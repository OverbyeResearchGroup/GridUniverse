(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-275db676"],{"0004":function(t,e){},"0150":function(t,e,n){t.exports=function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s="fb15")}({"06cf":function(t,e,n){var r=n("83ab"),i=n("d1e7"),o=n("5c6c"),s=n("fc6a"),a=n("c04e"),u=n("5135"),c=n("0cfb"),l=Object.getOwnPropertyDescriptor;e.f=r?l:function(t,e){if(t=s(t),e=a(e,!0),c)try{return l(t,e)}catch(n){}if(u(t,e))return o(!i.f.call(t,e),t[e])}},"0cfb":function(t,e,n){var r=n("83ab"),i=n("d039"),o=n("cc12");t.exports=!r&&!i((function(){return 7!=Object.defineProperty(o("div"),"a",{get:function(){return 7}}).a}))},"0d86":function(t,e,n){var r=n("19f3");"string"===typeof r&&(r=[[t.i,r,""]]),r.locals&&(t.exports=r.locals);var i=n("499e").default;i("6c1335ea",r,!0,{sourceMap:!1,shadowMode:!1})},1148:function(t,e,n){"use strict";var r=n("a691"),i=n("1d80");t.exports="".repeat||function(t){var e=String(i(this)),n="",o=r(t);if(o<0||o==1/0)throw RangeError("Wrong number of repetitions");for(;o>0;(o>>>=1)&&(e+=e))1&o&&(n+=e);return n}},"19f3":function(t,e,n){var r=n("24fb");e=r(!1),e.push([t.i,".marquee-text-wrap{overflow:hidden}.marquee-text-content{width:100000px}.marquee-text-text{-webkit-animation-name:marquee-text-animation;animation-name:marquee-text-animation;-webkit-animation-timing-function:linear;animation-timing-function:linear;-webkit-animation-iteration-count:infinite;animation-iteration-count:infinite;float:left}.marquee-text-paused .marquee-text-text{-webkit-animation-play-state:paused;animation-play-state:paused}@-webkit-keyframes marquee-text-animation{0%{-webkit-transform:translateX(0);transform:translateX(0)}to{-webkit-transform:translateX(-100%);transform:translateX(-100%)}}@keyframes marquee-text-animation{0%{-webkit-transform:translateX(0);transform:translateX(0)}to{-webkit-transform:translateX(-100%);transform:translateX(-100%)}}",""]),e.locals={wrap:"marquee-text-wrap",content:"marquee-text-content",text:"marquee-text-text",animation:"marquee-text-animation",paused:"marquee-text-paused"},t.exports=e},"1be4":function(t,e,n){var r=n("d066");t.exports=r("document","documentElement")},"1d80":function(t,e){t.exports=function(t){if(void 0==t)throw TypeError("Can't call method on "+t);return t}},"23cb":function(t,e,n){var r=n("a691"),i=Math.max,o=Math.min;t.exports=function(t,e){var n=r(t);return n<0?i(n+e,0):o(n,e)}},"23e7":function(t,e,n){var r=n("da84"),i=n("06cf").f,o=n("9112"),s=n("6eeb"),a=n("ce4e"),u=n("e893"),c=n("94ca");t.exports=function(t,e){var n,l,h,f,d,p,g=t.target,m=t.global,y=t.stat;if(l=m?r:y?r[g]||a(g,{}):(r[g]||{}).prototype,l)for(h in e){if(d=e[h],t.noTargetGet?(p=i(l,h),f=p&&p.value):f=l[h],n=c(m?h:g+(y?".":"#")+h,t.forced),!n&&void 0!==f){if(typeof d===typeof f)continue;u(d,f)}(t.sham||f&&f.sham)&&o(d,"sham",!0),s(l,h,d,t)}}},"241c":function(t,e,n){var r=n("ca84"),i=n("7839"),o=i.concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return r(t,o)}},"24fb":function(t,e,n){"use strict";function r(t,e){var n=t[1]||"",r=t[3];if(!r)return n;if(e&&"function"===typeof btoa){var o=i(r),s=r.sources.map((function(t){return"/*# sourceURL=".concat(r.sourceRoot||"").concat(t," */")}));return[n].concat(s).concat([o]).join("\n")}return[n].join("\n")}function i(t){var e=btoa(unescape(encodeURIComponent(JSON.stringify(t)))),n="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(e);return"/*# ".concat(n," */")}t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var n=r(e,t);return e[2]?"@media ".concat(e[2]," {").concat(n,"}"):n})).join("")},e.i=function(t,n,r){"string"===typeof t&&(t=[[null,t,""]]);var i={};if(r)for(var o=0;o<this.length;o++){var s=this[o][0];null!=s&&(i[s]=!0)}for(var a=0;a<t.length;a++){var u=[].concat(t[a]);r&&i[u[0]]||(n&&(u[2]?u[2]="".concat(n," and ").concat(u[2]):u[2]=n),e.push(u))}},e}},"37e8":function(t,e,n){var r=n("83ab"),i=n("9bf2"),o=n("825a"),s=n("df75");t.exports=r?Object.defineProperties:function(t,e){o(t);var n,r=s(e),a=r.length,u=0;while(a>u)i.f(t,n=r[u++],e[n]);return t}},"38cf":function(t,e,n){var r=n("23e7"),i=n("1148");r({target:"String",proto:!0},{repeat:i})},"3bbe":function(t,e,n){var r=n("861d");t.exports=function(t){if(!r(t)&&null!==t)throw TypeError("Can't set "+String(t)+" as a prototype");return t}},"428f":function(t,e,n){var r=n("da84");t.exports=r},"44ad":function(t,e,n){var r=n("d039"),i=n("c6b6"),o="".split;t.exports=r((function(){return!Object("z").propertyIsEnumerable(0)}))?function(t){return"String"==i(t)?o.call(t,""):Object(t)}:Object},"44d2":function(t,e,n){var r=n("b622"),i=n("7c73"),o=n("9bf2"),s=r("unscopables"),a=Array.prototype;void 0==a[s]&&o.f(a,s,{configurable:!0,value:i(null)}),t.exports=function(t){a[s][t]=!0}},4930:function(t,e,n){var r=n("d039");t.exports=!!Object.getOwnPropertySymbols&&!r((function(){return!String(Symbol())}))},"499e":function(t,e,n){"use strict";function r(t,e){for(var n=[],r={},i=0;i<e.length;i++){var o=e[i],s=o[0],a=o[1],u=o[2],c=o[3],l={id:t+":"+i,css:a,media:u,sourceMap:c};r[s]?r[s].parts.push(l):n.push(r[s]={id:s,parts:[l]})}return n}n.r(e),n.d(e,"default",(function(){return p}));var i="undefined"!==typeof document;if("undefined"!==typeof DEBUG&&DEBUG&&!i)throw new Error("vue-style-loader cannot be used in a non-browser environment. Use { target: 'node' } in your Webpack config to indicate a server-rendering environment.");var o={},s=i&&(document.head||document.getElementsByTagName("head")[0]),a=null,u=0,c=!1,l=function(){},h=null,f="data-vue-ssr-id",d="undefined"!==typeof navigator&&/msie [6-9]\b/.test(navigator.userAgent.toLowerCase());function p(t,e,n,i){c=n,h=i||{};var s=r(t,e);return g(s),function(e){for(var n=[],i=0;i<s.length;i++){var a=s[i],u=o[a.id];u.refs--,n.push(u)}e?(s=r(t,e),g(s)):s=[];for(i=0;i<n.length;i++){u=n[i];if(0===u.refs){for(var c=0;c<u.parts.length;c++)u.parts[c]();delete o[u.id]}}}}function g(t){for(var e=0;e<t.length;e++){var n=t[e],r=o[n.id];if(r){r.refs++;for(var i=0;i<r.parts.length;i++)r.parts[i](n.parts[i]);for(;i<n.parts.length;i++)r.parts.push(y(n.parts[i]));r.parts.length>n.parts.length&&(r.parts.length=n.parts.length)}else{var s=[];for(i=0;i<n.parts.length;i++)s.push(y(n.parts[i]));o[n.id]={id:n.id,refs:1,parts:s}}}}function m(){var t=document.createElement("style");return t.type="text/css",s.appendChild(t),t}function y(t){var e,n,r=document.querySelector("style["+f+'~="'+t.id+'"]');if(r){if(c)return l;r.parentNode.removeChild(r)}if(d){var i=u++;r=a||(a=m()),e=b.bind(null,r,i,!1),n=b.bind(null,r,i,!0)}else r=m(),e=_.bind(null,r),n=function(){r.parentNode.removeChild(r)};return e(t),function(r){if(r){if(r.css===t.css&&r.media===t.media&&r.sourceMap===t.sourceMap)return;e(t=r)}else n()}}var v=function(){var t=[];return function(e,n){return t[e]=n,t.filter(Boolean).join("\n")}}();function b(t,e,n,r){var i=n?"":r.css;if(t.styleSheet)t.styleSheet.cssText=v(e,i);else{var o=document.createTextNode(i),s=t.childNodes;s[e]&&t.removeChild(s[e]),s.length?t.insertBefore(o,s[e]):t.appendChild(o)}}function _(t,e){var n=e.css,r=e.media,i=e.sourceMap;if(r&&t.setAttribute("media",r),h.ssrId&&t.setAttribute(f,e.id),i&&(n+="\n/*# sourceURL="+i.sources[0]+" */",n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(i))))+" */"),t.styleSheet)t.styleSheet.cssText=n;else{while(t.firstChild)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(n))}}},"4d64":function(t,e,n){var r=n("fc6a"),i=n("50c4"),o=n("23cb"),s=function(t){return function(e,n,s){var a,u=r(e),c=i(u.length),l=o(s,c);if(t&&n!=n){while(c>l)if(a=u[l++],a!=a)return!0}else for(;c>l;l++)if((t||l in u)&&u[l]===n)return t||l||0;return!t&&-1}};t.exports={includes:s(!0),indexOf:s(!1)}},"50c4":function(t,e,n){var r=n("a691"),i=Math.min;t.exports=function(t){return t>0?i(r(t),9007199254740991):0}},5135:function(t,e){var n={}.hasOwnProperty;t.exports=function(t,e){return n.call(t,e)}},5692:function(t,e,n){var r=n("c430"),i=n("c6cd");(t.exports=function(t,e){return i[t]||(i[t]=void 0!==e?e:{})})("versions",[]).push({version:"3.6.5",mode:r?"pure":"global",copyright:"© 2020 Denis Pushkarev (zloirock.ru)"})},"56ef":function(t,e,n){var r=n("d066"),i=n("241c"),o=n("7418"),s=n("825a");t.exports=r("Reflect","ownKeys")||function(t){var e=i.f(s(t)),n=o.f;return n?e.concat(n(t)):e}},5899:function(t,e){t.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},"58a8":function(t,e,n){var r=n("1d80"),i=n("5899"),o="["+i+"]",s=RegExp("^"+o+o+"*"),a=RegExp(o+o+"*$"),u=function(t){return function(e){var n=String(r(e));return 1&t&&(n=n.replace(s,"")),2&t&&(n=n.replace(a,"")),n}};t.exports={start:u(1),end:u(2),trim:u(3)}},"5c6c":function(t,e){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},"69f3":function(t,e,n){var r,i,o,s=n("7f9a"),a=n("da84"),u=n("861d"),c=n("9112"),l=n("5135"),h=n("f772"),f=n("d012"),d=a.WeakMap,p=function(t){return o(t)?i(t):r(t,{})},g=function(t){return function(e){var n;if(!u(e)||(n=i(e)).type!==t)throw TypeError("Incompatible receiver, "+t+" required");return n}};if(s){var m=new d,y=m.get,v=m.has,b=m.set;r=function(t,e){return b.call(m,t,e),e},i=function(t){return y.call(m,t)||{}},o=function(t){return v.call(m,t)}}else{var _=h("state");f[_]=!0,r=function(t,e){return c(t,_,e),e},i=function(t){return l(t,_)?t[_]:{}},o=function(t){return l(t,_)}}t.exports={set:r,get:i,has:o,enforce:p,getterFor:g}},"6edf":function(t,e,n){"use strict";var r=n("0d86"),i=n.n(r);e["default"]=i.a},"6eeb":function(t,e,n){var r=n("da84"),i=n("9112"),o=n("5135"),s=n("ce4e"),a=n("8925"),u=n("69f3"),c=u.get,l=u.enforce,h=String(String).split("String");(t.exports=function(t,e,n,a){var u=!!a&&!!a.unsafe,c=!!a&&!!a.enumerable,f=!!a&&!!a.noTargetGet;"function"==typeof n&&("string"!=typeof e||o(n,"name")||i(n,"name",e),l(n).source=h.join("string"==typeof e?e:"")),t!==r?(u?!f&&t[e]&&(c=!0):delete t[e],c?t[e]=n:i(t,e,n)):c?t[e]=n:s(e,n)})(Function.prototype,"toString",(function(){return"function"==typeof this&&c(this).source||a(this)}))},7156:function(t,e,n){var r=n("861d"),i=n("d2bb");t.exports=function(t,e,n){var o,s;return i&&"function"==typeof(o=e.constructor)&&o!==n&&r(s=o.prototype)&&s!==n.prototype&&i(t,s),t}},7418:function(t,e){e.f=Object.getOwnPropertySymbols},7839:function(t,e){t.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},"7b0b":function(t,e,n){var r=n("1d80");t.exports=function(t){return Object(r(t))}},"7c73":function(t,e,n){var r,i=n("825a"),o=n("37e8"),s=n("7839"),a=n("d012"),u=n("1be4"),c=n("cc12"),l=n("f772"),h=">",f="<",d="prototype",p="script",g=l("IE_PROTO"),m=function(){},y=function(t){return f+p+h+t+f+"/"+p+h},v=function(t){t.write(y("")),t.close();var e=t.parentWindow.Object;return t=null,e},b=function(){var t,e=c("iframe"),n="java"+p+":";return e.style.display="none",u.appendChild(e),e.src=String(n),t=e.contentWindow.document,t.open(),t.write(y("document.F=Object")),t.close(),t.F},_=function(){try{r=document.domain&&new ActiveXObject("htmlfile")}catch(e){}_=r?v(r):b();var t=s.length;while(t--)delete _[d][s[t]];return _()};a[g]=!0,t.exports=Object.create||function(t,e){var n;return null!==t?(m[d]=i(t),n=new m,m[d]=null,n[g]=t):n=_(),void 0===e?n:o(n,e)}},"7f9a":function(t,e,n){var r=n("da84"),i=n("8925"),o=r.WeakMap;t.exports="function"===typeof o&&/native code/.test(i(o))},"81d5":function(t,e,n){"use strict";var r=n("7b0b"),i=n("23cb"),o=n("50c4");t.exports=function(t){var e=r(this),n=o(e.length),s=arguments.length,a=i(s>1?arguments[1]:void 0,n),u=s>2?arguments[2]:void 0,c=void 0===u?n:i(u,n);while(c>a)e[a++]=t;return e}},"825a":function(t,e,n){var r=n("861d");t.exports=function(t){if(!r(t))throw TypeError(String(t)+" is not an object");return t}},"83ab":function(t,e,n){var r=n("d039");t.exports=!r((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}))},"861d":function(t,e){t.exports=function(t){return"object"===typeof t?null!==t:"function"===typeof t}},8875:function(t,e,n){var r,i,o;(function(n,s){i=[],r=s,o="function"===typeof r?r.apply(e,i):r,void 0===o||(t.exports=o)})("undefined"!==typeof self&&self,(function(){function t(){var e=Object.getOwnPropertyDescriptor(document,"currentScript");if(!e&&"currentScript"in document&&document.currentScript)return document.currentScript;if(e&&e.get!==t&&document.currentScript)return document.currentScript;try{throw new Error}catch(d){var n,r,i,o=/.*at [^(]*\((.*):(.+):(.+)\)$/gi,s=/@([^@]*):(\d+):(\d+)\s*$/gi,a=o.exec(d.stack)||s.exec(d.stack),u=a&&a[1]||!1,c=a&&a[2]||!1,l=document.location.href.replace(document.location.hash,""),h=document.getElementsByTagName("script");u===l&&(n=document.documentElement.outerHTML,r=new RegExp("(?:[^\\n]+?\\n){0,"+(c-2)+"}[^<]*<script>([\\d\\D]*?)<\\/script>[\\d\\D]*","i"),i=n.replace(r,"$1").trim());for(var f=0;f<h.length;f++){if("interactive"===h[f].readyState)return h[f];if(h[f].src===u)return h[f];if(u===l&&h[f].innerHTML&&h[f].innerHTML.trim()===i)return h[f]}return null}}return t}))},8925:function(t,e,n){var r=n("c6cd"),i=Function.toString;"function"!=typeof r.inspectSource&&(r.inspectSource=function(t){return i.call(t)}),t.exports=r.inspectSource},"90e3":function(t,e){var n=0,r=Math.random();t.exports=function(t){return"Symbol("+String(void 0===t?"":t)+")_"+(++n+r).toString(36)}},9112:function(t,e,n){var r=n("83ab"),i=n("9bf2"),o=n("5c6c");t.exports=r?function(t,e,n){return i.f(t,e,o(1,n))}:function(t,e,n){return t[e]=n,t}},"94ca":function(t,e,n){var r=n("d039"),i=/#|\.prototype\./,o=function(t,e){var n=a[s(t)];return n==c||n!=u&&("function"==typeof e?r(e):!!e)},s=o.normalize=function(t){return String(t).replace(i,".").toLowerCase()},a=o.data={},u=o.NATIVE="N",c=o.POLYFILL="P";t.exports=o},"9bf2":function(t,e,n){var r=n("83ab"),i=n("0cfb"),o=n("825a"),s=n("c04e"),a=Object.defineProperty;e.f=r?a:function(t,e,n){if(o(t),e=s(e,!0),o(n),i)try{return a(t,e,n)}catch(r){}if("get"in n||"set"in n)throw TypeError("Accessors not supported");return"value"in n&&(t[e]=n.value),t}},a691:function(t,e){var n=Math.ceil,r=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?r:n)(t)}},a9e3:function(t,e,n){"use strict";var r=n("83ab"),i=n("da84"),o=n("94ca"),s=n("6eeb"),a=n("5135"),u=n("c6b6"),c=n("7156"),l=n("c04e"),h=n("d039"),f=n("7c73"),d=n("241c").f,p=n("06cf").f,g=n("9bf2").f,m=n("58a8").trim,y="Number",v=i[y],b=v.prototype,_=u(f(b))==y,w=function(t){var e,n,r,i,o,s,a,u,c=l(t,!1);if("string"==typeof c&&c.length>2)if(c=m(c),e=c.charCodeAt(0),43===e||45===e){if(n=c.charCodeAt(2),88===n||120===n)return NaN}else if(48===e){switch(c.charCodeAt(1)){case 66:case 98:r=2,i=49;break;case 79:case 111:r=8,i=55;break;default:return+c}for(o=c.slice(2),s=o.length,a=0;a<s;a++)if(u=o.charCodeAt(a),u<48||u>i)return NaN;return parseInt(o,r)}return+c};if(o(y,!v(" 0o1")||!v("0b1")||v("+0x1"))){for(var x,S=function(t){var e=arguments.length<1?0:t,n=this;return n instanceof S&&(_?h((function(){b.valueOf.call(n)})):u(n)!=y)?c(new v(w(e)),n,S):w(e)},E=r?d(v):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),A=0;E.length>A;A++)a(v,x=E[A])&&!a(S,x)&&g(S,x,p(v,x));S.prototype=b,b.constructor=S,s(i,y,S)}},b622:function(t,e,n){var r=n("da84"),i=n("5692"),o=n("5135"),s=n("90e3"),a=n("4930"),u=n("fdbf"),c=i("wks"),l=r.Symbol,h=u?l:l&&l.withoutSetter||s;t.exports=function(t){return o(c,t)||(a&&o(l,t)?c[t]=l[t]:c[t]=h("Symbol."+t)),c[t]}},c04e:function(t,e,n){var r=n("861d");t.exports=function(t,e){if(!r(t))return t;var n,i;if(e&&"function"==typeof(n=t.toString)&&!r(i=n.call(t)))return i;if("function"==typeof(n=t.valueOf)&&!r(i=n.call(t)))return i;if(!e&&"function"==typeof(n=t.toString)&&!r(i=n.call(t)))return i;throw TypeError("Can't convert object to primitive value")}},c430:function(t,e){t.exports=!1},c6b6:function(t,e){var n={}.toString;t.exports=function(t){return n.call(t).slice(8,-1)}},c6cd:function(t,e,n){var r=n("da84"),i=n("ce4e"),o="__core-js_shared__",s=r[o]||i(o,{});t.exports=s},c8ba:function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(r){"object"===typeof window&&(n=window)}t.exports=n},ca84:function(t,e,n){var r=n("5135"),i=n("fc6a"),o=n("4d64").indexOf,s=n("d012");t.exports=function(t,e){var n,a=i(t),u=0,c=[];for(n in a)!r(s,n)&&r(a,n)&&c.push(n);while(e.length>u)r(a,n=e[u++])&&(~o(c,n)||c.push(n));return c}},cb29:function(t,e,n){var r=n("23e7"),i=n("81d5"),o=n("44d2");r({target:"Array",proto:!0},{fill:i}),o("fill")},cc12:function(t,e,n){var r=n("da84"),i=n("861d"),o=r.document,s=i(o)&&i(o.createElement);t.exports=function(t){return s?o.createElement(t):{}}},ce4e:function(t,e,n){var r=n("da84"),i=n("9112");t.exports=function(t,e){try{i(r,t,e)}catch(n){r[t]=e}return e}},d012:function(t,e){t.exports={}},d039:function(t,e){t.exports=function(t){try{return!!t()}catch(e){return!0}}},d066:function(t,e,n){var r=n("428f"),i=n("da84"),o=function(t){return"function"==typeof t?t:void 0};t.exports=function(t,e){return arguments.length<2?o(r[t])||o(i[t]):r[t]&&r[t][e]||i[t]&&i[t][e]}},d1e7:function(t,e,n){"use strict";var r={}.propertyIsEnumerable,i=Object.getOwnPropertyDescriptor,o=i&&!r.call({1:2},1);e.f=o?function(t){var e=i(this,t);return!!e&&e.enumerable}:r},d2bb:function(t,e,n){var r=n("825a"),i=n("3bbe");t.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var t,e=!1,n={};try{t=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set,t.call(n,[]),e=n instanceof Array}catch(o){}return function(n,o){return r(n),i(o),e?t.call(n,o):n.__proto__=o,n}}():void 0)},da84:function(t,e,n){(function(e){var n=function(t){return t&&t.Math==Math&&t};t.exports=n("object"==typeof globalThis&&globalThis)||n("object"==typeof window&&window)||n("object"==typeof self&&self)||n("object"==typeof e&&e)||Function("return this")()}).call(this,n("c8ba"))},df75:function(t,e,n){var r=n("ca84"),i=n("7839");t.exports=Object.keys||function(t){return r(t,i)}},e893:function(t,e,n){var r=n("5135"),i=n("56ef"),o=n("06cf"),s=n("9bf2");t.exports=function(t,e){for(var n=i(e),a=s.f,u=o.f,c=0;c<n.length;c++){var l=n[c];r(t,l)||a(t,l,u(e,l))}}},f772:function(t,e,n){var r=n("5692"),i=n("90e3"),o=r("keys");t.exports=function(t){return o[t]||(o[t]=i(t))}},fb15:function(t,e,n){"use strict";if(n.r(e),"undefined"!==typeof window){var r=window.document.currentScript,i=n("8875");r=i(),"currentScript"in document||Object.defineProperty(document,"currentScript",{get:i});var o=r&&r.src.match(/(.+\/)[^/]+\.js(\?.*)?$/);o&&(n.p=o[1])}n("cb29"),n("a9e3"),n("38cf");var s,a,u={name:"MarqueeText",functional:!0,props:{duration:{type:Number,default:15},repeat:{type:Number,default:2,validator:function(t){return t>0}},paused:{type:Boolean,default:!1},reverse:{type:Boolean,default:!1}},render:function(t,e){var n=e.$style,r=e.props,i=r.duration,o=r.repeat,s=r.paused,a=r.reverse,u=e.children,c=e.data,l=c.staticClass,h=c.key,f=c.on,d=t("div",{class:n.text,style:{animationDuration:"".concat(i,"s"),animationDirection:a?"reverse":void 0}},u);return t("div",{key:h,on:f,class:[l,n.wrap]},[t("div",{class:[s?n.paused:void 0,n.content]},Array(o).fill(d))])}},c=u,l=n("6edf");function h(t,e,n,r,i,o,s,a){var u,c="function"===typeof t?t.options:t;if(e&&(c.render=e,c.staticRenderFns=n,c._compiled=!0),r&&(c.functional=!0),o&&(c._scopeId="data-v-"+o),s?(u=function(t){t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,t||"undefined"===typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),i&&i.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(s)},c._ssrRegister=u):i&&(u=a?function(){i.call(this,(c.functional?this.parent:this).$root.$options.shadowRoot)}:i),u)if(c.functional){c._injectStyles=u;var l=c.render;c.render=function(t,e){return u.call(e),l(t,e)}}else{var h=c.beforeCreate;c.beforeCreate=h?[].concat(h,u):[u]}return{exports:t,options:c}}function f(t){this["$style"]=l["default"].locals||l["default"]}var d=h(c,s,a,!1,f,null,null),p=d.exports;e["default"]=p},fc6a:function(t,e,n){var r=n("44ad"),i=n("1d80");t.exports=function(t){return r(i(t))}},fdbf:function(t,e,n){var r=n("4930");t.exports=r&&!Symbol.sham&&"symbol"==typeof Symbol.iterator}})["default"]},"022f":function(t,e,n){"use strict";n("cedc")},"0280":function(t,e,n){},"0299":function(t,e,n){"use strict";var r,i="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),o=64,s={},a=0,u=0;function c(t){var e="";do{e=i[t%o]+e,t=Math.floor(t/o)}while(t>0);return e}function l(t){var e=0;for(u=0;u<t.length;u++)e=e*o+s[t.charAt(u)];return e}function h(){var t=c(+new Date);return t!==r?(a=0,r=t):t+"."+c(a++)}for(;u<o;u++)s[i[u]]=u;h.encode=c,h.decode=l,t.exports=h},"04d4":function(t,e,n){t.exports=n("b181")},"07d6":function(t,e){t.exports=function(){throw new Error("define cannot be used indirect")}},"095a":function(t,e,n){"use strict";(function(t){var r=n("4ea4");Object.defineProperty(e,"__esModule",{value:!0}),e.default=o;var i=r(n("7037"));function o(e){if("undefined"!==typeof window&&"object"===(0,i.default)(window.process)&&"renderer"===window.process.type)return!0;if("undefined"!==typeof t&&"object"===(0,i.default)(t.versions)&&Boolean(t.versions.electron))return!0;var n="object"===("undefined"===typeof navigator?"undefined":(0,i.default)(navigator))&&"string"===typeof navigator.userAgent&&navigator.userAgent,r=e||n;return!!(r&&r.indexOf("Electron")>=0)}}).call(this,n("4362"))},"09b8":function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function i(t){if(!(e=r.exec(t)))throw new Error("invalid format: "+t);var e;return new o({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}function o(t){this.fill=void 0===t.fill?" ":t.fill+"",this.align=void 0===t.align?">":t.align+"",this.sign=void 0===t.sign?"-":t.sign+"",this.symbol=void 0===t.symbol?"":t.symbol+"",this.zero=!!t.zero,this.width=void 0===t.width?void 0:+t.width,this.comma=!!t.comma,this.precision=void 0===t.precision?void 0:+t.precision,this.trim=!!t.trim,this.type=void 0===t.type?"":t.type+""}i.prototype=o.prototype,o.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type}},"0a06":function(t,e,n){"use strict";var r=n("c532"),i=n("30b5"),o=n("f6b4"),s=n("5270"),a=n("4a7b"),u=n("848b"),c=u.validators;function l(t){this.defaults=t,this.interceptors={request:new o,response:new o}}l.prototype.request=function(t){"string"===typeof t?(t=arguments[1]||{},t.url=arguments[0]):t=t||{},t=a(this.defaults,t),t.method?t.method=t.method.toLowerCase():this.defaults.method?t.method=this.defaults.method.toLowerCase():t.method="get";var e=t.transitional;void 0!==e&&u.assertOptions(e,{silentJSONParsing:c.transitional(c.boolean),forcedJSONParsing:c.transitional(c.boolean),clarifyTimeoutError:c.transitional(c.boolean)},!1);var n=[],r=!0;this.interceptors.request.forEach((function(e){"function"===typeof e.runWhen&&!1===e.runWhen(t)||(r=r&&e.synchronous,n.unshift(e.fulfilled,e.rejected))}));var i,o=[];if(this.interceptors.response.forEach((function(t){o.push(t.fulfilled,t.rejected)})),!r){var l=[s,void 0];Array.prototype.unshift.apply(l,n),l=l.concat(o),i=Promise.resolve(t);while(l.length)i=i.then(l.shift(),l.shift());return i}var h=t;while(n.length){var f=n.shift(),d=n.shift();try{h=f(h)}catch(p){d(p);break}}try{i=s(h)}catch(p){return Promise.reject(p)}while(o.length)i=i.then(o.shift(),o.shift());return i},l.prototype.getUri=function(t){return t=a(this.defaults,t),i(t.url,t.params,t.paramsSerializer).replace(/^\?/,"")},r.forEach(["delete","get","head","options"],(function(t){l.prototype[t]=function(e,n){return this.request(a(n||{},{method:t,url:e,data:(n||{}).data}))}})),r.forEach(["post","put","patch"],(function(t){l.prototype[t]=function(e,n,r){return this.request(a(r||{},{method:t,url:e,data:n}))}})),t.exports=l},"0b41":function(t,e,n){t.exports=n("38ac")},"0b64":function(t,e){function n(t){t=t||{},this.ms=t.min||100,this.max=t.max||1e4,this.factor=t.factor||2,this.jitter=t.jitter>0&&t.jitter<=1?t.jitter:0,this.attempts=0}t.exports=n,n.prototype.duration=function(){var t=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random(),n=Math.floor(e*this.jitter*t);t=0==(1&Math.floor(10*e))?t-n:t+n}return 0|Math.min(t,this.max)},n.prototype.reset=function(){this.attempts=0},n.prototype.setMin=function(t){this.ms=t},n.prototype.setMax=function(t){this.max=t},n.prototype.setJitter=function(t){this.jitter=t}},"0c7c":function(t,e,n){"use strict";n.r(e);var r={};n.r(r),n.d(r,"COORDINATE_SYSTEM",(function(){return bn})),n.d(r,"UNIT",(function(){return wn})),n.d(r,"LightingEffect",(function(){return tl})),n.d(r,"AmbientLight",(function(){return Da})),n.d(r,"DirectionalLight",(function(){return Ua})),n.d(r,"PointLight",(function(){return Vl})),n.d(r,"_CameraLight",(function(){return Wl})),n.d(r,"_SunLight",(function(){return dh})),n.d(r,"PostProcessEffect",(function(){return ef})),n.d(r,"_LayersPass",(function(){return qa})),n.d(r,"Deck",(function(){return mv})),n.d(r,"LayerManager",(function(){return sg})),n.d(r,"AttributeManager",(function(){return Ob})),n.d(r,"Layer",(function(){return X_})),n.d(r,"CompositeLayer",(function(){return Z_})),n.d(r,"DeckRenderer",(function(){return Gg})),n.d(r,"Viewport",(function(){return yl})),n.d(r,"WebMercatorViewport",(function(){return Al})),n.d(r,"_GlobeViewport",(function(){return nw})),n.d(r,"picking",(function(){return lw})),n.d(r,"project",(function(){return Mu})),n.d(r,"project32",(function(){return fw})),n.d(r,"gouraudLighting",(function(){return Sw})),n.d(r,"phongLighting",(function(){return Ew})),n.d(r,"shadow",(function(){return Zc})),n.d(r,"View",(function(){return dg})),n.d(r,"MapView",(function(){return Fg})),n.d(r,"FirstPersonView",(function(){return Tw})),n.d(r,"OrbitView",(function(){return Bw})),n.d(r,"OrthographicView",(function(){return qw})),n.d(r,"_GlobeView",(function(){return Hw})),n.d(r,"Controller",(function(){return Pg})),n.d(r,"MapController",(function(){return Rg})),n.d(r,"_GlobeController",(function(){return Gw})),n.d(r,"FirstPersonController",(function(){return kw})),n.d(r,"OrbitController",(function(){return Nw})),n.d(r,"OrthographicController",(function(){return zw})),n.d(r,"Effect",(function(){return $a})),n.d(r,"LayerExtension",(function(){return Xw})),n.d(r,"TRANSITION_EVENTS",(function(){return vg})),n.d(r,"TransitionInterpolator",(function(){return wg})),n.d(r,"LinearInterpolator",(function(){return Eg})),n.d(r,"FlyToInterpolator",(function(){return Kw})),n.d(r,"log",(function(){return vn})),n.d(r,"createIterable",(function(){return Av})),n.d(r,"fp64LowPart",(function(){return cl})),n.d(r,"Tesselator",(function(){return Jw})),n.d(r,"_fillArray",(function(){return yf})),n.d(r,"_flatten",(function(){return gf})),n.d(r,"_count",(function(){return Kb})),n.d(r,"_memoize",(function(){return du})),n.d(r,"_mergeShaders",(function(){return t_})),n.d(r,"_compareProps",(function(){return $b}));var i={};n.r(i),n.d(i,"ArcLayer",(function(){return rx})),n.d(i,"BitmapLayer",(function(){return dx})),n.d(i,"IconLayer",(function(){return Tx})),n.d(i,"LineLayer",(function(){return Rx})),n.d(i,"PointCloudLayer",(function(){return Vx})),n.d(i,"ScatterplotLayer",(function(){return Xx})),n.d(i,"ColumnLayer",(function(){return CS})),n.d(i,"GridCellLayer",(function(){return DS})),n.d(i,"PathLayer",(function(){return GS})),n.d(i,"PolygonLayer",(function(){return bE})),n.d(i,"GeoJsonLayer",(function(){return IA})),n.d(i,"TextLayer",(function(){return yA})),n.d(i,"SolidPolygonLayer",(function(){return pE})),n.d(i,"_MultiIconLayer",(function(){return CE})),n.d(i,"_TextBackgroundLayer",(function(){return cA}));var o={};n.r(o),n.d(o,"createGLContext",(function(){return Si})),n.d(o,"instrumentGLContext",(function(){return Ei})),n.d(o,"isWebGL",(function(){return ci["d"]})),n.d(o,"isWebGL2",(function(){return ci["e"]})),n.d(o,"getParameters",(function(){return li["a"]})),n.d(o,"setParameters",(function(){return li["c"]})),n.d(o,"withParameters",(function(){return li["d"]})),n.d(o,"resetParameters",(function(){return li["b"]})),n.d(o,"cssToDeviceRatio",(function(){return pi})),n.d(o,"cssToDevicePixels",(function(){return gi})),n.d(o,"lumaStats",(function(){return ji})),n.d(o,"FEATURES",(function(){return Yo})),n.d(o,"hasFeature",(function(){return Qo})),n.d(o,"hasFeatures",(function(){return ts})),n.d(o,"Buffer",(function(){return co})),n.d(o,"Program",(function(){return Pa})),n.d(o,"Framebuffer",(function(){return os})),n.d(o,"Renderbuffer",(function(){return Ao})),n.d(o,"Texture2D",(function(){return wo})),n.d(o,"TextureCube",(function(){return jo})),n.d(o,"clear",(function(){return No})),n.d(o,"readPixelsToArray",(function(){return Vo})),n.d(o,"readPixelsToBuffer",(function(){return qo})),n.d(o,"cloneTextureFrom",(function(){return Uo})),n.d(o,"copyToTexture",(function(){return Go})),n.d(o,"Texture3D",(function(){return zo})),n.d(o,"TransformFeedback",(function(){return kh})),n.d(o,"AnimationLoop",(function(){return uy})),n.d(o,"Model",(function(){return Xh})),n.d(o,"Transform",(function(){return hb})),n.d(o,"ProgramManager",(function(){return Ta})),n.d(o,"Timeline",(function(){return cf})),n.d(o,"Geometry",(function(){return Zh})),n.d(o,"ClipSpace",(function(){return Qh})),n.d(o,"ConeGeometry",(function(){return FA})),n.d(o,"CubeGeometry",(function(){return IS})),n.d(o,"CylinderGeometry",(function(){return BA})),n.d(o,"IcoSphereGeometry",(function(){return $A})),n.d(o,"PlaneGeometry",(function(){return WA})),n.d(o,"SphereGeometry",(function(){return HA})),n.d(o,"TruncatedConeGeometry",(function(){return DA})),n.d(o,"normalizeShaderModule",(function(){return In})),n.d(o,"fp32",(function(){return Za})),n.d(o,"fp64",(function(){return rM})),n.d(o,"project",(function(){return hM})),n.d(o,"dirlight",(function(){return yM})),n.d(o,"picking",(function(){return cw})),n.d(o,"gouraudLighting",(function(){return Sw})),n.d(o,"phongLighting",(function(){return Ew})),n.d(o,"pbr",(function(){return _M})),n.d(o,"log",(function(){return ui})),n.d(o,"assert",(function(){return zi})),n.d(o,"uid",(function(){return qi}));var s={};n.r(s),n.d(s,"aggregate",(function(){return CL})),n.d(s,"bin",(function(){return OL})),n.d(s,"collect",(function(){return TL})),n.d(s,"compare",(function(){return LL})),n.d(s,"countpattern",(function(){return NL})),n.d(s,"cross",(function(){return RL})),n.d(s,"density",(function(){return VL})),n.d(s,"dotbin",(function(){return ZL})),n.d(s,"expression",(function(){return JL})),n.d(s,"extent",(function(){return tI})),n.d(s,"facet",(function(){return nI})),n.d(s,"field",(function(){return rI})),n.d(s,"filter",(function(){return oI})),n.d(s,"flatten",(function(){return sI})),n.d(s,"fold",(function(){return aI})),n.d(s,"formula",(function(){return uI})),n.d(s,"generate",(function(){return cI})),n.d(s,"impute",(function(){return fI})),n.d(s,"joinaggregate",(function(){return mI})),n.d(s,"kde",(function(){return yI})),n.d(s,"key",(function(){return vI})),n.d(s,"load",(function(){return _I})),n.d(s,"lookup",(function(){return SI})),n.d(s,"multiextent",(function(){return EI})),n.d(s,"multivalues",(function(){return MI})),n.d(s,"params",(function(){return kI})),n.d(s,"pivot",(function(){return OI})),n.d(s,"prefacet",(function(){return II})),n.d(s,"project",(function(){return NI})),n.d(s,"proxy",(function(){return RI})),n.d(s,"quantile",(function(){return FI})),n.d(s,"relay",(function(){return jI})),n.d(s,"sample",(function(){return zI})),n.d(s,"sequence",(function(){return UI})),n.d(s,"sieve",(function(){return $I})),n.d(s,"subflow",(function(){return eI})),n.d(s,"timeunit",(function(){return VI})),n.d(s,"tupleindex",(function(){return WI})),n.d(s,"values",(function(){return GI})),n.d(s,"window",(function(){return tN}));var a={};n.r(a),n.d(a,"interpolate",(function(){return SF})),n.d(a,"interpolateArray",(function(){return dF})),n.d(a,"interpolateBasis",(function(){return QR})),n.d(a,"interpolateBasisClosed",(function(){return tF})),n.d(a,"interpolateDate",(function(){return gF})),n.d(a,"interpolateDiscrete",(function(){return ij})),n.d(a,"interpolateHue",(function(){return oj})),n.d(a,"interpolateNumber",(function(){return mF})),n.d(a,"interpolateNumberArray",(function(){return hF})),n.d(a,"interpolateObject",(function(){return yF})),n.d(a,"interpolateRound",(function(){return EF})),n.d(a,"interpolateString",(function(){return xF})),n.d(a,"interpolateTransformCss",(function(){return fj})),n.d(a,"interpolateTransformSvg",(function(){return dj})),n.d(a,"interpolateZoom",(function(){return vj})),n.d(a,"interpolateRgb",(function(){return aF})),n.d(a,"interpolateRgbBasis",(function(){return cF})),n.d(a,"interpolateRgbBasisClosed",(function(){return lF})),n.d(a,"interpolateHsl",(function(){return _j})),n.d(a,"interpolateHslLong",(function(){return wj})),n.d(a,"interpolateLab",(function(){return qj})),n.d(a,"interpolateHcl",(function(){return Gj})),n.d(a,"interpolateHclLong",(function(){return Hj})),n.d(a,"interpolateCubehelix",(function(){return sz})),n.d(a,"interpolateCubehelixLong",(function(){return az})),n.d(a,"piecewise",(function(){return GB})),n.d(a,"quantize",(function(){return uz}));var u={};n.r(u),n.d(u,"bound",(function(){return QX})),n.d(u,"identifier",(function(){return nY})),n.d(u,"mark",(function(){return iY})),n.d(u,"overlap",(function(){return sY})),n.d(u,"render",(function(){return pY})),n.d(u,"viewlayout",(function(){return qY}));var c={};n.r(c),n.d(c,"axisticks",(function(){return TZ})),n.d(c,"datajoin",(function(){return LZ})),n.d(c,"encode",(function(){return DZ})),n.d(c,"legendentries",(function(){return RZ})),n.d(c,"linkpath",(function(){return UZ})),n.d(c,"pie",(function(){return eK})),n.d(c,"scale",(function(){return sK})),n.d(c,"sortitems",(function(){return bK})),n.d(c,"stack",(function(){return EK}));var l={};n.r(l),n.d(l,"contour",(function(){return T4})),n.d(l,"geojson",(function(){return D4})),n.d(l,"geopath",(function(){return R4})),n.d(l,"geopoint",(function(){return B4})),n.d(l,"geoshape",(function(){return j4})),n.d(l,"graticule",(function(){return U4})),n.d(l,"heatmap",(function(){return $4})),n.d(l,"isocontour",(function(){return v4})),n.d(l,"kde2d",(function(){return C4})),n.d(l,"projection",(function(){return H4}));var h={};n.r(h),n.d(h,"force",(function(){return D5}));var f={};n.r(f),n.d(f,"nest",(function(){return P9})),n.d(f,"pack",(function(){return B9})),n.d(f,"partition",(function(){return z9})),n.d(f,"stratify",(function(){return U9})),n.d(f,"tree",(function(){return q9})),n.d(f,"treelinks",(function(){return W9})),n.d(f,"treemap",(function(){return X9}));var d={};n.r(d),n.d(d,"label",(function(){return K7}));var p={};n.r(p),n.d(p,"loess",(function(){return ftt})),n.d(p,"regression",(function(){return gtt}));var g={};n.r(g),n.d(g,"voronoi",(function(){return Jtt}));var m={};n.r(m),n.d(m,"wordcloud",(function(){return Pet}));var y={};n.r(y),n.d(y,"crossfilter",(function(){return int})),n.d(y,"resolvefilter",(function(){return ont}));var v={};n.r(v),n.d(v,"Debug",(function(){return UM})),n.d(v,"Error",(function(){return BM})),n.d(v,"Info",(function(){return zM})),n.d(v,"None",(function(){return FM})),n.d(v,"Warn",(function(){return jM})),n.d(v,"accessor",(function(){return wM})),n.d(v,"accessorFields",(function(){return SM})),n.d(v,"accessorName",(function(){return xM})),n.d(v,"array",(function(){return pC})),n.d(v,"ascending",(function(){return bC})),n.d(v,"clampRange",(function(){return gC})),n.d(v,"compare",(function(){return vC})),n.d(v,"constant",(function(){return SC})),n.d(v,"debounce",(function(){return EC})),n.d(v,"error",(function(){return CM})),n.d(v,"extend",(function(){return AC})),n.d(v,"extent",(function(){return MC})),n.d(v,"extentIndex",(function(){return CC})),n.d(v,"falsy",(function(){return DM})),n.d(v,"fastmap",(function(){return TC})),n.d(v,"field",(function(){return OM})),n.d(v,"flush",(function(){return LC})),n.d(v,"hasOwnProperty",(function(){return OC})),n.d(v,"id",(function(){return PM})),n.d(v,"identity",(function(){return TM})),n.d(v,"inherits",(function(){return IC})),n.d(v,"inrange",(function(){return NC})),n.d(v,"isArray",(function(){return VM})),n.d(v,"isBoolean",(function(){return DC})),n.d(v,"isDate",(function(){return RC})),n.d(v,"isFunction",(function(){return mC})),n.d(v,"isIterable",(function(){return FC})),n.d(v,"isNumber",(function(){return BC})),n.d(v,"isObject",(function(){return qM})),n.d(v,"isRegExp",(function(){return jC})),n.d(v,"isString",(function(){return zC})),n.d(v,"key",(function(){return UC})),n.d(v,"lerp",(function(){return $C})),n.d(v,"logger",(function(){return $M})),n.d(v,"lruCache",(function(){return qC})),n.d(v,"merge",(function(){return WC})),n.d(v,"mergeConfig",(function(){return GM})),n.d(v,"one",(function(){return IM})),n.d(v,"pad",(function(){return HC})),n.d(v,"panLinear",(function(){return rC})),n.d(v,"panLog",(function(){return iC})),n.d(v,"panPow",(function(){return oC})),n.d(v,"panSymlog",(function(){return sC})),n.d(v,"peek",(function(){return YM})),n.d(v,"quarter",(function(){return fC})),n.d(v,"repeat",(function(){return GC})),n.d(v,"span",(function(){return XC})),n.d(v,"splitAccessPath",(function(){return kM})),n.d(v,"stringValue",(function(){return YC})),n.d(v,"toBoolean",(function(){return ZC})),n.d(v,"toDate",(function(){return JC})),n.d(v,"toNumber",(function(){return ZM})),n.d(v,"toSet",(function(){return tk})),n.d(v,"toString",(function(){return QC})),n.d(v,"truncate",(function(){return ek})),n.d(v,"truthy",(function(){return NM})),n.d(v,"utcquarter",(function(){return dC})),n.d(v,"visitArray",(function(){return nk})),n.d(v,"writeConfig",(function(){return HM})),n.d(v,"zero",(function(){return LM})),n.d(v,"zoomLinear",(function(){return uC})),n.d(v,"zoomLog",(function(){return cC})),n.d(v,"zoomPow",(function(){return lC})),n.d(v,"zoomSymlog",(function(){return hC})),n.d(v,"Dataflow",(function(){return ZO})),n.d(v,"EventStream",(function(){return iO})),n.d(v,"MultiPulse",(function(){return NO})),n.d(v,"Operator",(function(){return Qk})),n.d(v,"Parameters",(function(){return Hk})),n.d(v,"Pulse",(function(){return PO})),n.d(v,"Transform",(function(){return JO})),n.d(v,"changeset",(function(){return Wk})),n.d(v,"definition",(function(){return tP})),n.d(v,"ingest",(function(){return jk})),n.d(v,"isTuple",(function(){return Rk})),n.d(v,"transform",(function(){return eP})),n.d(v,"transforms",(function(){return QO})),n.d(v,"tupleid",(function(){return Fk})),n.d(v,"bandwidthNRD",(function(){return JP})),n.d(v,"bin",(function(){return QP})),n.d(v,"bootstrapCI",(function(){return nT})),n.d(v,"cumulativeLogNormal",(function(){return bT})),n.d(v,"cumulativeNormal",(function(){return fT})),n.d(v,"cumulativeUniform",(function(){return AT})),n.d(v,"densityLogNormal",(function(){return vT})),n.d(v,"densityNormal",(function(){return hT})),n.d(v,"densityUniform",(function(){return ET})),n.d(v,"dotbin",(function(){return rT})),n.d(v,"quantileLogNormal",(function(){return _T})),n.d(v,"quantileNormal",(function(){return dT})),n.d(v,"quantileUniform",(function(){return MT})),n.d(v,"quantiles",(function(){return ZP})),n.d(v,"quartiles",(function(){return KP})),n.d(v,"random",(function(){return tT})),n.d(v,"randomInteger",(function(){return sT})),n.d(v,"randomKDE",(function(){return mT})),n.d(v,"randomLCG",(function(){return oT})),n.d(v,"randomLogNormal",(function(){return wT})),n.d(v,"randomMixture",(function(){return xT})),n.d(v,"randomNormal",(function(){return gT})),n.d(v,"randomUniform",(function(){return CT})),n.d(v,"regressionExp",(function(){return NT})),n.d(v,"regressionLinear",(function(){return LT})),n.d(v,"regressionLoess",(function(){return $T})),n.d(v,"regressionLog",(function(){return IT})),n.d(v,"regressionPoly",(function(){return FT})),n.d(v,"regressionPow",(function(){return DT})),n.d(v,"regressionQuad",(function(){return RT})),n.d(v,"sampleCurve",(function(){return HT})),n.d(v,"sampleLogNormal",(function(){return yT})),n.d(v,"sampleNormal",(function(){return lT})),n.d(v,"sampleUniform",(function(){return ST})),n.d(v,"setRandom",(function(){return eT})),n.d(v,"DATE",(function(){return uL["a"]})),n.d(v,"DAY",(function(){return uL["b"]})),n.d(v,"DAYOFYEAR",(function(){return uL["c"]})),n.d(v,"HOURS",(function(){return uL["d"]})),n.d(v,"MILLISECONDS",(function(){return uL["e"]})),n.d(v,"MINUTES",(function(){return uL["f"]})),n.d(v,"MONTH",(function(){return uL["g"]})),n.d(v,"QUARTER",(function(){return uL["h"]})),n.d(v,"SECONDS",(function(){return uL["i"]})),n.d(v,"TIME_UNITS",(function(){return uL["j"]})),n.d(v,"WEEK",(function(){return uL["k"]})),n.d(v,"YEAR",(function(){return uL["l"]})),n.d(v,"dayofyear",(function(){return uL["m"]})),n.d(v,"timeBin",(function(){return uL["n"]})),n.d(v,"timeFloor",(function(){return uL["o"]})),n.d(v,"timeInterval",(function(){return uL["p"]})),n.d(v,"timeOffset",(function(){return uL["q"]})),n.d(v,"timeSequence",(function(){return uL["r"]})),n.d(v,"timeUnitSpecifier",(function(){return uL["s"]})),n.d(v,"timeUnits",(function(){return uL["t"]})),n.d(v,"utcFloor",(function(){return uL["u"]})),n.d(v,"utcInterval",(function(){return uL["v"]})),n.d(v,"utcOffset",(function(){return uL["w"]})),n.d(v,"utcSequence",(function(){return uL["x"]})),n.d(v,"utcdayofyear",(function(){return uL["y"]})),n.d(v,"utcweek",(function(){return uL["z"]})),n.d(v,"week",(function(){return uL["A"]})),n.d(v,"format",(function(){return Pk["a"]})),n.d(v,"formats",(function(){return Pk["b"]})),n.d(v,"inferType",(function(){return Pk["c"]})),n.d(v,"inferTypes",(function(){return Pk["d"]})),n.d(v,"loader",(function(){return Pk["e"]})),n.d(v,"read",(function(){return Pk["f"]})),n.d(v,"responseType",(function(){return Pk["g"]})),n.d(v,"typeParsers",(function(){return Pk["h"]})),n.d(v,"Bounds",(function(){return lV})),n.d(v,"CanvasHandler",(function(){return PG})),n.d(v,"CanvasRenderer",(function(){return jG})),n.d(v,"Gradient",(function(){return WU})),n.d(v,"GroupItem",(function(){return fV})),n.d(v,"Handler",(function(){return oG})),n.d(v,"Item",(function(){return hV})),n.d(v,"Marks",(function(){return $W})),n.d(v,"RenderType",(function(){return qH})),n.d(v,"Renderer",(function(){return aG})),n.d(v,"ResourceLoader",(function(){return dV})),n.d(v,"SVGHandler",(function(){return VG})),n.d(v,"SVGRenderer",(function(){return wH})),n.d(v,"SVGStringRenderer",(function(){return BH})),n.d(v,"Scenegraph",(function(){return ZW})),n.d(v,"boundClip",(function(){return QH})),n.d(v,"boundContext",(function(){return DV})),n.d(v,"boundItem",(function(){return VW})),n.d(v,"boundMark",(function(){return WW})),n.d(v,"boundStroke",(function(){return mV})),n.d(v,"domChild",(function(){return tG})),n.d(v,"domClear",(function(){return eG})),n.d(v,"domCreate",(function(){return JW})),n.d(v,"domFind",(function(){return QW})),n.d(v,"font",(function(){return PW})),n.d(v,"fontFamily",(function(){return OW})),n.d(v,"fontSize",(function(){return wW})),n.d(v,"intersect",(function(){return HH})),n.d(v,"intersectBoxLine",(function(){return GV})),n.d(v,"intersectPath",(function(){return $V})),n.d(v,"intersectPoint",(function(){return VV})),n.d(v,"intersectRule",(function(){return WV})),n.d(v,"lineHeight",(function(){return xW})),n.d(v,"markup",(function(){return dH})),n.d(v,"multiLineOffset",(function(){return AW})),n.d(v,"pathCurves",(function(){return HU})),n.d(v,"pathEqual",(function(){return nX})),n.d(v,"pathParse",(function(){return ZU})),n.d(v,"pathRectangle",(function(){return S$})),n.d(v,"pathRender",(function(){return c$})),n.d(v,"pathSymbols",(function(){return d$})),n.d(v,"pathTrail",(function(){return E$})),n.d(v,"point",(function(){return rG})),n.d(v,"renderModule",(function(){return GH})),n.d(v,"resetSVGClipId",(function(){return uV})),n.d(v,"resetSVGDefIds",(function(){return iX})),n.d(v,"sceneEqual",(function(){return eX})),n.d(v,"sceneFromJSON",(function(){return XW})),n.d(v,"scenePickVisit",(function(){return iq})),n.d(v,"sceneToJSON",(function(){return HW})),n.d(v,"sceneVisit",(function(){return rq})),n.d(v,"sceneZOrder",(function(){return nq})),n.d(v,"serializeXML",(function(){return pH})),n.d(v,"textMetrics",(function(){return gW})),n.d(v,"interpolate",(function(){return iU})),n.d(v,"interpolateColors",(function(){return eU})),n.d(v,"interpolateRange",(function(){return tU})),n.d(v,"quantizeInterpolator",(function(){return nU})),n.d(v,"scale",(function(){return Vz})),n.d(v,"scheme",(function(){return hU})),n.d(v,"projection",(function(){return _3})),n.d(v,"View",(function(){return Rdt})),n.d(v,"defaultLocale",(function(){return Tk["a"]})),n.d(v,"formatLocale",(function(){return Tk["c"]})),n.d(v,"locale",(function(){return Tk["b"]})),n.d(v,"resetDefaultLocale",(function(){return Tk["d"]})),n.d(v,"timeFormatLocale",(function(){return Tk["e"]})),n.d(v,"expressionFunction",(function(){return sht})),n.d(v,"parse",(function(){return Vbt})),n.d(v,"runtimeContext",(function(){return uft})),n.d(v,"codegenExpression",(function(){return tst})),n.d(v,"parseExpression",(function(){return Zot})),n.d(v,"parseSelector",(function(){return _pt})),n.d(v,"version",(function(){return a_t}));var b={};n.r(b),n.d(b,"protocol",(function(){return Axt})),n.d(b,"PacketType",(function(){return Mxt})),n.d(b,"Encoder",(function(){return Cxt})),n.d(b,"Decoder",(function(){return kxt}));var _=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[t.showToolbar?n("v-app-bar",{attrs:{"clipped-left":"",app:""}},[n("v-app-bar-nav-icon",{on:{click:function(e){e.stopPropagation(),t.drawer=!t.drawer}}}),n("v-toolbar-title",{staticClass:"white--text pt-3"},[n("button",{on:{click:function(e){return t.$store.commit("setpage","Home")}}},[t._v("Gridverse")]),n("div",[n("p",{staticClass:"font-weight-thin text-subtitle-2"},[t._v(" Powered by PowerWorld Dynamics Studio and EMQ ")])])]),n("v-spacer"),n("v-btn",{attrs:{icon:""},on:{click:function(e){return t.handleFullScreen()}}},[n("v-icon",[t._v("fullscreen")])],1),n("v-menu",{attrs:{left:"",bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var r=e.on;return[n("v-btn",t._g({attrs:{icon:"",text:""},on:{click:function(e){return t.$store.commit("resetbadge")}}},r),[n("v-badge",{attrs:{color:"red",overlap:""},model:{value:t.badgeShow,callback:function(e){t.badgeShow=e},expression:"badgeShow"}},[n("span",{attrs:{slot:"badge"},slot:"badge"},[t._v(t._s(t.badge))]),n("v-icon",{attrs:{medium:""}},[t._v("notifications")])],1)],1)]}}],null,!1,2545753837)},[n("NotificationList",{on:{changeHeight:t.changeHeight}})],1)],1):t._e(),n("v-navigation-drawer",{attrs:{fixed:"",app:"",clipped:"",width:"160"},model:{value:t.drawer,callback:function(e){t.drawer=e},expression:"drawer"}},[n("v-list",{attrs:{dense:"",id:"step1"}},[n("div",{attrs:{id:"step4"}},[n("v-list-item",{key:"clock"},[n("Clock")],1)],1),n("v-list-item",{key:"home",on:{click:function(e){return t.$store.commit("setpage","Home")}}},[n("v-list-item-avatar",[n("v-icon",[t._v("mdi-home")])],1),n("v-list-item-content",[n("v-list-item-title",[t._v("Transmission")])],1)],1),n("v-list-item",{key:"generator",on:{click:function(e){return t.$store.commit("setpage","generator")}}},[n("v-list-item-avatar",[n("v-icon",[t._v("mdi-google-glass")])],1),n("v-list-item-content",[n("v-list-item-title",[t._v("Generator")])],1)],1),n("v-list-item",{key:"load",on:{click:function(e){return t.$store.commit("setpage","load")}}},[n("v-list-item-avatar",[n("v-icon",[t._v("mdi-lightbulb")])],1),n("v-list-item-content",[n("v-list-item-title",[t._v("Load")])],1)],1),n("v-list-item",{key:"shunt",on:{click:function(e){return t.$store.commit("setpage","shunt")}}},[n("v-list-item-avatar",[n("v-icon",[t._v("mdi-currency-usd")])],1),n("v-list-item-content",[n("v-list-item-title",[t._v("Shunt")])],1)],1),n("v-list-item",{key:"branch",on:{click:function(e){return t.$store.commit("setpage","branch")}}},[n("v-list-item-avatar",[n("v-icon",[t._v("linear_scale")])],1),n("v-list-item-content",[n("v-list-item-title",[t._v("Lines")])],1)],1),n("v-list-item",{key:"areastrip",on:{click:function(e){return t.$store.commit("setpage","areastrip")}}},[n("v-list-item-avatar",[n("v-icon",[t._v("linear_scale")])],1),n("v-list-item-content",[n("v-list-item-title",[t._v("Area")])],1)],1),n("v-list-item",{key:"sanddance",on:{click:function(e){return t.$store.commit("setpage","sanddance")}}},[n("v-list-item-avatar",[n("v-icon",[t._v("linear_scale")])],1),n("v-list-item-content",[n("v-list-item-title",[t._v("SandDance")])],1)],1),n("v-list-item",{key:"oneline",on:{click:function(e){return t.$store.commit("setpage","oneline")}}},[n("v-list-item-avatar",[n("v-icon",[t._v("linear_scale")])],1),n("v-list-item-content",[n("v-list-item-title",[t._v("OneLine")])],1)],1),n("v-list-item",{key:"generationVis",on:{click:function(e){return t.$store.commit("setpage","generationVis")}}},[n("v-list-item-avatar",[n("v-icon",[t._v("mdi-chart-bar")])],1),n("v-list-item-content",[n("v-list-item-title",[t._v("Gen. Bar")])],1)],1),n("v-list-item",{key:"generationPie",on:{click:function(e){return t.$store.commit("setpage","generationPie")}}},[n("v-list-item-avatar",[n("v-icon",[t._v("mdi-chart-pie")])],1),n("v-list-item-content",[n("v-list-item-title",[t._v("Gen. Pie")])],1)],1),n("v-list-item",{key:"sysInfo",on:{click:function(e){return t.$store.commit("setpage","sysInfo")}}},[n("v-list-item-avatar",[n("v-icon",[t._v("mdi-file-document-box-multiple")])],1),n("v-list-item-content",[n("v-list-item-title",[t._v("Sys. Info")])],1)],1),n("v-list-item",{key:"chat",on:{click:function(e){t.dialog=!0}}},[n("v-list-item-avatar",[n("v-icon",[t._v("chat")])],1),n("v-list-item-content",[n("v-list-item-title",[t._v("Chat")])],1)],1),n("v-list-item",{key:"start",on:{click:function(e){t.startDialog=!0}}},[n("v-list-item-avatar",[n("v-icon",[t._v("play_arrow")])],1),n("v-list-item-content",[n("v-list-item-title",[t._v("Start")])],1)],1),n("v-list-item",{key:"abort",on:{click:function(e){return t.$store.commit("trigabortsim")}}},[n("v-list-item-avatar",[n("v-icon",[t._v("mdi-stop")])],1),n("v-list-item-content",[n("v-list-item-title",[t._v("Abort")])],1)],1),t.isAdmin?n("v-list-item",{key:"admin",on:{click:function(e){return t.$store.commit("setpage","admin")}}},[n("v-list-item-avatar",[n("v-icon",[t._v("supervisor_account")])],1),n("v-list-item-content",[n("v-list-item-title",[t._v("Admin")])],1)],1):t._e(),n("v-list-item",{key:"report",on:{click:function(e){t.reportDialog=!0}}},[n("v-list-item-avatar",[n("v-icon",[t._v("save_alt")])],1),n("v-list-item-content",[n("v-list-item-title",[t._v("Report")])],1)],1),n("v-spacer"),n("v-list-item",{key:"index"},[n("div",{staticClass:"pl-3 pt-5"},[t._v("RIndex: "+t._s(t.rIndex))])])],1)],1),n("v-main",[t.showToolbar?n("div",{attrs:{id:"step3"}},[n("marquee")],1):t._e(),n("div",{staticClass:"page-wrapper",attrs:{id:"step2"}},[n(t.page,{tag:"component"})],1)]),n("MqttClient"),n("DataProcessing"),n("AGCBot"),t.dialog?n("chatpop",{attrs:{visible:t.dialog},on:{close:function(e){t.dialog=!1}}}):t._e(),t.startDialog?n("startpop",{attrs:{visible:t.startDialog},on:{close:function(e){t.startDialog=!1}}}):t._e(),t.reportDialog?n("reportpop",{attrs:{visible:t.reportDialog},on:{close:function(e){t.reportDialog=!1}}}):t._e()],1)},w=[],x=n("f3f3"),S=(n("d3b7"),n("3ca3"),n("ddb0"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("v-layout",{staticClass:"align-center layout px-4 pt-4 app--page-header",attrs:{row:""}},[n("div",{staticClass:"page-header-left"},[n("h3",{staticClass:"pr-3"},[t._v("Generator")])]),n("v-icon",{attrs:{larg:""}},[t._v("mdi-google-glass")]),n("v-spacer"),n("userInfo")],1),n("v-container",{attrs:{"grid-list-xl":"","text-xs-center":"",fluid:""}},[n("v-layout",{attrs:{row:"",wrap:""}},[n("v-flex",{attrs:{lg8:"",sm8:"",xs12:""}},[n("v-layout",{attrs:{row:"",wrap:""}},[n("v-flex",{attrs:{lg6:"",sm6:"",xs6:""}},[n("chartStatistic",{attrs:{id:"UTC",min:"null",max:"null",left:"13%",title:"Current Cost ($/h)",icon:"attach_money","card-color":"indigo","chart-color":[t.color.indigo.lighten1],costData:t.unitTimeCost,type:"line"}})],1),n("v-flex",{attrs:{lg6:"",sm6:"",xs6:""}},[n("chartStatistic",{attrs:{id:"ATC",min:"null",max:"null",left:"8%",precision:1,title:"Average Total Cost ($/MWh)",icon:"attach_money","card-color":"pink","chart-color":[t.color.pink.darken1,"rgba(255,255,255,0.3)"],costData:+(t.$store.state.totalCost/t.$store.state.totalMWh).toFixed(2),type:"line"}})],1)],1),n("v-layout",{attrs:{row:"",wrap:""}},[n("v-flex",{attrs:{lg12:"",sm12:"",xs12:""}},[n("gentable",{attrs:{title:"Realtime Data"}})],1)],1)],1),n("v-flex",{attrs:{lg4:"",sm4:"",xs12:""}},[n("v-layout",{attrs:{row:"",wrap:""}},[n("v-flex",[n("v-layout",{attrs:{row:"",wrap:""}},[n("v-flex",{attrs:{xs6:"","white--text":""}},[n("div",{staticClass:"text-sm-center primary card"},[n("div",{staticClass:"title pt-4"},[t._v("Total Cost")]),n("span",{staticClass:"title",staticStyle:{color:"white"}},[t._v("$"+t._s(t.totalCost))])])]),n("v-flex",{attrs:{xs6:"","white--text":""}},[n("v-tooltip",{attrs:{top:""},scopedSlots:t._u([{key:"activator",fn:function(e){var r=e.on;return[n("div",t._g({staticClass:"align-center text-sm-center green card"},r),[n("div",{staticClass:"title pt-4"},[t._v("ACE")]),n("span",{staticClass:"title",staticStyle:{color:"white"}},[t._v(t._s(t.ACE.toFixed(2))+"MW")])])]}}])},[n("span",[t._v("The instantaneous difference between a Balancing Authority's net actual and scheduled interchange")])])],1),n("v-flex",{attrs:{xs6:"","white--text":""}},[n("div",{staticClass:"align-center text-sm-center orange card"},[n("div",{staticClass:"title pt-4"},[t._v("Total Generation")]),n("span",{staticClass:"title",staticStyle:{color:"white"}},[t._v(t._s(t.areaData[0])+"MW")])])]),n("v-flex",{attrs:{xs6:"","white--text":""}},[n("div",{staticClass:"align-center text-sm-center pink card"},[n("div",{staticClass:"title pt-4"},[t._v("Total Load")]),n("span",{staticClass:"title",staticStyle:{color:"white"}},[t._v(t._s(t.areaData[2])+"MW")])])])],1)],1),n("v-flex",{attrs:{lg12:"",sm12:"",xs12:""}},[n("v-widget",{attrs:{title:"Power Import Schedule","content-bg":"dark"}},[n("div",{attrs:{slot:"widget-content"},slot:"widget-content"},[n("v-radio-group",{attrs:{mandatory:!1},model:{value:t.schedule,callback:function(e){t.schedule=e},expression:"schedule"}},[n("v-radio",{attrs:{label:"0MW @ $0/MW",value:"0@0"}}),n("v-radio",{attrs:{label:"600MW @ $13/MW",value:"600@13"}}),n("v-radio",{attrs:{label:"800MW @ $18/MW",value:"800@18"}}),n("v-radio",{attrs:{label:"1200MW @ $19/MW",value:"1200@19"}}),n("v-radio",{attrs:{label:"1800MW @ $24/MW",value:"1800@24"}})],1),n("p",[t._v("ACE cost is $100/MW")])],1)])],1),n("v-flex",{attrs:{xs12:""}},[n("m-widget",{attrs:{title:"Load Forecast","content-bg":"dark"}},[n("div",{attrs:{slot:"widget-content"},slot:"widget-content"},[n("loadForecast")],1)])],1),n("v-flex",{attrs:{lg12:"",sm12:"",xs12:""}},[n("v-widget",{attrs:{title:"Area Generation Overview","content-bg":"dark"}},[n("div",{attrs:{slot:"widget-content"},slot:"widget-content"},[n("pie",{attrs:{areatotal:t.areaData[0]}})],1)])],1),n("v-flex",{attrs:{lg12:"",sm12:"",xs12:""}},[n("MapWidget",{attrs:{title:"Location Assist (Gen)",focus:"Gen"}})],1)],1)],1)],1)],1)],1)}),E=[],A=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-card",[n("v-app-bar",{attrs:{flat:"",dense:"",color:"transparent"}},[n("v-toolbar-title",[n("h4",[t._v(t._s(t.title))])]),n("v-spacer"),n("v-toolbar-items",[n("v-menu",{attrs:{bottom:"",right:"","offset-x":""},scopedSlots:t._u([{key:"activator",fn:function(e){var r=e.on;return[n("v-btn",t._g({attrs:{icon:""}},r),[n("v-icon",[t._v("more_vert")])],1),n("v-list",[n("v-list-item",{on:{click:t.toggleALL}},[n("v-list-item-title",[t._v("Toggle all AGC")])],1)],1)]}}])})],1)],1),n("v-divider"),n("v-card-text",{staticClass:"pa-0"},[[n("v-data-table",{staticClass:"fixed-header",attrs:{headers:t.headers,items:t.genData,"items-per-page-options":t.defaultRowItems,"show-select":"","item-key":"name"},scopedSlots:t._u([{key:"item.MWSetpoint",fn:function(e){var r=e.item;return[n("v-edit-dialog",{attrs:{"return-value":r.MWSetpoint,large:"",persistent:""},on:{"update:returnValue":function(e){return t.$set(r,"MWSetpoint",e)},"update:return-value":function(e){return t.$set(r,"MWSetpoint",e)},save:function(e){return t.savemws(r)},open:function(e){return t.openmws(r)},cancel:t.cancel},scopedSlots:t._u([{key:"input",fn:function(){return[n("div",{staticClass:"mt-3 title"},[t._v("Update MW Setpoint")]),n("v-text-field",{attrs:{label:"Edit","single-line":"",autofocus:""},model:{value:t.mws,callback:function(e){t.mws=e},expression:"mws"}})]},proxy:!0}],null,!0)},[n("div",[t._v(t._s(r.MWSetpoint))])])]}},{key:"item.Actions",fn:function(e){var r=e.item;return[n("v-switch",{staticClass:"mt-3",attrs:{disabled:t.disable},nativeOn:{click:function(e){return t.toggle(r)}},model:{value:r.vStatus,callback:function(e){t.$set(r,"vStatus",e)},expression:"item.vStatus"}})]}},{key:"item.AGC",fn:function(e){var r=e.item;return[n("v-switch",{staticClass:"mt-3",attrs:{disabled:!r.Status},model:{value:r.AGC,callback:function(e){t.$set(r,"AGC",e)},expression:"item.AGC"}})]}},{key:"headerCell",fn:function(e){return[n("v-tooltip",{attrs:{bottom:""}},[n("span",{attrs:{slot:"activator"},slot:"activator"},[t._v(" "+t._s(e.header.text)+" ")]),n("span",{staticStyle:{color:"white"}},[t._v(" "+t._s(e.header.text)+" ")])])]}},{key:"items",fn:function(e){return[n("tr",{attrs:{active:e.selected},on:{click:function(t){e.selected=!e.selected}}},[n("td",[n("v-checkbox",{attrs:{"input-value":e.selected,primary:"","hide-details":""}})],1),n("td",{staticClass:"text-xs-left"},[t._v(t._s(e.item.name))]),n("td",{staticClass:"text-xs-left"},[t._v(t._s(e.item.Status))]),n("td",{staticClass:"text-xs-right"},[n("v-chip",{staticClass:"chip",attrs:{label:"",small:"",color:t.getColorByValue(e.item.MW,e.item.MWMax),"text-color":"white"}},[t._v(t._s(e.item.MW))])],1),n("td",{staticClass:"text-xs-center"},[t._v(t._s(e.item.MarginalCost))]),n("td",{staticClass:"text-xs-center"},[t._v(t._s(e.item.OperationCost))]),n("td",{staticClass:"text-xs-center"},[t._v(t._s(e.item.MWMax))])])]}}]),model:{value:t.selected,callback:function(e){t.selected=e},expression:"selected"}}),n("v-snackbar",{attrs:{timeout:3e3,color:t.snackColor},scopedSlots:t._u([{key:"action",fn:function(e){var r=e.attrs;return[n("v-btn",t._b({attrs:{text:""},on:{click:function(e){t.snack=!1}}},"v-btn",r,!1),[t._v(" Close ")])]}}]),model:{value:t.snack,callback:function(e){t.snack=e},expression:"snack"}},[t._v(" "+t._s(t.snackText)+" ")])],n("v-divider")],2)],1)},M=[],C=(n("b64b"),n("18a5"),n("25f0"),n("2f62")),k={props:{title:String},data:function(){return{headers:[{text:"Generator",align:"left",value:"name",width:"10%"},{text:"Status",value:"Status"},{text:"MW",value:"MW"},{text:"Operation Cost",value:"MarginalCost",align:"left"},{text:"Fixed Cost",value:"OperationCost"},{text:"MW Setpoint",value:"MWSetpoint",align:"left"},{text:"MW Max Limit",value:"MWMax"},{text:"Actions",value:"Actions"},{text:"AGC",value:"AGC"}],gens:[],selected:[],anchor:0,genDataLength:0,defaultRowItems:[10,25,{text:"$vuetify.dataIterator.rowsPerPageAll",value:-1}],mws:0,vps:1,switch:!1,snack:!1,snackColor:"",snackText:""}},methods:{preProcess:function(){var t,e,n=0;for(var r in this.$store.state.fieldstore){if(t=this.$store.state.fieldstore[r]["Field"].length,e=Object.keys(this.$store.state.casedetail.content[r]),"Gen"==r)break;n+=t*e.length}this.anchor=n,this.genDataLength=t},initTable:function(){var t,e=[];for(var n in console.log(this.$store.state.casedetail.content.Gen),this.$store.state.casedetail.content.Gen)t=this.$store.state.casedetail.content.Bus[n]["Int.Sub Number"],e.push({value:[this.$store.state.casedetail.content.Substation[t.toString()]["Double.Longitude"],this.$store.state.casedetail.content.Substation[t.toString()]["Double.Latitude"]],key:n,name:n,Status:1,vStatus:!0,MWMax:this.$store.state.casedetail.content.Gen[n]["Single.MW Max Limit"],MWMin:this.$store.state.casedetail.content.Gen[n]["Single.MW Min Limit"],MW:0,Mvar:0,MWSetpoint:0,VpuSetpoint:1,id:this.$store.state.casedetail.content.Gen[n]["String.ID"]});return this.gens=e,this.gens.length>1?Promise.resolve("Table initialized properly"):Promise.reject("Error in initialization")},updateTable:function(){try{var t=this.$store.state.parsedData;for(var e in this.gens)this.gens[e].MW=t[this.anchor+6+e*this.genDataLength],this.gens[e].Mvar=t[this.anchor+7+e*this.genDataLength],this.gens[e].MWSetpoint=t[this.anchor+9+e*this.genDataLength],this.gens[e].VpuSetpoint=t[this.anchor+8+e*this.genDataLength],this.gens[e].Status=t[this.anchor+5+e*this.genDataLength],void 0!=this.$store.state.genAction["Gen"][this.gens[e].key]?this.$store.state.currentTime>=Math.max(this.$store.state.genAction["Gen"][this.gens[e].key])+3&&(this.gens[e].vStatus=1==this.gens[e].Status):this.gens[e].vStatus=1==this.gens[e].Status}catch(n){console.log("The raw data are not ready")}},savemws:function(t){this.snack=!0,this.snackColor="success",this.snackText="New Setpoint Saved",this.mws=Math.min(Math.max(this.mws,0),t.MWMax);var e="Set Power "+this.mws+" MW";this.$store.commit("setMessage",["Gen",t.key+","+t.id,t.key+"#"+t.id,e]),this.$store.commit("setPublish")},openmws:function(t){this.mws=t.MWSetpoint},cancel:function(){this.snack=!0,this.snackColor="error",this.snackText="Canceled"},savevps:function(t){var e="Set Exciter_Setpoint "+this.vps+" pu";this.$store.commit("setMessage",["Gen",t.key+","+t.id,t.key+"#"+t.id,e]),this.$store.commit("setPublish")},openvps:function(t){this.vps=t.VpuSetpoint},toggle:function(t){var e;e=1==t.Status?"OPEN":"CLOSE",this.$store.commit("setMessage",["Gen",t.key+","+t.id,t.key+"#"+t.id,e]),this.$store.commit("recordAction",["Gen",t.key]),this.$store.commit("setPublish")},toggleAGC:function(t){console.log(t)},toggleALL:function(){this.switch=!this.switch,this.$store.commit("toggleALL",this.switch)},getColorByValue:function(t,e){var n="transparent";return t>0&&(t>=e?n="red":t>.9*e&&(n="yellow")),n}},created:function(){},mounted:function(){},computed:Object(x["a"])(Object(x["a"])({},Object(C["c"])(["genData"])),{},{disable:function(){return"running"!=this.$store.state.status}}),watch:{selected:function(t,e){this.$store.commit("updateSelectedGens",t)}}},O=k,P=(n("bbdc"),n("2877")),T=Object(P["a"])(O,A,M,!1,null,"6ae9a62e",null),I=T.exports,N=n("129e"),D=n("b85f"),R=n("12f1"),F=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-card",{attrs:{color:t.cardColor,dark:t.computeCardDark}},[n("v-card-title",[n("div",{staticClass:"layout row ma-0"},[n("div",{staticClass:"headline"},[t._v(t._s(t.title))]),n("v-spacer"),n("div",{staticClass:"subheading"},[t._v("$"+t._s(t.dispData))])],1)]),n("div",{staticClass:"chart",attrs:{id:t.id}})],1)},B=[],j=(n("a9e3"),n("b0c0"),n("b680"),n("313e")),z=n("6612"),U=n.n(z),$={props:{icon:String,title:String,costData:[Number,String],caption:String,value:Number,color:String,id:String,gradient:{type:Boolean,default:!1},cardColor:{type:String,default:"white"},chartColor:Array,min:[String,null],max:[String,null],left:String,precision:{default:0,type:Number}},data:function(){return{chart:null,dataSeries:[],index:0,Process:null}},computed:{computeCardDark:function(){return"white"!==this.cardColor},dispData:function(){return U()(this.costData).format("0,0")}},methods:{initChart:function(){this.chart=j["e"](document.getElementById(this.id));var t=this;this.chart.setOption({tooltip:{trigger:"axis",formatter:function(t){return t[0].name+": "+t[0].value[1]},axisPointer:{animation:!1},confine:!0},xAxis:{show:!1,type:"value",min:"dataMin",max:"dataMax"},yAxis:{show:!0,type:"value",splitLine:{show:!1},min:function(e){return(.99*e.min).toFixed(t.precision)},max:function(e){return(1.01*e.max).toFixed(t.precision)},axisLine:{lineStyle:{color:"rgba(255,255,255,1)"}}},grid:{top:"5%",left:this.left,bottom:"5%",right:"0"},color:this.chartColor,series:[{type:"line",id:"line",name:"line",smooth:!0,data:[]}]})},updateATC:function(){var t=this;this.Process=setInterval((function(){if("running"==t.$store.state.status){var e=new Date;e.getHours(),e.getMinutes(),e.getSeconds();t.dataSeries.push({name:t.index.toString(),value:[t.index,t.costData]}),t.index++,t.dataSeries.length>60&&t.dataSeries.shift(),t.chart.setOption({series:[{data:t.dataSeries}]})}}),1e3)},resizeChart:function(){var t=this;window.addEventListener("resize",(function(){t.chart.resize()}))}},mounted:function(){this.initChart(),this.resizeChart(),this.updateATC()},beforeDestroy:function(){clearInterval(this.Process),this.chart.clear()},watch:{}},V=$,q=(n("b834"),Object(P["a"])(V,F,B,!1,null,null,null)),W=q.exports,G=n("c0a4"),H=n.n(G),X=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"v-widget"}},[n("v-card",[t.enableHeader?n("v-app-bar",{attrs:{color:"transparent",flat:"",dense:""}},[n("v-toolbar-title",[n("h4",[t._v(t._s(t.title))])]),n("v-spacer"),t._t("widget-header-action"),n("v-btn",{attrs:{icon:""},on:{click:t.restore}},[n("v-icon",[t._v("restore")])],1)],2):t._e(),t.enableHeader?n("v-divider"):t._e(),t._t("widget-content"),n("div",{attrs:{id:"container"}},[n("div",{attrs:{id:"lower_map"}}),n("div",{attrs:{id:"upper_map"}})])],2)],1)},Y=[];n("d81d");n("8996");var Z="",K="",J="",Q="",tt={props:{title:{type:String},enableHeader:{type:Boolean,default:!0},contentBg:{type:String,default:"white"},focus:{type:String}},data:function(){return{chart:{},subdata:[],linedata:[],subdetail:[],busdetail:[],mapCenter:[27.4241,-98.4936],map:null}},methods:{initdraw:function(){var t=this,e=[];for(var n in this.transformerDict)e.push([this.transformerDict[n].coords[0][0],this.transformerDict[n].coords[0][1],100]);var r="https://{s}.tile.openstreetmap.fr/hot/{z}/{x}/{y}.png",i={};Z=L.map("lower_map",{center:this.mapCenter,maxZoom:18,zoom:7,attributionControl:!1,zoomControl:!1}),K=L.map("upper_map",{center:this.mapCenter,maxZoom:18,zoom:7,attributionControl:!1,zoomControl:!1}),Z.sync(K),L.tileLayer(r,i).addTo(Z);var o={animation:!1,tooltip:{show:!0,trigger:"item"},visualMap:{show:!1,top:"top",min:50,max:300,seriesIndex:7,calculable:!0,inRange:{color:["#000080","blue","green","yellow","red"]}},series:[{id:"sub",type:"scatter",name:"sub",coordinateSystem:"leaflet",symbol:"circle",symbolSize:function(e,n){return n.data.attributes.Gen&&"Gen"==t.focus?10:n.data.attributes.Shunt&&"Shunt"==t.focus?10:"Load"==t.focus?7:0},z:5,data:this.$store.state.subData,tooltip:{confine:!0,formatter:function(t){return"Substation: "+t.name}},itemStyle:{color:"rgb(200, 40, 0)"}},{id:"lines",name:"lines",type:"lines",coordinateSystem:"leaflet",silent:!1,lineStyle:{width:1,color:function(t){var e;switch(t.data.attributes.volt){case 230:e="#3949ab";break;case 500:e="#e53935";break}return e},opacity:1},tooltip:{confine:!0,formatter:function(t){return"Branch: "+t.name}},emphasis:{lineStyle:{width:2,shadowColor:"rgba(144, 144, 255, 0.5)",shadowBlur:10}},data:this.$store.state.lineData},{id:"vbus",name:"vbus",type:"scatter",coordinateSystem:"leaflet",silent:!1,symbol:"pin",symbolSize:50,itemStyle:{color:"#ff6d00"},label:{show:!0,position:"top",color:"black",formatter:function(t){return void 0!=t.user?t.user+": Bus#"+t.name:"Bus#"+t.name}},data:[]},{id:"shunt",name:"shunt",type:"scatter",coordinateSystem:"leaflet",silent:!1,symbol:"pin",symbolSize:50,itemStyle:{color:"#4caf50"},label:{show:!0,position:"top",color:"black",formatter:function(t){return"Shunt#"+t.name}},data:[]},{id:"violatedLines",name:"violatedLines",type:"lines",coordinateSystem:"leaflet",silent:!0,lineStyle:{width:10,color:"#f44336",shadowColor:"#ccff90",shadowBlur:20,opacity:.5},label:{show:!0,position:"middle",color:"black",formatter:function(t){return"Branch#"+t.name}},data:[]},{id:"gen",name:"gen",type:"scatter",coordinateSystem:"leaflet",silent:!1,symbol:"pin",symbolSize:50,itemStyle:{color:"#1565c0"},label:{show:!0,position:"top",color:"black",formatter:function(t){return"Gen#"+t.name}},data:[]},{id:"load",name:"load",type:"scatter",coordinateSystem:"leaflet",silent:!1,symbol:"pin",symbolSize:50,itemStyle:{color:"#303f9f"},label:{show:!0,position:"top",color:"black",formatter:function(t){return"Load#"+t.name}},data:[]},{id:"heatmap",type:"heatmap",coordinateSystem:"leaflet",data:[],pointSize:10,blurSize:20}]},s={animation:!1,tooltip:{show:!0,trigger:"item"},visualMap:{show:!1,top:"top",min:50,max:300,seriesIndex:7,calculable:!0,inRange:{color:["#000080","blue","green","yellow","red"]}},series:[{id:"violatedLines",name:"violatedLines",type:"lines",coordinateSystem:"leaflet",silent:!0,lineStyle:{width:10,color:"#f44336",shadowColor:"#ccff90",shadowBlur:20,opacity:.5},label:{show:!0,position:"middle",color:"black",formatter:function(t){return"Branch#"+t.name}},data:[]}]},a={loadWhileAnimating:!1,attribution:""};J=L.supermap.echartsLayer(o,a),Q=L.supermap.echartsLayer(s,a);J.addTo(Z),Q.addTo(K)},getData:function(){var t=this.$store.state.casedetail;if("dsmDictionary"==t.content.type){for(var e in this.subdetail=t.content.Substation,this.busdetail=t.content.Bus,this.subdetail)this.subdetail[e].Bus=[];for(var n in t.content.Gen)this.busdetail[n].Gen=t.content.Gen[n];for(var r in t.content.Load)this.busdetail[r].Load=t.content.Load[r];for(var i in t.content.Shunt)this.busdetail[i].Shunt=t.content.Shunt[i];for(var o in t.content.Bus)this.subdetail[t.content.Bus[o]["Int.Sub Number"]].Bus.push(this.busdetail[o])}},onDrawSub:function(){J.setOption({series:[{id:"sub",data:this.subData}]})},onDrawLines:function(){J.setOption({series:[{id:"lines",data:this.lineData}]})},onDrawTransformers:function(){console.log(this.areaDetail),J.setOption({series:[{id:"heatmap",data:[]}]})},restore:function(){Z.flyTo(this.mapCenter,6,{animate:!0,duration:1.5})}},mounted:function(){this.initdraw()},beforeDestroy:function(){try{J.remove(),Z.remove()}catch(t){console.log("The chart instance cannot be cleared")}},computed:Object(x["a"])(Object(x["a"])({},Object(C["c"])(["violatedBuses","selectedShunts","violatedLines","selectedGens","selectedLoads","subData","lineData","areaDetail","transformerDict"])),Object(C["b"])({ViolatedBuses:"getViolatedBuses",SelectedShunts:"getSelectedShunts",ViolatedLines:"getViolatedLines",SelectedGens:"getSelectedGens",SelectedLoads:"getSelectedLoads"})),watch:{ViolatedBuses:function(){var t=J._echartsOptions;t.series[2].data=this.violatedBuses,J.setOption(t)},SelectedShunts:function(){var t=J._echartsOptions;t.series[3].data=this.selectedShunts,J.setOption(t)},ViolatedLines:function(){Q.setOption({series:[{id:"violatedLines",data:this.violatedLines}]})},SelectedGens:function(){var t=J._echartsOptions;t.series[5].data=this.selectedGens,J.setOption(t)},SelectedLoads:function(){var t=J._echartsOptions;t.series[6].data=this.selectedLoads,J.setOption(t)}}},et=tt,nt=(n("e06e"),Object(P["a"])(et,X,Y,!1,null,"39de32cb",null)),rt=nt.exports,it=n("a43b"),ot=n("5372"),st={name:"generator",data:function(){return{color:H.a,radios:this.$store.state.schedule}},components:{gentable:I,VWidget:N["a"],chartStatistic:W,MapWidget:rt,pie:it["a"],MWidget:D["a"],loadForecast:R["a"],userInfo:ot["a"]},computed:Object(x["a"])({},Object(C["c"])(["totalCost","ACE","areaData","unitTimeCost","schedule"])),watch:{radios:function(t,e){this.$store.commit("setSchedule",t),this.$store.commit("addReportUser",{time:this.$store.state.currentTime,event:["Schedule",t]})}}},at=st,ut=(n("fda6"),Object(P["a"])(at,S,E,!1,null,null,null)),ct=ut.exports,lt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("v-layout",{staticClass:"align-center layout px-4 pt-4 app--page-header",attrs:{row:""}},[n("div",{staticClass:"page-header-left"},[n("h3",{staticClass:"pr-3"},[t._v("Load")])]),n("v-icon",{attrs:{larg:""}},[t._v("mdi-lightbulb")]),n("v-spacer"),n("userInfo")],1),n("v-container",{attrs:{"grid-list-xl":"","text-xs-center":"",fluid:""}},[n("v-layout",{attrs:{row:"",wrap:""}},[n("v-flex",{attrs:{lg8:"",sm12:"",xs12:""}},[n("loadtable",{attrs:{title:"Realtime Data"}})],1),n("v-flex",{attrs:{lg4:"",sm12:"",xs12:""}},[n("v-layout",{attrs:{row:"",wrap:""}},[n("v-flex",{attrs:{lg12:"",sm12:"",xs12:""}},[n("v-flex",{attrs:{lg12:"",sm12:"",xs12:""}},[n("MapWidget",{attrs:{title:"Location Assist (Load)",focus:"Load"}})],1)],1),n("v-flex",{attrs:{lg12:"",sm12:"",xs12:""}},[n("v-widget",{attrs:{title:"Tool2","content-bg":"dark"}},[n("div",{staticClass:"cardiv",attrs:{slot:"widget-content"},slot:"widget-content"},[n("v-card",{attrs:{dark:"",color:"light-blue"}},[n("v-card-text",{staticClass:"px-0"},[t._v("Tool2")])],1)],1)])],1)],1)],1)],1)],1)],1)},ht=[],ft=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-card",[n("v-app-bar",{attrs:{flat:"",dense:"",color:"transparent"}},[n("v-toolbar-title",[n("h4",[t._v(t._s(t.title))])]),n("v-spacer"),n("v-btn",{attrs:{icon:""}},[n("v-icon",[t._v("more_vert")])],1)],1),n("v-divider"),n("v-card-text",{staticClass:"pa-0"},[[n("v-data-table",{attrs:{headers:t.headers,items:t.loads,"items-per-page-options":t.defaultRowItems,"show-select":"","item-key":"name"},scopedSlots:t._u([{key:"item.Actions",fn:function(e){var r=e.item;return[n("v-switch",{staticClass:"mt-3",attrs:{disabled:t.disable},nativeOn:{click:function(e){return t.toggle(r)}},model:{value:r.vStatus,callback:function(e){t.$set(r,"vStatus",e)},expression:"item.vStatus"}})]}},{key:"items",fn:function(e){return[n("tr",{attrs:{active:e.selected},on:{click:function(t){e.selected=!e.selected}}},[n("td",[n("v-checkbox",{attrs:{"input-value":e.selected,primary:"","hide-details":""}})],1),n("td",{staticClass:"text-xs-left"},[t._v(t._s(e.item.name))]),n("td",{staticClass:"text-xs-left"},[t._v(t._s(e.item.Status))]),n("td",{staticClass:"text-xs-center"},[t._v(t._s(e.item.MW))]),n("td",{staticClass:"text-xs-center"},[t._v(t._s(e.item.Mvar))]),n("td",{staticClass:"text-xs-center"},[t._v(t._s(e.item.Vpu))]),n("td",{staticClass:"text-xs-center"},[t._v(t._s(e.item.FreqHz))])])]}}]),model:{value:t.selected,callback:function(e){t.selected=e},expression:"selected"}})],n("v-divider")],2)],1)},dt=[],pt=(n("dca8"),n("ac1f"),n("1276"),{props:{title:String},data:function(){return{headers:Object.freeze([{text:"Load",align:"left",value:"name"},{text:"Status",value:"Status"},{text:"MW",value:"MW"},{text:"Mvar",value:"Mvar"},{text:"Vpu",value:"Vpu"},{text:"FreqHz",value:"FreqHz"},{text:"Actions",value:"Actions",sortable:!1}]),selected:[],anchor:0,loadDataLength:0,defaultRowItems:[15,30,{text:"$vuetify.dataIterator.rowsPerPageAll",value:-1}],loadArray:[],loads:[],Interval:null}},methods:{preProcess:function(){var t,e,n=0;for(var r in this.fieldstore){if(t=this.fieldstore[r]["Field"].length,e=Object.keys(this.areadetail.content[r]),"Load"==r)break;n+=t*e.length}this.anchor=n,this.loadDataLength=t},initTable:function(){var t,e=[],n=0;for(var r in this.areadetail.content.Load)this.areadetail.content.Load[r]["Int.Area Number"]==+this.area&&(this.loadArray.push(n),t=this.areadetail.content.Bus[r.split(",")[0]]["Int.Sub Number"],e.push({value:[this.areadetail.content.Substation[t.toString()]["Double.Longitude"],this.areadetail.content.Substation[t.toString()]["Double.Latitude"]],key_cmd:r,name:Object.freeze(this.areadetail.content.Bus[r.split(",")[0]]["String.Name"]+" "+r.split(",")[1]),Status:1,vStatus:!0,MW:0,Mvar:0,Vpu:1,FreqHz:60,id_cmd:Object.freeze(this.areadetail.content.Load[r]["String.ID"])})),n++;return this.loads=e,this.loads.length>1?Promise.resolve("Table initialized properly"):Promise.reject("Error in initialization")},updateTable:function(){var t=this;this.Interval=setInterval((function(){try{var e=t.parsedData;for(var n in t.loads)t.loads[n].MW=e[t.anchor+6+t.loadArray[n]*t.loadDataLength],t.loads[n].Mvar=e[t.anchor+7+t.loadArray[n]*t.loadDataLength],t.loads[n].Vpu=e[t.anchor+t.loadArray[n]*t.loadDataLength],t.loads[n].FreqHz=e[t.anchor+3+t.loadArray[n]*t.loadDataLength],t.loads[n].Status=e[t.anchor+5+t.loadArray[n]*t.loadDataLength],void 0!=t.genAction["Load"][t.loads[n].key_cmd]?t.currentTime>=Math.max(t.genAction["Load"][t.loads[n].key_cmd])+3&&(t.loads[n].vStatus=1==t.loads[n].Status):t.loads[n].vStatus=1==t.loads[n].Status}catch(r){console.log("The raw data are not ready")}}),500)},toggle:function(t){var e;e=1==t.Status?"OPEN":"CLOSE",this.$store.commit("setMessage",["Load",t.key_cmd+","+t.id_cmd,t.key_cmd+"#"+t.id_cmd,e]),this.$store.commit("recordAction",["Load",t.key_cmd]),this.$store.commit("setPublish")}},created:function(){this.loads=[],this.preProcess()},mounted:function(){var t=this;this.initTable().then((function(){return t.updateTable()}))},computed:Object(x["a"])(Object(x["a"])({},Object(C["c"])(["fieldstore","areadetail","area","parsedData","genAction","currentTime","status"])),{},{disable:function(){return"running"!=this.status}}),watch:{selected:function(t,e){this.$store.commit("updateSelectedLoads",t)}},beforeDestroy:function(){clearInterval(this.Interval)}}),gt=pt,mt=(n("65f3"),Object(P["a"])(gt,ft,dt,!1,null,"1ab925e6",null)),yt=mt.exports,vt={name:"generator",components:{loadtable:yt,VWidget:N["a"],MapWidget:rt,userInfo:ot["a"]}},bt=vt,_t=(n("6a1a"),Object(P["a"])(bt,lt,ht,!1,null,null,null)),wt=_t.exports,xt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("v-layout",{staticClass:"align-center layout px-4 pt-4 app--page-header",attrs:{row:""}},[n("div",{staticClass:"page-header-left"},[n("h3",{staticClass:"pr-3"},[t._v("Shunt")])]),n("v-icon",{attrs:{larg:""}},[t._v("mdi-currency-usd")]),n("v-spacer"),n("userInfo")],1),n("v-container",{attrs:{"grid-list-xl":"","text-xs-center":"",fluid:""}},[n("v-layout",{attrs:{row:"",wrap:""}},[n("v-flex",{attrs:{lg8:"",sm12:"",xs12:""}},[n("shunttable",{attrs:{title:"Realtime Data"}})],1),n("v-flex",{attrs:{lg4:"",sm12:"",xs12:""}},[n("v-layout",{attrs:{row:"",wrap:""}},[n("v-flex",{attrs:{lg12:"",sm12:"",xs12:""}},[n("MapWidget",{attrs:{title:"Location Assist (Shunt)",focus:"Shunt"}})],1),n("v-flex",{attrs:{lg12:"",sm12:"",xs12:""}},[n("bustable",{attrs:{title:"Violating Buses"}})],1)],1)],1)],1)],1)],1)},St=[],Et=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-card",[n("v-app-bar",{attrs:{flat:"",dense:"",color:"transparent"}},[n("v-toolbar-title",[n("h4",[t._v(t._s(t.title))])]),n("v-spacer"),n("v-btn",{attrs:{icon:""}},[n("v-icon",[t._v("more_vert")])],1)],1),n("v-divider"),n("v-card-text",{staticClass:"pa-0"},[[n("v-data-table",{attrs:{headers:t.headers,items:t.shunts,"items-per-page-options":t.defaultRowItems,"show-select":"","item-key":"name"},scopedSlots:t._u([{key:"item.Actions",fn:function(e){var r=e.item;return[n("v-switch",{staticClass:"mt-3",attrs:{disabled:t.disable},nativeOn:{click:function(e){return t.toggle(r)}},model:{value:r.vStatus,callback:function(e){t.$set(r,"vStatus",e)},expression:"item.vStatus"}})]}},{key:"headerCell",fn:function(e){return[n("v-tooltip",{attrs:{bottom:""}},[n("span",{attrs:{slot:"activator"},slot:"activator"},[t._v(t._s(e.header.text))]),n("span",{staticStyle:{color:"white"}},[t._v(t._s(e.header.text))])])]}},{key:"items",fn:function(e){return[n("tr",{attrs:{active:e.selected},on:{click:function(t){e.selected=!e.selected}}},[n("td",[n("v-checkbox",{attrs:{"input-value":e.selected,primary:"","hide-details":""}})],1),n("td",{staticClass:"text-xs-left"},[t._v(t._s(e.item.name))]),n("td",{staticClass:"text-xs-left"},[t._v(t._s(e.item.Status))]),n("td",{staticClass:"text-xs-right"},[t._v(t._s(e.item.Mvar))]),n("td",{staticClass:"text-xs-right"},[t._v(t._s(e.item.Vpu))]),n("td",{staticClass:"text-xs-right"},[t._v(t._s(e.item.FreqHz))])])]}}]),model:{value:t.selected,callback:function(e){t.selected=e},expression:"selected"}})],n("v-divider")],2)],1)},At=[],Mt={props:{title:String},data:function(){return{headers:[{text:"Shunt",align:"left",value:"name"},{text:"Status",value:"Status",align:"left"},{text:"Mvar",value:"Mvar",align:"right"},{text:"Vpu",value:"Vpu",align:"right"},{text:"FreqHz",value:"FreqHz",align:"right"},{text:"Actions",value:"Actions",sortable:!1,align:"right"}],shunts:[],selected:[],anchor:0,shuntDataLength:0,defaultRowItems:[15,30,{text:"$vuetify.dataIterator.rowsPerPageAll",value:-1}],shuntArray:[],Interval:null}},methods:{preProcess:function(){var t,e,n=0;for(var r in this.$store.state.fieldstore){if(t=this.$store.state.fieldstore[r]["Field"].length,e=Object.keys(this.$store.state.areadetail.content[r]),"Shunt"==r)break;n+=t*e.length}this.anchor=n,this.shuntDataLength=t},initTable:function(){var t,e=[],n=0;for(var r in this.$store.state.areadetail.content.Shunt)this.$store.state.areadetail.content.Shunt[r]["Int.Area Number"]==+this.$store.state.area&&(this.shuntArray.push(n),t=this.$store.state.areadetail.content.Bus[r.split(",")[0]]["Int.Sub Number"],e.push({value:[this.$store.state.areadetail.content.Substation[t.toString()]["Double.Longitude"],this.$store.state.areadetail.content.Substation[t.toString()]["Double.Latitude"]],key_cmd:r,name:this.$store.state.areadetail.content.Bus[r.split(",")[0]]["String.Name"],Status:1,vStatus:!0,Mvar:0,Vpu:1,FreqHz:60,id_cmd:this.$store.state.areadetail.content.Shunt[r]["String.ID"]})),n++;return this.shunts=e,this.shunts.length>1?Promise.resolve("Table initialized properly"):Promise.reject("Error in initialization")},updateTable:function(){var t=this;this.Interval=setInterval((function(){try{var e=t.$store.state.parsedData;for(var n in t.shunts)t.shunts[n].Mvar=e[t.anchor+6+t.shuntArray[n]*t.shuntDataLength],t.shunts[n].Vpu=e[t.anchor+t.shuntArray[n]*t.shuntDataLength],t.shunts[n].FreqHz=e[t.anchor+3+t.shuntArray[n]*t.shuntDataLength],t.shunts[n].Status=e[t.anchor+5+t.shuntArray[n]*t.shuntDataLength],void 0!=t.$store.state.genAction["Shunt"][t.shunts[n].key_cmd]?t.$store.state.currentTime>=Math.max(t.$store.state.genAction["Shunt"][t.shunts[n].key_cmd])+3&&(t.shunts[n].vStatus=1==t.shunts[n].Status):t.shunts[n].vStatus=1==t.shunts[n].Status}catch(r){console.log("The raw data are not ready")}}),500)},toggle:function(t){var e;e=1==t.Status?"OPEN":"CLOSE",this.$store.commit("setMessage",["Shunt",t.key_cmd+","+t.id_cmd,t.key_cmd+"#"+t.id_cmd,e]),this.$store.commit("recordAction",["Shunt",t.key_cmd]),this.$store.commit("setPublish")}},created:function(){this.preProcess()},mounted:function(){var t=this;this.initTable().then((function(){return t.updateTable()}))},watch:{selected:function(t,e){this.$store.commit("updateSelectedShunts",t)}},computed:{disable:function(){return"running"!=this.$store.state.status}},beforeDestroy:function(){clearInterval(this.Interval)}},Ct=Mt,kt=(n("2f5d"),Object(P["a"])(Ct,Et,At,!1,null,"eccb8312",null)),Ot=kt.exports,Pt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-card",[n("v-app-bar",{attrs:{flat:"",dense:"",color:"transparent"}},[n("v-toolbar-title",[n("h4",[t._v(t._s(t.title))])]),n("v-spacer"),n("v-btn",{attrs:{icon:""}},[n("v-icon",[t._v("more_vert")])],1)],1),n("v-divider"),n("v-card-text",{staticClass:"pa-0"},[[n("v-data-table",{attrs:{headers:t.headers,items:t.riskBuses,"items-per-page-options":t.defaultRowItems,"show-select":"","item-key":"name"},scopedSlots:t._u([{key:"headerCell",fn:function(e){return[n("v-tooltip",{attrs:{bottom:""}},[n("span",{attrs:{slot:"activator"},slot:"activator"},[t._v(" "+t._s(e.header.text)+" ")]),n("span",[t._v(" "+t._s(e.header.text)+" ")])])]}},{key:"item.Vpu",fn:function(e){var r=e.item;return[n("v-chip",{attrs:{label:"",small:"",color:t.getColorByValue(r.Vpu),"text-color":"white"}},[t._v(t._s(r.Vpu))])]}},{key:"items",fn:function(e){return[n("tr",{attrs:{active:e.selected},on:{click:function(t){e.selected=!e.selected}}},[n("td",[n("v-checkbox",{attrs:{"input-value":e.selected,primary:"","hide-details":""}})],1),n("td",{staticClass:"text-xs-left"},[t._v(t._s(e.item.name))]),n("td",{staticClass:"text-xs-right"},[t._v(t._s(e.item.Max))]),n("td",{staticClass:"text-xs-right"},[t._v(t._s(e.item.Min))])])]}}]),model:{value:t.selected,callback:function(e){t.selected=e},expression:"selected"}},[n("template",{slot:"no-data"},[n("v-card",{attrs:{dark:"",color:"success"}},[n("v-card-text",[t._v(" Currently no violating buses! ")])],1)],1)],2)],n("v-divider")],2)],1)},Tt=[],Lt=n("d0af"),It=(n("07ac"),n("cb29"),n("fb6a"),n("4fad"),{props:{data:Array,title:String},data:function(){return{headers:[{text:"Bus",align:"left",value:"name"},{text:"Vpu",value:"Vpu"},{text:"Max",value:"Max"},{text:"Min",value:"Min"}],buses:[],formatRiskBuses:[],anchor:0,dataLength:0,arrLength:0,violateBuses:[],selected:[],defaultRowItems:[10,30,{text:"$vuetify.dataIterator.rowsPerPageAll",value:-1}]}},computed:Object(x["a"])({},Object(C["c"])(["riskBuses"])),methods:{initMonitor:function(){var t,e,n;for(var r in this.$store.state.fieldstore){if(t=this.$store.state.fieldstore[r]["Field"].length,e=Object.keys(this.$store.state.casedetail.content[r]),n=Object.values(this.$store.state.fieldstore[r]),"Bus"==r){this.dataLength=t*e.length,this.statusIndex=n.indexOf("Status"),this.mwfromIndex=n.indexOf("MWFrom"),this.arrLength=t;break}this.anchor+=t*e.length}this.statusArray=Array(e.length).fill(1)},onMonitor:function(){for(var t=this.$store.getters.rawData,e=t.slice(this.anchor,this.anchor+this.dataLength),n=0,r=0,i=Object.entries(this.$store.state.casedetail.content.Bus);r<i.length;r++){var o=Object(Lt["a"])(i[r],2),s=o[0],a=o[1];e[n]<=a["Single.Max Limit"]||e[n]>=a["Single.Min Limit"]?(this.violateBuses[s]={},this.violateBuses[s]["name"]=s,this.violateBuses[s]["Vpu"]=e[n],this.violateBuses[s]["Max"]=a["Single.Min Limit"],this.violateBuses[s]["Min"]=a["Single.Max Limit"],this.violateBuses[s]["SubID"]=a["Int.Sub Number"],this.violateBuses[s]["value"]=[this.$store.state.casedetail.content.Substation[a["Int.Sub Number"].toString()]["Double.Longitude"],this.$store.state.casedetail.content.Substation[a["Int.Sub Number"].toString()]["Double.Latitude"]]):s in this.violateBuses&&delete this.violateBuses[s],n+=this.arrLength}this.formatRiskBuses=Object.values(this.violateBuses)},getColorByValue:function(t){var e;return t>=1.1?e="red":t<.9&&(e="blue"),e},toggleAll:function(){this.selected.length?this.selected=[]:this.selected=this.desserts.slice()}},created:function(){},mounted:function(){},watch:{selected:function(t,e){this.$store.commit("updateVBuses",t)},data:function(t,e){this.data.length>0?this.$store.commit("triggerAlarm","Bus"):this.$store.commit("dismissAlarm","Bus")}}}),Nt=It,Dt=(n("a814"),Object(P["a"])(Nt,Pt,Tt,!1,null,null,null)),Rt=Dt.exports,Ft={name:"generator",components:{shunttable:Ot,VWidget:N["a"],bustable:Rt,MapWidget:rt,userInfo:ot["a"]}},Bt=Ft,jt=(n("6441"),Object(P["a"])(Bt,xt,St,!1,null,null,null)),zt=jt.exports,Ut=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div")},$t=[],Vt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[t._v(t._s(t.info))])},qt=[],Wt=(n("9911"),n("bc3a")),Gt=n.n(Wt),Ht={name:"ApiClient",props:{link:String,interval:{type:Number,default:0}},data:function(){return{info:null}},created:function(){var t=this;if(0==this.interval){this.link;Gt()({method:"GET",url:this.link,withCredentials:!0,auth:{username:"b18f956b3ad8d",password:"Mjg0MDE4MjAyNjA3MjUwMzUxNTcxNjkyNTkxMjgyMjU3OTC"}}).then((function(e){return t.info=e}))}else setInterval((function(){Gt.a.get(t.link,{},{headers:{Authorization:"Basic YjE4Zjk1NmIzYWQ4ZDpNamcwTURFNE1qQXlOakEzTWpVd016VXhOVGN4TmpreU5Ua3hNamd5TWpVM09UQw=="},withCredentials:!0,auth:{username:"b18f956b3ad8d",password:"Mjg0MDE4MjAyNjA3MjUwMzUxNTcxNjkyNTkxMjgyMjU3OTC"}}).then((function(e){return t.info=e}))}),this.interval)}},Xt=Ht,Yt=Object(P["a"])(Xt,Vt,qt,!1,null,"ff37953e",null),Zt=Yt.exports,Kt={name:"admin",data:function(){return{}},components:{ApiClient:Zt}},Jt=Kt,Qt=(n("53c7"),Object(P["a"])(Jt,Ut,$t,!1,null,null,null)),te=Qt.exports,ee=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("v-layout",{staticClass:"align-center layout px-4 pt-4 app--page-header",attrs:{row:""}},[n("div",{staticClass:"page-header-left"},[n("h3",{staticClass:"pr-3"},[t._v("Branch")])]),n("v-icon",{attrs:{larg:""}},[t._v("mdi-currency-usd")]),n("v-spacer"),n("userInfo")],1),n("v-container",{attrs:{"grid-list-xl":"","text-xs-center":"",fluid:""}},[n("v-layout",{attrs:{row:"",wrap:""}},[n("v-flex",{attrs:{lg8:"",sm12:"",xs12:""}},[n("branchtable",{attrs:{title:"Realtime Data"}})],1),n("v-flex",{attrs:{lg4:"",sm12:"",xs12:""}},[n("v-layout",{attrs:{row:"",wrap:""}},[n("v-flex",{attrs:{lg12:"",sm12:"",xs12:""}},[n("MapWidget",{attrs:{title:"Location Assist"}})],1),n("v-flex",{attrs:{lg12:"",sm12:"",xs12:""}},[n("v-widget",{attrs:{title:"GMD","content-bg":"dark"}},[n("div",{attrs:{slot:"widget-header-action"},slot:"widget-header-action"},[n("v-switch",{staticClass:"mt-3",model:{value:t.GMDSwitch,callback:function(e){t.GMDSwitch=e},expression:"GMDSwitch"}})],1),n("div",{attrs:{slot:"widget-content"},slot:"widget-content"},[n("v-card",{attrs:{flat:"",color:"transparent"}},[n("v-card-title",[t._v("Johnsonville - Nashville")]),n("v-subheader",[t._v(t._s(t.lapse))]),n("v-card-text",[n("v-layout",{attrs:{row:""}},[n("v-flex",{attrs:{sm9:""}},[n("v-slider",{attrs:{max:t.max,min:t.min},model:{value:t.slider,callback:function(e){t.slider=e},expression:"slider"}})],1),n("v-flex",{attrs:{sm3:""}},[n("v-text-field",{staticClass:"mt-0",attrs:{suffix:"s","hide-details":"","single-line":"",type:"number"},model:{value:t.slider,callback:function(e){t.slider=e},expression:"slider"}})],1)],1)],1)],1)],1)])],1),n("v-flex",{attrs:{lg12:"",sm12:"",xs12:""}},[n("bustable",{attrs:{title:"Violating Buses"}})],1)],1)],1)],1)],1)],1)},ne=[],re=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-card",[n("v-app-bar",{attrs:{flat:"",dense:"",color:"transparent"}},[n("v-toolbar-title",[n("h4",[t._v(t._s(t.title))])]),n("v-spacer"),n("v-btn",{attrs:{icon:""}},[n("v-icon",[t._v("more_vert")])],1)],1),n("v-divider"),n("v-card-text",{staticClass:"pa-0"},[[n("v-data-table",{staticClass:"fixed-header",attrs:{headers:t.headers,items:t.branches,"items-per-page-options":t.defaultRowItems,"show-select":"","item-key":"name"},scopedSlots:t._u([{key:"item.Actions",fn:function(e){var r=e.item;return[n("v-switch",{staticClass:"mt-3",attrs:{disabled:t.disable},nativeOn:{click:function(e){return t.toggle(r)}},model:{value:r.vStatus,callback:function(e){t.$set(r,"vStatus",e)},expression:"item.vStatus"}})]}},{key:"headerCell",fn:function(e){return[n("span",{attrs:{slot:"activator"},slot:"activator"},[t._v(t._s(e.header.text))])]}},{key:"items",fn:function(e){return[n("tr",{attrs:{active:e.selected},on:{click:function(t){e.selected=!e.selected}}},[n("td",[n("v-checkbox",{attrs:{"input-value":e.selected,primary:"","hide-details":""}})],1),n("td",{staticClass:"text-xs-left"},[t._v(t._s(e.item.name))]),n("td",{staticClass:"text-xs-left"},[t._v(t._s(e.item.vStatus))]),n("td",{staticClass:"text-xs-right"},[t._v(t._s(e.item.MWFrom))]),n("td",{staticClass:"text-xs-right"},[t._v(t._s(e.item.MvarFrom))]),n("td",{staticClass:"text-xs-right"},[t._v(t._s(e.item.MVAFrom))]),n("td",{staticClass:"text-xs-right"},[t._v(t._s(e.item.AmpsFrom))]),n("td",{staticClass:"text-xs-right"},[t._v(t._s(e.item.MVALimit))])])]}}]),model:{value:t.selected,callback:function(e){t.selected=e},expression:"selected"}})],n("v-divider")],2)],1)},ie=[],oe=(n("caad"),n("2532"),{props:{title:String},data:function(){return{headers:[{text:"Branch",align:"left",value:"name",width:"15%"},{text:"Status",value:"Status"},{text:"MWFrom",value:"MWFrom"},{text:"MvarFrom",value:"MvarFrom"},{text:"MVAFrom",value:"MVAFrom"},{text:"AmpsFrom",value:"AmpsFrom"},{text:"MVA Limit",value:"MVALimit"},{text:"Actions",value:"Actions",sortable:!1}],branches:[],selected:[],anchor:0,branchDataLength:0,defaultRowItems:[15,30,{text:"$vuetify.dataIterator.rowsPerPageAll",value:-1}],branchArray:this.$store.state.areaHelper.Branch.list,Interval:null}},methods:{preProcess:function(){var t,e,n=0;for(var r in this.$store.state.fieldstore){if(t=this.$store.state.fieldstore[r]["Field"].length,e=Object.keys(this.$store.state.areadetail.content[r]),"Branch"==r)break;n+=t*e.length}this.anchor=n,this.branchDataLength=t},initTable:function(){var t=[];for(var e in this.anchor=this.$store.state.areaHelper.Branch.anchor,this.branchDataLength=this.$store.state.areaHelper.Branch.length,this.$store.state.areadetail.content.Branch)[this.$store.state.areadetail.content.Branch[e]["FromArea"],this.$store.state.areadetail.content.Branch[e]["ToArea"]].includes(+this.$store.state.area)&&t.push({value:!1,key:e,name:this.$store.state.casedetail.content.Bus[e.split(",")[0]]["String.Name"]+"-"+this.$store.state.casedetail.content.Bus[e.split(",")[1]]["String.Name"],id:this.$store.state.areadetail.content.Branch[e]["String.CircuitID"],Status:1,vStatus:1,MWFrom:0,MvarFrom:0,MVAFrom:0,AmpsFrom:0,MWTo:0,MvarTo:0,MVATo:0,AmpsTo:0,MVALimit:this.$store.state.areadetail.content.Branch[e]["Single.MVA Limit"]});return this.branches=t,this.branches.length>1?Promise.resolve("Table initialized properly"):Promise.reject("Error in initialization")},updateTable:function(){var t=this;this.Interval=setInterval((function(){try{for(var e in t.branches)t.branches[e].Status=t.$store.state.branchData[0+e*t.branchDataLength],t.branches[e].MWFrom=t.$store.state.branchData[1+e*t.branchDataLength],t.branches[e].MvarFrom=t.$store.state.branchData[2+e*t.branchDataLength],t.branches[e].MVAFrom=t.$store.state.branchData[3+e*t.branchDataLength],t.branches[e].AmpsFrom=t.$store.state.branchData[4+e*t.branchDataLength],t.branches[e].MWTo=t.$store.state.branchData[5+e*t.branchDataLength],t.branches[e].MvarTo=t.$store.state.branchData[6+e*t.branchDataLength],t.branches[e].MVATo=t.$store.state.branchData[7+e*t.branchDataLength],t.branches[e].AmpsTo=t.$store.state.branchData[8+e*t.branchDataLength],void 0!=t.$store.state.genAction["Branch"][t.branches[e].key]?t.$store.state.currentTime>=Math.max(t.$store.state.genAction["Branch"][t.branches[e].key])+3&&(t.branches[e].vStatus=t.branches[e].Status):t.branches[e].vStatus=t.branches[e].Status}catch(n){console.log("The raw data are not ready")}}),500)},toggle:function(t){var e;t.vStatus?(t.vStatus=1,e="CLOSE BOTH"):(t.vStatus=0,e="OPEN BOTH"),this.$store.commit("setMessage",["Branch",t.key,t.key,e]),this.$store.commit("recordAction",["Branch",t.key]),this.$store.commit("setPublish")}},created:function(){},mounted:function(){var t=this;this.initTable().then((function(){return t.updateTable()}))},watch:{selected:function(t,e){this.$store.commit("updateSelectedShunts",t)}},computed:{disable:function(){return"running"!=this.$store.state.status}},beforeDestroy:function(){clearInterval(this.Interval)}}),se=oe,ae=(n("022f"),Object(P["a"])(se,re,ie,!1,null,"5c599dda",null)),ue=ae.exports,ce={name:"branch",data:function(){return{min:0,max:250,slider:this.$store.state.slider,triggered:!1,GMDSwitch:!1}},components:{branchtable:ue,VWidget:N["a"],bustable:Rt,MapWidget:rt,userInfo:ot["a"]},computed:Object(x["a"])(Object(x["a"])({},Object(C["c"])(["lapse"])),Object(C["b"])({timelapse:"getLapse"})),watch:{timelapse:function(){this.$store.state.lapse<+this.slider&&this.triggered&&(this.triggered=!1),this.$store.state.lapse>=+this.slider&&!this.triggered&&this.GMDSwitch&&(this.$store.commit("setMessage",["Branch","144,101,1","Johnsonville - Nashville","OPEN BOTH"]),this.$store.commit("setPublish"),this.triggered=!0)}}},le=ce,he=(n("f9e5"),Object(P["a"])(le,ee,ne,!1,null,null,null)),fe=he.exports,de=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("v-chart",{attrs:{options:t.option,theme:"dark",autoresize:!0}})],1)},pe=[],ge=n("fc11"),me={data:function(){var t,e;return{option:{title:[{text:"System Area Load",textAlign:"center",top:20,x:"25%",textStyle:{fontSize:44}},{text:"Hourly Area Load",textAlign:"center",top:20,x:"75%",textStyle:{fontSize:44}},{text:"Bus Voltage",left:"center",top:"55%",textStyle:{fontSize:44}}],legend:{top:"bottom",textStyle:{fontSize:20},data:["4195","4146","4056","4181","4192","4039","4151","4196","4073","4070","4158","4140","4113","4080","4004","4183","4041"]},grid:[{left:"3%",top:80,bottom:"55%",width:"45%"},{right:"3%",top:80,bottom:"55%",width:"45%"},{left:"3%",right:"3%",top:"60%"}],xAxis:[{type:"time",boundaryGap:!1,axisLine:{show:!1}},{type:"time",boundaryGap:!1,axisLine:{show:!1},gridIndex:1},{type:"time",boundaryGap:!1,axisLine:{show:!1},gridIndex:2}],yAxis:[{type:"value",boundaryGap:!1,axisLine:{show:!1}},{type:"value",boundaryGap:!1,axisLine:{show:!1},gridIndex:1},{type:"value",boundaryGap:!1,axisLine:{show:!1},min:0,max:1.2,gridIndex:2}],tooltip:{trigger:"axis"},animation:!1,dataset:{dimensions:["date","4195","4146","4056","4181","4192","4039","4151","4196","4073","4070","4158","4140","4113","4080","4004","4183","4041"],source:[]},series:[(t={type:"line",id:"area",name:"Actual Load",showSymbol:!1,sampling:"average",itemStyle:{color:"rgb(255, 158, 68)"},lineStyle:{type:"solid"}},Object(ge["a"])(t,"sampling","average"),Object(ge["a"])(t,"data",[]),t),(e={type:"line",id:"hourly",name:"Hourly Load",showSymbol:!1,smooth:!0,sampling:"average",itemStyle:{color:"rgb(255, 100, 100)"},lineStyle:{type:"solid"}},Object(ge["a"])(e,"sampling","average"),Object(ge["a"])(e,"data",[]),Object(ge["a"])(e,"xAxisIndex",1),Object(ge["a"])(e,"yAxisIndex",1),e),{type:"line",name:"4195",sampling:"average",smooth:!0,showSymbol:!1,encode:{x:"date",y:"4195"},xAxisIndex:2,yAxisIndex:2,markLine:{silent:!0,symbol:"none",label:{show:!1},data:[{yAxis:.9},{yAxis:1.05}]}},{type:"line",name:"4146",sampling:"average",smooth:!0,showSymbol:!1,encode:{x:"date",y:"4146"},xAxisIndex:2,yAxisIndex:2},{type:"line",name:"4056",sampling:"average",smooth:!0,showSymbol:!1,encode:{x:"date",y:"4056"},xAxisIndex:2,yAxisIndex:2},{type:"line",name:"4181",sampling:"average",smooth:!0,showSymbol:!1,encode:{x:"date",y:"4181"},xAxisIndex:2,yAxisIndex:2},{type:"line",name:"4192",sampling:"average",smooth:!0,showSymbol:!1,encode:{x:"date",y:"4192"},xAxisIndex:2,yAxisIndex:2},{type:"line",name:"4039",sampling:"average",smooth:!0,showSymbol:!1,encode:{x:"date",y:"4039"},xAxisIndex:2,yAxisIndex:2},{type:"line",name:"4151",sampling:"average",smooth:!0,showSymbol:!1,encode:{x:"date",y:"4151"},xAxisIndex:2,yAxisIndex:2},{type:"line",name:"4196",sampling:"average",smooth:!0,showSymbol:!1,encode:{x:"date",y:"4196"},xAxisIndex:2,yAxisIndex:2},{type:"line",name:"4073",sampling:"average",smooth:!0,showSymbol:!1,encode:{x:"date",y:"4073"},xAxisIndex:2,yAxisIndex:2},{type:"line",name:"4070",sampling:"average",smooth:!0,showSymbol:!1,encode:{x:"date",y:"4070"},xAxisIndex:2,yAxisIndex:2},{type:"line",name:"4158",sampling:"average",smooth:!0,showSymbol:!1,encode:{x:"date",y:"4158"},xAxisIndex:2,yAxisIndex:2},{type:"line",name:"4140",sampling:"average",smooth:!0,showSymbol:!1,encode:{x:"date",y:"4140"},xAxisIndex:2,yAxisIndex:2},{type:"line",name:"4113",sampling:"average",smooth:!0,showSymbol:!1,encode:{x:"date",y:"4113"},xAxisIndex:2,yAxisIndex:2},{type:"line",name:"4080",sampling:"average",smooth:!0,showSymbol:!1,encode:{x:"date",y:"4080"},xAxisIndex:2,yAxisIndex:2},{type:"line",name:"4004",sampling:"average",smooth:!0,showSymbol:!1,encode:{x:"date",y:"4004"},xAxisIndex:2,yAxisIndex:2},{type:"line",name:"4183",sampling:"average",smooth:!0,showSymbol:!1,encode:{x:"date",y:"4183"},xAxisIndex:2,yAxisIndex:2},{type:"line",name:"4041",sampling:"average",smooth:!0,showSymbol:!1,encode:{x:"date",y:"4041"},xAxisIndex:2,yAxisIndex:2}]}}},mounted:function(){var t=this;this.Interval=setInterval((function(){t.updateChart()}),1e3)},methods:{updateChart:function(){this.option.series[0].data=this.$store.state.areaLoad,this.$store.state.areaLoad.length<=119?this.option.series[1].data=this.$store.state.areaLoad:this.option.series[1].data=this.$store.state.areaLoad.slice(-119),this.option.dataset.source=this.$store.state.busVoltage}},beforeDestroy:function(){clearInterval(this.Interval)}},ye=me,ve=(n("def1"),Object(P["a"])(ye,de,pe,!1,null,"dd2c6d20",null)),be=ve.exports,_e=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-chart",{attrs:{options:t.option,theme:"dark",autoresize:!0}})},we=[],xe={data:function(){var t;return{option:{title:{text:"Hourly Area Load",left:"center",top:"20",textStyle:{fontSize:24}},grid:{left:"3%",right:"3%",top:80},xAxis:[{type:"time",boundaryGap:!1,axisLine:{show:!1}}],yAxis:{type:"value",boundaryGap:!1,axisLine:{show:!1}},animation:!1,series:[(t={type:"line",id:"real",name:"Actual Load",symbolSize:10,smooth:!0,sampling:"average",itemStyle:{color:"rgb(255, 158, 68)"},lineStyle:{type:"solid"}},Object(ge["a"])(t,"sampling","average"),Object(ge["a"])(t,"data",[]),t)]}}},mounted:function(){var t=this;this.Interval=setInterval((function(){t.updateChart()}),1e3)},methods:{updateChart:function(){this.$store.state.areaLoad.length<=119?this.option.series[0].data=this.$store.state.areaLoad:this.option.series[0].data=this.$store.state.areaLoad.slice(-119)}},beforeDestroy:function(){clearInterval(this.Interval)}},Se=xe,Ee=(n("62be"),Object(P["a"])(Se,_e,we,!1,null,"4fdf99e9",null)),Ae=Ee.exports,Me=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"echarts",attrs:{id:"chart"}})},Ce=[],ke="",Oe={title:{text:"Bus Voltage",left:"center",top:"20",textStyle:{fontSize:48}},grid:{left:"3%",right:"3%",top:80},legend:{top:"bottom",data:["4195","4146","4056","4181","4192","4039","4151","4196","4073","4070","4158","4140","4113","4080","4004","4183","4041"]},xAxis:[{type:"time",boundaryGap:!1,axisLine:{show:!1}}],yAxis:{type:"value",boundaryGap:!1,axisLine:{show:!1},min:0,max:1.2},animation:!1,dataset:{dimensions:["date","4195","4146","4056","4181","4192","4039","4151","4196","4073","4070","4158","4140","4113","4080","4004","4183","4041"],source:[]},series:[{type:"line",name:"4195",sampling:"average",smooth:!0,showSymbol:!1,encode:{x:"date",y:"4195"}},{type:"line",name:"4146",sampling:"average",smooth:!0,showSymbol:!1,encode:{x:"date",y:"4146"}},{type:"line",name:"4056",sampling:"average",smooth:!0,showSymbol:!1,encode:{x:"date",y:"4056"}},{type:"line",name:"4181",sampling:"average",smooth:!0,showSymbol:!1,encode:{x:"date",y:"4181"}},{type:"line",name:"4192",sampling:"average",smooth:!0,showSymbol:!1,encode:{x:"date",y:"4192"}},{type:"line",name:"4039",sampling:"average",smooth:!0,showSymbol:!1,encode:{x:"date",y:"4039"}},{type:"line",name:"4151",sampling:"average",smooth:!0,showSymbol:!1,encode:{x:"date",y:"4151"}},{type:"line",name:"4196",sampling:"average",smooth:!0,showSymbol:!1,encode:{x:"date",y:"4196"}},{type:"line",name:"4073",sampling:"average",smooth:!0,showSymbol:!1,encode:{x:"date",y:"4073"}},{type:"line",name:"4070",sampling:"average",smooth:!0,showSymbol:!1,encode:{x:"date",y:"4070"}},{type:"line",name:"4158",sampling:"average",smooth:!0,showSymbol:!1,encode:{x:"date",y:"4158"}},{type:"line",name:"4140",sampling:"average",smooth:!0,showSymbol:!1,encode:{x:"date",y:"4140"}},{type:"line",name:"4113",sampling:"average",smooth:!0,showSymbol:!1,encode:{x:"date",y:"4113"}},{type:"line",name:"4080",sampling:"average",smooth:!0,showSymbol:!1,encode:{x:"date",y:"4080"}},{type:"line",name:"4004",sampling:"average",smooth:!0,showSymbol:!1,encode:{x:"date",y:"4004"}},{type:"line",name:"4183",sampling:"average",smooth:!0,showSymbol:!1,encode:{x:"date",y:"4183"}},{type:"line",name:"4041",sampling:"average",smooth:!0,showSymbol:!1,encode:{x:"date",y:"4041"}}]},Pe={mounted:function(){var t=this;ke=j["e"](document.getElementById("chart"),"dark"),this.$once("hook:beforeDestroy",(function(){j["a"](ke)})),ke.setOption(Oe),this.Interval=setInterval((function(){t.updateChart()}),2e3)},methods:{updateChart:function(){Oe.dataset.source=this.$store.state.busVoltage,ke.setOption(Oe)}},beforeDestroy:function(){clearInterval(this.Interval)}},Te=Pe,Le=(n("8145"),Object(P["a"])(Te,Me,Ce,!1,null,"6d24de59",null)),Ie=Le.exports,Ne=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"echarts",attrs:{id:"chart"}})},De=[],Re="",Fe="",Be={mounted:function(){var t="https://api.mapbox.com/styles/v1/mapbox/dark-v9/tiles/256/{z}/{x}/{y}?access_token={accessToken}",e={accessToken:"pk.eyJ1IjoibXp5MjI0MCIsImEiOiJjamttc3VsODYyZmI4M2ttbGxmbzFudGM2In0.0dy22s32n9eth_63nlX1UA"};Fe=L.map("chart",{center:[32,-99.4936],maxZoom:18,zoom:7}),L.tileLayer(t,e).addTo(Fe);var n=L.control({position:"topright"});n.onAdd=function(t){for(var e=L.DomUtil.create("div","legend legend-background"),n=["Substation","Substation w/ generator","Substation w/ shunt"],r=["rgb(34, 47, 151)","rgb(197, 62, 21)","rgb(119, 93, 86)"],i=0;i<n.length;i++)e.innerHTML+='<span class="circle" style="background:'+r[i]+'"></span>'+n[i]+"<br>";return e},n.addTo(Fe);var r={tooltip:{show:!0,trigger:"item"},series:[{id:"sub",type:"effectScatter",name:"sub",coordinateSystem:"leaflet",blendMode:"lighter",symbolSize:5,itemStyle:{color:"#616161"},data:this.$store.state.subData,tooltip:{confine:!0,formatter:function(t){return"Substation: "+t.name}}},{id:"lines",name:"lines",type:"lines",coordinateSystem:"leaflet",animation:!0,progressive:400,progressiveThreshold:1e3,zlevel:1,blendMode:"lighter",lineStyle:{width:2,color:"rgb(200, 35, 45)"},tooltip:{confine:!0,formatter:function(t){return"Branch: "+t.name}},emphasis:{lineStyle:{width:2,shadowColor:"rgba(144, 144, 255, 0.5)",shadowBlur:10}},data:this.$store.state.lineData},{id:"otherSub",type:"scatter",coordinateSystem:"leaflet",blendMode:"lighter",symbolSize:5,itemStyle:{color:"#616161"},data:this.$store.state.otherArea.Substation},{id:"otherBranch",type:"lines",coordinateSystem:"leaflet",progressive:400,progressiveThreshold:1e3,blendMode:"lighter",zlevel:1,lineStyle:{width:2,color:"rgb(200, 35, 45)"},effect:{show:!0,trailLength:.1,symbolSize:1},data:this.$store.state.otherArea.Branch}]},i={loadWhileAnimating:!1,attribution:""};Re=L.supermap.echartsLayer(r,i);Re.addTo(Fe)},methods:{}},je=Be,ze=(n("1133"),Object(P["a"])(je,Ne,De,!1,null,"b08c76a6",null)),Ue=ze.exports,$e=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-container",{attrs:{"grid-list-md":"","text-xs-center":""}},[n("v-layout",{attrs:{row:"",wrap:""}},[n("v-flex",{attrs:{xs12:""}},[n("div",{attrs:{id:"sanddance"}})])],1)],1)},Ve=[],qe=n("a683");const We="undefined"!==typeof __VERSION__?__VERSION__:"untranspiled source",Ge=Object(qe["a"])();function He(t){try{const e=window[t],n="__storage_test__";return e.setItem(n,n),e.removeItem(n),e}catch(e){return null}}class Xe{constructor(t,e,n="sessionStorage"){this.storage=He(n),this.id=t,this.config={},Object.assign(this.config,e),this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(t){return this.config={},this.updateConfiguration(t)}updateConfiguration(t){if(Object.assign(this.config,t),this.storage){const t=JSON.stringify(this.config);this.storage.setItem(this.id,t)}return this}_loadConfiguration(){let t={};if(this.storage){const e=this.storage.getItem(this.id);t=e?JSON.parse(e):{}}return Object.assign(this.config,t),this}}function Ye(t){let e;return e=t<10?"".concat(t.toFixed(2),"ms"):t<100?"".concat(t.toFixed(1),"ms"):t<1e3?"".concat(t.toFixed(0),"ms"):"".concat((t/1e3).toFixed(2),"s"),e}function Ze(t,e=8){const n=Math.max(e-t.length,0);return"".concat(" ".repeat(n)).concat(t)}function Ke(t,e,n,r=600){const i=t.src.replace(/\(/g,"%28").replace(/\)/g,"%29");t.width>r&&(n=Math.min(n,r/t.width));const o=t.width*n,s=t.height*n,a=["font-size:1px;","padding:".concat(Math.floor(s/2),"px ").concat(Math.floor(o/2),"px;"),"line-height:".concat(s,"px;"),"background:url(".concat(i,");"),"background-size:".concat(o,"px ").concat(s,"px;"),"color:transparent;"].join("");return["".concat(e," %c+"),a]}const Je={BLACK:30,RED:31,GREEN:32,YELLOW:33,BLUE:34,MAGENTA:35,CYAN:36,WHITE:37,BRIGHT_BLACK:90,BRIGHT_RED:91,BRIGHT_GREEN:92,BRIGHT_YELLOW:93,BRIGHT_BLUE:94,BRIGHT_MAGENTA:95,BRIGHT_CYAN:96,BRIGHT_WHITE:97};function Qe(t){return"string"===typeof t?Je[t.toUpperCase()]||Je.WHITE:t}function tn(t,e,n){return Ge||"string"!==typeof t||(e&&(e=Qe(e),t="[".concat(e,"m").concat(t,"[39m")),n&&(e=Qe(n),t="[".concat(n+10,"m").concat(t,"[49m"))),t}function en(t,e=["constructor"]){const n=Object.getPrototypeOf(t),r=Object.getOwnPropertyNames(n);for(const i of r)"function"===typeof t[i]&&(e.find(t=>i===t)||(t[i]=t[i].bind(t)))}function nn(t,e){if(!t)throw new Error(e||"Assertion failed")}var rn=n("35b1");function on(){let t;if(Ge&&rn["b"].performance)t=rn["b"].performance.now();else if(rn["a"].hrtime){const e=rn["a"].hrtime();t=1e3*e[0]+e[1]/1e6}else t=Date.now();return t}const sn={debug:Ge&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},an={enabled:!0,level:0};function un(){}const cn={},ln={once:!0};function hn(t){for(const e in t)for(const n in t[e])return n||"untitled";return"empty"}class fn{constructor({id:t}={id:""}){this.id=t,this.VERSION=We,this._startTs=on(),this._deltaTs=on(),this.LOG_THROTTLE_TIMEOUT=0,this._storage=new Xe("__probe-".concat(this.id,"__"),an),this.userData={},this.timeStamp("".concat(this.id," started")),en(this),Object.seal(this)}set level(t){this.setLevel(t)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((on()-this._startTs).toPrecision(10))}getDelta(){return Number((on()-this._deltaTs).toPrecision(10))}set priority(t){this.level=t}get priority(){return this.level}getPriority(){return this.level}enable(t=!0){return this._storage.updateConfiguration({enabled:t}),this}setLevel(t){return this._storage.updateConfiguration({level:t}),this}assert(t,e){nn(t,e)}warn(t){return this._getLogFunction(0,t,sn.warn,arguments,ln)}error(t){return this._getLogFunction(0,t,sn.error,arguments)}deprecated(t,e){return this.warn("`".concat(t,"` is deprecated and will be removed in a later version. Use `").concat(e,"` instead"))}removed(t,e){return this.error("`".concat(t,"` has been removed. Use `").concat(e,"` instead"))}probe(t,e){return this._getLogFunction(t,e,sn.log,arguments,{time:!0,once:!0})}log(t,e){return this._getLogFunction(t,e,sn.debug,arguments)}info(t,e){return this._getLogFunction(t,e,console.info,arguments)}once(t,e){return this._getLogFunction(t,e,sn.debug||sn.info,arguments,ln)}table(t,e,n){return e?this._getLogFunction(t,e,console.table||un,n&&[n],{tag:hn(e)}):un}image({logLevel:t,priority:e,image:n,message:r="",scale:i=1}){return this._shouldLog(t||e)?Ge?yn({image:n,message:r,scale:i}):mn({image:n,message:r,scale:i}):un}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}get(t){return this._storage.config[t]}set(t,e){this._storage.updateConfiguration({[t]:e})}time(t,e){return this._getLogFunction(t,e,console.time?console.time:console.info)}timeEnd(t,e){return this._getLogFunction(t,e,console.timeEnd?console.timeEnd:console.info)}timeStamp(t,e){return this._getLogFunction(t,e,console.timeStamp||un)}group(t,e,n={collapsed:!1}){n=pn({logLevel:t,message:e,opts:n});const{collapsed:r}=n;return n.method=(r?console.groupCollapsed:console.group)||console.info,this._getLogFunction(n)}groupCollapsed(t,e,n={}){return this.group(t,e,Object.assign({},n,{collapsed:!0}))}groupEnd(t){return this._getLogFunction(t,"",console.groupEnd||un)}withGroup(t,e,n){this.group(t,e)();try{n()}finally{this.groupEnd(t)()}}trace(){console.trace&&console.trace()}_shouldLog(t){return this.isEnabled()&&this.getLevel()>=dn(t)}_getLogFunction(t,e,n,r=[],i){if(this._shouldLog(t)){i=pn({logLevel:t,message:e,args:r,opts:i}),n=n||i.method,nn(n),i.total=this.getTotal(),i.delta=this.getDelta(),this._deltaTs=on();const o=i.tag||i.message;if(i.once){if(cn[o])return un;cn[o]=on()}return e=gn(this.id,i.message,i),n.bind(console,e,...i.args)}return un}}function dn(t){if(!t)return 0;let e;switch(typeof t){case"number":e=t;break;case"object":e=t.logLevel||t.priority||0;break;default:return 0}return nn(Number.isFinite(e)&&e>=0),e}function pn(t){const{logLevel:e,message:n}=t;t.logLevel=dn(e);const r=t.args?Array.from(t.args):[];while(r.length&&r.shift()!==n);switch(t.args=r,typeof e){case"string":case"function":void 0!==n&&r.unshift(n),t.message=e;break;case"object":Object.assign(t,e);break;default:}"function"===typeof t.message&&(t.message=t.message());const i=typeof t.message;return nn("string"===i||"object"===i),Object.assign(t,t.opts)}function gn(t,e,n){if("string"===typeof e){const r=n.time?Ze(Ye(n.total)):"";e=n.time?"".concat(t,": ").concat(r,"  ").concat(e):"".concat(t,": ").concat(e),e=tn(e,n.color,n.background)}return e}function mn({image:t,message:e="",scale:r=1}){let i=null;try{i=n(4)}catch(o){}return i?()=>i(t,{fit:"box",width:"".concat(Math.round(80*r),"%")}).then(t=>console.log(t)):un}function yn({image:t,message:e="",scale:n=1}){if("string"===typeof t){const r=new Image;return r.onload=()=>{const t=Ke(r,e,n);console.log(...t)},r.src=t,un}const r=t.nodeName||"";if("img"===r.toLowerCase())return console.log(...Ke(t,e,n)),un;if("canvas"===r.toLowerCase()){const r=new Image;return r.onload=()=>console.log(...Ke(r,e,n)),r.src=t.toDataURL(),un}return un}fn.VERSION=We;var vn=new fn({id:"deck"});const bn={DEFAULT:-1,LNGLAT:1,METER_OFFSETS:2,LNGLAT_OFFSETS:3,CARTESIAN:0};Object.defineProperty(bn,"IDENTITY",{get:()=>vn.deprecated("COORDINATE_SYSTEM.IDENTITY","COORDINATE_SYSTEM.CARTESIAN")()||0});const _n={WEB_MERCATOR:1,GLOBE:2,WEB_MERCATOR_AUTO_OFFSET:4,IDENTITY:0},wn={common:0,meters:1,pixels:2},xn={click:{handler:"onClick"},panstart:{handler:"onDragStart"},panmove:{handler:"onDrag"},panend:{handler:"onDragEnd"}},Sn="vs",En="fs";function An(t,e){if(!t)throw new Error(e||"shadertools: assertion failed.")}const Mn={number:{validate(t,e){return Number.isFinite(t)&&(!("max"in e)||t<=e.max)&&(!("min"in e)||t>=e.min)}},array:{validate(t,e){return Array.isArray(t)||ArrayBuffer.isView(t)}}};function Cn(t){const e={};for(const n in t){const r=t[n],i=kn(r);e[n]=i}return e}function kn(t){let e=On(t);return"object"===e?t?"type"in t?Object.assign({},t,Mn[t.type]):"value"in t?(e=On(t.value),Object.assign({type:e},t,Mn[e])):{type:"object",value:t}:{type:"object",value:null}:Object.assign({type:e,value:t},Mn[e])}function On(t){return Array.isArray(t)||ArrayBuffer.isView(t)?"array":typeof t}const Pn="vs",Tn="fs";class Ln{constructor({name:t,vs:e,fs:n,dependencies:r=[],uniforms:i,getUniforms:o,deprecations:s=[],defines:a={},inject:u={},vertexShader:c,fragmentShader:l}){An("string"===typeof t),this.name=t,this.vs=e||c,this.fs=n||l,this.getModuleUniforms=o,this.dependencies=r,this.deprecations=this._parseDeprecationDefinitions(s),this.defines=a,this.injections=Nn(u),i&&(this.uniforms=Cn(i))}getModuleSource(t){let e;switch(t){case Pn:e=this.vs||"";break;case Tn:e=this.fs||"";break;default:An(!1)}return`#define MODULE_${this.name.toUpperCase().replace(/[^0-9a-z]/gi,"_")}\n${e}// END MODULE_${this.name}\n\n`}getUniforms(t,e){return this.getModuleUniforms?this.getModuleUniforms(t,e):this.uniforms?this._defaultGetUniforms(t):{}}getDefines(){return this.defines}checkDeprecations(t,e){this.deprecations.forEach(n=>{n.regex.test(t)&&(n.deprecated?e.deprecated(n.old,n.new)():e.removed(n.old,n.new)())})}_parseDeprecationDefinitions(t){return t.forEach(t=>{switch(t.type){case"function":t.regex=new RegExp(`\\b${t.old}\\(`);break;default:t.regex=new RegExp(`${t.type} ${t.old};`)}}),t}_defaultGetUniforms(t={}){const e={},n=this.uniforms;for(const r in n){const i=n[r];r in t&&!i.private?(i.validate&&An(i.validate(t[r],i),`${this.name}: invalid ${r}`),e[r]=t[r]):e[r]=i.value}return e}}function In(t){if(!t.normalized&&(t.normalized=!0,t.uniforms&&!t.getUniforms)){const e=new Ln(t);t.getUniforms=e.getUniforms.bind(e)}return t}function Nn(t){const e={vs:{},fs:{}};for(const n in t){let r=t[n];const i=n.slice(0,2);"string"===typeof r&&(r={order:0,injection:r}),e[i][n]=r}return e}function Dn(t){return Rn(Bn(t))}function Rn(t){const e={},n={};return Fn({modules:t,level:0,moduleMap:e,moduleDepth:n}),Object.keys(n).sort((t,e)=>n[e]-n[t]).map(t=>e[t])}function Fn({modules:t,level:e,moduleMap:n,moduleDepth:r}){if(e>=5)throw new Error("Possible loop in shader dependency graph");for(const i of t)n[i.name]=i,(void 0===r[i.name]||r[i.name]<e)&&(r[i.name]=e);for(const i of t)i.dependencies&&Fn({modules:i.dependencies,level:e+1,moduleMap:n,moduleDepth:r})}function Bn(t,e){return t.map(t=>{return t instanceof Ln?t:(An("string"!==typeof t,`Shader module use by name is deprecated. Import shader module '${t}' and use it directly.`),An(t.name,"shader module has no name"),t=new Ln(t),t.dependencies=Bn(t.dependencies),t)})}function jn(t={}){const e="undefined"!==typeof window&&window.navigator||{},n=t.userAgent||e.userAgent||"",r=-1!==n.indexOf("MSIE "),i=-1!==n.indexOf("Trident/");return r||i}const zn=7936,Un=7937,$n=7938,Vn=35724,qn={GLSL_FRAG_DATA:["WEBGL_draw_buffers",!0],GLSL_FRAG_DEPTH:["EXT_frag_depth",!0],GLSL_DERIVATIVES:["OES_standard_derivatives",!0],GLSL_TEXTURE_LOD:["EXT_shader_texture_lod",!0]},Wn={};function Gn(t){return"undefined"!==typeof WebGL2RenderingContext&&t instanceof WebGL2RenderingContext||Boolean(t&&2===t._version)}function Hn(t){const e=t.getExtension("WEBGL_debug_renderer_info"),n=t.getParameter(e&&e.UNMASKED_VENDOR_WEBGL||zn),r=t.getParameter(e&&e.UNMASKED_RENDERER_WEBGL||Un),i=Xn(n,r),o={gpuVendor:i,vendor:n,renderer:r,version:t.getParameter($n),shadingLanguageVersion:t.getParameter(Vn)};return o}function Xn(t,e){return t.match(/NVIDIA/i)||e.match(/NVIDIA/i)?"NVIDIA":t.match(/INTEL/i)||e.match(/INTEL/i)?"INTEL":t.match(/AMD/i)||e.match(/AMD/i)||t.match(/ATI/i)||e.match(/ATI/i)?"AMD":"UNKNOWN GPU"}Object.keys(qn).forEach(t=>{Wn[t]=t});const Yn={};function Zn(t,e,n={}){const r=qn[e];if(An(r,e),!jn(n))return!0;if(e in Yn)return Yn[e];const i=r[0],o=n.behavior||"enable",s=`#extension GL_${i} : ${o}\nvoid main(void) {}`,a=t.createShader(35633);t.shaderSource(a,s),t.compileShader(a);const u=t.getShaderParameter(a,35713);return t.deleteShader(a),Yn[e]=u,u}function Kn(t,e){const n=qn[e];An(n,e);const r=Gn(t)&&n[1]||n[0],i="string"===typeof r?Boolean(t.getExtension(r)):r;return An(!1===i||!0===i),i}function Jn(t,e){return e=Array.isArray(e)?e:[e],e.every(e=>Kn(t,e))}function Qn(t){const e=Hn(t);switch(e.gpuVendor.toLowerCase()){case"nvidia":return"#define NVIDIA_GPU\n// Nvidia optimizes away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n";case"intel":return"#define INTEL_GPU\n// Intel optimizes away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n// Intel's built-in 'tan' function doesn't have acceptable precision\n#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1\n// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow\n#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1\n";case"amd":return"#define AMD_GPU\n";default:return"#define DEFAULT_GPU\n// Prevent driver from optimizing away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n// Intel's built-in 'tan' function doesn't have acceptable precision\n#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1\n// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow\n#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1\n"}}function tr(t,e,n){let r="#if (__VERSION__ > 120)\n\n# define FEATURE_GLSL_DERIVATIVES\n# define FEATURE_GLSL_DRAW_BUFFERS\n# define FEATURE_GLSL_FRAG_DEPTH\n# define FEATURE_GLSL_TEXTURE_LOD\n\n// DEPRECATED FLAGS, remove in v9\n# define FRAG_DEPTH\n# define DERIVATIVES\n# define DRAW_BUFFERS\n# define TEXTURE_LOD\n\n#endif // __VERSION\n";return Jn(t,Wn.GLSL_FRAG_DEPTH)&&(r+="\n// FRAG_DEPTH => gl_FragDepth is available\n#ifdef GL_EXT_frag_depth\n#extension GL_EXT_frag_depth : enable\n# define FEATURE_GLSL_FRAG_DEPTH\n# define FRAG_DEPTH\n# define gl_FragDepth gl_FragDepthEXT\n#endif\n"),Jn(t,Wn.GLSL_DERIVATIVES)&&Zn(t,Wn.GLSL_DERIVATIVES)&&(r+="\n// DERIVATIVES => dxdF, dxdY and fwidth are available\n#ifdef GL_OES_standard_derivatives\n#extension GL_OES_standard_derivatives : enable\n# define FEATURE_GLSL_DERIVATIVES\n# define DERIVATIVES\n#endif\n"),Jn(t,Wn.GLSL_FRAG_DATA)&&Zn(t,Wn.GLSL_FRAG_DATA,{behavior:"require"})&&(r+="\n// DRAW_BUFFERS => gl_FragData[] is available\n#ifdef GL_EXT_draw_buffers\n#extension GL_EXT_draw_buffers : require\n#define FEATURE_GLSL_DRAW_BUFFERS\n#define DRAW_BUFFERS\n#endif\n"),Jn(t,Wn.GLSL_TEXTURE_LOD)&&(r+="// TEXTURE_LOD => texture2DLod etc are available\n#ifdef GL_EXT_shader_texture_lod\n#extension GL_EXT_shader_texture_lod : enable\n\n# define FEATURE_GLSL_TEXTURE_LOD\n# define TEXTURE_LOD\n\n#endif\n"),r}const er="#ifdef MODULE_LOGDEPTH\n  logdepth_adjustPosition(gl_Position);\n#endif\n",nr="#ifdef MODULE_MATERIAL\n  gl_FragColor = material_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_LIGHTING\n  gl_FragColor = lighting_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_FOG\n  gl_FragColor = fog_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_PICKING\n  gl_FragColor = picking_filterHighlightColor(gl_FragColor);\n  gl_FragColor = picking_filterPickingColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_LOGDEPTH\n  logdepth_setFragDepth();\n#endif\n",rr={[Sn]:er,[En]:nr},ir="__LUMA_INJECT_DECLARATIONS__",or=/void\s+main\s*\([^)]*\)\s*\{\n?/,sr=/}\n?[^{}]*$/,ar=[];function ur(t,e,n,r=!1){const i=e===Sn;for(const o in n){const e=n[o];e.sort((t,e)=>t.order-e.order),ar.length=e.length;for(let t=0,n=e.length;t<n;++t)ar[t]=e[t].injection;const r=`${ar.join("\n")}\n`;switch(o){case"vs:#decl":i&&(t=t.replace(ir,r));break;case"vs:#main-start":i&&(t=t.replace(or,t=>t+r));break;case"vs:#main-end":i&&(t=t.replace(sr,t=>r+t));break;case"fs:#decl":i||(t=t.replace(ir,r));break;case"fs:#main-start":i||(t=t.replace(or,t=>t+r));break;case"fs:#main-end":i||(t=t.replace(sr,t=>r+t));break;default:t=t.replace(o,t=>t+r)}}return t=t.replace(ir,""),r&&(t=t.replace(/\}\s*$/,t=>t+rr[e])),t}function cr(t){const e={};return An(Array.isArray(t)&&t.length>1),t.forEach(t=>{for(const n in t)e[n]=e[n]?`${e[n]}\n${t[n]}`:t[n]}),e}function lr(t){return new RegExp(`\\b${t}[ \\t]+(\\w+[ \\t]+\\w+(\\[\\w+\\])?;)`,"g")}const hr=[[/^(#version[ \t]+(100|300[ \t]+es))?[ \t]*\n/,"#version 300 es\n"],[/\btexture(2D|2DProj|Cube)Lod(EXT)?\(/g,"textureLod("],[/\btexture(2D|2DProj|Cube)(EXT)?\(/g,"texture("]],fr=[...hr,[lr("attribute"),"in $1"],[lr("varying"),"out $1"]],dr=[...hr,[lr("varying"),"in $1"]],pr=[[/^#version[ \t]+300[ \t]+es/,"#version 100"],[/\btexture(2D|2DProj|Cube)Lod\(/g,"texture$1LodEXT("],[/\btexture\(/g,"texture2D("],[/\btextureLod\(/g,"texture2DLodEXT("]],gr=[...pr,[lr("in"),"attribute $1"],[lr("out"),"varying $1"]],mr=[...pr,[lr("in"),"varying $1"]],yr="gl_FragColor",vr=/\bout[ \t]+vec4[ \t]+(\w+)[ \t]*;\n?/,br=/void\s+main\s*\([^)]*\)\s*\{\n?/;function _r(t,e,n){switch(e){case 300:return n?wr(t,fr):xr(t);case 100:return n?wr(t,gr):Sr(t);default:throw new Error(`unknown GLSL version ${e}`)}}function wr(t,e){for(const[n,r]of e)t=t.replace(n,r);return t}function xr(t){t=wr(t,dr);const e=t.match(vr);if(e){const n=e[1];t=t.replace(new RegExp(`\\b${yr}\\b`,"g"),n)}else{const e="fragmentColor";t=t.replace(br,t=>`out vec4 ${e};\n${t}`).replace(new RegExp(`\\b${yr}\\b`,"g"),e)}return t}function Sr(t){t=wr(t,mr);const e=t.match(vr);if(e){const n=e[1];t=t.replace(vr,"").replace(new RegExp(`\\b${n}\\b`,"g"),yr)}return t}const Er=`\n\n${ir}\n\n`,Ar={[Sn]:"vertex",[En]:"fragment"},Mr="precision highp float;\n\n";function Cr(t,e){const{vs:n,fs:r}=e,i=Dn(e.modules||[]);return{gl:t,vs:kr(t,Object.assign({},e,{source:n,type:Sn,modules:i})),fs:kr(t,Object.assign({},e,{source:r,type:En,modules:i})),getUniforms:Or(i)}}function kr(t,{id:e,source:n,type:r,modules:i,defines:o={},hookFunctions:s=[],inject:a={},transpileToGLSL100:u=!1,prologue:c=!0,log:l}){An("string"===typeof n,"shader source must be a string");const h=r===Sn,f=n.split("\n");let d=100,p="",g=n;0===f[0].indexOf("#version ")?(d=300,p=f[0],g=f.slice(1).join("\n")):p=`#version ${d}`;const m={};i.forEach(t=>{Object.assign(m,t.getDefines())}),Object.assign(m,o);let y=c?`${p}\n${Tr({id:e,source:n,type:r})}\n${Pr({type:r})}\n${Qn(t)}\n${tr(t,d,!h)}\n${Lr(m)}\n${h?"":Mr}\n`:`${p}\n`;const v=Nr(s),b={},_={},w={};for(const x in a){const t="string"===typeof a[x]?{injection:a[x],order:0}:a[x],e=x.match(/^(v|f)s:(#)?([\w-]+)$/);if(e){const n=e[2],r=e[3];n?"decl"===r?_[x]=[t]:w[x]=[t]:b[x]=[t]}else w[x]=[t]}for(const x of i){l&&x.checkDeprecations(g,l);const t=x.getModuleSource(r,d);y+=t;const e=x.injections[r];for(const n in e){const t=n.match(/^(v|f)s:#([\w-]+)$/);if(t){const r=t[2],i="decl"===r?_:w;i[n]=i[n]||[],i[n].push(e[n])}else b[n]=b[n]||[],b[n].push(e[n])}}return y+=Er,y=ur(y,r,_),y+=Ir(v[r],b),y+=g,y=ur(y,r,w),y=_r(y,u?100:d,h),y}function Or(t){return function(e){const n={};for(const r of t){const t=r.getUniforms(e,n);Object.assign(n,t)}return n}}function Pr({type:t}){return`\n#define SHADER_TYPE_${Ar[t].toUpperCase()}\n`}function Tr({id:t,source:e,type:n}){const r=t&&"string"===typeof t&&-1===e.indexOf("SHADER_NAME");return r?`\n#define SHADER_NAME ${t}_${Ar[n]}\n\n`:""}function Lr(t={}){let e=0,n="";for(const r in t){0===e&&(n+="\n// APPLICATION DEFINES\n"),e++;const i=t[r];(i||Number.isFinite(i))&&(n+=`#define ${r.toUpperCase()} ${t[r]}\n`)}return 0===e&&(n+="\n"),n}function Ir(t,e){let n="";for(const r in t){const i=t[r];if(n+=`void ${i.signature} {\n`,i.header&&(n+=`  ${i.header}`),e[r]){const t=e[r];t.sort((t,e)=>t.order-e.order);for(const e of t)n+=`  ${e.injection}\n`}i.footer&&(n+=`  ${i.footer}`),n+="}\n"}return n}function Nr(t){const e={vs:{},fs:{}};return t.forEach(t=>{let n;"string"!==typeof t?(n=t,t=n.hook):n={},t=t.trim();const[r,i]=t.split(":"),o=t.replace(/\(.+/,"");e[r][o]=Object.assign(n,{signature:i})}),e}var Dr=n("5b67");const Rr="undefined"!==typeof __VERSION__?__VERSION__:"untranspiled source",Fr=Object(Dr["a"])();function Br(t){try{const e=window[t],n="__storage_test__";return e.setItem(n,n),e.removeItem(n),e}catch(e){return null}}class jr{constructor(t,e,n="sessionStorage"){this.storage=Br(n),this.id=t,this.config={},Object.assign(this.config,e),this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(t){return this.config={},this.updateConfiguration(t)}updateConfiguration(t){if(Object.assign(this.config,t),this.storage){const t=JSON.stringify(this.config);this.storage.setItem(this.id,t)}return this}_loadConfiguration(){let t={};if(this.storage){const e=this.storage.getItem(this.id);t=e?JSON.parse(e):{}}return Object.assign(this.config,t),this}}function zr(t){let e;return e=t<10?"".concat(t.toFixed(2),"ms"):t<100?"".concat(t.toFixed(1),"ms"):t<1e3?"".concat(t.toFixed(0),"ms"):"".concat((t/1e3).toFixed(2),"s"),e}function Ur(t,e=8){const n=Math.max(e-t.length,0);return"".concat(" ".repeat(n)).concat(t)}function $r(t,e,n,r=600){const i=t.src.replace(/\(/g,"%28").replace(/\)/g,"%29");t.width>r&&(n=Math.min(n,r/t.width));const o=t.width*n,s=t.height*n,a=["font-size:1px;","padding:".concat(Math.floor(s/2),"px ").concat(Math.floor(o/2),"px;"),"line-height:".concat(s,"px;"),"background:url(".concat(i,");"),"background-size:".concat(o,"px ").concat(s,"px;"),"color:transparent;"].join("");return["".concat(e," %c+"),a]}const Vr={BLACK:30,RED:31,GREEN:32,YELLOW:33,BLUE:34,MAGENTA:35,CYAN:36,WHITE:37,BRIGHT_BLACK:90,BRIGHT_RED:91,BRIGHT_GREEN:92,BRIGHT_YELLOW:93,BRIGHT_BLUE:94,BRIGHT_MAGENTA:95,BRIGHT_CYAN:96,BRIGHT_WHITE:97};function qr(t){return"string"===typeof t?Vr[t.toUpperCase()]||Vr.WHITE:t}function Wr(t,e,n){return Fr||"string"!==typeof t||(e&&(e=qr(e),t="[".concat(e,"m").concat(t,"[39m")),n&&(e=qr(n),t="[".concat(n+10,"m").concat(t,"[49m"))),t}function Gr(t,e=["constructor"]){const n=Object.getPrototypeOf(t),r=Object.getOwnPropertyNames(n);for(const i of r)"function"===typeof t[i]&&(e.find(t=>i===t)||(t[i]=t[i].bind(t)))}function Hr(t,e){if(!t)throw new Error(e||"Assertion failed")}var Xr=n("2239");function Yr(){let t;if(Fr&&Xr["b"].performance)t=Xr["b"].performance.now();else if(Xr["a"].hrtime){const e=Xr["a"].hrtime();t=1e3*e[0]+e[1]/1e6}else t=Date.now();return t}const Zr={debug:Fr&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},Kr={enabled:!0,level:0};function Jr(){}const Qr={},ti={once:!0};function ei(t){for(const e in t)for(const n in t[e])return n||"untitled";return"empty"}class ni{constructor({id:t}={id:""}){this.id=t,this.VERSION=Rr,this._startTs=Yr(),this._deltaTs=Yr(),this.LOG_THROTTLE_TIMEOUT=0,this._storage=new jr("__probe-".concat(this.id,"__"),Kr),this.userData={},this.timeStamp("".concat(this.id," started")),Gr(this),Object.seal(this)}set level(t){this.setLevel(t)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((Yr()-this._startTs).toPrecision(10))}getDelta(){return Number((Yr()-this._deltaTs).toPrecision(10))}set priority(t){this.level=t}get priority(){return this.level}getPriority(){return this.level}enable(t=!0){return this._storage.updateConfiguration({enabled:t}),this}setLevel(t){return this._storage.updateConfiguration({level:t}),this}assert(t,e){Hr(t,e)}warn(t){return this._getLogFunction(0,t,Zr.warn,arguments,ti)}error(t){return this._getLogFunction(0,t,Zr.error,arguments)}deprecated(t,e){return this.warn("`".concat(t,"` is deprecated and will be removed in a later version. Use `").concat(e,"` instead"))}removed(t,e){return this.error("`".concat(t,"` has been removed. Use `").concat(e,"` instead"))}probe(t,e){return this._getLogFunction(t,e,Zr.log,arguments,{time:!0,once:!0})}log(t,e){return this._getLogFunction(t,e,Zr.debug,arguments)}info(t,e){return this._getLogFunction(t,e,console.info,arguments)}once(t,e){return this._getLogFunction(t,e,Zr.debug||Zr.info,arguments,ti)}table(t,e,n){return e?this._getLogFunction(t,e,console.table||Jr,n&&[n],{tag:ei(e)}):Jr}image({logLevel:t,priority:e,image:n,message:r="",scale:i=1}){return this._shouldLog(t||e)?Fr?ai({image:n,message:r,scale:i}):si({image:n,message:r,scale:i}):Jr}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}get(t){return this._storage.config[t]}set(t,e){this._storage.updateConfiguration({[t]:e})}time(t,e){return this._getLogFunction(t,e,console.time?console.time:console.info)}timeEnd(t,e){return this._getLogFunction(t,e,console.timeEnd?console.timeEnd:console.info)}timeStamp(t,e){return this._getLogFunction(t,e,console.timeStamp||Jr)}group(t,e,n={collapsed:!1}){n=ii({logLevel:t,message:e,opts:n});const{collapsed:r}=n;return n.method=(r?console.groupCollapsed:console.group)||console.info,this._getLogFunction(n)}groupCollapsed(t,e,n={}){return this.group(t,e,Object.assign({},n,{collapsed:!0}))}groupEnd(t){return this._getLogFunction(t,"",console.groupEnd||Jr)}withGroup(t,e,n){this.group(t,e)();try{n()}finally{this.groupEnd(t)()}}trace(){console.trace&&console.trace()}_shouldLog(t){return this.isEnabled()&&this.getLevel()>=ri(t)}_getLogFunction(t,e,n,r=[],i){if(this._shouldLog(t)){i=ii({logLevel:t,message:e,args:r,opts:i}),n=n||i.method,Hr(n),i.total=this.getTotal(),i.delta=this.getDelta(),this._deltaTs=Yr();const o=i.tag||i.message;if(i.once){if(Qr[o])return Jr;Qr[o]=Yr()}return e=oi(this.id,i.message,i),n.bind(console,e,...i.args)}return Jr}}function ri(t){if(!t)return 0;let e;switch(typeof t){case"number":e=t;break;case"object":e=t.logLevel||t.priority||0;break;default:return 0}return Hr(Number.isFinite(e)&&e>=0),e}function ii(t){const{logLevel:e,message:n}=t;t.logLevel=ri(e);const r=t.args?Array.from(t.args):[];while(r.length&&r.shift()!==n);switch(t.args=r,typeof e){case"string":case"function":void 0!==n&&r.unshift(n),t.message=e;break;case"object":Object.assign(t,e);break;default:}"function"===typeof t.message&&(t.message=t.message());const i=typeof t.message;return Hr("string"===i||"object"===i),Object.assign(t,t.opts)}function oi(t,e,n){if("string"===typeof e){const r=n.time?Ur(zr(n.total)):"";e=n.time?"".concat(t,": ").concat(r,"  ").concat(e):"".concat(t,": ").concat(e),e=Wr(e,n.color,n.background)}return e}function si({image:t,message:e="",scale:r=1}){let i=null;try{i=n(5)}catch(o){}return i?()=>i(t,{fit:"box",width:"".concat(Math.round(80*r),"%")}).then(t=>console.log(t)):Jr}function ai({image:t,message:e="",scale:n=1}){if("string"===typeof t){const r=new Image;return r.onload=()=>{const t=$r(r,e,n);console.log(...t)},r.src=t,Jr}const r=t.nodeName||"";if("img"===r.toLowerCase())return console.log(...$r(t,e,n)),Jr;if("canvas"===r.toLowerCase()){const r=new Image;return r.onload=()=>console.log(...$r(r,e,n)),r.src=t.toDataURL(),Jr}return Jr}ni.VERSION=Rr;const ui=new ni({id:"luma.gl"});var ci=n("a093"),li=(n("1e88"),n("8177")),hi=n("f50d"),fi=n("b2b4"),di=n("5729");function pi(t){const{luma:e}=t;if(t.canvas&&e){const{clientWidth:n}=e.canvasSizeInfo;return n?t.drawingBufferWidth/n:1}return 1}function gi(t,e,n=!0){const r=pi(t),i=t.drawingBufferWidth,o=t.drawingBufferHeight;return yi(e,r,i,o,n)}function mi(t){const e="undefined"===typeof window?1:window.devicePixelRatio||1;return Number.isFinite(t)?t<=0?1:t:t?e:1}function yi(t,e,n,r,i){const o=vi(t[0],e,n);let s=bi(t[1],e,r,i),a=vi(t[0]+1,e,n);const u=a===n-1?a:a-1;let c;return a=bi(t[1]+1,e,r,i),i?(a=0===a?a:a+1,c=s,s=a):c=a===r-1?a:a-1,{x:o,y:s,width:Math.max(u-o+1,1),height:Math.max(c-s+1,1)}}function vi(t,e,n){const r=Math.min(Math.round(t*e),n-1);return r}function bi(t,e,n,r){return r?Math.max(0,n-1-Math.round(t*e)):Math.min(Math.round(t*e),n-1)}const _i=Object(fi["isBrowser"])(),wi=_i&&"undefined"!==typeof document,xi={webgl2:!0,webgl1:!0,throwOnError:!0,manageState:!0,canvas:null,debug:!1,width:800,height:600};function Si(t={}){Object(di["a"])(_i,"createGLContext only available in the browser.\nCreate your own headless context or use 'createHeadlessContext' from @luma.gl/test-utils"),t=Object.assign({},xi,t);const{width:e,height:n}=t;function r(e){if(t.throwOnError)throw new Error(e);return console.error(e),null}let i;t.onError=r;const{canvas:o}=t,s=ki({canvas:o,width:e,height:n,onError:r});return i=Ci(s,t),i?(i=Ei(i,t),Oi(i),i):null}function Ei(t,e={}){if(!t||t._instrumented)return t;t._version=t._version||Pi(t),t.luma=t.luma||{},t.luma.canvasSizeInfo=t.luma.canvasSizeInfo||{},e=Object.assign({},xi,e);const{manageState:n,debug:r}=e;return n&&Object(hi["c"])(t,{copyState:!1,log:(...t)=>ui.log(1,...t)()}),_i&&r&&(fi["global"].makeDebugContext?(t=fi["global"].makeDebugContext(t,e),ui.level=Math.max(ui.level,1)):ui.warn('WebGL debug mode not activated. import "@luma.gl/debug" to enable.')()),t._instrumented=!0,t}function Ai(t){const e=t.getParameter(7936),n=t.getParameter(7937),r=t.getExtension("WEBGL_debug_renderer_info"),i=r&&t.getParameter(r.UNMASKED_VENDOR_WEBGL||7936),o=r&&t.getParameter(r.UNMASKED_RENDERER_WEBGL||7937);return{vendor:i||e,renderer:o||n,vendorMasked:e,rendererMasked:n,version:t.getParameter(7938),shadingLanguageVersion:t.getParameter(35724)}}function Mi(t,e={}){if(t.canvas){const n=mi(e.useDevicePixels);return void Ti(t,n,e)}const n=t.getExtension("STACKGL_resize_drawingbuffer");n&&"width"in e&&"height"in e&&n.resize(e.width,e.height)}function Ci(t,e){const{onError:n}=e;let r=null;const i=t=>r=t.statusMessage||r;t.addEventListener("webglcontextcreationerror",i,!1);const{webgl1:o=!0,webgl2:s=!0}=e;let a=null;return s&&(a=a||t.getContext("webgl2",e),a=a||t.getContext("experimental-webgl2",e)),o&&(a=a||t.getContext("webgl",e),a=a||t.getContext("experimental-webgl",e)),t.removeEventListener("webglcontextcreationerror",i,!1),a?(e.onContextLost&&t.addEventListener("webglcontextlost",e.onContextLost,!1),e.onContextRestored&&t.addEventListener("webglcontextrestored",e.onContextRestored,!1),a):n(`Failed to create ${s&&!o?"WebGL2":"WebGL"} context: ${r||"Unknown error"}`)}function ki({canvas:t,width:e=800,height:n=600,onError:r}){let i;if("string"===typeof t){const e=wi&&"complete"===document.readyState;e||r(`createGLContext called on canvas '${t}' before page was loaded`),i=document.getElementById(t)}else t?i=t:(i=document.createElement("canvas"),i.id="lumagl-canvas",i.style.width=Number.isFinite(e)?`${e}px`:"100%",i.style.height=Number.isFinite(n)?`${n}px`:"100%",document.body.insertBefore(i,document.body.firstChild));return i}function Oi(t){const e=Object(ci["e"])(t)?"WebGL2":"WebGL1",n=Ai(t),r=n?`(${n.vendor},${n.renderer})`:"",i=t.debug?" debug":"";ui.info(1,`${e}${i} context ${r}`)()}function Pi(t){return"undefined"!==typeof WebGL2RenderingContext&&t instanceof WebGL2RenderingContext?2:1}function Ti(t,e,n){let r="width"in n?n.width:t.canvas.clientWidth,i="height"in n?n.height:t.canvas.clientHeight;r&&i||(ui.log(1,"Canvas clientWidth/clientHeight is 0")(),e=1,r=t.canvas.width||1,i=t.canvas.height||1),t.luma=t.luma||{},t.luma.canvasSizeInfo=t.luma.canvasSizeInfo||{};const o=t.luma.canvasSizeInfo;if(o.clientWidth!==r||o.clientHeight!==i||o.devicePixelRatio!==e){let n=e;const o=Math.floor(r*n),s=Math.floor(i*n);t.canvas.width=o,t.canvas.height=s,t.drawingBufferWidth===o&&t.drawingBufferHeight===s||(ui.warn("Device pixel ratio clamped")(),n=Math.min(t.drawingBufferWidth/r,t.drawingBufferHeight/i),t.canvas.width=Math.floor(r*n),t.canvas.height=Math.floor(i*n)),Object.assign(t.luma.canvasSizeInfo,{clientWidth:r,clientHeight:i,devicePixelRatio:e})}}var Li=n("19ac");class Ii{constructor(t,e){this.name=t,this.type=e,this.sampleSize=1,this.reset()}setSampleSize(t){return this.sampleSize=t,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(t){return this._count+=t,this._samples++,this._checkSampling(),this}subtractCount(t){return this._count-=t,this._samples++,this._checkSampling(),this}addTime(t){return this._time+=t,this.lastTiming=t,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=Object(Li["a"])(),this._timerPending=!0,this}timeEnd(){return this._timerPending?(this.addTime(Object(Li["a"])()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}}class Ni{constructor({id:t,stats:e}){this.id=t,this.stats={},this._initializeStats(e),Object.seal(this)}get(t,e="count"){return this._getOrCreate({name:t,type:e})}get size(){return Object.keys(this.stats).length}reset(){for(const t in this.stats)this.stats[t].reset();return this}forEach(t){for(const e in this.stats)t(this.stats[e])}getTable(){const t={};return this.forEach(e=>{t[e.name]={time:e.time||0,count:e.count||0,average:e.getAverageTime()||0,hz:e.getHz()||0}}),t}_initializeStats(t=[]){t.forEach(t=>this._getOrCreate(t))}_getOrCreate(t){if(!t||!t.name)return null;const{name:e,type:n}=t;return this.stats[e]||(this.stats[e]=t instanceof Ii?t:new Ii(e,n)),this.stats[e]}}var Di=n("0b41");const Ri="8.5.10",Fi="set luma.log.level=1 (or higher) to trace rendering";class Bi{constructor(){this.stats=new Map}get(t){return this.stats.has(t)||this.stats.set(t,new Ni({id:t})),this.stats.get(t)}}const ji=new Bi;if(Di["global"].luma&&Di["global"].luma.VERSION!==Ri)throw new Error(`luma.gl - multiple VERSIONs detected: ${Di["global"].luma.VERSION} vs ${Ri}`);Di["global"].luma||(Object(Di["isBrowser"])()&&ui.log(1,`luma.gl ${Ri} - ${Fi}`)(),Di["global"].luma=Di["global"].luma||{VERSION:Ri,version:Ri,log:ui,stats:ji,globals:{modules:{},nodeIO:{}}});Di["global"].luma;function zi(t,e){if(!t)throw new Error(e||"luma.gl: assertion failed.")}function Ui(t,e){if("string"!==typeof e)return e;const n=Number(e);if(!isNaN(n))return n;e=e.replace(/^.*\./,"");const r=t[e];return zi(void 0!==r,`Accessing undefined constant GL.${e}`),r}function $i(t,e){e=Number(e);for(const n in t)if(t[n]===e)return`GL.${n}`;return String(e)}const Vi={};function qi(t="id"){Vi[t]=Vi[t]||1;const e=Vi[t]++;return`${t}-${e}`}function Wi(t){return zi("number"===typeof t,"Input must be a number"),t&&0===(t&t-1)}function Gi(t){let e=!0;for(const n in t){e=!1;break}return e}function Hi(t,e,n,r){const i=`See luma.gl ${n} Upgrade Guide at https://luma.gl/docs/upgrade-guide`,o=Object.getPrototypeOf(t);r.forEach(t=>{o.methodName||(o[t]=()=>{throw ui.removed(`Calling removed method ${e}.${t}: `,i)(),new Error(t)})})}const Xi="Resource subclass must define virtual methods";class Yi{constructor(t,e={}){Object(ci["b"])(t);const{id:n,userData:r={}}=e;this.gl=t,this.gl2=t,this.id=n||qi(this.constructor.name),this.userData=r,this._bound=!1,this._handle=e.handle,void 0===this._handle&&(this._handle=this._createHandle()),this.byteLength=0,this._addStats()}toString(){return`${this.constructor.name}(${this.id})`}get handle(){return this._handle}delete({deleteChildren:t=!1}={}){const e=this._handle&&this._deleteHandle(this._handle);return this._handle&&this._removeStats(),this._handle=null,e&&t&&e.filter(Boolean).forEach(t=>t.delete()),this}bind(t=this.handle){if("function"!==typeof t)return this._bindHandle(t),this;let e;return this._bound?e=t():(this._bindHandle(this.handle),this._bound=!0,e=t(),this._bound=!1,this._bindHandle(null)),e}unbind(){this.bind(null)}getParameter(t,e={}){t=Ui(this.gl,t),zi(t);const n=this.constructor.PARAMETERS||{},r=n[t];if(r){const t=Object(ci["e"])(this.gl),e=(!("webgl2"in r)||t)&&(!("extension"in r)||this.gl.getExtension(r.extension));if(!e){const e=r.webgl1,n="webgl2"in r?r.webgl2:r.webgl1,i=t?n:e;return i}}return this._getParameter(t,e)}getParameters(t={}){const{parameters:e,keys:n}=t,r=this.constructor.PARAMETERS||{},i=Object(ci["e"])(this.gl),o={},s=e||Object.keys(r);for(const a of s){const e=r[a],s=e&&(!("webgl2"in e)||i)&&(!("extension"in e)||this.gl.getExtension(e.extension));if(s){const r=n?$i(this.gl,a):a;o[r]=this.getParameter(a,t),n&&"GLenum"===e.type&&(o[r]=$i(this.gl,o[r]))}}return o}setParameter(t,e){t=Ui(this.gl,t),zi(t);const n=this.constructor.PARAMETERS||{},r=n[t];if(r){const t=Object(ci["e"])(this.gl),n=(!("webgl2"in r)||t)&&(!("extension"in r)||this.gl.getExtension(r.extension));if(!n)throw new Error("Parameter not available on this platform");"GLenum"===r.type&&(e=Ui(e))}return this._setParameter(t,e),this}setParameters(t){for(const e in t)this.setParameter(e,t[e]);return this}stubRemovedMethods(t,e,n){return Hi(this,t,e,n)}initialize(t){}_createHandle(){throw new Error(Xi)}_deleteHandle(){throw new Error(Xi)}_bindHandle(t){throw new Error(Xi)}_getOptsFromHandle(){throw new Error(Xi)}_getParameter(t,e){throw new Error(Xi)}_setParameter(t,e){throw new Error(Xi)}_context(){return this.gl.luma=this.gl.luma||{},this.gl.luma}_addStats(){const t=this.constructor.name,e=ji.get("Resource Counts");e.get("Resources Created").incrementCount(),e.get(`${t}s Created`).incrementCount(),e.get(`${t}s Active`).incrementCount()}_removeStats(){const t=this.constructor.name,e=ji.get("Resource Counts");e.get(`${t}s Active`).decrementCount()}_trackAllocatedMemory(t,e=this.constructor.name){const n=ji.get("Memory Usage");n.get("GPU Memory").addCount(t),n.get(`${e} Memory`).addCount(t),this.byteLength=t}_trackDeallocatedMemory(t=this.constructor.name){const e=ji.get("Memory Usage");e.get("GPU Memory").subtractCount(this.byteLength),e.get(`${t} Memory`).subtractCount(this.byteLength),this.byteLength=0}}const Zi="Failed to deduce GL constant from typed array";function Ki(t){const e=ArrayBuffer.isView(t)?t.constructor:t;switch(e){case Float32Array:return 5126;case Uint16Array:return 5123;case Uint32Array:return 5125;case Uint8Array:return 5121;case Uint8ClampedArray:return 5121;case Int8Array:return 5120;case Int16Array:return 5122;case Int32Array:return 5124;default:throw new Error(Zi)}}function Ji(t,{clamped:e=!0}={}){switch(t){case 5126:return Float32Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return e?Uint8ClampedArray:Uint8Array;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Failed to deduce typed array type from GL constant")}}function Qi({data:t,width:e,height:n,bytesPerPixel:r=4,temp:i}){const o=e*r;i=i||new Uint8Array(o);for(let s=0;s<n/2;++s){const e=s*o,r=(n-s-1)*o;i.set(t.subarray(e,e+o)),t.copyWithin(e,r,r+o),t.set(i,r)}}function to({data:t,width:e,height:n}){const r=Math.round(e/2),i=Math.round(n/2),o=new Uint8Array(r*i*4);for(let s=0;s<i;s++)for(let n=0;n<r;n++)for(let i=0;i<4;i++)o[4*(s*r+n)+i]=t[4*(2*s*e+2*n)+i];return{data:o,width:r,height:i}}function eo(t,e,n){const{removedProps:r={},deprecatedProps:i={},replacedProps:o={}}=n;for(const a in r)if(a in e){const e=r[a],n=e?`${t}.${r[a]}`:"N/A";ui.removed(`${t}.${a}`,n)()}for(const a in i)if(a in e){const e=i[a];ui.deprecated(`${t}.${a}`,`${t}.${e}`)()}let s=null;for(const a in o)if(a in e){const n=o[a];ui.deprecated(`${t}.${a}`,`${t}.${n}`)(),s=s||Object.assign({},e),s[n]=e[a],delete s[a]}return s||e}const no={offset:0,stride:0,type:5126,size:1,divisor:0,normalized:!1,integer:!1},ro={deprecatedProps:{instanced:"divisor",isInstanced:"divisor"}};class io{static getBytesPerElement(t){const e=Ji(t.type||5126);return e.BYTES_PER_ELEMENT}static getBytesPerVertex(t){zi(t.size);const e=Ji(t.type||5126);return e.BYTES_PER_ELEMENT*t.size}static resolve(...t){return new io(...[no,...t])}constructor(...t){t.forEach(t=>this._assign(t)),Object.freeze(this)}toString(){return JSON.stringify(this)}get BYTES_PER_ELEMENT(){return io.getBytesPerElement(this)}get BYTES_PER_VERTEX(){return io.getBytesPerVertex(this)}_assign(t={}){return t=eo("Accessor",t,ro),void 0!==t.type&&(this.type=t.type,5124!==t.type&&5125!==t.type||(this.integer=!0)),void 0!==t.size&&(this.size=t.size),void 0!==t.offset&&(this.offset=t.offset),void 0!==t.stride&&(this.stride=t.stride),void 0!==t.normalized&&(this.normalized=t.normalized),void 0!==t.integer&&(this.integer=t.integer),void 0!==t.divisor&&(this.divisor=t.divisor),void 0!==t.buffer&&(this.buffer=t.buffer),void 0!==t.index&&("boolean"===typeof t.index?this.index=t.index?1:0:this.index=t.index),void 0!==t.instanced&&(this.divisor=t.instanced?1:0),void 0!==t.isInstanced&&(this.divisor=t.isInstanced?1:0),this}}const oo=10,so={offset:"accessor.offset",stride:"accessor.stride",type:"accessor.type",size:"accessor.size",divisor:"accessor.divisor",normalized:"accessor.normalized",integer:"accessor.integer",instanced:"accessor.divisor",isInstanced:"accessor.divisor"},ao={removedProps:{},replacedProps:{bytes:"byteLength"},deprecatedProps:so},uo={removedProps:so};class co extends Yi{constructor(t,e={}){super(t,e),this.stubRemovedMethods("Buffer","v6.0",["layout","setLayout","getIndexedParameter"]),this.target=e.target||(this.gl.webgl2?36662:34962),this.initialize(e),Object.seal(this)}getElementCount(t=this.accessor){return Math.round(this.byteLength/io.getBytesPerElement(t))}getVertexCount(t=this.accessor){return Math.round(this.byteLength/io.getBytesPerVertex(t))}initialize(t={}){return ArrayBuffer.isView(t)&&(t={data:t}),Number.isFinite(t)&&(t={byteLength:t}),t=eo("Buffer",t,ao),this.usage=t.usage||35044,this.debugData=null,this.setAccessor(Object.assign({},t,t.accessor)),t.data?this._setData(t.data,t.offset,t.byteLength):this._setByteLength(t.byteLength||0),this}setProps(t){return t=eo("Buffer",t,uo),"accessor"in t&&this.setAccessor(t.accessor),this}setAccessor(t){return t=Object.assign({},t),delete t.buffer,this.accessor=new io(t),this}reallocate(t){return t>this.byteLength?(this._setByteLength(t),!0):(this.bytesUsed=t,!1)}setData(t){return this.initialize(t)}subData(t){ArrayBuffer.isView(t)&&(t={data:t});const{data:e,offset:n=0,srcOffset:r=0}=t,i=t.byteLength||t.length;zi(e);const o=this.gl.webgl2?36663:this.target;return this.gl.bindBuffer(o,this.handle),0!==r||void 0!==i?(Object(ci["a"])(this.gl),this.gl.bufferSubData(this.target,n,e,r,i)):this.gl.bufferSubData(o,n,e),this.gl.bindBuffer(o,null),this.debugData=null,this._inferType(e),this}copyData({sourceBuffer:t,readOffset:e=0,writeOffset:n=0,size:r}){const{gl:i}=this;return Object(ci["a"])(i),i.bindBuffer(36662,t.handle),i.bindBuffer(36663,this.handle),i.copyBufferSubData(36662,36663,e,n,r),i.bindBuffer(36662,null),i.bindBuffer(36663,null),this.debugData=null,this}getData({dstData:t=null,srcByteOffset:e=0,dstOffset:n=0,length:r=0}={}){Object(ci["a"])(this.gl);const i=Ji(this.accessor.type||5126,{clamped:!1}),o=this._getAvailableElementCount(e),s=n;let a,u;t?(u=t.length,a=u-s):(a=Math.min(o,r||o),u=s+a);const c=Math.min(o,a);return r=r||c,zi(r<=c),t=t||new i(u),this.gl.bindBuffer(36662,this.handle),this.gl.getBufferSubData(36662,e,t,n,r),this.gl.bindBuffer(36662,null),t}bind({target:t=this.target,index:e=this.accessor&&this.accessor.index,offset:n=0,size:r}={}){return 35345===t||35982===t?void 0!==r?this.gl.bindBufferRange(t,e,this.handle,n,r):(zi(0===n),this.gl.bindBufferBase(t,e,this.handle)):this.gl.bindBuffer(t,this.handle),this}unbind({target:t=this.target,index:e=this.accessor&&this.accessor.index}={}){const n=35345===t||35982===t;return n?this.gl.bindBufferBase(t,e,null):this.gl.bindBuffer(t,null),this}getDebugData(){return this.debugData?{data:this.debugData,changed:!1}:(this.debugData=this.getData({length:Math.min(oo,this.byteLength)}),{data:this.debugData,changed:!0})}invalidateDebugData(){this.debugData=null}_setData(t,e=0,n=t.byteLength+e){zi(ArrayBuffer.isView(t)),this._trackDeallocatedMemory();const r=this._getTarget();this.gl.bindBuffer(r,this.handle),this.gl.bufferData(r,n,this.usage),this.gl.bufferSubData(r,e,t),this.gl.bindBuffer(r,null),this.debugData=t.slice(0,oo),this.bytesUsed=n,this._trackAllocatedMemory(n);const i=Ki(t);return zi(i),this.setAccessor(new io(this.accessor,{type:i})),this}_setByteLength(t,e=this.usage){zi(t>=0),this._trackDeallocatedMemory();let n=t;0===t&&(n=new Float32Array(0));const r=this._getTarget();return this.gl.bindBuffer(r,this.handle),this.gl.bufferData(r,n,e),this.gl.bindBuffer(r,null),this.usage=e,this.debugData=null,this.bytesUsed=t,this._trackAllocatedMemory(t),this}_getTarget(){return this.gl.webgl2?36663:this.target}_getAvailableElementCount(t){const e=Ji(this.accessor.type||5126,{clamped:!1}),n=t/e.BYTES_PER_ELEMENT;return this.getElementCount()-n}_inferType(t){this.accessor.type||this.setAccessor(new io(this.accessor,{type:Ki(t)}))}_createHandle(){return this.gl.createBuffer()}_deleteHandle(){this.gl.deleteBuffer(this.handle),this._trackDeallocatedMemory()}_getParameter(t){this.gl.bindBuffer(this.target,this.handle);const e=this.gl.getBufferParameter(this.target,t);return this.gl.bindBuffer(this.target,null),e}get type(){return ui.deprecated("Buffer.type","Buffer.accessor.type")(),this.accessor.type}get bytes(){return ui.deprecated("Buffer.bytes","Buffer.byteLength")(),this.byteLength}setByteLength(t){return ui.deprecated("setByteLength","reallocate")(),this.reallocate(t)}updateAccessor(t){return ui.deprecated("updateAccessor(...)","setAccessor(new Accessor(buffer.accessor, ...)")(),this.accessor=new io(this.accessor,t),this}}const lo={[6407]:{dataFormat:6407,types:[5121,33635]},[6408]:{dataFormat:6408,types:[5121,32819,32820]},[6406]:{dataFormat:6406,types:[5121]},[6409]:{dataFormat:6409,types:[5121]},[6410]:{dataFormat:6410,types:[5121]},[33326]:{dataFormat:6403,types:[5126],gl2:!0},[33328]:{dataFormat:33319,types:[5126],gl2:!0},[34837]:{dataFormat:6407,types:[5126],gl2:!0},[34836]:{dataFormat:6408,types:[5126],gl2:!0}},ho={[6403]:1,[36244]:1,[33319]:2,[33320]:2,[6407]:3,[36248]:3,[6408]:4,[36249]:4,[6402]:1,[34041]:1,[6406]:1,[6409]:1,[6410]:2},fo={[5126]:4,[5125]:4,[5124]:4,[5123]:2,[5122]:2,[5131]:2,[5120]:1,[5121]:1};function po(t,e){const n=lo[e];if(!n)return!1;if(void 0===n.gl1&&void 0===n.gl2)return!0;const r=Object(ci["e"])(t)&&n.gl2||n.gl1;return"string"===typeof r?t.getExtension(r):r}function go(t,e){const n=lo[e];switch(n&&n.types[0]){case 5126:return t.getExtension("OES_texture_float_linear");case 5131:return t.getExtension("OES_texture_half_float_linear");default:return!0}}const mo=[9729,9728],yo=Di["global"].WebGLBuffer||function(){};class vo extends Yi{static isSupported(t,e={}){const{format:n,linearFiltering:r}=e;let i=!0;return n&&(i=i&&po(t,n),i=i&&(!r||go(t,n))),i}constructor(t,e){const{id:n=qi("texture"),handle:r,target:i}=e;super(t,{id:n,handle:r}),this.target=i,this.textureUnit=void 0,this.loaded=!1,this.width=void 0,this.height=void 0,this.depth=void 0,this.format=void 0,this.type=void 0,this.dataFormat=void 0,this.border=void 0,this.textureUnit=void 0,this.mipmaps=void 0}toString(){return`Texture(${this.id},${this.width}x${this.height})`}initialize(t={}){let e=t.data;if(e instanceof Promise)return e.then(e=>this.initialize(Object.assign({},t,{pixels:e,data:e}))),this;const n="undefined"!==typeof HTMLVideoElement&&e instanceof HTMLVideoElement;if(n&&e.readyState<HTMLVideoElement.HAVE_METADATA)return this._video=null,e.addEventListener("loadeddata",()=>this.initialize(t)),this;const{pixels:r=null,format:i=6408,border:o=0,recreate:s=!1,parameters:a={},pixelStore:u={},textureUnit:c}=t;e||(e=r);let{width:l,height:h,dataFormat:f,type:d,compressed:p=!1,mipmaps:g=!0}=t;const{depth:m=0}=t;return({width:l,height:h,compressed:p,dataFormat:f,type:d}=this._deduceParameters({format:i,type:d,dataFormat:f,compressed:p,data:e,width:l,height:h})),this.width=l,this.height=h,this.depth=m,this.format=i,this.type=d,this.dataFormat=f,this.border=o,this.textureUnit=c,Number.isFinite(this.textureUnit)&&(this.gl.activeTexture(33984+this.textureUnit),this.gl.bindTexture(this.target,this.handle)),g&&this._isNPOT()&&(ui.warn(`texture: ${this} is Non-Power-Of-Two, disabling mipmaping`)(),g=!1,this._updateForNPOT(a)),this.mipmaps=g,this.setImageData({data:e,width:l,height:h,depth:m,format:i,type:d,dataFormat:f,border:o,mipmaps:g,parameters:u,compressed:p}),g&&this.generateMipmap(),this.setParameters(a),s&&(this.data=e),n&&(this._video={video:e,parameters:a,lastTime:e.readyState>=HTMLVideoElement.HAVE_CURRENT_DATA?e.currentTime:-1}),this}update(){if(this._video){const{video:t,parameters:e,lastTime:n}=this._video;if(n===t.currentTime||t.readyState<HTMLVideoElement.HAVE_CURRENT_DATA)return;this.setSubImageData({data:t,parameters:e}),this.mipmaps&&this.generateMipmap(),this._video.lastTime=t.currentTime}}resize({height:t,width:e,mipmaps:n=!1}){return e!==this.width||t!==this.height?this.initialize({width:e,height:t,format:this.format,type:this.type,dataFormat:this.dataFormat,border:this.border,mipmaps:n}):this}generateMipmap(t={}){return this._isNPOT()?(ui.warn(`texture: ${this} is Non-Power-Of-Two, disabling mipmaping`)(),this):(this.mipmaps=!0,this.gl.bindTexture(this.target,this.handle),Object(li["d"])(this.gl,t,()=>{this.gl.generateMipmap(this.target)}),this.gl.bindTexture(this.target,null),this)}setImageData(t){this._trackDeallocatedMemory("Texture");const{target:e=this.target,pixels:n=null,level:r=0,format:i=this.format,border:o=this.border,offset:s=0,parameters:a={}}=t;let{data:u=null,type:c=this.type,width:l=this.width,height:h=this.height,dataFormat:f=this.dataFormat,compressed:d=!1}=t;u||(u=n),({type:c,dataFormat:f,compressed:d,width:l,height:h}=this._deduceParameters({format:i,type:c,dataFormat:f,compressed:d,data:u,width:l,height:h}));const{gl:p}=this;p.bindTexture(this.target,this.handle);let g,m=null;if(({data:u,dataType:m}=this._getDataType({data:u,compressed:d})),Object(li["d"])(this.gl,a,()=>{switch(m){case"null":p.texImage2D(e,r,i,l,h,o,f,c,u);break;case"typed-array":p.texImage2D(e,r,i,l,h,o,f,c,u,s);break;case"buffer":g=Object(ci["a"])(p),g.bindBuffer(35052,u.handle||u),g.texImage2D(e,r,i,l,h,o,f,c,s),g.bindBuffer(35052,null);break;case"browser-object":Object(ci["e"])(p)?p.texImage2D(e,r,i,l,h,o,f,c,u):p.texImage2D(e,r,i,f,c,u);break;case"compressed":for(const[t,n]of u.entries())p.compressedTexImage2D(e,t,n.format,n.width,n.height,o,n.data);break;default:zi(!1,"Unknown image data type")}}),u&&u.byteLength)this._trackAllocatedMemory(u.byteLength,"Texture");else{const t=ho[this.dataFormat]||4,e=fo[this.type]||1;this._trackAllocatedMemory(this.width*this.height*t*e,"Texture")}return this.loaded=!0,this}setSubImageData({target:t=this.target,pixels:e=null,data:n=null,x:r=0,y:i=0,width:o=this.width,height:s=this.height,level:a=0,format:u=this.format,type:c=this.type,dataFormat:l=this.dataFormat,compressed:h=!1,offset:f=0,border:d=this.border,parameters:p={}}){if(({type:c,dataFormat:l,compressed:h,width:o,height:s}=this._deduceParameters({format:u,type:c,dataFormat:l,compressed:h,data:n,width:o,height:s})),zi(0===this.depth,"texSubImage not supported for 3D textures"),n||(n=e),n&&n.data){const t=n;n=t.data,o=t.shape[0],s=t.shape[1]}n instanceof co&&(n=n.handle),this.gl.bindTexture(this.target,this.handle),Object(li["d"])(this.gl,p,()=>{if(h)this.gl.compressedTexSubImage2D(t,a,r,i,o,s,u,n);else if(null===n)this.gl.texSubImage2D(t,a,r,i,o,s,l,c,null);else if(ArrayBuffer.isView(n))this.gl.texSubImage2D(t,a,r,i,o,s,l,c,n,f);else if(n instanceof yo){const e=Object(ci["a"])(this.gl);e.bindBuffer(35052,n),e.texSubImage2D(t,a,r,i,o,s,l,c,f),e.bindBuffer(35052,null)}else if(Object(ci["e"])(this.gl)){const e=Object(ci["a"])(this.gl);e.texSubImage2D(t,a,r,i,o,s,l,c,n)}else this.gl.texSubImage2D(t,a,r,i,l,c,n)}),this.gl.bindTexture(this.target,null)}copyFramebuffer(t={}){return ui.error("Texture.copyFramebuffer({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}getActiveUnit(){return this.gl.getParameter(34016)-33984}bind(t=this.textureUnit){const{gl:e}=this;return void 0!==t&&(this.textureUnit=t,e.activeTexture(33984+t)),e.bindTexture(this.target,this.handle),t}unbind(t=this.textureUnit){const{gl:e}=this;return void 0!==t&&(this.textureUnit=t,e.activeTexture(33984+t)),e.bindTexture(this.target,null),t}_getDataType({data:t,compressed:e=!1}){return e?{data:t,dataType:"compressed"}:null===t?{data:t,dataType:"null"}:ArrayBuffer.isView(t)?{data:t,dataType:"typed-array"}:t instanceof co?{data:t.handle,dataType:"buffer"}:t instanceof yo?{data:t,dataType:"buffer"}:{data:t,dataType:"browser-object"}}_deduceParameters(t){const{format:e,data:n}=t;let{width:r,height:i,dataFormat:o,type:s,compressed:a}=t;const u=lo[e];return o=o||u&&u.dataFormat,s=s||u&&u.types[0],a=a||u&&u.compressed,({width:r,height:i}=this._deduceImageSize(n,r,i)),{dataFormat:o,type:s,compressed:a,width:r,height:i,format:e,data:n}}_deduceImageSize(t,e,n){let r;return r="undefined"!==typeof ImageData&&t instanceof ImageData?{width:t.width,height:t.height}:"undefined"!==typeof HTMLImageElement&&t instanceof HTMLImageElement?{width:t.naturalWidth,height:t.naturalHeight}:"undefined"!==typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement?{width:t.width,height:t.height}:"undefined"!==typeof ImageBitmap&&t instanceof ImageBitmap?{width:t.width,height:t.height}:"undefined"!==typeof HTMLVideoElement&&t instanceof HTMLVideoElement?{width:t.videoWidth,height:t.videoHeight}:t?{width:e,height:n}:{width:e>=0?e:1,height:n>=0?n:1},zi(r,"Could not deduced texture size"),zi(void 0===e||r.width===e,"Deduced texture width does not match supplied width"),zi(void 0===n||r.height===n,"Deduced texture height does not match supplied height"),r}_createHandle(){return this.gl.createTexture()}_deleteHandle(){this.gl.deleteTexture(this.handle),this._trackDeallocatedMemory("Texture")}_getParameter(t){switch(t){case 4096:return this.width;case 4097:return this.height;default:this.gl.bindTexture(this.target,this.handle);const e=this.gl.getTexParameter(this.target,t);return this.gl.bindTexture(this.target,null),e}}_setParameter(t,e){switch(this.gl.bindTexture(this.target,this.handle),e=this._getNPOTParam(t,e),t){case 33082:case 33083:this.gl.texParameterf(this.handle,t,e);break;case 4096:case 4097:zi(!1);break;default:this.gl.texParameteri(this.target,t,e);break}return this.gl.bindTexture(this.target,null),this}_isNPOT(){return!Object(ci["e"])(this.gl)&&(!(!this.width||!this.height)&&(!Wi(this.width)||!Wi(this.height)))}_updateForNPOT(t){void 0===t[this.gl.TEXTURE_MIN_FILTER]&&(t[this.gl.TEXTURE_MIN_FILTER]=this.gl.LINEAR),void 0===t[this.gl.TEXTURE_WRAP_S]&&(t[this.gl.TEXTURE_WRAP_S]=this.gl.CLAMP_TO_EDGE),void 0===t[this.gl.TEXTURE_WRAP_T]&&(t[this.gl.TEXTURE_WRAP_T]=this.gl.CLAMP_TO_EDGE)}_getNPOTParam(t,e){if(this._isNPOT())switch(t){case 10241:-1===mo.indexOf(e)&&(e=9729);break;case 10242:case 10243:33071!==e&&(e=33071);break;default:break}return e}}let bo="";function _o(t,e){return zi("string"===typeof t),t=bo+t,new Promise((n,r)=>{try{const i=new Image;i.onload=()=>n(i),i.onerror=()=>r(new Error(`Could not load image ${t}.`)),i.crossOrigin=e&&e.crossOrigin||"anonymous",i.src=t}catch(i){r(i)}})}class wo extends vo{static isSupported(t,e){return vo.isSupported(t,e)}constructor(t,e={}){Object(ci["b"])(t),(e instanceof Promise||"string"===typeof e)&&(e={data:e}),"string"===typeof e.data&&(e=Object.assign({},e,{data:_o(e.data)})),super(t,Object.assign({},e,{target:3553})),this.initialize(e),Object.seal(this)}}const xo="EXT_color_buffer_float";var So={[33189]:{bpp:2},[33190]:{gl2:!0,bpp:3},[36012]:{gl2:!0,bpp:4},[36168]:{bpp:1},[34041]:{bpp:4},[35056]:{gl2:!0,bpp:4},[36013]:{gl2:!0,bpp:5},[32854]:{bpp:2},[36194]:{bpp:2},[32855]:{bpp:2},[33321]:{gl2:!0,bpp:1},[33330]:{gl2:!0,bpp:1},[33329]:{gl2:!0,bpp:1},[33332]:{gl2:!0,bpp:2},[33331]:{gl2:!0,bpp:2},[33334]:{gl2:!0,bpp:4},[33333]:{gl2:!0,bpp:4},[33323]:{gl2:!0,bpp:2},[33336]:{gl2:!0,bpp:2},[33335]:{gl2:!0,bpp:2},[33338]:{gl2:!0,bpp:4},[33337]:{gl2:!0,bpp:4},[33340]:{gl2:!0,bpp:8},[33339]:{gl2:!0,bpp:8},[32849]:{gl2:!0,bpp:3},[32856]:{gl2:!0,bpp:4},[32857]:{gl2:!0,bpp:4},[36220]:{gl2:!0,bpp:4},[36238]:{gl2:!0,bpp:4},[36975]:{gl2:!0,bpp:4},[36214]:{gl2:!0,bpp:8},[36232]:{gl2:!0,bpp:8},[36226]:{gl2:!0,bpp:16},[36208]:{gl2:!0,bpp:16},[33325]:{gl2:xo,bpp:2},[33327]:{gl2:xo,bpp:4},[34842]:{gl2:xo,bpp:8},[33326]:{gl2:xo,bpp:4},[33328]:{gl2:xo,bpp:8},[34836]:{gl2:xo,bpp:16},[35898]:{gl2:xo,bpp:4}};function Eo(t,e,n){const r=n[e];if(!r)return!1;const i=Object(ci["e"])(t)&&r.gl2||r.gl1;return"string"===typeof i?t.getExtension(i):i}class Ao extends Yi{static isSupported(t,{format:e}={format:null}){return!e||Eo(t,e,So)}static getSamplesForFormat(t,{format:e}){return t.getInternalformatParameter(36161,e,32937)}constructor(t,e={}){super(t,e),this.initialize(e),Object.seal(this)}initialize({format:t,width:e=1,height:n=1,samples:r=0}){return zi(t,"Needs format"),this._trackDeallocatedMemory(),this.gl.bindRenderbuffer(36161,this.handle),0!==r&&Object(ci["e"])(this.gl)?this.gl.renderbufferStorageMultisample(36161,r,t,e,n):this.gl.renderbufferStorage(36161,t,e,n),this.format=t,this.width=e,this.height=n,this.samples=r,this._trackAllocatedMemory(this.width*this.height*(this.samples||1)*So[this.format].bpp),this}resize({width:t,height:e}){return t!==this.width||e!==this.height?this.initialize({width:t,height:e,format:this.format,samples:this.samples}):this}_createHandle(){return this.gl.createRenderbuffer()}_deleteHandle(){this.gl.deleteRenderbuffer(this.handle),this._trackDeallocatedMemory()}_bindHandle(t){this.gl.bindRenderbuffer(36161,t)}_syncHandle(t){this.format=this.getParameter(36164),this.width=this.getParameter(36162),this.height=this.getParameter(36163),this.samples=this.getParameter(36011)}_getParameter(t){this.gl.bindRenderbuffer(36161,this.handle);const e=this.gl.getRenderbufferParameter(36161,t);return e}}const Mo=256,Co=1024,ko=16384,Oo=6144,Po=6145,To=6146,Lo=34041,Io="clear: bad arguments";function No(t,{framebuffer:e=null,color:n=null,depth:r=null,stencil:i=null}={}){const o={};e&&(o.framebuffer=e);let s=0;n&&(s|=ko,!0!==n&&(o.clearColor=n)),r&&(s|=Mo,!0!==r&&(o.clearDepth=r)),i&&(s|=Co,!0!==r&&(o.clearStencil=r)),zi(0!==s,Io),Object(li["d"])(t,o,()=>{t.clear(s)})}function Do(t,{framebuffer:e=null,buffer:n=Oo,drawBuffer:r=0,value:i=[0,0,0,0]}={}){Object(ci["a"])(t),Object(li["d"])(t,{framebuffer:e},()=>{switch(n){case Oo:switch(i.constructor){case Int32Array:t.clearBufferiv(n,r,i);break;case Uint32Array:t.clearBufferuiv(n,r,i);break;case Float32Array:default:t.clearBufferfv(n,r,i)}break;case Po:t.clearBufferfv(Po,0,[i]);break;case To:t.clearBufferiv(To,0,[i]);break;case Lo:const[e,o]=i;t.clearBufferfi(Lo,0,e,o);break;default:zi(!1,Io)}})}function Ro(t){switch(t){case 6406:case 33326:case 6403:return 1;case 33328:case 33319:return 2;case 6407:case 34837:return 3;case 6408:case 34836:return 4;default:return zi(!1),0}}function Fo(t){switch(t){case 5121:return 1;case 33635:case 32819:case 32820:return 2;case 5126:return 4;default:return zi(!1),0}}const Bo=[34069,34070,34071,34072,34073,34074];class jo extends vo{constructor(t,e={}){Object(ci["b"])(t),super(t,Object.assign({},e,{target:34067})),this.initialize(e),Object.seal(this)}initialize(t={}){const{mipmaps:e=!0,parameters:n={}}=t;return this.opts=t,this.setCubeMapImageData(t).then(()=>{this.loaded=!0,e&&this.generateMipmap(t),this.setParameters(n)}),this}subImage({face:t,data:e,x:n=0,y:r=0,mipmapLevel:i=0}){return this._subImage({target:t,data:e,x:n,y:r,mipmapLevel:i})}async setCubeMapImageData({width:t,height:e,pixels:n,data:r,border:i=0,format:o=6408,type:s=5121}){const{gl:a}=this,u=n||r,c=await Promise.all(Bo.map(t=>{const e=u[t];return Promise.all(Array.isArray(e)?e:[e])}));this.bind(),Bo.forEach((n,r)=>{c[r].length>1&&!1!==this.opts.mipmaps&&ui.warn(`${this.id} has mipmap and multiple LODs.`)(),c[r].forEach((r,u)=>{t&&e?a.texImage2D(n,u,o,t,e,i,o,s,r):a.texImage2D(n,u,o,o,s,r)})}),this.unbind()}setImageDataForFace(t){const{face:e,width:n,height:r,pixels:i,data:o,border:s=0,format:a=6408,type:u=5121}=t,{gl:c}=this,l=i||o;return this.bind(),l instanceof Promise?l.then(n=>this.setImageDataForFace(Object.assign({},t,{face:e,data:n,pixels:n}))):this.width||this.height?c.texImage2D(e,0,a,n,r,s,a,u,l):c.texImage2D(e,0,a,a,u,l),this}}jo.FACES=Bo;class zo extends vo{static isSupported(t){return Object(ci["e"])(t)}constructor(t,e={}){Object(ci["a"])(t),e=Object.assign({depth:1},e,{target:32879,unpackFlipY:!1}),super(t,e),this.initialize(e),Object.seal(this)}setImageData({level:t=0,dataFormat:e=6408,width:n,height:r,depth:i=1,border:o=0,format:s,type:a=5121,offset:u=0,data:c,parameters:l={}}){if(this._trackDeallocatedMemory("Texture"),this.gl.bindTexture(this.target,this.handle),Object(li["d"])(this.gl,l,()=>{ArrayBuffer.isView(c)&&this.gl.texImage3D(this.target,t,e,n,r,i,o,s,a,c),c instanceof co&&(this.gl.bindBuffer(35052,c.handle),this.gl.texImage3D(this.target,t,e,n,r,i,o,s,a,u))}),c&&c.byteLength)this._trackAllocatedMemory(c.byteLength,"Texture");else{const t=ho[this.dataFormat]||4,e=fo[this.type]||1;this._trackAllocatedMemory(this.width*this.height*this.depth*t*e,"Texture")}return this.loaded=!0,this}}function Uo(t,e){zi(t instanceof wo||t instanceof jo||t instanceof zo);const n=t.constructor,{gl:r,width:i,height:o,format:s,type:a,dataFormat:u,border:c,mipmaps:l}=t,h=Object.assign({width:i,height:o,format:s,type:a,dataFormat:u,border:c,mipmaps:l},e);return new n(r,h)}function $o(t,e){const{gl:n,width:r,height:i,id:o}=t,s=new os(n,Object.assign({},e,{id:`framebuffer-for-${o}`,width:r,height:i,attachments:{[36064]:t}}));return s}function Vo(t,e={}){const{sourceX:n=0,sourceY:r=0,sourceFormat:i=6408}=e;let{sourceAttachment:o=36064,target:s=null,sourceWidth:a,sourceHeight:u,sourceType:c}=e;const{framebuffer:l,deleteFramebuffer:h}=Ho(t);zi(l);const{gl:f,handle:d,attachments:p}=l;a=a||l.width,u=u||l.height,36064===o&&null===d&&(o=1028),zi(p[o]),c=c||p[o].type,s=Xo(s,c,i,a,u),c=c||Ki(s);const g=f.bindFramebuffer(36160,d);return f.readPixels(n,r,a,u,i,c,s),f.bindFramebuffer(36160,g||null),h&&l.delete(),s}function qo(t,{sourceX:e=0,sourceY:n=0,sourceFormat:r=6408,target:i=null,targetByteOffset:o=0,sourceWidth:s,sourceHeight:a,sourceType:u}){const{framebuffer:c,deleteFramebuffer:l}=Ho(t);zi(c),s=s||c.width,a=a||c.height;const h=Object(ci["a"])(c.gl);if(u=u||(i?i.type:5121),!i){const t=Ro(r),e=Fo(u),n=o+s*a*t*e;i=new co(h,{byteLength:n,accessor:{type:u,size:t}})}return i.bind({target:35051}),Object(li["d"])(h,{framebuffer:c},()=>{h.readPixels(e,n,s,a,r,u,o)}),i.unbind({target:35051}),l&&c.delete(),i}function Wo(t,{sourceAttachment:e=36064,targetMaxHeight:n=Number.MAX_SAFE_INTEGER}={}){let r=Vo(t,{sourceAttachment:e}),{width:i,height:o}=t;while(o>n)({data:r,width:i,height:o}=to({data:r,width:i,height:o}));Qi({data:r,width:i,height:o});const s=document.createElement("canvas");s.width=i,s.height=o;const a=s.getContext("2d"),u=a.createImageData(i,o);return u.data.set(r),a.putImageData(u,0,0),s.toDataURL()}function Go(t,e,n={}){const{sourceX:r=0,sourceY:i=0,targetMipmaplevel:o=0,targetInternalFormat:s=6408}=n;let{targetX:a,targetY:u,targetZ:c,width:l,height:h}=n;const{framebuffer:f,deleteFramebuffer:d}=Ho(t);zi(f);const{gl:p,handle:g}=f,m="undefined"!==typeof a||"undefined"!==typeof u||"undefined"!==typeof c;a=a||0,u=u||0,c=c||0;const y=p.bindFramebuffer(36160,g);zi(e);let v=null;if(e instanceof vo&&(v=e,l=Number.isFinite(l)?l:v.width,h=Number.isFinite(h)?h:v.height,v.bind(0),e=v.target),m)switch(e){case 3553:case 34067:p.copyTexSubImage2D(e,o,a,u,r,i,l,h);break;case 35866:case 32879:const t=Object(ci["a"])(p);t.copyTexSubImage3D(e,o,a,u,c,r,i,l,h);break;default:}else p.copyTexImage2D(e,o,s,r,i,l,h,0);return v&&v.unbind(),p.bindFramebuffer(36160,y||null),d&&f.delete(),v}function Ho(t){return t instanceof os?{framebuffer:t,deleteFramebuffer:!1}:{framebuffer:$o(t),deleteFramebuffer:!0}}function Xo(t,e,n,r,i){if(t)return t;e=e||5121;const o=Ji(e,{clamped:!1}),s=Ro(n);return new o(r*i*s)}const Yo={WEBGL2:"WEBGL2",VERTEX_ARRAY_OBJECT:"VERTEX_ARRAY_OBJECT",TIMER_QUERY:"TIMER_QUERY",INSTANCED_RENDERING:"INSTANCED_RENDERING",MULTIPLE_RENDER_TARGETS:"MULTIPLE_RENDER_TARGETS",ELEMENT_INDEX_UINT32:"ELEMENT_INDEX_UINT32",BLEND_EQUATION_MINMAX:"BLEND_EQUATION_MINMAX",FLOAT_BLEND:"FLOAT_BLEND",COLOR_ENCODING_SRGB:"COLOR_ENCODING_SRGB",TEXTURE_DEPTH:"TEXTURE_DEPTH",TEXTURE_FLOAT:"TEXTURE_FLOAT",TEXTURE_HALF_FLOAT:"TEXTURE_HALF_FLOAT",TEXTURE_FILTER_LINEAR_FLOAT:"TEXTURE_FILTER_LINEAR_FLOAT",TEXTURE_FILTER_LINEAR_HALF_FLOAT:"TEXTURE_FILTER_LINEAR_HALF_FLOAT",TEXTURE_FILTER_ANISOTROPIC:"TEXTURE_FILTER_ANISOTROPIC",COLOR_ATTACHMENT_RGBA32F:"COLOR_ATTACHMENT_RGBA32F",COLOR_ATTACHMENT_FLOAT:"COLOR_ATTACHMENT_FLOAT",COLOR_ATTACHMENT_HALF_FLOAT:"COLOR_ATTACHMENT_HALF_FLOAT",GLSL_FRAG_DATA:"GLSL_FRAG_DATA",GLSL_FRAG_DEPTH:"GLSL_FRAG_DEPTH",GLSL_DERIVATIVES:"GLSL_DERIVATIVES",GLSL_TEXTURE_LOD:"GLSL_TEXTURE_LOD"};function Zo(t){const e=new wo(t,{format:6408,type:5126,dataFormat:6408}),n=new os(t,{id:"test-framebuffer",check:!1,attachments:{[36064]:e}}),r=n.getStatus();return e.delete(),n.delete(),36053===r}var Ko={[Yo.WEBGL2]:[!1,!0],[Yo.VERTEX_ARRAY_OBJECT]:["OES_vertex_array_object",!0],[Yo.TIMER_QUERY]:["EXT_disjoint_timer_query","EXT_disjoint_timer_query_webgl2"],[Yo.INSTANCED_RENDERING]:["ANGLE_instanced_arrays",!0],[Yo.MULTIPLE_RENDER_TARGETS]:["WEBGL_draw_buffers",!0],[Yo.ELEMENT_INDEX_UINT32]:["OES_element_index_uint",!0],[Yo.BLEND_EQUATION_MINMAX]:["EXT_blend_minmax",!0],[Yo.FLOAT_BLEND]:["EXT_float_blend"],[Yo.COLOR_ENCODING_SRGB]:["EXT_sRGB",!0],[Yo.TEXTURE_DEPTH]:["WEBGL_depth_texture",!0],[Yo.TEXTURE_FLOAT]:["OES_texture_float",!0],[Yo.TEXTURE_HALF_FLOAT]:["OES_texture_half_float",!0],[Yo.TEXTURE_FILTER_LINEAR_FLOAT]:["OES_texture_float_linear"],[Yo.TEXTURE_FILTER_LINEAR_HALF_FLOAT]:["OES_texture_half_float_linear"],[Yo.TEXTURE_FILTER_ANISOTROPIC]:["EXT_texture_filter_anisotropic"],[Yo.COLOR_ATTACHMENT_RGBA32F]:[Zo,"EXT_color_buffer_float"],[Yo.COLOR_ATTACHMENT_FLOAT]:[!1,"EXT_color_buffer_float"],[Yo.COLOR_ATTACHMENT_HALF_FLOAT]:["EXT_color_buffer_half_float"],[Yo.GLSL_FRAG_DATA]:["WEBGL_draw_buffers",!0],[Yo.GLSL_FRAG_DEPTH]:["EXT_frag_depth",!0],[Yo.GLSL_DERIVATIVES]:["OES_standard_derivatives",!0],[Yo.GLSL_TEXTURE_LOD]:["EXT_shader_texture_lod",!0]};const Jo=2;function Qo(t,e){return ts(t,e)}function ts(t,e){return e=Array.isArray(e)?e:[e],e.every(e=>{return ns(t,e)})}function es(t){t.luma=t.luma||{},t.luma.caps=t.luma.caps||{};for(const e in Ko)void 0===t.luma.caps[e]&&(t.luma.caps[e]=ns(t,e));return t.luma.caps}function ns(t,e){return t.luma=t.luma||{},t.luma.caps=t.luma.caps||{},void 0===t.luma.caps[e]&&(t.luma.caps[e]=rs(t,e)),t.luma.caps[e]||ui.log(Jo,`Feature: ${e} not supported`)(),t.luma.caps[e]}function rs(t,e){const n=Ko[e];let r;zi(n,e);const i=Object(ci["e"])(t)&&n[1]||n[0];if("function"===typeof i)r=i(t);else if(Array.isArray(i)){r=!0;for(const e of i)r=r&&Boolean(t.getExtension(e))}else"string"===typeof i?r=Boolean(t.getExtension(i)):"boolean"===typeof i?r=i:zi(!1);return r}const is="Multiple render targets not supported";class os extends Yi{static isSupported(t,e={}){const{colorBufferFloat:n,colorBufferHalfFloat:r}=e;let i=!0;return n&&(i=Boolean(t.getExtension("EXT_color_buffer_float")||t.getExtension("WEBGL_color_buffer_float")||t.getExtension("OES_texture_float"))),r&&(i=i&&Boolean(t.getExtension("EXT_color_buffer_float")||t.getExtension("EXT_color_buffer_half_float"))),i}static getDefaultFramebuffer(t){return t.luma=t.luma||{},t.luma.defaultFramebuffer=t.luma.defaultFramebuffer||new os(t,{id:"default-framebuffer",handle:null,attachments:{}}),t.luma.defaultFramebuffer}get MAX_COLOR_ATTACHMENTS(){const t=Object(ci["a"])(this.gl);return t.getParameter(t.MAX_COLOR_ATTACHMENTS)}get MAX_DRAW_BUFFERS(){const t=Object(ci["a"])(this.gl);return t.getParameter(t.MAX_DRAW_BUFFERS)}constructor(t,e={}){super(t,e),this.width=null,this.height=null,this.attachments={},this.readBuffer=36064,this.drawBuffers=[36064],this.ownResources=[],this.initialize(e),Object.seal(this)}get color(){return this.attachments[36064]||null}get texture(){return this.attachments[36064]||null}get depth(){return this.attachments[36096]||this.attachments[33306]||null}get stencil(){return this.attachments[36128]||this.attachments[33306]||null}initialize({width:t=1,height:e=1,attachments:n=null,color:r=!0,depth:i=!0,stencil:o=!1,check:s=!0,readBuffer:a,drawBuffers:u}){if(zi(t>=0&&e>=0,"Width and height need to be integers"),this.width=t,this.height=e,n)for(const c in n){const r=n[c],i=Array.isArray(r)?r[0]:r;i.resize({width:t,height:e})}else n=this._createDefaultAttachments(r,i,o,t,e);this.update({clearAttachments:!0,attachments:n,readBuffer:a,drawBuffers:u}),n&&s&&this.checkStatus()}delete(){for(const t of this.ownResources)t.delete();return super.delete(),this}update({attachments:t={},readBuffer:e,drawBuffers:n,clearAttachments:r=!1,resizeAttachments:i=!0}){this.attach(t,{clearAttachments:r,resizeAttachments:i});const{gl:o}=this,s=o.bindFramebuffer(36160,this.handle);return e&&this._setReadBuffer(e),n&&this._setDrawBuffers(n),o.bindFramebuffer(36160,s||null),this}resize(t={}){let{width:e,height:n}=t;if(null===this.handle)return zi(void 0===e&&void 0===n),this.width=this.gl.drawingBufferWidth,this.height=this.gl.drawingBufferHeight,this;void 0===e&&(e=this.gl.drawingBufferWidth),void 0===n&&(n=this.gl.drawingBufferHeight),e!==this.width&&n!==this.height&&ui.log(2,`Resizing framebuffer ${this.id} to ${e}x${n}`)();for(const r in this.attachments)this.attachments[r].resize({width:e,height:n});return this.width=e,this.height=n,this}attach(t,{clearAttachments:e=!1,resizeAttachments:n=!0}={}){const r={};e&&Object.keys(this.attachments).forEach(t=>{r[t]=null}),Object.assign(r,t);const i=this.gl.bindFramebuffer(36160,this.handle);for(const o in r){zi(void 0!==o,"Misspelled framebuffer binding point?");const t=Number(o),e=r[t];let i=e;if(i)if(i instanceof Ao)this._attachRenderbuffer({attachment:t,renderbuffer:i});else if(Array.isArray(e)){const[n,r=0,o=0]=e;i=n,this._attachTexture({attachment:t,texture:n,layer:r,level:o})}else this._attachTexture({attachment:t,texture:i,layer:0,level:0});else this._unattach(t);n&&i&&i.resize({width:this.width,height:this.height})}this.gl.bindFramebuffer(36160,i||null),Object.assign(this.attachments,t),Object.keys(this.attachments).filter(t=>!this.attachments[t]).forEach(t=>{delete this.attachments[t]})}checkStatus(){const{gl:t}=this,e=this.getStatus();if(36053!==e)throw new Error(as(e));return this}getStatus(){const{gl:t}=this,e=t.bindFramebuffer(36160,this.handle),n=t.checkFramebufferStatus(36160);return t.bindFramebuffer(36160,e||null),n}clear(t={}){const{color:e,depth:n,stencil:r,drawBuffers:i=[]}=t,o=this.gl.bindFramebuffer(36160,this.handle);return(e||n||r)&&No(this.gl,{color:e,depth:n,stencil:r}),i.forEach((t,e)=>{Do(this.gl,{drawBuffer:e,value:t})}),this.gl.bindFramebuffer(36160,o||null),this}readPixels(t={}){return ui.error("Framebuffer.readPixels() is no logner supported, use readPixelsToArray(framebuffer)")(),null}readPixelsToBuffer(t={}){return ui.error("Framebuffer.readPixelsToBuffer()is no logner supported, use readPixelsToBuffer(framebuffer)")(),null}copyToDataUrl(t={}){return ui.error("Framebuffer.copyToDataUrl() is no logner supported, use copyToDataUrl(framebuffer)")(),null}copyToImage(t={}){return ui.error("Framebuffer.copyToImage() is no logner supported, use copyToImage(framebuffer)")(),null}copyToTexture(t={}){return ui.error("Framebuffer.copyToTexture({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}blit(t={}){return ui.error("Framebuffer.blit({...}) is no logner supported, use blit(source, target, opts)")(),null}invalidate({attachments:t=[],x:e=0,y:n=0,width:r,height:i}){const o=Object(ci["a"])(this.gl),s=o.bindFramebuffer(36008,this.handle),a=0===e&&0===n&&void 0===r&&void 0===i;return a?o.invalidateFramebuffer(36008,t):o.invalidateFramebuffer(36008,t,e,n,r,i),o.bindFramebuffer(36008,s),this}getAttachmentParameter(t,e,n){let r=this._getAttachmentParameterFallback(e);return null===r&&(this.gl.bindFramebuffer(36160,this.handle),r=this.gl.getFramebufferAttachmentParameter(36160,t,e),this.gl.bindFramebuffer(36160,null)),n&&r>1e3&&(r=$i(this.gl,r)),r}getAttachmentParameters(t=36064,e,n=this.constructor.ATTACHMENT_PARAMETERS||[]){const r={};for(const i of n){const n=e?$i(this.gl,i):i;r[n]=this.getAttachmentParameter(t,i,e)}return r}getParameters(t=!0){const e=Object.keys(this.attachments),n={};for(const r of e){const e=Number(r),i=t?$i(this.gl,e):e;n[i]=this.getAttachmentParameters(e,t)}return n}show(){return"undefined"!==typeof window&&window.open(Wo(this),"luma-debug-texture"),this}log(t=0,e=""){if(t>ui.level||"undefined"===typeof window)return this;e=e||`Framebuffer ${this.id}`;const n=Wo(this,{targetMaxHeight:100});return ui.image({logLevel:t,message:e,image:n},e)(),this}bind({target:t=36160}={}){return this.gl.bindFramebuffer(t,this.handle),this}unbind({target:t=36160}={}){return this.gl.bindFramebuffer(t,null),this}_createDefaultAttachments(t,e,n,r,i){let o=null;return t&&(o=o||{},o[36064]=new wo(this.gl,{id:`${this.id}-color0`,pixels:null,format:6408,type:5121,width:r,height:i,mipmaps:!1,parameters:{[10241]:9729,[10240]:9729,[10242]:33071,[10243]:33071}}),this.ownResources.push(o[36064])),e&&n?(o=o||{},o[33306]=new Ao(this.gl,{id:`${this.id}-depth-stencil`,format:35056,width:r,height:111}),this.ownResources.push(o[33306])):e?(o=o||{},o[36096]=new Ao(this.gl,{id:`${this.id}-depth`,format:33189,width:r,height:i}),this.ownResources.push(o[36096])):n&&zi(!1),o}_unattach(t){const e=this.attachments[t];e&&(e instanceof Ao?this.gl.framebufferRenderbuffer(36160,t,36161,null):this.gl.framebufferTexture2D(36160,t,3553,null,0),delete this.attachments[t])}_attachRenderbuffer({attachment:t=36064,renderbuffer:e}){const{gl:n}=this;n.framebufferRenderbuffer(36160,t,36161,e.handle),this.attachments[t]=e}_attachTexture({attachment:t=36064,texture:e,layer:n,level:r}){const{gl:i}=this;switch(i.bindTexture(e.target,e.handle),e.target){case 35866:case 32879:const o=Object(ci["a"])(i);o.framebufferTextureLayer(36160,t,e.target,r,n);break;case 34067:const s=ss(n);i.framebufferTexture2D(36160,t,s,e.handle,r);break;case 3553:i.framebufferTexture2D(36160,t,3553,e.handle,r);break;default:zi(!1,"Illegal texture type")}i.bindTexture(e.target,null),this.attachments[t]=e}_setReadBuffer(t){const e=Object(ci["c"])(this.gl);e?e.readBuffer(t):zi(36064===t||1029===t,is),this.readBuffer=t}_setDrawBuffers(t){const{gl:e}=this,n=Object(ci["a"])(e);if(n)n.drawBuffers(t);else{const n=e.getExtension("WEBGL_draw_buffers");n?n.drawBuffersWEBGL(t):zi(1===t.length&&(36064===t[0]||1029===t[0]),is)}this.drawBuffers=t}_getAttachmentParameterFallback(t){const e=es(this.gl);switch(t){case 36052:return e.WEBGL2?null:0;case 33298:case 33299:case 33300:case 33301:case 33302:case 33303:return e.WEBGL2?null:8;case 33297:return e.WEBGL2?null:5125;case 33296:return e.WEBGL2||e.EXT_sRGB?null:9729;default:return null}}_createHandle(){return this.gl.createFramebuffer()}_deleteHandle(){this.gl.deleteFramebuffer(this.handle)}_bindHandle(t){return this.gl.bindFramebuffer(36160,t)}}function ss(t){return t<34069?t+34069:t}function as(t){const e=os.STATUS||{};return e[t]||`Framebuffer error ${t}`}const us=[36049,36048,33296,33298,33299,33300,33301,33302,33303];os.ATTACHMENT_PARAMETERS=us;const cs={[5126]:As.bind(null,"uniform1fv",gs,1,Ms),[35664]:As.bind(null,"uniform2fv",gs,2,Ms),[35665]:As.bind(null,"uniform3fv",gs,3,Ms),[35666]:As.bind(null,"uniform4fv",gs,4,Ms),[5124]:As.bind(null,"uniform1iv",ms,1,Ms),[35667]:As.bind(null,"uniform2iv",ms,2,Ms),[35668]:As.bind(null,"uniform3iv",ms,3,Ms),[35669]:As.bind(null,"uniform4iv",ms,4,Ms),[35670]:As.bind(null,"uniform1iv",ms,1,Ms),[35671]:As.bind(null,"uniform2iv",ms,2,Ms),[35672]:As.bind(null,"uniform3iv",ms,3,Ms),[35673]:As.bind(null,"uniform4iv",ms,4,Ms),[35674]:As.bind(null,"uniformMatrix2fv",gs,4,Cs),[35675]:As.bind(null,"uniformMatrix3fv",gs,9,Cs),[35676]:As.bind(null,"uniformMatrix4fv",gs,16,Cs),[35678]:Es,[35680]:Es,[5125]:As.bind(null,"uniform1uiv",ys,1,Ms),[36294]:As.bind(null,"uniform2uiv",ys,2,Ms),[36295]:As.bind(null,"uniform3uiv",ys,3,Ms),[36296]:As.bind(null,"uniform4uiv",ys,4,Ms),[35685]:As.bind(null,"uniformMatrix2x3fv",gs,6,Cs),[35686]:As.bind(null,"uniformMatrix2x4fv",gs,8,Cs),[35687]:As.bind(null,"uniformMatrix3x2fv",gs,6,Cs),[35688]:As.bind(null,"uniformMatrix3x4fv",gs,12,Cs),[35689]:As.bind(null,"uniformMatrix4x2fv",gs,8,Cs),[35690]:As.bind(null,"uniformMatrix4x3fv",gs,12,Cs),[35678]:Es,[35680]:Es,[35679]:Es,[35682]:Es,[36289]:Es,[36292]:Es,[36293]:Es,[36298]:Es,[36299]:Es,[36300]:Es,[36303]:Es,[36306]:Es,[36307]:Es,[36308]:Es,[36311]:Es},ls={},hs={},fs={},ds=[0];function ps(t,e,n,r){1===e&&"boolean"===typeof t&&(t=t?1:0),Number.isFinite(t)&&(ds[0]=t,t=ds);const i=t.length;if(i%e&&ui.warn(`Uniform size should be multiples of ${e}`,t)(),t instanceof n)return t;let o=r[i];o||(o=new n(i),r[i]=o);for(let s=0;s<i;s++)o[s]=t[s];return o}function gs(t,e){return ps(t,e,Float32Array,ls)}function ms(t,e){return ps(t,e,Int32Array,hs)}function ys(t,e){return ps(t,e,Uint32Array,fs)}function vs(t,e,n){const r=cs[n.type];if(!r)throw new Error(`Unknown GLSL uniform type ${n.type}`);return r().bind(null,t,e)}function bs(t){if("]"!==t[t.length-1])return{name:t,length:1,isArray:!1};const e=/([^[]*)(\[[0-9]+\])?/,n=t.match(e);if(!n||n.length<2)throw new Error(`Failed to parse GLSL uniform name ${t}`);return{name:n[1],length:n[2]||1,isArray:Boolean(n[2])}}function _s(t,e,n){for(const r in t){const i=t[r],o=!n||Boolean(n[r]);if(o&&!ws(i))throw e=e?`${e} `:"",console.error(`${e} Bad uniform ${r}`,i),new Error(`${e} Bad uniform ${r}`)}return!0}function ws(t){return Array.isArray(t)||ArrayBuffer.isView(t)?Ss(t):!!isFinite(t)||(!0===t||!1===t||(t instanceof vo||(t instanceof Ao||t instanceof os&&Boolean(t.texture))))}function xs(t,e,n){if(Array.isArray(n)||ArrayBuffer.isView(n))if(t[e]){const r=t[e];for(let t=0,e=n.length;t<e;++t)r[t]=n[t]}else t[e]=n.slice();else t[e]=n}function Ss(t){if(0===t.length)return!1;const e=Math.min(t.length,16);for(let n=0;n<e;++n)if(!Number.isFinite(t[n]))return!1;return!0}function Es(){let t=null;return(e,n,r)=>{const i=t!==r;return i&&(e.uniform1i(n,r),t=r),i}}function As(t,e,n,r){let i=null,o=null;return(s,a,u)=>{const c=e(u,n),l=c.length;let h=!1;if(null===i)i=new Float32Array(l),o=l,h=!0;else{zi(o===l,"Uniform length cannot change.");for(let t=0;t<l;++t)if(c[t]!==i[t]){h=!0;break}}return h&&(r(s,t,a,c),i.set(c)),h}}function Ms(t,e,n,r){t[e](n,r)}function Cs(t,e,n,r){t[e](n,!1,r)}function ks(t,e="unnamed"){const n=/#define[\s*]SHADER_NAME[\s*]([A-Za-z0-9_-]+)[\s*]/,r=t.match(n);return r?r[1]:e}const Os=35632,Ps=35633;function Ts(t){switch(t){case Os:return"fragment";case Ps:return"vertex";default:return"unknown type"}}function Ls(t,e,n,r){const i=t.split(/\r?\n/),o={},s={},a=r||ks(e)||"(unnamed)",u=`${Ts(n)} shader ${a}`;for(let l=0;l<i.length;l++){const e=i[l];if(e.length<=1)continue;const n=e.split(":"),r=n[0],a=parseInt(n[2],10);if(isNaN(a))throw new Error(`GLSL compilation error in ${u}: ${t}`);"WARNING"!==r?o[a]=e:s[a]=e}const c=Ns(e);return{shaderName:u,errors:Is(o,c),warnings:Is(s,c)}}function Is(t,e){let n="";for(let r=0;r<e.length;r++){const i=e[r];if((t[r+3]||t[r+2]||t[r+1])&&(n+=`${i}\n`,t[r+1])){const e=t[r+1],i=e.split(":",3),o=i[0],s=parseInt(i[1],10)||0,a=e.substring(i.join(":").length+1).trim();n+=Ds(`^^^ ${o}: ${a}\n\n`,s)}}return n}function Ns(t,e=1,n=": "){const r=t.split(/\r?\n/),i=String(r.length+e-1).length;return r.map((t,r)=>{const o=String(r+e),s=o.length,a=Ds(o,i-s);return a+n+t})}function Ds(t,e){let n="";for(let r=0;r<e;++r)n+=" ";return`${n}${t}`}const Rs="Shader: GLSL source code must be a JavaScript string";class Fs extends Yi{static getTypeName(t){switch(t){case 35633:return"vertex-shader";case 35632:return"fragment-shader";default:return zi(!1),"unknown"}}constructor(t,e){Object(ci["b"])(t),zi("string"===typeof e.source,Rs);const n=ks(e.source,null)||e.id||qi(`unnamed ${Fs.getTypeName(e.shaderType)}`);super(t,{id:n}),this.shaderType=e.shaderType,this.source=e.source,this.initialize(e)}initialize({source:t}){const e=ks(t,null);e&&(this.id=qi(e)),this._compile(t)}getParameter(t){return this.gl.getShaderParameter(this.handle,t)}toString(){return`${Fs.getTypeName(this.shaderType)}:${this.id}`}getName(){return ks(this.source)||"unnamed-shader"}getSource(){return this.gl.getShaderSource(this.handle)}getTranslatedSource(){const t=this.gl.getExtension("WEBGL_debug_shaders");return t?t.getTranslatedShaderSource(this.handle):"No translated source available. WEBGL_debug_shaders not implemented"}_compile(t=this.source){t.startsWith("#version ")||(t=`#version 100\n${t}`),this.source=t,this.gl.shaderSource(this.handle,this.source),this.gl.compileShader(this.handle);const e=this.getParameter(35713);if(!e){const t=this.gl.getShaderInfoLog(this.handle),{shaderName:e,errors:n,warnings:r}=Ls(t,this.source,this.shaderType,this.id);throw ui.error(`GLSL compilation errors in ${e}\n${n}`)(),ui.warn(`GLSL compilation warnings in ${e}\n${r}`)(),new Error(`GLSL compilation errors in ${e}`)}}_deleteHandle(){this.gl.deleteShader(this.handle)}_getOptsFromHandle(){return{type:this.getParameter(35663),source:this.getSource()}}}class Bs extends Fs{constructor(t,e){"string"===typeof e&&(e={source:e}),super(t,Object.assign({},e,{shaderType:35633}))}_createHandle(){return this.gl.createShader(35633)}}class js extends Fs{constructor(t,e){"string"===typeof e&&(e={source:e}),super(t,Object.assign({},e,{shaderType:35632}))}_createHandle(){return this.gl.createShader(35632)}}const zs=5120,Us=5121,$s=5122,Vs=5123,qs=0,Ws=1,Gs=2,Hs=3,Xs=4,Ys=5,Zs=6,Ks=5126,Js=35664,Qs=35665,ta=35666,ea=5124,na=35667,ra=35668,ia=35669,oa=5125,sa=36294,aa=36295,ua=36296,ca=35670,la=35671,ha=35672,fa=35673,da=35674,pa=35675,ga=35676,ma=35685,ya=35686,va=35687,ba=35688,_a=35689,wa=35690,xa={[Ks]:[Ks,1,"float"],[Js]:[Ks,2,"vec2"],[Qs]:[Ks,3,"vec3"],[ta]:[Ks,4,"vec4"],[ea]:[ea,1,"int"],[na]:[ea,2,"ivec2"],[ra]:[ea,3,"ivec3"],[ia]:[ea,4,"ivec4"],[oa]:[oa,1,"uint"],[sa]:[oa,2,"uvec2"],[aa]:[oa,3,"uvec3"],[ua]:[oa,4,"uvec4"],[ca]:[Ks,1,"bool"],[la]:[Ks,2,"bvec2"],[ha]:[Ks,3,"bvec3"],[fa]:[Ks,4,"bvec4"],[da]:[Ks,8,"mat2"],[ma]:[Ks,8,"mat2x3"],[ya]:[Ks,8,"mat2x4"],[pa]:[Ks,12,"mat3"],[va]:[Ks,12,"mat3x2"],[ba]:[Ks,12,"mat3x4"],[ga]:[Ks,16,"mat4"],[_a]:[Ks,16,"mat4x2"],[wa]:[Ks,16,"mat4x3"]};function Sa(t){switch(t){case qs:return qs;case Ws:return Ws;case Hs:return Ws;case Gs:return Ws;case Xs:return Xs;case Ys:return Xs;case Zs:return Xs;default:return zi(!1),0}}function Ea(t){const e=xa[t];if(!e)return null;const[n,r]=e;return{type:n,components:r}}function Aa(t,e){switch(t){case zs:case Us:case $s:case Vs:t=Ks;break;default:}for(const n in xa){const[r,i,o]=xa[n];if(r===t&&i===e)return{glType:n,name:o}}return null}class Ma{constructor(t){this.id=t.id,this.attributeInfos=[],this.attributeInfosByName={},this.attributeInfosByLocation=[],this.varyingInfos=[],this.varyingInfosByName={},Object.seal(this),this._readAttributesFromProgram(t),this._readVaryingsFromProgram(t)}getAttributeInfo(t){const e=Number(t);return Number.isFinite(e)?this.attributeInfosByLocation[e]:this.attributeInfosByName[t]||null}getAttributeLocation(t){const e=this.getAttributeInfo(t);return e?e.location:-1}getAttributeAccessor(t){const e=this.getAttributeInfo(t);return e?e.accessor:null}getVaryingInfo(t){const e=Number(t);return Number.isFinite(e)?this.varyingInfos[e]:this.varyingInfosByName[t]||null}getVaryingIndex(t){const e=this.getVaryingInfo();return e?e.location:-1}getVaryingAccessor(t){const e=this.getVaryingInfo();return e?e.accessor:null}_readAttributesFromProgram(t){const{gl:e}=t,n=e.getProgramParameter(t.handle,35721);for(let r=0;r<n;r++){const{name:n,type:i,size:o}=e.getActiveAttrib(t.handle,r),s=e.getAttribLocation(t.handle,n);s>=0&&this._addAttribute(s,n,i,o)}this.attributeInfos.sort((t,e)=>t.location-e.location)}_readVaryingsFromProgram(t){const{gl:e}=t;if(!Object(ci["e"])(e))return;const n=e.getProgramParameter(t.handle,35971);for(let r=0;r<n;r++){const{name:n,type:i,size:o}=e.getTransformFeedbackVarying(t.handle,r);this._addVarying(r,n,i,o)}this.varyingInfos.sort((t,e)=>t.location-e.location)}_addAttribute(t,e,n,r){const{type:i,components:o}=Ea(n),s={type:i,size:r*o};this._inferProperties(t,e,s);const a={location:t,name:e,accessor:new io(s)};this.attributeInfos.push(a),this.attributeInfosByLocation[t]=a,this.attributeInfosByName[a.name]=a}_inferProperties(t,e,n){/instance/i.test(e)&&(n.divisor=1)}_addVarying(t,e,n,r){const{type:i,components:o}=Ea(n),s=new io({type:i,size:r*o}),a={location:t,name:e,accessor:s};this.varyingInfos.push(a),this.varyingInfosByName[a.name]=a}}const Ca=4,ka=35981,Oa=["setVertexArray","setAttributes","setBuffers","unsetBuffers","use","getUniformCount","getUniformInfo","getUniformLocation","getUniformValue","getVarying","getFragDataLocation","getAttachedShaders","getAttributeCount","getAttributeLocation","getAttributeInfo"];class Pa extends Yi{constructor(t,e={}){super(t,e),this.stubRemovedMethods("Program","v6.0",Oa),this._isCached=!1,this.initialize(e),Object.seal(this),this._setId(e.id)}initialize(t={}){const{hash:e,vs:n,fs:r,varyings:i,bufferMode:o=ka}=t;return this.hash=e||"",this.vs="string"===typeof n?new Bs(this.gl,{id:`${t.id}-vs`,source:n}):n,this.fs="string"===typeof r?new js(this.gl,{id:`${t.id}-fs`,source:r}):r,zi(this.vs instanceof Bs),zi(this.fs instanceof js),this.uniforms={},this._textureUniforms={},i&&i.length>0&&(Object(ci["a"])(this.gl),this.varyings=i,this.gl2.transformFeedbackVaryings(this.handle,i,o)),this._compileAndLink(),this._readUniformLocationsFromLinkedProgram(),this.configuration=new Ma(this),this.setProps(t)}delete(t={}){return this._isCached?this:super.delete(t)}setProps(t){return"uniforms"in t&&this.setUniforms(t.uniforms),this}draw({logPriority:t,drawMode:e=4,vertexCount:n,offset:r=0,start:i,end:o,isIndexed:s=!1,indexType:a=5123,instanceCount:u=0,isInstanced:c=u>0,vertexArray:l=null,transformFeedback:h,framebuffer:f,parameters:d={},uniforms:p,samplers:g}){if((p||g)&&(ui.deprecated("Program.draw({uniforms})","Program.setUniforms(uniforms)")(),this.setUniforms(p||{})),ui.priority>=t){const r=f?f.id:"default",i=`mode=${$i(this.gl,e)} verts=${n} `+`instances=${u} indexType=${$i(this.gl,a)} `+`isInstanced=${c} isIndexed=${s} `+`Framebuffer=${r}`;ui.log(t,i)()}return zi(l),this.gl.useProgram(this.handle),!(!this._areTexturesRenderable()||0===n||c&&0===u)&&(l.bindForDraw(n,u,()=>{if(void 0!==f&&(d=Object.assign({},d,{framebuffer:f})),h){const t=Sa(e);h.begin(t)}this._bindTextures(),Object(li["d"])(this.gl,d,()=>{s&&c?this.gl2.drawElementsInstanced(e,n,a,r,u):s&&Object(ci["e"])(this.gl)&&!isNaN(i)&&!isNaN(o)?this.gl2.drawRangeElements(e,i,o,n,a,r):s?this.gl.drawElements(e,n,a,r):c?this.gl2.drawArraysInstanced(e,r,n,u):this.gl.drawArrays(e,r,n)}),h&&h.end()}),!0)}setUniforms(t={}){ui.priority>=2&&_s(t,this.id,this._uniformSetters),this.gl.useProgram(this.handle);for(const e in t){const n=t[e],r=this._uniformSetters[e];if(r){let t=n,i=!1;if(t instanceof os&&(t=t.texture),t instanceof vo)if(i=this.uniforms[e]!==n,i){void 0===r.textureIndex&&(r.textureIndex=this._textureIndexCounter++);const n=t,{textureIndex:i}=r;n.bind(i),t=i,this._textureUniforms[e]=n}else t=r.textureIndex;else this._textureUniforms[e]&&delete this._textureUniforms[e];(r(t)||i)&&xs(this.uniforms,e,n)}}return this}_areTexturesRenderable(){let t=!0;for(const e in this._textureUniforms){const n=this._textureUniforms[e];n.update(),t=t&&n.loaded}return t}_bindTextures(){for(const t in this._textureUniforms){const e=this._uniformSetters[t].textureIndex;this._textureUniforms[t].bind(e)}}_createHandle(){return this.gl.createProgram()}_deleteHandle(){this.gl.deleteProgram(this.handle)}_getOptionsFromHandle(t){const e=this.gl.getAttachedShaders(t),n={};for(const r of e){const t=this.gl.getShaderParameter(this.handle,35663);switch(t){case 35633:n.vs=new Bs({handle:r});break;case 35632:n.fs=new js({handle:r});break;default:}}return n}_getParameter(t){return this.gl.getProgramParameter(this.handle,t)}_setId(t){if(!t){const t=this._getName();this.id=qi(t)}}_getName(){let t=this.vs.getName()||this.fs.getName();return t=t.replace(/shader/i,""),t=t?`${t}-program`:"program",t}_compileAndLink(){const{gl:t}=this;if(t.attachShader(this.handle,this.vs.handle),t.attachShader(this.handle,this.fs.handle),ui.time(Ca,`linkProgram for ${this._getName()}`)(),t.linkProgram(this.handle),ui.timeEnd(Ca,`linkProgram for ${this._getName()}`)(),t.debug||ui.level>0){const e=t.getProgramParameter(this.handle,35714);if(!e)throw new Error(`Error linking: ${t.getProgramInfoLog(this.handle)}`);t.validateProgram(this.handle);const n=t.getProgramParameter(this.handle,35715);if(!n)throw new Error(`Error validating: ${t.getProgramInfoLog(this.handle)}`)}}_readUniformLocationsFromLinkedProgram(){const{gl:t}=this;this._uniformSetters={},this._uniformCount=this._getParameter(35718);for(let e=0;e<this._uniformCount;e++){const n=this.gl.getActiveUniform(this.handle,e),{name:r}=bs(n.name);let i=t.getUniformLocation(this.handle,r);if(this._uniformSetters[r]=vs(t,i,n),n.size>1)for(let e=0;e<n.size;e++)i=t.getUniformLocation(this.handle,`${r}[${e}]`),this._uniformSetters[`${r}[${e}]`]=vs(t,i,n)}this._textureIndexCounter=0}getActiveUniforms(t,e){return this.gl2.getActiveUniforms(this.handle,t,e)}getUniformBlockIndex(t){return this.gl2.getUniformBlockIndex(this.handle,t)}getActiveUniformBlockParameter(t,e){return this.gl2.getActiveUniformBlockParameter(this.handle,t,e)}uniformBlockBinding(t,e){this.gl2.uniformBlockBinding(this.handle,t,e)}}class Ta{static getDefaultProgramManager(t){return t.luma=t.luma||{},t.luma.defaultProgramManager=t.luma.defaultProgramManager||new Ta(t),t.luma.defaultProgramManager}constructor(t){this.gl=t,this._programCache={},this._getUniforms={},this._registeredModules={},this._hookFunctions=[],this._defaultModules=[],this._hashes={},this._hashCounter=0,this.stateHash=0,this._useCounts={}}addDefaultModule(t){this._defaultModules.find(e=>e.name===t.name)||this._defaultModules.push(t),this.stateHash++}removeDefaultModule(t){const e="string"===typeof t?t:t.name;this._defaultModules=this._defaultModules.filter(t=>t.name!==e),this.stateHash++}addShaderHook(t,e){e&&(t=Object.assign(e,{hook:t})),this._hookFunctions.push(t),this.stateHash++}get(t={}){const{vs:e="",fs:n="",defines:r={},inject:i={},varyings:o=[],bufferMode:s=35981,transpileToGLSL100:a=!1}=t,u=this._getModuleList(t.modules),c=this._getHash(e),l=this._getHash(n),h=u.map(t=>this._getHash(t.name)).sort(),f=o.map(t=>this._getHash(t)),d=Object.keys(r).sort(),p=Object.keys(i).sort(),g=[],m=[];for(const v of d)g.push(this._getHash(v)),g.push(this._getHash(r[v]));for(const v of p)m.push(this._getHash(v)),m.push(this._getHash(i[v]));const y=`${c}/${l}D${g.join("/")}M${h.join("/")}I${m.join("/")}V${f.join("/")}H${this.stateHash}B${s}${a?"T":""}`;if(!this._programCache[y]){const t=Cr(this.gl,{vs:e,fs:n,modules:u,inject:i,defines:r,hookFunctions:this._hookFunctions,transpileToGLSL100:a});this._programCache[y]=new Pa(this.gl,{hash:y,vs:t.vs,fs:t.fs,varyings:o,bufferMode:s}),this._getUniforms[y]=t.getUniforms||(t=>{}),this._useCounts[y]=0}return this._useCounts[y]++,this._programCache[y]}getUniforms(t){return this._getUniforms[t.hash]||null}release(t){const e=t.hash;this._useCounts[e]--,0===this._useCounts[e]&&(this._programCache[e].delete(),delete this._programCache[e],delete this._getUniforms[e],delete this._useCounts[e])}_getHash(t){return void 0===this._hashes[t]&&(this._hashes[t]=this._hashCounter++),this._hashes[t]}_getModuleList(t=[]){const e=new Array(this._defaultModules.length+t.length),n={};let r=0;for(let i=0,o=this._defaultModules.length;i<o;++i){const t=this._defaultModules[i],o=t.name;e[r++]=t,n[o]=!0}for(let i=0,o=t.length;i<o;++i){const o=t[i],s=o.name;n[s]||(e[r++]=o,n[s]=!0)}return e.length=r,e}}const La=[255,255,255],Ia=1;let Na=0;class Da{constructor(t={}){const{color:e=La}=t,{intensity:n=Ia}=t;this.id=t.id||"ambient-".concat(Na++),this.color=e,this.intensity=n,this.type="ambient"}}var Ra=n("56f3");const Fa=[255,255,255],Ba=1,ja=[0,0,-1];let za=0;class Ua{constructor(t={}){const{color:e=Fa}=t,{intensity:n=Ba}=t,{direction:r=ja}=t,{_shadow:i=!1}=t;this.id=t.id||"directional-".concat(za++),this.color=e,this.intensity=n,this.type="directional",this.direction=new Ra["b"](r).normalize().toArray(),this.shadow=i}getProjectedLight(){return this}}class $a{constructor(t={}){const{id:e="effect"}=t;this.id=e,this.props={...t}}preRender(){}getModuleParameters(){}cleanup(){}}class Va{constructor(t,e={}){const{id:n="pass"}=e;this.id=n,this.gl=t,this.props={...e}}setProps(t){Object.assign(this.props,t)}render(){}cleanup(){}}class qa extends Va{render(t){const e=this.gl;return Object(li["c"])(e,{framebuffer:t.target}),this._drawLayers(t)}_drawLayers(t){const{viewports:e,views:n,onViewportActive:r,clearCanvas:i=!0}=t;t.pass=t.pass||"unknown";const o=this.gl;i&&Ha(o);const s=[];for(const a of e){const e=a.viewport||a,i=n&&n[e.id];r(e);const u=this._getDrawLayerParams(e,t);t.view=i;const c=e.subViewports||[e];for(const n of c){t.viewport=n;const e=this._drawLayersInViewport(o,t,u);s.push(e)}}return s}_getDrawLayerParams(t,{layers:e,pass:n,layerFilter:r,effects:i,moduleParameters:o}){const s=[],a=Wa(),u={viewport:t,isPicking:n.startsWith("picking"),renderPass:n},c={};for(let l=0;l<e.length;l++){const h=e[l],f=this._shouldDrawLayer(h,u,r,c),d=a(h,f),p={shouldDrawLayer:f,layerRenderIndex:d};f&&(p.moduleParameters=this._getModuleParameters(h,i,n,o),p.layerParameters=this.getLayerParameters(h,l,t)),s[l]=p}return s}_drawLayersInViewport(t,{layers:e,pass:n,viewport:r,view:i},o){const s=Ga(t,{viewport:r});if(i&&i.props.clear){const e=!0===i.props.clear?{color:!0,depth:!0}:i.props.clear;Object(li["d"])(t,{scissorTest:!0,scissor:s},()=>No(t,e))}const a={totalCount:e.length,visibleCount:0,compositeCount:0,pickableCount:0};Object(li["c"])(t,{viewport:s});for(let c=0;c<e.length;c++){const t=e[c],{shouldDrawLayer:i,layerRenderIndex:s,moduleParameters:l,layerParameters:h}=o[c];if(i&&t.props.pickable&&a.pickableCount++,t.isComposite)a.compositeCount++;else if(i){a.visibleCount++,l.viewport=r;try{t.drawLayer({moduleParameters:l,uniforms:{layerIndex:s},parameters:h})}catch(u){t.raiseError(u,"drawing ".concat(t," to ").concat(n))}}}return a}shouldDrawLayer(t){return!0}getModuleParameters(t,e){return null}getLayerParameters(t,e){return t.props.parameters}_shouldDrawLayer(t,e,n,r){const i=this.shouldDrawLayer(t)&&t.props.visible;if(!i)return!1;e.layer=t;let o=t.parent;while(o){if(!o.props.visible||!o.filterSubLayer(e))return!1;e.layer=o,o=o.parent}if(n){const t=e.layer.id;if(t in r||(r[t]=n(e)),!r[t])return!1}return t.activateViewport(e.viewport),!0}_getModuleParameters(t,e,n,r){const i=Object.assign(Object.create(t.props),{autoWrapLongitude:t.wrapLongitude,viewport:t.context.viewport,mousePosition:t.context.mousePosition,pickingActive:0,devicePixelRatio:pi(this.gl)});if(e)for(const o of e)Object.assign(i,o.getModuleParameters(t));return Object.assign(i,this.getModuleParameters(t,e),r)}}function Wa(t=0,e={}){const n={},r=(i,o)=>{const s=i.props._offset,a=i.id,u=i.parent&&i.parent.id;let c;if(!u||u in e||r(i.parent,!1),u in n){const t=n[u]=n[u]||Wa(e[u],e);c=t(i,o),n[a]=t}else Number.isFinite(s)?(c=s+(e[u]||0),n[a]=null):c=t;return o&&c>=t&&(t=c+1),e[a]=c,c};return r}function Ga(t,{viewport:e}){const n=t.canvas?t.canvas.clientHeight||t.canvas.height:100,r=e,i=pi(t);return[r.x*i,(n-r.y-r.height)*i,r.width*i,r.height*i]}function Ha(t){const e=t.drawingBufferWidth,n=t.drawingBufferHeight;Object(li["c"])(t,{viewport:[0,0,e,n]}),t.clear(16640)}class Xa extends qa{constructor(t,e){super(t,e),this.shadowMap=new wo(t,{width:1,height:1,parameters:{[10241]:9729,[10240]:9729,[10242]:33071,[10243]:33071}}),this.depthBuffer=new Ao(t,{format:33189,width:1,height:1}),this.fbo=new os(t,{id:"shadowmap",width:1,height:1,attachments:{[36064]:this.shadowMap,[36096]:this.depthBuffer}})}render(t){const e=this.fbo;Object(li["d"])(this.gl,{depthRange:[0,1],depthTest:!0,blend:!1,clearColor:[1,1,1,1]},()=>{const n=t.viewports[0],r=pi(this.gl),i=n.width*r,o=n.height*r;i===e.width&&o===e.height||e.resize({width:i,height:o}),super.render({...t,target:e,pass:"shadow"})})}shouldDrawLayer(t){return!1!==t.props.shadowEnabled}getModuleParameters(){return{drawToShadowMap:!0}}delete(){this.fbo&&(this.fbo.delete(),this.fbo=null),this.shadowMap&&(this.shadowMap.delete(),this.shadowMap=null),this.depthBuffer&&(this.depthBuffer.delete(),this.depthBuffer=null)}}const Ya="#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND\nconst float TWO_PI = 6.2831854820251465;\nconst float PI_2 = 1.5707963705062866;\nconst float PI_16 = 0.1963495463132858;\n\nconst float SIN_TABLE_0 = 0.19509032368659973;\nconst float SIN_TABLE_1 = 0.3826834261417389;\nconst float SIN_TABLE_2 = 0.5555702447891235;\nconst float SIN_TABLE_3 = 0.7071067690849304;\n\nconst float COS_TABLE_0 = 0.9807852506637573;\nconst float COS_TABLE_1 = 0.9238795042037964;\nconst float COS_TABLE_2 = 0.8314695954322815;\nconst float COS_TABLE_3 = 0.7071067690849304;\n\nconst float INVERSE_FACTORIAL_3 = 1.666666716337204e-01;\nconst float INVERSE_FACTORIAL_5 = 8.333333767950535e-03;\nconst float INVERSE_FACTORIAL_7 = 1.9841270113829523e-04;\nconst float INVERSE_FACTORIAL_9 = 2.75573188446287533e-06;\n\nfloat sin_taylor_fp32(float a) {\n  float r, s, t, x;\n\n  if (a == 0.0) {\n    return 0.0;\n  }\n\n  x = -a * a;\n  s = a;\n  r = a;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_3;\n  s = s + t;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_5;\n  s = s + t;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_7;\n  s = s + t;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_9;\n  s = s + t;\n\n  return s;\n}\n\nvoid sincos_taylor_fp32(float a, out float sin_t, out float cos_t) {\n  if (a == 0.0) {\n    sin_t = 0.0;\n    cos_t = 1.0;\n  }\n  sin_t = sin_taylor_fp32(a);\n  cos_t = sqrt(1.0 - sin_t * sin_t);\n}\n\nfloat tan_taylor_fp32(float a) {\n    float sin_a;\n    float cos_a;\n\n    if (a == 0.0) {\n        return 0.0;\n    }\n    float z = floor(a / TWO_PI);\n    float r = a - TWO_PI * z;\n\n    float t;\n    float q = floor(r / PI_2 + 0.5);\n    int j = int(q);\n\n    if (j < -2 || j > 2) {\n        return 1.0 / 0.0;\n    }\n\n    t = r - PI_2 * q;\n\n    q = floor(t / PI_16 + 0.5);\n    int k = int(q);\n    int abs_k = int(abs(float(k)));\n\n    if (abs_k > 4) {\n        return 1.0 / 0.0;\n    } else {\n        t = t - PI_16 * q;\n    }\n\n    float u = 0.0;\n    float v = 0.0;\n\n    float sin_t, cos_t;\n    float s, c;\n    sincos_taylor_fp32(t, sin_t, cos_t);\n\n    if (k == 0) {\n        s = sin_t;\n        c = cos_t;\n    } else {\n        if (abs(float(abs_k) - 1.0) < 0.5) {\n            u = COS_TABLE_0;\n            v = SIN_TABLE_0;\n        } else if (abs(float(abs_k) - 2.0) < 0.5) {\n            u = COS_TABLE_1;\n            v = SIN_TABLE_1;\n        } else if (abs(float(abs_k) - 3.0) < 0.5) {\n            u = COS_TABLE_2;\n            v = SIN_TABLE_2;\n        } else if (abs(float(abs_k) - 4.0) < 0.5) {\n            u = COS_TABLE_3;\n            v = SIN_TABLE_3;\n        }\n        if (k > 0) {\n            s = u * sin_t + v * cos_t;\n            c = u * cos_t - v * sin_t;\n        } else {\n            s = u * sin_t - v * cos_t;\n            c = u * cos_t + v * sin_t;\n        }\n    }\n\n    if (j == 0) {\n        sin_a = s;\n        cos_a = c;\n    } else if (j == 1) {\n        sin_a = c;\n        cos_a = -s;\n    } else if (j == -1) {\n        sin_a = -c;\n        cos_a = s;\n    } else {\n        sin_a = -s;\n        cos_a = -c;\n    }\n    return sin_a / cos_a;\n}\n#endif\n\nfloat tan_fp32(float a) {\n#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND\n  return tan_taylor_fp32(a);\n#else\n  return tan(a);\n#endif\n}\n",Za={name:"fp32",vs:Ya,fs:null},Ka="\nstruct VertexGeometry {\n  vec4 position;\n  vec3 worldPosition;\n  vec3 worldPositionAlt;\n  vec3 normal;\n  vec2 uv;\n  vec3 pickingColor;\n} geometry = VertexGeometry(\n  vec4(0.0),\n  vec3(0.0),\n  vec3(0.0),\n  vec3(0.0),\n  vec2(0.0),\n  vec3(0.0)\n);\n",Ja="\n#define SMOOTH_EDGE_RADIUS 0.5\n\nstruct FragmentGeometry {\n  vec2 uv;\n} geometry;\n\nfloat smoothedge(float edge, float x) {\n  return smoothstep(edge - SMOOTH_EDGE_RADIUS, edge + SMOOTH_EDGE_RADIUS, x);\n}\n";var Qa={name:"geometry",vs:Ka,fs:Ja};const tu=Object.keys(bn).map(t=>"const int COORDINATE_SYSTEM_".concat(t," = ").concat(bn[t],";")).join(""),eu=Object.keys(_n).map(t=>"const int PROJECTION_MODE_".concat(t," = ").concat(_n[t],";")).join(""),nu=Object.keys(wn).map(t=>"const int UNIT_".concat(t.toUpperCase()," = ").concat(wn[t],";")).join("");var ru="".concat(tu,"\n").concat(eu,"\n").concat(nu,"\n\nuniform int project_uCoordinateSystem;\nuniform int project_uProjectionMode;\nuniform float project_uScale;\nuniform bool project_uWrapLongitude;\nuniform vec3 project_uCommonUnitsPerMeter;\nuniform vec3 project_uCommonUnitsPerWorldUnit;\nuniform vec3 project_uCommonUnitsPerWorldUnit2;\nuniform vec4 project_uCenter;\nuniform mat4 project_uModelMatrix;\nuniform mat4 project_uViewProjectionMatrix;\nuniform vec2 project_uViewportSize;\nuniform float project_uDevicePixelRatio;\nuniform float project_uFocalDistance;\nuniform vec3 project_uCameraPosition;\nuniform vec3 project_uCoordinateOrigin;\nuniform vec3 project_uCommonOrigin;\nuniform bool project_uPseudoMeters;\n\nconst float TILE_SIZE = 512.0;\nconst float PI = 3.1415926536;\nconst float WORLD_SCALE = TILE_SIZE / (PI * 2.0);\nconst vec3 ZERO_64_LOW = vec3(0.0);\nconst float EARTH_RADIUS = 6370972.0;\nconst float GLOBE_RADIUS = 256.0;\nfloat project_size() {\n  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR &&\n    project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT &&\n    project_uPseudoMeters == false) {\n    \n    if (geometry.position.w == 0.0) {\n      float y = clamp(geometry.worldPosition.y, -89.9, 89.9);\n      return 1.0 / cos(radians(y));\n    }\n  \n    float y = geometry.position.y / TILE_SIZE * 2.0 - 1.0;\n    float y2 = y * y;\n    float y4 = y2 * y2;\n    float y6 = y4 * y2;\n    return 1.0 + 4.9348 * y2 + 4.0587 * y4 + 1.5642 * y6;\n  }\n  return 1.0;\n}\nfloat project_size(float meters) {\n  return meters * project_uCommonUnitsPerMeter.z * project_size();\n}\n\nvec2 project_size(vec2 meters) {\n  return meters * project_uCommonUnitsPerMeter.xy * project_size();\n}\n\nvec3 project_size(vec3 meters) {\n  return meters * project_uCommonUnitsPerMeter * project_size();\n}\n\nvec4 project_size(vec4 meters) {\n  return vec4(meters.xyz * project_uCommonUnitsPerMeter, meters.w);\n}\nvec3 project_normal(vec3 vector) {\n  vec4 normal_modelspace = project_uModelMatrix * vec4(vector, 0.0);\n  return normalize(normal_modelspace.xyz * project_uCommonUnitsPerMeter);\n}\n\nvec4 project_offset_(vec4 offset) {\n  float dy = offset.y;\n  vec3 commonUnitsPerWorldUnit = project_uCommonUnitsPerWorldUnit + project_uCommonUnitsPerWorldUnit2 * dy;\n  return vec4(offset.xyz * commonUnitsPerWorldUnit, offset.w);\n}\nvec2 project_mercator_(vec2 lnglat) {\n  float x = lnglat.x;\n  if (project_uWrapLongitude) {\n    x = mod(x + 180., 360.0) - 180.;\n  }\n  float y = clamp(lnglat.y, -89.9, 89.9);\n  return vec2(\n    radians(x) + PI,\n    PI + log(tan_fp32(PI * 0.25 + radians(y) * 0.5))\n  ) * WORLD_SCALE;\n}\n\nvec3 project_globe_(vec3 lnglatz) {\n  float lambda = radians(lnglatz.x);\n  float phi = radians(lnglatz.y);\n  float cosPhi = cos(phi);\n  float D = (lnglatz.z / EARTH_RADIUS + 1.0) * GLOBE_RADIUS;\n\n  return vec3(\n    sin(lambda) * cosPhi,\n    -cos(lambda) * cosPhi,\n    sin(phi)\n  ) * D;\n}\nvec4 project_position(vec4 position, vec3 position64Low) {\n  vec4 position_world = project_uModelMatrix * position;\n  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR) {\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n      return vec4(\n        project_mercator_(position_world.xy),\n        project_size(position_world.z),\n        position_world.w\n      );\n    }\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN) {\n      position_world.xyz += project_uCoordinateOrigin;\n    }\n  }\n  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n      return vec4(\n        project_globe_(position_world.xyz),\n        position_world.w\n      );\n    }\n  }\n  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET) {\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n      if (abs(position_world.y - project_uCoordinateOrigin.y) > 0.25) {\n        return vec4(\n          project_mercator_(position_world.xy) - project_uCommonOrigin.xy,\n          project_size(position_world.z),\n          position_world.w\n        );\n      }\n    }\n  }\n  if (project_uProjectionMode == PROJECTION_MODE_IDENTITY ||\n    (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET &&\n    (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||\n     project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN))) {\n    position_world.xyz -= project_uCoordinateOrigin;\n  }\n  return project_offset_(position_world + project_uModelMatrix * vec4(position64Low, 0.0));\n}\n\nvec4 project_position(vec4 position) {\n  return project_position(position, ZERO_64_LOW);\n}\n\nvec3 project_position(vec3 position, vec3 position64Low) {\n  vec4 projected_position = project_position(vec4(position, 1.0), position64Low);\n  return projected_position.xyz;\n}\n\nvec3 project_position(vec3 position) {\n  vec4 projected_position = project_position(vec4(position, 1.0), ZERO_64_LOW);\n  return projected_position.xyz;\n}\n\nvec2 project_position(vec2 position) {\n  vec4 projected_position = project_position(vec4(position, 0.0, 1.0), ZERO_64_LOW);\n  return projected_position.xy;\n}\n\nvec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {\n  return viewProjectionMatrix * position + center;\n}\nvec4 project_common_position_to_clipspace(vec4 position) {\n  return project_common_position_to_clipspace(position, project_uViewProjectionMatrix, project_uCenter);\n}\nvec2 project_pixel_size_to_clipspace(vec2 pixels) {\n  vec2 offset = pixels / project_uViewportSize * project_uDevicePixelRatio * 2.0;\n  return offset * project_uFocalDistance;\n}\n\nfloat project_size_to_pixel(float meters) {\n  return project_size(meters) * project_uScale;\n}\nfloat project_size_to_pixel(float size, int unit) {\n  if (unit == UNIT_METERS) return project_size_to_pixel(size);\n  if (unit == UNIT_COMMON) return size * project_uScale;\n  return size;\n}\nfloat project_pixel_size(float pixels) {\n  return pixels / project_uScale;\n}\nvec2 project_pixel_size(vec2 pixels) {\n  return pixels / project_uScale;\n}\nmat3 project_get_orientation_matrix(vec3 up) {\n  vec3 uz = normalize(up);\n  vec3 ux = abs(uz.z) == 1.0 ? vec3(1.0, 0.0, 0.0) : normalize(vec3(uz.y, -uz.x, 0));\n  vec3 uy = cross(uz, ux);\n  return mat3(ux, uy, uz);\n}\n\nbool project_needs_rotation(vec3 commonPosition, out mat3 transform) {\n  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {\n    transform = project_get_orientation_matrix(commonPosition);\n    return true;\n  }\n  return false;\n}\n"),iu="undefined"!==typeof Float32Array?Float32Array:Array;Math.random;Math.PI;function ou(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],s=e[4],a=e[5],u=e[6],c=e[7],l=e[8],h=e[9],f=e[10],d=e[11],p=e[12],g=e[13],m=e[14],y=e[15],v=n*a-r*s,b=n*u-i*s,_=n*c-o*s,w=r*u-i*a,x=r*c-o*a,S=i*c-o*u,E=l*g-h*p,A=l*m-f*p,M=l*y-d*p,C=h*m-f*g,k=h*y-d*g,O=f*y-d*m,P=v*O-b*k+_*C+w*M-x*A+S*E;return P?(P=1/P,t[0]=(a*O-u*k+c*C)*P,t[1]=(i*k-r*O-o*C)*P,t[2]=(g*S-m*x+y*w)*P,t[3]=(f*x-h*S-d*w)*P,t[4]=(u*M-s*O-c*A)*P,t[5]=(n*O-i*M+o*A)*P,t[6]=(m*_-p*S-y*b)*P,t[7]=(l*S-f*_+d*b)*P,t[8]=(s*k-a*M+c*E)*P,t[9]=(r*M-n*k-o*E)*P,t[10]=(p*x-g*_+y*v)*P,t[11]=(h*_-l*x-d*v)*P,t[12]=(a*A-s*C-u*E)*P,t[13]=(n*C-r*A+i*E)*P,t[14]=(g*b-p*w-m*v)*P,t[15]=(l*w-h*b+f*v)*P,t):null}function su(t,e,n){var r=e[0],i=e[1],o=e[2],s=e[3],a=e[4],u=e[5],c=e[6],l=e[7],h=e[8],f=e[9],d=e[10],p=e[11],g=e[12],m=e[13],y=e[14],v=e[15],b=n[0],_=n[1],w=n[2],x=n[3];return t[0]=b*r+_*a+w*h+x*g,t[1]=b*i+_*u+w*f+x*m,t[2]=b*o+_*c+w*d+x*y,t[3]=b*s+_*l+w*p+x*v,b=n[4],_=n[5],w=n[6],x=n[7],t[4]=b*r+_*a+w*h+x*g,t[5]=b*i+_*u+w*f+x*m,t[6]=b*o+_*c+w*d+x*y,t[7]=b*s+_*l+w*p+x*v,b=n[8],_=n[9],w=n[10],x=n[11],t[8]=b*r+_*a+w*h+x*g,t[9]=b*i+_*u+w*f+x*m,t[10]=b*o+_*c+w*d+x*y,t[11]=b*s+_*l+w*p+x*v,b=n[12],_=n[13],w=n[14],x=n[15],t[12]=b*r+_*a+w*h+x*g,t[13]=b*i+_*u+w*f+x*m,t[14]=b*o+_*c+w*d+x*y,t[15]=b*s+_*l+w*p+x*v,t}function au(t,e,n){var r,i,o,s,a,u,c,l,h,f,d,p,g=n[0],m=n[1],y=n[2];return e===t?(t[12]=e[0]*g+e[4]*m+e[8]*y+e[12],t[13]=e[1]*g+e[5]*m+e[9]*y+e[13],t[14]=e[2]*g+e[6]*m+e[10]*y+e[14],t[15]=e[3]*g+e[7]*m+e[11]*y+e[15]):(r=e[0],i=e[1],o=e[2],s=e[3],a=e[4],u=e[5],c=e[6],l=e[7],h=e[8],f=e[9],d=e[10],p=e[11],t[0]=r,t[1]=i,t[2]=o,t[3]=s,t[4]=a,t[5]=u,t[6]=c,t[7]=l,t[8]=h,t[9]=f,t[10]=d,t[11]=p,t[12]=r*g+a*m+h*y+e[12],t[13]=i*g+u*m+f*y+e[13],t[14]=o*g+c*m+d*y+e[14],t[15]=s*g+l*m+p*y+e[15]),t}function uu(t,e,n){var r=n[0],i=n[1],o=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}Math.hypot||(Math.hypot=function(){var t=0,e=arguments.length;while(e--)t+=arguments[e]*arguments[e];return Math.sqrt(t)});function cu(){var t=new iu(4);return iu!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function lu(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t}function hu(t,e,n){var r=e[0],i=e[1],o=e[2],s=e[3];return t[0]=n[0]*r+n[4]*i+n[8]*o+n[12]*s,t[1]=n[1]*r+n[5]*i+n[9]*o+n[13]*s,t[2]=n[2]*r+n[6]*i+n[10]*o+n[14]*s,t[3]=n[3]*r+n[7]*i+n[11]*o+n[15]*s,t}(function(){var t=cu()})();function fu(t,e){if(t===e)return!0;if(Array.isArray(t)){const n=t.length;if(!e||e.length!==n)return!1;for(let r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}return!1}function du(t){let e,n={};return r=>{for(const i in r)if(!fu(r[i],n[i])){e=t(r),n=r;break}return e}}const pu=[0,0,0,0],gu=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],mu=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],yu=[0,0,0],vu=[0,0,0],bu=du(Su);function _u(t,e,n=vu){let r,i=n,o=!0;switch(r=e===bn.LNGLAT_OFFSETS||e===bn.METER_OFFSETS?n:t.isGeospatial?[Math.fround(t.longitude),Math.fround(t.latitude),0]:null,t.projectionMode){case _n.WEB_MERCATOR:e!==bn.LNGLAT&&e!==bn.CARTESIAN||(r=[0,0,0],o=!1);break;case _n.WEB_MERCATOR_AUTO_OFFSET:e===bn.LNGLAT?i=r:e===bn.CARTESIAN&&(i=[Math.fround(t.center[0]),Math.fround(t.center[1]),0],r=t.unprojectPosition(i),i[0]-=n[0],i[1]-=n[1],i[2]-=n[2]);break;case _n.IDENTITY:i=t.position.map(Math.fround);break;case _n.GLOBE:o=!1,r=null;break;default:o=!1}return i[2]=i[2]||0,{geospatialOrigin:r,shaderCoordinateOrigin:i,offsetMode:o}}function wu(t,e,n){const{viewMatrixUncentered:r,projectionMatrix:i}=t;let{viewMatrix:o,viewProjectionMatrix:s}=t,a=pu,u=pu,c=t.cameraPosition;const{geospatialOrigin:l,shaderCoordinateOrigin:h,offsetMode:f}=_u(t,e,n);return f&&(u=t.projectPosition(l||h),c=[c[0]-u[0],c[1]-u[1],c[2]-u[2]],u[3]=1,a=hu([],u,s),o=r||o,s=su([],i,o),s=su([],s,gu)),{viewMatrix:o,viewProjectionMatrix:s,projectionCenter:a,originCommon:u,cameraPosCommon:c,shaderCoordinateOrigin:h,geospatialOrigin:l}}function xu({viewport:t,devicePixelRatio:e=1,modelMatrix:n=null,coordinateSystem:r=bn.DEFAULT,coordinateOrigin:i,autoWrapLongitude:o=!1}={}){r===bn.DEFAULT&&(r=t.isGeospatial?bn.LNGLAT:bn.CARTESIAN);const s=bu({viewport:t,devicePixelRatio:e,coordinateSystem:r,coordinateOrigin:i});return s.project_uWrapLongitude=o,s.project_uModelMatrix=n||mu,s}function Su({viewport:t,devicePixelRatio:e,coordinateSystem:n,coordinateOrigin:r}){const{projectionCenter:i,viewProjectionMatrix:o,originCommon:s,cameraPosCommon:a,shaderCoordinateOrigin:u,geospatialOrigin:c}=wu(t,n,r),l=t.getDistanceScales(),h=[t.width*e,t.height*e],f=t.projectionMatrix.transform([0,0,-t.focalDistance,1])[3]||1,d={project_uCoordinateSystem:n,project_uProjectionMode:t.projectionMode,project_uCoordinateOrigin:u,project_uCommonOrigin:s.slice(0,3),project_uCenter:i,project_uPseudoMeters:Boolean(t._pseudoMeters),project_uViewportSize:h,project_uDevicePixelRatio:e,project_uFocalDistance:f,project_uCommonUnitsPerMeter:l.unitsPerMeter,project_uCommonUnitsPerWorldUnit:l.unitsPerMeter,project_uCommonUnitsPerWorldUnit2:yu,project_uScale:t.scale,project_uViewProjectionMatrix:o,project_uCameraPosition:a};if(c){const e=t.getDistanceScales(c);switch(n){case bn.METER_OFFSETS:d.project_uCommonUnitsPerWorldUnit=e.unitsPerMeter,d.project_uCommonUnitsPerWorldUnit2=e.unitsPerMeter2;break;case bn.LNGLAT:case bn.LNGLAT_OFFSETS:t._pseudoMeters||(d.project_uCommonUnitsPerMeter=e.unitsPerMeter),d.project_uCommonUnitsPerWorldUnit=e.unitsPerDegree,d.project_uCommonUnitsPerWorldUnit2=e.unitsPerDegree2;break;case bn.CARTESIAN:d.project_uCommonUnitsPerWorldUnit=[1,1,e.unitsPerMeter[2]],d.project_uCommonUnitsPerWorldUnit2=[0,0,e.unitsPerMeter2[2]];break;default:break}}return d}const Eu={};function Au(t=Eu){return t.viewport?xu(t):{}}var Mu={name:"project",dependencies:[Za,Qa],vs:ru,getUniforms:Au},Cu=1e-6,ku="undefined"!==typeof Float32Array?Float32Array:Array;Math.random;Math.PI;function Ou(){var t=new ku(4);return ku!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function Pu(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t}function Tu(t,e,n){var r=e[0],i=e[1],o=e[2],s=e[3];return t[0]=n[0]*r+n[4]*i+n[8]*o+n[12]*s,t[1]=n[1]*r+n[5]*i+n[9]*o+n[13]*s,t[2]=n[2]*r+n[6]*i+n[10]*o+n[14]*s,t[3]=n[3]*r+n[7]*i+n[11]*o+n[15]*s,t}Math.hypot||(Math.hypot=function(){var t=0,e=arguments.length;while(e--)t+=arguments[e]*arguments[e];return Math.sqrt(t)});(function(){var t=Ou()})();function Lu(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function Iu(t,e){const n=Tu([],e,t);return Pu(n,n,1/n[3]),n}function Nu(t,e){const n=t%e;return n<0?e+n:n}function Du(t,e,n){return n*e+(1-n)*t}function Ru(t){return Math.log(t)*Math.LOG2E}const Fu=Math.log2||Ru;function Bu(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],s=e[4],a=e[5],u=e[6],c=e[7],l=e[8],h=e[9],f=e[10],d=e[11],p=e[12],g=e[13],m=e[14],y=e[15],v=n*a-r*s,b=n*u-i*s,_=n*c-o*s,w=r*u-i*a,x=r*c-o*a,S=i*c-o*u,E=l*g-h*p,A=l*m-f*p,M=l*y-d*p,C=h*m-f*g,k=h*y-d*g,O=f*y-d*m,P=v*O-b*k+_*C+w*M-x*A+S*E;return P?(P=1/P,t[0]=(a*O-u*k+c*C)*P,t[1]=(i*k-r*O-o*C)*P,t[2]=(g*S-m*x+y*w)*P,t[3]=(f*x-h*S-d*w)*P,t[4]=(u*M-s*O-c*A)*P,t[5]=(n*O-i*M+o*A)*P,t[6]=(m*_-p*S-y*b)*P,t[7]=(l*S-f*_+d*b)*P,t[8]=(s*k-a*M+c*E)*P,t[9]=(r*M-n*k-o*E)*P,t[10]=(p*x-g*_+y*v)*P,t[11]=(h*_-l*x-d*v)*P,t[12]=(a*A-s*C-u*E)*P,t[13]=(n*C-r*A+i*E)*P,t[14]=(g*b-p*w-m*v)*P,t[15]=(l*w-h*b+f*v)*P,t):null}function ju(t,e,n){var r=e[0],i=e[1],o=e[2],s=e[3],a=e[4],u=e[5],c=e[6],l=e[7],h=e[8],f=e[9],d=e[10],p=e[11],g=e[12],m=e[13],y=e[14],v=e[15],b=n[0],_=n[1],w=n[2],x=n[3];return t[0]=b*r+_*a+w*h+x*g,t[1]=b*i+_*u+w*f+x*m,t[2]=b*o+_*c+w*d+x*y,t[3]=b*s+_*l+w*p+x*v,b=n[4],_=n[5],w=n[6],x=n[7],t[4]=b*r+_*a+w*h+x*g,t[5]=b*i+_*u+w*f+x*m,t[6]=b*o+_*c+w*d+x*y,t[7]=b*s+_*l+w*p+x*v,b=n[8],_=n[9],w=n[10],x=n[11],t[8]=b*r+_*a+w*h+x*g,t[9]=b*i+_*u+w*f+x*m,t[10]=b*o+_*c+w*d+x*y,t[11]=b*s+_*l+w*p+x*v,b=n[12],_=n[13],w=n[14],x=n[15],t[12]=b*r+_*a+w*h+x*g,t[13]=b*i+_*u+w*f+x*m,t[14]=b*o+_*c+w*d+x*y,t[15]=b*s+_*l+w*p+x*v,t}function zu(t,e,n){var r,i,o,s,a,u,c,l,h,f,d,p,g=n[0],m=n[1],y=n[2];return e===t?(t[12]=e[0]*g+e[4]*m+e[8]*y+e[12],t[13]=e[1]*g+e[5]*m+e[9]*y+e[13],t[14]=e[2]*g+e[6]*m+e[10]*y+e[14],t[15]=e[3]*g+e[7]*m+e[11]*y+e[15]):(r=e[0],i=e[1],o=e[2],s=e[3],a=e[4],u=e[5],c=e[6],l=e[7],h=e[8],f=e[9],d=e[10],p=e[11],t[0]=r,t[1]=i,t[2]=o,t[3]=s,t[4]=a,t[5]=u,t[6]=c,t[7]=l,t[8]=h,t[9]=f,t[10]=d,t[11]=p,t[12]=r*g+a*m+h*y+e[12],t[13]=i*g+u*m+f*y+e[13],t[14]=o*g+c*m+d*y+e[14],t[15]=s*g+l*m+p*y+e[15]),t}function Uu(t,e,n){var r=n[0],i=n[1],o=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function $u(t,e,n){var r=Math.sin(n),i=Math.cos(n),o=e[4],s=e[5],a=e[6],u=e[7],c=e[8],l=e[9],h=e[10],f=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=o*i+c*r,t[5]=s*i+l*r,t[6]=a*i+h*r,t[7]=u*i+f*r,t[8]=c*i-o*r,t[9]=l*i-s*r,t[10]=h*i-a*r,t[11]=f*i-u*r,t}function Vu(t,e,n){var r=Math.sin(n),i=Math.cos(n),o=e[0],s=e[1],a=e[2],u=e[3],c=e[4],l=e[5],h=e[6],f=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*i+c*r,t[1]=s*i+l*r,t[2]=a*i+h*r,t[3]=u*i+f*r,t[4]=c*i-o*r,t[5]=l*i-s*r,t[6]=h*i-a*r,t[7]=f*i-u*r,t}function qu(t,e,n,r,i){var o,s=1/Math.tan(e/2);return t[0]=s/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=i&&i!==1/0?(o=1/(r-i),t[10]=(i+r)*o,t[14]=2*i*r*o):(t[10]=-1,t[14]=-2*r),t}function Wu(t,e){var n=t[0],r=t[1],i=t[2],o=t[3],s=t[4],a=t[5],u=t[6],c=t[7],l=t[8],h=t[9],f=t[10],d=t[11],p=t[12],g=t[13],m=t[14],y=t[15],v=e[0],b=e[1],_=e[2],w=e[3],x=e[4],S=e[5],E=e[6],A=e[7],M=e[8],C=e[9],k=e[10],O=e[11],P=e[12],T=e[13],L=e[14],I=e[15];return Math.abs(n-v)<=Cu*Math.max(1,Math.abs(n),Math.abs(v))&&Math.abs(r-b)<=Cu*Math.max(1,Math.abs(r),Math.abs(b))&&Math.abs(i-_)<=Cu*Math.max(1,Math.abs(i),Math.abs(_))&&Math.abs(o-w)<=Cu*Math.max(1,Math.abs(o),Math.abs(w))&&Math.abs(s-x)<=Cu*Math.max(1,Math.abs(s),Math.abs(x))&&Math.abs(a-S)<=Cu*Math.max(1,Math.abs(a),Math.abs(S))&&Math.abs(u-E)<=Cu*Math.max(1,Math.abs(u),Math.abs(E))&&Math.abs(c-A)<=Cu*Math.max(1,Math.abs(c),Math.abs(A))&&Math.abs(l-M)<=Cu*Math.max(1,Math.abs(l),Math.abs(M))&&Math.abs(h-C)<=Cu*Math.max(1,Math.abs(h),Math.abs(C))&&Math.abs(f-k)<=Cu*Math.max(1,Math.abs(f),Math.abs(k))&&Math.abs(d-O)<=Cu*Math.max(1,Math.abs(d),Math.abs(O))&&Math.abs(p-P)<=Cu*Math.max(1,Math.abs(p),Math.abs(P))&&Math.abs(g-T)<=Cu*Math.max(1,Math.abs(g),Math.abs(T))&&Math.abs(m-L)<=Cu*Math.max(1,Math.abs(m),Math.abs(L))&&Math.abs(y-I)<=Cu*Math.max(1,Math.abs(y),Math.abs(I))}function Gu(){var t=new ku(2);return ku!=Float32Array&&(t[0]=0,t[1]=0),t}function Hu(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t}function Xu(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t}function Yu(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t}function Zu(t){var e=t[0],n=t[1];return Math.hypot(e,n)}function Ku(t,e){return t[0]=-e[0],t[1]=-e[1],t}function Ju(t,e,n,r){var i=e[0],o=e[1];return t[0]=i+r*(n[0]-i),t[1]=o+r*(n[1]-o),t}var Qu=Xu;(function(){var t=Gu()})();function tc(){var t=new ku(3);return ku!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function ec(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t}function nc(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t}function rc(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}var ic=nc;(function(){var t=tc()})();function oc(t,e){if(!t)throw new Error(e||"@math.gl/web-mercator: assertion failed.")}const sc=Math.PI,ac=sc/4,uc=sc/180,cc=180/sc,lc=512,hc=4003e4,fc=1.5;function dc(t){return Math.pow(2,t)}function pc(t){return Fu(t)}function gc([t,e]){oc(Number.isFinite(t)),oc(Number.isFinite(e)&&e>=-90&&e<=90,"invalid latitude");const n=t*uc,r=e*uc,i=lc*(n+sc)/(2*sc),o=lc*(sc+Math.log(Math.tan(ac+.5*r)))/(2*sc);return[i,o]}function mc([t,e]){const n=t/lc*(2*sc)-sc,r=2*(Math.atan(Math.exp(e/lc*(2*sc)-sc))-ac);return[n*cc,r*cc]}function yc({latitude:t}){oc(Number.isFinite(t));const e=Math.cos(t*uc);return pc(hc*e)-9}function vc({latitude:t,longitude:e,highPrecision:n=!1}){oc(Number.isFinite(t)&&Number.isFinite(e));const r={},i=lc,o=Math.cos(t*uc),s=i/360,a=s/o,u=i/hc/o;if(r.unitsPerMeter=[u,u,u],r.metersPerUnit=[1/u,1/u,1/u],r.unitsPerDegree=[s,a,u],r.degreesPerUnit=[1/s,1/a,1/u],n){const e=uc*Math.tan(t*uc)/o,n=s*e/2,c=i/hc*e,l=c/a*u;r.unitsPerDegree2=[0,n,c],r.unitsPerMeter2=[l,0,l]}return r}function bc(t,e){const[n,r,i]=t,[o,s,a]=e,{unitsPerMeter:u,unitsPerMeter2:c}=vc({longitude:n,latitude:r,highPrecision:!0}),l=gc(t);l[0]+=o*(u[0]+c[0]*s),l[1]+=s*(u[1]+c[1]*s);const h=mc(l),f=(i||0)+(a||0);return Number.isFinite(i)||Number.isFinite(a)?[h[0],h[1],f]:h}function _c({height:t,pitch:e,bearing:n,altitude:r,scale:i,center:o=null}){const s=Lu();return zu(s,s,[0,0,-r]),$u(s,s,-e*uc),Vu(s,s,n*uc),i/=t,Uu(s,s,[i,i,i]),o&&zu(s,s,rc([],o)),s}function wc({width:t,height:e,fovy:n=Sc(fc),altitude:r,pitch:i=0,nearZMultiplier:o=1,farZMultiplier:s=1}){void 0!==r&&(n=Sc(r));const a=.5*n*uc,u=Ec(n),c=i*uc,l=Math.sin(a)*u/Math.sin(Math.min(Math.max(Math.PI/2-c-a,.01),Math.PI-.01)),h=Math.sin(c)*l+u;return{fov:2*a,aspect:t/e,focalDistance:u,near:o,far:h*s}}function xc({width:t,height:e,pitch:n,altitude:r,fovy:i,nearZMultiplier:o,farZMultiplier:s}){const{fov:a,aspect:u,near:c,far:l}=wc({width:t,height:e,altitude:r,fovy:i,pitch:n,nearZMultiplier:o,farZMultiplier:s}),h=qu([],a,u,c,l);return h}function Sc(t){return 2*Math.atan(.5/t)*cc}function Ec(t){return.5/Math.tan(.5*t*uc)}function Ac(t,e){const[n,r,i=0]=t;return oc(Number.isFinite(n)&&Number.isFinite(r)&&Number.isFinite(i)),Iu(e,[n,r,i,1])}function Mc(t,e,n=0){const[r,i,o]=t;if(oc(Number.isFinite(r)&&Number.isFinite(i),"invalid pixel coordinate"),Number.isFinite(o)){const t=Iu(e,[r,i,o,1]);return t}const s=Iu(e,[r,i,0,1]),a=Iu(e,[r,i,1,1]),u=s[2],c=a[2],l=u===c?0:((n||0)-u)/(c-u);return Ju([],s,a,l)}function Cc({width:t,height:e,bounds:n,minExtent:r=0,maxZoom:i=24,padding:o=0,offset:s=[0,0]}){const[[a,u],[c,l]]=n;if(Number.isFinite(o)){const t=o;o={top:t,bottom:t,left:t,right:t}}else oc(Number.isFinite(o.top)&&Number.isFinite(o.bottom)&&Number.isFinite(o.left)&&Number.isFinite(o.right));const h=new Tc({width:t,height:e,longitude:0,latitude:0,zoom:0}),f=h.project([a,l]),d=h.project([c,u]),p=[Math.max(Math.abs(d[0]-f[0]),r),Math.max(Math.abs(d[1]-f[1]),r)],g=[t-o.left-o.right-2*Math.abs(s[0]),e-o.top-o.bottom-2*Math.abs(s[1])];oc(g[0]>0&&g[1]>0);const m=g[0]/p[0],y=g[1]/p[1],v=(o.right-o.left)/2/m,b=(o.bottom-o.top)/2/y,_=[(d[0]+f[0])/2+v,(d[1]+f[1])/2+b],w=h.unproject(_),x=Math.min(i,h.zoom+Fu(Math.abs(Math.min(m,y))));return oc(Number.isFinite(x)),{longitude:w[0],latitude:w[1],zoom:x}}const kc=Math.PI/180;function Oc(t,e=0){const{width:n,height:r,unproject:i}=t,o={targetZ:e},s=i([0,r],o),a=i([n,r],o);let u,c;const l=t.fovy?.5*t.fovy*kc:Math.atan(.5/t.altitude),h=(90-t.pitch)*kc;return l>h-.01?(u=Pc(t,0,e),c=Pc(t,n,e)):(u=i([0,0],o),c=i([n,0],o)),[s,a,c,u]}function Pc(t,e,n){const{pixelUnprojectionMatrix:r}=t,i=Iu(r,[e,0,1,1]),o=Iu(r,[e,t.height,1,1]),s=n*t.distanceScales.unitsPerMeter[2],a=(s-i[2])/(o[2]-i[2]),u=Ju([],i,o,a),c=mc(u);return c[2]=n,c}class Tc{constructor({width:t,height:e,latitude:n=0,longitude:r=0,zoom:i=0,pitch:o=0,bearing:s=0,altitude:a=null,fovy:u=null,position:c=null,nearZMultiplier:l=.02,farZMultiplier:h=1.01}={width:1,height:1}){t=t||1,e=e||1,null===u&&null===a?(a=fc,u=Sc(a)):null===u?u=Sc(a):null===a&&(a=Ec(u));const f=dc(i);a=Math.max(.75,a);const d=vc({longitude:r,latitude:n}),p=gc([r,n]);p[2]=0,c&&ec(p,p,ic([],c,d.unitsPerMeter)),this.projectionMatrix=xc({width:t,height:e,pitch:o,fovy:u,nearZMultiplier:l,farZMultiplier:h}),this.viewMatrix=_c({height:e,scale:f,center:p,pitch:o,bearing:s,altitude:a}),this.width=t,this.height=e,this.scale=f,this.latitude=n,this.longitude=r,this.zoom=i,this.pitch=o,this.bearing=s,this.altitude=a,this.fovy=u,this.center=p,this.meterOffset=c||[0,0,0],this.distanceScales=d,this._initMatrices(),this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),Object.freeze(this)}_initMatrices(){const{width:t,height:e,projectionMatrix:n,viewMatrix:r}=this,i=Lu();ju(i,i,n),ju(i,i,r),this.viewProjectionMatrix=i;const o=Lu();Uu(o,o,[t/2,-e/2,1]),zu(o,o,[1,-1,0]),ju(o,o,i);const s=Bu(Lu(),o);if(!s)throw new Error("Pixel project matrix not invertible");this.pixelProjectionMatrix=o,this.pixelUnprojectionMatrix=s}equals(t){return t instanceof Tc&&(t.width===this.width&&t.height===this.height&&Wu(t.projectionMatrix,this.projectionMatrix)&&Wu(t.viewMatrix,this.viewMatrix))}project(t,{topLeft:e=!0}={}){const n=this.projectPosition(t),r=Ac(n,this.pixelProjectionMatrix),[i,o]=r,s=e?o:this.height-o;return 2===t.length?[i,s]:[i,s,r[2]]}unproject(t,{topLeft:e=!0,targetZ:n}={}){const[r,i,o]=t,s=e?i:this.height-i,a=n&&n*this.distanceScales.unitsPerMeter[2],u=Mc([r,s,o],this.pixelUnprojectionMatrix,a),[c,l,h]=this.unprojectPosition(u);return Number.isFinite(o)?[c,l,h]:Number.isFinite(n)?[c,l,n]:[c,l]}projectPosition(t){const[e,n]=gc(t),r=(t[2]||0)*this.distanceScales.unitsPerMeter[2];return[e,n,r]}unprojectPosition(t){const[e,n]=mc(t),r=(t[2]||0)*this.distanceScales.metersPerUnit[2];return[e,n,r]}projectFlat(t){return gc(t)}unprojectFlat(t){return mc(t)}getMapCenterByLngLatPosition({lngLat:t,pos:e}){const n=Mc(e,this.pixelUnprojectionMatrix),r=gc(t),i=Hu([],r,Ku([],n)),o=Hu([],this.center,i);return mc(o)}getLocationAtPoint({lngLat:t,pos:e}){return this.getMapCenterByLngLatPosition({lngLat:t,pos:e})}fitBounds(t,e={}){const{width:n,height:r}=this,{longitude:i,latitude:o,zoom:s}=Cc(Object.assign({width:n,height:r,bounds:t},e));return new Tc({width:n,height:r,longitude:i,latitude:o,zoom:s})}getBounds(t){const e=this.getBoundingRegion(t),n=Math.min(...e.map(t=>t[0])),r=Math.max(...e.map(t=>t[0])),i=Math.min(...e.map(t=>t[1])),o=Math.max(...e.map(t=>t[1]));return[[n,i],[r,o]]}getBoundingRegion(t={}){return Oc(this,t.z||0)}}const Lc=512;function Ic({width:t,height:e,longitude:n,latitude:r,zoom:i,pitch:o=0,bearing:s=0}){(n<-180||n>180)&&(n=Nu(n+180,360)-180),(s<-180||s>180)&&(s=Nu(s+180,360)-180);const a=Fu(e/Lc);if(i<=a)i=a,r=0;else{const t=e/2/Math.pow(2,i),n=mc([0,t])[1];if(r<n)r=n;else{const e=mc([0,Lc-t])[1];r>e&&(r=e)}}return{width:t,height:e,longitude:n,latitude:r,zoom:i,pitch:o,bearing:s}}const Nc=.01,Dc=["longitude","latitude","zoom"],Rc={curve:1.414,speed:1.2};function Fc(t,e,n,r={}){const i={},{startZoom:o,startCenterXY:s,uDelta:a,w0:u,u1:c,S:l,rho:h,rho2:f,r0:d}=jc(t,e,r);if(c<Nc){for(const r of Dc){const o=t[r],s=e[r];i[r]=Du(o,s,n)}return i}const p=n*l,g=Math.cosh(d)/Math.cosh(d+h*p),m=u*((Math.cosh(d)*Math.tanh(d+h*p)-Math.sinh(d))/f)/c,y=1/g,v=o+pc(y),b=Yu([],a,m);Hu(b,b,s);const _=mc(b);return i.longitude=_[0],i.latitude=_[1],i.zoom=v,i}function Bc(t,e,n={}){n=Object.assign({},Rc,n);const{screenSpeed:r,speed:i,maxDuration:o}=n,{S:s,rho:a}=jc(t,e,n),u=1e3*s;let c;return c=Number.isFinite(r)?u/(r/a):u/i,Number.isFinite(o)&&c>o?0:c}function jc(t,e,n){n=Object.assign({},Rc,n);const r=n.curve,i=t.zoom,o=[t.longitude,t.latitude],s=dc(i),a=e.zoom,u=[e.longitude,e.latitude],c=dc(a-i),l=gc(o),h=gc(u),f=Qu([],h,l),d=Math.max(t.width,t.height),p=d/c,g=Zu(f)*s,m=Math.max(g,Nc),y=r*r,v=(p*p-d*d+y*y*m*m)/(2*d*y*m),b=(p*p-d*d-y*y*m*m)/(2*p*y*m),_=Math.log(Math.sqrt(v*v+1)-v),w=Math.log(Math.sqrt(b*b+1)-b),x=(w-_)/r;return{startZoom:i,startCenterXY:l,uDelta:f,w0:d,u1:g,S:x,rho:r,rho2:y,r0:_,r1:w}}const zc="\nconst int max_lights = 2;\nuniform mat4 shadow_uViewProjectionMatrices[max_lights];\nuniform vec4 shadow_uProjectCenters[max_lights];\nuniform bool shadow_uDrawShadowMap;\nuniform bool shadow_uUseShadowMap;\nuniform int shadow_uLightId;\nuniform float shadow_uLightCount;\n\nvarying vec3 shadow_vPosition[max_lights];\n\nvec4 shadow_setVertexPosition(vec4 position_commonspace) {\n  if (shadow_uDrawShadowMap) {\n    return project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[shadow_uLightId], shadow_uProjectCenters[shadow_uLightId]);\n  }\n  if (shadow_uUseShadowMap) {\n    for (int i = 0; i < max_lights; i++) {\n      if(i < int(shadow_uLightCount)) {\n        vec4 shadowMap_position = project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[i], shadow_uProjectCenters[i]);\n        shadow_vPosition[i] = (shadowMap_position.xyz / shadowMap_position.w + 1.0) / 2.0;\n      }\n    }\n  }\n  return gl_Position;\n}\n",Uc="\nconst int max_lights = 2;\nuniform bool shadow_uDrawShadowMap;\nuniform bool shadow_uUseShadowMap;\nuniform sampler2D shadow_uShadowMap0;\nuniform sampler2D shadow_uShadowMap1;\nuniform vec4 shadow_uColor;\nuniform float shadow_uLightCount;\n\nvarying vec3 shadow_vPosition[max_lights];\n\nconst vec4 bitPackShift = vec4(1.0, 255.0, 65025.0, 16581375.0);\nconst vec4 bitUnpackShift = 1.0 / bitPackShift;\nconst vec4 bitMask = vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0,  0.0);\n\nfloat shadow_getShadowWeight(vec3 position, sampler2D shadowMap) {\n  vec4 rgbaDepth = texture2D(shadowMap, position.xy);\n\n  float z = dot(rgbaDepth, bitUnpackShift);\n  return smoothstep(0.001, 0.01, position.z - z);\n}\n\nvec4 shadow_filterShadowColor(vec4 color) {\n  if (shadow_uDrawShadowMap) {\n    vec4 rgbaDepth = fract(gl_FragCoord.z * bitPackShift);\n    rgbaDepth -= rgbaDepth.gbaa * bitMask;\n    return rgbaDepth;\n  }\n  if (shadow_uUseShadowMap) {\n    float shadowAlpha = 0.0;\n    shadowAlpha += shadow_getShadowWeight(shadow_vPosition[0], shadow_uShadowMap0);\n    if(shadow_uLightCount > 1.0) {\n      shadowAlpha += shadow_getShadowWeight(shadow_vPosition[1], shadow_uShadowMap1);\n    }\n    shadowAlpha *= shadow_uColor.a / shadow_uLightCount;\n    float blendedAlpha = shadowAlpha + color.a * (1.0 - shadowAlpha);\n\n    return vec4(\n      mix(color.rgb, shadow_uColor.rgb, shadowAlpha / blendedAlpha),\n      blendedAlpha\n    );\n  }\n  return color;\n}\n",$c=du(Hc),Vc=du(Xc),qc=[0,0,0,1],Wc=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0];function Gc(t,e){const[n,r,i]=t,o=Mc([n,r,i],e);return Number.isFinite(i)?o:[o[0],o[1],0]}function Hc({viewport:t,center:e}){return new Ra["a"](t.viewProjectionMatrix).invert().transform(e)}function Xc({viewport:t,shadowMatrices:e}){const n=[],r=t.pixelUnprojectionMatrix,i=t.isGeospatial?void 0:1,o=[[0,0,i],[t.width,0,i],[0,t.height,i],[t.width,t.height,i],[0,0,-1],[t.width,0,-1],[0,t.height,-1],[t.width,t.height,-1]].map(t=>Gc(t,r));for(const s of e){const e=s.clone().translate(new Ra["b"](t.center).negate()),r=o.map(t=>e.transform(t)),i=(new Ra["a"]).ortho({left:Math.min(...r.map(t=>t[0])),right:Math.max(...r.map(t=>t[0])),bottom:Math.min(...r.map(t=>t[1])),top:Math.max(...r.map(t=>t[1])),near:Math.min(...r.map(t=>-t[2])),far:Math.max(...r.map(t=>-t[2]))});n.push(i.multiplyRight(s))}return n}function Yc(t={},e={}){const n={shadow_uDrawShadowMap:Boolean(t.drawToShadowMap),shadow_uUseShadowMap:!!t.shadowMaps&&t.shadowMaps.length>0,shadow_uColor:t.shadowColor||qc,shadow_uLightId:t.shadowLightId||0,shadow_uLightCount:t.shadowMatrices.length},r=$c({viewport:t.viewport,center:e.project_uCenter}),i=[],o=Vc({shadowMatrices:t.shadowMatrices,viewport:t.viewport}).slice();for(let s=0;s<t.shadowMatrices.length;s++){const n=o[s],a=n.clone().translate(new Ra["b"](t.viewport.center).negate());e.project_uCoordinateSystem===bn.LNGLAT&&e.project_uProjectionMode===_n.WEB_MERCATOR?(o[s]=a,i[s]=r):(o[s]=n.clone().multiplyRight(Wc),i[s]=a.transform(r))}for(let s=0;s<o.length;s++)n["shadow_uViewProjectionMatrices[".concat(s,"]")]=o[s],n["shadow_uProjectCenters[".concat(s,"]")]=i[s],t.shadowMaps&&t.shadowMaps.length>0?n["shadow_uShadowMap".concat(s)]=t.shadowMaps[s]:n["shadow_uShadowMap".concat(s)]=t.dummyShadowMap;return n}var Zc={name:"shadow",dependencies:[Mu],vs:zc,fs:Uc,inject:{"vs:DECKGL_FILTER_GL_POSITION":"\n    position = shadow_setVertexPosition(geometry.position);\n    ","fs:DECKGL_FILTER_COLOR":"\n    color = shadow_filterShadowColor(color);\n    "},getUniforms:(t={},e={})=>{if(t.drawToShadowMap||t.shadowMaps&&t.shadowMaps.length>0){const{shadowEnabled:n=!0}=t;return n&&t.shadowMatrices&&t.shadowMatrices.length>0?Yc(t,e):{shadow_uDrawShadowMap:!1,shadow_uUseShadowMap:!1}}return{}}};const Kc={color:[255,255,255],intensity:1},Jc=[{color:[255,255,255],intensity:1,direction:[-1,3,-1]},{color:[255,255,255],intensity:.9,direction:[1,-8,-2.5]}],Qc=[0,0,0,200/255];class tl extends $a{constructor(t){super(t),this.ambientLight=null,this.directionalLights=[],this.pointLights=[],this.shadowColor=Qc,this.shadowPasses=[],this.shadowMaps=[],this.dummyShadowMap=null,this.shadow=!1,this.programManager=null;for(const e in t){const n=t[e];switch(n.type){case"ambient":this.ambientLight=n;break;case"directional":this.directionalLights.push(n);break;case"point":this.pointLights.push(n);break;default:}}this._applyDefaultLights(),this.shadow=this.directionalLights.some(t=>t.shadow)}preRender(t,{layers:e,layerFilter:n,viewports:r,onViewportActive:i,views:o}){if(this.shadow){this.shadowMatrices=this._createLightMatrix(),0===this.shadowPasses.length&&this._createShadowPasses(t),this.programManager||(this.programManager=Ta.getDefaultProgramManager(t),Zc&&this.programManager.addDefaultModule(Zc)),this.dummyShadowMap||(this.dummyShadowMap=new wo(t,{width:1,height:1}));for(let t=0;t<this.shadowPasses.length;t++){const s=this.shadowPasses[t];s.render({layers:e,layerFilter:n,viewports:r,onViewportActive:i,views:o,moduleParameters:{shadowLightId:t,dummyShadowMap:this.dummyShadowMap,shadowMatrices:this.shadowMatrices}})}}}getModuleParameters(t){const e=this.shadow?{shadowMaps:this.shadowMaps,dummyShadowMap:this.dummyShadowMap,shadowColor:this.shadowColor,shadowMatrices:this.shadowMatrices}:{};return e.lightSources={ambientLight:this.ambientLight,directionalLights:this.directionalLights.map(e=>e.getProjectedLight({layer:t})),pointLights:this.pointLights.map(e=>e.getProjectedLight({layer:t}))},e}cleanup(){for(const t of this.shadowPasses)t.delete();this.shadowPasses.length=0,this.shadowMaps.length=0,this.dummyShadowMap&&(this.dummyShadowMap.delete(),this.dummyShadowMap=null),this.shadow&&this.programManager&&(this.programManager.removeDefaultModule(Zc),this.programManager=null)}_createLightMatrix(){const t=[];for(const e of this.directionalLights){const n=(new Ra["a"]).lookAt({eye:new Ra["b"](e.direction).negate()});t.push(n)}return t}_createShadowPasses(t){for(let e=0;e<this.directionalLights.length;e++){const n=new Xa(t);this.shadowPasses[e]=n,this.shadowMaps[e]=n.shadowMap}}_applyDefaultLights(){const{ambientLight:t,pointLights:e,directionalLights:n}=this;t||0!==e.length||0!==n.length||(this.ambientLight=new Da(Kc),this.directionalLights.push(new Ua(Jc[0]),new Ua(Jc[1])))}}class el{constructor(t){this._pool=[],this.props={overAlloc:2,poolSize:100},this.setProps(t)}setProps(t){Object.assign(this.props,t)}allocate(t,e,{size:n=1,type:r,padding:i=0,copy:o=!1,initialize:s=!1,maxCount:a}){const u=r||t&&t.constructor||Float32Array,c=e*n+i;if(ArrayBuffer.isView(t)){if(c<=t.length)return t;if(c*t.BYTES_PER_ELEMENT<=t.buffer.byteLength)return new u(t.buffer,0,c)}let l;a&&(l=a*n+i);const h=this._allocate(u,c,s,l);return t&&o?h.set(t):s||h.fill(0,0,4),this._release(t),h}release(t){this._release(t)}_allocate(t,e,n,r){let i=Math.max(Math.ceil(e*this.props.overAlloc),1);i>r&&(i=r);const o=this._pool,s=t.BYTES_PER_ELEMENT*i,a=o.findIndex(t=>t.byteLength>=s);if(a>=0){const e=new t(o.splice(a,1)[0],0,i);return n&&e.fill(0),e}return new t(i)}_release(t){if(!ArrayBuffer.isView(t))return;const e=this._pool,{buffer:n}=t,{byteLength:r}=n,i=e.findIndex(t=>t.byteLength>=r);i<0?e.push(n):(i>0||e.length<this.props.poolSize)&&e.splice(i,0,n),e.length>this.props.poolSize&&e.shift()}}var nl=new el;function rl(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function il(t,e){const n=t%e;return n<0?e+n:n}function ol(t){return[t[12],t[13],t[14]]}function sl(t){const e={};return e.left=ul(t[3]+t[0],t[7]+t[4],t[11]+t[8],t[15]+t[12]),e.right=ul(t[3]-t[0],t[7]-t[4],t[11]-t[8],t[15]-t[12]),e.bottom=ul(t[3]+t[1],t[7]+t[5],t[11]+t[9],t[15]+t[13]),e.top=ul(t[3]-t[1],t[7]-t[5],t[11]-t[9],t[15]-t[13]),e.near=ul(t[3]+t[2],t[7]+t[6],t[11]+t[10],t[15]+t[14]),e.far=ul(t[3]-t[2],t[7]-t[6],t[11]-t[10],t[15]-t[14]),e}const al=new Ra["b"];function ul(t,e,n,r){al.set(t,e,n);const i=al.len();return{distance:r/i,normal:new Ra["b"](-t/i,-e/i,-n/i)}}function cl(t){return t-Math.fround(t)}let ll;function hl(t,{size:e=1,startIndex:n=0,endIndex:r}){Number.isFinite(r)||(r=t.length);const i=(r-n)/e;ll=nl.allocate(ll,i,{type:Float32Array,size:2*e});let o=n,s=0;while(o<r){for(let n=0;n<e;n++){const r=t[o++];ll[s+n]=r,ll[s+n+e]=cl(r)}s+=2*e}return ll.subarray(0,i*e*2)}const fl=Math.PI/180,dl=rl(),pl=[0,0,0],gl=0,ml={unitsPerMeter:[1,1,1],metersPerUnit:[1,1,1]};class yl{constructor(t={}){const{id:e=null,x:n=0,y:r=0,width:i=1,height:o=1}=t;this.id=e||this.constructor.displayName||"viewport",this.x=n,this.y=r,this.width=i||1,this.height=o||1,this._frustumPlanes={},this._initViewMatrix(t),this._initProjectionMatrix(t),this._initPixelMatrices(),this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}get metersPerPixel(){return this.distanceScales.metersPerUnit[2]/this.scale}get projectionMode(){return this.isGeospatial?this.zoom<12?_n.WEB_MERCATOR:_n.WEB_MERCATOR_AUTO_OFFSET:_n.IDENTITY}equals(t){return t instanceof yl&&(this===t||t.width===this.width&&t.height===this.height&&t.scale===this.scale&&Object(Ra["e"])(t.projectionMatrix,this.projectionMatrix)&&Object(Ra["e"])(t.viewMatrix,this.viewMatrix))}project(t,{topLeft:e=!0}={}){const n=this.projectPosition(t),r=Ac(n,this.pixelProjectionMatrix),[i,o]=r,s=e?o:this.height-o;return 2===t.length?[i,s]:[i,s,r[2]]}unproject(t,{topLeft:e=!0,targetZ:n}={}){const[r,i,o]=t,s=e?i:this.height-i,a=n&&n*this.distanceScales.unitsPerMeter[2],u=Mc([r,s,o],this.pixelUnprojectionMatrix,a),[c,l,h]=this.unprojectPosition(u);return Number.isFinite(o)?[c,l,h]:Number.isFinite(n)?[c,l,n]:[c,l]}projectPosition(t){const[e,n]=this.projectFlat(t),r=(t[2]||0)*this.distanceScales.unitsPerMeter[2];return[e,n,r]}unprojectPosition(t){const[e,n]=this.unprojectFlat(t),r=(t[2]||0)*this.distanceScales.metersPerUnit[2];return[e,n,r]}projectFlat(t){return this.isGeospatial?gc(t):t}unprojectFlat(t){return this.isGeospatial?mc(t):t}getBounds(t={}){const e={targetZ:t.z||0},n=this.unproject([0,0],e),r=this.unproject([this.width,0],e),i=this.unproject([0,this.height],e),o=this.unproject([this.width,this.height],e);return[Math.min(n[0],r[0],i[0],o[0]),Math.min(n[1],r[1],i[1],o[1]),Math.max(n[0],r[0],i[0],o[0]),Math.max(n[1],r[1],i[1],o[1])]}getDistanceScales(t=null){return t?vc({longitude:t[0],latitude:t[1],highPrecision:!0}):this.distanceScales}containsPixel({x:t,y:e,width:n=1,height:r=1}){return t<this.x+this.width&&this.x<t+n&&e<this.y+this.height&&this.y<e+r}getFrustumPlanes(){return this._frustumPlanes.near?this._frustumPlanes:(Object.assign(this._frustumPlanes,sl(this.viewProjectionMatrix)),this._frustumPlanes)}panByPosition(t,e){return null}getCameraPosition(){return this.cameraPosition}getCameraDirection(){return this.cameraDirection}getCameraUp(){return this.cameraUp}_createProjectionMatrix({orthographic:t,fovyRadians:e,aspect:n,focalDistance:r,near:i,far:o}){return t?(new Ra["a"]).orthographic({fovy:e,aspect:n,focalDistance:r,near:i,far:o}):(new Ra["a"]).perspective({fovy:e,aspect:n,near:i,far:o})}_initViewMatrix(t){const{viewMatrix:e=dl,longitude:n=null,latitude:r=null,zoom:i=null,position:o=null,modelMatrix:s=null,focalDistance:a=1,distanceScales:u=null}=t;this.isGeospatial=Number.isFinite(r)&&Number.isFinite(n),this.zoom=i,Number.isFinite(this.zoom)||(this.zoom=this.isGeospatial?yc({latitude:r})+Math.log2(a):gl);const c=Math.pow(2,this.zoom);this.scale=c,this.distanceScales=this.isGeospatial?vc({latitude:r,longitude:n}):u||ml,this.focalDistance=a,this.distanceScales.metersPerUnit=new Ra["b"](this.distanceScales.metersPerUnit),this.distanceScales.unitsPerMeter=new Ra["b"](this.distanceScales.unitsPerMeter),this.position=pl,this.meterOffset=pl,o&&(this.position=o,this.modelMatrix=s,this.meterOffset=s?s.transformVector(o):o),this.isGeospatial?(this.longitude=n,this.latitude=r,this.center=this._getCenterInWorld({longitude:n,latitude:r})):this.center=o?this.projectPosition(o):[0,0,0],this.viewMatrixUncentered=e,this.viewMatrix=(new Ra["a"]).multiplyRight(this.viewMatrixUncentered).translate(new Ra["b"](this.center||pl).negate())}_getCenterInWorld({longitude:t,latitude:e}){const{meterOffset:n,distanceScales:r}=this,i=new Ra["b"](this.projectPosition([t,e,0]));if(n){const t=new Ra["b"](n).scale(r.unitsPerMeter);i.add(t)}return i}_initProjectionMatrix(t){const{projectionMatrix:e=null,orthographic:n=!1,fovyRadians:r,fovy:i=75,near:o=.1,far:s=1e3,focalDistance:a=1}=t;this.projectionMatrix=e||this._createProjectionMatrix({orthographic:n,fovyRadians:r||i*fl,aspect:this.width/this.height,focalDistance:a,near:o,far:s})}_initPixelMatrices(){const t=rl();su(t,t,this.projectionMatrix),su(t,t,this.viewMatrix),this.viewProjectionMatrix=t,this.viewMatrixInverse=ou([],this.viewMatrix)||this.viewMatrix,this.cameraPosition=ol(this.viewMatrixInverse);const e=rl(),n=rl();uu(e,e,[this.width/2,-this.height/2,1]),au(e,e,[1,-1,0]),su(n,e,this.viewProjectionMatrix),this.pixelProjectionMatrix=n,this.viewportMatrix=e,this.pixelUnprojectionMatrix=ou(rl(),this.pixelProjectionMatrix),this.pixelUnprojectionMatrix||vn.warn("Pixel project matrix not invertible")()}}function vl(){var t=new iu(2);return iu!=Float32Array&&(t[0]=0,t[1]=0),t}function bl(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t}function _l(t,e){return t[0]=-e[0],t[1]=-e[1],t}yl.displayName="Viewport";(function(){var t=vl()})();const wl=512,xl=4003e4,Sl=Math.PI/180;function El(t){const e=Math.cos(t*Sl);return wl/xl/e}class Al extends yl{constructor(t={}){const{latitude:e=0,longitude:n=0,zoom:r=11,pitch:i=0,bearing:o=0,nearZMultiplier:s=.1,farZMultiplier:a=1.01,orthographic:u=!1,projectionMatrix:c,repeat:l=!1,worldOffset:h=0,legacyMeterSizes:f=!1}=t;let{width:d,height:p,altitude:g=1.5}=t;const m=Math.pow(2,r);let y;d=d||1,p=p||1;let v=null;c?(g=c[5]/2,y=Sc(g)):(t.fovy?(y=t.fovy,g=Ec(y)):y=Sc(g),v=wc({width:d,height:p,pitch:i,fovy:y,nearZMultiplier:s,farZMultiplier:a}));let b=_c({height:p,pitch:i,bearing:o,scale:m,altitude:g});if(h){const t=(new Ra["a"]).translate([512*h,0,0]);b=t.multiplyLeft(b)}super({...t,width:d,height:p,viewMatrix:b,longitude:n,latitude:e,zoom:r,...v,fovy:y,focalDistance:g}),this.latitude=e,this.longitude=n,this.zoom=r,this.pitch=i,this.bearing=o,this.altitude=g,this.fovy=y,this.orthographic=u,this._subViewports=l?[]:null,this._pseudoMeters=f,Object.freeze(this)}get subViewports(){if(this._subViewports&&!this._subViewports.length){const t=this.getBounds(),e=Math.floor((t[0]+180)/360),n=Math.ceil((t[2]-180)/360);for(let r=e;r<=n;r++){const t=r?new Al({...this,worldOffset:r}):this;this._subViewports.push(t)}}return this._subViewports}projectPosition(t){if(this._pseudoMeters)return super.projectPosition(t);const[e,n]=this.projectFlat(t),r=(t[2]||0)*El(t[1]);return[e,n,r]}unprojectPosition(t){if(this._pseudoMeters)return super.unprojectPosition(t);const[e,n]=this.unprojectFlat(t),r=(t[2]||0)/El(n);return[e,n,r]}addMetersToLngLat(t,e){return bc(t,e)}panByPosition(t,e){const n=Mc(e,this.pixelUnprojectionMatrix),r=this.projectFlat(t),i=bl([],r,_l([],n)),o=bl([],this.center,i),[s,a]=this.unprojectFlat(o);return{longitude:s,latitude:a}}getBounds(t={}){const e=Oc(this,t.z||0);return[Math.min(e[0][0],e[1][0],e[2][0],e[3][0]),Math.min(e[0][1],e[1][1],e[2][1],e[3][1]),Math.max(e[0][0],e[1][0],e[2][0],e[3][0]),Math.max(e[0][1],e[1][1],e[2][1],e[3][1])]}fitBounds(t,e={}){const{width:n,height:r}=this,{longitude:i,latitude:o,zoom:s}=Cc({width:n,height:r,bounds:t,...e});return new Al({width:n,height:r,longitude:i,latitude:o,zoom:s})}}function Ml(){var t=new iu(3);return iu!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function Cl(t){var e=t[0],n=t[1],r=t[2];return Math.hypot(e,n,r)}function kl(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}function Ol(t){var e=t[0],n=t[1],r=t[2];return e*e+n*n+r*r}function Pl(t,e,n,r){var i=e[0],o=e[1],s=e[2];return t[0]=i+r*(n[0]-i),t[1]=o+r*(n[1]-o),t[2]=s+r*(n[2]-s),t}Al.displayName="WebMercatorViewport";var Tl=kl,Ll=Cl,Il=Ol;(function(){var t=Ml()})();function Nl(t,e,n=!1){const r=e.projectPosition(t);if(n&&e instanceof Al){const[n,i,o=0]=t,s=e.getDistanceScales([n,i]);r[2]=o*s.unitsPerMeter[2]}return r}function Dl(t){const e={...t};let{coordinateSystem:n}=t;const{viewport:r,coordinateOrigin:i,fromCoordinateSystem:o,fromCoordinateOrigin:s}=t;return n===bn.DEFAULT&&(n=r.isGeospatial?bn.LNGLAT:bn.CARTESIAN),void 0===o&&(e.fromCoordinateSystem=n),void 0===s&&(e.fromCoordinateOrigin=i),e.coordinateSystem=n,e}function Rl(t,{viewport:e,modelMatrix:n,coordinateSystem:r,coordinateOrigin:i,offsetMode:o}){let[s,a,u=0]=t;switch(n&&([s,a,u]=hu([],[s,a,u,1],n)),r){case bn.LNGLAT:return Nl([s,a,u],e,o);case bn.LNGLAT_OFFSETS:return Nl([s+i[0],a+i[1],u+(i[2]||0)],e,o);case bn.METER_OFFSETS:return Nl(bc(i,[s,a,u]),e,o);case bn.CARTESIAN:default:return e.isGeospatial?[s+i[0],a+i[1],u+i[2]]:e.projectPosition([s,a,u])}}function Fl(t,e){const{viewport:n,coordinateSystem:r,coordinateOrigin:i,modelMatrix:o,fromCoordinateSystem:s,fromCoordinateOrigin:a}=Dl(e),{geospatialOrigin:u,shaderCoordinateOrigin:c,offsetMode:l}=_u(n,r,i),h=Rl(t,{viewport:n,modelMatrix:o,coordinateSystem:s,coordinateOrigin:a,offsetMode:l});if(l){const t=n.projectPosition(u||c);Tl(h,h,t)}return h}const Bl=[255,255,255],jl=1,zl=[0,0,1],Ul=[0,0,1];let $l=0;class Vl{constructor(t={}){const{color:e=Bl}=t,{intensity:n=jl}=t,{position:r=Ul}=t;this.id=t.id||"point-".concat($l++),this.color=e,this.intensity=n,this.type="point",this.position=r,this.attenuation=ql(t),this.projectedLight={...this}}getProjectedLight({layer:t}){const{projectedLight:e}=this,n=t.context.viewport,{coordinateSystem:r,coordinateOrigin:i}=t.props,o=Fl(this.position,{viewport:n,coordinateSystem:r,coordinateOrigin:i,fromCoordinateSystem:n.isGeospatial?bn.LNGLAT:bn.CARTESIAN,fromCoordinateOrigin:[0,0,0]});return e.color=this.color,e.intensity=this.intensity,e.position=o,e}}function ql(t){return"attenuation"in t?t.attenuation:"intensity"in t?[0,0,t.intensity]:zl}class Wl extends Vl{getProjectedLight({layer:t}){const{projectedLight:e}=this,n=t.context.viewport,{coordinateSystem:r,coordinateOrigin:i,modelMatrix:o}=t.props,{project_uCameraPosition:s}=xu({viewport:n,modelMatrix:o,coordinateSystem:r,coordinateOrigin:i});return e.color=this.color,e.intensity=this.intensity,e.position=s,e}}const Gl=Math.PI/180,Hl=864e5,Xl=2440588,Yl=2451545,Zl=23.4397*Gl,Kl=357.5291,Jl=.98560028,Ql=280.147,th=360.9856235;function eh(t,e,n){const r=Gl*-n,i=Gl*e,o=ih(t),s=fh(o),a=ch(o,r)-s.rightAscension;return{azimuth:ah(a,i,s.declination),altitude:uh(a,i,s.declination)}}function nh(t,e,n){const{azimuth:r,altitude:i}=eh(t,e,n);return[Math.sin(r)*Math.cos(i),Math.cos(r)*Math.cos(i),-Math.sin(i)]}function rh(t){return t/Hl-.5+Xl}function ih(t){return rh(t)-Yl}function oh(t,e){const n=t;return Math.atan2(Math.sin(n)*Math.cos(Zl)-Math.tan(e)*Math.sin(Zl),Math.cos(n))}function sh(t,e){const n=t;return Math.asin(Math.sin(e)*Math.cos(Zl)+Math.cos(e)*Math.sin(Zl)*Math.sin(n))}function ah(t,e,n){const r=t,i=e,o=n;return Math.atan2(Math.sin(r),Math.cos(r)*Math.sin(i)-Math.tan(o)*Math.cos(i))}function uh(t,e,n){const r=t,i=e,o=n;return Math.asin(Math.sin(i)*Math.sin(o)+Math.cos(i)*Math.cos(o)*Math.cos(r))}function ch(t,e){return Gl*(Ql+th*t)-e}function lh(t){return Gl*(Kl+Jl*t)}function hh(t){const e=t,n=Gl*(1.9148*Math.sin(e)+.02*Math.sin(2*e)+3e-4*Math.sin(3*e)),r=102.9372*Gl;return e+n+r+Math.PI}function fh(t){const e=lh(t),n=hh(e);return{declination:sh(n,0),rightAscension:oh(n,0)}}class dh extends Ua{constructor({timestamp:t,...e}){super(e),this.timestamp=t}getProjectedLight({layer:t}){const{viewport:e}=t.context,n=e.resolution>0;if(n){const[t,e,n]=nh(this.timestamp,0,0);this.direction=[t,-n,e]}else{const{latitude:t,longitude:n}=e;this.direction=nh(this.timestamp,t,n)}return this}}let ph=null;function gh(t){return(!ph||ph.byteLength<t)&&(ph=new ArrayBuffer(t)),ph}function mh(t,e){const n=gh(t.BYTES_PER_ELEMENT*e);return new t(n,0,e)}function yh({target:t,source:e,start:n=0,count:r=1}){const i=e.length,o=r*i;let s=0;for(let a=n;s<i;s++)t[a++]=e[s];while(s<o)s<o-s?(t.copyWithin(n+s,n,n+s),s*=2):(t.copyWithin(n+s,n,n+o-s),s=o);return t}var vh=n("7f26"),bh=n("d6df"),_h=n("a070");function wh(t){if(!t&&!Object(bh["a"])())return"Node";if(Object(_h["a"])(t))return"Electron";const e="undefined"!==typeof navigator?navigator:{},n=t||e.userAgent||"";if(n.indexOf("Edge")>-1)return"Edge";const r=-1!==n.indexOf("MSIE "),i=-1!==n.indexOf("Trident/");return r||i?"IE":vh["a"].chrome?"Chrome":vh["a"].safari?"Safari":vh["a"].mozInnerScreenX?"Firefox":"Unknown"}const xh="elements must be GL.ELEMENT_ARRAY_BUFFER";class Sh extends Yi{static isSupported(t,e={}){return!e.constantAttributeZero||(Object(ci["e"])(t)||"Chrome"===wh())}static getDefaultArray(t){return t.luma=t.luma||{},t.luma.defaultVertexArray||(t.luma.defaultVertexArray=new Sh(t,{handle:null,isDefaultArray:!0})),t.luma.defaultVertexArray}static getMaxAttributes(t){return Sh.MAX_ATTRIBUTES=Sh.MAX_ATTRIBUTES||t.getParameter(34921),Sh.MAX_ATTRIBUTES}static setConstant(t,e,n){switch(n.constructor){case Float32Array:Sh._setConstantFloatArray(t,e,n);break;case Int32Array:Sh._setConstantIntArray(t,e,n);break;case Uint32Array:Sh._setConstantUintArray(t,e,n);break;default:zi(!1)}}constructor(t,e={}){const n=e.id||e.program&&e.program.id;super(t,Object.assign({},e,{id:n})),this.buffer=null,this.bufferValue=null,this.isDefaultArray=e.isDefaultArray||!1,this.gl2=t,this.initialize(e),Object.seal(this)}delete(){return super.delete(),this.buffer&&this.buffer.delete(),this}get MAX_ATTRIBUTES(){return Sh.getMaxAttributes(this.gl)}initialize(t={}){return this.setProps(t)}setProps(t){return this}setElementBuffer(t=null,e={}){return zi(!t||34963===t.target,xh),this.bind(()=>{this.gl.bindBuffer(34963,t?t.handle:null)}),this}setBuffer(t,e,n){if(34963===e.target)return this.setElementBuffer(e,n);const{size:r,type:i,stride:o,offset:s,normalized:a,integer:u,divisor:c}=n,{gl:l,gl2:h}=this;return t=Number(t),this.bind(()=>{l.bindBuffer(34962,e.handle),u?(zi(Object(ci["e"])(l)),h.vertexAttribIPointer(t,r,i,o,s)):l.vertexAttribPointer(t,r,i,a,o,s),l.enableVertexAttribArray(t),h.vertexAttribDivisor(t,c||0)}),this}enable(t,e=!0){const n=!e&&0===t&&!Sh.isSupported(this.gl,{constantAttributeZero:!0});return n||(t=Number(t),this.bind(()=>e?this.gl.enableVertexAttribArray(t):this.gl.disableVertexAttribArray(t))),this}getConstantBuffer(t,e){const n=this._normalizeConstantArrayValue(e),r=n.byteLength*t,i=n.length*t;let o=!this.buffer;if(this.buffer=this.buffer||new co(this.gl,r),o=o||this.buffer.reallocate(r),o=o||!this._compareConstantArrayValues(n,this.bufferValue),o){const t=mh(e.constructor,i);yh({target:t,source:n,start:0,count:i}),this.buffer.subData(t),this.bufferValue=e}return this.buffer}_normalizeConstantArrayValue(t){return Array.isArray(t)?new Float32Array(t):t}_compareConstantArrayValues(t,e){if(!t||!e||t.length!==e.length||t.constructor!==e.constructor)return!1;for(let n=0;n<t.length;++n)if(t[n]!==e[n])return!1;return!0}static _setConstantFloatArray(t,e,n){switch(n.length){case 1:t.vertexAttrib1fv(e,n);break;case 2:t.vertexAttrib2fv(e,n);break;case 3:t.vertexAttrib3fv(e,n);break;case 4:t.vertexAttrib4fv(e,n);break;default:zi(!1)}}static _setConstantIntArray(t,e,n){switch(zi(Object(ci["e"])(t)),n.length){case 1:t.vertexAttribI1iv(e,n);break;case 2:t.vertexAttribI2iv(e,n);break;case 3:t.vertexAttribI3iv(e,n);break;case 4:t.vertexAttribI4iv(e,n);break;default:zi(!1)}}static _setConstantUintArray(t,e,n){switch(zi(Object(ci["e"])(t)),n.length){case 1:t.vertexAttribI1uiv(e,n);break;case 2:t.vertexAttribI2uiv(e,n);break;case 3:t.vertexAttribI3uiv(e,n);break;case 4:t.vertexAttribI4uiv(e,n);break;default:zi(!1)}}_createHandle(){const t=this.gl;return t.createVertexArray()}_deleteHandle(t){return this.gl2.deleteVertexArray(t),[this.elements]}_bindHandle(t){this.gl2.bindVertexArray(t)}_getParameter(t,{location:e}){return zi(Number.isFinite(e)),this.bind(()=>{switch(t){case 34373:return this.gl.getVertexAttribOffset(e,t);default:return this.gl.getVertexAttrib(e,t)}})}}const Eh="VertexArray: attributes must be Buffers or constants (i.e. typed array)",Ah=/^(.+)__LOCATION_([0-9]+)$/,Mh=["setBuffers","setGeneric","clearBindings","setLocations","setGenericValues","setDivisor","enable","disable"];class Ch{constructor(t,e={}){const n=e.id||e.program&&e.program.id;this.id=n,this.gl=t,this.configuration=null,this.elements=null,this.elementsAccessor=null,this.values=null,this.accessors=null,this.unused=null,this.drawParams=null,this.buffer=null,this.attributes={},this.vertexArrayObject=new Sh(t),Hi(this,"VertexArray","v6.0",Mh),this.initialize(e),Object.seal(this)}delete(){this.buffer&&this.buffer.delete(),this.vertexArrayObject.delete()}initialize(t={}){return this.reset(),this.configuration=null,this.bindOnUse=!1,this.setProps(t)}reset(){this.elements=null,this.elementsAccessor=null;const{MAX_ATTRIBUTES:t}=this.vertexArrayObject;return this.values=new Array(t).fill(null),this.accessors=new Array(t).fill(null),this.unused={},this.drawParams=null,this}setProps(t){return"program"in t&&(this.configuration=t.program&&t.program.configuration),"configuration"in t&&(this.configuration=t.configuration),"attributes"in t&&this.setAttributes(t.attributes),"elements"in t&&this.setElementBuffer(t.elements),"bindOnUse"in t&&(t=t.bindOnUse),this}clearDrawParams(){this.drawParams=null}getDrawParams(){return this.drawParams=this.drawParams||this._updateDrawParams(),this.drawParams}setAttributes(t){return Object.assign(this.attributes,t),this.vertexArrayObject.bind(()=>{for(const e in t){const n=t[e];this._setAttribute(e,n)}this.gl.bindBuffer(34962,null)}),this}setElementBuffer(t=null,e={}){return this.elements=t,this.elementsAccessor=e,this.clearDrawParams(),this.vertexArrayObject.setElementBuffer(t,e),this}setBuffer(t,e,n={}){if(34963===e.target)return this.setElementBuffer(e,n);const{location:r,accessor:i}=this._resolveLocationAndAccessor(t,e,e.accessor,n);return r>=0&&(this.values[r]=e,this.accessors[r]=i,this.clearDrawParams(),this.vertexArrayObject.setBuffer(r,e,i)),this}setConstant(t,e,n={}){const{location:r,accessor:i}=this._resolveLocationAndAccessor(t,e,Object.assign({size:e.length},n));return r>=0&&(e=this.vertexArrayObject._normalizeConstantArrayValue(e),this.values[r]=e,this.accessors[r]=i,this.clearDrawParams(),this.vertexArrayObject.enable(r,!1)),this}unbindBuffers(){return this.vertexArrayObject.bind(()=>{this.elements&&this.vertexArrayObject.setElementBuffer(null),this.buffer=this.buffer||new co(this.gl,{accessor:{size:4}});for(let t=0;t<this.vertexArrayObject.MAX_ATTRIBUTES;t++)this.values[t]instanceof co&&(this.gl.disableVertexAttribArray(t),this.gl.bindBuffer(34962,this.buffer.handle),this.gl.vertexAttribPointer(t,1,5126,!1,0,0))}),this}bindBuffers(){return this.vertexArrayObject.bind(()=>{this.elements&&this.setElementBuffer(this.elements);for(let t=0;t<this.vertexArrayObject.MAX_ATTRIBUTES;t++){const e=this.values[t];e instanceof co&&this.setBuffer(t,e)}}),this}bindForDraw(t,e,n){let r;return this.vertexArrayObject.bind(()=>{this._setConstantAttributes(t,e),r=n()}),r}_resolveLocationAndAccessor(t,e,n,r){const i={location:-1,accessor:null},{location:o,name:s}=this._getAttributeIndex(t);if(!Number.isFinite(o)||o<0)return this.unused[t]=e,ui.once(3,()=>`unused value ${t} in ${this.id}`)(),i;const a=this._getAttributeInfo(s||o);if(!a)return i;const u=this.accessors[o]||{},c=io.resolve(a.accessor,u,n,r),{size:l,type:h}=c;return zi(Number.isFinite(l)&&Number.isFinite(h)),{location:o,accessor:c}}_getAttributeInfo(t){return this.configuration&&this.configuration.getAttributeInfo(t)}_getAttributeIndex(t){const e=Number(t);if(Number.isFinite(e))return{location:e};const n=Ah.exec(t),r=n?n[1]:t,i=n?Number(n[2]):0;return this.configuration?{location:this.configuration.getAttributeLocation(r)+i,name:r}:{location:-1}}_setAttribute(t,e){if(e instanceof co)this.setBuffer(t,e);else if(Array.isArray(e)&&e.length&&e[0]instanceof co){const n=e[0],r=e[1];this.setBuffer(t,n,r)}else if(ArrayBuffer.isView(e)||Array.isArray(e)){const n=e;this.setConstant(t,n)}else{if(!(e.buffer instanceof co))throw new Error(Eh);{const n=e;this.setBuffer(t,n.buffer,n)}}}_setConstantAttributes(t,e){const n=Math.max(0|t,0|e);let r=this.values[0];ArrayBuffer.isView(r)&&this._setConstantAttributeZero(r,n);for(let i=1;i<this.vertexArrayObject.MAX_ATTRIBUTES;i++)r=this.values[i],ArrayBuffer.isView(r)&&this._setConstantAttribute(i,r)}_setConstantAttributeZero(t,e){if(Sh.isSupported(this.gl,{constantAttributeZero:!0}))return void this._setConstantAttribute(0,t);const n=this.vertexArrayObject.getConstantBuffer(e,t);this.vertexArrayObject.setBuffer(0,n,this.accessors[0])}_setConstantAttribute(t,e){Sh.setConstant(this.gl,t,e)}_updateDrawParams(){const t={isIndexed:!1,isInstanced:!1,indexCount:1/0,vertexCount:1/0,instanceCount:1/0};for(let e=0;e<this.vertexArrayObject.MAX_ATTRIBUTES;e++)this._updateDrawParamsForLocation(t,e);return this.elements&&(t.elementCount=this.elements.getElementCount(this.elements.accessor),t.isIndexed=!0,t.indexType=this.elementsAccessor.type||this.elements.accessor.type,t.indexOffset=this.elementsAccessor.offset||0),t.indexCount===1/0&&(t.indexCount=0),t.vertexCount===1/0&&(t.vertexCount=0),t.instanceCount===1/0&&(t.instanceCount=0),t}_updateDrawParamsForLocation(t,e){const n=this.values[e],r=this.accessors[e];if(!n)return;const{divisor:i}=r,o=i>0;if(t.isInstanced=t.isInstanced||o,n instanceof co){const e=n;if(o){const n=e.getVertexCount(r);t.instanceCount=Math.min(t.instanceCount,n)}else{const n=e.getVertexCount(r);t.vertexCount=Math.min(t.vertexCount,n)}}}setElements(t=null,e={}){return ui.deprecated("setElements","setElementBuffer")(),this.setElementBuffer(t,e)}}class kh extends Yi{static isSupported(t){return Object(ci["e"])(t)}constructor(t,e={}){Object(ci["a"])(t),super(t,e),this.initialize(e),this.stubRemovedMethods("TransformFeedback","v6.0",["pause","resume"]),Object.seal(this)}initialize(t={}){return this.buffers={},this.unused={},this.configuration=null,this.bindOnUse=!0,Gi(this.buffers)||this.bind(()=>this._unbindBuffers()),this.setProps(t),this}setProps(t){"program"in t&&(this.configuration=t.program&&t.program.configuration),"configuration"in t&&(this.configuration=t.configuration),"bindOnUse"in t&&(t=t.bindOnUse),"buffers"in t&&this.setBuffers(t.buffers)}setBuffers(t={}){return this.bind(()=>{for(const e in t)this.setBuffer(e,t[e])}),this}setBuffer(t,e){const n=this._getVaryingIndex(t),{buffer:r,byteSize:i,byteOffset:o}=this._getBufferParams(e);return n<0?(this.unused[t]=r,ui.warn(()=>`${this.id} unused varying buffer ${t}`)(),this):(this.buffers[n]=e,this.bindOnUse||this._bindBuffer(n,r,o,i),this)}begin(t=0){return this.gl.bindTransformFeedback(36386,this.handle),this._bindBuffers(),this.gl.beginTransformFeedback(t),this}end(){return this.gl.endTransformFeedback(),this._unbindBuffers(),this.gl.bindTransformFeedback(36386,null),this}_getBufferParams(t){let e,n,r;return t instanceof co===!1?(r=t.buffer,n=t.byteSize,e=t.byteOffset):r=t,void 0===e&&void 0===n||(e=e||0,n=n||r.byteLength-e),{buffer:r,byteOffset:e,byteSize:n}}_getVaryingInfo(t){return this.configuration&&this.configuration.getVaryingInfo(t)}_getVaryingIndex(t){if(this.configuration)return this.configuration.getVaryingInfo(t).location;const e=Number(t);return Number.isFinite(e)?e:-1}_bindBuffers(){if(this.bindOnUse)for(const t in this.buffers){const{buffer:e,byteSize:n,byteOffset:r}=this._getBufferParams(this.buffers[t]);this._bindBuffer(t,e,r,n)}}_unbindBuffers(){if(this.bindOnUse)for(const t in this.buffers)this._bindBuffer(t,null)}_bindBuffer(t,e,n=0,r){const i=e&&e.handle;return i&&void 0!==r?this.gl.bindBufferRange(35982,t,i,n,r):this.gl.bindBufferBase(35982,t,i),this}_createHandle(){return this.gl.createTransformFeedback()}_deleteHandle(){this.gl.deleteTransformFeedback(this.handle)}_bindHandle(t){this.gl.bindTransformFeedback(36386,this.handle)}}function Oh(t,e){const{maxElts:n=16,size:r=1}=e;let i="[";for(let s=0;s<t.length&&s<n;++s)s>0&&(i+=`,${s%r===0?" ":""}`),i+=Ph(t[s],e);const o=t.length>n?"...":"]";return`${i}${o}`}function Ph(t,e={}){const n=1e-16,{isInteger:r=!1}=e;if(Array.isArray(t)||ArrayBuffer.isView(t))return Oh(t,e);if(!Number.isFinite(t))return String(t);if(Math.abs(t)<n)return r?"0":"0.";if(r)return t.toFixed(0);if(Math.abs(t)>100&&Math.abs(t)<1e4)return t.toFixed(0);const i=t.toPrecision(2),o=i.indexOf(".0");return o===i.length-2?i.slice(0,-1):i}function Th({vertexArray:t,header:e="Attributes"}){if(!t.configuration)return{};const n={};t.elements&&(n.ELEMENT_ARRAY_BUFFER=Lh(t,t.elements,null,e));const r=t.values;for(const i in r){const o=t._getAttributeInfo(i);if(o){let s=`${i}: ${o.name}`;const a=t.accessors[o.location];a&&(s=`${i}: ${Ih(o.name,a)}`),n[s]=Lh(t,r[i],a,e)}}return n}function Lh(t,e,n,r){const{gl:i}=t;if(!e)return{[r]:"null","Format ":"N/A"};let o,s,a,u="NOT PROVIDED",c=1,l=0,h=0;if(n&&(u=n.type,c=n.size,u=String(u).replace("Array",""),o=-1!==u.indexOf("nt")),e instanceof co){const t=e,{data:f,changed:d}=t.getDebugData();let p;if(s=d?"*":"",a=f,h=t.byteLength,l=h/f.BYTES_PER_ELEMENT/c,n){const t=n.divisor>0;p=`${t?"I ":"P "} ${l} (x${c}=${h} bytes ${$i(i,u)})`}else o=!0,p=`${h} bytes`;return{[r]:`${s}${Ph(a,{size:c,isInteger:o})}`,"Format ":p}}return a=e,c=e.length,u=String(e.constructor.name).replace("Array",""),o=-1!==u.indexOf("nt"),{[r]:`${Ph(a,{size:c,isInteger:o})} (constant)`,"Format ":`${c}x${u} (constant)`}}function Ih(t,e){const{type:n,size:r}=e,i=Aa(n,r);return i?`${t} (${i.name})`:t}function Nh({header:t="Uniforms",program:e,uniforms:n,undefinedOnly:r=!1}){zi(e);const i=".*_.*",o=".*Matrix",s=e._uniformSetters,a={},u=Object.keys(s).sort();let c=0;for(const f of u)f.match(i)||f.match(o)||Dh({table:a,header:t,uniforms:n,uniformName:f,undefinedOnly:r})&&c++;for(const f of u)f.match(o)&&Dh({table:a,header:t,uniforms:n,uniformName:f,undefinedOnly:r})&&c++;for(const f of u)a[f]||Dh({table:a,header:t,uniforms:n,uniformName:f,undefinedOnly:r})&&c++;let l=0;const h={};if(!r)for(const f in n){const e=n[f];a[f]||(l++,h[f]={Type:`NOT USED: ${e}`,[t]:Ph(e)})}return{table:a,count:c,unusedTable:h,unusedCount:l}}function Dh({table:t,header:e,uniforms:n,uniformName:r,undefinedOnly:i}){const o=n[r],s=Rh(o);return(!i||!s)&&(t[r]={[e]:s?Ph(o):"N/A","Uniform Type":s?o:"NOT PROVIDED"},!0)}function Rh(t){return void 0!==t&&null!==t}function Fh(t){const e={},n=`Accessors for ${t.id}`;for(const r of t.attributeInfos)if(r){const t=Bh(r);e[`in ${t}`]={[n]:JSON.stringify(r.accessor)}}for(const r of t.varyingInfos)if(r){const t=Bh(r);e[`out ${t}`]={[n]:JSON.stringify(r.accessor)}}return e}function Bh(t){const{type:e,size:n}=t.accessor,r=Aa(e,n);return r?`${r.name} ${t.name}`:t.name}const jh={POSITION:"positions",NORMAL:"normals",COLOR_0:"colors",TEXCOORD_0:"texCoords",TEXCOORD_1:"texCoords1",TEXCOORD_2:"texCoords2"};function zh(t,e,n){const r={};let i=e.indices;for(const o in e.attributes){const s=e.attributes[o],a=Uh(o,n);if("indices"===o)i=s;else if(s.constant)r[a]=s.value;else{const e=s.value,n={...s};delete n.value,r[a]=[new co(t,e),n],$h(o,n)}}if(i){const e=i.value||i;zi(e instanceof Uint16Array||e instanceof Uint32Array,'attribute array for "indices" must be of integer type');const n={size:1,isIndexed:void 0===i.isIndexed||i.isIndexed};r.indices=[new co(t,{data:e,target:34963}),n]}return r}function Uh(t,e){const{attributeMap:n=jh}=e||{};return n&&n[t]||t}function $h(t,e){let n;switch(t){case"texCoords":case"texCoord1":case"texCoord2":case"texCoord3":n="uvs";break;case"vertices":case"positions":case"normals":case"pickingColors":n="vectors";break;default:}switch(n){case"vectors":e.size=e.size||3;break;case"uvs":e.size=e.size||2;break;default:}zi(Number.isFinite(e.size),`attribute ${t} needs size`)}const Vh=2,qh=1e4,Wh="Model needs drawMode and vertexCount",Gh=()=>{},Hh={};class Xh{constructor(t,e={}){const{id:n=qi("model")}=e;zi(Object(ci["d"])(t)),this.id=n,this.gl=t,this.id=e.id||qi("Model"),this.lastLogTime=0,this.animated=!1,this.initialize(e)}initialize(t){this.props={},this.programManager=t.programManager||Ta.getDefaultProgramManager(this.gl),this._programManagerState=-1,this._managedProgram=!1;const{program:e=null,vs:n,fs:r,modules:i,defines:o,inject:s,varyings:a,bufferMode:u,transpileToGLSL100:c}=t;this.programProps={program:e,vs:n,fs:r,modules:i,defines:o,inject:s,varyings:a,bufferMode:u,transpileToGLSL100:c},this.program=null,this.vertexArray=null,this._programDirty=!0,this.userData={},this.needsRedraw=!0,this._attributes={},this.attributes={},this.uniforms={},this.pickable=!0,this._checkProgram(),this.setUniforms(Object.assign({},this.getModuleUniforms(t.moduleSettings))),this.drawMode=void 0!==t.drawMode?t.drawMode:4,this.vertexCount=t.vertexCount||0,this.geometryBuffers={},this.isInstanced=t.isInstanced||t.instanced||t.instanceCount>0,this._setModelProps(t),this.geometry={},zi(void 0!==this.drawMode&&Number.isFinite(this.vertexCount),Wh)}setProps(t){this._setModelProps(t)}delete(){for(const t in this._attributes)this._attributes[t]!==this.attributes[t]&&this._attributes[t].delete();this._managedProgram&&(this.programManager.release(this.program),this._managedProgram=!1),this.vertexArray.delete(),this._deleteGeometryBuffers()}getDrawMode(){return this.drawMode}getVertexCount(){return this.vertexCount}getInstanceCount(){return this.instanceCount}getAttributes(){return this.attributes}getProgram(){return this.program}setProgram(t){const{program:e,vs:n,fs:r,modules:i,defines:o,inject:s,varyings:a,bufferMode:u,transpileToGLSL100:c}=t;this.programProps={program:e,vs:n,fs:r,modules:i,defines:o,inject:s,varyings:a,bufferMode:u,transpileToGLSL100:c},this._programDirty=!0}getUniforms(){return this.uniforms}setDrawMode(t){return this.drawMode=t,this}setVertexCount(t){return zi(Number.isFinite(t)),this.vertexCount=t,this}setInstanceCount(t){return zi(Number.isFinite(t)),this.instanceCount=t,this}setGeometry(t){return this.drawMode=t.drawMode,this.vertexCount=t.getVertexCount(),this._deleteGeometryBuffers(),this.geometryBuffers=zh(this.gl,t),this.vertexArray.setAttributes(this.geometryBuffers),this}setAttributes(t={}){if(Gi(t))return this;const e={};for(const n in t){const r=t[n];e[n]=r.getValue?r.getValue():r}return this.vertexArray.setAttributes(e),this}setUniforms(t={}){return Object.assign(this.uniforms,t),this}getModuleUniforms(t){this._checkProgram();const e=this.programManager.getUniforms(this.program);return e?e(t):{}}updateModuleSettings(t){const e=this.getModuleUniforms(t||{});return this.setUniforms(e)}clear(t){return No(this.program.gl,t),this}draw(t={}){this._checkProgram();const{moduleSettings:e=null,framebuffer:n,uniforms:r={},attributes:i={},transformFeedback:o=this.transformFeedback,parameters:s={},vertexArray:a=this.vertexArray}=t;let u;this.setAttributes(i),this.updateModuleSettings(e),this.setUniforms(r),ui.priority>=Vh&&(u=this._logDrawCallStart(Vh));const c=this.vertexArray.getDrawParams(),{isIndexed:l=c.isIndexed,indexType:h=c.indexType,indexOffset:f=c.indexOffset,vertexArrayInstanced:d=c.isInstanced}=this.props;d&&!this.isInstanced&&ui.warn("Found instanced attributes on non-instanced model",this.id)();const{isInstanced:p,instanceCount:g}=this,{onBeforeRender:m=Gh,onAfterRender:y=Gh}=this.props;m(),this.program.setUniforms(this.uniforms);const v=this.program.draw(Object.assign(Hh,t,{logPriority:u,uniforms:null,framebuffer:n,parameters:s,drawMode:this.getDrawMode(),vertexCount:this.getVertexCount(),vertexArray:a,transformFeedback:o,isIndexed:l,indexType:h,isInstanced:p,instanceCount:g,offset:l?f:0}));return y(),ui.priority>=Vh&&this._logDrawCallEnd(u,a,n),v}transform(t={}){const{discard:e=!0,feedbackBuffers:n,unbindModels:r=[]}=t;let{parameters:i}=t;n&&this._setFeedbackBuffers(n),e&&(i=Object.assign({},i,{[35977]:e})),r.forEach(t=>t.vertexArray.unbindBuffers());try{this.draw(Object.assign({},t,{parameters:i}))}finally{r.forEach(t=>t.vertexArray.bindBuffers())}return this}render(t={}){return ui.warn("Model.render() is deprecated. Use Model.setUniforms() and Model.draw()")(),this.setUniforms(t).draw()}_setModelProps(t){Object.assign(this.props,t),"uniforms"in t&&this.setUniforms(t.uniforms),"pickable"in t&&(this.pickable=t.pickable),"instanceCount"in t&&(this.instanceCount=t.instanceCount),"geometry"in t&&this.setGeometry(t.geometry),"attributes"in t&&this.setAttributes(t.attributes),"_feedbackBuffers"in t&&this._setFeedbackBuffers(t._feedbackBuffers)}_checkProgram(){const t=this._programDirty||this.programManager.stateHash!==this._programManagerState;if(!t)return;let{program:e}=this.programProps;if(e)this._managedProgram=!1;else{const{vs:t,fs:n,modules:r,inject:i,defines:o,varyings:s,bufferMode:a,transpileToGLSL100:u}=this.programProps;e=this.programManager.get({vs:t,fs:n,modules:r,inject:i,defines:o,varyings:s,bufferMode:a,transpileToGLSL100:u}),this.program&&this._managedProgram&&this.programManager.release(this.program),this._programManagerState=this.programManager.stateHash,this._managedProgram=!0}zi(e instanceof Pa,"Model needs a program"),this._programDirty=!1,e!==this.program&&(this.program=e,this.vertexArray?this.vertexArray.setProps({program:this.program,attributes:this.vertexArray.attributes}):this.vertexArray=new Ch(this.gl,{program:this.program}),this.setUniforms(Object.assign({},this.getModuleUniforms())))}_deleteGeometryBuffers(){for(const t in this.geometryBuffers){const e=this.geometryBuffers[t][0]||this.geometryBuffers[t];e instanceof co&&e.delete()}}_setAnimationProps(t){this.animated&&zi(t,"Model.draw(): animated uniforms but no animationProps")}_setFeedbackBuffers(t={}){if(Gi(t))return this;const{gl:e}=this.program;return this.transformFeedback=this.transformFeedback||new kh(e,{program:this.program}),this.transformFeedback.setBuffers(t),this}_logDrawCallStart(t){const e=t>3?0:qh;if(!(Date.now()-this.lastLogTime<e))return this.lastLogTime=Date.now(),ui.group(Vh,`>>> DRAWING MODEL ${this.id}`,{collapsed:ui.level<=2})(),t}_logDrawCallEnd(t,e,n,r){if(void 0===t)return;const i=Th({vertexArray:e,header:`${this.id} attributes`,attributes:this._attributes}),{table:o,unusedTable:s,unusedCount:a}=Nh({header:`${this.id} uniforms`,program:this.program,uniforms:Object.assign({},this.program.uniforms,n)}),{table:u,count:c}=Nh({header:`${this.id} uniforms`,program:this.program,uniforms:Object.assign({},this.program.uniforms,n),undefinedOnly:!0});c>0&&ui.log("MISSING UNIFORMS",Object.keys(u))(),a>0&&ui.log("UNUSED UNIFORMS",Object.keys(s))();const l=Fh(this.vertexArray.configuration);ui.table(t,i)(),ui.table(t,o)(),ui.table(t+1,l)(),r&&r.log({logLevel:Vh,message:`Rendered to ${r.id}`}),ui.groupEnd(Vh,`>>> DRAWING MODEL ${this.id}`)()}}const Yh={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6};class Zh{static get DRAW_MODE(){return Yh}constructor(t={}){const{id:e=qi("geometry"),drawMode:n=Yh.TRIANGLES,attributes:r={},indices:i=null,vertexCount:o=null}=t;this.id=e,this.drawMode=0|n,this.attributes={},this.userData={},this._setAttributes(r,i),this.vertexCount=o||this._calculateVertexCount(this.attributes,this.indices)}get mode(){return this.drawMode}getVertexCount(){return this.vertexCount}getAttributes(){return this.indices?{indices:this.indices,...this.attributes}:this.attributes}_print(t){return`Geometry ${this.id} attribute ${t}`}_setAttributes(t,e){e&&(this.indices=ArrayBuffer.isView(e)?{value:e,size:1}:e);for(const n in t){let e=t[n];e=ArrayBuffer.isView(e)?{value:e}:e,zi(ArrayBuffer.isView(e.value),`${this._print(n)}: must be typed array or object with value as typed array`),"POSITION"!==n&&"positions"!==n||e.size||(e.size=3),"indices"===n?(zi(!this.indices),this.indices=e):this.attributes[n]=e}return this.indices&&void 0!==this.indices.isIndexed&&(this.indices=Object.assign({},this.indices),delete this.indices.isIndexed),this}_calculateVertexCount(t,e){if(e)return e.value.length;let n=1/0;for(const r in t){const e=t[r],{value:i,size:o,constant:s}=e;!s&&i&&o>=1&&(n=Math.min(n,i.length/o))}return zi(Number.isFinite(n)),n}}const Kh="attribute vec2 aClipSpacePosition;\nattribute vec2 aTexCoord;\nattribute vec2 aCoordinate;\n\nvarying vec2 position;\nvarying vec2 coordinate;\nvarying vec2 uv;\n\nvoid main(void) {\n  gl_Position = vec4(aClipSpacePosition, 0., 1.);\n  position = aClipSpacePosition;\n  coordinate = aCoordinate;\n  uv = aTexCoord;\n}\n",Jh=[-1,-1,1,-1,-1,1,1,1];class Qh extends Xh{constructor(t,e){const n=Jh.map(t=>-1===t?0:t);super(t,Object.assign({},e,{vs:Kh,geometry:new Zh({drawMode:5,vertexCount:4,attributes:{aClipSpacePosition:{size:2,value:new Float32Array(Jh)},aTexCoord:{size:2,value:new Float32Array(n)},aCoordinate:{size:2,value:new Float32Array(n)}}})})),this.setVertexCount(4)}}class tf extends Va{constructor(t,e={}){super(t,e);const{module:n,fs:r,id:i}=e;this.model=new Qh(t,{id:i,fs:r,modules:[n]})}render(t){const e=this.gl;Object(li["c"])(e,{viewport:[0,0,e.drawingBufferWidth,e.drawingBufferHeight]}),Object(li["d"])(e,{framebuffer:t.outputBuffer,clearColor:[0,0,0,0]},()=>this._renderPass(e,t))}delete(){this.model.delete(),this.model=null}_renderPass(t,{inputBuffer:e,outputBuffer:n}){No(t,{color:!0}),this.model.draw({moduleSettings:this.props.moduleSettings,uniforms:{texture:e,texSize:[e.width,e.height]},parameters:{depthWrite:!1,depthTest:!1}})}}class ef extends $a{constructor(t,e={}){super(e),this.id="".concat(t.name,"-pass"),In(t),this.module=t}postRender(t,e){this.passes||(this.passes=nf(t,this.module,this.id,this.props));const{target:n}=e;let r=e.inputBuffer,i=e.swapBuffer;for(let o=0;o<this.passes.length;o++){n&&o===this.passes.length-1&&(i=n),this.passes[o].render({inputBuffer:r,outputBuffer:i});const t=i;i=r,r=t}return r}cleanup(){if(this.passes){for(const t of this.passes)t.delete();this.passes=null}}}function nf(t,e,n,r){if(e.filter||e.sampler){const i=sf(e),o=new tf(t,{id:n,module:e,fs:i,moduleSettings:r});return[o]}const i=e.passes||[];return i.map((i,o)=>{const s=sf(e,i),a="".concat(n,"-").concat(o);return new tf(t,{id:a,module:e,fs:s,moduleSettings:r})})}const rf=t=>"uniform sampler2D texture;\nuniform vec2 texSize;\n\nvarying vec2 position;\nvarying vec2 coordinate;\nvarying vec2 uv;\n\nvoid main() {\n  vec2 texCoord = coordinate;\n\n  gl_FragColor = texture2D(texture, texCoord);\n  gl_FragColor = ".concat(t,"(gl_FragColor, texSize, texCoord);\n}\n"),of=t=>"uniform sampler2D texture;\nuniform vec2 texSize;\n\nvarying vec2 position;\nvarying vec2 coordinate;\nvarying vec2 uv;\n\nvoid main() {\n  vec2 texCoord = coordinate;\n\n  gl_FragColor = ".concat(t,"(texture, texSize, texCoord);\n}\n");function sf(t,e=t){if(e.filter){const n="string"===typeof e.filter?e.filter:"".concat(t.name,"_filterColor");return rf(n)}if(e.sampler){const n="string"===typeof e.sampler?e.sampler:"".concat(t.name,"_sampleColor");return of(n)}return null}let af=1,uf=1;class cf{constructor(){this.time=0,this.channels=new Map,this.animations=new Map,this.playing=!1,this.lastEngineTime=-1}addChannel(t){const{delay:e=0,duration:n=Number.POSITIVE_INFINITY,rate:r=1,repeat:i=1}=t,o=af++,s={time:0,delay:e,duration:n,rate:r,repeat:i};return this._setChannelTime(s,this.time),this.channels.set(o,s),o}removeChannel(t){this.channels.delete(t);for(const[e,n]of this.animations)n.channel===t&&this.detachAnimation(e)}isFinished(t){const e=this.channels.get(t);return void 0!==e&&this.time>=e.delay+e.duration*e.repeat}getTime(t){if(void 0===t)return this.time;const e=this.channels.get(t);return void 0===e?-1:e.time}setTime(t){this.time=Math.max(0,t);const e=this.channels.values();for(const r of e)this._setChannelTime(r,this.time);const n=this.animations.values();for(const r of n){const{animation:t,channel:e}=r;t.setTime(this.getTime(e))}}play(){this.playing=!0}pause(){this.playing=!1,this.lastEngineTime=-1}reset(){this.setTime(0)}attachAnimation(t,e){const n=uf++;return this.animations.set(n,{animation:t,channel:e}),t.setTime(this.getTime(e)),n}detachAnimation(t){this.animations.delete(t)}update(t){this.playing&&(-1===this.lastEngineTime&&(this.lastEngineTime=t),this.setTime(this.time+(t-this.lastEngineTime)),this.lastEngineTime=t)}_setChannelTime(t,e){const n=e-t.delay,r=t.duration*t.repeat;n>=r?t.time=t.duration*t.rate:(t.time=Math.max(0,n)%t.duration,t.time*=t.rate)}}const lf={NO_STATE:"Awaiting state",MATCHED:"Matched. State transferred from previous layer",INITIALIZED:"Initialized",AWAITING_GC:"Discarded. Awaiting garbage collection",AWAITING_FINALIZATION:"No longer matched. Awaiting garbage collection",FINALIZED:"Finalized! Awaiting garbage collection"},hf={COMPONENT:Symbol.for("component"),ASYNC_DEFAULTS:Symbol.for("asyncPropDefaults"),ASYNC_ORIGINAL:Symbol.for("asyncPropOriginal"),ASYNC_RESOLVED:Symbol.for("asyncPropResolved")};let ff={};function df(t){ff=t}function pf(t){vn.level>0&&ff[t]&&ff[t].call(...arguments)}function gf(t,e=(()=>!0)){return Array.isArray(t)?mf(t,e,[]):e(t)?[t]:[]}function mf(t,e,n){let r=-1;while(++r<t.length){const i=t[r];Array.isArray(i)?mf(i,e,n):e(i)&&n.push(i)}return n}function yf({target:t,source:e,start:n=0,count:r=1}){const i=e.length,o=r*i;let s=0;for(let a=n;s<i;s++)t[a++]=e[s];while(s<o)s<o-s?(t.copyWithin(n+s,n,n+s),s*=2):(t.copyWithin(n+s,n,n+o-s),s=o);return t}const vf=t=>"boolean"===typeof t,bf=t=>"function"===typeof t,_f=t=>null!==t&&"object"===typeof t,wf=t=>_f(t)&&t.constructor==={}.constructor,xf=t=>t&&"function"===typeof t[Symbol.iterator],Sf=t=>t&&"function"===typeof t[Symbol.asyncIterator],Ef=t=>"undefined"!==typeof Response&&t instanceof Response||t&&t.arrayBuffer&&t.text&&t.json,Af=t=>"undefined"!==typeof Blob&&t instanceof Blob,Mf=t=>"undefined"!==typeof ReadableStream&&t instanceof ReadableStream||_f(t)&&bf(t.tee)&&bf(t.cancel)&&bf(t.getReader),Cf=t=>t&&"object"===typeof t&&t.isBuffer,kf=t=>_f(t)&&bf(t.read)&&bf(t.pipe)&&vf(t.readable),Of=t=>Mf(t)||kf(t);function Pf(t,e){if(!t)throw new Error(e||"loader assertion failed.")}function Tf(t){var e;if(!t)return!1;Array.isArray(t)&&(t=t[0]);const n=Array.isArray(null===(e=t)||void 0===e?void 0:e.extensions);return n}function Lf(t){var e,n;let r;return Pf(t,"null loader"),Pf(Tf(t),"invalid loader"),Array.isArray(t)&&(r=t[1],t=t[0],t={...t,options:{...t.options,...r}}),(null!==(e=t)&&void 0!==e&&e.parseTextSync||null!==(n=t)&&void 0!==n&&n.parseText)&&(t.text=!0),t.text||(t.binary=!0),t}var If=n("22dc");let Nf="";const Df={};function Rf(t){for(const e in Df)if(t.startsWith(e)){const n=Df[e];t=t.replace(e,n)}return t.startsWith("http://")||t.startsWith("https://")||(t=`${Nf}${t}`),t}const Ff=/^data:([-\w.]+\/[-\w.+]+)(;|,)/,Bf=/^([-\w.]+\/[-\w.+]+)/;function jf(t){const e=Bf.exec(t);return e?e[1]:t}function zf(t){const e=Ff.exec(t);return e?e[1]:""}const Uf=/\?.*/;function $f(t){if(Ef(t)){const e=qf(t.url||""),n=t.headers.get("content-type")||"";return{url:e,type:jf(n)||zf(e)}}return Af(t)?{url:qf(t.name||""),type:t.type||""}:"string"===typeof t?{url:qf(t),type:zf(t)}:{url:"",type:""}}function Vf(t){return Ef(t)?t.headers["content-length"]||-1:Af(t)?t.size:"string"===typeof t?t.length:t instanceof ArrayBuffer?t.byteLength:ArrayBuffer.isView(t)?t.byteLength:-1}function qf(t){return t.replace(Uf,"")}async function Wf(t){if(Ef(t))return t;const e={},n=Vf(t);n>=0&&(e["content-length"]=String(n));const{url:r,type:i}=$f(t);i&&(e["content-type"]=i);const o=await Xf(t);o&&(e["x-first-bytes"]=o),"string"===typeof t&&(t=(new TextEncoder).encode(t));const s=new Response(t,{headers:e});return Object.defineProperty(s,"url",{value:r}),s}async function Gf(t){if(!t.ok){const e=await Hf(t);throw new Error(e)}}async function Hf(t){let e=`Failed to fetch resource ${t.url} (${t.status}): `;try{const n=t.headers.get("Content-Type");let r=t.statusText;n.includes("application/json")&&(r+=` ${await t.text()}`),e+=r,e=e.length>60?`${e.slice(60)}...`:e}catch(n){}return e}async function Xf(t){const e=5;if("string"===typeof t)return`data:,${t.slice(0,e)}`;if(t instanceof Blob){const e=t.slice(0,5);return await new Promise(t=>{const n=new FileReader;n.onload=e=>{var n;return t(null===e||void 0===e?void 0:null===(n=e.target)||void 0===n?void 0:n.result)},n.readAsDataURL(e)})}if(t instanceof ArrayBuffer){const n=t.slice(0,e),r=Yf(n);return`data:base64,${r}`}return null}function Yf(t){let e="";const n=new Uint8Array(t);for(let r=0;r<n.byteLength;r++)e+=String.fromCharCode(n[r]);return btoa(e)}async function Zf(t,e){if("string"===typeof t){t=Rf(t);let n=e;return null!==e&&void 0!==e&&e.fetch&&"function"!==typeof(null===e||void 0===e?void 0:e.fetch)&&(n=e.fetch),await fetch(t,n)}return await Wf(t)}function Kf(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var Jf=n("48e9");const Qf="undefined"!==typeof __VERSION__?__VERSION__:"untranspiled source",td=Object(Jf["a"])();function ed(t){try{const e=window[t],n="__storage_test__";return e.setItem(n,n),e.removeItem(n),e}catch(e){return null}}class nd{constructor(t,e,n="sessionStorage"){this.storage=ed(n),this.id=t,this.config={},Object.assign(this.config,e),this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(t){return this.config={},this.updateConfiguration(t)}updateConfiguration(t){if(Object.assign(this.config,t),this.storage){const t=JSON.stringify(this.config);this.storage.setItem(this.id,t)}return this}_loadConfiguration(){let t={};if(this.storage){const e=this.storage.getItem(this.id);t=e?JSON.parse(e):{}}return Object.assign(this.config,t),this}}function rd(t){let e;return e=t<10?"".concat(t.toFixed(2),"ms"):t<100?"".concat(t.toFixed(1),"ms"):t<1e3?"".concat(t.toFixed(0),"ms"):"".concat((t/1e3).toFixed(2),"s"),e}function id(t,e=8){const n=Math.max(e-t.length,0);return"".concat(" ".repeat(n)).concat(t)}function od(t,e,n,r=600){const i=t.src.replace(/\(/g,"%28").replace(/\)/g,"%29");t.width>r&&(n=Math.min(n,r/t.width));const o=t.width*n,s=t.height*n,a=["font-size:1px;","padding:".concat(Math.floor(s/2),"px ").concat(Math.floor(o/2),"px;"),"line-height:".concat(s,"px;"),"background:url(".concat(i,");"),"background-size:".concat(o,"px ").concat(s,"px;"),"color:transparent;"].join("");return["".concat(e," %c+"),a]}const sd={BLACK:30,RED:31,GREEN:32,YELLOW:33,BLUE:34,MAGENTA:35,CYAN:36,WHITE:37,BRIGHT_BLACK:90,BRIGHT_RED:91,BRIGHT_GREEN:92,BRIGHT_YELLOW:93,BRIGHT_BLUE:94,BRIGHT_MAGENTA:95,BRIGHT_CYAN:96,BRIGHT_WHITE:97};function ad(t){return"string"===typeof t?sd[t.toUpperCase()]||sd.WHITE:t}function ud(t,e,n){return td||"string"!==typeof t||(e&&(e=ad(e),t="[".concat(e,"m").concat(t,"[39m")),n&&(e=ad(n),t="[".concat(n+10,"m").concat(t,"[49m"))),t}function cd(t,e=["constructor"]){const n=Object.getPrototypeOf(t),r=Object.getOwnPropertyNames(n);for(const i of r)"function"===typeof t[i]&&(e.find(t=>i===t)||(t[i]=t[i].bind(t)))}function ld(t,e){if(!t)throw new Error(e||"Assertion failed")}var hd=n("a16a");function fd(){let t;if(td&&hd["b"].performance)t=hd["b"].performance.now();else if(hd["a"].hrtime){const e=hd["a"].hrtime();t=1e3*e[0]+e[1]/1e6}else t=Date.now();return t}const dd={debug:td&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},pd={enabled:!0,level:0};function gd(){}const md={},yd={once:!0};function vd(t){for(const e in t)for(const n in t[e])return n||"untitled";return"empty"}class bd{constructor({id:t}={id:""}){this.id=t,this.VERSION=Qf,this._startTs=fd(),this._deltaTs=fd(),this.LOG_THROTTLE_TIMEOUT=0,this._storage=new nd("__probe-".concat(this.id,"__"),pd),this.userData={},this.timeStamp("".concat(this.id," started")),cd(this),Object.seal(this)}set level(t){this.setLevel(t)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((fd()-this._startTs).toPrecision(10))}getDelta(){return Number((fd()-this._deltaTs).toPrecision(10))}set priority(t){this.level=t}get priority(){return this.level}getPriority(){return this.level}enable(t=!0){return this._storage.updateConfiguration({enabled:t}),this}setLevel(t){return this._storage.updateConfiguration({level:t}),this}assert(t,e){ld(t,e)}warn(t){return this._getLogFunction(0,t,dd.warn,arguments,yd)}error(t){return this._getLogFunction(0,t,dd.error,arguments)}deprecated(t,e){return this.warn("`".concat(t,"` is deprecated and will be removed in a later version. Use `").concat(e,"` instead"))}removed(t,e){return this.error("`".concat(t,"` has been removed. Use `").concat(e,"` instead"))}probe(t,e){return this._getLogFunction(t,e,dd.log,arguments,{time:!0,once:!0})}log(t,e){return this._getLogFunction(t,e,dd.debug,arguments)}info(t,e){return this._getLogFunction(t,e,console.info,arguments)}once(t,e){return this._getLogFunction(t,e,dd.debug||dd.info,arguments,yd)}table(t,e,n){return e?this._getLogFunction(t,e,console.table||gd,n&&[n],{tag:vd(e)}):gd}image({logLevel:t,priority:e,image:n,message:r="",scale:i=1}){return this._shouldLog(t||e)?td?Ed({image:n,message:r,scale:i}):Sd({image:n,message:r,scale:i}):gd}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}get(t){return this._storage.config[t]}set(t,e){this._storage.updateConfiguration({[t]:e})}time(t,e){return this._getLogFunction(t,e,console.time?console.time:console.info)}timeEnd(t,e){return this._getLogFunction(t,e,console.timeEnd?console.timeEnd:console.info)}timeStamp(t,e){return this._getLogFunction(t,e,console.timeStamp||gd)}group(t,e,n={collapsed:!1}){n=wd({logLevel:t,message:e,opts:n});const{collapsed:r}=n;return n.method=(r?console.groupCollapsed:console.group)||console.info,this._getLogFunction(n)}groupCollapsed(t,e,n={}){return this.group(t,e,Object.assign({},n,{collapsed:!0}))}groupEnd(t){return this._getLogFunction(t,"",console.groupEnd||gd)}withGroup(t,e,n){this.group(t,e)();try{n()}finally{this.groupEnd(t)()}}trace(){console.trace&&console.trace()}_shouldLog(t){return this.isEnabled()&&this.getLevel()>=_d(t)}_getLogFunction(t,e,n,r=[],i){if(this._shouldLog(t)){i=wd({logLevel:t,message:e,args:r,opts:i}),n=n||i.method,ld(n),i.total=this.getTotal(),i.delta=this.getDelta(),this._deltaTs=fd();const o=i.tag||i.message;if(i.once){if(md[o])return gd;md[o]=fd()}return e=xd(this.id,i.message,i),n.bind(console,e,...i.args)}return gd}}function _d(t){if(!t)return 0;let e;switch(typeof t){case"number":e=t;break;case"object":e=t.logLevel||t.priority||0;break;default:return 0}return ld(Number.isFinite(e)&&e>=0),e}function wd(t){const{logLevel:e,message:n}=t;t.logLevel=_d(e);const r=t.args?Array.from(t.args):[];while(r.length&&r.shift()!==n);switch(t.args=r,typeof e){case"string":case"function":void 0!==n&&r.unshift(n),t.message=e;break;case"object":Object.assign(t,e);break;default:}"function"===typeof t.message&&(t.message=t.message());const i=typeof t.message;return ld("string"===i||"object"===i),Object.assign(t,t.opts)}function xd(t,e,n){if("string"===typeof e){const r=n.time?id(rd(n.total)):"";e=n.time?"".concat(t,": ").concat(r,"  ").concat(e):"".concat(t,": ").concat(e),e=ud(e,n.color,n.background)}return e}function Sd({image:t,message:e="",scale:r=1}){let i=null;try{i=n(6)}catch(o){}return i?()=>i(t,{fit:"box",width:"".concat(Math.round(80*r),"%")}).then(t=>console.log(t)):gd}function Ed({image:t,message:e="",scale:n=1}){if("string"===typeof t){const r=new Image;return r.onload=()=>{const t=od(r,e,n);console.log(...t)},r.src=t,gd}const r=t.nodeName||"";if("img"===r.toLowerCase())return console.log(...od(t,e,n)),gd;if("canvas"===r.toLowerCase()){const r=new Image;return r.onload=()=>console.log(...od(r,e,n)),r.src=t.toDataURL(),gd}return gd}bd.VERSION=Qf;const Ad=new bd({id:"loaders.gl"});class Md{log(){return()=>{}}info(){return()=>{}}warn(){return()=>{}}error(){return()=>{}}}class Cd{constructor(){Kf(this,"console",void 0),this.console=console}log(...t){return this.console.log.bind(this.console,...t)}info(...t){return this.console.info.bind(this.console,...t)}warn(...t){return this.console.warn.bind(this.console,...t)}error(...t){return this.console.error.bind(this.console,...t)}}const kd={fetch:null,mimeType:void 0,nothrow:!1,log:new Cd,CDN:"https://unpkg.com/@loaders.gl",worker:!0,maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:!0,_workerType:"",limit:0,_limitMB:0,batchSize:"auto",batchDebounceMs:0,metadata:!1,transforms:[]},Od={throws:"nothrow",dataType:"(no longer used)",uri:"baseUri",method:"fetch.method",headers:"fetch.headers",body:"fetch.body",mode:"fetch.mode",credentials:"fetch.credentials",cache:"fetch.cache",redirect:"fetch.redirect",referrer:"fetch.referrer",referrerPolicy:"fetch.referrerPolicy",integrity:"fetch.integrity",keepalive:"fetch.keepalive",signal:"fetch.signal"};function Pd(){If["a"].loaders=If["a"].loaders||{};const{loaders:t}=If["a"];return t._state=t._state||{},t._state}const Td=()=>{const t=Pd();return t.globalOptions=t.globalOptions||{...kd},t.globalOptions};function Ld(t,e,n,r){return n=n||[],n=Array.isArray(n)?n:[n],Nd(t,n),Fd(e,t,r)}function Id(t,e){const n=Td(),r=t||n;return"function"===typeof r.fetch?r.fetch:_f(r.fetch)?t=>Zf(t,r):null!==e&&void 0!==e&&e.fetch?null===e||void 0===e?void 0:e.fetch:Zf}function Nd(t,e){Dd(t,null,kd,Od,e);for(const n of e){const r=t&&t[n.id]||{},i=n.options&&n.options[n.id]||{},o=n.deprecatedOptions&&n.deprecatedOptions[n.id]||{};Dd(r,n.id,i,o,e)}}function Dd(t,e,n,r,i){const o=e||"Top level",s=e?`${e}.`:"";for(const a in t){const u=!e&&_f(t[a]),c="baseUri"===a&&!e,l="workerUrl"===a&&e;if(!(a in n)&&!c&&!l)if(a in r)Ad.warn(`${o} loader option '${s}${a}' no longer supported, use '${r[a]}'`)();else if(!u){const t=Rd(a,i);Ad.warn(`${o} loader option '${s}${a}' not recognized. ${t}`)()}}}function Rd(t,e){const n=t.toLowerCase();let r="";for(const i of e)for(const e in i.options){if(t===e)return`Did you mean '${i.id}.${e}'?`;const o=e.toLowerCase(),s=n.startsWith(o)||o.startsWith(n);s&&(r=r||`Did you mean '${i.id}.${e}'?`)}return r}function Fd(t,e,n){const r=t.options||{},i={...r};return jd(i,n),null===i.log&&(i.log=new Md),Bd(i,Td()),Bd(i,e),i}function Bd(t,e){for(const n in e)if(n in e){const r=e[n];wf(r)&&wf(t[n])?t[n]={...t[n],...e[n]}:t[n]=e[n]}}function jd(t,e){!e||"baseUri"in t||(t.baseUri=e)}function zd(t,e){if(!t)throw new Error(e||"loaders.gl assertion failed.")}const Ud="3.0.12";function $d(t,e=Ud){zd(t,"no worker provided");const n=t.version;return!(!e||!n)}var Vd=n("f5f44");const qd=new Map;function Wd(t){zd(t.source&&!t.url||!t.source&&t.url);let e=qd.get(t.source||t.url);return e||(t.url&&(e=Gd(t.url),qd.set(t.url,e)),t.source&&(e=Hd(t.source),qd.set(t.source,e))),zd(e),e}function Gd(t){if(!t.startsWith("http"))return t;const e=Xd(t);return Hd(e)}function Hd(t){const e=new Blob([t],{type:"application/javascript"});return URL.createObjectURL(e)}function Xd(t){return`try {\n  importScripts('${t}');\n} catch (error) {\n  console.error(error);\n  throw error;\n}`}function Yd(t,e=!0,n){const r=n||new Set;if(t){if(Zd(t))r.add(t);else if(Zd(t.buffer))r.add(t.buffer);else if(ArrayBuffer.isView(t));else if(e&&"object"===typeof t)for(const i in t)Yd(t[i],e,r)}else;return void 0===n?Array.from(r):[]}function Zd(t){return!!t&&(t instanceof ArrayBuffer||("undefined"!==typeof MessagePort&&t instanceof MessagePort||("undefined"!==typeof ImageBitmap&&t instanceof ImageBitmap||"undefined"!==typeof OffscreenCanvas&&t instanceof OffscreenCanvas)))}const Kd=()=>{};class Jd{static isSupported(){return"undefined"!==typeof Worker}constructor(t){Kf(this,"name",void 0),Kf(this,"source",void 0),Kf(this,"url",void 0),Kf(this,"terminated",!1),Kf(this,"worker",void 0),Kf(this,"onMessage",void 0),Kf(this,"onError",void 0),Kf(this,"_loadableURL","");const{name:e,source:n,url:r}=t;zd(n||r),this.name=e,this.source=n,this.url=r,this.onMessage=Kd,this.onError=t=>console.log(t),this.worker=this._createBrowserWorker()}destroy(){this.onMessage=Kd,this.onError=Kd,this.worker.terminate(),this.terminated=!0}get isRunning(){return Boolean(this.onMessage)}postMessage(t,e){e=e||Yd(t),this.worker.postMessage(t,e)}_getErrorFromErrorEvent(t){let e="Failed to load ";return e+=`worker ${this.name}. `,t.message&&(e+=`${t.message} in `),t.lineno&&(e+=`:${t.lineno}:${t.colno}`),new Error(e)}_createBrowserWorker(){this._loadableURL=Wd({source:this.source,url:this.url});const t=new Worker(this._loadableURL,{name:this.name});return t.onmessage=t=>{t.data?this.onMessage(t.data):this.onError(new Error("No data received"))},t.onerror=t=>{this.onError(this._getErrorFromErrorEvent(t)),this.terminated=!0},t.onmessageerror=t=>console.error(t),t}}class Qd{constructor(t,e){Kf(this,"name",void 0),Kf(this,"workerThread",void 0),Kf(this,"isRunning",void 0),Kf(this,"result",void 0),Kf(this,"_resolve",void 0),Kf(this,"_reject",void 0),this.name=t,this.workerThread=e,this.isRunning=!0,this._resolve=()=>{},this._reject=()=>{},this.result=new Promise((t,e)=>{this._resolve=t,this._reject=e})}postMessage(t,e){this.workerThread.postMessage({source:"loaders.gl",type:t,payload:e})}done(t){zd(this.isRunning),this.isRunning=!1,this._resolve(t)}error(t){zd(this.isRunning),this.isRunning=!1,this._reject(t)}}class tp{constructor(t){Kf(this,"name","unnamed"),Kf(this,"source",void 0),Kf(this,"url",void 0),Kf(this,"maxConcurrency",1),Kf(this,"maxMobileConcurrency",1),Kf(this,"onDebug",()=>{}),Kf(this,"reuseWorkers",!0),Kf(this,"props",{}),Kf(this,"jobQueue",[]),Kf(this,"idleQueue",[]),Kf(this,"count",0),Kf(this,"isDestroyed",!1),this.source=t.source,this.url=t.url,this.setProps(t)}destroy(){this.idleQueue.forEach(t=>t.destroy()),this.isDestroyed=!0}setProps(t){this.props={...this.props,...t},void 0!==t.name&&(this.name=t.name),void 0!==t.maxConcurrency&&(this.maxConcurrency=t.maxConcurrency),void 0!==t.maxMobileConcurrency&&(this.maxMobileConcurrency=t.maxMobileConcurrency),void 0!==t.reuseWorkers&&(this.reuseWorkers=t.reuseWorkers),void 0!==t.onDebug&&(this.onDebug=t.onDebug)}async startJob(t,e=((t,e,n)=>t.done(n)),n=((t,e)=>t.error(e))){const r=new Promise(r=>{return this.jobQueue.push({name:t,onMessage:e,onError:n,onStart:r}),this});return this._startQueuedJob(),await r}async _startQueuedJob(){if(!this.jobQueue.length)return;const t=this._getAvailableWorker();if(!t)return;const e=this.jobQueue.shift();if(e){this.onDebug({message:"Starting job",name:e.name,workerThread:t,backlog:this.jobQueue.length});const n=new Qd(e.name,t);t.onMessage=t=>e.onMessage(n,t.type,t.payload),t.onError=t=>e.onError(n,t),e.onStart(n);try{await n.result}finally{this.returnWorkerToQueue(t)}}}returnWorkerToQueue(t){const e=this.isDestroyed||!this.reuseWorkers||this.count>this._getMaxConcurrency();e?(t.destroy(),this.count--):this.idleQueue.push(t),this.isDestroyed||this._startQueuedJob()}_getAvailableWorker(){if(this.idleQueue.length>0)return this.idleQueue.shift()||null;if(this.count<this._getMaxConcurrency()){this.count++;const t=`${this.name.toLowerCase()} (#${this.count} of ${this.maxConcurrency})`;return new Jd({name:t,source:this.source,url:this.url})}return null}_getMaxConcurrency(){return Vd["a"]?this.maxMobileConcurrency:this.maxConcurrency}}const ep={maxConcurrency:3,maxMobileConcurrency:1,onDebug:()=>{},reuseWorkers:!0};class np{static isSupported(){return Jd.isSupported()}static getWorkerFarm(t={}){return np._workerFarm=np._workerFarm||new np({}),np._workerFarm.setProps(t),np._workerFarm}constructor(t){Kf(this,"props",void 0),Kf(this,"workerPools",new Map),this.props={...ep},this.setProps(t),this.workerPools=new Map}destroy(){for(const t of this.workerPools.values())t.destroy()}setProps(t){this.props={...this.props,...t};for(const e of this.workerPools.values())e.setProps(this._getWorkerPoolProps())}getWorkerPool(t){const{name:e,source:n,url:r}=t;let i=this.workerPools.get(e);return i||(i=new tp({name:e,source:n,url:r}),i.setProps(this._getWorkerPoolProps()),this.workerPools.set(e,i)),i}_getWorkerPoolProps(){return{maxConcurrency:this.props.maxConcurrency,maxMobileConcurrency:this.props.maxMobileConcurrency,reuseWorkers:this.props.reuseWorkers,onDebug:this.props.onDebug}}}Kf(np,"_workerFarm",void 0);const rp="latest";function ip(t,e={}){const n=e[t.id]||{},r=`${t.id}-worker.js`;let i=n.workerUrl;if("test"===e._workerType&&(i=`modules/${t.module}/dist/${r}`),!i){let e=t.version;"latest"===e&&(e=rp);const n=e?`@${e}`:"";i=`https://unpkg.com/@loaders.gl/${t.module}${n}/dist/${r}`}return zd(i),i}function op(t,e){return!!np.isSupported()&&(t.worker&&(null===e||void 0===e?void 0:e.worker))}async function sp(t,e,n,r,i){const o=t.id,s=ip(t,n),a=np.getWorkerFarm(n),u=a.getWorkerPool({name:o,url:s});n=JSON.parse(JSON.stringify(n));const c=await u.startJob("process-on-worker",ap.bind(null,i));c.postMessage("process",{input:e,options:n});const l=await c.result;return await l.result}async function ap(t,e,n,r){switch(n){case"done":e.done(r);break;case"error":e.error(r.error);break;case"process":const{id:o,input:s,options:a}=r;try{const n=await t(s,a);e.postMessage("done",{id:o,result:n})}catch(i){const t=i instanceof Error?i.message:"unknown error";e.postMessage("error",{id:o,error:t})}break;default:console.warn(`parse-with-worker unknown message ${n}`)}}var up=n(7);function cp(t){return t&&"object"===typeof t&&t.isBuffer}function lp(t){return up["toArrayBuffer"]?up["toArrayBuffer"](t):t}function hp(t){if(cp(t)&&(t=lp(t)),t instanceof ArrayBuffer)return t;if(ArrayBuffer.isView(t))return 0===t.byteOffset&&t.byteLength===t.buffer.byteLength?t.buffer:t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength);if("string"===typeof t){const e=t,n=(new TextEncoder).encode(e);return n.buffer}if(t&&"object"===typeof t&&t._toArrayBuffer)return t._toArrayBuffer();throw new Error("toArrayBuffer")}function fp(t,e,n){if(n=n||t.byteLength,t.byteLength<n||e.byteLength<n)return!1;const r=new Uint8Array(t),i=new Uint8Array(e);for(let o=0;o<r.length;++o)if(r[o]!==i[o])return!1;return!0}function dp(...t){const e=t.map(t=>t instanceof ArrayBuffer?new Uint8Array(t):t),n=e.reduce((t,e)=>t+e.byteLength,0),r=new Uint8Array(n);let i=0;for(const o of e)r.set(o,i),i+=o.byteLength;return r.buffer}async function pp(t){const e=[];for await(const n of t)e.push(n);return dp(...e)}const gp=262144;function*mp(t,e){const n=(null===e||void 0===e?void 0:e.chunkSize)||gp;let r=0;const i=new TextEncoder;while(r<t.length){const e=Math.min(t.length-r,n),o=t.slice(r,r+e);r+=e,yield i.encode(o)}}const yp=262144;function*vp(t,e={}){const{chunkSize:n=yp}=e;let r=0;while(r<t.byteLength){const e=Math.min(t.byteLength-r,n),i=new ArrayBuffer(e),o=new Uint8Array(t,r,e),s=new Uint8Array(i);s.set(o),r+=e,yield i}}const bp=1048576;async function*_p(t,e){const n=(null===e||void 0===e?void 0:e.chunkSize)||bp;let r=0;while(r<t.size){const e=r+n,i=await t.slice(r,e).arrayBuffer();r=e,yield i}}function wp(t,e){return If["b"]?xp(t,e):Sp(t,e)}async function*xp(t,e){const n=t.getReader();let r;try{while(1){const t=r||n.read();null!==e&&void 0!==e&&e._streamReadAhead&&(r=n.read());const{done:i,value:o}=await t;if(i)return;yield hp(o)}}catch(i){n.releaseLock()}}async function*Sp(t,e){for await(const n of t)yield hp(n)}function Ep(t,e){if("string"===typeof t)return mp(t,e);if(t instanceof ArrayBuffer)return vp(t,e);if(Af(t))return _p(t,e);if(Of(t))return wp(t,e);if(Ef(t)){const n=t;return wp(n.body,e)}throw new Error("makeIterator")}const Ap="Cannot convert supplied data type";function Mp(t,e,n){if(e.text&&"string"===typeof t)return t;if(Cf(t)&&(t=t.buffer),t instanceof ArrayBuffer){const n=t;if(e.text&&!e.binary){const t=new TextDecoder("utf8");return t.decode(n)}return n}if(ArrayBuffer.isView(t)){if(e.text&&!e.binary){const e=new TextDecoder("utf8");return e.decode(t)}let n=t.buffer;const r=t.byteLength||t.length;return 0===t.byteOffset&&r===n.byteLength||(n=n.slice(t.byteOffset,t.byteOffset+r)),n}throw new Error(Ap)}async function Cp(t,e,n){const r=t instanceof ArrayBuffer||ArrayBuffer.isView(t);if("string"===typeof t||r)return Mp(t,e,n);if(Af(t)&&(t=await Wf(t)),Ef(t)){const n=t;return await Gf(n),e.binary?await n.arrayBuffer():await n.text()}if(Of(t)&&(t=Ep(t,n)),xf(t)||Sf(t))return pp(t);throw new Error(Ap)}function kp(t,e,n=null){if(n)return n;const r={fetch:Id(e,t),...t};return Array.isArray(r.loaders)||(r.loaders=null),r}function Op(t,e){if(!e&&t&&!Array.isArray(t))return t;let n;if(t&&(n=Array.isArray(t)?t:[t]),e&&e.loaders){const t=Array.isArray(e.loaders)?e.loaders:[e.loaders];n=n?[...n,...t]:t}return n&&n.length?n:null}const Pp=()=>{const t=Pd();return t.loaderRegistry=t.loaderRegistry||[],t.loaderRegistry};function Tp(t){const e=Pp();t=Array.isArray(t)?t:[t];for(const n of t){const t=Lf(n);e.find(e=>t===e)||e.unshift(t)}}function Lp(){return Pp()}const Ip=/\.([^.]+)$/;async function Np(t,e=[],n,r){if(!Fp(t))return null;let i=Dp(t,e,{...n,nothrow:!0},r);if(i)return i;if(Af(t)&&(t=await t.slice(0,10).arrayBuffer(),i=Dp(t,e,n,r)),!i&&(null===n||void 0===n||!n.nothrow))throw new Error(Bp(t));return i}function Dp(t,e=[],n,r){if(!Fp(t))return null;if(e&&!Array.isArray(e))return Lf(e);let i=[];e&&(i=i.concat(e)),null!==n&&void 0!==n&&n.ignoreRegisteredLoaders||i.push(...Lp()),jp(i);const o=Rp(t,i,n,r);if(!o&&(null===n||void 0===n||!n.nothrow))throw new Error(Bp(t));return o}function Rp(t,e,n,r){const{url:i,type:o}=$f(t),s=i||(null===r||void 0===r?void 0:r.url);let a=null;return null!==n&&void 0!==n&&n.mimeType&&(a=$p(e,null===n||void 0===n?void 0:n.mimeType)),a=a||zp(e,s),a=a||$p(e,o),a=a||Vp(e,t),a=a||$p(e,null===n||void 0===n?void 0:n.fallbackMimeType),a}function Fp(t){return!(t instanceof Response&&204===t.status)}function Bp(t){const{url:e,type:n}=$f(t);let r="No valid loader found";return t&&(r+=` data: "${Hp(t)}", contentType: "${n}"`),e&&(r+=` url: ${e}`),r}function jp(t){for(const e of t)Lf(e)}function zp(t,e){const n=e&&Ip.exec(e),r=n&&n[1];return r?Up(t,r):null}function Up(t,e){e=e.toLowerCase();for(const n of t)for(const t of n.extensions)if(t.toLowerCase()===e)return n;return null}function $p(t,e){for(const n of t){if(n.mimeTypes&&n.mimeTypes.includes(e))return n;if(e===`application/x.${n.id}`)return n}return null}function Vp(t,e){if(!e)return null;for(const n of t)if("string"===typeof e){if(qp(e,n))return n}else if(ArrayBuffer.isView(e)){if(Wp(e.buffer,e.byteOffset,n))return n}else if(e instanceof ArrayBuffer){const t=0;if(Wp(e,t,n))return n}return null}function qp(t,e){if(e.testText)return e.testText(t);const n=Array.isArray(e.tests)?e.tests:[e.tests];return n.some(e=>t.startsWith(e))}function Wp(t,e,n){const r=Array.isArray(n.tests)?n.tests:[n.tests];return r.some(r=>Gp(t,e,n,r))}function Gp(t,e,n,r){if(r instanceof ArrayBuffer)return fp(r,t,r.byteLength);switch(typeof r){case"function":return r(t,n);case"string":const i=Xp(t,e,r.length);return r===i;default:return!1}}function Hp(t,e=5){if("string"===typeof t)return t.slice(0,e);if(ArrayBuffer.isView(t))return Xp(t.buffer,t.byteOffset,e);if(t instanceof ArrayBuffer){const n=0;return Xp(t,n,e)}return""}function Xp(t,e,n){if(t.byteLength<e+n)return"";const r=new DataView(t);let i="";for(let o=0;o<n;o++)i+=String.fromCharCode(r.getUint8(e+o));return i}async function Yp(t,e,n,r){zd(!r||"object"===typeof r),!e||Array.isArray(e)||Tf(e)||(r=void 0,n=e,e=void 0),t=await t,n=n||{};const{url:i}=$f(t),o=e,s=Op(o,r),a=await Np(t,s,n);return a?(n=Ld(n,a,s,i),r=kp({url:i,parse:Yp,loaders:s},n,r),await Zp(a,t,n,r)):null}async function Zp(t,e,n,r){if($d(t),e=await Cp(e,t,n),t.parseTextSync&&"string"===typeof e)return n.dataType="text",t.parseTextSync(e,n,r,t);if(op(t,n))return await sp(t,e,n,r,Yp);if(t.parseText&&"string"===typeof e)return await t.parseText(e,n,r,t);if(t.parse)return await t.parse(e,n,r,t);throw zd(!t.parseSync),new Error(`${t.id} loader - no parser found and worker is disabled`)}async function Kp(t,e,n,r){Array.isArray(e)||Tf(e)||(void 0,n=e,e=void 0);const i=Id(n);let o=t;return"string"===typeof t&&(o=await i(t)),Af(t)&&(o=await i(t)),await Yp(o,e,n)}class Jp{constructor(t,e,n){this.id=t,this.context=n,this._loadCount=0,this._subscribers=new Set,this.setData(e)}subscribe(t){this._subscribers.add(t)}unsubscribe(t){this._subscribers.delete(t)}inUse(){return this._subscribers.size>0}delete(){}getData(){return this.isLoaded?this._error?Promise.reject(this._error):this._content:this._loader.then(()=>this.getData())}setData(t,e){if(t===this._data&&!e)return;this._data=t;const n=++this._loadCount;let r=t;"string"===typeof t&&(r=Kp(t)),r instanceof Promise?(this.isLoaded=!1,this._loader=r.then(t=>{this._loadCount===n&&(this.isLoaded=!0,this._error=null,this._content=t)}).catch(t=>{this._loadCount===n&&(this.isLoaded=!0,this._error=t||!0)})):(this.isLoaded=!0,this._error=null,this._content=t);for(const i of this._subscribers)i.onChange(this.getData())}}class Qp{constructor({gl:t,protocol:e}){this.protocol=e||"resource://",this._context={gl:t,resourceManager:this},this._resources={},this._consumers={},this._pruneRequest=null}contains(t){return!!t.startsWith(this.protocol)||t in this._resources}add({resourceId:t,data:e,forceUpdate:n=!1,persistent:r=!0}){let i=this._resources[t];i?i.setData(e,n):(i=new Jp(t,e,this._context),this._resources[t]=i),i.persistent=r}remove(t){const e=this._resources[t];e&&(e.delete(),delete this._resources[t])}unsubscribe({consumerId:t}){const e=this._consumers[t];if(e){for(const t in e){const n=e[t];n.resource&&n.resource.unsubscribe(n)}delete this._consumers[t],this.prune()}}subscribe({resourceId:t,onChange:e,consumerId:n,requestId:r="default"}){const{_resources:i,protocol:o}=this;t.startsWith(o)&&(t=t.replace(o,""),i[t]||this.add({resourceId:t,data:null,persistent:!1}));const s=i[t];if(this._track(n,r,s,e),s)return s.getData()}prune(){this._pruneRequest||(this._pruneRequest=setTimeout(()=>this._prune(),0))}finalize(){for(const t in this._resources)this._resources[t].delete()}_track(t,e,n,r){const i=this._consumers,o=i[t]=i[t]||{},s=o[e]||{};s.resource&&(s.resource.unsubscribe(s),s.resource=null,this.prune()),n&&(o[e]=s,s.onChange=r,s.resource=n,n.subscribe(s))}_prune(){this._pruneRequest=null;for(const t of Object.keys(this._resources)){const e=this._resources[t];e.persistent||e.inUse()||(e.delete(),delete this._resources[t])}}}const tg=[Mu],eg=["vs:DECKGL_FILTER_SIZE(inout vec3 size, VertexGeometry geometry)","vs:DECKGL_FILTER_GL_POSITION(inout vec4 position, VertexGeometry geometry)","vs:DECKGL_FILTER_COLOR(inout vec4 color, VertexGeometry geometry)","fs:DECKGL_FILTER_COLOR(inout vec4 color, FragmentGeometry geometry)"];function ng(t){const e=Ta.getDefaultProgramManager(t);for(const n of tg)e.addDefaultModule(n);for(const n of eg)e.addShaderHook(n);return e}const rg="layerManager.setLayers",ig="layerManager.activateViewport",og=Object.seal({layerManager:null,resourceManager:null,deck:null,gl:null,stats:null,shaderCache:null,pickingFBO:null,mousePosition:null,userData:{}});class sg{constructor(t,{deck:e,stats:n,viewport:r,timeline:i}={}){this.lastRenderedLayers=[],this.layers=[],this.resourceManager=new Qp({gl:t,protocol:"deck://"}),this.context={...og,layerManager:this,gl:t,deck:e,programManager:t&&ng(t),stats:n||new Ni({id:"deck.gl"}),viewport:r||new yl({id:"DEFAULT-INITIAL-VIEWPORT"}),timeline:i||new cf,resourceManager:this.resourceManager},this._nextLayers=null,this._needsRedraw="Initial render",this._needsUpdate=!1,this._debug=!1,this.activateViewport=this.activateViewport.bind(this),Object.seal(this)}finalize(){this.resourceManager.finalize();for(const t of this.layers)this._finalizeLayer(t)}needsRedraw(t={clearRedrawFlags:!1}){let e=this._needsRedraw;t.clearRedrawFlags&&(this._needsRedraw=!1);for(const n of this.layers){const r=n.getNeedsRedraw(t);e=e||r}return e}needsUpdate(){return this._nextLayers&&this._nextLayers!==this.lastRenderedLayers?"layers changed":this._needsUpdate}setNeedsRedraw(t){this._needsRedraw=this._needsRedraw||t}setNeedsUpdate(t){this._needsUpdate=this._needsUpdate||t}getLayers({layerIds:t=null}={}){return t?this.layers.filter(e=>t.find(t=>0===e.id.indexOf(t))):this.layers}setProps(t){"debug"in t&&(this._debug=t.debug),"userData"in t&&(this.context.userData=t.userData),"layers"in t&&(this._nextLayers=t.layers),"onError"in t&&(this.context.onError=t.onError)}setLayers(t,e){pf(rg,this,e,t),this.lastRenderedLayers=t,t=gf(t,Boolean);for(const n of t)n.context=this.context;return this._updateLayers(this.layers,t),this}updateLayers(){const t=this.needsUpdate();t&&(this.setNeedsRedraw("updating layers: ".concat(t)),this.setLayers(this._nextLayers||this.lastRenderedLayers,t)),this._nextLayers=null}activateViewport(t){return pf(ig,this,t),t&&(this.context.viewport=t),this}_handleError(t,e,n){n.raiseError(e,"".concat(t," of ").concat(n))}_updateLayers(t,e){const n={};for(const o of t)n[o.id]?vn.warn("Multiple old layers with same id ".concat(o.id))():n[o.id]=o;const r=[];this._updateSublayersRecursively(e,n,r),this._finalizeOldLayers(n);let i=!1;for(const o of r)if(o.hasUniformTransition()){i=!0;break}this._needsUpdate=i,this.layers=r}_updateSublayersRecursively(t,e,n){for(const i of t){i.context=this.context;const t=e[i.id];null===t&&vn.warn("Multiple new layers with same id ".concat(i.id))(),e[i.id]=null;let o=null;try{this._debug&&t!==i&&i.validateProps(),t?(this._transferLayerState(t,i),this._updateLayer(i)):this._initializeLayer(i),n.push(i),o=i.isComposite&&i.getSubLayers()}catch(r){this._handleError("matching",r,i)}o&&this._updateSublayersRecursively(o,e,n)}}_finalizeOldLayers(t){for(const e in t){const n=t[e];n&&this._finalizeLayer(n)}}_initializeLayer(t){try{t._initialize(),t.lifecycle=lf.INITIALIZED}catch(e){this._handleError("initialization",e,t)}}_transferLayerState(t,e){e._transferState(t),e.lifecycle=lf.MATCHED,e!==t&&(t.lifecycle=lf.AWAITING_GC)}_updateLayer(t){try{t._update()}catch(e){this._handleError("update",e,t)}}_finalizeLayer(t){this._needsRedraw=this._needsRedraw||"finalized ".concat(t),t.lifecycle=lf.AWAITING_FINALIZATION;try{t._finalize(),t.lifecycle=lf.FINALIZED}catch(e){this._handleError("finalization",e,t)}}}function ag(t,e){if(t===e)return!0;if(!t||!e)return!1;for(const n in t){const r=t[n],i=e[n],o=r===i||Array.isArray(r)&&Array.isArray(i)&&ag(r,i);if(!o)return!1}return!0}class ug{constructor(t={}){this.views=[],this.width=100,this.height=100,this.viewState={},this.controllers={},this.timeline=t.timeline,this._viewports=[],this._viewportMap={},this._isUpdating=!1,this._needsRedraw="Initial render",this._needsUpdate=!0,this._eventManager=t.eventManager,this._eventCallbacks={onViewStateChange:t.onViewStateChange,onInteractionStateChange:t.onInteractionStateChange},Object.seal(this),this.setProps(t)}finalize(){for(const t in this.controllers)this.controllers[t]&&this.controllers[t].finalize();this.controllers={}}needsRedraw(t={clearRedrawFlags:!1}){const e=this._needsRedraw;return t.clearRedrawFlags&&(this._needsRedraw=!1),e}setNeedsUpdate(t){this._needsUpdate=this._needsUpdate||t,this._needsRedraw=this._needsRedraw||t}updateViewStates(){for(const t in this.controllers){const e=this.controllers[t];e&&e.updateTransition()}}getViewports(t){return t?this._viewports.filter(e=>e.containsPixel(t)):this._viewports}getViews(){const t={};return this.views.forEach(e=>{t[e.id]=e}),t}getView(t){return"string"===typeof t?this.views.find(e=>e.id===t):t}getViewState(t){const e=this.getView(t),n=e&&this.viewState[e.getViewStateId()]||this.viewState;return e?e.filterViewState(n):n}getViewport(t){return this._viewportMap[t]}unproject(t,e){const n=this.getViewports(),r={x:t[0],y:t[1]};for(let i=n.length-1;i>=0;--i){const o=n[i];if(o.containsPixel(r)){const n=t.slice();return n[0]-=o.x,n[1]-=o.y,o.unproject(n,e)}}return null}setProps(t){"views"in t&&this._setViews(t.views),"viewState"in t&&this._setViewState(t.viewState),("width"in t||"height"in t)&&this._setSize(t.width,t.height),this._isUpdating||this._update()}_update(){this._isUpdating=!0,this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._isUpdating=!1}_setSize(t,e){t===this.width&&e===this.height||(this.width=t,this.height=e,this.setNeedsUpdate("Size changed"))}_setViews(t){t=gf(t,Boolean);const e=this._diffViews(t,this.views);e&&this.setNeedsUpdate("views changed"),this.views=t}_setViewState(t){if(t){const e=!ag(t,this.viewState);e&&this.setNeedsUpdate("viewState changed"),this.viewState=t}else vn.warn("missing `viewState` or `initialViewState`")()}_onViewStateChange(t,e){e.viewId=t,this._eventCallbacks.onViewStateChange&&this._eventCallbacks.onViewStateChange(e)}_createController(t,e){const n=e.type,r=new n({timeline:this.timeline,eventManager:this._eventManager,onViewStateChange:this._onViewStateChange.bind(this,e.id),onStateChange:this._eventCallbacks.onInteractionStateChange,makeViewport:e=>t._getViewport(e,{width:e.width,height:e.height}),...e});return r}_updateController(t,e,n,r){let i=t.controller;return i?(i={...e,...t.props,...i,id:t.id,x:n.x,y:n.y,width:n.width,height:n.height},r?r.setProps(i):r=this._createController(t,i),r):null}_rebuildViewports(){const{width:t,height:e,views:n}=this,r=this.controllers;this._viewports=[],this.controllers={};let i=!1;for(let o=n.length;o--;){const s=n[o],a=this.getViewState(s),u=s.makeViewport({width:t,height:e,viewState:a});let c=r[s.id];s.controller&&!c&&(i=!0),!i&&s.controller||!c||(c.finalize(),c=null),this.controllers[s.id]=this._updateController(s,a,u,c),this._viewports.unshift(u)}for(const o in r)r[o]&&!this.controllers[o]&&r[o].finalize();this._buildViewportMap()}_buildViewportMap(){this._viewportMap={},this._viewports.forEach(t=>{t.id&&(this._viewportMap[t.id]=this._viewportMap[t.id]||t)})}_diffViews(t,e){return t.length!==e.length||t.some((n,r)=>!t[r].equals(e[r]))}}const cg=/([0-9]+\.?[0-9]*)(%|px)/;function lg(t){switch(typeof t){case"number":return{position:t,relative:!1};case"string":const e=t.match(cg);if(e&&e.length>=3){const t="%"===e[2],n=parseFloat(e[1]);return{position:t?n/100:n,relative:t}}default:throw new Error("Could not parse position string ".concat(t))}}function hg(t,e){return t.relative?Math.round(t.position*e):t.position}function fg(t,e){if(!t)throw new Error(e||"deck.gl: assertion failed.")}class dg{constructor(t={}){const{id:e=null,x:n=0,y:r=0,width:i="100%",height:o="100%",viewportInstance:s,type:a=yl}=t;fg(!s||s instanceof yl),this.viewportInstance=s,this.id=e||this.constructor.displayName||"view",this.type=a,this.props={...t,id:this.id},this._parseDimensions({x:n,y:r,width:i,height:o}),this.equals=this.equals.bind(this),Object.seal(this)}equals(t){if(this===t)return!0;if(this.viewportInstance)return t.viewportInstance&&this.viewportInstance.equals(t.viewportInstance);const e=ag(this.props,t.props);return e}makeViewport({width:t,height:e,viewState:n}){if(this.viewportInstance)return this.viewportInstance;n=this.filterViewState(n);const r=this.getDimensions({width:t,height:e});return this._getViewport(n,r)}getViewStateId(){switch(typeof this.props.viewState){case"string":return this.props.viewState;case"object":return this.props.viewState&&this.props.viewState.id;default:return this.id}}filterViewState(t){if(this.props.viewState&&"object"===typeof this.props.viewState){if(!this.props.viewState.id)return this.props.viewState;const e={...t};for(const t in this.props.viewState)"id"!==t&&(e[t]=this.props.viewState[t]);return e}return t}getDimensions({width:t,height:e}){return{x:hg(this._x,t),y:hg(this._y,e),width:hg(this._width,t),height:hg(this._height,e)}}_getControllerProps(t){let e=this.props.controller;return e?!0===e?t:("function"===typeof e&&(e={type:e}),{...t,...e}):null}_getViewport(t,e){const{type:n}=this;return new n({...t,...this.props,...e})}_parseDimensions({x:t,y:e,width:n,height:r}){this._x=lg(t),this._y=lg(e),this._width=lg(n),this._height=lg(r)}}function pg(){}const gg={onStart:pg,onUpdate:pg,onInterrupt:pg,onEnd:pg};class mg{constructor(t){this._inProgress=!1,this._handle=null,this.timeline=t,this.settings={}}get inProgress(){return this._inProgress}start(t){this.cancel(),this.settings={...gg,...t},this._inProgress=!0,this.settings.onStart(this)}end(){this._inProgress&&(this.timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1,this.settings.onEnd(this))}cancel(){this._inProgress&&(this.settings.onInterrupt(this),this.timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1)}update(){if(!this._inProgress)return!1;if(null===this._handle){const{timeline:t,settings:e}=this;this._handle=t.addChannel({delay:t.getTime(),duration:e.duration})}return this.time=this.timeline.getTime(this._handle),this._onUpdate(),this.settings.onUpdate(this),this.timeline.isFinished(this._handle)&&this.end(),!0}_onUpdate(){}}const yg=()=>{},vg={BREAK:1,SNAP_TO_END:2,IGNORE:3},bg={transitionEasing:t=>t,transitionInterruption:vg.BREAK,onTransitionStart:yg,onTransitionInterrupt:yg,onTransitionEnd:yg};class _g{constructor(t,e={}){this.ControllerState=t,this.props={...bg,...e},this.propsInTransition=null,this.transition=new mg(e.timeline),this.onViewStateChange=e.onViewStateChange||yg,this.onStateChange=e.onStateChange||yg,this._onTransitionUpdate=this._onTransitionUpdate.bind(this)}finalize(){this.transition.cancel()}getViewportInTransition(){return this.propsInTransition}processViewStateChange(t){let e=!1;const n=this.props;if(t={...bg,...t},this.props=t,this._shouldIgnoreViewportChange(n,t))return e;if(this._isTransitionEnabled(t)){const{interruption:r,endProps:i}=this.transition.settings,o={...n,...r===vg.SNAP_TO_END?i:this.propsInTransition||n};this._triggerTransition(o,t),e=!0}else this.transition.cancel();return e}updateTransition(){this.transition.update()}_isTransitionEnabled(t){const{transitionDuration:e,transitionInterpolator:n}=t;return(e>0||"auto"===e)&&Boolean(n)}_isUpdateDueToCurrentTransition(t){return!!this.transition.inProgress&&this.transition.settings.interpolator.arePropsEqual(t,this.propsInTransition)}_shouldIgnoreViewportChange(t,e){return this.transition.inProgress?this.transition.settings.interruption===vg.IGNORE||this._isUpdateDueToCurrentTransition(e):!this._isTransitionEnabled(e)||e.transitionInterpolator.arePropsEqual(t,e)}_triggerTransition(t,e){const n=new this.ControllerState(t),r=new this.ControllerState(e).shortestPathFrom(n),{transitionInterpolator:i}=e,o=i.getDuration?i.getDuration(t,e):e.transitionDuration;if(0===o)return;const s=e.transitionInterpolator.initializeProps(t,r);this.propsInTransition={},this.duration=o,this.transition.start({duration:o,easing:e.transitionEasing,interpolator:e.transitionInterpolator,interruption:e.transitionInterruption,startProps:s.start,endProps:s.end,onStart:e.onTransitionStart,onUpdate:this._onTransitionUpdate,onInterrupt:this._onTransitionEnd(e.onTransitionInterrupt),onEnd:this._onTransitionEnd(e.onTransitionEnd)}),this.onStateChange({inTransition:!0}),this.updateTransition()}_onTransitionEnd(t){return e=>{this.propsInTransition=null,this.onStateChange({inTransition:!1,isZooming:!1,isPanning:!1,isRotating:!1}),t(e)}}_onTransitionUpdate(t){const{time:e,settings:{interpolator:n,startProps:r,endProps:i,duration:o,easing:s}}=t,a=s(e/o),u=n.interpolateProps(r,i,a);this.propsInTransition=new this.ControllerState({...this.props,...u}).getViewportProps(),this.onViewStateChange({viewState:this.propsInTransition,oldViewState:this.props})}}class wg{constructor(t={}){Array.isArray(t)&&(t={compare:t,extract:t,required:t});const{compare:e,extract:n,required:r}=t;this._propsToCompare=e,this._propsToExtract=n,this._requiredProps=r}arePropsEqual(t,e){for(const n of this._propsToCompare||Object.keys(e))if(!(n in t)||!(n in e)||!Object(Ra["e"])(t[n],e[n]))return!1;return!0}initializeProps(t,e){let n;if(this._propsToExtract){const r={},i={};for(const n of this._propsToExtract)r[n]=t[n],i[n]=e[n];n={start:r,end:i}}else n={start:t,end:e};return this._checkRequiredProps(n.start),this._checkRequiredProps(n.end),n}interpolateProps(t,e,n){return e}getDuration(t,e){return e.transitionDuration}_checkRequiredProps(t){this._requiredProps&&this._requiredProps.forEach(e=>{const n=t[e];fg(Number.isFinite(n)||Array.isArray(n),"".concat(e," is required for transition"))})}}const xg=["longitude","latitude","zoom","bearing","pitch"],Sg=["longitude","latitude","zoom"];class Eg extends wg{constructor(t={}){const e=Array.isArray(t)?t:t.transitionProps;super(e||{compare:xg,extract:xg,required:Sg}),this.opts=t}initializeProps(t,e){const n=super.initializeProps(t,e),{makeViewport:r,around:i}=this.opts;if(r&&i){const o=r(t),s=r(e),a=o.unproject(i);n.start.around=i,Object.assign(n.end,{around:s.project(a),aroundPosition:a,width:e.width,height:e.height})}return n}interpolateProps(t,e,n){const r={};for(const i of this._propsToExtract)r[i]=Object(Ra["f"])(t[i]||0,e[i]||0,n);if(e.aroundPosition){const i=this.opts.makeViewport({...e,...r});Object.assign(r,i.panByPosition(e.aroundPosition,Object(Ra["f"])(t.around,e.around,n)))}return r}}const Ag={transitionDuration:0},Mg={transitionDuration:300,transitionEasing:t=>t,transitionInterruption:vg.BREAK},Cg=300,kg=t=>1-(1-t)*(1-t),Og={WHEEL:["wheel"],PAN:["panstart","panmove","panend"],PINCH:["pinchstart","pinchmove","pinchend"],TRIPLE_PAN:["tripanstart","tripanmove","tripanend"],DOUBLE_TAP:["doubletap"],KEYBOARD:["keydown"]};class Pg{constructor(t,e={}){this.ControllerState=t,this.controllerState=null,this.controllerStateProps=null,this.eventManager=null,this.transitionManager=new _g(t,{...e,onViewStateChange:this._onTransition.bind(this),onStateChange:this._setInteractionState.bind(this)});const n=this.linearTransitionProps;this._transition=n&&{...Mg,transitionInterpolator:new Eg({transitionProps:n})},this._events=null,this._interactionState={isDragging:!1},this._customEvents=[],this.onViewStateChange=null,this.onStateChange=null,this.handleEvent=this.handleEvent.bind(this),this.setProps(e)}get linearTransitionProps(){return null}set events(t){this.toggleEvents(this._customEvents,!1),this.toggleEvents(t,!0),this._customEvents=t,this.setProps(this.controllerStateProps)}finalize(){for(const t in this._events)this._events[t]&&this.eventManager.off(t,this.handleEvent);this.transitionManager.finalize()}handleEvent(t){const{ControllerState:e}=this;this.controllerState=new e({makeViewport:this.makeViewport,...this.controllerStateProps,...this._state});const n=this._eventStartBlocked;switch(t.type){case"panstart":return!n&&this._onPanStart(t);case"panmove":return this._onPan(t);case"panend":return this._onPanEnd(t);case"pinchstart":return!n&&this._onPinchStart(t);case"pinchmove":return this._onPinch(t);case"pinchend":return this._onPinchEnd(t);case"tripanstart":return!n&&this._onTriplePanStart(t);case"tripanmove":return this._onTriplePan(t);case"tripanend":return this._onTriplePanEnd(t);case"doubletap":return this._onDoubleTap(t);case"wheel":return this._onWheel(t);case"keydown":return this._onKeyDown(t);default:return!1}}getCenter(t){const{x:e,y:n}=this.controllerStateProps,{offsetCenter:r}=t;return[r.x-e,r.y-n]}isPointInBounds(t,e){const{width:n,height:r}=this.controllerStateProps;if(e&&e.handled)return!1;const i=t[0]>=0&&t[0]<=n&&t[1]>=0&&t[1]<=r;return i&&e&&e.stopPropagation(),i}isFunctionKeyPressed(t){const{srcEvent:e}=t;return Boolean(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}isDragging(){return this._interactionState.isDragging}blockEvents(t){const e=setTimeout(()=>{this._eventStartBlocked===e&&(this._eventStartBlocked=null)},t);this._eventStartBlocked=e}setProps(t){"onViewStateChange"in t&&(this.onViewStateChange=t.onViewStateChange),"onStateChange"in t&&(this.onStateChange=t.onStateChange),"makeViewport"in t&&(this.makeViewport=t.makeViewport),"dragMode"in t&&(this.dragMode=t.dragMode),this.controllerStateProps=t,"eventManager"in t&&this.eventManager!==t.eventManager&&(this.eventManager=t.eventManager,this._events={},this.toggleEvents(this._customEvents,!0)),"transitionInterpolator"in t||(t.transitionInterpolator=this._getTransitionProps().transitionInterpolator),this.transitionManager.processViewStateChange(t);let{inertia:e}=t;!0===e&&(e=Cg),this.inertia=e;const{scrollZoom:n=!0,dragPan:r=!0,dragRotate:i=!0,doubleClickZoom:o=!0,touchZoom:s=!0,touchRotate:a=!1,keyboard:u=!0}=t,c=Boolean(this.onViewStateChange);this.toggleEvents(Og.WHEEL,c&&n),this.toggleEvents(Og.PAN,c&&(r||i)),this.toggleEvents(Og.PINCH,c&&(s||a)),this.toggleEvents(Og.TRIPLE_PAN,c&&a),this.toggleEvents(Og.DOUBLE_TAP,c&&o),this.toggleEvents(Og.KEYBOARD,c&&u),this.scrollZoom=n,this.dragPan=r,this.dragRotate=i,this.doubleClickZoom=o,this.touchZoom=s,this.touchRotate=a,this.keyboard=u}updateTransition(){this.transitionManager.updateTransition()}toggleEvents(t,e){this.eventManager&&t.forEach(t=>{this._events[t]!==e&&(this._events[t]=e,e?this.eventManager.on(t,this.handleEvent):this.eventManager.off(t,this.handleEvent))})}updateViewport(t,e={},n={}){const r={...t.getViewportProps(),...e},i=this.controllerState!==t;if(this._state=t.getState(),this._setInteractionState(n),i){const t=this.controllerState?this.controllerState.getViewportProps():null;this.onViewStateChange&&this.onViewStateChange({viewState:r,interactionState:this._interactionState,oldViewState:t})}}_onTransition(t){this.onViewStateChange&&(t.interactionState=this._interactionState,this.onViewStateChange(t))}_setInteractionState(t){Object.assign(this._interactionState,t),this.onStateChange&&this.onStateChange(this._interactionState)}_onPanStart(t){const e=this.getCenter(t);if(!this.isPointInBounds(e,t))return!1;let n=this.isFunctionKeyPressed(t)||t.rightButton;(this.invertPan||"pan"===this.dragMode)&&(n=!n);const r=this.controllerState[n?"panStart":"rotateStart"]({pos:e});return this._panMove=n,this.updateViewport(r,Ag,{isDragging:!0}),!0}_onPan(t){return!!this.isDragging()&&(this._panMove?this._onPanMove(t):this._onPanRotate(t))}_onPanEnd(t){return!!this.isDragging()&&(this._panMove?this._onPanMoveEnd(t):this._onPanRotateEnd(t))}_onPanMove(t){if(!this.dragPan)return!1;const e=this.getCenter(t),n=this.controllerState.pan({pos:e});return this.updateViewport(n,Ag,{isDragging:!0,isPanning:!0}),!0}_onPanMoveEnd(t){const{inertia:e}=this;if(this.dragPan&&e&&t.velocity){const n=this.getCenter(t),r=[n[0]+t.velocityX*e/2,n[1]+t.velocityY*e/2],i=this.controllerState.pan({pos:r}).panEnd();this.updateViewport(i,{...this._getTransitionProps(),transitionDuration:e,transitionEasing:kg},{isDragging:!1,isPanning:!0})}else{const t=this.controllerState.panEnd();this.updateViewport(t,null,{isDragging:!1,isPanning:!1})}return!0}_onPanRotate(t){if(!this.dragRotate)return!1;const e=this.getCenter(t),n=this.controllerState.rotate({pos:e});return this.updateViewport(n,Ag,{isDragging:!0,isRotating:!0}),!0}_onPanRotateEnd(t){const{inertia:e}=this;if(this.dragRotate&&e&&t.velocity){const n=this.getCenter(t),r=[n[0]+t.velocityX*e/2,n[1]+t.velocityY*e/2],i=this.controllerState.rotate({pos:r}).rotateEnd();this.updateViewport(i,{...this._getTransitionProps(),transitionDuration:e,transitionEasing:kg},{isDragging:!1,isRotating:!0})}else{const t=this.controllerState.rotateEnd();this.updateViewport(t,null,{isDragging:!1,isRotating:!1})}return!0}_onWheel(t){if(!this.scrollZoom)return!1;t.preventDefault();const e=this.getCenter(t);if(!this.isPointInBounds(e,t))return!1;const{speed:n=.01,smooth:r=!1}=this.scrollZoom,{delta:i}=t;let o=2/(1+Math.exp(-Math.abs(i*n)));i<0&&0!==o&&(o=1/o);const s=this.controllerState.zoom({pos:e,scale:o});return this.updateViewport(s,{...this._getTransitionProps({around:e}),transitionDuration:r?250:1},{isZooming:!0,isPanning:!0}),!0}_onTriplePanStart(t){const e=this.getCenter(t);if(!this.isPointInBounds(e,t))return!1;const n=this.controllerState.rotateStart({pos:e});return this.updateViewport(n,Ag,{isDragging:!0}),!0}_onTriplePan(t){if(!this.touchRotate)return!1;if(!this.isDragging())return!1;const e=this.getCenter(t);e[0]-=t.deltaX;const n=this.controllerState.rotate({pos:e});return this.updateViewport(n,Ag,{isDragging:!0,isRotating:!0}),!0}_onTriplePanEnd(t){if(!this.isDragging())return!1;const{inertia:e}=this;if(this.touchRotate&&e&&t.velocityY){const n=this.getCenter(t),r=[n[0],n[1]+=t.velocityY*e/2],i=this.controllerState.rotate({pos:r});this.updateViewport(i,{...this._getTransitionProps(),transitionDuration:e,transitionEasing:kg},{isDragging:!1,isRotating:!0}),this.blockEvents(e)}else{const t=this.controllerState.rotateEnd();this.updateViewport(t,null,{isDragging:!1,isRotating:!1})}return!0}_onPinchStart(t){const e=this.getCenter(t);if(!this.isPointInBounds(e,t))return!1;const n=this.controllerState.zoomStart({pos:e}).rotateStart({pos:e});return this._startPinchRotation=t.rotation,this._lastPinchEvent=t,this.updateViewport(n,Ag,{isDragging:!0}),!0}_onPinch(t){if(!this.touchZoom&&!this.touchRotate)return!1;if(!this.isDragging())return!1;let e=this.controllerState;if(this.touchZoom){const{scale:n}=t,r=this.getCenter(t);e=e.zoom({pos:r,scale:n})}if(this.touchRotate){const{rotation:n}=t;e=e.rotate({deltaAngleX:this._startPinchRotation-n})}return this.updateViewport(e,Ag,{isDragging:!0,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:this.touchRotate}),this._lastPinchEvent=t,!0}_onPinchEnd(t){if(!this.isDragging())return!1;const{inertia:e,_lastPinchEvent:n}=this;if(this.touchZoom&&e&&n&&t.scale!==n.scale){const r=this.getCenter(t);let i=this.controllerState.rotateEnd();const o=Math.log2(t.scale),s=(o-Math.log2(n.scale))/(t.deltaTime-n.deltaTime),a=Math.pow(2,o+s*e/2);i=i.zoom({pos:r,scale:a}).zoomEnd(),this.updateViewport(i,{...this._getTransitionProps({around:r}),transitionDuration:e,transitionEasing:kg},{isDragging:!1,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:!1}),this.blockEvents(e)}else{const t=this.controllerState.zoomEnd().rotateEnd();this.updateViewport(t,null,{isDragging:!1,isPanning:!1,isZooming:!1,isRotating:!1})}return this._startPinchRotation=null,this._lastPinchEvent=null,!0}_onDoubleTap(t){if(!this.doubleClickZoom)return!1;const e=this.getCenter(t);if(!this.isPointInBounds(e,t))return!1;const n=this.isFunctionKeyPressed(t),r=this.controllerState.zoom({pos:e,scale:n?.5:2});return this.updateViewport(r,this._getTransitionProps({around:e}),{isZooming:!0,isPanning:!0}),this.blockEvents(100),!0}_onKeyDown(t){if(!this.keyboard)return!1;const e=this.isFunctionKeyPressed(t),{zoomSpeed:n,moveSpeed:r,rotateSpeedX:i,rotateSpeedY:o}=this.keyboard,{controllerState:s}=this;let a;const u={};switch(t.srcEvent.code){case"Minus":a=e?s.zoomOut(n).zoomOut(n):s.zoomOut(n),u.isZooming=!0;break;case"Equal":a=e?s.zoomIn(n).zoomIn(n):s.zoomIn(n),u.isZooming=!0;break;case"ArrowLeft":e?(a=s.rotateLeft(i),u.isRotating=!0):(a=s.moveLeft(r),u.isPanning=!0);break;case"ArrowRight":e?(a=s.rotateRight(i),u.isRotating=!0):(a=s.moveRight(r),u.isPanning=!0);break;case"ArrowUp":e?(a=s.rotateUp(o),u.isRotating=!0):(a=s.moveUp(r),u.isPanning=!0);break;case"ArrowDown":e?(a=s.rotateDown(o),u.isRotating=!0):(a=s.moveDown(r),u.isPanning=!0);break;default:return!1}return this.updateViewport(a,this._getTransitionProps(),u),!0}_getTransitionProps(t){const{_transition:e}=this;return e?t?{...e,transitionInterpolator:new Eg({...t,transitionProps:this.linearTransitionProps,makeViewport:this.controllerState.makeViewport})}:e:Ag}}class Tg{constructor(t){this._viewportProps=this._applyConstraints(t)}getViewportProps(){return this._viewportProps}getState(){return this._state}shortestPathFrom(t){return this._viewportProps}_applyConstraints(t){return t}}const Lg=5,Ig=1.2,Ng={pitch:0,bearing:0,altitude:1.5,minZoom:0,maxZoom:20,minPitch:0,maxPitch:60};class Dg extends Tg{constructor({makeViewport:t,width:e,height:n,latitude:r,longitude:i,zoom:o,bearing:s=Ng.bearing,pitch:a=Ng.pitch,altitude:u=Ng.altitude,maxZoom:c=Ng.maxZoom,minZoom:l=Ng.minZoom,maxPitch:h=Ng.maxPitch,minPitch:f=Ng.minPitch,startPanLngLat:d,startZoomLngLat:p,startRotatePos:g,startBearing:m,startPitch:y,startZoom:v,normalize:b}={}){fg(Number.isFinite(i)),fg(Number.isFinite(r)),fg(Number.isFinite(o)),super({width:e,height:n,latitude:r,longitude:i,zoom:o,bearing:s,pitch:a,altitude:u,maxZoom:c,minZoom:l,maxPitch:h,minPitch:f,normalize:b}),this._state={startPanLngLat:d,startZoomLngLat:p,startRotatePos:g,startBearing:m,startPitch:y,startZoom:v},this.makeViewport=t}panStart({pos:t}){return this._getUpdatedState({startPanLngLat:this._unproject(t)})}pan({pos:t,startPos:e}){const n=this._state.startPanLngLat||this._unproject(e);if(!n)return this;const r=this.makeViewport(this._viewportProps),i=r.panByPosition(n,t);return this._getUpdatedState(i)}panEnd(){return this._getUpdatedState({startPanLngLat:null})}rotateStart({pos:t}){return this._getUpdatedState({startRotatePos:t,startBearing:this._viewportProps.bearing,startPitch:this._viewportProps.pitch})}rotate({pos:t,deltaAngleX:e=0,deltaAngleY:n=0}){const{startRotatePos:r,startBearing:i,startPitch:o}=this._state;if(!r||!Number.isFinite(i)||!Number.isFinite(o))return this;let s;return s=t?this._calculateNewPitchAndBearing({...this._getRotationParams(t,r),startBearing:i,startPitch:o}):{bearing:i+e,pitch:o+n},this._getUpdatedState(s)}rotateEnd(){return this._getUpdatedState({startBearing:null,startPitch:null})}zoomStart({pos:t}){return this._getUpdatedState({startZoomLngLat:this._unproject(t),startZoom:this._viewportProps.zoom})}zoom({pos:t,startPos:e,scale:n}){let{startZoom:r,startZoomLngLat:i}=this._state;Number.isFinite(r)||(r=this._viewportProps.zoom,i=this._unproject(e)||this._unproject(t));const o=this._calculateNewZoom({scale:n,startZoom:r}),s=this.makeViewport({...this._viewportProps,zoom:o});return this._getUpdatedState({zoom:o,...s.panByPosition(i,t)})}zoomEnd(){return this._getUpdatedState({startZoomLngLat:null,startZoom:null})}zoomIn(t=2){return this._zoomFromCenter(t)}zoomOut(t=2){return this._zoomFromCenter(1/t)}moveLeft(t=100){return this._panFromCenter([t,0])}moveRight(t=100){return this._panFromCenter([-t,0])}moveUp(t=100){return this._panFromCenter([0,t])}moveDown(t=100){return this._panFromCenter([0,-t])}rotateLeft(t=15){return this._getUpdatedState({bearing:this._viewportProps.bearing-t})}rotateRight(t=15){return this._getUpdatedState({bearing:this._viewportProps.bearing+t})}rotateUp(t=10){return this._getUpdatedState({pitch:this._viewportProps.pitch+t})}rotateDown(t=10){return this._getUpdatedState({pitch:this._viewportProps.pitch-t})}shortestPathFrom(t){const e=t.getViewportProps(),n={...this._viewportProps},{bearing:r,longitude:i}=n;return Math.abs(r-e.bearing)>180&&(n.bearing=r<0?r+360:r-360),Math.abs(i-e.longitude)>180&&(n.longitude=i<0?i+360:i-360),n}_zoomFromCenter(t){const{width:e,height:n}=this._viewportProps;return this.zoom({pos:[e/2,n/2],scale:t})}_panFromCenter(t){const{width:e,height:n}=this._viewportProps;return this.pan({startPos:[e/2,n/2],pos:[e/2+t[0],n/2+t[1]]})}_getUpdatedState(t){return new this.constructor({makeViewport:this.makeViewport,...this._viewportProps,...this._state,...t})}_applyConstraints(t){const{maxZoom:e,minZoom:n,zoom:r}=t;t.zoom=Object(Ra["d"])(r,n,e);const{maxPitch:i,minPitch:o,pitch:s}=t;t.pitch=Object(Ra["d"])(s,o,i);const{normalize:a=!0}=t;return a&&Object.assign(t,Ic(t)),t}_unproject(t){const e=this.makeViewport(this._viewportProps);return t&&e.unproject(t)}_calculateNewZoom({scale:t,startZoom:e}){const{maxZoom:n,minZoom:r}=this._viewportProps,i=e+Math.log2(t);return Object(Ra["d"])(i,r,n)}_calculateNewPitchAndBearing({deltaScaleX:t,deltaScaleY:e,startBearing:n,startPitch:r}){e=Object(Ra["d"])(e,-1,1);const{minPitch:i,maxPitch:o}=this._viewportProps,s=n+180*t;let a=r;return e>0?a=r+e*(o-r):e<0&&(a=r-e*(i-r)),{pitch:a,bearing:s}}_getRotationParams(t,e){const n=t[0]-e[0],r=t[1]-e[1],i=t[1],o=e[1],{width:s,height:a}=this._viewportProps,u=n/s;let c=0;return r>0?Math.abs(a-o)>Lg&&(c=r/(o-a)*Ig):r<0&&o>Lg&&(c=1-i/o),c=Math.min(1,Math.max(-1,c)),{deltaScaleX:u,deltaScaleY:c}}}class Rg extends Pg{constructor(t){t.dragMode=t.dragMode||"pan",super(Dg,t)}setProps(t){const e=this.controllerStateProps;super.setProps(t);const n=!e||e.height!==t.height;n&&this.updateViewport(new this.ControllerState({makeViewport:this.makeViewport,...this.controllerStateProps,...this._state}))}get linearTransitionProps(){return["longitude","latitude","zoom","bearing","pitch"]}}class Fg extends dg{constructor(t){super({...t,type:Al})}get controller(){return this._getControllerProps({type:Rg})}}Fg.displayName="MapView";const Bg=new tl;class jg{constructor(){this.effects=[],this._internalEffects=[],this._needsRedraw="Initial render",this.setEffects()}setProps(t){"effects"in t&&(t.effects.length===this.effects.length&&ag(t.effects,this.effects)||(this.setEffects(t.effects),this._needsRedraw="effects changed"))}needsRedraw(t={clearRedrawFlags:!1}){const e=this._needsRedraw;return t.clearRedrawFlags&&(this._needsRedraw=!1),e}getEffects(){return this._internalEffects}finalize(){this.cleanup()}setEffects(t=[]){this.cleanup(),this.effects=t,this._createInternalEffects()}cleanup(){for(const t of this.effects)t.cleanup();for(const t of this._internalEffects)t.cleanup();this.effects.length=0,this._internalEffects.length=0}_createInternalEffects(){this._internalEffects=this.effects.slice(),this.effects.some(t=>t instanceof tl)||this._internalEffects.push(Bg)}}class zg extends qa{}const Ug={blendFunc:[1,0,32771,0],blendEquation:32774};class $g extends qa{render(t){return t.pickingFBO?this._drawPickingBuffer(t):super.render(t)}_drawPickingBuffer({layers:t,layerFilter:e,views:n,viewports:r,onViewportActive:i,pickingFBO:o,deviceRect:{x:s,y:a,width:u,height:c},pass:l="picking",redrawReason:h,pickZ:f}){const d=this.gl;this.pickZ=f;const p=!f&&{byLayer:new Map,byAlpha:[]};this._colors=p;const g=Object(li["d"])(d,{scissorTest:!0,scissor:[s,a,u,c],clearColor:[0,0,0,0],depthMask:!0,depthTest:!0,depthRange:[0,1],colorMask:[!0,!0,!0,!0],...Ug,blend:!f},()=>super.render({target:o,layers:t,layerFilter:e,views:n,viewports:r,onViewportActive:i,pass:l,redrawReason:h}));this._colors=null;const m=p&&qg.bind(null,p);return{decodePickingColor:m,stats:g}}shouldDrawLayer(t){return t.props.pickable}getModuleParameters(){return{pickingActive:1,pickingAttribute:this.pickZ,lightSources:{}}}getLayerParameters(t,e,n){const r={...t.props.parameters};return this.pickZ?r.blend=!1:(Object.assign(r,Ug),r.blend=!0,r.blendColor=Vg(this._colors,t,n)),r}}function Vg(t,e,n){const{byLayer:r,byAlpha:i}=t;let o;if(r.has(e)){const t=r.get(e);t.viewports.push(n),o=t.a}else if(o=r.size+1,o<=255){const t={a:o,layer:e,viewports:[n]};r.set(e,t),i[o]=t}else vn.warn("Too many pickable layers, only picking the first 255")(),o=0;return[0,0,0,o/255]}function qg(t,e){const n=t.byAlpha[e[3]];return n&&{pickedLayer:n.layer,pickedViewports:n.viewports,pickedObjectIndex:n.layer.decodePickingColor(e)}}const Wg="deckRenderer.renderLayers";class Gg{constructor(t){this.gl=t,this.layerFilter=null,this.drawPickingColors=!1,this.drawLayersPass=new zg(t),this.pickLayersPass=new $g(t),this.renderCount=0,this._needsRedraw="Initial render",this.renderBuffers=[],this.lastPostProcessEffect=null}setProps(t){"layerFilter"in t&&this.layerFilter!==t.layerFilter&&(this.layerFilter=t.layerFilter,this._needsRedraw="layerFilter changed"),"drawPickingColors"in t&&this.drawPickingColors!==t.drawPickingColors&&(this.drawPickingColors=t.drawPickingColors,this._needsRedraw="drawPickingColors changed")}renderLayers(t){const e=this.drawPickingColors?this.pickLayersPass:this.drawLayersPass;t.layerFilter=t.layerFilter||this.layerFilter,t.effects=t.effects||[],t.target=t.target||os.getDefaultFramebuffer(this.gl),this._preRender(t.effects,t);const n=this.lastPostProcessEffect?this.renderBuffers[0]:t.target,r=e.render({...t,target:n});this._postRender(t.effects,t),this.renderCount++,pf(Wg,this,r,t)}needsRedraw(t={clearRedrawFlags:!1}){const e=this._needsRedraw;return t.clearRedrawFlags&&(this._needsRedraw=!1),e}finalize(){const{renderBuffers:t}=this;for(const e of t)e.delete();t.length=0}_preRender(t,e){let n=null;for(const r of t)r.preRender(this.gl,e),r.postRender&&(n=r);n&&this._resizeRenderBuffers(),this.lastPostProcessEffect=n}_resizeRenderBuffers(){const{renderBuffers:t}=this;0===t.length&&t.push(new os(this.gl),new os(this.gl));for(const e of t)e.resize()}_postRender(t,e){const{renderBuffers:n}=this,r={inputBuffer:n[0],swapBuffer:n[1],target:null};for(const i of t)if(i.postRender){if(i===this.lastPostProcessEffect){r.target=e.target,i.postRender(this.gl,r);break}const t=i.postRender(this.gl,r);r.inputBuffer=t,r.swapBuffer=t===n[0]?n[1]:n[0]}}}const Hg={pickedColor:null,pickedLayer:null,pickedObjectIndex:-1};function Xg({pickedColors:t,decodePickingColor:e,deviceX:n,deviceY:r,deviceRadius:i,deviceRect:o}){if(t){const{x:s,y:a,width:u,height:c}=o;let l=i*i,h=-1,f=0;for(let e=0;e<c;e++){const i=e+a-r,o=i*i;if(o>l)f+=4*u;else for(let e=0;e<u;e++){const r=t[f+3]-1;if(r>=0){const t=e+s-n,r=t*t+o;r<=l&&(l=r,h=f)}f+=4}}if(h>=0){const n=t.slice(h,h+4),r=e(n);if(r){const t=Math.floor(h/4/u),e=h/4-t*u;return{...r,pickedColor:n,pickedX:s+e,pickedY:a+t}}vn.error("Picked non-existent layer. Is picking buffer corrupt?")()}}return Hg}function Yg({pickedColors:t,decodePickingColor:e}){const n=new Map;if(t)for(let r=0;r<t.length;r+=4){const i=t[r+3]-1;if(i>=0){const i=t.slice(r,r+4),o=i.join(",");if(!n.has(o)){const t=e(i);t?n.set(o,{...t,pickedColor:i}):vn.error("Picked non-existent layer. Is picking buffer corrupt?")()}}}return Array.from(n.values())}function Zg({pickInfo:t,viewports:e,pixelRatio:n,x:r,y:i,z:o}){let s=e[0];e.length>1&&(s=Qg((null===t||void 0===t?void 0:t.pickedViewports)||e,{x:r,y:i}));const a=s&&s.unproject([r-s.x,i-s.y],{targetZ:o});return{color:null,layer:null,viewport:s,index:-1,picked:!1,x:r,y:i,pixel:[r,i],coordinate:a,devicePixel:t&&"pickedX"in t?[t.pickedX,t.pickedY]:null,pixelRatio:n}}function Kg(t){const{pickInfo:e,lastPickedInfo:n,mode:r,layers:i}=t,{pickedColor:o,pickedLayer:s,pickedObjectIndex:a}=e,u=s?[s]:[];if("hover"===r){const t=n.index,e=n.layerId,r=s&&s.props.id;if(r!==e||a!==t){if(r!==e){const t=i.find(t=>t.props.id===e);t&&u.unshift(t)}n.layerId=r,n.index=a,n.info=null}}const c=Zg(t),l=new Map;return l.set(null,c),u.forEach(t=>{let e={...c};t===s&&(e.color=o,e.index=a,e.picked=!0),e=Jg({layer:t,info:e,mode:r}),t===s&&"hover"===r&&(n.info=e),l.set(e.layer.id,e),"hover"===r&&e.layer.updateAutoHighlight(e)}),l}function Jg({layer:t,info:e,mode:n}){while(t&&e){const r=e.layer||null;e.sourceLayer=r,e.layer=t,e=t.getPickingInfo({info:e,mode:n,sourceLayer:r}),t=t.parent}return e}function Qg(t,e){for(let n=t.length-1;n>=0;n--){const r=t[n];if(r.containsPixel(e))return r}return t[0]}class tm{constructor(t){this.gl=t,this.pickingFBO=null,this.pickLayersPass=new $g(t),this.layerFilter=null,this.lastPickedInfo={index:-1,layerId:null,info:null}}setProps(t){"layerFilter"in t&&(this.layerFilter=t.layerFilter),"_pickable"in t&&(this._pickable=t._pickable)}finalize(){this.pickingFBO&&this.pickingFBO.delete(),this.depthFBO&&(this.depthFBO.color.delete(),this.depthFBO.delete())}pickObject(t){return this._pickClosestObject(t)}pickObjects(t){return this._pickVisibleObjects(t)}getLastPickedObject({x:t,y:e,layers:n,viewports:r},i=this.lastPickedInfo.info){const o=i&&i.layer&&i.layer.id,s=i&&i.viewport&&i.viewport.id,a=o?n.find(t=>t.id===o):null,u=s&&r.find(t=>t.id===s)||r[0],c=u&&u.unproject([t-u.x,e-u.y]),l={x:t,y:e,viewport:u,coordinate:c,layer:a};return{...i,...l}}_resizeBuffer(){const{gl:t}=this;return this.pickingFBO||(this.pickingFBO=new os(t),os.isSupported(t,{colorBufferFloat:!0})&&(this.depthFBO=new os(t),this.depthFBO.attach({[36064]:new wo(t,{format:Object(ci["e"])(t)?34836:6408,type:5126})}))),this.pickingFBO.resize({width:t.canvas.width,height:t.canvas.height}),this.depthFBO&&this.depthFBO.resize({width:t.canvas.width,height:t.canvas.height}),this.pickingFBO}_getPickable(t){if(!1===this._pickable)return null;const e=t.filter(t=>t.isPickable()&&!t.isComposite);return e.length?e:null}_pickClosestObject({layers:t,views:e,viewports:n,x:r,y:i,radius:o=0,depth:s=1,mode:a="query",unproject3D:u,onViewportActive:c}){if(t=this._getPickable(t),!t)return{result:[],emptyInfo:Zg({viewports:n,x:r,y:i})};this._resizeBuffer();const l=pi(this.gl),h=gi(this.gl,[r,i],!0),f=[h.x+Math.floor(h.width/2),h.y+Math.floor(h.height/2)],d=Math.round(o*l),{width:p,height:g}=this.pickingFBO,m=this._getPickingRect({deviceX:f[0],deviceY:f[1],deviceRadius:d,deviceWidth:p,deviceHeight:g});let y;const v=[],b={};for(let _=0;_<s;_++){const o=m&&this._drawAndSample({layers:t,views:e,viewports:n,onViewportActive:c,deviceRect:m,pass:"picking:".concat(a),redrawReason:a}),h=Xg({...o,deviceX:f[0],deviceY:f[1],deviceRadius:d,deviceRect:m});let p;if(h.pickedLayer&&u&&this.depthFBO){const t=this._drawAndSample({layers:[h.pickedLayer],views:e,viewports:n,onViewportActive:c,deviceRect:{x:h.pickedX,y:h.pickedY,width:1,height:1},pass:"picking:".concat(a),redrawReason:"pick-z",pickZ:!0});p=t.pickedColors[0]*n[0].distanceScales.metersPerUnit[2]+n[0].position[2]}if(h.pickedColor&&_+1<s){const e=h.pickedColor[3]-1;b[e]=!0,t[e].disablePickingIndex(h.pickedObjectIndex)}y=Kg({pickInfo:h,lastPickedInfo:this.lastPickedInfo,mode:a,layers:t,viewports:n,x:r,y:i,z:p,pixelRatio:l});for(const t of y.values())t.layer&&v.push(t);if(!h.pickedColor)break}for(const _ in b)t[_].restorePickingColors();return{result:v,emptyInfo:y&&y.get(null)}}_pickVisibleObjects({layers:t,views:e,viewports:n,x:r,y:i,width:o=1,height:s=1,mode:a="query",maxObjects:u=null,onViewportActive:c}){if(t=this._getPickable(t),!t)return[];this._resizeBuffer();const l=pi(this.gl),h=gi(this.gl,[r,i],!0),f=h.x,d=h.y+h.height,p=gi(this.gl,[r+o,i+s],!0),g=p.x+p.width,m=p.y,y={x:f,y:m,width:g-f,height:d-m},v=this._drawAndSample({layers:t,views:e,viewports:n,onViewportActive:c,deviceRect:y,pass:"picking:".concat(a),redrawReason:a}),b=Yg(v),_=new Map,w=Number.isFinite(u);for(let x=0;x<b.length;x++){if(w&&_.size>=u)break;const t=b[x];let e={color:t.pickedColor,layer:null,index:t.pickedObjectIndex,picked:!0,x:r,y:i,width:o,height:s,pixelRatio:l};e=Jg({layer:t.pickedLayer,info:e,mode:a}),_.has(e.object)||_.set(e.object,e)}return Array.from(_.values())}_drawAndSample({layers:t,views:e,viewports:n,onViewportActive:r,deviceRect:i,pass:o,redrawReason:s,pickZ:a}){const u=a?this.depthFBO:this.pickingFBO,{decodePickingColor:c}=this.pickLayersPass.render({layers:t,layerFilter:this.layerFilter,views:e,viewports:n,onViewportActive:r,pickingFBO:u,deviceRect:i,pass:o,redrawReason:s,pickZ:a}),{x:l,y:h,width:f,height:d}=i,p=new(a?Float32Array:Uint8Array)(f*d*4);return Vo(u,{sourceX:l,sourceY:h,sourceWidth:f,sourceHeight:d,target:p}),{pickedColors:p,decodePickingColor:c}}_getPickingRect({deviceX:t,deviceY:e,deviceRadius:n,deviceWidth:r,deviceHeight:i}){const o=Math.max(0,t-n),s=Math.max(0,e-n),a=Math.min(r,t+n+1)-o,u=Math.min(i,e+n+1)-s;return a<=0||u<=0?null:{x:o,y:s,width:a,height:u}}}const em={zIndex:1,position:"absolute",pointerEvents:"none",color:"#a0a7b4",backgroundColor:"#29323c",padding:"10px",top:0,left:0,display:"none"};class nm{constructor(t){const e=t.parentElement;e&&(this.el=document.createElement("div"),this.el.className="deck-tooltip",Object.assign(this.el.style,em),e.appendChild(this.el)),this.isVisible=!1}setTooltip(t,e,n){const r=this.el;if("string"===typeof t)r.innerText=t;else{if(!t)return this.isVisible=!1,void(r.style.display="none");"text"in t&&(r.innerText=t.text),"html"in t&&(r.innerHTML=t.html),"className"in t&&(r.className=t.className),Object.assign(r.style,t.style)}this.isVisible=!0,r.style.display="block",r.style.transform="translate(".concat(e,"px, ").concat(n,"px)")}remove(){this.el&&this.el.remove()}}const rm="3.0.12";function im(t,e){if(!t)throw new Error(e)}var om=n("77ae");const{_parseImageNode:sm}=om["a"],am="undefined"!==typeof Image,um="undefined"!==typeof ImageBitmap,cm=Boolean(sm),lm=!!om["b"]||cm;function hm(t){switch(t){case"auto":return um||am||lm;case"imagebitmap":return um;case"image":return am;case"data":return lm;default:throw new Error(`@loaders.gl/images: image ${t} not supported in this environment`)}}function fm(){if(um)return"imagebitmap";if(am)return"image";if(lm)return"data";throw new Error("Install '@loaders.gl/polyfills' to parse images under Node.js")}function dm(t){const e=gm(t);if(!e)throw new Error("Not an image");return e}function pm(t){switch(dm(t)){case"data":return t;case"image":case"imagebitmap":const e=document.createElement("canvas"),n=e.getContext("2d");if(!n)throw new Error("getImageData");return e.width=t.width,e.height=t.height,n.drawImage(t,0,0),n.getImageData(0,0,t.width,t.height);default:throw new Error("getImageData")}}function gm(t){return"undefined"!==typeof ImageBitmap&&t instanceof ImageBitmap?"imagebitmap":"undefined"!==typeof Image&&t instanceof Image?"image":t&&"object"===typeof t&&t.data&&t.width&&t.height?"data":null}const mm=/^data:image\/svg\+xml/,ym=/\.svg((\?|#).*)?$/;function vm(t){return t&&(mm.test(t)||ym.test(t))}function bm(t,e){if(vm(e)){const e=new TextDecoder;let r=e.decode(t);try{"function"===typeof unescape&&"function"===typeof encodeURIComponent&&(r=unescape(encodeURIComponent(r)))}catch(n){throw new Error(n.message)}const i=`data:image/svg+xml;base64,${btoa(r)}`;return i}return _m(t,e)}function _m(t,e){if(vm(e))throw new Error("SVG cannot be parsed directly to imagebitmap");return new Blob([new Uint8Array(t)])}async function wm(t,e,n){const r=bm(t,n),i=self.URL||self.webkitURL,o="string"!==typeof r&&i.createObjectURL(r);try{return await xm(o||r,e)}finally{o&&i.revokeObjectURL(o)}}async function xm(t,e){const n=new Image;return n.src=t,e.image&&e.image.decode&&n.decode?(await n.decode(),n):await new Promise((e,r)=>{try{n.onload=()=>e(n),n.onerror=e=>r(new Error(`Could not load image ${t}: ${e}`))}catch(i){r(i)}})}const Sm={};let Em=!0;async function Am(t,e,n){let r;if(vm(n)){const i=await wm(t,e,n);r=i}else r=_m(t,n);const i=e&&e.imagebitmap;return await Mm(r,i)}async function Mm(t,e=null){if(!Cm(e)&&Em||(e=null),e)try{return await createImageBitmap(t,e)}catch(n){console.warn(n),Em=!1}return await createImageBitmap(t)}function Cm(t){for(const e in t||Sm)return!1;return!0}const km=!1,Om=!0;function Pm(t){const e=Rm(t);return Tm(e)||Nm(e)||Lm(e)||Im(e)}function Tm(t){const e=Rm(t),n=e.byteLength>=24&&2303741511===e.getUint32(0,km);return n?{mimeType:"image/png",width:e.getUint32(16,km),height:e.getUint32(20,km)}:null}function Lm(t){const e=Rm(t),n=e.byteLength>=10&&1195984440===e.getUint32(0,km);return n?{mimeType:"image/gif",width:e.getUint16(6,Om),height:e.getUint16(8,Om)}:null}function Im(t){const e=Rm(t),n=e.byteLength>=14&&16973===e.getUint16(0,km)&&e.getUint32(2,Om)===e.byteLength;return n?{mimeType:"image/bmp",width:e.getUint32(18,Om),height:e.getUint32(22,Om)}:null}function Nm(t){const e=Rm(t),n=e.byteLength>=3&&65496===e.getUint16(0,km)&&255===e.getUint8(2);if(!n)return null;const{tableMarkers:r,sofMarkers:i}=Dm();let o=2;while(o+9<e.byteLength){const t=e.getUint16(o,km);if(i.has(t))return{mimeType:"image/jpeg",height:e.getUint16(o+5,km),width:e.getUint16(o+7,km)};if(!r.has(t))return null;o+=2,o+=e.getUint16(o,km)}return null}function Dm(){const t=new Set([65499,65476,65484,65501,65534]);for(let n=65504;n<65520;++n)t.add(n);const e=new Set([65472,65473,65474,65475,65477,65478,65479,65481,65482,65483,65485,65486,65487,65502]);return{tableMarkers:t,sofMarkers:e}}function Rm(t){if(t instanceof DataView)return t;if(ArrayBuffer.isView(t))return new DataView(t.buffer);if(t instanceof ArrayBuffer)return new DataView(t);throw new Error("toDataView")}function Fm(t,e){const{mimeType:n}=Pm(t)||{},{_parseImageNode:r}=om["a"];return im(r),r(t,n,e)}async function Bm(t,e,n){e=e||{};const r=e.image||{},i=r.type||"auto",{url:o}=n||{},s=jm(i);let a;switch(s){case"imagebitmap":a=await Am(t,e,o);break;case"image":a=await wm(t,e,o);break;case"data":a=await Fm(t,e);break;default:im(!1)}return"data"===i&&(a=pm(a)),a}function jm(t){switch(t){case"auto":case"data":return fm();default:return hm(t),t}}const zm=["png","jpg","jpeg","gif","webp","bmp","ico","svg"],Um=["image/png","image/jpeg","image/gif","image/webp","image/bmp","image/vnd.microsoft.icon","image/svg+xml"],$m={id:"image",module:"images",name:"Images",version:rm,mimeTypes:Um,extensions:zm,parse:Bm,tests:[t=>Boolean(Pm(new DataView(t)))],options:{image:{type:"auto",decode:!0}}};var Vm=n("2afa");function qm(t){const e=t[0],n=t[t.length-1];return"{"===e&&"}"===n||"["===e&&"]"===n}var Wm={name:"JSON",extensions:["json","geojson"],mimeTypes:["application/json","application/geo+json"],testText:qm,parseTextSync:JSON.parse};const Gm="8.6.3",Hm=Vm["global"].deck&&Vm["global"].deck.VERSION;if(Hm&&Hm!==Gm)throw new Error("deck.gl - multiple versions detected: ".concat(Hm," vs ").concat(Gm));Hm||(vn.log(1,"deck.gl ".concat(Gm))(),Vm["global"].deck=Object.assign(Vm["global"].deck||{},{VERSION:Gm,version:Gm,log:vn,_registerLoggers:df}),Tp([Wm,[$m,{imagebitmap:{premultiplyAlpha:"none"}}]]));var Xm=Vm["global"].deck;const Ym=34918,Zm=34919,Km=35007,Jm=36795,Qm=35976,ty=35887,ey=36202;class ny extends Yi{static isSupported(t,e=[]){const n=Object(ci["e"])(t),r=ts(t,Yo.TIMER_QUERY);let i=n||r;for(const o of e)switch(o){case"queries":i=i&&n;break;case"timers":i=i&&r;break;default:zi(!1)}return i}constructor(t,e={}){super(t,e),this.target=null,this._queryPending=!1,this._pollingPromise=null,Object.seal(this)}beginTimeElapsedQuery(){return this.begin(Km)}beginOcclusionQuery({conservative:t=!1}={}){return this.begin(t?ey:ty)}beginTransformFeedbackQuery(){return this.begin(Qm)}begin(t){return this._queryPending?this:(this.target=t,this.gl2.beginQuery(this.target,this.handle),this)}end(){return this._queryPending?this:(this.target&&(this.gl2.endQuery(this.target),this.target=null,this._queryPending=!0),this)}isResultAvailable(){if(!this._queryPending)return!1;const t=this.gl2.getQueryParameter(this.handle,Zm);return t&&(this._queryPending=!1),t}isTimerDisjoint(){return this.gl2.getParameter(Jm)}getResult(){return this.gl2.getQueryParameter(this.handle,Ym)}getTimerMilliseconds(){return this.getResult()/1e6}createPoll(t=Number.POSITIVE_INFINITY){if(this._pollingPromise)return this._pollingPromise;let e=0;return this._pollingPromise=new Promise((n,r)=>{const i=()=>{this.isResultAvailable()?(n(this.getResult()),this._pollingPromise=null):e++>t?(r("Timed out"),this._pollingPromise=null):requestAnimationFrame(i)};requestAnimationFrame(i)}),this._pollingPromise}_createHandle(){return ny.isSupported(this.gl)?this.gl2.createQuery():null}_deleteHandle(){this.gl2.deleteQuery(this.handle)}}function ry(t){return"undefined"!==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame(t):setTimeout(t,1e3/60)}function iy(t){return"undefined"!==typeof window&&window.cancelAnimationFrame?window.cancelAnimationFrame(t):clearTimeout(t)}var oy=n("ae32");const sy=Object(oy["isBrowser"])()&&"undefined"!==typeof document;let ay=0;class uy{constructor(t={}){const{onCreateContext:e=(t=>Si(t)),onAddHTML:n=null,onInitialize:r=(()=>{}),onRender:i=(()=>{}),onFinalize:o=(()=>{}),onError:s,gl:a=null,glOptions:u={},debug:c=!1,createFramebuffer:l=!1,autoResizeViewport:h=!0,autoResizeDrawingBuffer:f=!0,stats:d=ji.get(`animation-loop-${ay++}`)}=t;let{useDevicePixels:p=!0}=t;"useDevicePixelRatio"in t&&(ui.deprecated("useDevicePixelRatio","useDevicePixels")(),p=t.useDevicePixelRatio),this.props={onCreateContext:e,onAddHTML:n,onInitialize:r,onRender:i,onFinalize:o,onError:s,gl:a,glOptions:u,debug:c,createFramebuffer:l},this.gl=a,this.needsRedraw=null,this.timeline=null,this.stats=d,this.cpuTime=this.stats.get("CPU Time"),this.gpuTime=this.stats.get("GPU Time"),this.frameRate=this.stats.get("Frame Rate"),this._initialized=!1,this._running=!1,this._animationFrameId=null,this._nextFramePromise=null,this._resolveNextFrame=null,this._cpuStartTime=0,this.setProps({autoResizeViewport:h,autoResizeDrawingBuffer:f,useDevicePixels:p}),this.start=this.start.bind(this),this.stop=this.stop.bind(this),this._pageLoadPromise=null,this._onMousemove=this._onMousemove.bind(this),this._onMouseleave=this._onMouseleave.bind(this)}delete(){this.stop(),this._setDisplay(null)}setNeedsRedraw(t){return zi("string"===typeof t),this.needsRedraw=this.needsRedraw||t,this}setProps(t){return"autoResizeViewport"in t&&(this.autoResizeViewport=t.autoResizeViewport),"autoResizeDrawingBuffer"in t&&(this.autoResizeDrawingBuffer=t.autoResizeDrawingBuffer),"useDevicePixels"in t&&(this.useDevicePixels=t.useDevicePixels),this}start(t={}){if(this._running)return this;this._running=!0;const e=this._getPageLoadPromise().then(()=>{return!this._running||this._initialized?null:(this._createWebGLContext(t),this._createFramebuffer(),this._startEventHandling(),this._initializeCallbackData(),this._updateCallbackData(),this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._gpuTimeQuery=ny.isSupported(this.gl,["timers"])?new ny(this.gl):null,this._initialized=!0,this.onInitialize(this.animationProps))}).then(t=>{this._running&&(this._addCallbackData(t||{}),!1!==t&&this._startLoop())});return this.props.onError&&e.catch(this.props.onError),this}redraw(){return this.isContextLost()?this:(this._beginTimers(),this._setupFrame(),this._updateCallbackData(),this._renderFrame(this.animationProps),this._clearNeedsRedraw(),this.offScreen&&this.gl.commit&&this.gl.commit(),this._resolveNextFrame&&(this._resolveNextFrame(this),this._nextFramePromise=null,this._resolveNextFrame=null),this._endTimers(),this)}stop(){return this._running&&(this._finalizeCallbackData(),this._cancelAnimationFrame(this._animationFrameId),this._nextFramePromise=null,this._resolveNextFrame=null,this._animationFrameId=null,this._running=!1),this}attachTimeline(t){return this.timeline=t,this.timeline}detachTimeline(){this.timeline=null}waitForRender(){return this.setNeedsRedraw("waitForRender"),this._nextFramePromise||(this._nextFramePromise=new Promise(t=>{this._resolveNextFrame=t})),this._nextFramePromise}async toDataURL(){return this.setNeedsRedraw("toDataURL"),await this.waitForRender(),this.gl.canvas.toDataURL()}isContextLost(){return this.gl.isContextLost()}onCreateContext(...t){return this.props.onCreateContext(...t)}onInitialize(...t){return this.props.onInitialize(...t)}onRender(...t){return this.props.onRender(...t)}onFinalize(...t){return this.props.onFinalize(...t)}getHTMLControlValue(t,e=1){const n=document.getElementById(t);return n?Number(n.value):e}setViewParameters(){return ui.removed("AnimationLoop.setViewParameters","AnimationLoop.setProps")(),this}_startLoop(){const t=()=>{this._running&&(this.redraw(),this._animationFrameId=this._requestAnimationFrame(t))};this._cancelAnimationFrame(this._animationFrameId),this._animationFrameId=this._requestAnimationFrame(t)}_getPageLoadPromise(){return this._pageLoadPromise||(this._pageLoadPromise=sy?new Promise((t,e)=>{sy&&"complete"===document.readyState?t(document):window.addEventListener("load",()=>{t(document)})}):Promise.resolve({})),this._pageLoadPromise}_setDisplay(t){this.display&&(this.display.delete(),this.display.animationLoop=null),t&&(t.animationLoop=this),this.display=t}_cancelAnimationFrame(t){return this.display&&this.display.cancelAnimationFrame?this.display.cancelAnimationFrame(t):iy(t)}_requestAnimationFrame(t){if(this._running)return this.display&&this.display.requestAnimationFrame?this.display.requestAnimationFrame(t):ry(t)}_renderFrame(...t){this.display?this.display._renderFrame(...t):this.onRender(...t)}_clearNeedsRedraw(){this.needsRedraw=null}_setupFrame(){this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._resizeFramebuffer()}_initializeCallbackData(){this.animationProps={gl:this.gl,stop:this.stop,canvas:this.gl.canvas,framebuffer:this.framebuffer,useDevicePixels:this.useDevicePixels,needsRedraw:null,startTime:Date.now(),engineTime:0,tick:0,tock:0,time:0,_timeline:this.timeline,_loop:this,_animationLoop:this,_mousePosition:null}}_updateCallbackData(){const{width:t,height:e,aspect:n}=this._getSizeAndAspect();t===this.animationProps.width&&e===this.animationProps.height||this.setNeedsRedraw("drawing buffer resized"),n!==this.animationProps.aspect&&this.setNeedsRedraw("drawing buffer aspect changed"),this.animationProps.width=t,this.animationProps.height=e,this.animationProps.aspect=n,this.animationProps.needsRedraw=this.needsRedraw,this.animationProps.engineTime=Date.now()-this.animationProps.startTime,this.timeline&&this.timeline.update(this.animationProps.engineTime),this.animationProps.tick=Math.floor(this.animationProps.time/1e3*60),this.animationProps.tock++,this.animationProps.time=this.timeline?this.timeline.getTime():this.animationProps.engineTime,this.animationProps._offScreen=this.offScreen}_finalizeCallbackData(){this.onFinalize(this.animationProps)}_addCallbackData(t){"object"===typeof t&&null!==t&&(this.animationProps=Object.assign({},this.animationProps,t))}_createWebGLContext(t){if(this.offScreen=t.canvas&&"undefined"!==typeof OffscreenCanvas&&t.canvas instanceof OffscreenCanvas,t=Object.assign({},t,this.props.glOptions),this.gl=this.props.gl?Ei(this.props.gl,t):this.onCreateContext(t),!Object(ci["d"])(this.gl))throw new Error("AnimationLoop.onCreateContext - illegal context returned");Object(li["b"])(this.gl),this._createInfoDiv()}_createInfoDiv(){if(this.gl.canvas&&this.props.onAddHTML){const t=document.createElement("div");document.body.appendChild(t),t.style.position="relative";const e=document.createElement("div");e.style.position="absolute",e.style.left="10px",e.style.bottom="10px",e.style.width="300px",e.style.background="white",t.appendChild(this.gl.canvas),t.appendChild(e);const n=this.props.onAddHTML(e);n&&(e.innerHTML=n)}}_getSizeAndAspect(){const t=this.gl.drawingBufferWidth,e=this.gl.drawingBufferHeight;let n=1;const{canvas:r}=this.gl;return r&&r.clientHeight?n=r.clientWidth/r.clientHeight:t>0&&e>0&&(n=t/e),{width:t,height:e,aspect:n}}_resizeViewport(){this.autoResizeViewport&&this.gl.viewport(0,0,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight)}_resizeCanvasDrawingBuffer(){this.autoResizeDrawingBuffer&&Mi(this.gl,{useDevicePixels:this.useDevicePixels})}_createFramebuffer(){this.props.createFramebuffer&&(this.framebuffer=new os(this.gl))}_resizeFramebuffer(){this.framebuffer&&this.framebuffer.resize({width:this.gl.drawingBufferWidth,height:this.gl.drawingBufferHeight})}_beginTimers(){this.frameRate.timeEnd(),this.frameRate.timeStart(),this._gpuTimeQuery&&this._gpuTimeQuery.isResultAvailable()&&!this._gpuTimeQuery.isTimerDisjoint()&&this.stats.get("GPU Time").addTime(this._gpuTimeQuery.getTimerMilliseconds()),this._gpuTimeQuery&&this._gpuTimeQuery.beginTimeElapsedQuery(),this.cpuTime.timeStart()}_endTimers(){this.cpuTime.timeEnd(),this._gpuTimeQuery&&this._gpuTimeQuery.end()}_startEventHandling(){const{canvas:t}=this.gl;t&&(t.addEventListener("mousemove",this._onMousemove),t.addEventListener("mouseleave",this._onMouseleave))}_onMousemove(t){this.animationProps._mousePosition=[t.offsetX,t.offsetY]}_onMouseleave(t){this.animationProps._mousePosition=null}}var cy=n("c8b5"),ly=n.n(cy);const hy=1,fy=2,dy=4,py={mousedown:hy,mousemove:fy,mouseup:dy};function gy(t,e){for(let n=0;n<t.length;n++)if(e(t[n]))return!0;return!1}function my(t){const e=t.prototype.handler;t.prototype.handler=function(t){const n=this.store;t.button>0&&"pointerdown"===t.type&&(gy(n,e=>e.pointerId===t.pointerId)||n.push(t)),e.call(this,t)}}function yy(t){t.prototype.handler=function(t){let e=py[t.type];e&hy&&t.button>=0&&(this.pressed=!0),e&fy&&0===t.which&&(e=dy),this.pressed&&(e&dy&&(this.pressed=!1),this.callback(this.manager,e,{pointers:[t],changedPointers:[t],pointerType:"mouse",srcEvent:t}))}}my(ly.a.PointerEventInput),yy(ly.a.MouseInput);const vy=ly.a.Manager;var by=ly.a;const _y=by?[[by.Pan,{event:"tripan",pointers:3,threshold:0,enable:!1}],[by.Rotate,{enable:!1}],[by.Pinch,{enable:!1}],[by.Swipe,{enable:!1}],[by.Pan,{threshold:0,enable:!1}],[by.Press,{enable:!1}],[by.Tap,{event:"doubletap",taps:2,enable:!1}],[by.Tap,{event:"anytap",enable:!1}],[by.Tap,{enable:!1}]]:null,wy={tripan:["rotate","pinch","pan"],rotate:["pinch"],pinch:["pan"],pan:["press","doubletap","anytap","tap"],doubletap:["anytap"],anytap:["tap"]},xy={doubletap:["tap"]},Sy={pointerdown:"pointerdown",pointermove:"pointermove",pointerup:"pointerup",touchstart:"pointerdown",touchmove:"pointermove",touchend:"pointerup",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup"},Ey={KEY_EVENTS:["keydown","keyup"],MOUSE_EVENTS:["mousedown","mousemove","mouseup","mouseover","mouseout","mouseleave"],WHEEL_EVENTS:["wheel","mousewheel"]},Ay={tap:"tap",anytap:"anytap",doubletap:"doubletap",press:"press",pinch:"pinch",pinchin:"pinch",pinchout:"pinch",pinchstart:"pinch",pinchmove:"pinch",pinchend:"pinch",pinchcancel:"pinch",rotate:"rotate",rotatestart:"rotate",rotatemove:"rotate",rotateend:"rotate",rotatecancel:"rotate",tripan:"tripan",tripanstart:"tripan",tripanmove:"tripan",tripanup:"tripan",tripandown:"tripan",tripanleft:"tripan",tripanright:"tripan",tripanend:"tripan",tripancancel:"tripan",pan:"pan",panstart:"pan",panmove:"pan",panup:"pan",pandown:"pan",panleft:"pan",panright:"pan",panend:"pan",pancancel:"pan",swipe:"swipe",swipeleft:"swipe",swiperight:"swipe",swipeup:"swipe",swipedown:"swipe"},My={click:"tap",anyclick:"anytap",dblclick:"doubletap",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup",mouseover:"pointerover",mouseout:"pointerout",mouseleave:"pointerleave"};var Cy=n("55a9");const ky=-1!==Cy["b"].indexOf("firefox"),{WHEEL_EVENTS:Oy}=Ey,Py="wheel",Ty=4.000244140625,Ly=40,Iy=.25;class Ny{constructor(t,e,n={}){this.element=t,this.callback=e,this.options=Object.assign({enable:!0},n),this.events=Oy.concat(n.events||[]),this.handleEvent=this.handleEvent.bind(this),this.events.forEach(e=>t.addEventListener(e,this.handleEvent,!!Cy["a"]&&{passive:!1}))}destroy(){this.events.forEach(t=>this.element.removeEventListener(t,this.handleEvent))}enableEventType(t,e){t===Py&&(this.options.enable=e)}handleEvent(t){if(!this.options.enable)return;let e=t.deltaY;Cy["c"].WheelEvent&&(ky&&t.deltaMode===Cy["c"].WheelEvent.DOM_DELTA_PIXEL&&(e/=Cy["c"].devicePixelRatio),t.deltaMode===Cy["c"].WheelEvent.DOM_DELTA_LINE&&(e*=Ly));const n={x:t.clientX,y:t.clientY};0!==e&&e%Ty===0&&(e=Math.floor(e/Ty)),t.shiftKey&&e&&(e*=Iy),this._onWheel(t,-e,n)}_onWheel(t,e,n){this.callback({type:Py,center:n,delta:e,srcEvent:t,pointerType:"mouse",target:t.target})}}const{MOUSE_EVENTS:Dy}=Ey,Ry="pointermove",Fy="pointerover",By="pointerout",jy="pointerleave";class zy{constructor(t,e,n={}){this.element=t,this.callback=e,this.pressed=!1,this.options=Object.assign({enable:!0},n),this.enableMoveEvent=this.options.enable,this.enableLeaveEvent=this.options.enable,this.enableOutEvent=this.options.enable,this.enableOverEvent=this.options.enable,this.events=Dy.concat(n.events||[]),this.handleEvent=this.handleEvent.bind(this),this.events.forEach(e=>t.addEventListener(e,this.handleEvent))}destroy(){this.events.forEach(t=>this.element.removeEventListener(t,this.handleEvent))}enableEventType(t,e){t===Ry&&(this.enableMoveEvent=e),t===Fy&&(this.enableOverEvent=e),t===By&&(this.enableOutEvent=e),t===jy&&(this.enableLeaveEvent=e)}handleEvent(t){this.handleOverEvent(t),this.handleOutEvent(t),this.handleLeaveEvent(t),this.handleMoveEvent(t)}handleOverEvent(t){this.enableOverEvent&&"mouseover"===t.type&&this.callback({type:Fy,srcEvent:t,pointerType:"mouse",target:t.target})}handleOutEvent(t){this.enableOutEvent&&"mouseout"===t.type&&this.callback({type:By,srcEvent:t,pointerType:"mouse",target:t.target})}handleLeaveEvent(t){this.enableLeaveEvent&&"mouseleave"===t.type&&this.callback({type:jy,srcEvent:t,pointerType:"mouse",target:t.target})}handleMoveEvent(t){if(this.enableMoveEvent)switch(t.type){case"mousedown":t.button>=0&&(this.pressed=!0);break;case"mousemove":0===t.which&&(this.pressed=!1),this.pressed||this.callback({type:Ry,srcEvent:t,pointerType:"mouse",target:t.target});break;case"mouseup":this.pressed=!1;break;default:}}}const{KEY_EVENTS:Uy}=Ey,$y="keydown",Vy="keyup";class qy{constructor(t,e,n={}){this.element=t,this.callback=e,this.options=Object.assign({enable:!0},n),this.enableDownEvent=this.options.enable,this.enableUpEvent=this.options.enable,this.events=Uy.concat(n.events||[]),this.handleEvent=this.handleEvent.bind(this),t.tabIndex=n.tabIndex||0,t.style.outline="none",this.events.forEach(e=>t.addEventListener(e,this.handleEvent))}destroy(){this.events.forEach(t=>this.element.removeEventListener(t,this.handleEvent))}enableEventType(t,e){t===$y&&(this.enableDownEvent=e),t===Vy&&(this.enableUpEvent=e)}handleEvent(t){const e=t.target||t.srcElement;"INPUT"===e.tagName&&"text"===e.type||"TEXTAREA"===e.tagName||(this.enableDownEvent&&"keydown"===t.type&&this.callback({type:$y,srcEvent:t,key:t.key,target:t.target}),this.enableUpEvent&&"keyup"===t.type&&this.callback({type:Vy,srcEvent:t,key:t.key,target:t.target}))}}const Wy="contextmenu";class Gy{constructor(t,e,n={}){this.element=t,this.callback=e,this.options=Object.assign({enable:!0},n),this.handleEvent=this.handleEvent.bind(this),t.addEventListener("contextmenu",this.handleEvent)}destroy(){this.element.removeEventListener("contextmenu",this.handleEvent)}enableEventType(t,e){t===Wy&&(this.options.enable=e)}handleEvent(t){this.options.enable&&this.callback({type:Wy,center:{x:t.clientX,y:t.clientY},srcEvent:t,pointerType:"mouse",target:t.target})}}const Hy=1,Xy=2,Yy=4,Zy={pointerdown:Hy,pointermove:Xy,pointerup:Yy,mousedown:Hy,mousemove:Xy,mouseup:Yy},Ky=1,Jy=2,Qy=3,tv=0,ev=1,nv=2,rv=1,iv=2,ov=4;function sv(t){const e=Zy[t.srcEvent.type];if(!e)return null;const{buttons:n,button:r,which:i}=t.srcEvent;let o=!1,s=!1,a=!1;return e===Yy||e===Xy&&!Number.isFinite(n)?(o=i===Ky,s=i===Jy,a=i===Qy):e===Xy?(o=Boolean(n&rv),s=Boolean(n&ov),a=Boolean(n&iv)):e===Hy&&(o=r===tv,s=r===ev,a=r===nv),{leftButton:o,middleButton:s,rightButton:a}}function av(t,e){const{srcEvent:n}=t;if(!t.center&&!Number.isFinite(n.clientX))return null;const r=t.center||{x:n.clientX,y:n.clientY},i=e.getBoundingClientRect(),o=i.width/e.offsetWidth||1,s=i.height/e.offsetHeight||1,a={x:(r.x-i.left-e.clientLeft)/o,y:(r.y-i.top-e.clientTop)/s};return{center:r,offsetCenter:a}}const uv={srcElement:"root",priority:0};class cv{constructor(t){this.eventManager=t,this.handlers=[],this.handlersByElement=new Map,this.handleEvent=this.handleEvent.bind(this),this._active=!1}isEmpty(){return!this._active}add(t,e,n,r=!1,i=!1){const{handlers:o,handlersByElement:s}=this;n&&("object"!==typeof n||n.addEventListener)&&(n={srcElement:n}),n=n?Object.assign({},uv,n):uv;let a=s.get(n.srcElement);a||(a=[],s.set(n.srcElement,a));const u={type:t,handler:e,srcElement:n.srcElement,priority:n.priority};r&&(u.once=!0),i&&(u.passive=!0),o.push(u),this._active=this._active||!u.passive;let c=a.length-1;while(c>=0){if(a[c].priority>=u.priority)break;c--}a.splice(c+1,0,u)}remove(t,e){const{handlers:n,handlersByElement:r}=this;for(let i=n.length-1;i>=0;i--){const o=n[i];if(o.type===t&&o.handler===e){n.splice(i,1);const t=r.get(o.srcElement);t.splice(t.indexOf(o),1),0===t.length&&r.delete(o.srcElement)}}this._active=n.some(t=>!t.passive)}handleEvent(t){if(this.isEmpty())return;const e=this._normalizeEvent(t);let n=t.srcEvent.target;while(n&&n!==e.rootElement){if(this._emit(e,n),e.handled)return;n=n.parentNode}this._emit(e,"root")}_emit(t,e){const n=this.handlersByElement.get(e);if(n){let e=!1;const r=()=>{t.handled=!0},i=()=>{t.handled=!0,e=!0},o=[];for(let s=0;s<n.length;s++){const{type:a,handler:u,once:c}=n[s];if(u(Object.assign({},t,{type:a,stopPropagation:r,stopImmediatePropagation:i})),c&&o.push(n[s]),e)break}for(let t=0;t<o.length;t++){const{type:e,handler:n}=o[t];this.remove(e,n)}}}_normalizeEvent(t){const e=this.eventManager.element;return Object.assign({},t,sv(t),av(t,e),{handled:!1,rootElement:e})}}const lv={events:null,recognizers:null,recognizerOptions:{},Manager:vy,touchAction:"none",tabIndex:0};class hv{constructor(t=null,e={}){this.options=Object.assign({},lv,e),this.events=new Map,this._onBasicInput=this._onBasicInput.bind(this),this._onOtherEvent=this._onOtherEvent.bind(this),this.setElement(t);const{events:n}=e;n&&this.on(n)}setElement(t){if(this.element&&this.destroy(),this.element=t,!t)return;const{options:e}=this,n=e.Manager;this.manager=new n(t,{touchAction:e.touchAction,recognizers:e.recognizers||_y}).on("hammer.input",this._onBasicInput),e.recognizers||Object.keys(wy).forEach(t=>{const e=this.manager.get(t);e&&wy[t].forEach(t=>{e.recognizeWith(t)})});for(const r in e.recognizerOptions){const t=this.manager.get(r);if(t){const n=e.recognizerOptions[r];delete n.enable,t.set(n)}}this.wheelInput=new Ny(t,this._onOtherEvent,{enable:!1}),this.moveInput=new zy(t,this._onOtherEvent,{enable:!1}),this.keyInput=new qy(t,this._onOtherEvent,{enable:!1,tabIndex:e.tabIndex}),this.contextmenuInput=new Gy(t,this._onOtherEvent,{enable:!1});for(const[r,i]of this.events)i.isEmpty()||(this._toggleRecognizer(i.recognizerName,!0),this.manager.on(r,i.handleEvent))}destroy(){this.element&&(this.wheelInput.destroy(),this.moveInput.destroy(),this.keyInput.destroy(),this.contextmenuInput.destroy(),this.manager.destroy(),this.wheelInput=null,this.moveInput=null,this.keyInput=null,this.contextmenuInput=null,this.manager=null,this.element=null)}on(t,e,n){this._addEventHandler(t,e,n,!1)}once(t,e,n){this._addEventHandler(t,e,n,!0)}watch(t,e,n){this._addEventHandler(t,e,n,!1,!0)}off(t,e){this._removeEventHandler(t,e)}_toggleRecognizer(t,e){const{manager:n}=this;if(!n)return;const r=n.get(t);if(r&&r.options.enable!==e){r.set({enable:e});const i=xy[t];i&&!this.options.recognizers&&i.forEach(i=>{const o=n.get(i);e?(o.requireFailure(t),r.dropRequireFailure(i)):o.dropRequireFailure(t)})}this.wheelInput.enableEventType(t,e),this.moveInput.enableEventType(t,e),this.keyInput.enableEventType(t,e),this.contextmenuInput.enableEventType(t,e)}_addEventHandler(t,e,n,r,i){if("string"!==typeof t){n=e;for(const e in t)this._addEventHandler(e,t[e],n,r,i);return}const{manager:o,events:s}=this,a=My[t]||t;let u=s.get(a);u||(u=new cv(this),s.set(a,u),u.recognizerName=Ay[a]||a,o&&o.on(a,u.handleEvent)),u.add(t,e,n,r,i),u.isEmpty()||this._toggleRecognizer(u.recognizerName,!0)}_removeEventHandler(t,e){if("string"!==typeof t){for(const e in t)this._removeEventHandler(e,t[e]);return}const{events:n}=this,r=My[t]||t,i=n.get(r);if(i&&(i.remove(t,e),i.isEmpty())){const{recognizerName:t}=i;let e=!1;for(const r of n.values())if(r.recognizerName===t&&!r.isEmpty()){e=!0;break}e||this._toggleRecognizer(t,!1)}}_onBasicInput(t){const{srcEvent:e}=t,n=Sy[e.type];n&&this.manager.emit(n,t)}_onOtherEvent(t){this.manager.emit(t.type,t)}}function fv(){}const dv=({isDragging:t})=>t?"grabbing":"grab";function pv(t){return{id:t.string,width:t.oneOfType([t.number,t.string]),height:t.oneOfType([t.number,t.string]),layers:t.oneOfType([t.object,t.array]),layerFilter:t.func,views:t.oneOfType([t.object,t.array]),viewState:t.object,effects:t.arrayOf(t.instanceOf($a)),controller:t.oneOfType([t.func,t.bool,t.object]),gl:t.object,glOptions:t.object,parameters:t.object,pickingRadius:t.number,useDevicePixels:t.oneOfType([t.bool,t.number]),touchAction:t.string,eventRecognizerOptions:t.object,onWebGLInitialized:t.func,onResize:t.func,onViewStateChange:t.func,onInteractionStateChange:t.func,onBeforeRender:t.func,onAfterRender:t.func,onLoad:t.func,onError:t.func,debug:t.bool,drawPickingColors:t.bool,_framebuffer:t.object,_animate:t.bool,_pickable:t.bool,_typedArrayManagerProps:t.object}}const gv={id:"",width:"100%",height:"100%",pickingRadius:0,layerFilter:null,glOptions:{},gl:null,layers:[],effects:[],views:null,controller:null,useDevicePixels:!0,touchAction:"none",eventRecognizerOptions:{},_framebuffer:null,_animate:!1,_pickable:!0,_typedArrayManagerProps:{},onWebGLInitialized:fv,onResize:fv,onViewStateChange:fv,onInteractionStateChange:fv,onBeforeRender:fv,onAfterRender:fv,onLoad:fv,onError:(t,e)=>vn.error(t)(),_onMetrics:null,getCursor:dv,debug:!1,drawPickingColors:!1};class mv{constructor(t){t={...gv,...t},this.props={},this.width=0,this.height=0,this.viewManager=null,this.layerManager=null,this.effectManager=null,this.deckRenderer=null,this.deckPicker=null,this._needsRedraw=!0,this._pickRequest={},this._lastPointerDownInfo=null,this.viewState=null,this.interactiveState={isHovering:!1,isDragging:!1},this._onEvent=this._onEvent.bind(this),this._onPointerDown=this._onPointerDown.bind(this),this._onPointerMove=this._onPointerMove.bind(this),t.viewState&&t.initialViewState&&vn.warn("View state tracking is disabled. Use either `initialViewState` for auto update or `viewState` for manual update.")(),"IE"===Object(Vm["getBrowser"])()&&vn.warn("IE 11 support will be deprecated in v8.0")(),t.gl||"undefined"!==typeof document&&(this.canvas=this._createCanvas(t)),this.animationLoop=this._createAnimationLoop(t),this.stats=new Ni({id:"deck.gl"}),this.metrics={fps:0,setPropsTime:0,updateAttributesTime:0,framesRedrawn:0,pickTime:0,pickCount:0,gpuTime:0,gpuTimePerFrame:0,cpuTime:0,cpuTimePerFrame:0,bufferMemory:0,textureMemory:0,renderbufferMemory:0,gpuMemory:0},this._metricsCounter=0,this.setProps(t),t._typedArrayManagerProps&&nl.setProps(t._typedArrayManagerProps),this.animationLoop.start()}finalize(){this.animationLoop.stop(),this.animationLoop=null,this._lastPointerDownInfo=null,this.layerManager&&(this.layerManager.finalize(),this.layerManager=null,this.viewManager.finalize(),this.viewManager=null,this.effectManager.finalize(),this.effectManager=null,this.deckRenderer.finalize(),this.deckRenderer=null,this.deckPicker.finalize(),this.deckPicker=null,this.eventManager.destroy(),this.eventManager=null,this.tooltip.remove(),this.tooltip=null),this.props.canvas||this.props.gl||!this.canvas||(this.canvas.parentElement.removeChild(this.canvas),this.canvas=null)}setProps(t){this.stats.get("setProps Time").timeStart(),"onLayerHover"in t&&vn.removed("onLayerHover","onHover")(),"onLayerClick"in t&&vn.removed("onLayerClick","onClick")(),t.initialViewState&&!ag(this.props.initialViewState,t.initialViewState)&&(this.viewState=t.initialViewState),Object.assign(this.props,t),this._setCanvasSize(this.props);const e=Object.create(this.props);Object.assign(e,{views:this._getViews(),width:this.width,height:this.height,viewState:this._getViewState()}),this.animationLoop.setProps(e),this.layerManager&&(this.viewManager.setProps(e),this.layerManager.activateViewport(this.getViewports()[0]),this.layerManager.setProps(e),this.effectManager.setProps(e),this.deckRenderer.setProps(e),this.deckPicker.setProps(e)),this.stats.get("setProps Time").timeEnd()}needsRedraw(t={clearRedrawFlags:!1}){if(this.props._animate)return"Deck._animate";let e=this._needsRedraw;t.clearRedrawFlags&&(this._needsRedraw=!1);const n=this.viewManager.needsRedraw(t),r=this.layerManager.needsRedraw(t),i=this.effectManager.needsRedraw(t),o=this.deckRenderer.needsRedraw(t);return e=e||n||r||i||o,e}redraw(t){if(!this.layerManager)return;const e=t||this.needsRedraw({clearRedrawFlags:!0});e&&(this.stats.get("Redraw Count").incrementCount(),this.props._customRender?this.props._customRender(e):this._drawLayers(e))}getViews(){return this.viewManager.views}getViewports(t){return this.viewManager.getViewports(t)}pickObject(t){const e=this._pick("pickObject","pickObject Time",t).result;return e.length?e[0]:null}pickMultipleObjects(t){return t.depth=t.depth||10,this._pick("pickObject","pickMultipleObjects Time",t).result}pickObjects(t){return this._pick("pickObjects","pickObjects Time",t)}_addResources(t,e=!1){for(const n in t)this.layerManager.resourceManager.add({resourceId:n,data:t[n],forceUpdate:e})}_removeResources(t){for(const e of t)this.layerManager.resourceManager.remove(e)}_pick(t,e,n){const{stats:r}=this;r.get("Pick Count").incrementCount(),r.get(e).timeStart();const i=this.deckPicker[t]({layers:this.layerManager.getLayers(n),views:this.viewManager.getViews(),viewports:this.getViewports(n),onViewportActive:this.layerManager.activateViewport,...n});return r.get(e).timeEnd(),i}_createCanvas(t){let e=t.canvas;if("string"===typeof e&&(e=document.getElementById(e),fg(e)),!e){e=document.createElement("canvas"),e.id=t.id||"deckgl-overlay";const n=t.parent||document.body;n.appendChild(e)}return Object.assign(e.style,t.style),e}_setCanvasSize(t){if(!this.canvas)return;let{width:e,height:n}=t;(e||0===e)&&(e=Number.isFinite(e)?"".concat(e,"px"):e,this.canvas.style.width=e),(n||0===n)&&(n=Number.isFinite(n)?"".concat(n,"px"):n,this.canvas.style.position="absolute",this.canvas.style.height=n)}_updateCanvasSize(){if(this._checkForCanvasSizeChange()){const{width:t,height:e}=this;this.viewManager.setProps({width:t,height:e}),this.props.onResize({width:this.width,height:this.height})}}_checkForCanvasSizeChange(){const{canvas:t}=this;if(!t)return!1;const e=t.clientWidth||t.width,n=t.clientHeight||t.height;return(e!==this.width||n!==this.height)&&(this.width=e,this.height=n,!0)}_createAnimationLoop(t){const{width:e,height:n,gl:r,glOptions:i,debug:o,onError:s,onBeforeRender:a,onAfterRender:u,useDevicePixels:c,autoResizeDrawingBuffer:l}=t;return new uy({width:e,height:n,useDevicePixels:c,autoResizeDrawingBuffer:l,autoResizeViewport:!1,gl:r,onCreateContext:t=>Si({...i,...t,canvas:this.canvas,debug:o,onContextLost:()=>this._onContextLost()}),onInitialize:t=>this._setGLContext(t.gl),onRender:this._onRenderFrame.bind(this),onBeforeRender:a,onAfterRender:u,onError:s})}_getViewState(){return this.props.viewState||this.viewState}_getViews(){let t=this.props.views||[new Fg({id:"default-view"})];return t=Array.isArray(t)?t:[t],t.length&&this.props.controller&&(t[0].props.controller=this.props.controller),t}_onContextLost(){const{onError:t}=this.props;this.animationLoop&&t&&t(new Error("WebGL context is lost"))}_onPointerMove(t){const{_pickRequest:e}=this;if("pointerleave"===t.type)e.x=-1,e.y=-1,e.radius=0;else{if(t.leftButton||t.rightButton)return;{const n=t.offsetCenter;if(!n)return;e.x=n.x,e.y=n.y,e.radius=this.props.pickingRadius}}this.layerManager&&(this.layerManager.context.mousePosition={x:e.x,y:e.y}),e.event=t,e.mode="hover"}_pickAndCallback(){const{_pickRequest:t}=this;if(t.event){const{result:e,emptyInfo:n}=this._pick("pickObject","pickObject Time",t);this.interactiveState.isHovering=e.length>0;let r=n,i=!1;for(const o of e)r=o,i=o.layer.onHover(o,t.event);if(!i&&this.props.onHover&&this.props.onHover(r,t.event),this.props.getTooltip){const t=this.props.getTooltip(r);this.tooltip.setTooltip(t,r.x,r.y)}t.event=null}}_updateCursor(){const t=this.props.parent||this.canvas;t&&(t.style.cursor=this.props.getCursor(this.interactiveState))}_setGLContext(t){if(this.layerManager)return;this.canvas||(this.canvas=t.canvas,Ei(t,{enable:!0,copyState:!0})),this.tooltip=new nm(this.canvas),Object(li["c"])(t,{blend:!0,blendFunc:[770,771,1,771],polygonOffsetFill:!0,depthTest:!0,depthFunc:515}),this.props.onWebGLInitialized(t);const e=new cf;e.play(),this.animationLoop.attachTimeline(e),this.eventManager=new hv(this.props.parent||t.canvas,{touchAction:this.props.touchAction,recognizerOptions:this.props.eventRecognizerOptions,events:{pointerdown:this._onPointerDown,pointermove:this._onPointerMove,pointerleave:this._onPointerMove}});for(const r in xn)this.eventManager.on(r,this._onEvent);this.viewManager=new ug({timeline:e,eventManager:this.eventManager,onViewStateChange:this._onViewStateChange.bind(this),onInteractionStateChange:this._onInteractionStateChange.bind(this),views:this._getViews(),viewState:this._getViewState(),width:this.width,height:this.height});const n=this.viewManager.getViewports()[0];this.layerManager=new sg(t,{deck:this,stats:this.stats,viewport:n,timeline:e}),this.effectManager=new jg,this.deckRenderer=new Gg(t),this.deckPicker=new tm(t),this.setProps(this.props),this._updateCanvasSize(),this.props.onLoad()}_drawLayers(t,e){const{gl:n}=this.layerManager.context;Object(li["c"])(n,this.props.parameters),this.props.onBeforeRender({gl:n}),this.deckRenderer.renderLayers({target:this.props._framebuffer,layers:this.layerManager.getLayers(),viewports:this.viewManager.getViewports(),onViewportActive:this.layerManager.activateViewport,views:this.viewManager.getViews(),pass:"screen",redrawReason:t,effects:this.effectManager.getEffects(),...e}),this.props.onAfterRender({gl:n})}_onRenderFrame(t){this._getFrameStats(),this._metricsCounter++%60===0&&(this._getMetrics(),this.stats.reset(),vn.table(4,this.metrics)(),this.props._onMetrics&&this.props._onMetrics(this.metrics)),this._updateCanvasSize(),this._updateCursor(),this.tooltip.isVisible&&this.viewManager.needsRedraw()&&this.tooltip.setTooltip(null),this.layerManager.updateLayers(),this._pickAndCallback(),this.redraw(!1),this.viewManager&&this.viewManager.updateViewStates()}_onViewStateChange(t){const e=this.props.onViewStateChange(t)||t.viewState;this.viewState&&(this.viewState={...this.viewState,[t.viewId]:e},this.props.viewState||this.viewManager&&this.viewManager.setProps({viewState:this.viewState}))}_onInteractionStateChange(t){this.interactiveState.isDragging=t.isDragging,this.props.onInteractionStateChange(t)}_onEvent(t){const e=xn[t.type],n=t.offsetCenter;if(!e||!n)return;const r=this.layerManager.getLayers(),i=this.deckPicker.getLastPickedObject({x:n.x,y:n.y,layers:r,viewports:this.getViewports(n)},this._lastPointerDownInfo),{layer:o}=i,s=o&&(o[e.handler]||o.props[e.handler]),a=this.props[e.handler];let u=!1;s&&(u=s.call(o,i,t)),!u&&a&&a(i,t)}_onPointerDown(t){const e=t.offsetCenter,n=this._pick("pickObject","pickObject Time",{x:e.x,y:e.y,radius:this.props.pickingRadius});this._lastPointerDownInfo=n.result[0]||n.emptyInfo}_getFrameStats(){const{stats:t}=this;t.get("frameRate").timeEnd(),t.get("frameRate").timeStart();const e=this.animationLoop.stats;t.get("GPU Time").addTime(e.get("GPU Time").lastTiming),t.get("CPU Time").addTime(e.get("CPU Time").lastTiming)}_getMetrics(){const{metrics:t,stats:e}=this;t.fps=e.get("frameRate").getHz(),t.setPropsTime=e.get("setProps Time").time,t.updateAttributesTime=e.get("Update Attributes").time,t.framesRedrawn=e.get("Redraw Count").count,t.pickTime=e.get("pickObject Time").time+e.get("pickMultipleObjects Time").time+e.get("pickObjects Time").time,t.pickCount=e.get("Pick Count").count,t.gpuTime=e.get("GPU Time").time,t.cpuTime=e.get("CPU Time").time,t.gpuTimePerFrame=e.get("GPU Time").getAverageTime(),t.cpuTimePerFrame=e.get("CPU Time").getAverageTime();const n=ji.get("Memory Usage");t.bufferMemory=n.get("Buffer Memory").count,t.textureMemory=n.get("Texture Memory").count,t.renderbufferMemory=n.get("Renderbuffer Memory").count,t.gpuMemory=n.get("GPU Memory").count}}mv.getPropTypes=pv,mv.defaultProps=gv,mv.VERSION=Xm.VERSION;class yv{constructor(t,e){this.opts=e,this.source=t}get value(){return this.source.value}getValue(){const t=this.source.getBuffer(),e=this.getAccessor();if(t)return[t,e];const{value:n}=this.source,{size:r}=e;let i=n;if(n&&n.length!==r){i=new Float32Array(r);const t=e.elementOffset||0;for(let e=0;e<r;++e)i[e]=n[t+e]}return i}getAccessor(){return{...this.source.getAccessor(),...this.opts}}}function vv(t){switch(t){case 5126:return Float32Array;case 5130:return Float64Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return Uint8ClampedArray;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Unknown GL type")}}function bv(t){return t.stride||t.size*t.bytesPerElement}function _v(t,e){e.offset&&vn.removed("shaderAttribute.offset","vertexOffset, elementOffset")();const n=bv(t),r="vertexOffset"in e?e.vertexOffset:t.vertexOffset||0,i=e.elementOffset||0,o=r*n+i*t.bytesPerElement+(t.offset||0);return{...e,offset:o,stride:n}}function wv(t,e){const n=_v(t,e);return{high:n,low:{...n,offset:n.offset+4*t.size}}}class xv{constructor(t,e){this.gl=t,this.id=e.id,this.size=e.size;const n=e.logicalType||e.type,r=5130===n;let{defaultValue:i}=e;i=Number.isFinite(i)?[i]:i||new Array(this.size).fill(0),e.defaultValue=i;let o=n;r?o=5126:!o&&e.isIndexed?o=t&&Qo(t,Yo.ELEMENT_INDEX_UINT32)?5125:5123:o||(o=5126),e.logicalType=n,e.type=o;let s=vv(n||o||5126);this.shaderAttributes={},this.doublePrecision=r,r&&!1===e.fp64&&(s=Float32Array),e.bytesPerElement=s.BYTES_PER_ELEMENT,this.defaultType=s,this.value=null,this.settings=e,this.state={externalBuffer:null,bufferAccessor:e,allocatedValue:null,constant:!1},this._buffer=null,this.setData(e)}get buffer(){if(!this._buffer){const{isIndexed:t,type:e}=this.settings;this._buffer=new co(this.gl,{id:this.id,target:t?34963:34962,accessor:{type:e}})}return this._buffer}get byteOffset(){const t=this.getAccessor();return t.vertexOffset?t.vertexOffset*bv(t):0}delete(){this._buffer&&(this._buffer.delete(),this._buffer=null),nl.release(this.state.allocatedValue)}getShaderAttributes(t,e){if(this.doublePrecision){const n={},r=this.value instanceof Float64Array,i=wv(this.getAccessor(),e||{});return n[t]=new yv(this,i.high),n["".concat(t,"64Low")]=r?new yv(this,i.low):new Float32Array(this.size),n}if(e){const n=_v(this.getAccessor(),e);return{[t]:new yv(this,n)}}return{[t]:this}}getBuffer(){return this.state.constant?null:this.state.externalBuffer||this._buffer}getValue(){return this.state.constant?this.value:[this.getBuffer(),this.getAccessor()]}getAccessor(){return this.state.bufferAccessor}setData(t){const{state:e}=this;ArrayBuffer.isView(t)?t={value:t}:t instanceof co&&(t={buffer:t});const n={...this.settings,...t};if(e.bufferAccessor=n,t.constant){let n=t.value;n=this._normalizeValue(n,[],0),this.settings.normalized&&(n=this._normalizeConstant(n));const r=!e.constant||!this._areValuesEqual(n,this.value);if(!r)return!1;e.externalBuffer=null,e.constant=!0,this.value=n}else if(t.buffer){const r=t.buffer;e.externalBuffer=r,e.constant=!1,this.value=t.value;const i=t.value instanceof Float64Array;n.type=t.type||r.accessor.type,n.bytesPerElement=r.accessor.BYTES_PER_ELEMENT*(i?2:1),n.stride=bv(n)}else if(t.value){this._checkExternalBuffer(t);let r=t.value;e.externalBuffer=null,e.constant=!1,this.value=r,n.bytesPerElement=r.BYTES_PER_ELEMENT,n.stride=bv(n);const{buffer:i,byteOffset:o}=this;this.doublePrecision&&r instanceof Float64Array&&(r=hl(r,n));const s=r.byteLength+o+2*n.stride;i.byteLength<s&&i.reallocate(s),i.setAccessor(null),i.subData({data:r,offset:o}),n.type=t.type||i.accessor.type}return!0}updateSubBuffer(t={}){const{value:e}=this,{startOffset:n=0,endOffset:r}=t;this.buffer.subData({data:this.doublePrecision&&e instanceof Float64Array?hl(e,{size:this.size,startIndex:n,endIndex:r}):e.subarray(n,r),offset:n*e.BYTES_PER_ELEMENT+this.byteOffset})}allocate({numInstances:t,copy:e=!1}){const{state:n}=this,r=n.allocatedValue,i=nl.allocate(r,t+1,{size:this.size,type:this.defaultType,copy:e});this.value=i;const{buffer:o,byteOffset:s}=this;return o.byteLength<i.byteLength+s&&(o.reallocate(i.byteLength+s),e&&r&&o.subData({data:r instanceof Float64Array?hl(r,this):r,offset:s})),n.allocatedValue=i,n.constant=!1,n.externalBuffer=null,n.bufferAccessor=this.settings,!0}_checkExternalBuffer(t){const{value:e}=t;if(!t.constant&&e){const n=this.defaultType;let r=!1;if(this.doublePrecision&&(r=e.BYTES_PER_ELEMENT<4),r)throw new Error("Attribute ".concat(this.id," does not support ").concat(e.constructor.name));e instanceof n||!this.settings.normalized||"normalized"in t||vn.warn("Attribute ".concat(this.id," is normalized"))()}}_normalizeConstant(t){switch(this.settings.type){case 5120:return new Float32Array(t).map(t=>(t+128)/255*2-1);case 5122:return new Float32Array(t).map(t=>(t+32768)/65535*2-1);case 5121:return new Float32Array(t).map(t=>t/255);case 5123:return new Float32Array(t).map(t=>t/65535);default:return t}}_normalizeValue(t,e,n){const{defaultValue:r,size:i}=this.settings;if(Number.isFinite(t))return e[n]=t,e;if(!t)return e[n]=r[0],e;switch(i){case 4:e[n+3]=Number.isFinite(t[3])?t[3]:r[3];case 3:e[n+2]=Number.isFinite(t[2])?t[2]:r[2];case 2:e[n+1]=Number.isFinite(t[1])?t[1]:r[1];case 1:e[n+0]=Number.isFinite(t[0])?t[0]:r[0];break;default:let o=i;while(--o>=0)e[n+o]=Number.isFinite(t[o])?t[o]:r[o]}return e}_areValuesEqual(t,e){if(!t||!e)return!1;const{size:n}=this;for(let r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}}const Sv=[],Ev=[];function Av(t,e=0,n=1/0){let r=Sv;const i={index:-1,data:t,target:[]};return t?"function"===typeof t[Symbol.iterator]?r=t:t.length>0&&(Ev.length=t.length,r=Ev):r=Sv,(e>0||Number.isFinite(n))&&(r=(Array.isArray(r)?r:Array.from(r)).slice(e,n),i.index=e-1),{iterable:r,objectInfo:i}}function Mv(t){return t&&t[Symbol.asyncIterator]}function Cv(t,{size:e,stride:n,offset:r,startIndices:i,nested:o}){const s=t.BYTES_PER_ELEMENT,a=n?n/s:e,u=r?r/s:0,c=Math.floor((t.length-u)/a);return(n,{index:r,target:s})=>{if(!i){const n=r*a+u;for(let r=0;r<e;r++)s[r]=t[n+r];return s}const l=i[r],h=i[r+1]||c;let f;if(o){f=new Array(h-l);for(let n=l;n<h;n++){const r=n*a+u;s=new Array(e);for(let n=0;n<e;n++)s[n]=t[r+n];f[n-l]=s}}else if(a===e)f=t.subarray(l*e+u,h*e+u);else{f=new t.constructor((h-l)*e);let n=0;for(let r=l;r<h;r++){const i=r*a+u;for(let r=0;r<e;r++)f[n++]=t[i+r]}}return f}}const kv=[],Ov=[[0,1/0]];function Pv(t,e){if(t===Ov)return t;if(e[0]<0&&(e[0]=0),e[0]>=e[1])return t;const n=[],r=t.length;let i=0;for(let o=0;o<r;o++){const r=t[o];r[1]<e[0]?(n.push(r),i=o+1):r[0]>e[1]?n.push(r):e=[Math.min(r[0],e[0]),Math.max(r[1],e[1])]}return n.splice(i,0,e),n}function Tv({source:t,target:e,start:n=0,end:r,size:i,getData:o}){r=r||e.length;const s=t.length,a=r-n;if(s>a)return void e.set(t.subarray(0,a),n);if(e.set(t,n),!o)return;let u=s;while(u<a){const r=o(u,t);for(let t=0;t<i;t++)e[n+u]=r[t]||0,u++}}function Lv({source:t,target:e,size:n,getData:r,sourceStartIndices:i,targetStartIndices:o}){if(!Array.isArray(o))return Tv({source:t,target:e,size:n,getData:r}),e;let s=0,a=0;const u=r&&((t,e)=>r(t+a,e)),c=Math.min(i.length,o.length);for(let l=1;l<c;l++){const r=i[l]*n,c=o[l]*n;Tv({source:t.subarray(s,r),target:e,start:a,end:c,size:n,getData:u}),s=r,a=c}return a<e.length&&Tv({source:[],target:e,start:a,size:n,getData:u}),e}const Iv={interpolation:{duration:0,easing:t=>t},spring:{stiffness:.05,damping:.5}};function Nv(t,e){return t?(Number.isFinite(t)&&(t={duration:t}),t.type=t.type||"interpolation",{...Iv[t.type],...e,...t}):null}function Dv(t,e){const n=e.getBuffer();return n?[e.getBuffer(),{divisor:0,size:e.size,normalized:e.settings.normalized}]:e.value}function Rv(t){switch(t){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4";default:throw new Error('No defined attribute type for size "'.concat(t,'"'))}}function Fv(t){t.push(t.shift())}function Bv(t,e){const{doublePrecision:n,settings:r,value:i,size:o}=t,s=n&&i instanceof Float64Array?2:1;return(r.noAlloc?i.length:e*o)*s}function jv({buffer:t,numInstances:e,attribute:n,fromLength:r,fromStartIndices:i,getData:o=(t=>t)}){const s=n.doublePrecision&&n.value instanceof Float64Array?2:1,a=n.size*s,u=n.byteOffset,c=n.startIndices,l=i&&c,h=Bv(n,e),f=n.state.constant;if(!l&&r>=h)return;const d=f?n.value:n.getBuffer().getData({srcByteOffset:u});if(n.settings.normalized&&!f){const t=o;o=(e,r)=>n._normalizeConstant(t(e,r))}const p=f?(t,e)=>o(d,e):(t,e)=>o(d.subarray(t,t+a),e),g=t.getData({length:r}),m=new Float32Array(h);Lv({source:g,target:m,sourceStartIndices:i,targetStartIndices:c,size:a,getData:p}),t.byteLength<m.byteLength+u&&t.reallocate(m.byteLength+u),t.subData({data:m,offset:u})}class zv extends xv{constructor(t,e={}){super(t,e);const{transition:n=!1,noAlloc:r=!1,update:i=null,accessor:o=null,transform:s=null,startIndices:a=null}=e;Object.assign(this.settings,{transition:n,noAlloc:r,update:i||o&&this._autoUpdater,accessor:o,transform:s}),Object.assign(this.state,{lastExternalBuffer:null,binaryValue:null,binaryAccessor:null,needsUpdate:!0,needsRedraw:!1,updateRanges:Ov,startIndices:a}),Object.seal(this.settings),Object.seal(this.state),this._validateAttributeUpdaters()}get startIndices(){return this.state.startIndices}set startIndices(t){this.state.startIndices=t}needsUpdate(){return this.state.needsUpdate}needsRedraw({clearChangedFlags:t=!1}={}){const e=this.state.needsRedraw;return this.state.needsRedraw=e&&!t,e}getUpdateTriggers(){const{accessor:t}=this.settings;return[this.id].concat("function"!==typeof t&&t||[])}supportsTransition(){return Boolean(this.settings.transition)}getTransitionSetting(t){if(!t||!this.supportsTransition())return null;const{accessor:e}=this.settings,n=this.settings.transition,r=Array.isArray(e)?t[e.find(e=>t[e])]:t[e];return Nv(r,n)}setNeedsUpdate(t=this.id,e){if(this.state.needsUpdate=this.state.needsUpdate||t,this.setNeedsRedraw(t),e){const{startRow:t=0,endRow:n=1/0}=e;this.state.updateRanges=Pv(this.state.updateRanges,[t,n])}else this.state.updateRanges=Ov}clearNeedsUpdate(){this.state.needsUpdate=!1,this.state.updateRanges=kv}setNeedsRedraw(t=this.id){this.state.needsRedraw=this.state.needsRedraw||t}update(t){this.setData(t)}allocate(t){const{state:e,settings:n}=this;return!n.noAlloc&&(!!n.update&&(super.allocate({numInstances:t,copy:e.updateRanges!==Ov}),!0))}updateBuffer({numInstances:t,data:e,props:n,context:r}){if(!this.needsUpdate())return!1;const{state:{updateRanges:i},settings:{update:o,noAlloc:s}}=this;let a=!0;if(o){for(const[s,a]of i)o.call(r,this,{data:e,startRow:s,endRow:a,props:n,numInstances:t});if(this.value)if(this.constant||this.buffer.byteLength<this.value.byteLength+this.byteOffset)this.setData({value:this.value,constant:this.constant}),this.constant=!1;else for(const[e,n]of i){const r=Number.isFinite(e)?this.getVertexOffset(e):0,i=Number.isFinite(n)?this.getVertexOffset(n):s||!Number.isFinite(t)?this.value.length:t*this.size;super.updateSubBuffer({startOffset:r,endOffset:i})}else;this._checkAttributeArray()}else a=!1;return this.clearNeedsUpdate(),this.setNeedsRedraw(),a}setConstantValue(t){if(void 0===t||"function"===typeof t)return!1;const e=this.setData({constant:!0,value:t});return e&&this.setNeedsRedraw(),this.clearNeedsUpdate(),!0}setExternalBuffer(t){const{state:e}=this;return t?(this.clearNeedsUpdate(),e.lastExternalBuffer===t||(e.lastExternalBuffer=t,this.setNeedsRedraw(),this.setData(t),!0)):(e.lastExternalBuffer=null,!1)}setBinaryValue(t,e=null){const{state:n,settings:r}=this;if(!t)return n.binaryValue=null,n.binaryAccessor=null,!1;if(r.noAlloc)return!1;if(n.binaryValue===t)return this.clearNeedsUpdate(),!0;n.binaryValue=t,this.setNeedsRedraw(),ArrayBuffer.isView(t)&&(t={value:t});const i=r.transform||e!==this.startIndices;if(i){fg(ArrayBuffer.isView(t.value),"invalid ".concat(r.accessor));const i=t.size&&t.size!==this.size;return n.binaryAccessor=Cv(t.value,{size:t.size||this.size,stride:t.stride,offset:t.offset,startIndices:e,nested:i}),!1}return this.clearNeedsUpdate(),this.setData(t),!0}getVertexOffset(t){const{startIndices:e}=this,n=e?e[t]:t;return n*this.size}getShaderAttributes(){const t=this.settings.shaderAttributes||{[this.id]:null},e={};for(const n in t)Object.assign(e,super.getShaderAttributes(n,t[n]));return e}_autoUpdater(t,{data:e,startRow:n,endRow:r,props:i,numInstances:o}){if(t.constant)return;const{settings:s,state:a,value:u,size:c,startIndices:l}=t,{accessor:h,transform:f}=s,d=a.binaryAccessor||("function"===typeof h?h:i[h]);fg("function"===typeof d,'accessor "'.concat(h,'" is not a function'));let p=t.getVertexOffset(n);const{iterable:g,objectInfo:m}=Av(e,n,r);for(const y of g){m.index++;let e=d(y,m);if(f&&(e=f.call(this,e)),l){const n=(m.index<l.length-1?l[m.index+1]:o)-l[m.index];if(e&&Array.isArray(e[0])){let n=p;for(const r of e)t._normalizeValue(r,u,n),n+=c}else e&&e.length>c?u.set(e,p):(t._normalizeValue(e,m.target,0),yf({target:u,source:m.target,start:p,count:n}));p+=n*c}else t._normalizeValue(e,u,p),p+=c}}_validateAttributeUpdaters(){const{settings:t}=this,e=t.noAlloc||"function"===typeof t.update;if(!e)throw new Error("Attribute ".concat(this.id," missing update or accessor"))}_checkAttributeArray(){const{value:t}=this,e=Math.min(4,this.size);if(t&&t.length>=e){let n=!0;switch(e){case 4:n=n&&Number.isFinite(t[3]);case 3:n=n&&Number.isFinite(t[2]);case 2:n=n&&Number.isFinite(t[1]);case 1:n=n&&Number.isFinite(t[0]);break;default:n=!1}if(!n)throw new Error("Illegal attribute generated for ".concat(this.id))}}}const Uv="void main() {gl_FragColor = vec4(0);}",$v="out vec4 transform_output;\nvoid main() {\n  transform_output = vec4(0);\n}",Vv=`#version 300 es\n${$v}`;function qv(t,e){e=Array.isArray(e)?e:[e];const n=t.replace(/^\s+/,"").split(/\s+/),[r,i,o]=n;if(!e.includes(r)||!i||!o)return null;const s=o.split(";")[0];return{qualifier:r,type:i,name:s}}function Wv(t={}){const{version:e=100,input:n,inputType:r,output:i}=t;if(!n)return 300===e?Vv:e>300?`#version ${e}\n${$v}`:Uv;const o=Xv(n,r);return e>=300?`#version ${e} ${300===e?"es":""}\nin ${r} ${n};\nout vec4 ${i};\nvoid main() {\n  ${i} = ${o};\n}`:`varying ${r} ${n};\nvoid main() {\n  gl_FragColor = ${o};\n}`}function Gv(t){switch(t){case"float":return"x";case"vec2":return"xy";case"vec3":return"xyz";case"vec4":return"xyzw";default:return An(!1),null}}function Hv(t){switch(t){case"float":return 1;case"vec2":return 2;case"vec3":return 3;case"vec4":return 4;default:return An(!1),null}}function Xv(t,e){switch(e){case"float":return`vec4(${t}, 0.0, 0.0, 1.0)`;case"vec2":return`vec4(${t}, 0.0, 1.0)`;case"vec3":return`vec4(${t}, 1.0)`;case"vec4":return t;default:return An(!1),null}}class Yv{constructor(t,e={}){this.gl=t,this.currentIndex=0,this.feedbackMap={},this.varyings=null,this.bindings=[],this.resources={},this._initialize(e),Object.seal(this)}setupResources(t){for(const e of this.bindings)this._setupTransformFeedback(e,t)}updateModelProps(t={}){const{varyings:e}=this;return e.length>0&&(t=Object.assign({},t,{varyings:e})),t}getDrawOptions(t={}){const e=this.bindings[this.currentIndex],{sourceBuffers:n,transformFeedback:r}=e,i=Object.assign({},n,t.attributes);return{attributes:i,transformFeedback:r}}swap(){return!!this.feedbackMap&&(this.currentIndex=this._getNextIndex(),!0)}update(t={}){this._setupBuffers(t)}getBuffer(t){const{feedbackBuffers:e}=this.bindings[this.currentIndex],n=t?e[t]:null;return n?n instanceof co?n:n.buffer:null}getData(t={}){const{varyingName:e}=t,n=this.getBuffer(e);return n?n.getData():null}delete(){for(const t in this.resources)this.resources[t].delete()}_initialize(t={}){this._setupBuffers(t),this.varyings=t.varyings||Object.keys(this.bindings[this.currentIndex].feedbackBuffers),this.varyings.length>0&&zi(Object(ci["e"])(this.gl))}_getFeedbackBuffers(t){const{sourceBuffers:e={}}=t,n={};if(this.bindings[this.currentIndex]&&Object.assign(n,this.bindings[this.currentIndex].feedbackBuffers),this.feedbackMap)for(const r in this.feedbackMap){const t=this.feedbackMap[r];r in e&&(n[t]=r)}Object.assign(n,t.feedbackBuffers);for(const r in n){const t=n[r];if("string"===typeof t){const i=e[t],{byteLength:o,usage:s,accessor:a}=i;n[r]=this._createNewBuffer(r,{byteLength:o,usage:s,accessor:a})}}return n}_setupBuffers(t={}){const{sourceBuffers:e=null}=t;Object.assign(this.feedbackMap,t.feedbackMap);const n=this._getFeedbackBuffers(t);this._updateBindings({sourceBuffers:e,feedbackBuffers:n})}_setupTransformFeedback(t,{model:e}){const{program:n}=e;t.transformFeedback=new kh(this.gl,{program:n,buffers:t.feedbackBuffers})}_updateBindings(t){if(this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],t),this.feedbackMap){const{sourceBuffers:t,feedbackBuffers:e}=this._swapBuffers(this.bindings[this.currentIndex]),n=this._getNextIndex();this.bindings[n]=this._updateBinding(this.bindings[n],{sourceBuffers:t,feedbackBuffers:e})}}_updateBinding(t,e){return t?(Object.assign(t.sourceBuffers,e.sourceBuffers),Object.assign(t.feedbackBuffers,e.feedbackBuffers),t.transformFeedback&&t.transformFeedback.setBuffers(t.feedbackBuffers),t):{sourceBuffers:Object.assign({},e.sourceBuffers),feedbackBuffers:Object.assign({},e.feedbackBuffers)}}_swapBuffers(t){if(!this.feedbackMap)return null;const e=Object.assign({},t.sourceBuffers),n=Object.assign({},t.feedbackBuffers);for(const r in this.feedbackMap){const i=this.feedbackMap[r];e[r]=t.feedbackBuffers[i],n[i]=t.sourceBuffers[r],zi(n[i]instanceof co)}return{sourceBuffers:e,feedbackBuffers:n}}_createNewBuffer(t,e){const n=new co(this.gl,e);return this.resources[t]&&this.resources[t].delete(),this.resources[t]=n,n}_getNextIndex(){return(this.currentIndex+1)%2}}function Zv(t){let e=100;const n=t.match(/[^\s]+/g);if(n.length>=2&&"#version"===n[0]){const t=parseInt(n[1],10);Number.isFinite(t)&&(e=t)}return e}const Kv="attribute float transform_elementID;\nvec2 transform_getPixelSizeHalf(vec2 size) {\n  return vec2(1.) / (2. * size);\n}\n\nvec2 transform_getPixelIndices(vec2 texSize, vec2 pixelSizeHalf) {\n  float yIndex = floor((transform_elementID / texSize[0]) + pixelSizeHalf[1]);\n  float xIndex = transform_elementID - (yIndex * texSize[0]);\n  return vec2(xIndex, yIndex);\n}\nvec2 transform_getTexCoord(vec2 size) {\n  vec2 pixelSizeHalf = transform_getPixelSizeHalf(size);\n  vec2 indices = transform_getPixelIndices(size, pixelSizeHalf);\n  vec2 coord = indices / size + pixelSizeHalf;\n  return coord;\n}\nvec2 transform_getPos(vec2 size) {\n  vec2 texCoord = transform_getTexCoord(size);\n  vec2 pos = (texCoord * (2.0, 2.0)) - (1., 1.);\n  return pos;\n}\nvec4 transform_getInput(sampler2D texSampler, vec2 size) {\n  vec2 texCoord = transform_getTexCoord(size);\n  vec4 textureColor = texture2D(texSampler, texCoord);\n  return textureColor;\n}\n",Jv={name:"transform",vs:Kv,fs:null},Qv="transform_uSampler_",tb="transform_uSize_",eb="transform_position";function nb({vs:t,sourceTextureMap:e,targetTextureVarying:n,targetTexture:r}){const i=Object.keys(e);let o=i.length,s=null;const a={};let u=t,c={};if(o>0||n){const t=u.split("\n"),i=t.slice();if(t.forEach((t,r,u)=>{if(o>0){const n=ab(t,e);if(n){const{updatedLine:t,inject:e}=n;i[r]=t,c=cr([c,e]),Object.assign(a,n.samplerTextureMap),o--}}n&&!s&&(s=sb(t,n))}),n){zi(r);const t=`${tb}${n}`,e=`uniform vec2 ${t};\n`,i=`     vec2 ${eb} = transform_getPos(${t});\n     gl_Position = vec4(${eb}, 0, 1.);\n`,o={"vs:#decl":e,"vs:#main-start":i};c=cr([c,o])}u=i.join("\n")}return{vs:u,targetTextureType:s,inject:c,samplerTextureMap:a}}function rb({sourceTextureMap:t,targetTextureVarying:e,targetTexture:n}){const r={};let i,o;e&&(({width:i,height:o}=n),r[`${tb}${e}`]=[i,o]);for(const s in t)({width:i,height:o}=t[s]),r[`${tb}${s}`]=[i,o];return r}function ib(t){return qv(t,["attribute","in"])}function ob(t){const e=`${Qv}${t}`,n=`${tb}${t}`,r=`  uniform sampler2D ${e};\n  uniform vec2 ${n};`;return{samplerName:e,sizeName:n,uniformDeclerations:r}}function sb(t,e){const n=qv(t,["varying","out"]);return n&&n.name===e?n.type:null}function ab(t,e){const n={},r=ib(t);if(!r)return null;const{type:i,name:o}=r;if(o&&e[o]){const e=`// ${t} => Replaced by Transform with a sampler`,{samplerName:r,sizeName:s,uniformDeclerations:a}=ob(o),u=Gv(i),c=`  ${i} ${o} = transform_getInput(${r}, ${s}).${u};\n`;n[r]=o;const l={"vs:#decl":a,"vs:#main-start":c};return{updatedLine:e,inject:l,samplerTextureMap:n}}return null}const ub={[10241]:9728,[10240]:9728,[10242]:33071,[10243]:33071},cb="transform_output";class lb{constructor(t,e={}){this.gl=t,this.id=this.currentIndex=0,this._swapTexture=null,this.targetTextureVarying=null,this.targetTextureType=null,this.samplerTextureMap=null,this.bindings=[],this.resources={},this._initialize(e),Object.seal(this)}updateModelProps(t={}){const e=this._processVertexShader(t);return Object.assign({},t,e)}getDrawOptions(t={}){const{sourceBuffers:e,sourceTextures:n,framebuffer:r,targetTexture:i}=this.bindings[this.currentIndex],o=Object.assign({},e,t.attributes),s=Object.assign({},t.uniforms),a=Object.assign({},t.parameters);let u=t.discard;if(this.hasSourceTextures||this.hasTargetTexture){o.transform_elementID=this.elementIDBuffer;for(const e in this.samplerTextureMap){const t=this.samplerTextureMap[e];s[e]=n[t]}this._setSourceTextureParameters();const t=rb({sourceTextureMap:n,targetTextureVarying:this.targetTextureVarying,targetTexture:i});Object.assign(s,t)}return this.hasTargetTexture&&(u=!1,a.viewport=[0,0,r.width,r.height]),{attributes:o,framebuffer:r,uniforms:s,discard:u,parameters:a}}swap(){return!!this._swapTexture&&(this.currentIndex=this._getNextIndex(),!0)}update(t={}){this._setupTextures(t)}getTargetTexture(){const{targetTexture:t}=this.bindings[this.currentIndex];return t}getData({packed:t=!1}={}){const{framebuffer:e}=this.bindings[this.currentIndex],n=Vo(e);if(!t)return n;const r=n.constructor,i=Hv(this.targetTextureType),o=new r(n.length*i/4);let s=0;for(let a=0;a<n.length;a+=4)for(let t=0;t<i;t++)o[s++]=n[a+t];return o}getFramebuffer(){const t=this.bindings[this.currentIndex];return t.framebuffer}delete(){this.ownTexture&&this.ownTexture.delete(),this.elementIDBuffer&&this.elementIDBuffer.delete()}_initialize(t={}){const{_targetTextureVarying:e,_swapTexture:n}=t;this._swapTexture=n,this.targetTextureVarying=e,this.hasTargetTexture=e,this._setupTextures(t)}_createTargetTexture(t){const{sourceTextures:e,textureOrReference:n}=t;if(n instanceof wo)return n;const r=e[n];return r?(this._targetRefTexName=n,this._createNewTexture(r)):null}_setupTextures(t={}){const{sourceBuffers:e,_sourceTextures:n={},_targetTexture:r}=t,i=this._createTargetTexture({sourceTextures:n,textureOrReference:r});this.hasSourceTextures=this.hasSourceTextures||n&&Object.keys(n).length>0,this._updateBindings({sourceBuffers:e,sourceTextures:n,targetTexture:i}),"elementCount"in t&&this._updateElementIDBuffer(t.elementCount)}_updateElementIDBuffer(t){if("number"!==typeof t||this.elementCount>=t)return;const e=new Float32Array(t);e.forEach((t,e,n)=>{n[e]=e}),this.elementIDBuffer?this.elementIDBuffer.setData({data:e}):this.elementIDBuffer=new co(this.gl,{data:e,accessor:{size:1}}),this.elementCount=t}_updateBindings(t){if(this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],t),this._swapTexture){const{sourceTextures:t,targetTexture:e}=this._swapTextures(this.bindings[this.currentIndex]),n=this._getNextIndex();this.bindings[n]=this._updateBinding(this.bindings[n],{sourceTextures:t,targetTexture:e})}}_updateBinding(t,e){const{sourceBuffers:n,sourceTextures:r,targetTexture:i}=e;if(t||(t={sourceBuffers:{},sourceTextures:{},targetTexture:null}),Object.assign(t.sourceTextures,r),Object.assign(t.sourceBuffers,n),i){t.targetTexture=i;const{width:e,height:n}=i,{framebuffer:r}=t;r?(r.update({attachments:{[36064]:i},resizeAttachments:!1}),r.resize({width:e,height:n})):t.framebuffer=new os(this.gl,{id:"transform-framebuffer",width:e,height:n,attachments:{[36064]:i}})}return t}_setSourceTextureParameters(){const t=this.currentIndex,{sourceTextures:e}=this.bindings[t];for(const n in e)e[n].setParameters(ub)}_swapTextures(t){if(!this._swapTexture)return null;const e=Object.assign({},t.sourceTextures);e[this._swapTexture]=t.targetTexture;const n=t.sourceTextures[this._swapTexture];return{sourceTextures:e,targetTexture:n}}_createNewTexture(t){const e=Uo(t,{parameters:{[10241]:9728,[10240]:9728,[10242]:33071,[10243]:33071},pixelStore:{[37440]:!1}});return this.ownTexture&&this.ownTexture.delete(),this.ownTexture=e,e}_getNextIndex(){return(this.currentIndex+1)%2}_processVertexShader(t={}){const{sourceTextures:e,targetTexture:n}=this.bindings[this.currentIndex],{vs:r,uniforms:i,targetTextureType:o,inject:s,samplerTextureMap:a}=nb({vs:t.vs,sourceTextureMap:e,targetTextureVarying:this.targetTextureVarying,targetTexture:n}),u=cr([t.inject||{},s]);this.targetTextureType=o,this.samplerTextureMap=a;const c=t._fs||Wv({version:Zv(r),input:this.targetTextureVarying,inputType:o,output:cb}),l=this.hasSourceTextures||this.targetTextureVarying?[Jv].concat(t.modules||[]):t.modules;return{vs:r,fs:c,modules:l,uniforms:i,inject:u}}}class hb{static isSupported(t){return Object(ci["e"])(t)}constructor(t,e={}){this.gl=t,this.model=null,this.elementCount=0,this.bufferTransform=null,this.textureTransform=null,this.elementIDBuffer=null,this._initialize(e),Object.seal(this)}delete(){const{model:t,bufferTransform:e,textureTransform:n}=this;t&&t.delete(),e&&e.delete(),n&&n.delete()}run(t={}){const{clearRenderTarget:e=!0}=t,n=this._updateDrawOptions(t);e&&n.framebuffer&&n.framebuffer.clear({color:!0}),this.model.transform(n)}swap(){let t=!1;const e=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const n of e)t=t||n.swap();zi(t,"Nothing to swap")}getBuffer(t=null){return this.bufferTransform&&this.bufferTransform.getBuffer(t)}getData(t={}){const e=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const n of e){const e=n.getData(t);if(e)return e}return null}getFramebuffer(){return this.textureTransform&&this.textureTransform.getFramebuffer()}update(t={}){"elementCount"in t&&this.model.setVertexCount(t.elementCount);const e=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const n of e)n.update(t)}_initialize(t={}){const{gl:e}=this;this._buildResourceTransforms(e,t),t=this._updateModelProps(t),this.model=new Xh(e,Object.assign({},t,{fs:t.fs||Wv({version:Zv(t.vs)}),id:t.id||"transform-model",drawMode:t.drawMode||0,vertexCount:t.elementCount})),this.bufferTransform&&this.bufferTransform.setupResources({model:this.model})}_updateModelProps(t){let e=Object.assign({},t);const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const r of n)e=r.updateModelProps(e);return e}_buildResourceTransforms(t,e){fb(e)&&(this.bufferTransform=new Yv(t,e)),db(e)&&(this.textureTransform=new lb(t,e)),zi(this.bufferTransform||this.textureTransform,"must provide source/feedback buffers or source/target textures")}_updateDrawOptions(t){let e=Object.assign({},t);const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const r of n)e=Object.assign(e,r.getDrawOptions(e));return e}}function fb(t){return!(Gi(t.feedbackBuffers)&&Gi(t.feedbackMap)&&!(t.varyings&&t.varyings.length>0))}function db(t){return!(Gi(t._sourceTextures)&&!t._targetTexture&&!t._targetTextureVarying)}class pb{constructor({gl:t,attribute:e,timeline:n}){this.gl=t,this.type="interpolation",this.transition=new mg(n),this.attribute=e,this.attributeInTransition=new zv(t,e.settings),this.currentStartIndices=e.startIndices,this.currentLength=0,this.transform=mb(t,e);const r={byteLength:0,usage:35050};this.buffers=[new co(t,r),new co(t,r)]}get inProgress(){return this.transition.inProgress}start(t,e){if(t.duration<=0)return void this.transition.cancel();const{gl:n,buffers:r,attribute:i}=this;Fv(r);const o={numInstances:e,attribute:i,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:t.enter};for(const s of r)jv({buffer:s,...o});this.currentStartIndices=i.startIndices,this.currentLength=Bv(i,e),this.attributeInTransition.update({buffer:r[1],value:i.value}),this.transition.start(t),this.transform.update({elementCount:Math.floor(this.currentLength/i.size),sourceBuffers:{aFrom:r[0],aTo:Dv(n,i)},feedbackBuffers:{vCurrent:r[1]}})}update(){const t=this.transition.update();if(t){const{time:t,settings:{duration:e,easing:n}}=this.transition,r=n(t/e);this.transform.run({uniforms:{time:r}})}return t}cancel(){this.transition.cancel(),this.transform.delete();while(this.buffers.length)this.buffers.pop().delete()}}const gb="\n#define SHADER_NAME interpolation-transition-vertex-shader\n\nuniform float time;\nattribute ATTRIBUTE_TYPE aFrom;\nattribute ATTRIBUTE_TYPE aTo;\nvarying ATTRIBUTE_TYPE vCurrent;\n\nvoid main(void) {\n  vCurrent = mix(aFrom, aTo, time);\n  gl_Position = vec4(0.0);\n}\n";function mb(t,e){const n=Rv(e.size);return new hb(t,{vs:gb,defines:{ATTRIBUTE_TYPE:n},varyings:["vCurrent"]})}class yb{constructor({gl:t,attribute:e,timeline:n}){this.gl=t,this.type="spring",this.transition=new mg(n),this.attribute=e,this.attributeInTransition=new zv(t,{...e.settings,normalized:!1}),this.currentStartIndices=e.startIndices,this.currentLength=0,this.texture=bb(t),this.framebuffer=_b(t,this.texture),this.transform=vb(t,e,this.framebuffer);const r={byteLength:0,usage:35050};this.buffers=[new co(t,r),new co(t,r),new co(t,r)]}get inProgress(){return this.transition.inProgress}start(t,e){const{gl:n,buffers:r,attribute:i}=this,o={numInstances:e,attribute:i,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:t.enter};for(const s of r)jv({buffer:s,...o});this.currentStartIndices=i.startIndices,this.currentLength=Bv(i,e),this.attributeInTransition.update({buffer:r[1],value:i.value}),this.transition.start(t),this.transform.update({elementCount:Math.floor(this.currentLength/i.size),sourceBuffers:{aTo:Dv(n,i)}})}update(){const{buffers:t,transform:e,framebuffer:n,transition:r}=this,i=r.update();if(!i)return!1;e.update({sourceBuffers:{aPrev:t[0],aCur:t[1]},feedbackBuffers:{vNext:t[2]}}),e.run({framebuffer:n,discard:!1,clearRenderTarget:!0,uniforms:{stiffness:r.settings.stiffness,damping:r.settings.damping},parameters:{depthTest:!1,blend:!0,viewport:[0,0,1,1],blendFunc:[1,1],blendEquation:[32776,32776]}}),Fv(t),this.attributeInTransition.update({buffer:t[1],value:this.attribute.value});const o=Vo(n)[0]>0;return o||r.end(),!0}cancel(){this.transition.cancel(),this.transform.delete();while(this.buffers.length)this.buffers.pop().delete();this.texture.delete(),this.texture=null,this.framebuffer.delete(),this.framebuffer=null}}function vb(t,e,n){const r=Rv(e.size);return new hb(t,{framebuffer:n,vs:"\n#define SHADER_NAME spring-transition-vertex-shader\n\n#define EPSILON 0.00001\n\nuniform float stiffness;\nuniform float damping;\nattribute ATTRIBUTE_TYPE aPrev;\nattribute ATTRIBUTE_TYPE aCur;\nattribute ATTRIBUTE_TYPE aTo;\nvarying ATTRIBUTE_TYPE vNext;\nvarying float vIsTransitioningFlag;\n\nATTRIBUTE_TYPE getNextValue(ATTRIBUTE_TYPE cur, ATTRIBUTE_TYPE prev, ATTRIBUTE_TYPE dest) {\n  ATTRIBUTE_TYPE velocity = cur - prev;\n  ATTRIBUTE_TYPE delta = dest - cur;\n  ATTRIBUTE_TYPE spring = delta * stiffness;\n  ATTRIBUTE_TYPE damper = velocity * -1.0 * damping;\n  return spring + damper + velocity + cur;\n}\n\nvoid main(void) {\n  bool isTransitioning = length(aCur - aPrev) > EPSILON || length(aTo - aCur) > EPSILON;\n  vIsTransitioningFlag = isTransitioning ? 1.0 : 0.0;\n\n  vNext = getNextValue(aCur, aPrev, aTo);\n  gl_Position = vec4(0, 0, 0, 1);\n  gl_PointSize = 100.0;\n}\n",fs:"\n#define SHADER_NAME spring-transition-is-transitioning-fragment-shader\n\nvarying float vIsTransitioningFlag;\n\nvoid main(void) {\n  if (vIsTransitioningFlag == 0.0) {\n    discard;\n  }\n  gl_FragColor = vec4(1.0);\n}",defines:{ATTRIBUTE_TYPE:r},varyings:["vNext"]})}function bb(t){return new wo(t,{data:new Uint8Array(4),format:6408,type:5121,border:0,mipmaps:!1,dataFormat:6408,width:1,height:1})}function _b(t,e){return new os(t,{id:"spring-transition-is-transitioning-framebuffer",width:1,height:1,attachments:{[36064]:e}})}const wb={interpolation:pb,spring:yb};class xb{constructor(t,{id:e,timeline:n}){this.id=e,this.gl=t,this.timeline=n,this.transitions={},this.needsRedraw=!1,this.numInstances=1,this.isSupported=hb.isSupported(t)}finalize(){for(const t in this.transitions)this._removeTransition(t)}update({attributes:t,transitions:e,numInstances:n}){this.numInstances=n||1;for(const r in t){const n=t[r],i=n.getTransitionSetting(e);i&&this._updateAttribute(r,n,i)}for(const r in this.transitions){const n=t[r];n&&n.getTransitionSetting(e)||this._removeTransition(r)}}hasAttribute(t){const e=this.transitions[t];return e&&e.inProgress}getAttributes(){const t={};for(const e in this.transitions){const n=this.transitions[e];n.inProgress&&(t[e]=n.attributeInTransition)}return t}run(){if(!this.isSupported||0===this.numInstances)return!1;for(const e in this.transitions){const t=this.transitions[e].update();t&&(this.needsRedraw=!0)}const t=this.needsRedraw;return this.needsRedraw=!1,t}_removeTransition(t){this.transitions[t].cancel(),delete this.transitions[t]}_updateAttribute(t,e,n){const r=this.transitions[t];let i=!r||r.type!==n.type;if(i){if(!this.isSupported)return void vn.warn("WebGL2 not supported by this browser. Transition for ".concat(t," is disabled."))();r&&this._removeTransition(t);const o=wb[n.type];o?this.transitions[t]=new o({attribute:e,timeline:this.timeline,gl:this.gl}):(vn.error("unsupported transition type '".concat(n.type,"'"))(),i=!1)}(i||e.needsRedraw())&&(this.needsRedraw=!0,this.transitions[t].start(n,this.numInstances))}}const Sb="attributeManager.invalidate",Eb="attributeManager.updateStart",Ab="attributeManager.updateEnd",Mb="attribute.updateStart",Cb="attribute.allocate",kb="attribute.updateEnd";class Ob{constructor(t,{id:e="attribute-manager",stats:n,timeline:r}={}){this.id=e,this.gl=t,this.attributes={},this.updateTriggers={},this.accessors={},this.needsRedraw=!0,this.userData={},this.stats=n,this.attributeTransitionManager=new xb(t,{id:"".concat(e,"-transitions"),timeline:r}),Object.seal(this)}finalize(){for(const t in this.attributes)this.attributes[t].delete();this.attributeTransitionManager.finalize()}getNeedsRedraw(t={clearRedrawFlags:!1}){const e=this.needsRedraw;return this.needsRedraw=this.needsRedraw&&!t.clearRedrawFlags,e&&this.id}setNeedsRedraw(t=!0){return this.needsRedraw=!0,this}add(t,e){this._add(t,e)}addInstanced(t,e){this._add(t,e,{instanced:1})}remove(t){for(let e=0;e<t.length;e++){const n=t[e];void 0!==this.attributes[n]&&(this.attributes[n].delete(),delete this.attributes[n])}}invalidate(t,e){const n=this._invalidateTrigger(t,e);pf(Sb,this,t,n)}invalidateAll(t){for(const e in this.attributes)this.attributes[e].setNeedsUpdate(e,t);pf(Sb,this,"all")}update({data:t,numInstances:e,startIndices:n=null,transitions:r,props:i={},buffers:o={},context:s={}}={}){let a=!1;pf(Eb,this),this.stats&&this.stats.get("Update Attributes").timeStart();for(const u in this.attributes){const r=this.attributes[u],c=r.settings.accessor;r.startIndices=n,i[u]&&vn.removed("props.".concat(u),"data.attributes.".concat(u))(),r.setExternalBuffer(o[u])||r.setBinaryValue(o[c],t.startIndices)||!o[c]&&r.setConstantValue(i[c])||r.needsUpdate()&&(a=!0,this._updateAttribute({attribute:r,numInstances:e,data:t,props:i,context:s})),this.needsRedraw|=r.needsRedraw()}a&&pf(Ab,this,e),this.stats&&this.stats.get("Update Attributes").timeEnd(),this.attributeTransitionManager.update({attributes:this.attributes,numInstances:e,transitions:r})}updateTransition(){const{attributeTransitionManager:t}=this,e=t.run();return this.needsRedraw=this.needsRedraw||e,e}getAttributes(){return this.attributes}getChangedAttributes(t={clearChangedFlags:!1}){const{attributes:e,attributeTransitionManager:n}=this,r={...n.getAttributes()};for(const i in e){const o=e[i];o.needsRedraw(t)&&!n.hasAttribute(i)&&(r[i]=o)}return r}getShaderAttributes(t,e={}){t||(t=this.getAttributes());const n={};for(const r in t)e[r]||Object.assign(n,t[r].getShaderAttributes());return n}getAccessors(){return this.updateTriggers}_add(t,e,n={}){e&&vn.warn("AttributeManager.add({updaters}) - updater map no longer supported")();for(const r in t){const e=t[r];this.attributes[r]=this._createAttribute(r,e,n)}this._mapUpdateTriggersToAttributes()}_createAttribute(t,e,n){const r={...e,id:t,isIndexed:e.isIndexed||e.elements||!1,constant:e.constant||!1,size:(e.elements?1:e.size)||1,value:e.value||null,divisor:e.instanced||n.instanced?1:e.divisor||0};return new zv(this.gl,r)}_mapUpdateTriggersToAttributes(){const t={};for(const e in this.attributes){const n=this.attributes[e];n.getUpdateTriggers().forEach(n=>{t[n]||(t[n]=[]),t[n].push(e)})}this.updateTriggers=t}_invalidateTrigger(t,e){const{attributes:n,updateTriggers:r}=this,i=r[t];return i&&i.forEach(t=>{const r=n[t];r&&r.setNeedsUpdate(r.id,e)}),i}_updateAttribute(t){const{attribute:e,numInstances:n}=t;if(pf(Mb,e),e.constant)return void e.setConstantValue(e.value);e.allocate(n)&&pf(Cb,e,n);const r=e.updateBuffer(t);r&&(this.needsRedraw=!0,pf(kb,e,n))}}class Pb extends mg{get value(){return this._value}_onUpdate(){const{time:t,settings:{fromValue:e,toValue:n,duration:r,easing:i}}=this,o=i(t/r);this._value=Object(Ra["f"])(e,n,o)}}const Tb=1e-5;function Lb(t,e,n,r,i){const o=e-t,s=n-e,a=s*i,u=-o*r;return a+u+o+e}function Ib(t,e,n,r,i){if(Array.isArray(n)){const o=[];for(let s=0;s<n.length;s++)o[s]=Lb(t[s],e[s],n[s],r,i);return o}return Lb(t,e,n,r,i)}function Nb(t,e){if(Array.isArray(t)){let n=0;for(let r=0;r<t.length;r++){const i=t[r]-e[r];n+=i*i}return Math.sqrt(n)}return Math.abs(t-e)}class Db extends mg{get value(){return this._currValue}_onUpdate(){const{fromValue:t,toValue:e,damping:n,stiffness:r}=this.settings,{_prevValue:i=t,_currValue:o=t}=this;let s=Ib(i,o,e,n,r);const a=Nb(s,e),u=Nb(s,o);a<Tb&&u<Tb&&(s=e,this.end()),this._prevValue=o,this._currValue=s}}const Rb={interpolation:Pb,spring:Db};class Fb{constructor(t){this.transitions=new Map,this.timeline=t}get active(){return this.transitions.size>0}add(t,e,n,r){const{transitions:i}=this;if(i.has(t)){const n=i.get(t),{value:r=n.settings.fromValue}=n;e=r,this.remove(t)}if(r=Nv(r),!r)return;const o=Rb[r.type];if(!o)return void vn.error("unsupported transition type '".concat(r.type,"'"))();const s=new o(this.timeline);s.start({...r,fromValue:e,toValue:n}),i.set(t,s)}remove(t){const{transitions:e}=this;e.has(t)&&(e.get(t).cancel(),e.delete(t))}update(){const t={};for(const[e,n]of this.transitions)n.update(),t[e]=n.value,n.inProgress||this.remove(e);return t}clear(){for(const t of this.transitions.keys())this.remove(t)}}const{COMPONENT:Bb}=hf;function jb(t){const e=Xb(t);for(const n in e){const r=e[n],{validate:i}=r;if(i&&!i(t[n],r))throw new Error("Invalid prop ".concat(n,": ").concat(t[n]))}}function zb(t,e){const n=$b({newProps:t,oldProps:e,propTypes:Xb(t),ignoreProps:{data:null,updateTriggers:null,extensions:null,transitions:null}}),r=qb(t,e);let i=!1;return r||(i=Wb(t,e)),{dataChanged:r,propsChanged:n,updateTriggersChanged:i,extensionsChanged:Gb(t,e),transitionsChanged:Ub(t,e)}}function Ub(t,e){if(!t.transitions)return null;const n={},r=Xb(t);for(const i in t.transitions){const o=r[i],s=o&&o.type,a="number"===s||"color"===s||"array"===s;a&&Vb(t[i],e[i],o)&&(n[i]=!0)}return n}function $b({newProps:t,oldProps:e,ignoreProps:n={},propTypes:r={},triggerName:i="props"}={}){if(e===t)return null;if("object"!==typeof t||null===t)return"".concat(i," changed shallowly");if("object"!==typeof e||null===e)return"".concat(i," changed shallowly");for(const o of Object.keys(t))if(!(o in n)){if(!(o in e))return"".concat(i,".").concat(o," added");const n=Vb(t[o],e[o],r[o]);if(n)return"".concat(i,".").concat(o," ").concat(n)}for(const o of Object.keys(e))if(!(o in n)){if(!(o in t))return"".concat(i,".").concat(o," dropped");if(!Object.hasOwnProperty.call(t,o)){const n=Vb(t[o],e[o],r[o]);if(n)return"".concat(i,".").concat(o," ").concat(n)}}return null}function Vb(t,e,n){let r=n&&n.equal;return r&&!r(t,e,n)?"changed deeply":r||(r=t&&e&&t.equals,!r||r.call(t,e))?r||e===t?null:"changed shallowly":"changed deeply"}function qb(t,e){if(null===e)return"oldProps is null, initial diff";let n=null;const{dataComparator:r,_dataDiff:i}=t;return r?r(t.data,e.data)||(n="Data comparator detected a change"):t.data!==e.data&&(n="A new data container was supplied"),n&&i&&(n=i(t.data,e.data)||n),n}function Wb(t,e){if(null===e)return"oldProps is null, initial diff";if("all"in t.updateTriggers){const n=Hb(t,e,"all");if(n)return{all:!0}}const n={};let r=!1;for(const i in t.updateTriggers)if("all"!==i){const o=Hb(t,e,i);o&&(n[i]=!0,r=n)}return r}function Gb(t,e){if(null===e)return"oldProps is null, initial diff";const n=e.extensions,{extensions:r}=t;if(r===n)return!1;if(r.length!==n.length)return!0;for(let i=0;i<r.length;i++)if(!r[i].equals(n[i]))return!0;return!1}function Hb(t,e,n){let r=t.updateTriggers[n];r=void 0===r||null===r?{}:r;let i=e.updateTriggers[n];i=void 0===i||null===i?{}:i;const o=$b({oldProps:i,newProps:r,triggerName:n});return o}function Xb(t){const e=t[Bb],n=e&&e.constructor;return n?n._propTypes:{}}const Yb="count(): argument not an object",Zb="count(): argument not a container";function Kb(t){if(!Qb(t))throw new Error(Yb);if("function"===typeof t.count)return t.count();if(Number.isFinite(t.size))return t.size;if(Number.isFinite(t.length))return t.length;if(Jb(t))return Object.keys(t).length;throw new Error(Zb)}function Jb(t){return null!==t&&"object"===typeof t&&t.constructor===Object}function Qb(t){return null!==t&&"object"===typeof t}function t_(t,e){if(!e)return t;const n={...t,...e};if("defines"in e&&(n.defines={...t.defines,...e.defines}),"modules"in e&&(n.modules=(t.modules||[]).concat(e.modules),e.modules.some(t=>"project64"===t.name))){const t=n.modules.findIndex(t=>"project32"===t.name);t>=0&&n.modules.splice(t,1)}if("inject"in e)if(t.inject){const r={...t.inject};for(const t in e.inject)r[t]=(r[t]||"")+e.inject[t];n.inject=r}else n.inject=e.inject;return n}const e_={[10241]:9987,[10240]:9729,[10242]:33071,[10243]:33071},n_={};function r_(t,e){const n=t.context&&t.context.gl;if(!n||!e)return null;if(e instanceof wo)return e;e.constructor&&"Object"!==e.constructor.name&&(e={data:e});let r=null;e.compressed&&(r={[10241]:e.data.length>1?9985:9729});const i=new wo(n,{...e,parameters:{...e_,...r,...t.props.textureParameters}});return n_[i.id]=!0,i}function i_(t){t&&t instanceof wo&&n_[t.id]&&(t.delete(),delete n_[t.id])}const o_={boolean:{validate(t,e){return!0},equal(t,e,n){return Boolean(t)===Boolean(e)}},number:{validate(t,e){return Number.isFinite(t)&&(!("max"in e)||t<=e.max)&&(!("min"in e)||t>=e.min)}},color:{validate(t,e){return e.optional&&!t||l_(t)&&(3===t.length||4===t.length)},equal(t,e,n){return s_(t,e)}},accessor:{validate(t,e){const n=h_(t);return"function"===n||n===h_(e.value)},equal(t,e,n){return"function"===typeof e||s_(t,e)}},array:{validate(t,e){return e.optional&&!t||l_(t)},equal(t,e,n){return n.compare?s_(t,e):t===e}},function:{validate(t,e){return e.optional&&!t||"function"===typeof t},equal(t,e,n){return!n.compare||t===e}},data:{transform:(t,e,n)=>{const{dataTransform:r}=n?n.props:{};return r&&t?r(t):t}},image:{transform:(t,e,n)=>{return r_(n,t)},release:t=>{i_(t)}}};function s_(t,e){if(t===e)return!0;if(!l_(t)||!l_(e))return!1;const n=t.length;if(n!==e.length)return!1;for(let r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}function a_(t){const e={},n={},r={};for(const[i,o]of Object.entries(t))if(o&&o.deprecatedFor)r[i]=Array.isArray(o.deprecatedFor)?o.deprecatedFor:[o.deprecatedFor];else{const t=u_(i,o);e[i]=t,n[i]=t.value}return{propTypes:e,defaultProps:n,deprecatedProps:r}}function u_(t,e){switch(h_(e)){case"object":return c_(t,e);case"array":return c_(t,{type:"array",value:e,compare:!1});case"boolean":return c_(t,{type:"boolean",value:e});case"number":return c_(t,{type:"number",value:e});case"function":return c_(t,{type:"function",value:e,compare:!0});default:return{name:t,type:"unknown",value:e}}}function c_(t,e){return"type"in e?{name:t,...o_[e.type],...e}:"value"in e?{name:t,type:h_(e.value),...e}:{name:t,type:"object",value:e}}function l_(t){return Array.isArray(t)||ArrayBuffer.isView(t)}function h_(t){return l_(t)?"array":null===t?"null":typeof t}const{COMPONENT:f_,ASYNC_ORIGINAL:d_,ASYNC_RESOLVED:p_,ASYNC_DEFAULTS:g_}=hf;function m_(){const t=this,e=y_(t.constructor),n=Object.create(e);n[f_]=t,n[d_]={},n[p_]={};for(let r=0;r<arguments.length;++r){const t=arguments[r];for(const e in t)n[e]=t[e]}return Object.freeze(n),n}function y_(t){const e=E_(t,"_mergedDefaultProps");return e||(v_(t),t._mergedDefaultProps)}function v_(t){const e=t.prototype;if(!e)return;const n=Object.getPrototypeOf(t),r=y_(n),i=E_(t,"defaultProps")||{},o=a_(i),s=b_(o.defaultProps,r,t),a={...n._propTypes,...o.propTypes};w_(s,a);const u={...n._deprecatedProps,...o.deprecatedProps};__(s,u),t._mergedDefaultProps=s,t._propTypes=a,t._deprecatedProps=u}function b_(t,e,n){const r=Object.create(null);Object.assign(r,e,t);const i=A_(n);return delete t.id,Object.defineProperties(r,{id:{writable:!0,value:i}}),r}function __(t,e){for(const n in e)Object.defineProperty(t,n,{enumerable:!1,set(t){const r="".concat(this.id,": ").concat(n);for(const i of e[n])S_(this,i)||(this[i]=t);vn.deprecated(r,e[n].join("/"))()}})}function w_(t,e){const n={},r={};for(const i in e){const t=e[i],{name:o,value:s}=t;t.async&&(n[o]=s,r[o]=x_(o,s))}t[g_]=n,t[d_]={},Object.defineProperties(t,r)}function x_(t){return{enumerable:!0,set(e){"string"===typeof e||e instanceof Promise||Mv(e)?this[d_][t]=e:this[p_][t]=e},get(){if(this[p_]){if(t in this[p_]){const e=this[p_][t];return e||this[g_][t]}if(t in this[d_]){const e=this[f_]&&this[f_].internalState;if(e&&e.hasAsyncProp(t))return e.getAsyncProp(t)||this[g_][t]}}return this[g_][t]}}}function S_(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function E_(t,e){return S_(t,e)&&t[e]}function A_(t){const e=E_(t,"layerName")||E_(t,"componentName");return e||vn.once(0,"".concat(t.name,".componentName not specified"))(),e||t.name}const{ASYNC_ORIGINAL:M_,ASYNC_RESOLVED:C_,ASYNC_DEFAULTS:k_}=hf,O_=Object.freeze({});class P_{constructor(t=null){this.component=t,this.asyncProps={},this.onAsyncPropUpdated=()=>{},this.oldProps=O_,this.oldAsyncProps=null}finalize(){for(const t in this.asyncProps){const e=this.asyncProps[t];e.type&&e.type.release&&e.type.release(e.resolvedValue,e.type,this.component)}}getOldProps(){return this.oldAsyncProps||this.oldProps}resetOldProps(){this.oldAsyncProps=null,this.oldProps=this.component.props}freezeAsyncOldProps(){if(!this.oldAsyncProps){this.oldProps=this.oldProps||this.component.props,this.oldAsyncProps=Object.create(this.oldProps);for(const t in this.asyncProps)Object.defineProperty(this.oldAsyncProps,t,{enumerable:!0,value:this.oldProps[t]})}}hasAsyncProp(t){return t in this.asyncProps}getAsyncProp(t){const e=this.asyncProps[t];return e&&e.resolvedValue}isAsyncPropLoading(t){if(t){const e=this.asyncProps[t];return Boolean(e&&e.pendingLoadCount>0&&e.pendingLoadCount!==e.resolvedLoadCount)}for(const e in this.asyncProps)if(this.isAsyncPropLoading(e))return!0;return!1}reloadAsyncProp(t,e){this._watchPromise(t,Promise.resolve(e))}setAsyncProps(t){const e=t[C_]||{},n=t[M_]||t,r=t[k_]||{};for(const i in e){const t=e[i];this._createAsyncPropData(i,r[i]),this._updateAsyncProp(i,t),e[i]=this.getAsyncProp(i)}for(const i in n){const t=n[i];this._createAsyncPropData(i,r[i]),this._updateAsyncProp(i,t)}}_updateAsyncProp(t,e){if(this._didAsyncInputValueChange(t,e)){if("string"===typeof e){var n;const r=null===(n=this.layer)||void 0===n?void 0:n.props.fetch,i=e;r&&(e=r(i,{propName:t,layer:this.layer}))}e instanceof Promise?this._watchPromise(t,e):Mv(e)?this._resolveAsyncIterable(t,e):this._setPropValue(t,e)}}_didAsyncInputValueChange(t,e){const n=this.asyncProps[t];return e!==n.resolvedValue&&e!==n.lastValue&&(n.lastValue=e,!0)}_setPropValue(t,e){this.freezeAsyncOldProps();const n=this.asyncProps[t];e=this._postProcessValue(n,e),n.resolvedValue=e,n.pendingLoadCount++,n.resolvedLoadCount=n.pendingLoadCount}_setAsyncPropValue(t,e,n){const r=this.asyncProps[t];r&&n>=r.resolvedLoadCount&&void 0!==e&&(this.freezeAsyncOldProps(),r.resolvedValue=e,r.resolvedLoadCount=n,this.onAsyncPropUpdated(t,e))}_watchPromise(t,e){const n=this.asyncProps[t];n.pendingLoadCount++;const r=n.pendingLoadCount;e.then(e=>{var i;e=this._postProcessValue(n,e),this._setAsyncPropValue(t,e,r);const o=null===(i=this.layer)||void 0===i?void 0:i.props.onDataLoad;"data"===t&&o&&o(e,{propName:t,layer:this.layer})}).catch(e=>{var n;null===(n=this.layer)||void 0===n||n.raiseError(e,"loading ".concat(t," of ").concat(this.layer))})}async _resolveAsyncIterable(t,e){var n;"data"!==t&&this._setPropValue(t,e);const r=this.asyncProps[t];r.pendingLoadCount++;const i=r.pendingLoadCount;let o=[],s=0;for await(const u of e){const{dataTransform:e}=this.component?this.component.props:{};o=e?e(u,o):o.concat(u),Object.defineProperty(o,"__diff",{enumerable:!1,value:[{startRow:s,endRow:o.length}]}),s=o.length,this._setAsyncPropValue(t,o,i)}const a=null===(n=this.layer)||void 0===n?void 0:n.props.onDataLoad;a&&a(o,{propName:t,layer:this.layer})}_postProcessValue(t,e){const n=t.type;return n&&(n.release&&n.release(t.resolvedValue,n,this.component),n.transform)?n.transform(e,n,this.component):e}_createAsyncPropData(t,e){const n=this.asyncProps[t];if(!n){const n=this.component&&this.component.constructor._propTypes;this.asyncProps[t]={type:n&&n[t],lastValue:null,resolvedValue:e,pendingLoadCount:0,resolvedLoadCount:0}}}}const{ASYNC_ORIGINAL:T_,ASYNC_RESOLVED:L_,ASYNC_DEFAULTS:I_}=hf,N_={};let D_=0;class R_{constructor(){this.props=m_.apply(this,arguments),this.id=this.props.id,this.count=D_++,this.lifecycle=lf.NO_STATE,this.parent=null,this.context=null,this.state=null,this.internalState=null,Object.seal(this)}get root(){let t=this;while(t.parent)t=t.parent;return t}clone(t){const{props:e}=this,n={};for(const r in e[I_])r in e[L_]?n[r]=e[L_][r]:r in e[T_]&&(n[r]=e[T_][r]);return new this.constructor({...e,...n,...t})}get stats(){return this.internalState.stats}_initState(){this.internalState=new P_({})}}R_.componentName="Component",R_.defaultProps=N_;class F_ extends P_{constructor({attributeManager:t,layer:e}){super(e),this.attributeManager=t,this.model=null,this.needsRedraw=!0,this.subLayers=null,this.usesPickingColorCache=!1}get layer(){return this.component}set layer(t){this.component=t}}const B_="layer.changeFlag",j_="layer.initialize",z_="layer.update",U_="layer.finalize",$_="layer.matched",V_=2**24-1,q_=Object.freeze([]),W_=du(({oldViewport:t,viewport:e})=>{return t.equals(e)});let G_=new Uint8ClampedArray(0);const H_={data:{type:"data",value:q_,async:!0},dataComparator:null,_dataDiff:{type:"function",value:t=>t&&t.__diff,compare:!1,optional:!0},dataTransform:{type:"function",value:null,compare:!1,optional:!0},onDataLoad:{type:"function",value:null,compare:!1,optional:!0},onError:{type:"function",value:null,compare:!1,optional:!0},fetch:{type:"function",value:(t,{propName:e,layer:n,loaders:r,loadOptions:i,signal:o})=>{const{resourceManager:s}=n.context;var a;(i=i||n.getLoadOptions(),r=r||n.props.loaders,o)&&(i={...i,fetch:{...null===(a=i)||void 0===a?void 0:a.fetch,signal:o}});let u=s.contains(t);return u||i||(s.add({resourceId:t,data:Kp(t,r),persistent:!1}),u=!0),u?s.subscribe({resourceId:t,onChange:t=>n.internalState.reloadAsyncProp(e,t),consumerId:n.id,requestId:e}):Kp(t,r,i)},compare:!1},updateTriggers:{},visible:!0,pickable:!1,opacity:{type:"number",min:0,max:1,value:1},onHover:{type:"function",value:null,compare:!1,optional:!0},onClick:{type:"function",value:null,compare:!1,optional:!0},onDragStart:{type:"function",value:null,compare:!1,optional:!0},onDrag:{type:"function",value:null,compare:!1,optional:!0},onDragEnd:{type:"function",value:null,compare:!1,optional:!0},coordinateSystem:bn.DEFAULT,coordinateOrigin:{type:"array",value:[0,0,0],compare:!0},modelMatrix:{type:"array",value:null,compare:!0,optional:!0},wrapLongitude:!1,positionFormat:"XYZ",colorFormat:"RGBA",parameters:{},transitions:null,extensions:[],loaders:{type:"array",value:[],optional:!0,compare:!0},getPolygonOffset:{type:"function",value:({layerIndex:t})=>[0,100*-t],compare:!1},highlightedObjectIndex:-1,autoHighlight:!1,highlightColor:{type:"accessor",value:[0,0,128,128]}};class X_ extends R_{toString(){const t=this.constructor.layerName||this.constructor.name;return"".concat(t,"({id: '").concat(this.props.id,"'})")}raiseError(t,e){var n,r,i,o;(e&&(t.message="".concat(e,": ").concat(t.message)),null===(n=(r=this.props).onError)||void 0===n?void 0:n.call(r,t))||(null===(i=this.context)||void 0===i||null===(o=i.onError)||void 0===o||o.call(i,t,this))}setState(t){this.setChangeFlags({stateChanged:!0}),Object.assign(this.state,t),this.setNeedsRedraw()}setNeedsRedraw(t=!0){this.internalState&&(this.internalState.needsRedraw=t)}setNeedsUpdate(){this.context.layerManager.setNeedsUpdate(String(this)),this.internalState.needsUpdate=!0}getNeedsRedraw(t={clearRedrawFlags:!1}){return this._getNeedsRedraw(t)}needsUpdate(){return this.internalState.needsUpdate||this.hasUniformTransition()||this.shouldUpdateState(this._getUpdateParams())}hasUniformTransition(){return this.internalState.uniformTransitions.active}get isLoaded(){return this.internalState&&!this.internalState.isAsyncPropLoading()}get wrapLongitude(){return this.props.wrapLongitude}isPickable(){return this.props.pickable&&this.props.visible}getModels(){return this.state&&(this.state.models||(this.state.model?[this.state.model]:[]))}getAttributeManager(){return this.internalState&&this.internalState.attributeManager}getCurrentLayer(){return this.internalState&&this.internalState.layer}getLoadOptions(){return this.props.loadOptions}project(t){const{viewport:e}=this.context,n=Rl(t,{viewport:e,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem}),[r,i,o]=Ac(n,e.pixelProjectionMatrix);return 2===t.length?[r,i]:[r,i,o]}unproject(t){const{viewport:e}=this.context;return e.unproject(t)}projectPosition(t){return Fl(t,{viewport:this.context.viewport,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem})}use64bitPositions(){const{coordinateSystem:t}=this.props;return t===bn.DEFAULT||t===bn.LNGLAT||t===bn.CARTESIAN}onHover(t,e){return!!this.props.onHover&&this.props.onHover(t,e)}onClick(t,e){return!!this.props.onClick&&this.props.onClick(t,e)}nullPickingColor(){return[0,0,0]}encodePickingColor(t,e=[]){return e[0]=t+1&255,e[1]=t+1>>8&255,e[2]=t+1>>8>>8&255,e}decodePickingColor(t){fg(t instanceof Uint8Array);const[e,n,r]=t,i=e+256*n+65536*r-1;return i}initializeState(){throw new Error("Layer ".concat(this," has not defined initializeState"))}getShaders(t){for(const e of this.props.extensions)t=t_(t,e.getShaders.call(this,e));return t}shouldUpdateState({oldProps:t,props:e,context:n,changeFlags:r}){return r.propsOrDataChanged}updateState({oldProps:t,props:e,context:n,changeFlags:r}){const i=this.getAttributeManager();if(r.dataChanged&&i){const{dataChanged:t}=r;if(Array.isArray(t))for(const e of t)i.invalidateAll(e);else i.invalidateAll()}const o=t.highlightedObjectIndex>=0||t.pickable,s=e.highlightedObjectIndex>=0||e.pickable;if(o!==s&&i){const{pickingColors:t,instancePickingColors:e}=i.attributes,n=t||e;n&&(s&&n.constant&&(n.constant=!1,i.invalidate(n.id)),n.value||s||(n.constant=!0,n.value=[0,0,0]))}}finalizeState(){for(const e of this.getModels())e.delete();const t=this.getAttributeManager();t&&t.finalize(),this.context.resourceManager.unsubscribe({consumerId:this.id}),this.internalState.uniformTransitions.clear(),this.internalState.finalize()}draw(t){for(const e of this.getModels())e.draw(t)}getPickingInfo({info:t,mode:e}){const{index:n}=t;return n>=0&&Array.isArray(this.props.data)&&(t.object=this.props.data[n]),t}activateViewport(t){const e=this.internalState.viewport;this.internalState.viewport=t,e&&W_({oldViewport:e,viewport:t})||(this.setChangeFlags({viewportChanged:!0}),this.isComposite?this.needsUpdate()&&this.setNeedsUpdate():this._update())}invalidateAttribute(t="all",e=""){const n=this.getAttributeManager();n&&("all"===t?n.invalidateAll():n.invalidate(t))}updateAttributes(t){for(const e of this.getModels())this._setModelAttributes(e,t)}_updateAttributes(t){const e=this.getAttributeManager();if(!e)return;const n=this.getNumInstances(t),r=this.getStartIndices(t);e.update({data:t.data,numInstances:n,startIndices:r,props:t,transitions:t.transitions,buffers:t.data.attributes,context:this,ignoreUnknownAttributes:!0});const i=e.getChangedAttributes({clearChangedFlags:!0});this.updateAttributes(i)}_updateAttributeTransition(){const t=this.getAttributeManager();t&&t.updateTransition()}_updateUniformTransition(){const{uniformTransitions:t}=this.internalState;if(t.active){const e=t.update(),n=Object.create(this.props);for(const t in e)Object.defineProperty(n,t,{value:e[t]});return n}return this.props}calculateInstancePickingColors(t,{numInstances:e}){if(t.constant)return;const n=Math.floor(G_.length/3);if(this.internalState.usesPickingColorCache=!0,n<e){e>V_&&vn.warn("Layer has too many data objects. Picking might not be able to distinguish all objects.")(),G_=nl.allocate(G_,e,{size:3,copy:!0,maxCount:Math.max(e,V_)});const t=Math.floor(G_.length/3),r=[];for(let e=n;e<t;e++)this.encodePickingColor(e,r),G_[3*e+0]=r[0],G_[3*e+1]=r[1],G_[3*e+2]=r[2]}t.value=G_.subarray(0,3*e)}_setModelAttributes(t,e){const n=this.getAttributeManager(),r=t.userData.excludeAttributes||{},i=n.getShaderAttributes(e,r);t.setAttributes(i)}disablePickingIndex(t){this._disablePickingIndex(t)}_disablePickingIndex(t){const{pickingColors:e,instancePickingColors:n}=this.getAttributeManager().attributes,r=e||n,i=r.getVertexOffset(t),o=r.getVertexOffset(t+1);r.buffer.subData({data:new Uint8Array(o-i),offset:i})}restorePickingColors(){const{pickingColors:t,instancePickingColors:e}=this.getAttributeManager().attributes,n=t||e;this.internalState.usesPickingColorCache&&n.value.buffer!==G_.buffer&&(n.value=G_.subarray(0,n.value.length)),n.updateSubBuffer({startOffset:0})}getNumInstances(t){return t=t||this.props,void 0!==t.numInstances?t.numInstances:this.state&&void 0!==this.state.numInstances?this.state.numInstances:Kb(t.data)}getStartIndices(t){return t=t||this.props,void 0!==t.startIndices?t.startIndices:this.state&&this.state.startIndices?this.state.startIndices:null}_initialize(){pf(j_,this),this._initState(),this.initializeState(this.context);for(const t of this.props.extensions)t.initializeState.call(this,this.context,t);this.setChangeFlags({dataChanged:!0,propsChanged:!0,viewportChanged:!0,extensionsChanged:!0}),this._updateState()}_update(){const t=this.needsUpdate();pf(z_,this,t),t&&this._updateState()}_updateState(){const t=this.props,e=this.context.viewport,n=this._updateUniformTransition();this.internalState.propsInTransition=n,this.context.viewport=this.internalState.viewport||e,this.props=n;try{const n=this._getUpdateParams(),i=this.getModels();if(this.context.gl)this.updateState(n);else try{this.updateState(n)}catch(r){}for(const t of this.props.extensions)t.updateState.call(this,n,t);const o=this.getModels()[0]!==i[0];this._updateModules(n,o),this.isComposite?this._renderLayers(n):(this.setNeedsRedraw(),this._updateAttributes(this.props),this.state.model&&this.state.model.setInstanceCount(this.getNumInstances()))}finally{this.context.viewport=e,this.props=t,this.clearChangeFlags(),this.internalState.needsUpdate=!1,this.internalState.resetOldProps()}}_finalize(){pf(U_,this),this.finalizeState(this.context);for(const t of this.props.extensions)t.finalizeState.call(this,t)}drawLayer({moduleParameters:t=null,uniforms:e={},parameters:n={}}){this._updateAttributeTransition();const r=this.props;this.props=this.internalState.propsInTransition||r;const{opacity:i}=this.props;e.opacity=Math.pow(i,1/2.2);try{t&&this.setModuleParameters(t);const{getPolygonOffset:i}=this.props,o=i&&i(e)||[0,0];Object(li["c"])(this.context.gl,{polygonOffset:o}),Object(li["d"])(this.context.gl,n,()=>{const r={moduleParameters:t,uniforms:e,parameters:n,context:this.context};for(const t of this.props.extensions)t.draw.call(this,r,t);this.draw(r)})}finally{this.props=r}}getChangeFlags(){return this.internalState.changeFlags}setChangeFlags(t){const{changeFlags:e}=this.internalState;for(const r in t)if(t[r]){let n=!1;switch(r){case"dataChanged":Array.isArray(e[r])&&(e[r]=Array.isArray(t[r])?e[r].concat(t[r]):t[r],n=!0);default:e[r]||(e[r]=t[r],n=!0)}n&&pf(B_,this,r,t)}const n=e.dataChanged||e.updateTriggersChanged||e.propsChanged||e.extensionsChanged;e.propsOrDataChanged=n,e.somethingChanged=n||t.viewportChanged||t.stateChanged}clearChangeFlags(){this.internalState.changeFlags={dataChanged:!1,propsChanged:!1,updateTriggersChanged:!1,viewportChanged:!1,stateChanged:!1,extensionsChanged:!1,propsOrDataChanged:!1,somethingChanged:!1}}diffProps(t,e){const n=zb(t,e);if(n.updateTriggersChanged)for(const r in n.updateTriggersChanged)n.updateTriggersChanged[r]&&this.invalidateAttribute(r);if(n.transitionsChanged)for(const r in n.transitionsChanged)this.internalState.uniformTransitions.add(r,e[r],t[r],t.transitions[r]);return this.setChangeFlags(n)}validateProps(){jb(this.props)}setModuleParameters(t){for(const e of this.getModels())e.updateModuleSettings(t)}updateAutoHighlight(t){this.props.autoHighlight&&this._updateAutoHighlight(t)}_updateAutoHighlight(t){const e={pickingSelectedColor:t.picked?t.color:null},{highlightColor:n}=this.props;t.picked&&"function"===typeof n&&(e.pickingHighlightColor=n(t)),this.setModuleParameters(e),this.setNeedsRedraw()}_updateModules({props:t,oldProps:e},n){const{autoHighlight:r,highlightedObjectIndex:i,highlightColor:o}=t;if(n||e.autoHighlight!==r||e.highlightedObjectIndex!==i||e.highlightColor!==o){const t={};r||(t.pickingSelectedColor=null),Array.isArray(o)&&(t.pickingHighlightColor=o),Number.isInteger(i)&&(t.pickingSelectedColor=i>=0?this.encodePickingColor(i):null),this.setModuleParameters(t)}}_getUpdateParams(){return{props:this.props,oldProps:this.internalState.getOldProps(),context:this.context,changeFlags:this.internalState.changeFlags}}_getNeedsRedraw(t){if(!this.internalState)return!1;let e=!1;e=e||this.internalState.needsRedraw&&this.id,this.internalState.needsRedraw=this.internalState.needsRedraw&&!t.clearRedrawFlags;const n=this.getAttributeManager(),r=n&&n.getNeedsRedraw(t);return e=e||r,e}_getAttributeManager(){return new Ob(this.context.gl,{id:this.props.id,stats:this.context.stats,timeline:this.context.timeline})}_initState(){fg(!this.internalState&&!this.state),fg(isFinite(this.props.coordinateSystem));const t=this._getAttributeManager();t&&t.addInstanced({instancePickingColors:{type:5121,size:3,noAlloc:!0,update:this.calculateInstancePickingColors}}),this.internalState=new F_({attributeManager:t,layer:this}),this.clearChangeFlags(),this.state={},Object.defineProperty(this.state,"attributeManager",{get:()=>{return vn.deprecated("layer.state.attributeManager","layer.getAttributeManager()"),t}}),this.internalState.layer=this,this.internalState.uniformTransitions=new Fb(this.context.timeline),this.internalState.onAsyncPropUpdated=this._onAsyncPropUpdated.bind(this),this.internalState.setAsyncProps(this.props)}_transferState(t){pf($_,this,this===t);const{state:e,internalState:n}=t;this!==t&&(this.internalState=n,this.internalState.layer=this,this.state=e,this.internalState.setAsyncProps(this.props),this.diffProps(this.props,this.internalState.getOldProps()))}_onAsyncPropUpdated(){this.diffProps(this.props,this.internalState.getOldProps()),this.setNeedsUpdate()}}X_.layerName="Layer",X_.defaultProps=H_;const Y_="compositeLayer.renderLayers";class Z_ extends X_{get isComposite(){return!0}get isLoaded(){return super.isLoaded&&this.getSubLayers().every(t=>t.isLoaded)}getSubLayers(){return this.internalState&&this.internalState.subLayers||[]}initializeState(){}setState(t){super.setState(t),this.setNeedsUpdate()}getPickingInfo({info:t}){const{object:e}=t,n=e&&e.__source&&e.__source.parent&&e.__source.parent.id===this.id;return n?(t.object=e.__source.object,t.index=e.__source.index,t):t}renderLayers(){return null}filterSubLayer(t){return!0}shouldRenderSubLayer(t,e){return e&&e.length}getSubLayerClass(t,e){const{_subLayerProps:n}=this.props;return n&&n[t]&&n[t].type||e}getSubLayerRow(t,e,n){return t.__source={parent:this,object:e,index:n},t}getSubLayerAccessor(t){if("function"===typeof t){const e={data:this.props.data,target:[]};return(n,r)=>{return n&&n.__source?(e.index=n.__source.index,t(n.__source.object,e)):t(n,r)}}return t}getSubLayerProps(t={}){const{opacity:e,pickable:n,visible:r,parameters:i,getPolygonOffset:o,highlightedObjectIndex:s,autoHighlight:a,highlightColor:u,coordinateSystem:c,coordinateOrigin:l,wrapLongitude:h,positionFormat:f,modelMatrix:d,extensions:p,fetch:g,_subLayerProps:m}=this.props,y={opacity:e,pickable:n,visible:r,parameters:i,getPolygonOffset:o,highlightedObjectIndex:s,autoHighlight:a,highlightColor:u,coordinateSystem:c,coordinateOrigin:l,wrapLongitude:h,positionFormat:f,modelMatrix:d,extensions:p,fetch:g},v=m&&m[t.id],b=v&&v.updateTriggers,_=t.id||"sublayer";if(v){const e=this.constructor._propTypes,n=t.type?t.type._propTypes:{};for(const t in v){const r=n[t]||e[t];r&&"accessor"===r.type&&(v[t]=this.getSubLayerAccessor(v[t]))}}Object.assign(y,t,v),y.id="".concat(this.props.id,"-").concat(_),y.updateTriggers={all:this.props.updateTriggers.all,...t.updateTriggers,...b};for(const w of p){const t=w.getSubLayerProps.call(this,w);t&&Object.assign(y,t,{updateTriggers:Object.assign(y.updateTriggers,t.updateTriggers)})}return y}_updateAutoHighlight(t){for(const e of this.getSubLayers())e.updateAutoHighlight(t)}_getAttributeManager(){return null}_renderLayers(){let{subLayers:t}=this.internalState;const e=!t||this.needsUpdate();e&&(t=this.renderLayers(),t=gf(t,Boolean),this.internalState.subLayers=t),pf(Y_,this,e,t);for(const n of t)n.parent=this}}Z_.layerName="CompositeLayer";const K_=Math.PI/180,J_=180/Math.PI,Q_=6370972,tw=256;function ew(){const t=tw/Q_,e=Math.PI/180*tw;return{unitsPerMeter:[t,t,t],unitsPerMeter2:[0,0,0],metersPerUnit:[1/t,1/t,1/t],unitsPerDegree:[e,e,t],unitsPerDegree2:[0,0,0],degreesPerUnit:[1/e,1/e,1/t]}}class nw extends yl{constructor(t={}){const{latitude:e=0,longitude:n=0,zoom:r=11,nearZMultiplier:i=.1,farZMultiplier:o=2,resolution:s=10}=t;let{width:a,height:u,altitude:c=1.5}=t;a=a||1,u=u||1,c=Math.max(.75,c);const l=(new Ra["a"]).lookAt({eye:[0,-c,0],up:[0,0,1]}),h=Math.pow(2,r);l.rotateX(e*K_),l.rotateZ(-n*K_),l.scale(h/u);const f=Math.atan(.5/c),d=2*tw*h/u;super({...t,width:a,height:u,viewMatrix:l,longitude:n,latitude:e,zoom:r,fovyRadians:2*f,aspect:a/u,focalDistance:c,near:i,far:Math.min(2,1/d+1)*c*o}),this.resolution=s,this.distanceScales=ew()}get projectionMode(){return _n.GLOBE}getDistanceScales(){return this.distanceScales}getBounds(t={}){const e={targetZ:t.z||0},n=this.unproject([0,this.height/2],e),r=this.unproject([this.width/2,0],e),i=this.unproject([this.width,this.height/2],e),o=this.unproject([this.width/2,this.height],e);return i[0]<this.longitude&&(i[0]+=360),n[0]>this.longitude&&(n[0]-=360),[Math.min(n[0],i[0],r[0],o[0]),Math.min(n[1],i[1],r[1],o[1]),Math.max(n[0],i[0],r[0],o[0]),Math.max(n[1],i[1],r[1],o[1])]}unproject(t,{topLeft:e=!0,targetZ:n}={}){const[r,i,o]=t,s=e?i:this.height-i,{pixelUnprojectionMatrix:a}=this;let u;if(Number.isFinite(o))u=rw(a,[r,s,o,1]);else{const t=rw(a,[r,s,-1,1]),e=rw(a,[r,s,1,1]),i=((n||0)/Q_+1)*tw,o=Il(Tl([],t,e)),c=Il(t),l=Il(e),h=(4*c*l-(o-c-l)**2)/16,f=4*h/o,d=Math.sqrt(c-f),p=Math.sqrt(Math.max(0,i*i-f)),g=(d-p)/Math.sqrt(o);u=Pl([],t,e,g)}const[c,l,h]=this.unprojectPosition(u);return Number.isFinite(o)?[c,l,h]:Number.isFinite(n)?[c,l,n]:[c,l]}projectPosition(t){const[e,n,r=0]=t,i=e*K_,o=n*K_,s=Math.cos(o),a=(r/Q_+1)*tw;return[Math.sin(i)*s*a,-Math.cos(i)*s*a,Math.sin(o)*a]}unprojectPosition(t){const[e,n,r]=t,i=Ll(t),o=Math.asin(r/i),s=Math.atan2(e,-n),a=s*J_,u=o*J_,c=(i/tw-1)*Q_;return[a,u,c]}projectFlat(t){return t}unprojectFlat(t){return t}panByPosition(t,e){const n=this.unproject(e);return{longitude:t[0]-n[0]+this.longitude,latitude:t[1]-n[1]+this.latitude}}}function rw(t,e){const n=hu([],e,t);return lu(n,n,1/n[3]),n}const iw=new Uint8Array([0,255,255,255]),ow={pickingSelectedColor:null,pickingHighlightColor:iw,pickingActive:!1,pickingAttribute:!1};function sw(t=ow){const e={};if(void 0!==t.pickingSelectedColor)if(t.pickingSelectedColor){const n=t.pickingSelectedColor.slice(0,3);e.picking_uSelectedColorValid=1,e.picking_uSelectedColor=n}else e.picking_uSelectedColorValid=0;if(t.pickingHighlightColor){const n=Array.from(t.pickingHighlightColor,t=>t/255);Number.isFinite(n[3])||(n[3]=1),e.picking_uHighlightColor=n}return void 0!==t.pickingActive&&(e.picking_uActive=Boolean(t.pickingActive),e.picking_uAttribute=Boolean(t.pickingAttribute)),e}const aw="uniform bool picking_uActive;\nuniform bool picking_uAttribute;\nuniform vec3 picking_uSelectedColor;\nuniform bool picking_uSelectedColorValid;\n\nout vec4 picking_vRGBcolor_Avalid;\n\nconst float COLOR_SCALE = 1. / 255.;\n\nbool picking_isColorValid(vec3 color) {\n  return dot(color, vec3(1.0)) > 0.001;\n}\n\nbool isVertexPicked(vec3 vertexColor) {\n  return\n    picking_uSelectedColorValid &&\n    !picking_isColorValid(abs(vertexColor - picking_uSelectedColor));\n}\n\nvoid picking_setPickingColor(vec3 pickingColor) {\n  if (picking_uActive) {\n    picking_vRGBcolor_Avalid.a = float(picking_isColorValid(pickingColor));\n\n    if (!picking_uAttribute) {\n      picking_vRGBcolor_Avalid.rgb = pickingColor * COLOR_SCALE;\n    }\n  } else {\n    picking_vRGBcolor_Avalid.a = float(isVertexPicked(pickingColor));\n  }\n}\n\nvoid picking_setPickingAttribute(float value) {\n  if (picking_uAttribute) {\n    picking_vRGBcolor_Avalid.r = value;\n  }\n}\nvoid picking_setPickingAttribute(vec2 value) {\n  if (picking_uAttribute) {\n    picking_vRGBcolor_Avalid.rg = value;\n  }\n}\nvoid picking_setPickingAttribute(vec3 value) {\n  if (picking_uAttribute) {\n    picking_vRGBcolor_Avalid.rgb = value;\n  }\n}\n",uw="uniform bool picking_uActive;\nuniform vec3 picking_uSelectedColor;\nuniform vec4 picking_uHighlightColor;\n\nin vec4 picking_vRGBcolor_Avalid;\nvec4 picking_filterHighlightColor(vec4 color) {\n  if (picking_uActive) {\n    return color;\n  }\n  bool selected = bool(picking_vRGBcolor_Avalid.a);\n\n  if (selected) {\n    float highLightAlpha = picking_uHighlightColor.a;\n    float blendedAlpha = highLightAlpha + color.a * (1.0 - highLightAlpha);\n    float highLightRatio = highLightAlpha / blendedAlpha;\n\n    vec3 blendedRGB = mix(color.rgb, picking_uHighlightColor.rgb, highLightRatio);\n    return vec4(blendedRGB, blendedAlpha);\n  } else {\n    return color;\n  }\n}\nvec4 picking_filterPickingColor(vec4 color) {\n  if (picking_uActive) {\n    if (picking_vRGBcolor_Avalid.a == 0.0) {\n      discard;\n    }\n    return picking_vRGBcolor_Avalid;\n  }\n  return color;\n}\nvec4 picking_filterColor(vec4 color) {\n  vec4 highightColor = picking_filterHighlightColor(color);\n  return picking_filterPickingColor(highightColor);\n}\n\n",cw={name:"picking",vs:aw,fs:uw,getUniforms:sw};var lw={inject:{"vs:DECKGL_FILTER_COLOR":"\n  picking_setPickingColor(geometry.pickingColor);\n  // for picking depth values\n  picking_setPickingAttribute(geometry.position.z);\n  ","fs:DECKGL_FILTER_COLOR":{order:99,injection:"\n  // use highlight color if this fragment belongs to the selected object.\n  color = picking_filterHighlightColor(color);\n\n  // use picking color if rendering to picking FBO.\n  color = picking_filterPickingColor(color);\n    "}},...cw};const hw="\nvec4 project_position_to_clipspace(\n  vec3 position, vec3 position64Low, vec3 offset, out vec4 commonPosition\n) {\n  vec3 projectedPosition = project_position(position, position64Low);\n  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {\n    // offset is specified as ENU\n    // when in globe projection, rotate offset so that the ground alighs with the surface of the globe\n    mat3 rotation = project_get_orientation_matrix(projectedPosition);\n    offset = rotation * offset;\n  }\n  commonPosition = vec4(projectedPosition + offset, 1.0);\n  return project_common_position_to_clipspace(commonPosition);\n}\n\nvec4 project_position_to_clipspace(\n  vec3 position, vec3 position64Low, vec3 offset\n) {\n  vec4 commonPosition;\n  return project_position_to_clipspace(position, position64Low, offset, commonPosition);\n}\n";var fw={name:"project32",dependencies:[Mu],vs:hw},dw="#if (defined(SHADER_TYPE_FRAGMENT) && defined(LIGHTING_FRAGMENT)) || (defined(SHADER_TYPE_VERTEX) && defined(LIGHTING_VERTEX))\n\nstruct AmbientLight {\n vec3 color;\n};\n\nstruct PointLight {\n vec3 color;\n vec3 position;\n vec3 attenuation;\n};\n\nstruct DirectionalLight {\n  vec3 color;\n  vec3 direction;\n};\n\nuniform AmbientLight lighting_uAmbientLight;\nuniform PointLight lighting_uPointLight[MAX_LIGHTS];\nuniform DirectionalLight lighting_uDirectionalLight[MAX_LIGHTS];\nuniform int lighting_uPointLightCount;\nuniform int lighting_uDirectionalLightCount;\n\nuniform bool lighting_uEnabled;\n\nfloat getPointLightAttenuation(PointLight pointLight, float distance) {\n  return pointLight.attenuation.x\n       + pointLight.attenuation.y * distance\n       + pointLight.attenuation.z * distance * distance;\n}\n\n#endif\n";const pw={lightSources:{}};function gw({color:t=[0,0,0],intensity:e=1}={}){return t.map(t=>t*e/255)}function mw({ambientLight:t,pointLights:e=[],directionalLights:n=[]}){const r={};return r["lighting_uAmbientLight.color"]=t?gw(t):[0,0,0],e.forEach((t,e)=>{r[`lighting_uPointLight[${e}].color`]=gw(t),r[`lighting_uPointLight[${e}].position`]=t.position,r[`lighting_uPointLight[${e}].attenuation`]=t.attenuation||[1,0,0]}),r.lighting_uPointLightCount=e.length,n.forEach((t,e)=>{r[`lighting_uDirectionalLight[${e}].color`]=gw(t),r[`lighting_uDirectionalLight[${e}].direction`]=t.direction}),r.lighting_uDirectionalLightCount=n.length,r}function yw(t=pw){if("lightSources"in t){const{ambientLight:e,pointLights:n,directionalLights:r}=t.lightSources||{},i=e||n&&n.length>0||r&&r.length>0;return i?Object.assign({},mw({ambientLight:e,pointLights:n,directionalLights:r}),{lighting_uEnabled:!0}):{lighting_uEnabled:!1}}if("lights"in t){const e={pointLights:[],directionalLights:[]};for(const n of t.lights||[])switch(n.type){case"ambient":e.ambientLight=n;break;case"directional":e.directionalLights.push(n);break;case"point":e.pointLights.push(n);break;default:}return yw({lightSources:e})}return{}}const vw={name:"lights",vs:dw,fs:dw,getUniforms:yw,defines:{MAX_LIGHTS:3}};var bw="\nuniform float lighting_uAmbient;\nuniform float lighting_uDiffuse;\nuniform float lighting_uShininess;\nuniform vec3  lighting_uSpecularColor;\n\nvec3 lighting_getLightColor(vec3 surfaceColor, vec3 light_direction, vec3 view_direction, vec3 normal_worldspace, vec3 color) {\n    vec3 halfway_direction = normalize(light_direction + view_direction);\n    float lambertian = dot(light_direction, normal_worldspace);\n    float specular = 0.0;\n    if (lambertian > 0.0) {\n      float specular_angle = max(dot(normal_worldspace, halfway_direction), 0.0);\n      specular = pow(specular_angle, lighting_uShininess);\n    }\n    lambertian = max(lambertian, 0.0);\n    return (lambertian * lighting_uDiffuse * surfaceColor + specular * lighting_uSpecularColor) * color;\n}\n\nvec3 lighting_getLightColor(vec3 surfaceColor, vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {\n  vec3 lightColor = surfaceColor;\n\n  if (lighting_uEnabled) {\n    vec3 view_direction = normalize(cameraPosition - position_worldspace);\n    lightColor = lighting_uAmbient * surfaceColor * lighting_uAmbientLight.color;\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uPointLightCount) {\n        break;\n      }\n      PointLight pointLight = lighting_uPointLight[i];\n      vec3 light_position_worldspace = pointLight.position;\n      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);\n      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);\n    }\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uDirectionalLightCount) {\n        break;\n      }\n      DirectionalLight directionalLight = lighting_uDirectionalLight[i];\n      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);\n    }\n  }\n  return lightColor;\n}\n\nvec3 lighting_getSpecularLightColor(vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {\n  vec3 lightColor = vec3(0, 0, 0);\n  vec3 surfaceColor = vec3(0, 0, 0);\n\n  if (lighting_uEnabled) {\n    vec3 view_direction = normalize(cameraPosition - position_worldspace);\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uPointLightCount) {\n        break;\n      }\n      PointLight pointLight = lighting_uPointLight[i];\n      vec3 light_position_worldspace = pointLight.position;\n      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);\n      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);\n    }\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uDirectionalLightCount) {\n        break;\n      }\n      DirectionalLight directionalLight = lighting_uDirectionalLight[i];\n      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);\n    }\n  }\n  return lightColor;\n}\n";const _w={};function ww(t){const{ambient:e=.35,diffuse:n=.6,shininess:r=32,specularColor:i=[30,30,30]}=t;return{lighting_uAmbient:e,lighting_uDiffuse:n,lighting_uShininess:r,lighting_uSpecularColor:i.map(t=>t/255)}}function xw(t=_w){if(!("material"in t))return{};const{material:e}=t;return e?ww(e):{lighting_uEnabled:!1}}const Sw={name:"gouraud-lighting",dependencies:[vw],vs:bw,defines:{LIGHTING_VERTEX:1},getUniforms:xw},Ew={name:"phong-lighting",dependencies:[vw],fs:bw,defines:{LIGHTING_FRAGMENT:1},getUniforms:xw},Aw=20,Mw={position:[0,0,0],pitch:0,bearing:0,maxPitch:90,minPitch:-90};class Cw extends Tg{constructor({width:t,height:e,position:n=Mw.position,bearing:r=Mw.bearing,pitch:i=Mw.pitch,longitude:o,latitude:s,maxPitch:a=Mw.maxPitch,minPitch:u=Mw.minPitch,startRotatePos:c,startBearing:l,startPitch:h,startZoomPosition:f,startZoom:d}){super({width:t,height:e,position:n,bearing:r,pitch:i,longitude:o,latitude:s,maxPitch:a,minPitch:u}),this._state={startRotatePos:c,startBearing:l,startPitch:h,startZoomPosition:f,startZoom:d}}getDirection(t=!1){const e=new Ra["c"]({bearing:this._viewportProps.bearing,pitch:t?90:90+this._viewportProps.pitch}),n=e.toVector3().normalize();return n}panStart(){return this}pan(){return this}panEnd(){return this}rotateStart({pos:t}){return this._getUpdatedState({startRotatePos:t,startBearing:this._viewportProps.bearing,startPitch:this._viewportProps.pitch})}rotate({pos:t,deltaAngleX:e=0,deltaAngleY:n=0}){const{startRotatePos:r,startBearing:i,startPitch:o}=this._state,{width:s,height:a}=this._viewportProps;if(!r||!Number.isFinite(i)||!Number.isFinite(o))return this;let u;if(t){const e=(t[0]-r[0])/s,n=(t[1]-r[1])/a;u={bearing:i-180*e,pitch:o-90*n}}else u={bearing:i-e,pitch:o-n};return this._getUpdatedState(u)}rotateEnd(){return this._getUpdatedState({startRotatePos:null,startBearing:null,startPitch:null})}zoomStart(){return this._getUpdatedState({startZoomPosition:this._viewportProps.position,startZoom:this._viewportProps.zoom})}zoom({scale:t}){let{startZoomPosition:e}=this._state;e||(e=this._viewportProps.position);const n=this.getDirection();return this._move(n,Math.log2(t)*Aw,e)}zoomEnd(){return this._getUpdatedState({startZoomPosition:null,startZoom:null})}moveLeft(t=Aw){const e=this.getDirection(!0);return this._move(e.rotateZ({radians:Math.PI/2}),t)}moveRight(t=Aw){const e=this.getDirection(!0);return this._move(e.rotateZ({radians:-Math.PI/2}),t)}moveUp(t=Aw){const e=this.getDirection(!0);return this._move(e,t)}moveDown(t=Aw){const e=this.getDirection(!0);return this._move(e.negate(),t)}rotateLeft(t=15){return this._getUpdatedState({bearing:this._viewportProps.bearing-t})}rotateRight(t=15){return this._getUpdatedState({bearing:this._viewportProps.bearing+t})}rotateUp(t=10){return this._getUpdatedState({pitch:this._viewportProps.pitch+t})}rotateDown(t=10){return this._getUpdatedState({pitch:this._viewportProps.pitch-t})}zoomIn(t=2){return this.zoom({scale:t})}zoomOut(t=2){return this.zoom({scale:1/t})}shortestPathFrom(t){const e=t.getViewportProps(),n={...this._viewportProps},{bearing:r,longitude:i}=n;return Math.abs(r-e.bearing)>180&&(n.bearing=r<0?r+360:r-360),Math.abs(i-e.longitude)>180&&(n.longitude=i<0?i+360:i-360),n}_move(t,e,n=this._viewportProps.position){const r=t.scale(e);return this._getUpdatedState({position:new Ra["b"](n).add(r)})}_getUpdatedState(t){return new Cw({...this._viewportProps,...this._state,...t})}_applyConstraints(t){const{pitch:e,maxPitch:n,minPitch:r,longitude:i,bearing:o}=t;return t.pitch=Object(Ra["d"])(e,r,n),(i<-180||i>180)&&(t.longitude=il(i+180,360)-180),(o<-180||o>180)&&(t.bearing=il(o+180,360)-180),t}}class kw extends Pg{constructor(t){super(Cw,t)}get linearTransitionProps(){return["position","pitch","bearing"]}}function Ow({bearing:t,pitch:e}){const n=new Ra["c"]({bearing:t,pitch:e}),r=n.toVector3().normalize();return r}class Pw extends yl{constructor(t){const{modelMatrix:e=null,bearing:n=0,pitch:r=0,up:i=[0,0,1]}=t,o=Ow({bearing:n,pitch:-90===r?1e-4:90+r}),s=e?e.transformDirection(o):o,a=yc(t),u=Math.pow(2,a),c=(new Ra["a"]).lookAt({eye:[0,0,0],center:s,up:i}).scale(u);super({...t,zoom:a,viewMatrix:c})}}class Tw extends dg{constructor(t){super({...t,type:Pw})}get controller(){return this._getControllerProps({type:kw})}}Tw.displayName="FirstPersonView";const Lw={rotationX:0,rotationOrbit:0,zoom:0,target:[0,0,0],minRotationX:-90,maxRotationX:90,minZoom:-1/0,maxZoom:1/0};class Iw extends Tg{constructor({makeViewport:t,width:e,height:n,rotationX:r=Lw.rotationX,rotationOrbit:i=Lw.rotationOrbit,target:o=Lw.target,zoom:s=Lw.zoom,minRotationX:a=Lw.minRotationX,maxRotationX:u=Lw.maxRotationX,minZoom:c=Lw.minZoom,maxZoom:l=Lw.maxZoom,startPanPosition:h,startRotatePos:f,startRotationX:d,startRotationOrbit:p,startZoomPosition:g,startZoom:m}){super({width:e,height:n,rotationX:r,rotationOrbit:i,target:o,zoom:s,minRotationX:a,maxRotationX:u,minZoom:c,maxZoom:l}),this._state={startPanPosition:h,startRotatePos:f,startRotationX:d,startRotationOrbit:p,startZoomPosition:g,startZoom:m},this.makeViewport=t}panStart({pos:t}){return this._getUpdatedState({startPanPosition:this._unproject(t)})}pan({pos:t,startPosition:e}){const n=this._state.startPanPosition||e;if(!n)return this;const r=this.makeViewport(this._viewportProps),i=r.panByPosition(n,t);return this._getUpdatedState(i)}panEnd(){return this._getUpdatedState({startPanPosition:null})}rotateStart({pos:t}){return this._getUpdatedState({startRotatePos:t,startRotationX:this._viewportProps.rotationX,startRotationOrbit:this._viewportProps.rotationOrbit})}rotate({pos:t,deltaAngleX:e=0,deltaAngleY:n=0}){const{startRotatePos:r,startRotationX:i,startRotationOrbit:o}=this._state,{width:s,height:a}=this._viewportProps;if(!r||!Number.isFinite(i)||!Number.isFinite(o))return this;let u;if(t){let e=(t[0]-r[0])/s;const n=(t[1]-r[1])/a;(i<-90||i>90)&&(e*=-1),u={rotationX:i+180*n,rotationOrbit:o+180*e}}else u={rotationX:i+n,rotationOrbit:o+e};return this._getUpdatedState(u)}rotateEnd(){return this._getUpdatedState({startRotationX:null,startRotationOrbit:null})}shortestPathFrom(t){const e=t.getViewportProps(),n={...this._viewportProps},{rotationOrbit:r}=n;return Math.abs(r-e.rotationOrbit)>180&&(n.rotationOrbit=r<0?r+360:r-360),n}zoomStart({pos:t}){return this._getUpdatedState({startZoomPosition:this._unproject(t),startZoom:this._viewportProps.zoom})}zoom({pos:t,startPos:e,scale:n}){const{zoom:r}=this._viewportProps;let{startZoom:i,startZoomPosition:o}=this._state;Number.isFinite(i)||(i=r,o=this._unproject(e)||this._unproject(t));const s=this._calculateNewZoom({scale:n,startZoom:i}),a=this.makeViewport({...this._viewportProps,zoom:s});return this._getUpdatedState({zoom:s,...a.panByPosition(o,t)})}zoomEnd(){return this._getUpdatedState({startZoomPosition:null,startZoom:null})}zoomIn(t=2){return this._getUpdatedState({zoom:this._calculateNewZoom({scale:t})})}zoomOut(t=2){return this._getUpdatedState({zoom:this._calculateNewZoom({scale:1/t})})}moveLeft(t=50){return this._panFromCenter([-t,0])}moveRight(t=50){return this._panFromCenter([t,0])}moveUp(t=50){return this._panFromCenter([0,-t])}moveDown(t=50){return this._panFromCenter([0,t])}rotateLeft(t=15){return this._getUpdatedState({rotationOrbit:this._viewportProps.rotationOrbit-t})}rotateRight(t=15){return this._getUpdatedState({rotationOrbit:this._viewportProps.rotationOrbit+t})}rotateUp(t=10){return this._getUpdatedState({rotationX:this._viewportProps.rotationX-t})}rotateDown(t=10){return this._getUpdatedState({rotationX:this._viewportProps.rotationX+t})}_unproject(t){const e=this.makeViewport(this._viewportProps);return t&&e.unproject(t)}_calculateNewZoom({scale:t,startZoom:e}){const{maxZoom:n,minZoom:r}=this._viewportProps;Number.isFinite(e)||(e=this._viewportProps.zoom);const i=e+Math.log2(t);return Object(Ra["d"])(i,r,n)}_panFromCenter(t){const{width:e,height:n,target:r}=this._viewportProps;return this.pan({startPosition:r,pos:[e/2+t[0],n/2+t[1]]})}_getUpdatedState(t){return new this.constructor({...this._viewportProps,...this._state,...t})}_applyConstraints(t){const{maxZoom:e,minZoom:n,zoom:r,maxRotationX:i,minRotationX:o,rotationOrbit:s}=t;return t.zoom=Object(Ra["d"])(r,n,e),t.rotationX=Object(Ra["d"])(t.rotationX,o,i),(s<-180||s>180)&&(t.rotationOrbit=il(s+180,360)-180),t}}class Nw extends Pg{constructor(t){super(Iw,t)}get linearTransitionProps(){return["target","zoom","rotationX","rotationOrbit"]}}const Dw=Math.PI/180;function Rw({height:t,focalDistance:e,orbitAxis:n,rotationX:r,rotationOrbit:i,zoom:o}){const s="Z"===n?[0,0,1]:[0,1,0],a="Z"===n?[0,-e,0]:[0,0,e],u=(new Ra["a"]).lookAt({eye:a,up:s});u.rotateX(r*Dw),"Z"===n?u.rotateZ(i*Dw):u.rotateY(i*Dw);const c=Math.pow(2,o)/(t||1);return u.scale(c),u}class Fw extends yl{constructor(t){const{height:e,projectionMatrix:n,fovy:r=50,orbitAxis:i,target:o=[0,0,0],rotationX:s=0,rotationOrbit:a=0,zoom:u=0}=t,c=n?n[5]/2:Ec(r);super({...t,longitude:null,viewMatrix:Rw({height:e,focalDistance:c,orbitAxis:i,rotationX:s,rotationOrbit:a,zoom:u}),fovy:r,focalDistance:c,position:o,zoom:u}),this.projectedCenter=this.project(this.center)}unproject(t,{topLeft:e=!0}={}){const[n,r,i=this.projectedCenter[2]]=t,o=e?r:this.height-r,[s,a,u]=Mc([n,o,i],this.pixelUnprojectionMatrix);return[s,a,u]}panByPosition(t,e){const n=this.project(t),r=[this.width/2+n[0]-e[0],this.height/2+n[1]-e[1],this.projectedCenter[2]];return{target:this.unproject(r)}}}class Bw extends dg{constructor(t={}){const{orbitAxis:e="Z"}=t;super({...t,orbitAxis:e,type:Fw})}get controller(){return this._getControllerProps({type:Nw})}}Bw.displayName="OrbitView";class jw extends Iw{constructor(t){super(t),this.zoomAxis=t.zoomAxis||"all"}_applyConstraints(t){const{maxZoom:e,minZoom:n,zoom:r}=t;return t.zoom=Array.isArray(r)?[Object(Ra["d"])(r[0],n,e),Object(Ra["d"])(r[1],n,e)]:Object(Ra["d"])(r,n,e),t}_calculateNewZoom({scale:t,startZoom:e}){const{maxZoom:n,minZoom:r}=this._viewportProps;e||0===e||(e=this._viewportProps.zoom);let i=Math.log2(t);if(Array.isArray(e)){let[t,o]=e;switch(this.zoomAxis){case"X":t=Object(Ra["d"])(t+i,r,n);break;case"Y":o=Object(Ra["d"])(o+i,r,n);break;default:let e=Math.min(t+i,o+i);e<r&&(i+=r-e),e=Math.max(t+i,o+i),e>n&&(i+=n-e),t+=i,o+=i}return[t,o]}return Object(Ra["d"])(e+i,r,n)}}class zw extends Pg{constructor(t){t.dragMode=t.dragMode||"pan",super(jw,t)}_onPanRotate(t){return!1}get linearTransitionProps(){return["target","zoom"]}}const Uw=(new Ra["a"]).lookAt({eye:[0,0,1]});function $w({width:t,height:e,near:n,far:r}){return t=t||1,e=e||1,(new Ra["a"]).ortho({left:-t/2,right:t/2,bottom:-e/2,top:e/2,near:n,far:r})}class Vw extends yl{constructor(t){const{width:e,height:n,near:r=.1,far:i=1e3,zoom:o=0,target:s=[0,0,0],flipY:a=!0}=t,u=Array.isArray(o)?o[0]:o,c=Array.isArray(o)?o[1]:o,l=Math.min(u,c),h=Math.pow(2,l);if(super({...t,longitude:null,position:s,viewMatrix:Uw.clone().scale([h,h*(a?-1:1),h]),projectionMatrix:$w({width:e,height:n,near:r,far:i}),zoom:l}),u!==c){const t=Math.pow(2,u),e=Math.pow(2,c);this.distanceScales={unitsPerMeter:[t/h,e/h,1],metersPerUnit:[h/t,h/e,1]}}}projectFlat([t,e]){const{unitsPerMeter:n}=this.distanceScales;return[t*n[0],e*n[1]]}unprojectFlat([t,e]){const{metersPerUnit:n}=this.distanceScales;return[t*n[0],e*n[1]]}panByPosition(t,e){const n=Mc(e,this.pixelUnprojectionMatrix),r=this.projectFlat(t),i=bl([],r,_l([],n)),o=bl([],this.center,i);return{target:o}}}class qw extends dg{constructor(t){super({...t,type:Vw})}get controller(){return this._getControllerProps({type:zw})}}qw.displayName="OrthographicView";class Ww extends Dg{_applyConstraints(t){const{maxZoom:e,minZoom:n,zoom:r}=t;t.zoom=Object(Ra["d"])(r,n,e);const{longitude:i,latitude:o}=t;return(i<-180||i>180)&&(t.longitude=il(i+180,360)-180),t.latitude=Object(Ra["d"])(o,-89,89),t}}class Gw extends Pg{constructor(t){t.dragMode=t.dragMode||"pan",super(Ww,t)}setProps(t){super.setProps(t),this.dragRotate=!1,this.touchRotate=!1}get linearTransitionProps(){return["longitude","latitude","zoom"]}}class Hw extends dg{constructor(t){super({...t,type:nw})}get controller(){return this._getControllerProps({type:Gw})}}Hw.displayName="GlobeView";class Xw{constructor(t={}){this.opts=t}equals(t){return this===t||this.constructor===t.constructor&&ag(this.opts,t.opts)}getShaders(t){return null}getSubLayerProps(t){const{defaultProps:e={}}=t.constructor,n={updateTriggers:{}};for(const r in e)if(r in this.props){const t=e[r],i=this.props[r];n[r]=i,t&&"accessor"===t.type&&(n.updateTriggers[r]=this.props.updateTriggers[r],"function"===typeof i&&(n[r]=this.getSubLayerAccessor(i,!0)))}return n}initializeState(t,e){}updateState(t,e){}draw(t,e){}finalizeState(t){}}const Yw=["bearing","pitch"],Zw={speed:1.2,curve:1.414};class Kw extends wg{constructor(t={}){super({compare:["longitude","latitude","zoom","bearing","pitch"],extract:["width","height","longitude","latitude","zoom","bearing","pitch"],required:["width","height","latitude","longitude","zoom"]}),this.props={...Zw,...t}}interpolateProps(t,e,n){const r=Fc(t,e,n,this.props);for(const i of Yw)r[i]=Object(Ra["f"])(t[i]||0,e[i]||0,n);return r}getDuration(t,e){let{transitionDuration:n}=e;return"auto"===n&&(n=Bc(t,e,this.props)),n}}class Jw{constructor(t={}){const{attributes:e={}}=t;this.typedArrayManager=nl,this.indexStarts=null,this.vertexStarts=null,this.vertexCount=0,this.instanceCount=0,this.attributes={},this._attributeDefs=e,this.opts=t,this.updateGeometry(t),Object.seal(this)}updateGeometry(t){Object.assign(this.opts,t);const{data:e,buffers:n={},getGeometry:r,geometryBuffer:i,positionFormat:o,dataChanged:s,normalize:a=!0}=this.opts;if(this.data=e,this.getGeometry=r,this.positionSize=i&&i.size||("XY"===o?2:3),this.buffers=n,this.normalize=a,i&&(fg(e.startIndices),this.getGeometry=this.getGeometryFromBuffer(i),a||(n.positions=i)),this.geometryBuffer=n.positions,Array.isArray(s))for(const u of s)this._rebuildGeometry(u);else this._rebuildGeometry()}updatePartialGeometry({startRow:t,endRow:e}){this._rebuildGeometry({startRow:t,endRow:e})}normalizeGeometry(t){return t}updateGeometryAttributes(t,e,n){throw new Error("Not implemented")}getGeometrySize(t){throw new Error("Not implemented")}getGeometryFromBuffer(t){const e=t.value||t;return fg(ArrayBuffer.isView(e)),Cv(e,{size:this.positionSize,offset:t.offset,stride:t.stride,startIndices:this.data.startIndices})}_allocate(t,e){const{attributes:n,buffers:r,_attributeDefs:i,typedArrayManager:o}=this;for(const s in i)if(s in r)o.release(n[s]),n[s]=null;else{const r=i[s];r.copy=e,n[s]=o.allocate(n[s],t,r)}}_forEachGeometry(t,e,n){const{data:r,getGeometry:i}=this,{iterable:o,objectInfo:s}=Av(r,e,n);for(const a of o){s.index++;const e=i(a,s);t(e,s.index)}}_rebuildGeometry(t){if(!this.data||!this.getGeometry)return;let{indexStarts:e,vertexStarts:n,instanceCount:r}=this;const{data:i,geometryBuffer:o}=this,{startRow:s=0,endRow:a=1/0}=t||{},u={};if(t||(e=[0],n=[0]),this.normalize||!o)this._forEachGeometry((t,e)=>{t=this.normalizeGeometry(t),u[e]=t,n[e+1]=n[e]+this.getGeometrySize(t)},s,a),r=n[n.length-1];else if(o.buffer instanceof co){const t=o.stride||4*this.positionSize;n=i.startIndices,r=n[i.length]||o.buffer.byteLength/t}else{const t=o.value||o,e=o.stride/t.BYTES_PER_ELEMENT||this.positionSize;n=i.startIndices,r=n[i.length]||t.length/e}this._allocate(r,Boolean(t)),this.indexStarts=e,this.vertexStarts=n,this.instanceCount=r;const c={};this._forEachGeometry((t,i)=>{t=u[i]||t,c.vertexStart=n[i],c.indexStart=e[i];const o=i<n.length-1?n[i+1]:r;c.geometrySize=o-n[i],c.geometryIndex=i,this.updateGeometryAttributes(t,c)},s,a),this.vertexCount=e[e.length-1]}}var Qw="#define SHADER_NAME arc-layer-vertex-shader\n\nattribute vec3 positions;\nattribute vec4 instanceSourceColors;\nattribute vec4 instanceTargetColors;\nattribute vec3 instanceSourcePositions;\nattribute vec3 instanceSourcePositions64Low;\nattribute vec3 instanceTargetPositions;\nattribute vec3 instanceTargetPositions64Low;\nattribute vec3 instancePickingColors;\nattribute float instanceWidths;\nattribute float instanceHeights;\nattribute float instanceTilts;\n\nuniform bool greatCircle;\nuniform bool useShortestPath;\nuniform float numSegments;\nuniform float opacity;\nuniform float widthScale;\nuniform float widthMinPixels;\nuniform float widthMaxPixels;\nuniform int widthUnits;\n\nvarying vec4 vColor;\nvarying vec2 uv;\nvarying float isValid;\n\nfloat paraboloid(float distance, float sourceZ, float targetZ, float ratio) {\n\n  float deltaZ = targetZ - sourceZ;\n  float dh = distance * instanceHeights;\n  if (dh == 0.0) {\n    return sourceZ + deltaZ * ratio;\n  }\n  float unitZ = deltaZ / dh;\n  float p2 = unitZ * unitZ + 1.0;\n  float dir = step(deltaZ, 0.0);\n  float z0 = mix(sourceZ, targetZ, dir);\n  float r = mix(ratio, 1.0 - ratio, dir);\n  return sqrt(r * (p2 - r)) * dh + z0;\n}\nvec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction, float width) {\n  vec2 dir_screenspace = normalize(line_clipspace * project_uViewportSize);\n  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);\n\n  return dir_screenspace * offset_direction * width / 2.0;\n}\n\nfloat getSegmentRatio(float index) {\n  return smoothstep(0.0, 1.0, index / (numSegments - 1.0));\n}\n\nvec3 interpolateFlat(vec3 source, vec3 target, float segmentRatio) {\n  float distance = length(source.xy - target.xy);\n  float z = paraboloid(distance, source.z, target.z, segmentRatio);\n\n  float tiltAngle = radians(instanceTilts);\n  vec2 tiltDirection = normalize(target.xy - source.xy);\n  vec2 tilt = vec2(-tiltDirection.y, tiltDirection.x) * z * sin(tiltAngle);\n\n  return vec3(\n    mix(source.xy, target.xy, segmentRatio) + tilt,\n    z * cos(tiltAngle)\n  );\n}\nfloat getAngularDist (vec2 source, vec2 target) {\n  vec2 sourceRadians = radians(source);\n  vec2 targetRadians = radians(target);\n  vec2 sin_half_delta = sin((sourceRadians - targetRadians) / 2.0);\n  vec2 shd_sq = sin_half_delta * sin_half_delta;\n\n  float a = shd_sq.y + cos(sourceRadians.y) * cos(targetRadians.y) * shd_sq.x;\n  return 2.0 * asin(sqrt(a));\n}\n\nvec3 interpolateGreatCircle(vec3 source, vec3 target, vec3 source3D, vec3 target3D, float angularDist, float t) {\n  vec2 lngLat;\n  if(abs(angularDist - PI) < 0.001) {\n    lngLat = (1.0 - t) * source.xy + t * target.xy;\n  } else {\n    float a = sin((1.0 - t) * angularDist);\n    float b = sin(t * angularDist);\n    vec3 p = source3D.yxz * a + target3D.yxz * b;\n    lngLat = degrees(vec2(atan(p.y, -p.x), atan(p.z, length(p.xy))));\n  }\n\n  float z = paraboloid(angularDist * EARTH_RADIUS, source.z, target.z, t);\n\n  return vec3(lngLat, z);\n}\n\nvoid main(void) {\n  geometry.worldPosition = instanceSourcePositions;\n  geometry.worldPositionAlt = instanceTargetPositions;\n\n  float segmentIndex = positions.x;\n  float segmentRatio = getSegmentRatio(segmentIndex);\n  float prevSegmentRatio = getSegmentRatio(max(0.0, segmentIndex - 1.0));\n  float nextSegmentRatio = getSegmentRatio(min(numSegments - 1.0, segmentIndex + 1.0));\n  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));\n  isValid = 1.0;\n\n  uv = vec2(segmentRatio, positions.y);\n  geometry.uv = uv;\n  geometry.pickingColor = instancePickingColors;\n\n  vec4 curr;\n  vec4 next;\n  vec3 source;\n  vec3 target;\n\n  if ((greatCircle || project_uProjectionMode == PROJECTION_MODE_GLOBE) && project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n    source = project_globe_(vec3(instanceSourcePositions.xy, 0.0));\n    target = project_globe_(vec3(instanceTargetPositions.xy, 0.0));\n    float angularDist = getAngularDist(instanceSourcePositions.xy, instanceTargetPositions.xy);\n\n    vec3 prevPos = interpolateGreatCircle(instanceSourcePositions, instanceTargetPositions, source, target, angularDist, prevSegmentRatio);\n    vec3 currPos = interpolateGreatCircle(instanceSourcePositions, instanceTargetPositions, source, target, angularDist, segmentRatio);\n    vec3 nextPos = interpolateGreatCircle(instanceSourcePositions, instanceTargetPositions, source, target, angularDist, nextSegmentRatio);\n\n    if (abs(currPos.x - prevPos.x) > 180.0) {\n      indexDir = -1.0;\n      isValid = 0.0;\n    } else if (abs(currPos.x - nextPos.x) > 180.0) {\n      indexDir = 1.0;\n      isValid = 0.0;\n    }\n    nextPos = indexDir < 0.0 ? prevPos : nextPos;\n    nextSegmentRatio = indexDir < 0.0 ? prevSegmentRatio : nextSegmentRatio;\n\n    if (isValid == 0.0) {\n      nextPos.x += nextPos.x > 0.0 ? -360.0 : 360.0;\n      float t = ((currPos.x > 0.0 ? 180.0 : -180.0) - currPos.x) / (nextPos.x - currPos.x);\n      currPos = mix(currPos, nextPos, t);\n      segmentRatio = mix(segmentRatio, nextSegmentRatio, t);\n    }\n\n    vec3 currPos64Low = mix(instanceSourcePositions64Low, instanceTargetPositions64Low, segmentRatio);\n    vec3 nextPos64Low = mix(instanceSourcePositions64Low, instanceTargetPositions64Low, nextSegmentRatio);\n  \n    curr = project_position_to_clipspace(currPos, currPos64Low, vec3(0.0), geometry.position);\n    next = project_position_to_clipspace(nextPos, nextPos64Low, vec3(0.0));\n  \n  } else {\n    vec3 source_world = instanceSourcePositions;\n    vec3 target_world = instanceTargetPositions;\n    if (useShortestPath) {\n      source_world.x = mod(source_world.x + 180., 360.0) - 180.;\n      target_world.x = mod(target_world.x + 180., 360.0) - 180.;\n\n      float deltaLng = target_world.x - source_world.x;\n      if (deltaLng > 180.) target_world.x -= 360.;\n      if (deltaLng < -180.) source_world.x -= 360.;\n    }\n    source = project_position(source_world, instanceSourcePositions64Low);\n    target = project_position(target_world, instanceTargetPositions64Low);\n    float antiMeridianX = 0.0;\n\n    if (useShortestPath) {\n      if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET) {\n        antiMeridianX = -(project_uCoordinateOrigin.x + 180.) / 360. * TILE_SIZE;\n      }\n      float thresholdRatio = (antiMeridianX - source.x) / (target.x - source.x);\n\n      if (prevSegmentRatio <= thresholdRatio && nextSegmentRatio > thresholdRatio) {\n        isValid = 0.0;\n        indexDir = sign(segmentRatio - thresholdRatio);\n        segmentRatio = thresholdRatio;\n      }\n    }\n\n    nextSegmentRatio = indexDir < 0.0 ? prevSegmentRatio : nextSegmentRatio;\n    vec3 currPos = interpolateFlat(source, target, segmentRatio);\n    vec3 nextPos = interpolateFlat(source, target, nextSegmentRatio);\n\n    if (useShortestPath) {\n      if (nextPos.x < antiMeridianX) {\n        currPos.x += TILE_SIZE;\n        nextPos.x += TILE_SIZE;\n      }\n    }\n\n    curr = project_common_position_to_clipspace(vec4(currPos, 1.0));\n    next = project_common_position_to_clipspace(vec4(nextPos, 1.0));\n    geometry.position = vec4(currPos, 1.0);\n  }\n  float widthPixels = clamp(\n    project_size_to_pixel(instanceWidths * widthScale, widthUnits),\n    widthMinPixels, widthMaxPixels\n  );\n  vec3 offset = vec3(\n    getExtrusionOffset((next.xy - curr.xy) * indexDir, positions.y, widthPixels),\n    0.0);\n  DECKGL_FILTER_SIZE(offset, geometry);\n  gl_Position = curr + vec4(project_pixel_size_to_clipspace(offset.xy), 0.0, 0.0);\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  vec4 color = mix(instanceSourceColors, instanceTargetColors, segmentRatio);\n  vColor = vec4(color.rgb, color.a * opacity);\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",tx="#define SHADER_NAME arc-layer-fragment-shader\n\nprecision highp float;\n\nvarying vec4 vColor;\nvarying vec2 uv;\nvarying float isValid;\n\nvoid main(void) {\n  if (isValid == 0.0) {\n    discard;\n  }\n\n  gl_FragColor = vColor;\n  geometry.uv = uv;\n\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n";const ex=[0,0,0,255],nx={getSourcePosition:{type:"accessor",value:t=>t.sourcePosition},getTargetPosition:{type:"accessor",value:t=>t.targetPosition},getSourceColor:{type:"accessor",value:ex},getTargetColor:{type:"accessor",value:ex},getWidth:{type:"accessor",value:1},getHeight:{type:"accessor",value:1},getTilt:{type:"accessor",value:0},greatCircle:!1,widthUnits:"pixels",widthScale:{type:"number",value:1,min:0},widthMinPixels:{type:"number",value:0,min:0},widthMaxPixels:{type:"number",value:Number.MAX_SAFE_INTEGER,min:0}};class rx extends X_{getShaders(){return super.getShaders({vs:Qw,fs:tx,modules:[fw,lw]})}get wrapLongitude(){return!1}initializeState(){const t=this.getAttributeManager();t.addInstanced({instanceSourcePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getSourcePosition"},instanceTargetPositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getTargetPosition"},instanceSourceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getSourceColor",defaultValue:ex},instanceTargetColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getTargetColor",defaultValue:ex},instanceWidths:{size:1,transition:!0,accessor:"getWidth",defaultValue:1},instanceHeights:{size:1,transition:!0,accessor:"getHeight",defaultValue:1},instanceTilts:{size:1,transition:!0,accessor:"getTilt",defaultValue:0}})}updateState({props:t,oldProps:e,changeFlags:n}){if(super.updateState({props:t,oldProps:e,changeFlags:n}),n.extensionsChanged){var r;const{gl:t}=this.context;null===(r=this.state.model)||void 0===r||r.delete(),this.state.model=this._getModel(t),this.getAttributeManager().invalidateAll()}}draw({uniforms:t}){const{widthUnits:e,widthScale:n,widthMinPixels:r,widthMaxPixels:i,greatCircle:o,wrapLongitude:s}=this.props;this.state.model.setUniforms(t).setUniforms({greatCircle:o,widthUnits:wn[e],widthScale:n,widthMinPixels:r,widthMaxPixels:i,useShortestPath:s}).draw()}_getModel(t){let e=[];const n=50;for(let i=0;i<n;i++)e=e.concat([i,1,0,i,-1,0]);const r=new Xh(t,{...this.getShaders(),id:this.props.id,geometry:new Zh({drawMode:5,attributes:{positions:new Float32Array(e)}}),isInstanced:!0});return r.setUniforms({numSegments:n}),r}}rx.layerName="ArcLayer",rx.defaultProps=nx;const ix=new Uint16Array([0,2,1,0,3,2]),ox=new Float32Array([0,1,0,0,1,0,1,1]);function sx(t,e){if(!e)return ax(t);const n=Math.max(Math.abs(t[0][0]-t[3][0]),Math.abs(t[1][0]-t[2][0])),r=Math.max(Math.abs(t[1][1]-t[0][1]),Math.abs(t[2][1]-t[3][1])),i=Math.ceil(n/e)+1,o=Math.ceil(r/e)+1,s=(i-1)*(o-1)*6,a=new Uint32Array(s),u=new Float32Array(i*o*2),c=new Float64Array(i*o*3);let l=0,h=0;for(let f=0;f<i;f++){const e=f/(i-1);for(let n=0;n<o;n++){const r=n/(o-1),i=ux(t,e,r);c[3*l+0]=i[0],c[3*l+1]=i[1],c[3*l+2]=i[2]||0,u[2*l+0]=e,u[2*l+1]=1-r,f>0&&n>0&&(a[h++]=l-o,a[h++]=l-o-1,a[h++]=l-1,a[h++]=l-o,a[h++]=l-1,a[h++]=l),l++}}return{vertexCount:s,positions:c,indices:a,texCoords:u}}function ax(t){const e=new Float64Array(12);for(let n=0;n<t.length;n++)e[3*n+0]=t[n][0],e[3*n+1]=t[n][1],e[3*n+2]=t[n][2]||0;return{vertexCount:6,positions:e,indices:ix,texCoords:ox}}function ux(t,e,n){return Object(Ra["f"])(Object(Ra["f"])(t[0],t[1],n),Object(Ra["f"])(t[3],t[2],n),e)}var cx="\n#define SHADER_NAME bitmap-layer-vertex-shader\n\nattribute vec2 texCoords;\nattribute vec3 positions;\nattribute vec3 positions64Low;\n\nvarying vec2 vTexCoord;\nvarying vec2 vTexPos;\n\nuniform float coordinateConversion;\n\nconst vec3 pickingColor = vec3(1.0, 0.0, 0.0);\n\nvoid main(void) {\n  geometry.worldPosition = positions;\n  geometry.uv = texCoords;\n  geometry.pickingColor = pickingColor;\n\n  gl_Position = project_position_to_clipspace(positions, positions64Low, vec3(0.0), geometry.position);\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  vTexCoord = texCoords;\n\n  if (coordinateConversion < -0.5) {\n    vTexPos = geometry.position.xy;\n  } else if (coordinateConversion > 0.5) {\n    vTexPos = geometry.worldPosition.xy;\n  }\n\n  vec4 color = vec4(0.0);\n  DECKGL_FILTER_COLOR(color, geometry);\n}\n";const lx="\nvec3 packUVsIntoRGB(vec2 uv) {\n  // Extract the top 8 bits. We want values to be truncated down so we can add a fraction\n  vec2 uv8bit = floor(uv * 256.);\n\n  // Calculate the normalized remainders of u and v parts that do not fit into 8 bits\n  // Scale and clamp to 0-1 range\n  vec2 uvFraction = fract(uv * 256.);\n  vec2 uvFraction4bit = floor(uvFraction * 16.);\n\n  // Remainder can be encoded in blue channel, encode as 4 bits for pixel coordinates\n  float fractions = uvFraction4bit.x + uvFraction4bit.y * 16.;\n\n  return vec3(uv8bit, fractions) / 255.;\n}\n";var hx="\n#define SHADER_NAME bitmap-layer-fragment-shader\n\n#ifdef GL_ES\nprecision highp float;\n#endif\n\nuniform sampler2D bitmapTexture;\n\nvarying vec2 vTexCoord;\nvarying vec2 vTexPos;\n\nuniform float desaturate;\nuniform vec4 transparentColor;\nuniform vec3 tintColor;\nuniform float opacity;\n\nuniform float coordinateConversion;\nuniform vec4 bounds;\n\n/* projection utils */\nconst float TILE_SIZE = 512.0;\nconst float PI = 3.1415926536;\nconst float WORLD_SCALE = TILE_SIZE / PI / 2.0;\n\n// from degrees to Web Mercator\nvec2 lnglat_to_mercator(vec2 lnglat) {\n  float x = lnglat.x;\n  float y = clamp(lnglat.y, -89.9, 89.9);\n  return vec2(\n    radians(x) + PI,\n    PI + log(tan(PI * 0.25 + radians(y) * 0.5))\n  ) * WORLD_SCALE;\n}\n\n// from Web Mercator to degrees\nvec2 mercator_to_lnglat(vec2 xy) {\n  xy /= WORLD_SCALE;\n  return degrees(vec2(\n    xy.x - PI,\n    atan(exp(xy.y - PI)) * 2.0 - PI * 0.5\n  ));\n}\n/* End projection utils */\n\n// apply desaturation\nvec3 color_desaturate(vec3 color) {\n  float luminance = (color.r + color.g + color.b) * 0.333333333;\n  return mix(color, vec3(luminance), desaturate);\n}\n\n// apply tint\nvec3 color_tint(vec3 color) {\n  return color * tintColor;\n}\n\n// blend with background color\nvec4 apply_opacity(vec3 color, float alpha) {\n  return mix(transparentColor, vec4(color, 1.0), alpha);\n}\n\nvec2 getUV(vec2 pos) {\n  return vec2(\n    (pos.x - bounds[0]) / (bounds[2] - bounds[0]),\n    (pos.y - bounds[3]) / (bounds[1] - bounds[3])\n  );\n}\n\n".concat(lx,"\n\nvoid main(void) {\n  vec2 uv = vTexCoord;\n  if (coordinateConversion < -0.5) {\n    vec2 lnglat = mercator_to_lnglat(vTexPos);\n    uv = getUV(lnglat);\n  } else if (coordinateConversion > 0.5) {\n    vec2 commonPos = lnglat_to_mercator(vTexPos);\n    uv = getUV(commonPos);\n  }\n  vec4 bitmapColor = texture2D(bitmapTexture, uv);\n\n  gl_FragColor = apply_opacity(color_tint(color_desaturate(bitmapColor.rgb)), bitmapColor.a * opacity);\n\n  geometry.uv = uv;\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n\n  if (picking_uActive) {\n    // Since instance information is not used, we can use picking color for pixel index\n    gl_FragColor.rgb = packUVsIntoRGB(uv);\n  }\n}\n");const fx={image:{type:"image",value:null,async:!0},bounds:{type:"array",value:[1,0,0,1],compare:!0},_imageCoordinateSystem:bn.DEFAULT,desaturate:{type:"number",min:0,max:1,value:0},transparentColor:{type:"color",value:[0,0,0,0]},tintColor:{type:"color",value:[255,255,255]}};class dx extends X_{getShaders(){return super.getShaders({vs:cx,fs:hx,modules:[fw,lw]})}initializeState(){const t=this.getAttributeManager();t.remove(["instancePickingColors"]);const e=!0;t.add({indices:{size:1,isIndexed:!0,update:t=>t.value=this.state.mesh.indices,noAlloc:e},positions:{size:3,type:5130,fp64:this.use64bitPositions(),update:t=>t.value=this.state.mesh.positions,noAlloc:e},texCoords:{size:2,update:t=>t.value=this.state.mesh.texCoords,noAlloc:e}})}updateState({props:t,oldProps:e,changeFlags:n}){if(n.extensionsChanged){var r;const{gl:t}=this.context;null===(r=this.state.model)||void 0===r||r.delete(),this.state.model=this._getModel(t),this.getAttributeManager().invalidateAll()}const i=this.getAttributeManager();if(t.bounds!==e.bounds){const t=this.state.mesh,e=this._createMesh();this.state.model.setVertexCount(e.vertexCount);for(const n in e)t&&t[n]!==e[n]&&i.invalidate(n);this.setState({mesh:e,...this._getCoordinateUniforms()})}else t._imageCoordinateSystem!==e._imageCoordinateSystem&&this.setState(this._getCoordinateUniforms())}getPickingInfo({info:t}){const{image:e}=this.props;if(!t.color||!e)return t.bitmap=null,t;const{width:n,height:r}=e;t.index=0;const i=px(t.color),o=[Math.floor(i[0]*n),Math.floor(i[1]*r)];return t.bitmap={size:{width:n,height:r},uv:i,pixel:o},t}disablePickingIndex(){this.setState({disablePicking:!0})}restorePickingColors(){this.setState({disablePicking:!1})}_updateAutoHighlight(t){super._updateAutoHighlight({...t,color:this.encodePickingColor(0)})}_createMesh(){const{bounds:t}=this.props;let e=t;return Number.isFinite(t[0])&&(e=[[t[0],t[1]],[t[0],t[3]],[t[2],t[3]],[t[2],t[1]]]),sx(e,this.context.viewport.resolution)}_getModel(t){return t?new Xh(t,{...this.getShaders(),id:this.props.id,geometry:new Zh({drawMode:4,vertexCount:6}),isInstanced:!1}):null}draw(t){const{uniforms:e,moduleParameters:n}=t,{model:r,coordinateConversion:i,bounds:o,disablePicking:s}=this.state,{image:a,desaturate:u,transparentColor:c,tintColor:l}=this.props;n.pickingActive&&s||a&&r&&r.setUniforms(e).setUniforms({bitmapTexture:a,desaturate:u,transparentColor:c.map(t=>t/255),tintColor:l.slice(0,3).map(t=>t/255),coordinateConversion:i,bounds:o}).draw()}_getCoordinateUniforms(){const{LNGLAT:t,CARTESIAN:e,DEFAULT:n}=bn;let{_imageCoordinateSystem:r}=this.props;if(r!==n){const{bounds:n}=this.props;if(!Number.isFinite(n[0]))throw new Error("_imageCoordinateSystem only supports rectangular bounds");const i=this.context.viewport.resolution?t:e;if(r=r===t?t:e,r===t&&i===e)return{coordinateConversion:-1,bounds:n};if(r===e&&i===t){const t=gc([n[0],n[1]]),e=gc([n[2],n[3]]);return{coordinateConversion:1,bounds:[t[0],t[1],e[0],e[1]]}}}return{coordinateConversion:0,bounds:[0,0,0,0]}}}function px(t){const[e,n,r]=t,i=(240&r)/256,o=(15&r)/16;return[(e+o)/256,(n+i)/256]}dx.layerName="BitmapLayer",dx.defaultProps=fx;var gx="#define SHADER_NAME icon-layer-vertex-shader\n\nattribute vec2 positions;\n\nattribute vec3 instancePositions;\nattribute vec3 instancePositions64Low;\nattribute float instanceSizes;\nattribute float instanceAngles;\nattribute vec4 instanceColors;\nattribute vec3 instancePickingColors;\nattribute vec4 instanceIconFrames;\nattribute float instanceColorModes;\nattribute vec2 instanceOffsets;\nattribute vec2 instancePixelOffset;\n\nuniform float sizeScale;\nuniform vec2 iconsTextureDim;\nuniform float sizeMinPixels;\nuniform float sizeMaxPixels;\nuniform bool billboard;\nuniform int sizeUnits;\n\nvarying float vColorMode;\nvarying vec4 vColor;\nvarying vec2 vTextureCoords;\nvarying vec2 uv;\n\nvec2 rotate_by_angle(vec2 vertex, float angle) {\n  float angle_radian = angle * PI / 180.0;\n  float cos_angle = cos(angle_radian);\n  float sin_angle = sin(angle_radian);\n  mat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);\n  return rotationMatrix * vertex;\n}\n\nvoid main(void) {\n  geometry.worldPosition = instancePositions;\n  geometry.uv = positions;\n  geometry.pickingColor = instancePickingColors;\n  uv = positions;\n\n  vec2 iconSize = instanceIconFrames.zw;\n  float sizePixels = clamp(\n    project_size_to_pixel(instanceSizes * sizeScale, sizeUnits), \n    sizeMinPixels, sizeMaxPixels\n  );\n  float instanceScale = iconSize.y == 0.0 ? 0.0 : sizePixels / iconSize.y;\n  vec2 pixelOffset = positions / 2.0 * iconSize + instanceOffsets;\n  pixelOffset = rotate_by_angle(pixelOffset, instanceAngles) * instanceScale;\n  pixelOffset += instancePixelOffset;\n  pixelOffset.y *= -1.0;\n\n  if (billboard)  {\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);\n    vec3 offset = vec3(pixelOffset, 0.0);\n    DECKGL_FILTER_SIZE(offset, geometry);\n    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);\n\n  } else {\n    vec3 offset_common = vec3(project_pixel_size(pixelOffset), 0.0);\n    DECKGL_FILTER_SIZE(offset_common, geometry);\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset_common, geometry.position); \n  }\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  vTextureCoords = mix(\n    instanceIconFrames.xy,\n    instanceIconFrames.xy + iconSize,\n    (positions.xy + 1.0) / 2.0\n  ) / iconsTextureDim;\n\n  vColor = instanceColors;\n  DECKGL_FILTER_COLOR(vColor, geometry);\n\n  vColorMode = instanceColorModes;\n}\n",mx="#define SHADER_NAME icon-layer-fragment-shader\n\nprecision highp float;\n\nuniform float opacity;\nuniform sampler2D iconsTexture;\nuniform float alphaCutoff;\n\nvarying float vColorMode;\nvarying vec4 vColor;\nvarying vec2 vTextureCoords;\nvarying vec2 uv;\n\nvoid main(void) {\n  geometry.uv = uv;\n\n  vec4 texColor = texture2D(iconsTexture, vTextureCoords);\n  vec3 color = mix(texColor.rgb, vColor.rgb, vColorMode);\n  float a = texColor.a * opacity * vColor.a;\n\n  if (a < alphaCutoff) {\n    discard;\n  }\n\n  gl_FragColor = vec4(color, a);\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n";const yx=1024,vx=4,bx=()=>{},_x={[10241]:9987,[10240]:9729,[10242]:33071,[10243]:33071};function wx(t){return Math.pow(2,Math.ceil(Math.log2(t)))}function xx(t,e,n,r){return n===e.width&&r===e.height?e:(t.canvas.height=r,t.canvas.width=n,t.clearRect(0,0,t.canvas.width,t.canvas.height),t.drawImage(e,0,0,e.width,e.height,0,0,n,r),t.canvas)}function Sx(t){return t&&(t.id||t.url)}function Ex(t,e,n,r){const i=e.width,o=e.height,s=Uo(e,{width:n,height:r});return Go(e,s,{targetY:0,width:i,height:o}),e.delete(),s}function Ax(t,e,n){for(let r=0;r<e.length;r++){const{icon:i,xOffset:o}=e[r],s=Sx(i);t[s]={...i,x:o,y:n}}}function Mx({icons:t,buffer:e,mapping:n={},xOffset:r=0,yOffset:i=0,rowHeight:o=0,canvasWidth:s}){let a=[];for(let u=0;u<t.length;u++){const c=t[u],l=Sx(c);if(!n[l]){const{height:t,width:u}=c;r+u+e>s&&(Ax(n,a,i),r=0,i=o+i+e,o=0,a=[]),a.push({icon:c,xOffset:r}),r=r+u+e,o=Math.max(o,t)}}return a.length>0&&Ax(n,a,i),{mapping:n,rowHeight:o,xOffset:r,yOffset:i,canvasWidth:s,canvasHeight:wx(o+i+e)}}function Cx(t,e,n){if(!t||!e)return null;n=n||{};const r={},{iterable:i,objectInfo:o}=Av(t);for(const s of i){o.index++;const t=e(s,o),i=Sx(t);if(!t)throw new Error("Icon is missing.");if(!t.url)throw new Error("Icon url is missing.");r[i]||n[i]&&t.url===n[i].url||(r[i]={...t,source:s,sourceIndex:o.index})}return r}class kx{constructor(t,{onUpdate:e=bx,onError:n=bx}){this.gl=t,this.onUpdate=e,this.onError=n,this._loadOptions=null,this._getIcon=null,this._texture=null,this._externalTexture=null,this._mapping={},this._pendingCount=0,this._autoPacking=!1,this._xOffset=0,this._yOffset=0,this._rowHeight=0,this._buffer=vx,this._canvasWidth=yx,this._canvasHeight=0,this._canvas=null}finalize(){var t;null===(t=this._texture)||void 0===t||t.delete()}getTexture(){return this._texture||this._externalTexture}getIconMapping(t){const e=this._autoPacking?Sx(t):t;return this._mapping[e]||{}}setProps({loadOptions:t,autoPacking:e,iconAtlas:n,iconMapping:r,data:i,getIcon:o}){t&&(this._loadOptions=t),void 0!==e&&(this._autoPacking=e),o&&(this._getIcon=o),r&&(this._mapping=r),n&&this._updateIconAtlas(n),this._autoPacking&&(i||o)&&"undefined"!==typeof document&&(this._canvas=this._canvas||document.createElement("canvas"),this._updateAutoPacking(i))}get isLoaded(){return 0===this._pendingCount}_updateIconAtlas(t){var e;null===(e=this._texture)||void 0===e||e.delete(),this._texture=null,this._externalTexture=t,this.onUpdate()}_updateAutoPacking(t){const e=Object.values(Cx(t,this._getIcon,this._mapping)||{});if(e.length>0){const{mapping:t,xOffset:n,yOffset:r,rowHeight:i,canvasHeight:o}=Mx({icons:e,buffer:this._buffer,canvasWidth:this._canvasWidth,mapping:this._mapping,rowHeight:this._rowHeight,xOffset:this._xOffset,yOffset:this._yOffset});this._rowHeight=i,this._mapping=t,this._xOffset=n,this._yOffset=r,this._canvasHeight=o,this._texture||(this._texture=new wo(this.gl,{width:this._canvasWidth,height:this._canvasHeight,parameters:_x})),this._texture.height!==this._canvasHeight&&(this._texture=Ex(this.gl,this._texture,this._canvasWidth,this._canvasHeight)),this.onUpdate(),this._loadIcons(e)}}_loadIcons(t){const e=this._canvas.getContext("2d");for(const n of t)this._pendingCount++,Kp(n.url,$m,this._loadOptions).then(t=>{const r=Sx(n),{x:i,y:o,width:s,height:a}=this._mapping[r],u=xx(e,t,s,a);this._texture.setSubImageData({data:u,x:i,y:o,width:s,height:a}),this._texture.generateMipmap(),this.onUpdate()}).catch(t=>{this.onError({url:n.url,source:n.source,sourceIndex:n.sourceIndex,loadOptions:this._loadOptions,error:t})}).finally(()=>{this._pendingCount--})}}const Ox=[0,0,0,255],Px={iconAtlas:{type:"image",value:null,async:!0},iconMapping:{type:"object",value:{},async:!0},sizeScale:{type:"number",value:1,min:0},billboard:!0,sizeUnits:"pixels",sizeMinPixels:{type:"number",min:0,value:0},sizeMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},alphaCutoff:{type:"number",value:.05,min:0,max:1},getPosition:{type:"accessor",value:t=>t.position},getIcon:{type:"accessor",value:t=>t.icon},getColor:{type:"accessor",value:Ox},getSize:{type:"accessor",value:1},getAngle:{type:"accessor",value:0},getPixelOffset:{type:"accessor",value:[0,0]},onIconError:{type:"function",value:null,compare:!1,optional:!0}};class Tx extends X_{getShaders(){return super.getShaders({vs:gx,fs:mx,modules:[fw,lw]})}initializeState(){this.state={iconManager:new kx(this.context.gl,{onUpdate:this._onUpdate.bind(this),onError:this._onError.bind(this)})};const t=this.getAttributeManager();t.addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceSizes:{size:1,transition:!0,accessor:"getSize",defaultValue:1},instanceOffsets:{size:2,accessor:"getIcon",transform:this.getInstanceOffset},instanceIconFrames:{size:4,accessor:"getIcon",transform:this.getInstanceIconFrame},instanceColorModes:{size:1,type:5121,accessor:"getIcon",transform:this.getInstanceColorMode},instanceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getColor",defaultValue:Ox},instanceAngles:{size:1,transition:!0,accessor:"getAngle"},instancePixelOffset:{size:2,transition:!0,accessor:"getPixelOffset"}})}updateState({oldProps:t,props:e,changeFlags:n}){super.updateState({props:e,oldProps:t,changeFlags:n});const r=this.getAttributeManager(),{iconAtlas:i,iconMapping:o,data:s,getIcon:a}=e,{iconManager:u}=this.state;u.setProps({loadOptions:e.loadOptions});let c=!1;const l=i||this.internalState.isAsyncPropLoading("iconAtlas");if(l?(t.iconAtlas!==e.iconAtlas&&u.setProps({iconAtlas:i,autoPacking:!1}),t.iconMapping!==e.iconMapping&&(u.setProps({iconMapping:o}),c=!0)):u.setProps({autoPacking:!0}),(n.dataChanged||n.updateTriggersChanged&&(n.updateTriggersChanged.all||n.updateTriggersChanged.getIcon))&&u.setProps({data:s,getIcon:a}),c&&(r.invalidate("instanceOffsets"),r.invalidate("instanceIconFrames"),r.invalidate("instanceColorModes")),n.extensionsChanged){var h;const{gl:t}=this.context;null===(h=this.state.model)||void 0===h||h.delete(),this.state.model=this._getModel(t),r.invalidateAll()}}get isLoaded(){return super.isLoaded&&this.state.iconManager.isLoaded}finalizeState(){super.finalizeState(),this.state.iconManager.finalize()}draw({uniforms:t}){const{sizeScale:e,sizeMinPixels:n,sizeMaxPixels:r,sizeUnits:i,billboard:o,alphaCutoff:s}=this.props,{iconManager:a}=this.state,u=a.getTexture();u&&this.state.model.setUniforms(t).setUniforms({iconsTexture:u,iconsTextureDim:[u.width,u.height],sizeUnits:wn[i],sizeScale:e,sizeMinPixels:n,sizeMaxPixels:r,billboard:o,alphaCutoff:s}).draw()}_getModel(t){const e=[-1,-1,-1,1,1,1,1,-1];return new Xh(t,{...this.getShaders(),id:this.props.id,geometry:new Zh({drawMode:6,attributes:{positions:{size:2,value:new Float32Array(e)}}}),isInstanced:!0})}_onUpdate(){this.setNeedsRedraw()}_onError(t){const{onIconError:e}=this.getCurrentLayer().props;e?e(t):vn.error(t.error)()}getInstanceOffset(t){const e=this.state.iconManager.getIconMapping(t);return[e.width/2-e.anchorX||0,e.height/2-e.anchorY||0]}getInstanceColorMode(t){const e=this.state.iconManager.getIconMapping(t);return e.mask?1:0}getInstanceIconFrame(t){const e=this.state.iconManager.getIconMapping(t);return[e.x||0,e.y||0,e.width||0,e.height||0]}}Tx.layerName="IconLayer",Tx.defaultProps=Px;var Lx="#define SHADER_NAME line-layer-vertex-shader\n\nattribute vec3 positions;\nattribute vec3 instanceSourcePositions;\nattribute vec3 instanceTargetPositions;\nattribute vec3 instanceSourcePositions64Low;\nattribute vec3 instanceTargetPositions64Low;\nattribute vec4 instanceColors;\nattribute vec3 instancePickingColors;\nattribute float instanceWidths;\n\nuniform float opacity;\nuniform float widthScale;\nuniform float widthMinPixels;\nuniform float widthMaxPixels;\nuniform float useShortestPath;\nuniform int widthUnits;\n\nvarying vec4 vColor;\nvarying vec2 uv;\nvec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction, float width) {\n  vec2 dir_screenspace = normalize(line_clipspace * project_uViewportSize);\n  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);\n\n  return dir_screenspace * offset_direction * width / 2.0;\n}\n\nvec3 splitLine(vec3 a, vec3 b, float x) {\n  float t = (x - a.x) / (b.x - a.x);\n  return vec3(x, mix(a.yz, b.yz, t));\n}\n\nvoid main(void) {\n  geometry.worldPosition = instanceSourcePositions;\n  geometry.worldPositionAlt = instanceTargetPositions;\n\n  vec3 source_world = instanceSourcePositions;\n  vec3 target_world = instanceTargetPositions;\n  vec3 source_world_64low = instanceSourcePositions64Low;\n  vec3 target_world_64low = instanceTargetPositions64Low;\n\n  if (useShortestPath > 0.5 || useShortestPath < -0.5) {\n    source_world.x = mod(source_world.x + 180., 360.0) - 180.;\n    target_world.x = mod(target_world.x + 180., 360.0) - 180.;\n    float deltaLng = target_world.x - source_world.x;\n\n    if (deltaLng * useShortestPath > 180.) {\n      source_world.x += 360. * useShortestPath;\n      source_world = splitLine(source_world, target_world, 180. * useShortestPath);\n      source_world_64low = vec3(0.0);\n    } else if (deltaLng * useShortestPath < -180.) {\n      target_world.x += 360. * useShortestPath;\n      target_world = splitLine(source_world, target_world, 180. * useShortestPath);\n      target_world_64low = vec3(0.0);\n    } else if (useShortestPath < 0.) {\n      gl_Position = vec4(0.);\n      return;\n    }\n  }\n  vec4 source_commonspace;\n  vec4 target_commonspace;\n  vec4 source = project_position_to_clipspace(source_world, source_world_64low, vec3(0.), source_commonspace);\n  vec4 target = project_position_to_clipspace(target_world, target_world_64low, vec3(0.), target_commonspace);\n  float segmentIndex = positions.x;\n  vec4 p = mix(source, target, segmentIndex);\n  geometry.position = mix(source_commonspace, target_commonspace, segmentIndex);\n  uv = positions.xy;\n  geometry.uv = uv;\n  geometry.pickingColor = instancePickingColors;\n  float widthPixels = clamp(\n    project_size_to_pixel(instanceWidths * widthScale, widthUnits),\n    widthMinPixels, widthMaxPixels\n  );\n  vec3 offset = vec3(\n    getExtrusionOffset(target.xy - source.xy, positions.y, widthPixels),\n    0.0);\n  DECKGL_FILTER_SIZE(offset, geometry);\n  gl_Position = p + vec4(project_pixel_size_to_clipspace(offset.xy), 0.0, 0.0);\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n  vColor = vec4(instanceColors.rgb, instanceColors.a * opacity);\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",Ix="#define SHADER_NAME line-layer-fragment-shader\n\nprecision highp float;\n\nvarying vec4 vColor;\nvarying vec2 uv;\n\nvoid main(void) {\n  geometry.uv = uv;\n\n  gl_FragColor = vColor;\n\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n";const Nx=[0,0,0,255],Dx={getSourcePosition:{type:"accessor",value:t=>t.sourcePosition},getTargetPosition:{type:"accessor",value:t=>t.targetPosition},getColor:{type:"accessor",value:Nx},getWidth:{type:"accessor",value:1},widthUnits:"pixels",widthScale:{type:"number",value:1,min:0},widthMinPixels:{type:"number",value:0,min:0},widthMaxPixels:{type:"number",value:Number.MAX_SAFE_INTEGER,min:0}};class Rx extends X_{getShaders(){return super.getShaders({vs:Lx,fs:Ix,modules:[fw,lw]})}get wrapLongitude(){return!1}initializeState(){const t=this.getAttributeManager();t.addInstanced({instanceSourcePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getSourcePosition"},instanceTargetPositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getTargetPosition"},instanceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getColor",defaultValue:[0,0,0,255]},instanceWidths:{size:1,transition:!0,accessor:"getWidth",defaultValue:1}})}updateState({props:t,oldProps:e,changeFlags:n}){if(super.updateState({props:t,oldProps:e,changeFlags:n}),n.extensionsChanged){var r;const{gl:t}=this.context;null===(r=this.state.model)||void 0===r||r.delete(),this.state.model=this._getModel(t),this.getAttributeManager().invalidateAll()}}draw({uniforms:t}){const{widthUnits:e,widthScale:n,widthMinPixels:r,widthMaxPixels:i,wrapLongitude:o}=this.props;this.state.model.setUniforms(t).setUniforms({widthUnits:wn[e],widthScale:n,widthMinPixels:r,widthMaxPixels:i,useShortestPath:o?1:0}).draw(),o&&this.state.model.setUniforms({useShortestPath:-1}).draw()}_getModel(t){const e=[0,-1,0,0,1,0,1,-1,0,1,1,0];return new Xh(t,{...this.getShaders(),id:this.props.id,geometry:new Zh({drawMode:5,attributes:{positions:new Float32Array(e)}}),isInstanced:!0})}}Rx.layerName="LineLayer",Rx.defaultProps=Dx;var Fx="#define SHADER_NAME point-cloud-layer-vertex-shader\n\nattribute vec3 positions;\nattribute vec3 instanceNormals;\nattribute vec4 instanceColors;\nattribute vec3 instancePositions;\nattribute vec3 instancePositions64Low;\nattribute vec3 instancePickingColors;\n\nuniform float opacity;\nuniform float radiusPixels;\nuniform int sizeUnits;\n\nvarying vec4 vColor;\nvarying vec2 unitPosition;\n\nvoid main(void) {\n  geometry.worldPosition = instancePositions;\n  geometry.normal = project_normal(instanceNormals);\n  unitPosition = positions.xy;\n  geometry.uv = unitPosition;\n  geometry.pickingColor = instancePickingColors;\n  vec3 offset = vec3(positions.xy * project_size_to_pixel(radiusPixels, sizeUnits), 0.0);\n  DECKGL_FILTER_SIZE(offset, geometry);\n\n  gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.), geometry.position);\n  gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n  vec3 lightColor = lighting_getLightColor(instanceColors.rgb, project_uCameraPosition, geometry.position.xyz, geometry.normal);\n  vColor = vec4(lightColor, instanceColors.a * opacity);\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",Bx="#define SHADER_NAME point-cloud-layer-fragment-shader\n\nprecision highp float;\n\nvarying vec4 vColor;\nvarying vec2 unitPosition;\n\nvoid main(void) {\n  geometry.uv = unitPosition;\n\n  float distToCenter = length(unitPosition);\n\n  if (distToCenter > 1.0) {\n    discard;\n  }\n\n  gl_FragColor = vColor;\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n";const jx=[0,0,0,255],zx=[0,0,1],Ux={sizeUnits:"pixels",pointSize:{type:"number",min:0,value:10},getPosition:{type:"accessor",value:t=>t.position},getNormal:{type:"accessor",value:zx},getColor:{type:"accessor",value:jx},material:!0,radiusPixels:{deprecatedFor:"pointSize"}};function $x(t){const{header:e,attributes:n}=t;e&&n&&(t.length=e.vertexCount,n.POSITION&&(n.instancePositions=n.POSITION),n.NORMAL&&(n.instanceNormals=n.NORMAL),n.COLOR_0&&(n.instanceColors=n.COLOR_0))}class Vx extends X_{getShaders(){return super.getShaders({vs:Fx,fs:Bx,modules:[fw,Sw,lw]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceNormals:{size:3,transition:!0,accessor:"getNormal",defaultValue:zx},instanceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getColor",defaultValue:jx}})}updateState({props:t,oldProps:e,changeFlags:n}){if(super.updateState({props:t,oldProps:e,changeFlags:n}),n.extensionsChanged){var r;const{gl:t}=this.context;null===(r=this.state.model)||void 0===r||r.delete(),this.state.model=this._getModel(t),this.getAttributeManager().invalidateAll()}n.dataChanged&&$x(t.data)}draw({uniforms:t}){const{pointSize:e,sizeUnits:n}=this.props;this.state.model.setUniforms(t).setUniforms({sizeUnits:wn[n],radiusPixels:e}).draw()}_getModel(t){const e=[];for(let n=0;n<3;n++){const t=n/3*Math.PI*2;e.push(2*Math.cos(t),2*Math.sin(t),0)}return new Xh(t,{...this.getShaders(),id:this.props.id,geometry:new Zh({drawMode:4,attributes:{positions:new Float32Array(e)}}),isInstanced:!0})}}Vx.layerName="PointCloudLayer",Vx.defaultProps=Ux;var qx="#define SHADER_NAME scatterplot-layer-vertex-shader\n\nattribute vec3 positions;\n\nattribute vec3 instancePositions;\nattribute vec3 instancePositions64Low;\nattribute float instanceRadius;\nattribute float instanceLineWidths;\nattribute vec4 instanceFillColors;\nattribute vec4 instanceLineColors;\nattribute vec3 instancePickingColors;\n\nuniform float opacity;\nuniform float radiusScale;\nuniform float radiusMinPixels;\nuniform float radiusMaxPixels;\nuniform float lineWidthScale;\nuniform float lineWidthMinPixels;\nuniform float lineWidthMaxPixels;\nuniform float stroked;\nuniform bool filled;\nuniform bool billboard;\nuniform int radiusUnits;\nuniform int lineWidthUnits;\n\nvarying vec4 vFillColor;\nvarying vec4 vLineColor;\nvarying vec2 unitPosition;\nvarying float innerUnitRadius;\nvarying float outerRadiusPixels;\n\nvoid main(void) {\n  geometry.worldPosition = instancePositions;\n  outerRadiusPixels = clamp(\n    project_size_to_pixel(radiusScale * instanceRadius, radiusUnits),\n    radiusMinPixels, radiusMaxPixels\n  );\n  float lineWidthPixels = clamp(\n    project_size_to_pixel(lineWidthScale * instanceLineWidths, lineWidthUnits),\n    lineWidthMinPixels, lineWidthMaxPixels\n  );\n  outerRadiusPixels += stroked * lineWidthPixels / 2.0;\n  unitPosition = positions.xy;\n  geometry.uv = unitPosition;\n  geometry.pickingColor = instancePickingColors;\n\n  innerUnitRadius = 1.0 - stroked * lineWidthPixels / outerRadiusPixels;\n  \n  if (billboard) {\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);\n    vec3 offset = positions * outerRadiusPixels;\n    DECKGL_FILTER_SIZE(offset, geometry);\n    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);\n  } else {\n    vec3 offset = positions * project_pixel_size(outerRadiusPixels);\n    DECKGL_FILTER_SIZE(offset, geometry);\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset, geometry.position);\n  }\n\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n  vFillColor = vec4(instanceFillColors.rgb, instanceFillColors.a * opacity);\n  DECKGL_FILTER_COLOR(vFillColor, geometry);\n  vLineColor = vec4(instanceLineColors.rgb, instanceLineColors.a * opacity);\n  DECKGL_FILTER_COLOR(vLineColor, geometry);\n}\n",Wx="#define SHADER_NAME scatterplot-layer-fragment-shader\n\nprecision highp float;\n\nuniform bool filled;\nuniform float stroked;\nuniform bool antialiasing;\n\nvarying vec4 vFillColor;\nvarying vec4 vLineColor;\nvarying vec2 unitPosition;\nvarying float innerUnitRadius;\nvarying float outerRadiusPixels;\n\nvoid main(void) {\n  geometry.uv = unitPosition;\n\n  float distToCenter = length(unitPosition) * outerRadiusPixels;\n  float inCircle = antialiasing ? \n    smoothedge(distToCenter, outerRadiusPixels) : \n    step(distToCenter, outerRadiusPixels);\n\n  if (inCircle == 0.0) {\n    discard;\n  }\n\n  if (stroked > 0.5) {\n    float isLine = antialiasing ? \n      smoothedge(innerUnitRadius * outerRadiusPixels, distToCenter) :\n      step(innerUnitRadius * outerRadiusPixels, distToCenter);\n\n    if (filled) {\n      gl_FragColor = mix(vFillColor, vLineColor, isLine);\n    } else {\n      if (isLine == 0.0) {\n        discard;\n      }\n      gl_FragColor = vec4(vLineColor.rgb, vLineColor.a * isLine);\n    }\n  } else if (filled) {\n    gl_FragColor = vFillColor;\n  } else {\n    discard;\n  }\n\n  gl_FragColor.a *= inCircle;\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n";const Gx=[0,0,0,255],Hx={radiusUnits:"meters",radiusScale:{type:"number",min:0,value:1},radiusMinPixels:{type:"number",min:0,value:0},radiusMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},lineWidthUnits:"meters",lineWidthScale:{type:"number",min:0,value:1},lineWidthMinPixels:{type:"number",min:0,value:0},lineWidthMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},stroked:!1,filled:!0,billboard:!1,antialiasing:!0,getPosition:{type:"accessor",value:t=>t.position},getRadius:{type:"accessor",value:1},getFillColor:{type:"accessor",value:Gx},getLineColor:{type:"accessor",value:Gx},getLineWidth:{type:"accessor",value:1},strokeWidth:{deprecatedFor:"getLineWidth"},outline:{deprecatedFor:"stroked"},getColor:{deprecatedFor:["getFillColor","getLineColor"]}};class Xx extends X_{getShaders(){return super.getShaders({vs:qx,fs:Wx,modules:[fw,lw]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceRadius:{size:1,transition:!0,accessor:"getRadius",defaultValue:1},instanceFillColors:{size:this.props.colorFormat.length,transition:!0,normalized:!0,type:5121,accessor:"getFillColor",defaultValue:[0,0,0,255]},instanceLineColors:{size:this.props.colorFormat.length,transition:!0,normalized:!0,type:5121,accessor:"getLineColor",defaultValue:[0,0,0,255]},instanceLineWidths:{size:1,transition:!0,accessor:"getLineWidth",defaultValue:1}})}updateState({props:t,oldProps:e,changeFlags:n}){if(super.updateState({props:t,oldProps:e,changeFlags:n}),n.extensionsChanged){var r;const{gl:t}=this.context;null===(r=this.state.model)||void 0===r||r.delete(),this.state.model=this._getModel(t),this.getAttributeManager().invalidateAll()}}draw({uniforms:t}){const{radiusUnits:e,radiusScale:n,radiusMinPixels:r,radiusMaxPixels:i,stroked:o,filled:s,billboard:a,antialiasing:u,lineWidthUnits:c,lineWidthScale:l,lineWidthMinPixels:h,lineWidthMaxPixels:f}=this.props;this.state.model.setUniforms(t).setUniforms({stroked:o?1:0,filled:s,billboard:a,antialiasing:u,radiusUnits:wn[e],radiusScale:n,radiusMinPixels:r,radiusMaxPixels:i,lineWidthUnits:wn[c],lineWidthScale:l,lineWidthMinPixels:h,lineWidthMaxPixels:f}).draw()}_getModel(t){const e=[-1,-1,0,1,-1,0,1,1,0,-1,1,0];return new Xh(t,{...this.getShaders(),id:this.props.id,geometry:new Zh({drawMode:6,vertexCount:4,attributes:{positions:{size:3,value:new Float32Array(e)}}}),isInstanced:!0})}}Xx.layerName="ScatterplotLayer",Xx.defaultProps=Hx;n("6b74");const Yx={CLOCKWISE:1,COUNTER_CLOCKWISE:-1};function Zx(t,e,n={}){const r=Kx(t,n);return r!==e&&(Qx(t,n),!0)}function Kx(t,e={}){return Math.sign(Jx(t,e))}function Jx(t,e={}){const{start:n=0,end:r=t.length}=e,i=e.size||2;let o=0;for(let s=n,a=r-i;s<r;s+=i)o+=(t[s]-t[a])*(t[s+1]+t[a+1]),a=s;return o/2}function Qx(t,e){const{start:n=0,end:r=t.length,size:i=2}=e,o=(r-n)/i,s=Math.floor(o/2);for(let a=0;a<s;++a){const e=n+a*i,r=n+(o-1-a)*i;for(let n=0;n<i;++n){const i=t[e+n];t[e+n]=t[r+n],t[r+n]=i}}}function tS(t,e){const n=e.length,r=t.length;if(r>0){let i=!0;for(let o=0;o<n;o++)if(t[r-n+o]!==e[o]){i=!1;break}if(i)return!1}for(let i=0;i<n;i++)t[r+i]=e[i];return!0}function eS(t,e){const n=e.length;for(let r=0;r<n;r++)t[r]=e[r]}function nS(t,e,n,r,i=[]){const o=r+e*n;for(let s=0;s<n;s++)i[s]=t[o+s];return i}function rS(t,e,n,r,i=[]){let o,s;if(8&n)o=(r[3]-t[1])/(e[1]-t[1]),s=3;else if(4&n)o=(r[1]-t[1])/(e[1]-t[1]),s=1;else if(2&n)o=(r[2]-t[0])/(e[0]-t[0]),s=2;else{if(!(1&n))return null;o=(r[0]-t[0])/(e[0]-t[0]),s=0}for(let a=0;a<t.length;a++)i[a]=(1&s)===a?r[s]:o*(e[a]-t[a])+t[a];return i}function iS(t,e){let n=0;return t[0]<e[0]?n|=1:t[0]>e[2]&&(n|=2),t[1]<e[1]?n|=4:t[1]>e[3]&&(n|=8),n}function oS(t,e={}){const{size:n=2,broken:r=!1,gridResolution:i=10,gridOffset:o=[0,0],startIndex:s=0,endIndex:a=t.length}=e,u=(a-s)/n;let c=[];const l=[c],h=nS(t,0,n,s);let f,d;const p=hS(h,i,o,[]),g=[];tS(c,h);for(let m=1;m<u;m++){f=nS(t,m,n,s,f),d=iS(f,p);while(d){rS(h,f,d,p,g);const t=iS(g,p);t&&(rS(h,g,t,p,g),d=t),tS(c,g),eS(h,g),fS(p,i,d),r&&c.length>n&&(c=[],l.push(c),tS(c,h)),d=iS(f,p)}tS(c,f),eS(h,f)}return r?l:l[0]}const sS=0,aS=1;function uS(t,e){for(let n=0;n<e.length;n++)t.push(e[n]);return t}function cS(t,e,n={}){if(!t.length)return[];const{size:r=2,gridResolution:i=10,gridOffset:o=[0,0],edgeTypes:s=!1}=n,a=[],u=[{pos:t,types:s&&new Array(t.length/r).fill(aS),holes:e||[]}],c=[[],[]];let l=[];while(u.length){const{pos:t,types:e,holes:n}=u.shift();dS(t,r,n[0]||t.length,c),l=hS(c[0],i,o,l);const h=iS(c[1],l);if(h){let i=lS(t,e,r,0,n[0]||t.length,l,h);const o={pos:i[0].pos,types:i[0].types,holes:[]},a={pos:i[1].pos,types:i[1].types,holes:[]};u.push(o,a);for(let u=0;u<n.length;u++)i=lS(t,e,r,n[u],n[u+1]||t.length,l,h),i[0]&&(o.holes.push(o.pos.length),o.pos=uS(o.pos,i[0].pos),s&&(o.types=uS(o.types,i[0].types))),i[1]&&(a.holes.push(a.pos.length),a.pos=uS(a.pos,i[1].pos),s&&(a.types=uS(a.types,i[1].types)))}else{const r={positions:t};s&&(r.edgeTypes=e),n.length&&(r.holeIndices=n),a.push(r)}}return a}function lS(t,e,n,r,i,o,s){const a=(i-r)/n,u=[],c=[],l=[],h=[],f=[];let d,p,g;const m=nS(t,a-1,n,r);let y=Math.sign(8&s?m[1]-o[3]:m[0]-o[2]),v=e&&e[a-1],b=0,_=0;for(let w=0;w<a;w++)d=nS(t,w,n,r,d),p=Math.sign(8&s?d[1]-o[3]:d[0]-o[2]),g=e&&e[r/n+w],p&&y&&y!==p&&(rS(m,d,s,o,f),tS(u,f)&&l.push(v),tS(c,f)&&h.push(v)),p<=0?(tS(u,d)&&l.push(g),b-=p):l.length&&(l[l.length-1]=sS),p>=0?(tS(c,d)&&h.push(g),_+=p):h.length&&(h[h.length-1]=sS),eS(m,d),y=p,v=g;return[b?{pos:u,types:e&&l}:null,_?{pos:c,types:e&&h}:null]}function hS(t,e,n,r){const i=Math.floor((t[0]-n[0])/e)*e+n[0],o=Math.floor((t[1]-n[1])/e)*e+n[1];return r[0]=i,r[1]=o,r[2]=i+e,r[3]=o+e,r}function fS(t,e,n){8&n?(t[1]+=e,t[3]+=e):4&n?(t[1]-=e,t[3]-=e):2&n?(t[0]+=e,t[2]+=e):1&n&&(t[0]-=e,t[2]-=e)}function dS(t,e,n,r){let i=1/0,o=-1/0,s=1/0,a=-1/0;for(let u=0;u<n;u+=e){const e=t[u],n=t[u+1];i=e<i?e:i,o=e>o?e:o,s=n<s?n:s,a=n>a?n:a}return r[0][0]=i,r[0][1]=s,r[1][0]=o,r[1][1]=a,r}const pS=85.051129;function gS(t,e={}){const{size:n=2,startIndex:r=0,endIndex:i=t.length,normalize:o=!0}=e,s=t.slice(r,i);bS(s,n,0,i-r);const a=oS(s,{size:n,broken:!0,gridResolution:360,gridOffset:[-180,-180]});if(o)for(const u of a)_S(u,n);return a}function mS(t,e,n={}){const{size:r=2,normalize:i=!0,edgeTypes:o=!1}=n;e=e||[];const s=[],a=[];let u=0,c=0;for(let h=0;h<=e.length;h++){const i=e[h]||t.length,o=c,l=yS(t,r,u,i);for(let e=l;e<i;e++)s[c++]=t[e];for(let e=u;e<l;e++)s[c++]=t[e];bS(s,r,o,c),vS(s,r,o,c,n.maxLatitude),u=i,a[h]=c}a.pop();const l=cS(s,a,{size:r,gridResolution:360,gridOffset:[-180,-180],edgeTypes:o});if(i)for(const h of l)_S(h.positions,r);return l}function yS(t,e,n,r){let i=-1,o=-1;for(let s=n+1;s<r;s+=e){const e=Math.abs(t[s]);e>i&&(i=e,o=s-1)}return o}function vS(t,e,n,r,i=pS){const o=t[n],s=t[r-e];if(Math.abs(o-s)>180){const r=nS(t,0,e,n);r[0]+=360*Math.round((s-o)/360),tS(t,r),r[1]=Math.sign(r[1])*i,tS(t,r),r[0]=o,tS(t,r)}}function bS(t,e,n,r){let i,o=t[0];for(let s=n;s<r;s+=e){i=t[s];const e=i-o;(e>180||e<-180)&&(i-=360*Math.round(e/360)),t[s]=o=i}}function _S(t,e){let n;const r=t.length/e;for(let o=0;o<r;o++)if(n=t[o*e],(n+180)%360!==0)break;const i=360*-Math.round(n/360);if(0!==i)for(let o=0;o<r;o++)t[o*e]+=i}class wS extends Zh{constructor(t={}){const{id:e=qi("column-geometry")}=t,{indices:n,attributes:r}=xS(t);super({...t,id:e,indices:n,attributes:r})}}function xS(t){const{radius:e,height:n=1,nradial:r=10}=t;let{vertices:i}=t;i&&(vn.assert(i.length>=r),i=i.flatMap(t=>[t[0],t[1]]),Zx(i,Yx.COUNTER_CLOCKWISE));const o=n>0,s=r+1,a=o?3*s+1:r,u=2*Math.PI/r,c=new Uint16Array(o?3*r*2:0),l=new Float32Array(3*a),h=new Float32Array(3*a);let f=0;if(o){for(let t=0;t<s;t++){const o=t*u,s=t%r,a=Math.sin(o),c=Math.cos(o);for(let t=0;t<2;t++)l[f+0]=i?i[2*s]:c*e,l[f+1]=i?i[2*s+1]:a*e,l[f+2]=(.5-t)*n,h[f+0]=i?i[2*s]:c,h[f+1]=i?i[2*s+1]:a,f+=3}l[f+0]=l[f-3],l[f+1]=l[f-2],l[f+2]=l[f-1],f+=3}for(let d=o?0:1;d<s;d++){const t=Math.floor(d/2)*Math.sign(.5-d%2),o=t*u,s=(t+r)%r,a=Math.sin(o),c=Math.cos(o);l[f+0]=i?i[2*s]:c*e,l[f+1]=i?i[2*s+1]:a*e,l[f+2]=n/2,h[f+2]=1,f+=3}if(o){let t=0;for(let e=0;e<r;e++)c[t++]=2*e+0,c[t++]=2*e+2,c[t++]=2*e+0,c[t++]=2*e+1,c[t++]=2*e+1,c[t++]=2*e+3}return{indices:c,attributes:{POSITION:{size:3,value:l},NORMAL:{size:3,value:h}}}}var SS="\n#define SHADER_NAME column-layer-vertex-shader\n\nattribute vec3 positions;\nattribute vec3 normals;\n\nattribute vec3 instancePositions;\nattribute float instanceElevations;\nattribute vec3 instancePositions64Low;\nattribute vec4 instanceFillColors;\nattribute vec4 instanceLineColors;\nattribute float instanceStrokeWidths;\n\nattribute vec3 instancePickingColors;\nuniform float opacity;\nuniform float radius;\nuniform float angle;\nuniform vec2 offset;\nuniform bool extruded;\nuniform bool isStroke;\nuniform float coverage;\nuniform float elevationScale;\nuniform float edgeDistance;\nuniform float widthScale;\nuniform float widthMinPixels;\nuniform float widthMaxPixels;\nuniform int radiusUnits;\nuniform int widthUnits;\nvarying vec4 vColor;\n\nvoid main(void) {\n  geometry.worldPosition = instancePositions;\n\n  vec4 color = isStroke ? instanceLineColors : instanceFillColors;\n  mat2 rotationMatrix = mat2(cos(angle), sin(angle), -sin(angle), cos(angle));\n  float elevation = 0.0;\n  float strokeOffsetRatio = 1.0;\n\n  if (extruded) {\n    elevation = instanceElevations * (positions.z + 1.0) / 2.0 * elevationScale;\n  } else if (isStroke) {\n    float widthPixels = clamp(\n      project_size_to_pixel(instanceStrokeWidths * widthScale, widthUnits),\n      widthMinPixels, widthMaxPixels) / 2.0;\n    strokeOffsetRatio -= sign(positions.z) * project_pixel_size(widthPixels) / project_size(edgeDistance * coverage * radius);\n  }\n  float shouldRender = float(color.a > 0.0 && instanceElevations >= 0.0);\n  float dotRadius = radius * coverage * shouldRender;\n\n  geometry.normal = project_normal(vec3(rotationMatrix * normals.xy, normals.z));\n  geometry.pickingColor = instancePickingColors;\n  vec3 centroidPosition = vec3(instancePositions.xy, instancePositions.z + elevation);\n  vec3 centroidPosition64Low = instancePositions64Low;\n  vec2 offset = (rotationMatrix * positions.xy * strokeOffsetRatio + offset) * dotRadius;\n  if (radiusUnits == UNIT_METERS) {\n    offset = project_size(offset);\n  }\n  vec3 pos = vec3(offset, 0.);\n  DECKGL_FILTER_SIZE(pos, geometry);\n\n  gl_Position = project_position_to_clipspace(centroidPosition, centroidPosition64Low, pos, geometry.position);\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n  if (extruded && !isStroke) {\n    vec3 lightColor = lighting_getLightColor(color.rgb, project_uCameraPosition, geometry.position.xyz, geometry.normal);\n    vColor = vec4(lightColor, color.a * opacity);\n  } else {\n    vColor = vec4(color.rgb, color.a * opacity);\n  }\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",ES="#define SHADER_NAME column-layer-fragment-shader\n\nprecision highp float;\n\nvarying vec4 vColor;\n\nvoid main(void) {\n  gl_FragColor = vColor;\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n";const AS=[0,0,0,255],MS={diskResolution:{type:"number",min:4,value:20},vertices:null,radius:{type:"number",min:0,value:1e3},angle:{type:"number",value:0},offset:{type:"array",value:[0,0]},coverage:{type:"number",min:0,max:1,value:1},elevationScale:{type:"number",min:0,value:1},radiusUnits:"meters",lineWidthUnits:"meters",lineWidthScale:1,lineWidthMinPixels:0,lineWidthMaxPixels:Number.MAX_SAFE_INTEGER,extruded:!0,wireframe:!1,filled:!0,stroked:!1,getPosition:{type:"accessor",value:t=>t.position},getFillColor:{type:"accessor",value:AS},getLineColor:{type:"accessor",value:AS},getLineWidth:{type:"accessor",value:1},getElevation:{type:"accessor",value:1e3},material:!0,getColor:{deprecatedFor:["getFillColor","getLineColor"]}};class CS extends X_{getShaders(){return super.getShaders({vs:SS,fs:ES,modules:[fw,Sw,lw]})}initializeState(){const t=this.getAttributeManager();t.addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceElevations:{size:1,transition:!0,accessor:"getElevation"},instanceFillColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getFillColor",defaultValue:AS},instanceLineColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getLineColor",defaultValue:AS},instanceStrokeWidths:{size:1,accessor:"getLineWidth",transition:!0}})}updateState({props:t,oldProps:e,changeFlags:n}){super.updateState({props:t,oldProps:e,changeFlags:n});const r=n.extensionsChanged;if(r){var i;const{gl:t}=this.context;null===(i=this.state.model)||void 0===i||i.delete(),this.state.model=this._getModel(t),this.getAttributeManager().invalidateAll()}(r||t.diskResolution!==e.diskResolution||t.vertices!==e.vertices||(t.extruded||t.stroked)!==(e.extruded||e.stroked))&&this._updateGeometry(t)}getGeometry(t,e,n){const r=new wS({radius:1,height:n?2:0,vertices:e,nradial:t});let i=0;if(e)for(let o=0;o<t;o++){const n=e[o],r=Math.sqrt(n[0]*n[0]+n[1]*n[1]);i+=r/t}else i=1;return this.setState({edgeDistance:Math.cos(Math.PI/t)*i}),r}_getModel(t){return new Xh(t,{...this.getShaders(),id:this.props.id,isInstanced:!0})}_updateGeometry({diskResolution:t,vertices:e,extruded:n,stroked:r}){const i=this.getGeometry(t,e,n||r);this.setState({fillVertexCount:i.attributes.POSITION.value.length/3,wireframeVertexCount:i.indices.value.length}),this.state.model.setProps({geometry:i})}draw({uniforms:t}){const{lineWidthUnits:e,lineWidthScale:n,lineWidthMinPixels:r,lineWidthMaxPixels:i,radiusUnits:o,elevationScale:s,extruded:a,filled:u,stroked:c,wireframe:l,offset:h,coverage:f,radius:d,angle:p}=this.props,{model:g,fillVertexCount:m,wireframeVertexCount:y,edgeDistance:v}=this.state;g.setUniforms(t).setUniforms({radius:d,angle:p/180*Math.PI,offset:h,extruded:a,coverage:f,elevationScale:s,edgeDistance:v,radiusUnits:wn[o],widthUnits:wn[e],widthScale:n,widthMinPixels:r,widthMaxPixels:i}),a&&l&&(g.setProps({isIndexed:!0}),g.setVertexCount(y).setDrawMode(1).setUniforms({isStroke:!0}).draw()),u&&(g.setProps({isIndexed:!1}),g.setVertexCount(m).setDrawMode(5).setUniforms({isStroke:!1}).draw()),!a&&c&&(g.setProps({isIndexed:!1}),g.setVertexCount(2*m/3).setDrawMode(5).setUniforms({isStroke:!0}).draw())}}CS.layerName="ColumnLayer",CS.defaultProps=MS;const kS=new Uint16Array([0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23]),OS=new Float32Array([-1,-1,1,1,-1,1,1,1,1,-1,1,1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1,-1,-1,1,-1,-1,1,1,1,1,1,1,1,-1,-1,-1,-1,1,-1,-1,1,-1,1,-1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,-1,1,-1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1]),PS=new Float32Array([0,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0]),TS=new Float32Array([0,0,1,0,1,1,0,1,1,0,1,1,0,1,0,0,0,1,0,0,1,0,1,1,1,1,0,1,0,0,1,0,1,0,1,1,0,1,0,0,0,0,1,0,1,1,0,1]),LS={POSITION:{size:3,value:new Float32Array(OS)},NORMAL:{size:3,value:new Float32Array(PS)},TEXCOORD_0:{size:2,value:new Float32Array(TS)}};class IS extends Zh{constructor(t={}){const{id:e=qi("cube-geometry")}=t;super({...t,id:e,indices:{size:1,value:new Uint16Array(kS)},attributes:{...LS,...t.attributes}})}}const NS={cellSize:{type:"number",min:0,value:1e3},offset:{type:"array",min:0,value:[1,1]}};class DS extends CS{getGeometry(t){return new IS}draw({uniforms:t}){const{elevationScale:e,extruded:n,offset:r,coverage:i,cellSize:o,angle:s,radiusUnits:a}=this.props;this.state.model.setUniforms(t).setUniforms({radius:o/2,radiusUnits:wn[a],angle:s,offset:r,extruded:n,coverage:i,elevationScale:e,edgeDistance:1,isWireframe:!1}).draw()}}function RS(t,e,n,r){let i=t;if(Array.isArray(t[0])){const n=t.length*e;i=new Array(n);for(let r=0;r<t.length;r++)for(let n=0;n<e;n++)i[r*e+n]=t[r][n]||0}return n?oS(i,{size:e,gridResolution:n}):r?gS(i,{size:e}):i}DS.layerName="GridCellLayer",DS.defaultProps=NS;const FS=1,BS=2,jS=4;class zS extends Jw{constructor(t){super({...t,attributes:{positions:{size:3,padding:18,initialize:!0,type:t.fp64?Float64Array:Float32Array},segmentTypes:{size:1,type:Uint8ClampedArray}}})}getGeometryFromBuffer(t){return this.normalize?super.getGeometryFromBuffer(t):()=>null}normalizeGeometry(t){return this.normalize?RS(t,this.positionSize,this.opts.resolution,this.opts.wrapLongitude):t}get(t){return this.attributes[t]}getGeometrySize(t){if(Array.isArray(t[0])){let e=0;for(const n of t)e+=this.getGeometrySize(n);return e}const e=this.getPathLength(t);return e<2?0:this.isClosed(t)?e<3?0:e+2:e}updateGeometryAttributes(t,e){if(0!==e.geometrySize)if(t&&Array.isArray(t[0]))for(const n of t){const t=this.getGeometrySize(n);e.geometrySize=t,this.updateGeometryAttributes(n,e),e.vertexStart+=t}else this._updateSegmentTypes(t,e),this._updatePositions(t,e)}_updateSegmentTypes(t,e){const{segmentTypes:n}=this.attributes,r=this.isClosed(t),{vertexStart:i,geometrySize:o}=e;n.fill(0,i,i+o),r?(n[i]=jS,n[i+o-2]=jS):(n[i]+=FS,n[i+o-2]+=BS),n[i+o-1]=jS}_updatePositions(t,e){const{positions:n}=this.attributes;if(!n)return;const{vertexStart:r,geometrySize:i}=e,o=new Array(3);for(let s=r,a=0;a<i;s++,a++)this.getPointOnPath(t,a,o),n[3*s]=o[0],n[3*s+1]=o[1],n[3*s+2]=o[2]}getPathLength(t){return t.length/this.positionSize}getPointOnPath(t,e,n=[]){const{positionSize:r}=this;e*r>=t.length&&(e+=1-t.length/r);const i=e*r;return n[0]=t[i],n[1]=t[i+1],n[2]=3===r&&t[i+2]||0,n}isClosed(t){if(!this.normalize)return this.opts.loop;const{positionSize:e}=this,n=t.length-e;return t[0]===t[n]&&t[1]===t[n+1]&&(2===e||t[2]===t[n+2])}}var US="#define SHADER_NAME path-layer-vertex-shader\n\nattribute vec2 positions;\n\nattribute float instanceTypes;\nattribute vec3 instanceStartPositions;\nattribute vec3 instanceEndPositions;\nattribute vec3 instanceLeftPositions;\nattribute vec3 instanceRightPositions;\nattribute vec3 instanceLeftPositions64Low;\nattribute vec3 instanceStartPositions64Low;\nattribute vec3 instanceEndPositions64Low;\nattribute vec3 instanceRightPositions64Low;\nattribute float instanceStrokeWidths;\nattribute vec4 instanceColors;\nattribute vec3 instancePickingColors;\n\nuniform float widthScale;\nuniform float widthMinPixels;\nuniform float widthMaxPixels;\nuniform float jointType;\nuniform float capType;\nuniform float miterLimit;\nuniform bool billboard;\nuniform int widthUnits;\n\nuniform float opacity;\n\nvarying vec4 vColor;\nvarying vec2 vCornerOffset;\nvarying float vMiterLength;\nvarying vec2 vPathPosition;\nvarying float vPathLength;\nvarying float vJointType;\n\nconst float EPSILON = 0.001;\nconst vec3 ZERO_OFFSET = vec3(0.0);\n\nfloat flipIfTrue(bool flag) {\n  return -(float(flag) * 2. - 1.);\n}\nvec3 lineJoin(\n  vec3 prevPoint, vec3 currPoint, vec3 nextPoint,\n  vec2 width\n) {\n  bool isEnd = positions.x > 0.0;\n  float sideOfPath = positions.y;\n  float isJoint = float(sideOfPath == 0.0);\n\n  vec3 deltaA3 = (currPoint - prevPoint);\n  vec3 deltaB3 = (nextPoint - currPoint);\n\n  mat3 rotationMatrix;\n  bool needsRotation = !billboard && project_needs_rotation(currPoint, rotationMatrix);\n  if (needsRotation) {\n    deltaA3 = deltaA3 * rotationMatrix;\n    deltaB3 = deltaB3 * rotationMatrix;\n  }\n  vec2 deltaA = deltaA3.xy / width;\n  vec2 deltaB = deltaB3.xy / width;\n\n  float lenA = length(deltaA);\n  float lenB = length(deltaB);\n\n  vec2 dirA = lenA > 0. ? normalize(deltaA) : vec2(0.0, 0.0);\n  vec2 dirB = lenB > 0. ? normalize(deltaB) : vec2(0.0, 0.0);\n\n  vec2 perpA = vec2(-dirA.y, dirA.x);\n  vec2 perpB = vec2(-dirB.y, dirB.x);\n  vec2 tangent = dirA + dirB;\n  tangent = length(tangent) > 0. ? normalize(tangent) : perpA;\n  vec2 miterVec = vec2(-tangent.y, tangent.x);\n  vec2 dir = isEnd ? dirA : dirB;\n  vec2 perp = isEnd ? perpA : perpB;\n  float L = isEnd ? lenA : lenB;\n  float sinHalfA = abs(dot(miterVec, perp));\n  float cosHalfA = abs(dot(dirA, miterVec));\n  float turnDirection = flipIfTrue(dirA.x * dirB.y >= dirA.y * dirB.x);\n  float cornerPosition = sideOfPath * turnDirection;\n\n  float miterSize = 1.0 / max(sinHalfA, EPSILON);\n  miterSize = mix(\n    min(miterSize, max(lenA, lenB) / max(cosHalfA, EPSILON)),\n    miterSize,\n    step(0.0, cornerPosition)\n  );\n\n  vec2 offsetVec = mix(miterVec * miterSize, perp, step(0.5, cornerPosition))\n    * (sideOfPath + isJoint * turnDirection);\n  bool isStartCap = lenA == 0.0 || (!isEnd && (instanceTypes == 1.0 || instanceTypes == 3.0));\n  bool isEndCap = lenB == 0.0 || (isEnd && (instanceTypes == 2.0 || instanceTypes == 3.0));\n  bool isCap = isStartCap || isEndCap;\n  if (isCap) {\n    offsetVec = mix(perp * sideOfPath, dir * capType * 4.0 * flipIfTrue(isStartCap), isJoint);\n    vJointType = capType;\n  } else {\n    vJointType = jointType;\n  }\n  vPathLength = L;\n  vCornerOffset = offsetVec;\n  vMiterLength = dot(vCornerOffset, miterVec * turnDirection);\n  vMiterLength = isCap ? isJoint : vMiterLength;\n\n  vec2 offsetFromStartOfPath = vCornerOffset + deltaA * float(isEnd);\n  vPathPosition = vec2(\n    dot(offsetFromStartOfPath, perp),\n    dot(offsetFromStartOfPath, dir)\n  );\n  geometry.uv = vPathPosition;\n\n  float isValid = step(instanceTypes, 3.5);\n  vec3 offset = vec3(offsetVec * width * isValid, 0.0);\n\n  if (needsRotation) {\n    offset = rotationMatrix * offset;\n  }\n  return currPoint + offset;\n}\nvoid clipLine(inout vec4 position, vec4 refPosition) {\n  if (position.w < EPSILON) {\n    float r = (EPSILON - refPosition.w) / (position.w - refPosition.w);\n    position = refPosition + (position - refPosition) * r;\n  }\n}\n\nvoid main() {\n  geometry.pickingColor = instancePickingColors;\n\n  vColor = vec4(instanceColors.rgb, instanceColors.a * opacity);\n\n  float isEnd = positions.x;\n\n  vec3 prevPosition = mix(instanceLeftPositions, instanceStartPositions, isEnd);\n  vec3 prevPosition64Low = mix(instanceLeftPositions64Low, instanceStartPositions64Low, isEnd);\n\n  vec3 currPosition = mix(instanceStartPositions, instanceEndPositions, isEnd);\n  vec3 currPosition64Low = mix(instanceStartPositions64Low, instanceEndPositions64Low, isEnd);\n\n  vec3 nextPosition = mix(instanceEndPositions, instanceRightPositions, isEnd);\n  vec3 nextPosition64Low = mix(instanceEndPositions64Low, instanceRightPositions64Low, isEnd);\n\n  geometry.worldPosition = currPosition;\n  vec2 widthPixels = vec2(clamp(\n    project_size_to_pixel(instanceStrokeWidths * widthScale, widthUnits),\n    widthMinPixels, widthMaxPixels) / 2.0);\n  vec3 width;\n\n  if (billboard) {\n    vec4 prevPositionScreen = project_position_to_clipspace(prevPosition, prevPosition64Low, ZERO_OFFSET);\n    vec4 currPositionScreen = project_position_to_clipspace(currPosition, currPosition64Low, ZERO_OFFSET, geometry.position);\n    vec4 nextPositionScreen = project_position_to_clipspace(nextPosition, nextPosition64Low, ZERO_OFFSET);\n\n    clipLine(prevPositionScreen, currPositionScreen);\n    clipLine(nextPositionScreen, currPositionScreen);\n    clipLine(currPositionScreen, mix(nextPositionScreen, prevPositionScreen, isEnd));\n\n    width = vec3(widthPixels, 0.0);\n    DECKGL_FILTER_SIZE(width, geometry);\n\n    vec3 pos = lineJoin(\n      prevPositionScreen.xyz / prevPositionScreen.w,\n      currPositionScreen.xyz / currPositionScreen.w,\n      nextPositionScreen.xyz / nextPositionScreen.w,\n      project_pixel_size_to_clipspace(width.xy)\n    );\n\n    gl_Position = vec4(pos * currPositionScreen.w, currPositionScreen.w);\n  } else {\n    prevPosition = project_position(prevPosition, prevPosition64Low);\n    currPosition = project_position(currPosition, currPosition64Low);\n    nextPosition = project_position(nextPosition, nextPosition64Low);\n\n    width = vec3(project_pixel_size(widthPixels), 0.0);\n    DECKGL_FILTER_SIZE(width, geometry);\n\n    vec4 pos = vec4(\n      lineJoin(prevPosition, currPosition, nextPosition, width.xy),\n      1.0);\n    geometry.position = pos;\n    gl_Position = project_common_position_to_clipspace(pos);\n  }\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",$S="#define SHADER_NAME path-layer-fragment-shader\n\nprecision highp float;\n\nuniform float miterLimit;\n\nvarying vec4 vColor;\nvarying vec2 vCornerOffset;\nvarying float vMiterLength;\nvarying vec2 vPathPosition;\nvarying float vPathLength;\nvarying float vJointType;\n\nvoid main(void) {\n  geometry.uv = vPathPosition;\n\n  if (vPathPosition.y < 0.0 || vPathPosition.y > vPathLength) {\n    if (vJointType > 0.5 && length(vCornerOffset) > 1.0) {\n      discard;\n    }\n    if (vJointType < 0.5 && vMiterLength > miterLimit + 1.0) {\n      discard;\n    }\n  }\n  gl_FragColor = vColor;\n\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n";const VS=[0,0,0,255],qS={widthUnits:"meters",widthScale:{type:"number",min:0,value:1},widthMinPixels:{type:"number",min:0,value:0},widthMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},jointRounded:!1,capRounded:!1,miterLimit:{type:"number",min:0,value:4},billboard:!1,_pathType:null,getPath:{type:"accessor",value:t=>t.path},getColor:{type:"accessor",value:VS},getWidth:{type:"accessor",value:1},rounded:{deprecatedFor:["jointRounded","capRounded"]}},WS={enter:(t,e)=>{return e.length?e.subarray(e.length-t.length):t}};class GS extends X_{getShaders(){return super.getShaders({vs:US,fs:$S,modules:[fw,lw]})}get wrapLongitude(){return!1}initializeState(){const t=!0,e=this.getAttributeManager();e.addInstanced({positions:{size:3,vertexOffset:1,type:5130,fp64:this.use64bitPositions(),transition:WS,accessor:"getPath",update:this.calculatePositions,noAlloc:t,shaderAttributes:{instanceLeftPositions:{vertexOffset:0},instanceStartPositions:{vertexOffset:1},instanceEndPositions:{vertexOffset:2},instanceRightPositions:{vertexOffset:3}}},instanceTypes:{size:1,type:5121,update:this.calculateSegmentTypes,noAlloc:t},instanceStrokeWidths:{size:1,accessor:"getWidth",transition:WS,defaultValue:1},instanceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,accessor:"getColor",transition:WS,defaultValue:VS},instancePickingColors:{size:3,type:5121,accessor:(t,{index:e,target:n})=>this.encodePickingColor(t&&t.__source?t.__source.index:e,n)}}),this.setState({pathTesselator:new zS({fp64:this.use64bitPositions()})}),this.props.getDashArray&&!this.props.extensions.length&&vn.removed("getDashArray","PathStyleExtension")()}updateState({oldProps:t,props:e,changeFlags:n}){super.updateState({props:e,oldProps:t,changeFlags:n});const r=this.getAttributeManager(),i=n.dataChanged||n.updateTriggersChanged&&(n.updateTriggersChanged.all||n.updateTriggersChanged.getPath);if(i){const{pathTesselator:t}=this.state,i=e.data.attributes||{};t.updateGeometry({data:e.data,geometryBuffer:i.getPath,buffers:i,normalize:!e._pathType,loop:"loop"===e._pathType,getGeometry:e.getPath,positionFormat:e.positionFormat,wrapLongitude:e.wrapLongitude,resolution:this.context.viewport.resolution,dataChanged:n.dataChanged}),this.setState({numInstances:t.instanceCount,startIndices:t.vertexStarts}),n.dataChanged||r.invalidateAll()}if(n.extensionsChanged){var o;const{gl:t}=this.context;null===(o=this.state.model)||void 0===o||o.delete(),this.state.model=this._getModel(t),r.invalidateAll()}}getPickingInfo(t){const e=super.getPickingInfo(t),{index:n}=e,{data:r}=this.props;return r[0]&&r[0].__source&&(e.object=r.find(t=>t.__source.index===n)),e}disablePickingIndex(t){const{data:e}=this.props;if(e[0]&&e[0].__source)for(let n=0;n<e.length;n++)e[n].__source.index===t&&this._disablePickingIndex(n);else this._disablePickingIndex(t)}draw({uniforms:t}){const{jointRounded:e,capRounded:n,billboard:r,miterLimit:i,widthUnits:o,widthScale:s,widthMinPixels:a,widthMaxPixels:u}=this.props;this.state.model.setUniforms(t).setUniforms({jointType:Number(e),capType:Number(n),billboard:r,widthUnits:wn[o],widthScale:s,miterLimit:i,widthMinPixels:a,widthMaxPixels:u}).draw()}_getModel(t){const e=[0,1,2,1,4,2,1,3,4,3,5,4],n=[0,0,0,-1,0,1,1,-1,1,1,1,0];return new Xh(t,{...this.getShaders(),id:this.props.id,geometry:new Zh({drawMode:4,attributes:{indices:new Uint16Array(e),positions:{value:new Float32Array(n),size:2}}}),isInstanced:!0})}calculatePositions(t){const{pathTesselator:e}=this.state;t.startIndices=e.vertexStarts,t.value=e.get("positions")}calculateSegmentTypes(t){const{pathTesselator:e}=this.state;t.startIndices=e.vertexStarts,t.value=e.get("segmentTypes")}}GS.layerName="PathLayer",GS.defaultProps=qS;var HS=n("5664"),XS=n.n(HS);const YS=Yx.CLOCKWISE,ZS=Yx.COUNTER_CLOCKWISE,KS={isClosed:!0};function JS(t){if(t=t&&t.positions||t,!Array.isArray(t)&&!ArrayBuffer.isView(t))throw new Error("invalid polygon")}function QS(t){return t.length>=1&&t[0].length>=2&&Number.isFinite(t[0][0])}function tE(t){const e=t[0],n=t[t.length-1];return e[0]===n[0]&&e[1]===n[1]&&e[2]===n[2]}function eE(t,e,n,r){for(let i=0;i<e;i++)if(t[n+i]!==t[r-e+i])return!1;return!0}function nE(t,e,n,r,i){let o=e;const s=n.length;for(let a=0;a<s;a++)for(let e=0;e<r;e++)t[o++]=n[a][e]||0;if(!tE(n))for(let a=0;a<r;a++)t[o++]=n[0][a]||0;return KS.start=e,KS.end=o,KS.size=r,Zx(t,i,KS),o}function rE(t,e,n,r,i=0,o,s){o=o||n.length;const a=o-i;if(a<=0)return e;let u=e;for(let c=0;c<a;c++)t[u++]=n[i+c];if(!eE(n,r,i,o))for(let c=0;c<r;c++)t[u++]=n[i+c];return KS.start=e,KS.end=u,KS.size=r,Zx(t,s,KS),u}function iE(t,e){JS(t);const n=[],r=[];if(t.positions){const{positions:i,holeIndices:o}=t;if(o){let t=0;for(let s=0;s<=o.length;s++)t=rE(n,t,i,e,o[s-1],o[s],0===s?YS:ZS),r.push(t);return r.pop(),{positions:n,holeIndices:r}}t=i}if(Number.isFinite(t[0]))return rE(n,0,t,e,0,n.length,YS),n;if(!QS(t)){let i=0;for(const[o,s]of t.entries())i=nE(n,i,s,e,0===o?YS:ZS),r.push(i);return r.pop(),{positions:n,holeIndices:r}}return nE(n,0,t,e,YS),n}function oE(t,e,n){let r=null;t.holeIndices&&(r=t.holeIndices.map(t=>t/e));let i=t.positions||t;if(n){const t=i.length;i=i.slice();const r=[];for(let o=0;o<t;o+=e){r[0]=i[o],r[1]=i[o+1];const t=n(r);i[o]=t[0],i[o+1]=t[1]}}return XS()(i,r,e)}class sE extends Jw{constructor(t){const{fp64:e,IndexType:n=Uint32Array}=t;super({...t,attributes:{positions:{size:3,type:e?Float64Array:Float32Array},vertexValid:{type:Uint8ClampedArray,size:1},indices:{type:n,size:1}}})}get(t){const{attributes:e}=this;return"indices"===t?e.indices&&e.indices.subarray(0,this.vertexCount):e[t]}updateGeometry(t){super.updateGeometry(t);const e=this.buffers.indices;e&&(this.vertexCount=(e.value||e).length)}normalizeGeometry(t){if(this.normalize){if(t=iE(t,this.positionSize),this.opts.resolution)return cS(t.positions||t,t.holeIndices,{size:this.positionSize,gridResolution:this.opts.resolution,edgeTypes:!0});if(this.opts.wrapLongitude)return mS(t.positions||t,t.holeIndices,{size:this.positionSize,maxLatitude:86,edgeTypes:!0})}return t}getGeometrySize(t){if(Array.isArray(t)&&!Number.isFinite(t[0])){let e=0;for(const n of t)e+=this.getGeometrySize(n);return e}return(t.positions||t).length/this.positionSize}getGeometryFromBuffer(t){return this.normalize||!this.buffers.indices?super.getGeometryFromBuffer(t):()=>null}updateGeometryAttributes(t,e){if(Array.isArray(t)&&!Number.isFinite(t[0]))for(const n of t){const t=this.getGeometrySize(n);e.geometrySize=t,this.updateGeometryAttributes(n,e),e.vertexStart+=t,e.indexStart=this.indexStarts[e.geometryIndex+1]}else this._updateIndices(t,e),this._updatePositions(t,e),this._updateVertexValid(t,e)}_updateIndices(t,{geometryIndex:e,vertexStart:n,indexStart:r}){const{attributes:i,indexStarts:o,typedArrayManager:s}=this;let a=i.indices;if(!a)return;let u=r;const c=oE(t,this.positionSize,this.opts.preproject);a=s.allocate(a,r+c.length,{copy:!0});for(let l=0;l<c.length;l++)a[u++]=c[l]+n;o[e+1]=r+c.length,i.indices=a}_updatePositions(t,{vertexStart:e,geometrySize:n}){const{attributes:{positions:r},positionSize:i}=this;if(!r)return;const o=t.positions||t;for(let s=e,a=0;a<n;s++,a++){const t=o[a*i],e=o[a*i+1],n=i>2?o[a*i+2]:0;r[3*s]=t,r[3*s+1]=e,r[3*s+2]=n}}_updateVertexValid(t,{vertexStart:e,geometrySize:n}){const{attributes:{vertexValid:r},positionSize:i}=this,o=t&&t.holeIndices;if(t&&t.edgeTypes?r.set(t.edgeTypes,e):r.fill(1,e,e+n),o)for(let s=0;s<o.length;s++)r[e+o[s]/i-1]=0;r[e+n-1]=0}}var aE="\nattribute vec2 vertexPositions;\nattribute float vertexValid;\n\nuniform bool extruded;\nuniform bool isWireframe;\nuniform float elevationScale;\nuniform float opacity;\n\nvarying vec4 vColor;\n\nstruct PolygonProps {\n  vec4 fillColors;\n  vec4 lineColors;\n  vec3 positions;\n  vec3 nextPositions;\n  vec3 pickingColors;\n  vec3 positions64Low;\n  vec3 nextPositions64Low;\n  float elevations;\n};\n\nvec3 project_offset_normal(vec3 vector) {\n  if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||\n    project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSETS) {\n    return normalize(vector * project_uCommonUnitsPerWorldUnit);\n  }\n  return project_normal(vector);\n}\n\nvoid calculatePosition(PolygonProps props) {\n#ifdef IS_SIDE_VERTEX\n  if(vertexValid < 0.5){\n    gl_Position = vec4(0.);\n    return;\n  }\n#endif\n\n  vec3 pos;\n  vec3 pos64Low;\n  vec3 normal;\n  vec4 colors = isWireframe ? props.lineColors : props.fillColors;\n\n  geometry.worldPosition = props.positions;\n  geometry.worldPositionAlt = props.nextPositions;\n  geometry.pickingColor = props.pickingColors;\n\n#ifdef IS_SIDE_VERTEX\n  pos = mix(props.positions, props.nextPositions, vertexPositions.x);\n  pos64Low = mix(props.positions64Low, props.nextPositions64Low, vertexPositions.x);\n#else\n  pos = props.positions;\n  pos64Low = props.positions64Low;\n#endif\n\n  if (extruded) {\n    pos.z += props.elevations * vertexPositions.y * elevationScale;\n\n#ifdef IS_SIDE_VERTEX\n    normal = vec3(\n      props.positions.y - props.nextPositions.y + (props.positions64Low.y - props.nextPositions64Low.y),\n      props.nextPositions.x - props.positions.x + (props.nextPositions64Low.x - props.positions64Low.x),\n      0.0);\n    normal = project_offset_normal(normal);\n#else\n    normal = vec3(0.0, 0.0, 1.0);\n#endif\n    geometry.normal = normal;\n  }\n\n  gl_Position = project_position_to_clipspace(pos, pos64Low, vec3(0.), geometry.position);\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  if (extruded) {\n    vec3 lightColor = lighting_getLightColor(colors.rgb, project_uCameraPosition, geometry.position.xyz, normal);\n    vColor = vec4(lightColor, colors.a * opacity);\n  } else {\n    vColor = vec4(colors.rgb, colors.a * opacity);\n  }\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",uE="#define SHADER_NAME solid-polygon-layer-vertex-shader\n\nattribute vec3 positions;\nattribute vec3 positions64Low;\nattribute float elevations;\nattribute vec4 fillColors;\nattribute vec4 lineColors;\nattribute vec3 pickingColors;\n\n".concat(aE,"\n\nvoid main(void) {\n  PolygonProps props;\n\n  props.positions = positions;\n  props.positions64Low = positions64Low;\n  props.elevations = elevations;\n  props.fillColors = fillColors;\n  props.lineColors = lineColors;\n  props.pickingColors = pickingColors;\n\n  calculatePosition(props);\n}\n"),cE="#define SHADER_NAME solid-polygon-layer-vertex-shader-side\n#define IS_SIDE_VERTEX\n\n\nattribute vec3 instancePositions;\nattribute vec3 nextPositions;\nattribute vec3 instancePositions64Low;\nattribute vec3 nextPositions64Low;\nattribute float instanceElevations;\nattribute vec4 instanceFillColors;\nattribute vec4 instanceLineColors;\nattribute vec3 instancePickingColors;\n\n".concat(aE,"\n\nvoid main(void) {\n  PolygonProps props;\n\n  #if RING_WINDING_ORDER_CW == 1\n    props.positions = instancePositions;\n    props.positions64Low = instancePositions64Low;\n    props.nextPositions = nextPositions;\n    props.nextPositions64Low = nextPositions64Low;\n  #else\n    props.positions = nextPositions;\n    props.positions64Low = nextPositions64Low;\n    props.nextPositions = instancePositions;\n    props.nextPositions64Low = instancePositions64Low;\n  #endif\n  props.elevations = instanceElevations;\n  props.fillColors = instanceFillColors;\n  props.lineColors = instanceLineColors;\n  props.pickingColors = instancePickingColors;\n\n  calculatePosition(props);\n}\n"),lE="#define SHADER_NAME solid-polygon-layer-fragment-shader\n\nprecision highp float;\n\nvarying vec4 vColor;\n\nvoid main(void) {\n  gl_FragColor = vColor;\n\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n";const hE=[0,0,0,255],fE={filled:!0,extruded:!1,wireframe:!1,_normalize:!0,_windingOrder:"CW",elevationScale:{type:"number",min:0,value:1},getPolygon:{type:"accessor",value:t=>t.polygon},getElevation:{type:"accessor",value:1e3},getFillColor:{type:"accessor",value:hE},getLineColor:{type:"accessor",value:hE},material:!0},dE={enter:(t,e)=>{return e.length?e.subarray(e.length-t.length):t}};class pE extends X_{getShaders(t){return super.getShaders({vs:"top"===t?uE:cE,fs:lE,defines:{RING_WINDING_ORDER_CW:this.props._normalize||"CCW"!==this.props._windingOrder?1:0},modules:[fw,Sw,lw]})}get wrapLongitude(){return!1}initializeState(){const{gl:t,viewport:e}=this.context;let{coordinateSystem:n}=this.props;e.isGeospatial&&n===bn.DEFAULT&&(n=bn.LNGLAT),this.setState({numInstances:0,polygonTesselator:new sE({preproject:n===bn.LNGLAT&&e.projectFlat,fp64:this.use64bitPositions(),IndexType:!t||ts(t,Yo.ELEMENT_INDEX_UINT32)?Uint32Array:Uint16Array})});const r=this.getAttributeManager(),i=!0;r.remove(["instancePickingColors"]),r.add({indices:{size:1,isIndexed:!0,update:this.calculateIndices,noAlloc:i},positions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:dE,accessor:"getPolygon",update:this.calculatePositions,noAlloc:i,shaderAttributes:{positions:{vertexOffset:0,divisor:0},instancePositions:{vertexOffset:0,divisor:1},nextPositions:{vertexOffset:1,divisor:1}}},vertexValid:{size:1,divisor:1,type:5121,update:this.calculateVertexValid,noAlloc:i},elevations:{size:1,transition:dE,accessor:"getElevation",shaderAttributes:{elevations:{divisor:0},instanceElevations:{divisor:1}}},fillColors:{alias:"colors",size:this.props.colorFormat.length,type:5121,normalized:!0,transition:dE,accessor:"getFillColor",defaultValue:hE,shaderAttributes:{fillColors:{divisor:0},instanceFillColors:{divisor:1}}},lineColors:{alias:"colors",size:this.props.colorFormat.length,type:5121,normalized:!0,transition:dE,accessor:"getLineColor",defaultValue:hE,shaderAttributes:{lineColors:{divisor:0},instanceLineColors:{divisor:1}}},pickingColors:{size:3,type:5121,accessor:(t,{index:e,target:n})=>this.encodePickingColor(t&&t.__source?t.__source.index:e,n),shaderAttributes:{pickingColors:{divisor:0},instancePickingColors:{divisor:1}}}})}getPickingInfo(t){const e=super.getPickingInfo(t),{index:n}=e,{data:r}=this.props;return r[0]&&r[0].__source&&(e.object=r.find(t=>t.__source.index===n)),e}disablePickingIndex(t){const{data:e}=this.props;if(e[0]&&e[0].__source)for(let n=0;n<e.length;n++)e[n].__source.index===t&&this._disablePickingIndex(n);else this._disablePickingIndex(t)}draw({uniforms:t}){const{extruded:e,filled:n,wireframe:r,elevationScale:i}=this.props,{topModel:o,sideModel:s,polygonTesselator:a}=this.state,u={...t,extruded:Boolean(e),elevationScale:i};s&&(s.setInstanceCount(a.instanceCount-1),s.setUniforms(u),r&&(s.setDrawMode(3),s.setUniforms({isWireframe:!0}).draw()),n&&(s.setDrawMode(6),s.setUniforms({isWireframe:!1}).draw())),o&&(o.setVertexCount(a.vertexCount),o.setUniforms(u).draw())}updateState(t){super.updateState(t),this.updateGeometry(t);const{props:e,oldProps:n,changeFlags:r}=t,i=this.getAttributeManager(),o=r.extensionsChanged||e.filled!==n.filled||e.extruded!==n.extruded;var s;o&&(null===(s=this.state.models)||void 0===s||s.forEach(t=>t.delete()),this.setState(this._getModels(this.context.gl)),i.invalidateAll())}updateGeometry({props:t,oldProps:e,changeFlags:n}){const r=n.dataChanged||n.updateTriggersChanged&&(n.updateTriggersChanged.all||n.updateTriggersChanged.getPolygon);if(r){const{polygonTesselator:e}=this.state,r=t.data.attributes||{};e.updateGeometry({data:t.data,normalize:t._normalize,geometryBuffer:r.getPolygon,buffers:r,getGeometry:t.getPolygon,positionFormat:t.positionFormat,wrapLongitude:t.wrapLongitude,resolution:this.context.viewport.resolution,fp64:this.use64bitPositions(),dataChanged:n.dataChanged}),this.setState({numInstances:e.instanceCount,startIndices:e.vertexStarts}),n.dataChanged||this.getAttributeManager().invalidateAll()}}_getModels(t){const{id:e,filled:n,extruded:r}=this.props;let i,o;if(n){const n=this.getShaders("top");n.defines.NON_INSTANCED_MODEL=1,i=new Xh(t,{...n,id:"".concat(e,"-top"),drawMode:4,attributes:{vertexPositions:new Float32Array([0,1])},uniforms:{isWireframe:!1,isSideVertex:!1},vertexCount:0,isIndexed:!0})}return r&&(o=new Xh(t,{...this.getShaders("side"),id:"".concat(e,"-side"),geometry:new Zh({drawMode:1,vertexCount:4,attributes:{vertexPositions:{size:2,value:new Float32Array([1,0,0,0,0,1,1,1])}}}),instanceCount:0,isInstanced:1}),o.userData.excludeAttributes={indices:!0}),{models:[o,i].filter(Boolean),topModel:i,sideModel:o}}calculateIndices(t){const{polygonTesselator:e}=this.state;t.startIndices=e.indexStarts,t.value=e.get("indices")}calculatePositions(t){const{polygonTesselator:e}=this.state;t.startIndices=e.vertexStarts,t.value=e.get("positions")}calculateVertexValid(t){t.value=this.state.polygonTesselator.get("vertexValid")}}function gE({data:t,getIndex:e,dataRange:n,replace:r}){const{startRow:i=0,endRow:o=1/0}=n,s=t.length;let a=s,u=s;for(let f=0;f<s;f++){const n=e(t[f]);if(a>f&&n>=i&&(a=f),n>=o){u=f;break}}let c=a;const l=u-a!==r.length,h=l&&t.slice(u);for(let f=0;f<r.length;f++)t[c++]=r[f];if(l){for(let e=0;e<h.length;e++)t[c++]=h[e];t.length=c}return{startRow:a,endRow:a+r.length}}pE.layerName="SolidPolygonLayer",pE.defaultProps=fE;const mE=[0,0,0,255],yE=[0,0,0,255],vE={stroked:!0,filled:!0,extruded:!1,elevationScale:1,wireframe:!1,_normalize:!0,_windingOrder:"CW",lineWidthUnits:"meters",lineWidthScale:1,lineWidthMinPixels:0,lineWidthMaxPixels:Number.MAX_SAFE_INTEGER,lineJointRounded:!1,lineMiterLimit:4,getPolygon:{type:"accessor",value:t=>t.polygon},getFillColor:{type:"accessor",value:yE},getLineColor:{type:"accessor",value:mE},getLineWidth:{type:"accessor",value:1},getElevation:{type:"accessor",value:1e3},material:!0};class bE extends Z_{initializeState(){this.state={paths:[]},this.props.getLineDashArray&&vn.removed("getLineDashArray","PathStyleExtension")()}updateState({oldProps:t,props:e,changeFlags:n}){const r=n.dataChanged||n.updateTriggersChanged&&(n.updateTriggersChanged.all||n.updateTriggersChanged.getPolygon);if(r&&Array.isArray(n.dataChanged)){const t=this.state.paths.slice(),e=n.dataChanged.map(e=>gE({data:t,getIndex:t=>t.__source.index,dataRange:e,replace:this._getPaths(e)}));this.setState({paths:t,pathsDiff:e})}else r&&this.setState({paths:this._getPaths(),pathsDiff:null})}_getPaths(t={}){const{data:e,getPolygon:n,positionFormat:r,_normalize:i}=this.props,o=[],s="XY"===r?2:3,{startRow:a,endRow:u}=t,{iterable:c,objectInfo:l}=Av(e,a,u);for(const h of c){l.index++;let t=n(h,l);i&&(t=iE(t,s));const{holeIndices:e}=t,r=t.positions||t;if(e)for(let n=0;n<=e.length;n++){const t=r.slice(e[n-1]||0,e[n]||r.length);o.push(this.getSubLayerRow({path:t},h,l.index))}else o.push(this.getSubLayerRow({path:r},h,l.index))}return o}renderLayers(){const{data:t,_dataDiff:e,stroked:n,filled:r,extruded:i,wireframe:o,_normalize:s,_windingOrder:a,elevationScale:u,transitions:c,positionFormat:l}=this.props,{lineWidthUnits:h,lineWidthScale:f,lineWidthMinPixels:d,lineWidthMaxPixels:p,lineJointRounded:g,lineMiterLimit:m,lineDashJustified:y}=this.props,{getFillColor:v,getLineColor:b,getLineWidth:_,getLineDashArray:w,getElevation:x,getPolygon:S,updateTriggers:E,material:A}=this.props,{paths:M,pathsDiff:C}=this.state,k=this.getSubLayerClass("fill",pE),O=this.getSubLayerClass("stroke",GS),P=this.shouldRenderSubLayer("fill",M)&&new k({_dataDiff:e,extruded:i,elevationScale:u,filled:r,wireframe:o,_normalize:s,_windingOrder:a,getElevation:x,getFillColor:v,getLineColor:i&&o?b:mE,material:A,transitions:c},this.getSubLayerProps({id:"fill",updateTriggers:{getPolygon:E.getPolygon,getElevation:E.getElevation,getFillColor:E.getFillColor,lineColors:i&&o,getLineColor:E.getLineColor}}),{data:t,positionFormat:l,getPolygon:S}),T=!i&&n&&this.shouldRenderSubLayer("stroke",M)&&new O({_dataDiff:C&&(()=>C),widthUnits:h,widthScale:f,widthMinPixels:d,widthMaxPixels:p,jointRounded:g,miterLimit:m,dashJustified:y,_pathType:"loop",transitions:c&&{getWidth:c.getLineWidth,getColor:c.getLineColor,getPath:c.getPolygon},getColor:this.getSubLayerAccessor(b),getWidth:this.getSubLayerAccessor(_),getDashArray:this.getSubLayerAccessor(w)},this.getSubLayerProps({id:"stroke",updateTriggers:{getWidth:E.getLineWidth,getColor:E.getLineColor,getDashArray:E.getLineDashArray}}),{data:M,positionFormat:l,getPath:t=>t.path});return[!i&&P,T,i&&P]}}function _E(t,e){if(!t)return null;const n="startIndices"in t?t.startIndices[e]:e,r=t.featureIds.value[n];return-1!==n?wE(t,r,n):null}function wE(t,e,n){const r={properties:{...t.properties[e]}};for(const i in t.numericProps)r.properties[i]=t.numericProps[i].value[n];return r}function xE(t,e){const n={points:null,lines:null,polygons:null};for(const r in n){const i=t[r].globalFeatureIds.value;n[r]=new Uint8ClampedArray(3*i.length);const o=[];for(let t=0;t<i.length;t++)e(i[t],o),n[r][3*t+0]=o[0],n[r][3*t+1]=o[1],n[r][3*t+2]=o[2]}return n}bE.layerName="PolygonLayer",bE.defaultProps=vE;var SE="#define SHADER_NAME multi-icon-layer-fragment-shader\n\nprecision highp float;\n\nuniform float opacity;\nuniform sampler2D iconsTexture;\nuniform float gamma;\nuniform bool sdf;\nuniform float alphaCutoff;\nuniform float buffer;\nuniform float outlineBuffer;\nuniform vec4 outlineColor;\n\nvarying vec4 vColor;\nvarying vec2 vTextureCoords;\nvarying vec2 uv;\n\nvoid main(void) {\n  geometry.uv = uv;\n\n  if (!picking_uActive) {\n    float alpha = texture2D(iconsTexture, vTextureCoords).a;\n    vec4 color = vColor;\n    if (sdf) {\n      float distance = alpha;\n      alpha = smoothstep(buffer - gamma, buffer + gamma, distance);\n\n      if (outlineBuffer > 0.0) {\n        float inFill = alpha;\n        float inBorder = smoothstep(outlineBuffer - gamma, outlineBuffer + gamma, distance);\n        color = mix(outlineColor, vColor, inFill);\n        alpha = inBorder;\n      }\n    }\n    float a = alpha * color.a;\n    \n    if (a < alphaCutoff) {\n      discard;\n    }\n\n    gl_FragColor = vec4(color.rgb, a * opacity);\n  }\n\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n";const EE=.75,AE=[],ME={getIconOffsets:{type:"accessor",value:t=>t.offsets},alphaCutoff:.001,smoothing:.1,outlineWidth:0,outlineColor:{type:"color",value:[0,0,0,255]}};class CE extends Tx{getShaders(){return{...super.getShaders(),fs:SE}}initializeState(){super.initializeState();const t=this.getAttributeManager();t.addInstanced({instanceOffsets:{size:2,accessor:"getIconOffsets"},instancePickingColors:{type:5121,size:3,accessor:(t,{index:e,target:n})=>this.encodePickingColor(e,n)}})}updateState(t){super.updateState(t);const{props:e,oldProps:n}=t;let{outlineColor:r}=e;r!==n.outlineColor&&(r=r.map(t=>t/255),r[3]=Number.isFinite(r[3])?r[3]:1,this.setState({outlineColor:r})),!e.sdf&&e.outlineWidth&&vn.warn("".concat(this.id,": fontSettings.sdf is required to render outline"))()}draw(t){const{sdf:e,smoothing:n,outlineWidth:r}=this.props,{outlineColor:i}=this.state;t.uniforms={...t.uniforms,buffer:EE,outlineBuffer:r?Math.max(n,EE*(1-r)):-1,gamma:n,sdf:Boolean(e),outlineColor:i},super.draw(t)}getInstanceOffset(t){return t?Array.from(t).map(t=>super.getInstanceOffset(t)):AE}getInstanceColorMode(t){return 1}getInstanceIconFrame(t){return t?Array.from(t).map(t=>super.getInstanceIconFrame(t)):AE}}CE.layerName="MultiIconLayer",CE.defaultProps=ME;var kE=n("af19"),OE=n.n(kE);const PE=32,TE=[];function LE(t){return Math.pow(2,Math.ceil(Math.log2(t)))}function IE({characterSet:t,getFontWidth:e,fontHeight:n,buffer:r,maxCanvasWidth:i,mapping:o={},xOffset:s=0,yOffset:a=0}){let u=0,c=s,l=0;for(const f of t)if(!o[f]){const t=e(f,l++);c+t+2*r>i&&(c=0,u++),o[f]={x:c+r,y:a+u*(n+2*r)+r,width:t,height:n},c+=t+2*r}const h=n+2*r;return{mapping:o,xOffset:c,yOffset:a+u*h,canvasHeight:LE(a+(u+1)*h)}}function NE(t,e,n,r){let i=0;for(let o=e;o<n;o++){const e=t[o];let n=null;const s=r&&r[e];s&&(n=s.width),i+=n}return i}function DE(t,e,n,r,i,o){let s=e,a=0;for(let u=e;u<n;u++){const e=NE(t,u,u+1,i);a+e>r&&(s<u&&o.push(u),s=u,a=0),a+=e}return a}function RE(t,e,n,r,i,o){let s=e,a=e,u=e,c=0;for(let l=e;l<n;l++)if(" "===t[l]?u=l+1:" "!==t[l+1]&&l+1!==n||(u=l+1),u>a){let e=NE(t,a,u,i);c+e>r&&(s<a&&(o.push(a),s=a,c=0),e>r&&(e=DE(t,a,u,r,i,o),s=o[o.length-1])),a=u,c+=e}return c}function FE(t,e,n,r,i=0,o){void 0===o&&(o=t.length);const s=[];return"break-all"===e?DE(t,i,o,n,r,s):RE(t,i,o,n,r,s),s}function BE(t,e,n,r,i,o){let s=0,a=0;for(let u=e;u<n;u++){const e=t[u],n=r[e];n?(a||(a=n.height),i[u]=s+n.width/2,s+=n.width):(vn.warn("Missing character: ".concat(e," (").concat(e.codePointAt(0),")"))(),i[u]=s,s+=PE)}o[0]=s,o[1]=a}function jE(t,e,n,r,i){t=Array.from(t);const o=t.length,s=new Array(o),a=new Array(o),u=new Array(o),c=("break-word"===n||"break-all"===n)&&isFinite(r)&&r>0,l=[0,0],h=[];let f=0,d=0,p=0;for(let g=0;g<=o;g++){const m=t[g];if("\n"!==m&&g!==o||(p=g),p>d){const o=c?FE(t,n,r,i,d,p):TE;for(let n=0;n<=o.length;n++){const r=0===n?d:o[n-1],c=n<o.length?o[n]:p;BE(t,r,c,i,s,h);for(let t=r;t<c;t++)a[t]=f+h[1]/2,u[t]=h[0];f+=h[1]*e,l[0]=Math.max(l[0],h[0])}d=p}"\n"===m&&(s[d]=0,a[d]=0,u[d]=0,d++)}return l[1]=f,{x:s,y:a,rowWidth:u,size:l}}function zE({value:t,length:e,stride:n,offset:r,startIndices:i,characterSet:o}){const s=t.BYTES_PER_ELEMENT,a=n?n/s:1,u=r?r/s:0,c=i[e]||Math.ceil((t.length-u)/a),l=o&&new Set,h=new Array(e);let f=t;if(a>1||u>0){f=new t.constructor(c);for(let e=0;e<c;e++)f[e]=t[e*a+u]}for(let d=0;d<e;d++){const t=i[d],e=i[d+1]||c,n=f.subarray(t,e);h[d]=String.fromCodePoint.apply(null,n),l&&n.forEach(l.add,l)}if(l)for(const d of l)o.add(String.fromCodePoint(d));return{texts:h,characterCount:c}}class UE{constructor(t=5){this.limit=t,this.clear()}clear(){this._cache={},this._order=[]}get(t){const e=this._cache[t];return e&&(this._deleteOrder(t),this._appendOrder(t)),e}set(t,e){this._cache[t]?(this.delete(t),this._cache[t]=e,this._appendOrder(t)):(Object.keys(this._cache).length===this.limit&&this.delete(this._order[0]),this._cache[t]=e,this._appendOrder(t))}delete(t){const e=this._cache[t];e&&(this._deleteCache(t),this._deleteOrder(t))}_deleteCache(t){delete this._cache[t]}_deleteOrder(t){const e=this._order.findIndex(e=>e===t);e>=0&&this._order.splice(e,1)}_appendOrder(t){this._order.push(t)}}function $E(){const t=[];for(let e=32;e<128;e++)t.push(String.fromCharCode(e));return t}const VE=$E(),qE="Monaco, monospace",WE="normal",GE=64,HE=4,XE=.25,YE=12,ZE=1024,KE=.9,JE=1.2,QE=3,tA=new UE(QE),eA=["fontFamily","fontWeight","characterSet","fontSize","sdf","buffer","cutoff","radius"];function nA(t,e){const n=tA.get(t);if(!n)return e;const r=[],i=n.mapping;let o=Object.keys(i);o=new Set(o);let s=e;return s instanceof Array&&(s=new Set(s)),s.forEach(t=>{o.has(t)||r.push(t)}),r}function rA(t,e){for(let n=0;n<t.length;n++)e.data[4*n+3]=t[n]}function iA(t,e,n,r){t.font="".concat(r," ").concat(n,"px ").concat(e),t.fillStyle="#000",t.textBaseline="baseline",t.textAlign="left"}class oA{constructor(){this.props={fontFamily:qE,fontWeight:WE,characterSet:VE,fontSize:GE,buffer:HE,sdf:!1,cutoff:XE,radius:YE},this._key=null,this._atlas=null}get texture(){return this._atlas}get mapping(){return this._atlas&&this._atlas.mapping}get scale(){return JE}setProps(t={}){eA.forEach(e=>{e in t&&(this.props[e]=t[e])});const e=this._key;this._key=this._getKey();const n=nA(this._key,this.props.characterSet),r=tA.get(this._key);if(r&&0===n.length)return void(this._key!==e&&(this._atlas=r));const i=this._generateFontAtlas(this._key,n,r);this._atlas=i,tA.set(this._key,i)}_generateFontAtlas(t,e,n){const{fontFamily:r,fontWeight:i,fontSize:o,buffer:s,sdf:a,radius:u,cutoff:c}=this.props;let l=n&&n.data;l||(l=document.createElement("canvas"),l.width=ZE);const h=l.getContext("2d");iA(h,r,o,i);const{mapping:f,canvasHeight:d,xOffset:p,yOffset:g}=IE({getFontWidth:t=>h.measureText(t).width,fontHeight:o*JE,buffer:s,characterSet:e,maxCanvasWidth:ZE,...n&&{mapping:n.mapping,xOffset:n.xOffset,yOffset:n.yOffset}});if(l.height!==d){const t=h.getImageData(0,0,l.width,l.height);l.height=d,h.putImageData(t,0,0)}if(iA(h,r,o,i),a){const t=new OE.a(o,s,u,c,r,i),n=h.getImageData(0,0,t.size,t.size);for(const r of e)rA(t.draw(r),n),h.putImageData(n,f[r].x-s,f[r].y+s)}else for(const m of e)h.fillText(m,f[m].x,f[m].y+o*KE);return{xOffset:p,yOffset:g,mapping:f,data:l,width:l.width,height:l.height}}_getKey(){const{fontFamily:t,fontWeight:e,fontSize:n,buffer:r,sdf:i,radius:o,cutoff:s}=this.props;return i?"".concat(t," ").concat(e," ").concat(n," ").concat(r," ").concat(o," ").concat(s):"".concat(t," ").concat(e," ").concat(n," ").concat(r)}}var sA="#define SHADER_NAME text-background-layer-vertex-shader\n\nattribute vec2 positions;\n\nattribute vec3 instancePositions;\nattribute vec3 instancePositions64Low;\nattribute vec4 instanceRects;\nattribute float instanceSizes;\nattribute float instanceAngles;\nattribute vec2 instancePixelOffsets;\nattribute float instanceLineWidths;\nattribute vec4 instanceFillColors;\nattribute vec4 instanceLineColors;\nattribute vec3 instancePickingColors;\n\nuniform bool billboard;\nuniform float opacity;\nuniform float sizeScale;\nuniform float sizeMinPixels;\nuniform float sizeMaxPixels;\nuniform vec4 padding;\nuniform int sizeUnits;\n\nvarying vec4 vFillColor;\nvarying vec4 vLineColor;\nvarying float vLineWidth;\nvarying vec2 uv;\nvarying vec2 dimensions;\n\nvec2 rotate_by_angle(vec2 vertex, float angle) {\n  float angle_radian = radians(angle);\n  float cos_angle = cos(angle_radian);\n  float sin_angle = sin(angle_radian);\n  mat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);\n  return rotationMatrix * vertex;\n}\n\nvoid main(void) {\n  geometry.worldPosition = instancePositions;\n  geometry.uv = positions;\n  geometry.pickingColor = instancePickingColors;\n  uv = positions;\n  vLineWidth = instanceLineWidths;\n  float sizePixels = clamp(\n    project_size_to_pixel(instanceSizes * sizeScale, sizeUnits),\n    sizeMinPixels, sizeMaxPixels\n  );\n\n  dimensions = instanceRects.zw * sizePixels + padding.xy + padding.zw;\n\n  vec2 pixelOffset = (positions * instanceRects.zw + instanceRects.xy) * sizePixels + mix(-padding.xy, padding.zw, positions);\n  pixelOffset = rotate_by_angle(pixelOffset, instanceAngles);\n  pixelOffset += instancePixelOffsets;\n  pixelOffset.y *= -1.0;\n\n  if (billboard)  {\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);\n    vec3 offset = vec3(pixelOffset, 0.0);\n    DECKGL_FILTER_SIZE(offset, geometry);\n    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);\n  } else {\n    vec3 offset_common = vec3(project_pixel_size(pixelOffset), 0.0);\n    DECKGL_FILTER_SIZE(offset_common, geometry);\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset_common, geometry.position);\n  }\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n  vFillColor = vec4(instanceFillColors.rgb, instanceFillColors.a * opacity);\n  DECKGL_FILTER_COLOR(vFillColor, geometry);\n  vLineColor = vec4(instanceLineColors.rgb, instanceLineColors.a * opacity);\n  DECKGL_FILTER_COLOR(vLineColor, geometry);\n}\n",aA="#define SHADER_NAME text-background-layer-fragment-shader\n\nprecision highp float;\n\nuniform bool stroked;\n\nvarying vec4 vFillColor;\nvarying vec4 vLineColor;\nvarying float vLineWidth;\nvarying vec2 uv;\nvarying vec2 dimensions;\n\nvoid main(void) {\n  geometry.uv = uv;\n\n  vec2 pixelPosition = uv * dimensions;\n  if (stroked) {\n    float distToEdge = min(\n      min(pixelPosition.x, dimensions.x - pixelPosition.x),\n      min(pixelPosition.y, dimensions.y - pixelPosition.y)\n    );\n    float isBorder = smoothedge(distToEdge, vLineWidth);\n    gl_FragColor = mix(vFillColor, vLineColor, isBorder);\n  } else {\n    gl_FragColor = vFillColor;\n  }\n\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n";const uA={billboard:!0,sizeScale:1,sizeUnits:"pixels",sizeMinPixels:0,sizeMaxPixels:Number.MAX_SAFE_INTEGER,padding:{type:"array",value:[0,0,0,0]},getPosition:{type:"accessor",value:t=>t.position},getSize:{type:"accessor",value:1},getAngle:{type:"accessor",value:0},getPixelOffset:{type:"accessor",value:[0,0]},getBoundingRect:{type:"accessor",value:[0,0,0,0]},getFillColor:{type:"accessor",value:[0,0,0,255]},getLineColor:{type:"accessor",value:[0,0,0,255]},getLineWidth:{type:"accessor",value:1}};class cA extends X_{getShaders(){return super.getShaders({vs:sA,fs:aA,modules:[fw,lw]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceSizes:{size:1,transition:!0,accessor:"getSize",defaultValue:1},instanceAngles:{size:1,transition:!0,accessor:"getAngle"},instanceRects:{size:4,accessor:"getBoundingRect"},instancePixelOffsets:{size:2,transition:!0,accessor:"getPixelOffset"},instanceFillColors:{size:4,transition:!0,normalized:!0,type:5121,accessor:"getFillColor",defaultValue:[0,0,0,255]},instanceLineColors:{size:4,transition:!0,normalized:!0,type:5121,accessor:"getLineColor",defaultValue:[0,0,0,255]},instanceLineWidths:{size:1,transition:!0,accessor:"getLineWidth",defaultValue:1}})}updateState({props:t,oldProps:e,changeFlags:n}){if(super.updateState({props:t,oldProps:e,changeFlags:n}),n.extensionsChanged){var r;const{gl:t}=this.context;null===(r=this.state.model)||void 0===r||r.delete(),this.state.model=this._getModel(t),this.getAttributeManager().invalidateAll()}}draw({uniforms:t}){const{billboard:e,sizeScale:n,sizeUnits:r,sizeMinPixels:i,sizeMaxPixels:o,getLineWidth:s}=this.props;let{padding:a}=this.props;a.length<4&&(a=[a[0],a[1],a[0],a[1]]),this.state.model.setUniforms(t).setUniforms({billboard:e,stroked:Boolean(s),padding:a,sizeUnits:wn[r],sizeScale:n,sizeMinPixels:i,sizeMaxPixels:o}).draw()}_getModel(t){const e=[0,0,1,0,1,1,0,1];return new Xh(t,{...this.getShaders(),id:this.props.id,geometry:new Zh({drawMode:6,vertexCount:4,attributes:{positions:{size:2,value:new Float32Array(e)}}}),isInstanced:!0})}}cA.layerName="TextBackgroundLayer",cA.defaultProps=uA;const lA={fontSize:GE,buffer:HE,sdf:!1,radius:YE,cutoff:XE,smoothing:.1},hA={start:1,middle:0,end:-1},fA={top:1,center:0,bottom:-1},dA=[0,0,0,255],pA=1,gA=["fontSize","buffer","sdf","radius","cutoff"],mA={billboard:!0,sizeScale:1,sizeUnits:"pixels",sizeMinPixels:0,sizeMaxPixels:Number.MAX_SAFE_INTEGER,background:!1,getBackgroundColor:{type:"accessor",value:[255,255,255,255]},getBorderColor:{type:"accessor",value:dA},getBorderWidth:{type:"accessor",value:0},backgroundPadding:{type:"array",value:[0,0,0,0]},characterSet:{type:"object",value:VE},fontFamily:qE,fontWeight:WE,lineHeight:pA,outlineWidth:{type:"number",value:0,min:0},outlineColor:{type:"color",value:dA},fontSettings:{},wordBreak:"break-word",maxWidth:{type:"number",value:-1},getText:{type:"accessor",value:t=>t.text},getPosition:{type:"accessor",value:t=>t.position},getColor:{type:"accessor",value:dA},getSize:{type:"accessor",value:32},getAngle:{type:"accessor",value:0},getTextAnchor:{type:"accessor",value:"middle"},getAlignmentBaseline:{type:"accessor",value:"center"},getPixelOffset:{type:"accessor",value:[0,0]},backgroundColor:{deprecatedFor:["background","getBackgroundColor"]}};class yA extends Z_{initializeState(){this.state={styleVersion:0,fontAtlasManager:new oA}}updateState({props:t,oldProps:e,changeFlags:n}){const r=n.dataChanged||n.updateTriggersChanged&&(n.updateTriggersChanged.all||n.updateTriggersChanged.getText),i=this.state.characterSet;r&&this._updateText();const o=i!==this.state.characterSet||this._fontChanged(e,t);o&&this._updateFontAtlas(e,t);const s=o||t.lineHeight!==e.lineHeight||t.wordBreak!==e.wordBreak||t.maxWidth!==e.maxWidth;s&&this.setState({styleVersion:this.state.styleVersion+1})}getPickingInfo({info:t}){return t.object=t.index>=0?this.props.data[t.index]:null,t}_updateFontAtlas(t,e){const{fontSettings:n,fontFamily:r,fontWeight:i}=e,{fontAtlasManager:o,characterSet:s}=this.state;o.setProps({...lA,...n,characterSet:s,fontFamily:r,fontWeight:i})}_fontChanged(t,e){if(t.fontFamily!==e.fontFamily||t.fontWeight!==e.fontWeight)return!0;if(t.fontSettings===e.fontSettings)return!1;const n=t.fontSettings||{},r=e.fontSettings||{};return gA.some(t=>n[t]!==r[t])}_updateText(){const{data:t,characterSet:e}=this.props,n=t.attributes&&t.attributes.getText;let r,{getText:i}=this.props,{startIndices:o}=t;const s="auto"===e&&new Set;if(n&&o){const{texts:e,characterCount:a}=zE({...ArrayBuffer.isView(n)?{value:n}:n,length:t.length,startIndices:o,characterSet:s});r=a,i=(t,{index:n})=>e[n]}else{const{iterable:e,objectInfo:n}=Av(t);o=[0],r=0;for(const t of e){n.index++;const e=Array.from(i(t,n)||"");s&&e.forEach(s.add,s),r+=e.length,o.push(r)}}this.setState({getText:i,startIndices:o,numInstances:r,characterSet:s||e})}getBoundingRect(t,e){const n=this.state.fontAtlasManager.mapping,{getText:r}=this.state,{wordBreak:i,maxWidth:o,lineHeight:s,getTextAnchor:a,getAlignmentBaseline:u}=this.props,c=r(t,e)||"",{size:[l,h]}=jE(c,s,i,o,n),f=hA["function"===typeof a?a(t,e):a],d=fA["function"===typeof u?u(t,e):u];return[(f-1)*l/2,(d-1)*h/2,l,h]}getIconOffsets(t,e){const n=this.state.fontAtlasManager.mapping,{getText:r}=this.state,{wordBreak:i,maxWidth:o,lineHeight:s,getTextAnchor:a,getAlignmentBaseline:u}=this.props,c=r(t,e)||"",{x:l,y:h,rowWidth:f,size:[d,p]}=jE(c,s,i,o,n),g=hA["function"===typeof a?a(t,e):a],m=fA["function"===typeof u?u(t,e):u],y=l.length,v=new Array(2*y);let b=0;for(let _=0;_<y;_++){const t=(1-g)*(d-f[_])/2;v[b++]=(g-1)*d/2+t+l[_],v[b++]=(m-1)*p/2+h[_]}return v}renderLayers(){const{startIndices:t,numInstances:e,getText:n,fontAtlasManager:{scale:r,texture:i,mapping:o},styleVersion:s}=this.state,{data:a,_dataDiff:u,getPosition:c,getColor:l,getSize:h,getAngle:f,getPixelOffset:d,getBackgroundColor:p,getBorderColor:g,getBorderWidth:m,backgroundPadding:y,background:v,billboard:b,fontSettings:_,outlineWidth:w,outlineColor:x,sizeScale:S,sizeUnits:E,sizeMinPixels:A,sizeMaxPixels:M,transitions:C,updateTriggers:k}=this.props,O=this.getSubLayerClass("characters",CE),P=this.getSubLayerClass("background",cA);return[v&&new P({getFillColor:p,getLineColor:g,getLineWidth:m,padding:y,getPosition:c,getSize:h,getAngle:f,getPixelOffset:d,billboard:b,sizeScale:S/this.state.fontAtlasManager.props.fontSize,sizeUnits:E,sizeMinPixels:A,sizeMaxPixels:M,transitions:C&&{getPosition:C.getPosition,getAngle:C.getAngle,getSize:C.getSize,getFillColor:C.getBackgroundColor,getLineColor:C.getBorderColor,getLineWidth:C.getBorderWidth,getPixelOffset:C.getPixelOffset}},this.getSubLayerProps({id:"background",updateTriggers:{getPosition:k.getPosition,getAngle:k.getAngle,getSize:k.getSize,getFillColor:k.getBackgroundColor,getLineColor:k.getBorderColor,getLineWidth:k.getBorderWidth,getPixelOffset:k.getPixelOffset,getBoundingRect:{getText:k.getText,getTextAnchor:k.getTextAnchor,getAlignmentBaseline:k.getAlignmentBaseline,styleVersion:s}}}),{data:a.attributes?{length:a.length,attributes:a.attributes.background||{}}:a,_dataDiff:u,autoHighlight:!1,getBoundingRect:this.getBoundingRect.bind(this)}),new O({sdf:_.sdf,smoothing:Number.isFinite(_.smoothing)?_.smoothing:lA.smoothing,outlineWidth:w,outlineColor:x,iconAtlas:i,iconMapping:o,getPosition:c,getColor:l,getSize:h,getAngle:f,getPixelOffset:d,billboard:b,sizeScale:S*r,sizeUnits:E,sizeMinPixels:A*r,sizeMaxPixels:M*r,transitions:C&&{getPosition:C.getPosition,getAngle:C.getAngle,getColor:C.getColor,getSize:C.getSize,getPixelOffset:C.getPixelOffset}},this.getSubLayerProps({id:"characters",updateTriggers:{getIcon:k.getText,getPosition:k.getPosition,getAngle:k.getAngle,getColor:k.getColor,getSize:k.getSize,getPixelOffset:k.getPixelOffset,getIconOffsets:{getText:k.getText,getTextAnchor:k.getTextAnchor,getAlignmentBaseline:k.getAlignmentBaseline,styleVersion:s}}}),{data:a,_dataDiff:u,startIndices:t,numInstances:e,getIconOffsets:this.getIconOffsets.bind(this),getIcon:n})]}}yA.layerName="TextLayer",yA.defaultProps=mA;const vA={circle:{type:Xx,props:{filled:"filled",stroked:"stroked",lineWidthMaxPixels:"lineWidthMaxPixels",lineWidthMinPixels:"lineWidthMinPixels",lineWidthScale:"lineWidthScale",lineWidthUnits:"lineWidthUnits",pointRadiusMaxPixels:"radiusMaxPixels",pointRadiusMinPixels:"radiusMinPixels",pointRadiusScale:"radiusScale",pointRadiusUnits:"radiusUnits",pointAntialiasing:"antialiasing",pointBillboard:"billboard",getFillColor:"getFillColor",getLineColor:"getLineColor",getLineWidth:"getLineWidth",getPointRadius:"getRadius"}},icon:{type:Tx,props:{iconAtlas:"iconAtlas",iconMapping:"iconMapping",iconSizeMaxPixels:"sizeMaxPixels",iconSizeMinPixels:"sizeMinPixels",iconSizeScale:"sizeScale",iconSizeUnits:"sizeUnits",iconAlphaCutoff:"alphaCutoff",iconBillboard:"billboard",getIcon:"getIcon",getIconAngle:"getAngle",getIconColor:"getColor",getIconPixelOffset:"getPixelOffset",getIconSize:"getSize"}},text:{type:yA,props:{textSizeMaxPixels:"sizeMaxPixels",textSizeMinPixels:"sizeMinPixels",textSizeScale:"sizeScale",textSizeUnits:"sizeUnits",textBackground:"background",textBackgroundPadding:"backgroundPadding",textFontFamily:"fontFamily",textFontWeight:"fontWeight",textLineHeight:"lineHeight",textMaxWidth:"maxWidth",textOutlineColor:"outlineColor",textOutlineWidth:"outlineWidth",textWordBreak:"wordBreak",textCharacterSet:"characterSet",textBillboard:"billboard",textFontSettings:"fontSettings",getText:"getText",getTextAngle:"getAngle",getTextColor:"getColor",getTextPixelOffset:"getPixelOffset",getTextSize:"getSize",getTextAnchor:"getTextAnchor",getTextAlignmentBaseline:"getAlignmentBaseline",getTextBackgroundColor:"getBackgroundColor",getTextBorderColor:"getBorderColor",getTextBorderWidth:"getBorderWidth"}}},bA={type:GS,props:{lineWidthUnits:"widthUnits",lineWidthScale:"widthScale",lineWidthMinPixels:"widthMinPixels",lineWidthMaxPixels:"widthMaxPixels",lineJointRounded:"jointRounded",lineCapRounded:"capRounded",lineMiterLimit:"miterLimit",lineBillboard:"billboard",getLineColor:"getColor",getLineWidth:"getWidth"}},_A={type:pE,props:{extruded:"extruded",filled:"filled",wireframe:"wireframe",elevationScale:"elevationScale",material:"material",getElevation:"getElevation",getFillColor:"getFillColor",getLineColor:"getLineColor"}};function wA({type:t,props:e}){const n={};for(const r in e)n[r]=t.defaultProps[e[r]];return n}function xA(t,e){const{transitions:n,updateTriggers:r}=t.props,i={updateTriggers:{},transitions:n&&{getPosition:n.geometry}};for(const o in e){const s=e[o];let a=t.props[o];o.startsWith("get")&&(a=t.getSubLayerAccessor(a),i.updateTriggers[s]=r[o],n&&(i.transitions[s]=n[o])),i[s]=a}return i}function SA(t){if(Array.isArray(t))return t;switch(vn.assert(t.type,"GeoJSON does not have type"),t.type){case"Feature":return[t];case"FeatureCollection":return vn.assert(Array.isArray(t.features),"GeoJSON does not have features array"),t.features;default:return[{geometry:t}]}}function EA(t,e,n={}){const r={pointFeatures:[],lineFeatures:[],polygonFeatures:[],polygonOutlineFeatures:[]},{startRow:i=0,endRow:o=t.length}=n;for(let s=i;s<o;s++){const n=t[s];vn.assert(n&&n.geometry,"GeoJSON does not have geometry");const{geometry:i}=n;if("GeometryCollection"===i.type){vn.assert(Array.isArray(i.geometries),"GeoJSON does not have geometries array");const{geometries:t}=i;for(let i=0;i<t.length;i++){const o=t[i];AA(o,r,e,n,s)}}else AA(i,r,e,n,s)}return r}function AA(t,e,n,r,i){const{type:o,coordinates:s}=t,{pointFeatures:a,lineFeatures:u,polygonFeatures:c,polygonOutlineFeatures:l}=e;if(CA(o,s))switch(o){case"Point":a.push(n({geometry:t},r,i));break;case"MultiPoint":s.forEach(t=>{a.push(n({geometry:{type:"Point",coordinates:t}},r,i))});break;case"LineString":u.push(n({geometry:t},r,i));break;case"MultiLineString":s.forEach(t=>{u.push(n({geometry:{type:"LineString",coordinates:t}},r,i))});break;case"Polygon":c.push(n({geometry:t},r,i)),s.forEach(t=>{l.push(n({geometry:{type:"LineString",coordinates:t}},r,i))});break;case"MultiPolygon":s.forEach(t=>{c.push(n({geometry:{type:"Polygon",coordinates:t}},r,i)),t.forEach(t=>{l.push(n({geometry:{type:"LineString",coordinates:t}},r,i))})});break;default:}else vn.warn("".concat(o," coordinates are malformed"))()}const MA={Point:1,MultiPoint:2,LineString:2,MultiLineString:3,Polygon:3,MultiPolygon:4};function CA(t,e){let n=MA[t];vn.assert(n,"Unknown GeoJSON type ".concat(t));while(e&&--n>0)e=e[0];return e&&Number.isFinite(e[0])}function kA(){return{points:{},lines:{},polygons:{},polygonsOutline:{}}}function OA(t){return t.geometry.coordinates}function PA(t,e){const n=kA(),{pointFeatures:r,lineFeatures:i,polygonFeatures:o,polygonOutlineFeatures:s}=t;return n.points.data=r,n.points._dataDiff=e.pointFeatures&&(()=>e.pointFeatures),n.points.getPosition=OA,n.lines.data=i,n.lines._dataDiff=e.lineFeatures&&(()=>e.lineFeatures),n.lines.getPath=OA,n.polygons.data=o,n.polygons._dataDiff=e.polygonFeatures&&(()=>e.polygonFeatures),n.polygons.getPolygon=OA,n.polygonsOutline.data=s,n.polygonsOutline._dataDiff=e.polygonOutlineFeatures&&(()=>e.polygonOutlineFeatures),n.polygonsOutline.getPath=OA,n}function TA(t,e){const n=kA(),{points:r,lines:i,polygons:o}=t,s=xE(t,e);return n.points.data={length:r.positions.value.length/r.positions.size,attributes:{getPosition:r.positions,instancePickingColors:{size:3,value:s.points}},properties:r.properties,numericProps:r.numericProps,featureIds:r.featureIds},n.lines.data={length:i.pathIndices.value.length-1,startIndices:i.pathIndices.value,attributes:{getPath:i.positions,instancePickingColors:{size:3,value:s.lines}},properties:i.properties,numericProps:i.numericProps,featureIds:i.featureIds},n.lines._pathType="open",n.polygons.data={length:o.polygonIndices.value.length-1,startIndices:o.polygonIndices.value,attributes:{getPolygon:o.positions,pickingColors:{size:3,value:s.polygons}},properties:o.properties,numericProps:o.numericProps,featureIds:o.featureIds},n.polygons._normalize=!1,o.triangles&&(n.polygons.data.attributes.indices=o.triangles.value),n.polygonsOutline.data={length:o.primitivePolygonIndices.value.length-1,startIndices:o.primitivePolygonIndices.value,attributes:{getPath:o.positions,instancePickingColors:{size:3,value:s.polygons}},properties:o.properties,numericProps:o.numericProps,featureIds:o.featureIds},n.polygonsOutline._pathType="open",n}const LA={...wA(vA.circle),...wA(vA.icon),...wA(vA.text),...wA(bA),...wA(_A),stroked:!0,filled:!0,extruded:!1,wireframe:!1,iconAtlas:{type:"object",value:null},iconMapping:{type:"object",value:{}},getIcon:{type:"accessor",value:t=>t.properties.icon},getText:{type:"accessor",value:t=>t.properties.text},pointType:"circle",getRadius:{deprecatedFor:"getPointRadius"}};class IA extends Z_{initializeState(){this.state={layerProps:{},features:{}},this.props.getLineDashArray&&vn.removed("getLineDashArray","PathStyleExtension")()}updateState({props:t,changeFlags:e}){if(!e.dataChanged)return;const{data:n}=this.props,r=n&&"points"in n&&"polygons"in n&&"lines"in n;this.setState({binary:r}),r?this._updateStateBinary({props:t,changeFlags:e}):this._updateStateJSON({props:t,changeFlags:e})}_updateStateBinary({props:t,changeFlags:e}){const n=TA(t.data,this.encodePickingColor);this.setState({layerProps:n})}_updateStateJSON({props:t,changeFlags:e}){const n=SA(t.data),r=this.getSubLayerRow.bind(this);let i={};const o={};if(Array.isArray(e.dataChanged)){const t=this.state.features;for(const e in t)i[e]=t[e].slice(),o[e]=[];for(const s of e.dataChanged){const e=EA(n,r,s);for(const n in t)o[n].push(gE({data:i[n],getIndex:t=>t.__source.index,dataRange:s,replace:e[n]}))}}else i=EA(n,r);const s=PA(i,o);this.setState({features:i,featuresDiff:o,layerProps:s})}_updateAutoHighlight(t){const e="".concat(this.id,"-points-"),n=t.sourceLayer.id.startsWith(e);for(const r of this.getSubLayers())r.id.startsWith(e)===n&&r.updateAutoHighlight(t)}_renderPolygonLayer(){const{extruded:t,wireframe:e}=this.props,{layerProps:n}=this.state,r="polygons-fill",i=this.shouldRenderSubLayer(r,n.polygons.data)&&this.getSubLayerClass(r,_A.type);if(i){const o=xA(this,_A.props),s=t&&e;return s||delete o.getLineColor,o.updateTriggers.lineColors=s,new i(o,this.getSubLayerProps({id:r,updateTriggers:o.updateTriggers}),n.polygons)}return null}_renderLineLayers(){const{extruded:t,stroked:e}=this.props,{layerProps:n}=this.state,r="polygons-stroke",i="linestrings",o=!t&&e&&this.shouldRenderSubLayer(r,n.polygonsOutline.data)&&this.getSubLayerClass(r,bA.type),s=this.shouldRenderSubLayer(i,n.lines.data)&&this.getSubLayerClass(i,bA.type);if(o||s){const t=xA(this,bA.props);return[o&&new o(t,this.getSubLayerProps({id:r,updateTriggers:t.updateTriggers}),n.polygonsOutline),s&&new s(t,this.getSubLayerProps({id:i,updateTriggers:t.updateTriggers}),n.lines)]}return null}_renderPointLayers(){const{pointType:t}=this.props,{layerProps:e,binary:n}=this.state;let{highlightedObjectIndex:r}=this.props;!n&&Number.isFinite(r)&&(r=e.points.data.findIndex(t=>t.__source.index===r));const i=new Set(t.split("+")),o=[];for(const s of i){const t="points-".concat(s),n=vA[s],i=n&&this.shouldRenderSubLayer(t,e.points.data)&&this.getSubLayerClass(t,n.type);if(i){const s=xA(this,n.props);o.push(new i(s,this.getSubLayerProps({id:t,updateTriggers:s.updateTriggers,highlightedObjectIndex:r}),e.points))}}return o}renderLayers(){const{extruded:t}=this.props,e=this._renderPolygonLayer(),n=this._renderLineLayers(),r=this._renderPointLayers();return[!t&&e,n,r,t&&e]}getSubLayerAccessor(t){const{binary:e}=this.state;return e&&"function"===typeof t?(e,n)=>{const{data:r,index:i}=n,o=_E(r,i);return t(o,n)}:super.getSubLayerAccessor(t)}}IA.layerName="GeoJsonLayer",IA.defaultProps=LA;const NA={x:[2,0,1],y:[0,1,2],z:[1,2,0]};class DA extends Zh{constructor(t={}){const{id:e=qi("truncated-code-geometry")}=t,{indices:n,attributes:r}=RA(t);super({...t,id:e,indices:n,attributes:{...r,...t.attributes}})}}function RA(t){const{bottomRadius:e=0,topRadius:n=0,height:r=1,nradial:i=10,nvertical:o=10,verticalAxis:s="y",topCap:a=!1,bottomCap:u=!1}=t,c=(a?2:0)+(u?2:0),l=(i+1)*(o+1+c),h=Math.atan2(e-n,r),f=Math.sin,d=Math.cos,p=Math.PI,g=d(h),m=f(h),y=a?-2:0,v=o+(u?2:0),b=i+1,_=new Uint16Array(i*(o+c)*6),w=NA[s],x=new Float32Array(3*l),S=new Float32Array(3*l),E=new Float32Array(2*l);let A=0,M=0;for(let C=y;C<=v;C++){let t,s=C/o,a=r*s;C<0?(a=0,s=1,t=e):C>o?(a=r,s=1,t=n):t=e+C/o*(n-e),-2!==C&&C!==o+2||(t=0,s=0),a-=r/2;for(let e=0;e<b;e++){const n=f(e*p*2/i),r=d(e*p*2/i);x[A+w[0]]=n*t,x[A+w[1]]=a,x[A+w[2]]=r*t,S[A+w[0]]=C<0||C>o?0:n*g,S[A+w[1]]=C<0?-1:C>o?1:m,S[A+w[2]]=C<0||C>o?0:r*g,E[M+0]=e/i,E[M+1]=s,M+=2,A+=3}}for(let C=0;C<o+c;C++)for(let t=0;t<i;t++){const e=6*(C*i+t);_[e+0]=b*(C+0)+0+t,_[e+1]=b*(C+0)+1+t,_[e+2]=b*(C+1)+1+t,_[e+3]=b*(C+0)+0+t,_[e+4]=b*(C+1)+1+t,_[e+5]=b*(C+1)+0+t}return{indices:_,attributes:{POSITION:{size:3,value:x},NORMAL:{size:3,value:S},TEXCOORD_0:{size:2,value:E}}}}class FA extends DA{constructor(t={}){const{id:e=qi("cone-geometry"),radius:n=1,cap:r=!0}=t;super({...t,id:e,topRadius:0,topCap:Boolean(r),bottomCap:Boolean(r),bottomRadius:n})}}class BA extends DA{constructor(t={}){const{id:e=qi("cylinder-geometry"),radius:n=1}=t;super({...t,id:e,bottomRadius:n,topRadius:n})}}var jA=n("cd77");const zA=[-1,0,0,0,1,0,0,0,-1,0,0,1,0,-1,0,1,0,0],UA=[3,4,5,3,5,1,3,1,0,3,0,4,4,0,2,4,2,5,2,0,1,5,2,1];class $A extends Zh{constructor(t={}){const{id:e=qi("ico-sphere-geometry")}=t,{indices:n,attributes:r}=VA(t);super({...t,id:e,indices:n,attributes:{...r,...t.attributes}})}}function VA(t){const{iterations:e=0}=t,n=Math.PI,r=2*n,i=[...zA];let o=[...UA];i.push(),o.push();const s=(()=>{const t={};return(e,n)=>{e*=3,n*=3;const r=e<n?e:n,o=e>n?e:n,s=`${r}|${o}`;if(s in t)return t[s];const a=i[e],u=i[e+1],c=i[e+2],l=i[n],h=i[n+1],f=i[n+2];let d=(a+l)/2,p=(u+h)/2,g=(c+f)/2;const m=Math.sqrt(d*d+p*p+g*g);return d/=m,p/=m,g/=m,i.push(d,p,g),t[s]=i.length/3-1}})();for(let l=0;l<e;l++){const t=[];for(let e=0;e<o.length;e+=3){const n=s(o[e+0],o[e+1]),r=s(o[e+1],o[e+2]),i=s(o[e+2],o[e+0]);t.push(i,o[e+0],n,n,o[e+1],r,r,o[e+2],i,n,r,i)}o=t}const a=new Array(i.length),u=new Array(i.length/3*2),c=o.length;for(let l=c-3;l>=0;l-=3){const t=o[l+0],e=o[l+1],s=o[l+2],c=3*t,h=3*e,f=3*s,d=2*t,p=2*e,g=2*s,m=i[c+0],y=i[c+1],v=i[c+2],b=Math.acos(v/Math.sqrt(m*m+y*y+v*v)),_=Math.atan2(y,m)+n,w=b/n,x=1-_/r,S=i[h+0],E=i[h+1],A=i[h+2],M=Math.acos(A/Math.sqrt(S*S+E*E+A*A)),C=Math.atan2(E,S)+n,k=M/n,O=1-C/r,P=i[f+0],T=i[f+1],L=i[f+2],I=Math.acos(L/Math.sqrt(P*P+T*T+L*L)),N=Math.atan2(T,P)+n,D=I/n,R=1-N/r,F=[P-S,T-E,L-A],B=[m-S,y-E,v-A],j=new jA["a"](F).cross(B).normalize();let z;(0===x||0===O||0===R)&&(0===x||x>.5)&&(0===O||O>.5)&&(0===R||R>.5)&&(i.push(i[c+0],i[c+1],i[c+2]),z=i.length/3-1,o.push(z),u[2*z+0]=1,u[2*z+1]=w,a[3*z+0]=j.x,a[3*z+1]=j.y,a[3*z+2]=j.z,i.push(i[h+0],i[h+1],i[h+2]),z=i.length/3-1,o.push(z),u[2*z+0]=1,u[2*z+1]=k,a[3*z+0]=j.x,a[3*z+1]=j.y,a[3*z+2]=j.z,i.push(i[f+0],i[f+1],i[f+2]),z=i.length/3-1,o.push(z),u[2*z+0]=1,u[2*z+1]=D,a[3*z+0]=j.x,a[3*z+1]=j.y,a[3*z+2]=j.z),a[c+0]=a[h+0]=a[f+0]=j.x,a[c+1]=a[h+1]=a[f+1]=j.y,a[c+2]=a[h+2]=a[f+2]=j.z,u[d+0]=x,u[d+1]=w,u[p+0]=O,u[p+1]=k,u[g+0]=R,u[g+1]=D}return{indices:{size:1,value:new Uint16Array(o)},attributes:{POSITION:{size:3,value:new Float32Array(i)},NORMAL:{size:3,value:new Float32Array(a)},TEXCOORD_0:{size:2,value:new Float32Array(u)}}}}function qA(t){const{indices:e,attributes:n}=t;if(!e)return t;const r=e.value.length,i={};for(const o in n){const t=n[o],{constant:s,value:a,size:u}=t;if(s||!u)continue;const c=new a.constructor(r*u);for(let n=0;n<r;++n){const t=e.value[n];for(let e=0;e<u;e++)c[n*u+e]=a[t*u+e]}i[o]={size:u,value:c}}return{attributes:Object.assign({},n,i)}}class WA extends Zh{constructor(t={}){const{id:e=qi("plane-geometry")}=t,{indices:n,attributes:r}=GA(t);super({...t,id:e,indices:n,attributes:{...r,...t.attributes}})}}function GA(t){const{type:e="x,y",offset:n=0,flipCull:r=!1,unpack:i=!1}=t,o=e.split(",");let s=t[`${o[0]}len`]||1;const a=t[`${o[1]}len`]||1,u=t[`n${o[0]}`]||1,c=t[`n${o[1]}`]||1,l=(u+1)*(c+1),h=new Float32Array(3*l),f=new Float32Array(3*l),d=new Float32Array(2*l);r&&(s=-s);let p=0,g=0;for(let b=0;b<=c;b++)for(let t=0;t<=u;t++){const i=t/u,o=b/c;switch(d[p+0]=r?1-i:i,d[p+1]=o,e){case"x,y":h[g+0]=s*i-.5*s,h[g+1]=a*o-.5*a,h[g+2]=n,f[g+0]=0,f[g+1]=0,f[g+2]=r?1:-1;break;case"x,z":h[g+0]=s*i-.5*s,h[g+1]=n,h[g+2]=a*o-.5*a,f[g+0]=0,f[g+1]=r?1:-1,f[g+2]=0;break;case"y,z":h[g+0]=n,h[g+1]=s*i-.5*s,h[g+2]=a*o-.5*a,f[g+0]=r?1:-1,f[g+1]=0,f[g+2]=0;break;default:throw new Error("PlaneGeometry: unknown type")}p+=2,g+=3}const m=u+1,y=new Uint16Array(u*c*6);for(let b=0;b<c;b++)for(let t=0;t<u;t++){const e=6*(b*u+t);y[e+0]=(b+0)*m+t,y[e+1]=(b+1)*m+t,y[e+2]=(b+0)*m+t+1,y[e+3]=(b+1)*m+t,y[e+4]=(b+1)*m+t+1,y[e+5]=(b+0)*m+t+1}const v={indices:{size:1,value:y},attributes:{POSITION:{size:3,value:h},NORMAL:{size:3,value:f},TEXCOORD_0:{size:2,value:d}}};return i?qA(v):v}class HA extends Zh{constructor(t={}){const{id:e=qi("sphere-geometry")}=t,{indices:n,attributes:r}=XA(t);super({...t,id:e,indices:n,attributes:{...r,...t.attributes}})}}function XA(t){const{nlat:e=10,nlong:n=10}=t;let{radius:r=1}=t;const i=0,o=Math.PI,s=o-i,a=0,u=2*Math.PI,c=u-a,l=(e+1)*(n+1);if("number"===typeof r){const t=r;r=(e,n,r,i,o)=>t}const h=new Float32Array(3*l),f=new Float32Array(3*l),d=new Float32Array(2*l),p=l>65535?Uint32Array:Uint16Array,g=new p(e*n*6);for(let y=0;y<=e;y++)for(let t=0;t<=n;t++){const i=t/n,o=y/e,a=t+y*(n+1),u=2*a,l=3*a,p=c*i,g=s*o,m=Math.sin(p),v=Math.cos(p),b=Math.sin(g),_=Math.cos(g),w=v*b,x=_,S=m*b,E=r(w,x,S,i,o);h[l+0]=E*w,h[l+1]=E*x,h[l+2]=E*S,f[l+0]=w,f[l+1]=x,f[l+2]=S,d[u+0]=i,d[u+1]=1-o}const m=n+1;for(let y=0;y<n;y++)for(let t=0;t<e;t++){const n=6*(y*e+t);g[n+0]=t*m+y,g[n+1]=t*m+y+1,g[n+2]=(t+1)*m+y,g[n+3]=(t+1)*m+y,g[n+4]=t*m+y+1,g[n+5]=(t+1)*m+y+1}return{indices:{size:1,value:g},attributes:{POSITION:{size:3,value:h},NORMAL:{size:3,value:f},TEXCOORD_0:{size:2,value:d}}}}function YA(t,e=[],n=0){const r=Math.fround(t),i=t-r;return e[n]=r,e[n+1]=i,e}function ZA(t){return t-Math.fround(t)}function KA(t){const e=new Float32Array(32);for(let n=0;n<4;++n)for(let r=0;r<4;++r){const i=4*n+r;YA(t[4*r+n],e,2*i)}return e}var JA="uniform float ONE;\nvec2 split(float a) {\n  const float SPLIT = 4097.0;\n  float t = a * SPLIT;\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\n  float a_hi = t * ONE - (t - a);\n  float a_lo = a * ONE - a_hi;\n#else\n  float a_hi = t - (t - a);\n  float a_lo = a - a_hi;\n#endif\n  return vec2(a_hi, a_lo);\n}\nvec2 split2(vec2 a) {\n  vec2 b = split(a.x);\n  b.y += a.y;\n  return b;\n}\nvec2 quickTwoSum(float a, float b) {\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\n  float sum = (a + b) * ONE;\n  float err = b - (sum - a) * ONE;\n#else\n  float sum = a + b;\n  float err = b - (sum - a);\n#endif\n  return vec2(sum, err);\n}\nvec2 twoSum(float a, float b) {\n  float s = (a + b);\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\n  float v = (s * ONE - a) * ONE;\n  float err = (a - (s - v) * ONE) * ONE * ONE * ONE + (b - v);\n#else\n  float v = s - a;\n  float err = (a - (s - v)) + (b - v);\n#endif\n  return vec2(s, err);\n}\n\nvec2 twoSub(float a, float b) {\n  float s = (a - b);\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\n  float v = (s * ONE - a) * ONE;\n  float err = (a - (s - v) * ONE) * ONE * ONE * ONE - (b + v);\n#else\n  float v = s - a;\n  float err = (a - (s - v)) - (b + v);\n#endif\n  return vec2(s, err);\n}\n\nvec2 twoSqr(float a) {\n  float prod = a * a;\n  vec2 a_fp64 = split(a);\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\n  float err = ((a_fp64.x * a_fp64.x - prod) * ONE + 2.0 * a_fp64.x *\n    a_fp64.y * ONE * ONE) + a_fp64.y * a_fp64.y * ONE * ONE * ONE;\n#else\n  float err = ((a_fp64.x * a_fp64.x - prod) + 2.0 * a_fp64.x * a_fp64.y) + a_fp64.y * a_fp64.y;\n#endif\n  return vec2(prod, err);\n}\n\nvec2 twoProd(float a, float b) {\n  float prod = a * b;\n  vec2 a_fp64 = split(a);\n  vec2 b_fp64 = split(b);\n  float err = ((a_fp64.x * b_fp64.x - prod) + a_fp64.x * b_fp64.y +\n    a_fp64.y * b_fp64.x) + a_fp64.y * b_fp64.y;\n  return vec2(prod, err);\n}\n\nvec2 sum_fp64(vec2 a, vec2 b) {\n  vec2 s, t;\n  s = twoSum(a.x, b.x);\n  t = twoSum(a.y, b.y);\n  s.y += t.x;\n  s = quickTwoSum(s.x, s.y);\n  s.y += t.y;\n  s = quickTwoSum(s.x, s.y);\n  return s;\n}\n\nvec2 sub_fp64(vec2 a, vec2 b) {\n  vec2 s, t;\n  s = twoSub(a.x, b.x);\n  t = twoSub(a.y, b.y);\n  s.y += t.x;\n  s = quickTwoSum(s.x, s.y);\n  s.y += t.y;\n  s = quickTwoSum(s.x, s.y);\n  return s;\n}\n\nvec2 mul_fp64(vec2 a, vec2 b) {\n  vec2 prod = twoProd(a.x, b.x);\n  prod.y += a.x * b.y;\n#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)\n  prod = split2(prod);\n#endif\n  prod = quickTwoSum(prod.x, prod.y);\n  prod.y += a.y * b.x;\n#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)\n  prod = split2(prod);\n#endif\n  prod = quickTwoSum(prod.x, prod.y);\n  return prod;\n}\n\nvec2 div_fp64(vec2 a, vec2 b) {\n  float xn = 1.0 / b.x;\n#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)\n  vec2 yn = mul_fp64(a, vec2(xn, 0));\n#else\n  vec2 yn = a * xn;\n#endif\n  float diff = (sub_fp64(a, mul_fp64(b, yn))).x;\n  vec2 prod = twoProd(xn, diff);\n  return sum_fp64(yn, prod);\n}\n\nvec2 sqrt_fp64(vec2 a) {\n  if (a.x == 0.0 && a.y == 0.0) return vec2(0.0, 0.0);\n  if (a.x < 0.0) return vec2(0.0 / 0.0, 0.0 / 0.0);\n\n  float x = 1.0 / sqrt(a.x);\n  float yn = a.x * x;\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\n  vec2 yn_sqr = twoSqr(yn) * ONE;\n#else\n  vec2 yn_sqr = twoSqr(yn);\n#endif\n  float diff = sub_fp64(a, yn_sqr).x;\n  vec2 prod = twoProd(x * 0.5, diff);\n#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)\n  return sum_fp64(split(yn), prod);\n#else\n  return sum_fp64(vec2(yn, 0.0), prod);\n#endif\n}\n",QA="const vec2 E_FP64 = vec2(2.7182817459106445e+00, 8.254840366817007e-08);\nconst vec2 LOG2_FP64 = vec2(0.6931471824645996e+00, -1.9046542121259336e-09);\nconst vec2 PI_FP64 = vec2(3.1415927410125732, -8.742278012618954e-8);\nconst vec2 TWO_PI_FP64 = vec2(6.2831854820251465, -1.7484556025237907e-7);\nconst vec2 PI_2_FP64 = vec2(1.5707963705062866, -4.371139006309477e-8);\nconst vec2 PI_4_FP64 = vec2(0.7853981852531433, -2.1855695031547384e-8);\nconst vec2 PI_16_FP64 = vec2(0.19634954631328583, -5.463923757886846e-9);\nconst vec2 PI_16_2_FP64 = vec2(0.39269909262657166, -1.0927847515773692e-8);\nconst vec2 PI_16_3_FP64 = vec2(0.5890486240386963, -1.4906100798128818e-9);\nconst vec2 PI_180_FP64 = vec2(0.01745329238474369, 1.3519960498364902e-10);\n\nconst vec2 SIN_TABLE_0_FP64 = vec2(0.19509032368659973, -1.6704714833615242e-9);\nconst vec2 SIN_TABLE_1_FP64 = vec2(0.3826834261417389, 6.22335089017767e-9);\nconst vec2 SIN_TABLE_2_FP64 = vec2(0.5555702447891235, -1.1769521357507529e-8);\nconst vec2 SIN_TABLE_3_FP64 = vec2(0.7071067690849304, 1.2101617041793133e-8);\n\nconst vec2 COS_TABLE_0_FP64 = vec2(0.9807852506637573, 2.9739473106360492e-8);\nconst vec2 COS_TABLE_1_FP64 = vec2(0.9238795042037964, 2.8307490351764386e-8);\nconst vec2 COS_TABLE_2_FP64 = vec2(0.8314695954322815, 1.6870263741530778e-8);\nconst vec2 COS_TABLE_3_FP64 = vec2(0.7071067690849304, 1.2101617152815436e-8);\n\nconst vec2 INVERSE_FACTORIAL_3_FP64 = vec2(1.666666716337204e-01, -4.967053879312289e-09);\nconst vec2 INVERSE_FACTORIAL_4_FP64 = vec2(4.16666679084301e-02, -1.2417634698280722e-09);\nconst vec2 INVERSE_FACTORIAL_5_FP64 = vec2(8.333333767950535e-03, -4.34617203337595e-10);\nconst vec2 INVERSE_FACTORIAL_6_FP64 = vec2(1.3888889225199819e-03, -3.3631094437103215e-11);\nconst vec2 INVERSE_FACTORIAL_7_FP64 = vec2(1.9841270113829523e-04,  -2.725596874933456e-12);\nconst vec2 INVERSE_FACTORIAL_8_FP64 = vec2(2.4801587642286904e-05, -3.406996025904184e-13);\nconst vec2 INVERSE_FACTORIAL_9_FP64 = vec2(2.75573188446287533e-06, 3.7935713937038186e-14);\nconst vec2 INVERSE_FACTORIAL_10_FP64 = vec2(2.755731998149713e-07, -7.575112367869873e-15);\n\nfloat nint(float d) {\n    if (d == floor(d)) return d;\n    return floor(d + 0.5);\n}\n\nvec2 nint_fp64(vec2 a) {\n    float hi = nint(a.x);\n    float lo;\n    vec2 tmp;\n    if (hi == a.x) {\n        lo = nint(a.y);\n        tmp = quickTwoSum(hi, lo);\n    } else {\n        lo = 0.0;\n        if (abs(hi - a.x) == 0.5 && a.y < 0.0) {\n            hi -= 1.0;\n        }\n        tmp = vec2(hi, lo);\n    }\n    return tmp;\n}\n\nvec2 exp_fp64(vec2 a) {\n\n  const int k_power = 4;\n  const float k = 16.0;\n\n  const float inv_k = 1.0 / k;\n\n  if (a.x <= -88.0) return vec2(0.0, 0.0);\n  if (a.x >= 88.0) return vec2(1.0 / 0.0, 1.0 / 0.0);\n  if (a.x == 0.0 && a.y == 0.0) return vec2(1.0, 0.0);\n  if (a.x == 1.0 && a.y == 0.0) return E_FP64;\n\n  float m = floor(a.x / LOG2_FP64.x + 0.5);\n  vec2 r = sub_fp64(a, mul_fp64(LOG2_FP64, vec2(m, 0.0))) * inv_k;\n  vec2 s, t, p;\n\n  p = mul_fp64(r, r);\n  s = sum_fp64(r, p * 0.5);\n  p = mul_fp64(p, r);\n  t = mul_fp64(p, INVERSE_FACTORIAL_3_FP64);\n\n  s = sum_fp64(s, t);\n  p = mul_fp64(p, r);\n  t = mul_fp64(p, INVERSE_FACTORIAL_4_FP64);\n\n  s = sum_fp64(s, t);\n  p = mul_fp64(p, r);\n  t = mul_fp64(p, INVERSE_FACTORIAL_5_FP64);\n\n\n\n\n\n\n  s = sum_fp64(s, t);\n  for (int i = 0; i < k_power; i++) {\n    s = sum_fp64(s * 2.0, mul_fp64(s, s));\n  }\n\n#if defined(NVIDIA_FP64_WORKAROUND) || defined(INTEL_FP64_WORKAROUND)\n  s = sum_fp64(s, vec2(ONE, 0.0));\n#else\n  s = sum_fp64(s, vec2(1.0, 0.0));\n#endif\n\n  return s * pow(2.0, m);\n}\n\nvec2 log_fp64(vec2 a)\n{\n  if (a.x == 1.0 && a.y == 0.0) return vec2(0.0, 0.0);\n  if (a.x <= 0.0) return vec2(0.0 / 0.0, 0.0 / 0.0);\n  vec2 x = vec2(log(a.x), 0.0);\n  vec2 s;\n#if defined(NVIDIA_FP64_WORKAROUND) || defined(INTEL_FP64_WORKAROUND)\n  s = vec2(ONE, 0.0);\n#else\n  s = vec2(1.0, 0.0);\n#endif\n\n  x = sub_fp64(sum_fp64(x, mul_fp64(a, exp_fp64(-x))), s);\n  return x;\n}\n\nvec2 sin_taylor_fp64(vec2 a) {\n  vec2 r, s, t, x;\n\n  if (a.x == 0.0 && a.y == 0.0) {\n    return vec2(0.0, 0.0);\n  }\n\n  x = -mul_fp64(a, a);\n  s = a;\n  r = a;\n\n  r = mul_fp64(r, x);\n  t = mul_fp64(r, INVERSE_FACTORIAL_3_FP64);\n  s = sum_fp64(s, t);\n\n  r = mul_fp64(r, x);\n  t = mul_fp64(r, INVERSE_FACTORIAL_5_FP64);\n  s = sum_fp64(s, t);\n\n\n\n\n\n\n  return s;\n}\n\nvec2 cos_taylor_fp64(vec2 a) {\n  vec2 r, s, t, x;\n\n  if (a.x == 0.0 && a.y == 0.0) {\n    return vec2(1.0, 0.0);\n  }\n\n  x = -mul_fp64(a, a);\n  r = x;\n  s = sum_fp64(vec2(1.0, 0.0), r * 0.5);\n\n  r = mul_fp64(r, x);\n  t = mul_fp64(r, INVERSE_FACTORIAL_4_FP64);\n  s = sum_fp64(s, t);\n\n  r = mul_fp64(r, x);\n  t = mul_fp64(r, INVERSE_FACTORIAL_6_FP64);\n  s = sum_fp64(s, t);\n\n\n\n\n\n\n  return s;\n}\n\nvoid sincos_taylor_fp64(vec2 a, out vec2 sin_t, out vec2 cos_t) {\n  if (a.x == 0.0 && a.y == 0.0) {\n    sin_t = vec2(0.0, 0.0);\n    cos_t = vec2(1.0, 0.0);\n  }\n\n  sin_t = sin_taylor_fp64(a);\n  cos_t = sqrt_fp64(sub_fp64(vec2(1.0, 0.0), mul_fp64(sin_t, sin_t)));\n}\n\nvec2 sin_fp64(vec2 a) {\n    if (a.x == 0.0 && a.y == 0.0) {\n        return vec2(0.0, 0.0);\n    }\n    vec2 z = nint_fp64(div_fp64(a, TWO_PI_FP64));\n    vec2 r = sub_fp64(a, mul_fp64(TWO_PI_FP64, z));\n\n    vec2 t;\n    float q = floor(r.x / PI_2_FP64.x + 0.5);\n    int j = int(q);\n\n    if (j < -2 || j > 2) {\n        return vec2(0.0 / 0.0, 0.0 / 0.0);\n    }\n\n    t = sub_fp64(r, mul_fp64(PI_2_FP64, vec2(q, 0.0)));\n\n    q = floor(t.x / PI_16_FP64.x + 0.5);\n    int k = int(q);\n\n    if (k == 0) {\n        if (j == 0) {\n            return sin_taylor_fp64(t);\n        } else if (j == 1) {\n            return cos_taylor_fp64(t);\n        } else if (j == -1) {\n            return -cos_taylor_fp64(t);\n        } else {\n            return -sin_taylor_fp64(t);\n        }\n    }\n\n    int abs_k = int(abs(float(k)));\n\n    if (abs_k > 4) {\n        return vec2(0.0 / 0.0, 0.0 / 0.0);\n    } else {\n        t = sub_fp64(t, mul_fp64(PI_16_FP64, vec2(q, 0.0)));\n    }\n\n    vec2 u = vec2(0.0, 0.0);\n    vec2 v = vec2(0.0, 0.0);\n\n#if defined(NVIDIA_FP64_WORKAROUND) || defined(INTEL_FP64_WORKAROUND)\n    if (abs(float(abs_k) - 1.0) < 0.5) {\n        u = COS_TABLE_0_FP64;\n        v = SIN_TABLE_0_FP64;\n    } else if (abs(float(abs_k) - 2.0) < 0.5) {\n        u = COS_TABLE_1_FP64;\n        v = SIN_TABLE_1_FP64;\n    } else if (abs(float(abs_k) - 3.0) < 0.5) {\n        u = COS_TABLE_2_FP64;\n        v = SIN_TABLE_2_FP64;\n    } else if (abs(float(abs_k) - 4.0) < 0.5) {\n        u = COS_TABLE_3_FP64;\n        v = SIN_TABLE_3_FP64;\n    }\n#else\n    if (abs_k == 1) {\n        u = COS_TABLE_0_FP64;\n        v = SIN_TABLE_0_FP64;\n    } else if (abs_k == 2) {\n        u = COS_TABLE_1_FP64;\n        v = SIN_TABLE_1_FP64;\n    } else if (abs_k == 3) {\n        u = COS_TABLE_2_FP64;\n        v = SIN_TABLE_2_FP64;\n    } else if (abs_k == 4) {\n        u = COS_TABLE_3_FP64;\n        v = SIN_TABLE_3_FP64;\n    }\n#endif\n\n    vec2 sin_t, cos_t;\n    sincos_taylor_fp64(t, sin_t, cos_t);\n\n\n\n    vec2 result = vec2(0.0, 0.0);\n    if (j == 0) {\n        if (k > 0) {\n            result = sum_fp64(mul_fp64(u, sin_t), mul_fp64(v, cos_t));\n        } else {\n            result = sub_fp64(mul_fp64(u, sin_t), mul_fp64(v, cos_t));\n        }\n    } else if (j == 1) {\n        if (k > 0) {\n            result = sub_fp64(mul_fp64(u, cos_t), mul_fp64(v, sin_t));\n        } else {\n            result = sum_fp64(mul_fp64(u, cos_t), mul_fp64(v, sin_t));\n        }\n    } else if (j == -1) {\n        if (k > 0) {\n            result = sub_fp64(mul_fp64(v, sin_t), mul_fp64(u, cos_t));\n        } else {\n            result = -sum_fp64(mul_fp64(v, sin_t), mul_fp64(u, cos_t));\n        }\n    } else {\n        if (k > 0) {\n            result = -sum_fp64(mul_fp64(u, sin_t), mul_fp64(v, cos_t));\n        } else {\n            result = sub_fp64(mul_fp64(v, cos_t), mul_fp64(u, sin_t));\n        }\n    }\n\n    return result;\n}\n\nvec2 cos_fp64(vec2 a) {\n    if (a.x == 0.0 && a.y == 0.0) {\n        return vec2(1.0, 0.0);\n    }\n    vec2 z = nint_fp64(div_fp64(a, TWO_PI_FP64));\n    vec2 r = sub_fp64(a, mul_fp64(TWO_PI_FP64, z));\n\n    vec2 t;\n    float q = floor(r.x / PI_2_FP64.x + 0.5);\n    int j = int(q);\n\n    if (j < -2 || j > 2) {\n        return vec2(0.0 / 0.0, 0.0 / 0.0);\n    }\n\n    t = sub_fp64(r, mul_fp64(PI_2_FP64, vec2(q, 0.0)));\n\n    q = floor(t.x / PI_16_FP64.x + 0.5);\n    int k = int(q);\n\n    if (k == 0) {\n        if (j == 0) {\n            return cos_taylor_fp64(t);\n        } else if (j == 1) {\n            return -sin_taylor_fp64(t);\n        } else if (j == -1) {\n            return sin_taylor_fp64(t);\n        } else {\n            return -cos_taylor_fp64(t);\n        }\n    }\n\n    int abs_k = int(abs(float(k)));\n\n    if (abs_k > 4) {\n        return vec2(0.0 / 0.0, 0.0 / 0.0);\n    } else {\n        t = sub_fp64(t, mul_fp64(PI_16_FP64, vec2(q, 0.0)));\n    }\n\n    vec2 u = vec2(0.0, 0.0);\n    vec2 v = vec2(0.0, 0.0);\n\n#if defined(NVIDIA_FP64_WORKAROUND) || defined(INTEL_FP64_WORKAROUND)\n    if (abs(float(abs_k) - 1.0) < 0.5) {\n        u = COS_TABLE_0_FP64;\n        v = SIN_TABLE_0_FP64;\n    } else if (abs(float(abs_k) - 2.0) < 0.5) {\n        u = COS_TABLE_1_FP64;\n        v = SIN_TABLE_1_FP64;\n    } else if (abs(float(abs_k) - 3.0) < 0.5) {\n        u = COS_TABLE_2_FP64;\n        v = SIN_TABLE_2_FP64;\n    } else if (abs(float(abs_k) - 4.0) < 0.5) {\n        u = COS_TABLE_3_FP64;\n        v = SIN_TABLE_3_FP64;\n    }\n#else\n    if (abs_k == 1) {\n        u = COS_TABLE_0_FP64;\n        v = SIN_TABLE_0_FP64;\n    } else if (abs_k == 2) {\n        u = COS_TABLE_1_FP64;\n        v = SIN_TABLE_1_FP64;\n    } else if (abs_k == 3) {\n        u = COS_TABLE_2_FP64;\n        v = SIN_TABLE_2_FP64;\n    } else if (abs_k == 4) {\n        u = COS_TABLE_3_FP64;\n        v = SIN_TABLE_3_FP64;\n    }\n#endif\n\n    vec2 sin_t, cos_t;\n    sincos_taylor_fp64(t, sin_t, cos_t);\n\n    vec2 result = vec2(0.0, 0.0);\n    if (j == 0) {\n        if (k > 0) {\n            result = sub_fp64(mul_fp64(u, cos_t), mul_fp64(v, sin_t));\n        } else {\n            result = sum_fp64(mul_fp64(u, cos_t), mul_fp64(v, sin_t));\n        }\n    } else if (j == 1) {\n        if (k > 0) {\n            result = -sum_fp64(mul_fp64(u, sin_t), mul_fp64(v, cos_t));\n        } else {\n            result = sub_fp64(mul_fp64(v, cos_t), mul_fp64(u, sin_t));\n        }\n    } else if (j == -1) {\n        if (k > 0) {\n            result = sum_fp64(mul_fp64(u, sin_t), mul_fp64(v, cos_t));\n        } else {\n            result = sub_fp64(mul_fp64(u, sin_t), mul_fp64(v, cos_t));\n        }\n    } else {\n        if (k > 0) {\n            result = sub_fp64(mul_fp64(v, sin_t), mul_fp64(u, cos_t));\n        } else {\n            result = -sum_fp64(mul_fp64(u, cos_t), mul_fp64(v, sin_t));\n        }\n    }\n\n    return result;\n}\n\nvec2 tan_fp64(vec2 a) {\n    vec2 sin_a;\n    vec2 cos_a;\n\n    if (a.x == 0.0 && a.y == 0.0) {\n        return vec2(0.0, 0.0);\n    }\n    vec2 z = nint_fp64(div_fp64(a, TWO_PI_FP64));\n    vec2 r = sub_fp64(a, mul_fp64(TWO_PI_FP64, z));\n\n    vec2 t;\n    float q = floor(r.x / PI_2_FP64.x + 0.5);\n    int j = int(q);\n\n\n    if (j < -2 || j > 2) {\n        return vec2(0.0 / 0.0, 0.0 / 0.0);\n    }\n\n    t = sub_fp64(r, mul_fp64(PI_2_FP64, vec2(q, 0.0)));\n\n    q = floor(t.x / PI_16_FP64.x + 0.5);\n    int k = int(q);\n    int abs_k = int(abs(float(k)));\n\n    if (abs_k > 4) {\n        return vec2(0.0 / 0.0, 0.0 / 0.0);\n    } else {\n        t = sub_fp64(t, mul_fp64(PI_16_FP64, vec2(q, 0.0)));\n    }\n\n\n    vec2 u = vec2(0.0, 0.0);\n    vec2 v = vec2(0.0, 0.0);\n\n    vec2 sin_t, cos_t;\n    vec2 s, c;\n    sincos_taylor_fp64(t, sin_t, cos_t);\n\n    if (k == 0) {\n        s = sin_t;\n        c = cos_t;\n    } else {\n#if defined(NVIDIA_FP64_WORKAROUND) || defined(INTEL_FP64_WORKAROUND)\n        if (abs(float(abs_k) - 1.0) < 0.5) {\n            u = COS_TABLE_0_FP64;\n            v = SIN_TABLE_0_FP64;\n        } else if (abs(float(abs_k) - 2.0) < 0.5) {\n            u = COS_TABLE_1_FP64;\n            v = SIN_TABLE_1_FP64;\n        } else if (abs(float(abs_k) - 3.0) < 0.5) {\n            u = COS_TABLE_2_FP64;\n            v = SIN_TABLE_2_FP64;\n        } else if (abs(float(abs_k) - 4.0) < 0.5) {\n            u = COS_TABLE_3_FP64;\n            v = SIN_TABLE_3_FP64;\n        }\n#else\n        if (abs_k == 1) {\n            u = COS_TABLE_0_FP64;\n            v = SIN_TABLE_0_FP64;\n        } else if (abs_k == 2) {\n            u = COS_TABLE_1_FP64;\n            v = SIN_TABLE_1_FP64;\n        } else if (abs_k == 3) {\n            u = COS_TABLE_2_FP64;\n            v = SIN_TABLE_2_FP64;\n        } else if (abs_k == 4) {\n            u = COS_TABLE_3_FP64;\n            v = SIN_TABLE_3_FP64;\n        }\n#endif\n        if (k > 0) {\n            s = sum_fp64(mul_fp64(u, sin_t), mul_fp64(v, cos_t));\n            c = sub_fp64(mul_fp64(u, cos_t), mul_fp64(v, sin_t));\n        } else {\n            s = sub_fp64(mul_fp64(u, sin_t), mul_fp64(v, cos_t));\n            c = sum_fp64(mul_fp64(u, cos_t), mul_fp64(v, sin_t));\n        }\n    }\n\n    if (j == 0) {\n        sin_a = s;\n        cos_a = c;\n    } else if (j == 1) {\n        sin_a = c;\n        cos_a = -s;\n    } else if (j == -1) {\n        sin_a = -c;\n        cos_a = s;\n    } else {\n        sin_a = -s;\n        cos_a = -c;\n    }\n    return div_fp64(sin_a, cos_a);\n}\n\nvec2 radians_fp64(vec2 degree) {\n  return mul_fp64(degree, PI_180_FP64);\n}\n\nvec2 mix_fp64(vec2 a, vec2 b, float x) {\n  vec2 range = sub_fp64(b, a);\n  return sum_fp64(a, mul_fp64(range, vec2(x, 0.0)));\n}\n\nvoid vec2_sum_fp64(vec2 a[2], vec2 b[2], out vec2 out_val[2]) {\n    out_val[0] = sum_fp64(a[0], b[0]);\n    out_val[1] = sum_fp64(a[1], b[1]);\n}\n\nvoid vec2_sub_fp64(vec2 a[2], vec2 b[2], out vec2 out_val[2]) {\n    out_val[0] = sub_fp64(a[0], b[0]);\n    out_val[1] = sub_fp64(a[1], b[1]);\n}\n\nvoid vec2_mul_fp64(vec2 a[2], vec2 b[2], out vec2 out_val[2]) {\n    out_val[0] = mul_fp64(a[0], b[0]);\n    out_val[1] = mul_fp64(a[1], b[1]);\n}\n\nvoid vec2_div_fp64(vec2 a[2], vec2 b[2], out vec2 out_val[2]) {\n    out_val[0] = div_fp64(a[0], b[0]);\n    out_val[1] = div_fp64(a[1], b[1]);\n}\n\nvoid vec2_mix_fp64(vec2 x[2], vec2 y[2], float a, out vec2 out_val[2]) {\n  vec2 range[2];\n  vec2_sub_fp64(y, x, range);\n  vec2 portion[2];\n  portion[0] = range[0] * a;\n  portion[1] = range[1] * a;\n  vec2_sum_fp64(x, portion, out_val);\n}\n\nvec2 vec2_length_fp64(vec2 x[2]) {\n  return sqrt_fp64(sum_fp64(mul_fp64(x[0], x[0]), mul_fp64(x[1], x[1])));\n}\n\nvoid vec2_normalize_fp64(vec2 x[2], out vec2 out_val[2]) {\n  vec2 length = vec2_length_fp64(x);\n  vec2 length_vec2[2];\n  length_vec2[0] = length;\n  length_vec2[1] = length;\n\n  vec2_div_fp64(x, length_vec2, out_val);\n}\n\nvec2 vec2_distance_fp64(vec2 x[2], vec2 y[2]) {\n  vec2 diff[2];\n  vec2_sub_fp64(x, y, diff);\n  return vec2_length_fp64(diff);\n}\n\nvec2 vec2_dot_fp64(vec2 a[2], vec2 b[2]) {\n  vec2 v[2];\n\n  v[0] = mul_fp64(a[0], b[0]);\n  v[1] = mul_fp64(a[1], b[1]);\n\n  return sum_fp64(v[0], v[1]);\n}\nvoid vec3_sub_fp64(vec2 a[3], vec2 b[3], out vec2 out_val[3]) {\n  for (int i = 0; i < 3; i++) {\n    out_val[i] = sum_fp64(a[i], b[i]);\n  }\n}\n\nvoid vec3_sum_fp64(vec2 a[3], vec2 b[3], out vec2 out_val[3]) {\n  for (int i = 0; i < 3; i++) {\n    out_val[i] = sum_fp64(a[i], b[i]);\n  }\n}\n\nvec2 vec3_length_fp64(vec2 x[3]) {\n  return sqrt_fp64(sum_fp64(sum_fp64(mul_fp64(x[0], x[0]), mul_fp64(x[1], x[1])),\n    mul_fp64(x[2], x[2])));\n}\n\nvec2 vec3_distance_fp64(vec2 x[3], vec2 y[3]) {\n  vec2 diff[3];\n  vec3_sub_fp64(x, y, diff);\n  return vec3_length_fp64(diff);\n}\nvoid vec4_fp64(vec4 a, out vec2 out_val[4]) {\n  out_val[0].x = a[0];\n  out_val[0].y = 0.0;\n\n  out_val[1].x = a[1];\n  out_val[1].y = 0.0;\n\n  out_val[2].x = a[2];\n  out_val[2].y = 0.0;\n\n  out_val[3].x = a[3];\n  out_val[3].y = 0.0;\n}\n\nvoid vec4_scalar_mul_fp64(vec2 a[4], vec2 b, out vec2 out_val[4]) {\n  out_val[0] = mul_fp64(a[0], b);\n  out_val[1] = mul_fp64(a[1], b);\n  out_val[2] = mul_fp64(a[2], b);\n  out_val[3] = mul_fp64(a[3], b);\n}\n\nvoid vec4_sum_fp64(vec2 a[4], vec2 b[4], out vec2 out_val[4]) {\n  for (int i = 0; i < 4; i++) {\n    out_val[i] = sum_fp64(a[i], b[i]);\n  }\n}\n\nvoid vec4_dot_fp64(vec2 a[4], vec2 b[4], out vec2 out_val) {\n  vec2 v[4];\n\n  v[0] = mul_fp64(a[0], b[0]);\n  v[1] = mul_fp64(a[1], b[1]);\n  v[2] = mul_fp64(a[2], b[2]);\n  v[3] = mul_fp64(a[3], b[3]);\n\n  out_val = sum_fp64(sum_fp64(v[0], v[1]), sum_fp64(v[2], v[3]));\n}\n\nvoid mat4_vec4_mul_fp64(vec2 b[16], vec2 a[4], out vec2 out_val[4]) {\n  vec2 tmp[4];\n\n  for (int i = 0; i < 4; i++)\n  {\n    for (int j = 0; j < 4; j++)\n    {\n      tmp[j] = b[j + i * 4];\n    }\n    vec4_dot_fp64(a, tmp, out_val[i]);\n  }\n}\n";const tM={ONE:1};function eM(){return tM}const nM={name:"fp64-arithmetic",vs:JA,fs:null,getUniforms:eM,fp64ify:YA,fp64LowPart:ZA,fp64ifyMatrix4:KA},rM={name:"fp64",vs:QA,fs:null,dependencies:[nM],fp64ify:YA,fp64LowPart:ZA,fp64ifyMatrix4:KA};var iM=n("370d");const oM=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],sM={modelMatrix:oM,viewMatrix:oM,projectionMatrix:oM,cameraPositionWorld:[0,0,0]};function aM(t=sM,e={}){const n={};return void 0!==t.modelMatrix&&(n.modelMatrix=t.modelMatrix),void 0!==t.viewMatrix&&(n.viewMatrix=t.viewMatrix),void 0!==t.projectionMatrix&&(n.projectionMatrix=t.projectionMatrix),void 0!==t.cameraPositionWorld&&(n.cameraPositionWorld=t.cameraPositionWorld),void 0===t.projectionMatrix&&void 0===t.viewMatrix||(n.viewProjectionMatrix=new iM["a"](t.projectionMatrix).multiplyRight(t.viewMatrix)),n}const uM="varying vec4 project_vPositionWorld;\nvarying vec3 project_vNormalWorld;\n\nvec4 project_getPosition_World() {\n  return project_vPositionWorld;\n}\n\nvec3 project_getNormal_World() {\n  return project_vNormalWorld;\n}\n",cM=`${uM}\nuniform mat4 modelMatrix;\nuniform mat4 viewMatrix;\nuniform mat4 projectionMatrix;\nuniform mat4 viewProjectionMatrix;\nuniform vec3 cameraPositionWorld;\n\nstruct World {\n  vec3 position;\n  vec3 normal;\n};\n\nWorld world;\n\nvoid project_setPosition(vec4 position) {\n  project_vPositionWorld = position;\n}\n\nvoid project_setNormal(vec3 normal) {\n  project_vNormalWorld = normal;\n}\n\nvoid project_setPositionAndNormal_World(vec3 position, vec3 normal) {\n  world.position = position;\n  world.normal = normal;\n}\n\nvoid project_setPositionAndNormal_Model(vec3 position, vec3 normal) {\n  world.position = (modelMatrix * vec4(position, 1.)).xyz;\n  world.normal = mat3(modelMatrix) * normal;\n}\n\nvec4 project_model_to_clipspace(vec4 position) {\n  return viewProjectionMatrix * modelMatrix * position;\n}\n\nvec4 project_model_to_clipspace(vec3 position) {\n  return viewProjectionMatrix * modelMatrix * vec4(position, 1.);\n}\n\nvec4 project_world_to_clipspace(vec3 position) {\n  return viewProjectionMatrix * vec4(position, 1.);\n}\n\nvec4 project_view_to_clipspace(vec3 position) {\n  return projectionMatrix * vec4(position, 1.);\n}\n\nvec4 project_to_clipspace(vec3 position) {\n  return viewProjectionMatrix * vec4(position, 1.);\n}\n`,lM=`\n${uM}`,hM={name:"project",getUniforms:aM,vs:cM,fs:lM},fM=new Float32Array([1,1,2]),dM={lightDirection:fM};function pM(t=dM){const e={};return t.lightDirection&&(e.dirlight_uLightDirection=t.lightDirection),e}const gM=null,mM="uniform vec3 dirlight_uLightDirection;\nvec4 dirlight_filterColor(vec4 color) {\n  vec3 normal = project_getNormal_World();\n  float d = abs(dot(normalize(normal), normalize(dirlight_uLightDirection)));\n  return vec4(color.rgb * d, color.a);\n}\n",yM={name:"dirlight",vs:gM,fs:mM,getUniforms:pM,dependencies:[hM]};var vM="uniform mat4 u_MVPMatrix;\nuniform mat4 u_ModelMatrix;\nuniform mat4 u_NormalMatrix;\n\nvarying vec3 pbr_vPosition;\nvarying vec2 pbr_vUV;\n\n#ifdef HAS_NORMALS\n# ifdef HAS_TANGENTS\nvarying mat3 pbr_vTBN;\n# else\nvarying vec3 pbr_vNormal;\n# endif\n#endif\n\nvoid pbr_setPositionNormalTangentUV(vec4 position, vec4 normal, vec4 tangent, vec2 uv)\n{\n  vec4 pos = u_ModelMatrix * position;\n  pbr_vPosition = vec3(pos.xyz) / pos.w;\n\n#ifdef HAS_NORMALS\n#ifdef HAS_TANGENTS\n  vec3 normalW = normalize(vec3(u_NormalMatrix * vec4(normal.xyz, 0.0)));\n  vec3 tangentW = normalize(vec3(u_ModelMatrix * vec4(tangent.xyz, 0.0)));\n  vec3 bitangentW = cross(normalW, tangentW) * tangent.w;\n  pbr_vTBN = mat3(tangentW, bitangentW, normalW);\n#else\n  pbr_vNormal = normalize(vec3(u_ModelMatrix * vec4(normal.xyz, 0.0)));\n#endif\n#endif\n\n#ifdef HAS_UV\n  pbr_vUV = uv;\n#else\n  pbr_vUV = vec2(0.,0.);\n#endif\n}\n",bM="#if defined(USE_TEX_LOD) && !defined(FEATURE_GLSL_TEXTURE_LOD)\n# error PBR fragment shader: Texture LOD is not available\n#endif\n\n#if !defined(HAS_TANGENTS) && !defined(FEATURE_GLSL_DERIVATIVES)\n# error PBR fragment shader: Derivatives are not available\n#endif\n\n\n#if (__VERSION__ < 300)\n  #define SMART_FOR(INIT, WEBGL1COND, WEBGL2COND, INCR) for (INIT; WEBGL1COND; INCR)\n#else\n  #define SMART_FOR(INIT, WEBGL1COND, WEBGL2COND, INCR) for (INIT; WEBGL2COND; INCR)\n#endif\n\nprecision highp float;\n\nuniform bool pbr_uUnlit;\n\n#ifdef USE_IBL\nuniform samplerCube u_DiffuseEnvSampler;\nuniform samplerCube u_SpecularEnvSampler;\nuniform sampler2D u_brdfLUT;\nuniform vec2 u_ScaleIBLAmbient;\n#endif\n\n#ifdef HAS_BASECOLORMAP\nuniform sampler2D u_BaseColorSampler;\n#endif\n#ifdef HAS_NORMALMAP\nuniform sampler2D u_NormalSampler;\nuniform float u_NormalScale;\n#endif\n#ifdef HAS_EMISSIVEMAP\nuniform sampler2D u_EmissiveSampler;\nuniform vec3 u_EmissiveFactor;\n#endif\n#ifdef HAS_METALROUGHNESSMAP\nuniform sampler2D u_MetallicRoughnessSampler;\n#endif\n#ifdef HAS_OCCLUSIONMAP\nuniform sampler2D u_OcclusionSampler;\nuniform float u_OcclusionStrength;\n#endif\n\n#ifdef ALPHA_CUTOFF\nuniform float u_AlphaCutoff;\n#endif\n\nuniform vec2 u_MetallicRoughnessValues;\nuniform vec4 u_BaseColorFactor;\n\nuniform vec3 u_Camera;\n#ifdef PBR_DEBUG\nuniform vec4 u_ScaleDiffBaseMR;\nuniform vec4 u_ScaleFGDSpec;\n#endif\n\nvarying vec3 pbr_vPosition;\n\nvarying vec2 pbr_vUV;\n\n#ifdef HAS_NORMALS\n#ifdef HAS_TANGENTS\nvarying mat3 pbr_vTBN;\n#else\nvarying vec3 pbr_vNormal;\n#endif\n#endif\n\n\nstruct PBRInfo\n{\n  float NdotL;\n  float NdotV;\n  float NdotH;\n  float LdotH;\n  float VdotH;\n  float perceptualRoughness;\n  float metalness;\n  vec3 reflectance0;\n  vec3 reflectance90;\n  float alphaRoughness;\n  vec3 diffuseColor;\n  vec3 specularColor;\n  vec3 n;\n  vec3 v;\n};\n\nconst float M_PI = 3.141592653589793;\nconst float c_MinRoughness = 0.04;\n\nvec4 SRGBtoLINEAR(vec4 srgbIn)\n{\n#ifdef MANUAL_SRGB\n#ifdef SRGB_FAST_APPROXIMATION\n  vec3 linOut = pow(srgbIn.xyz,vec3(2.2));\n#else\n  vec3 bLess = step(vec3(0.04045),srgbIn.xyz);\n  vec3 linOut = mix( srgbIn.xyz/vec3(12.92), pow((srgbIn.xyz+vec3(0.055))/vec3(1.055),vec3(2.4)), bLess );\n#endif\n  return vec4(linOut,srgbIn.w);;\n#else\n  return srgbIn;\n#endif\n}\n\nvec3 getNormal()\n{\n#ifndef HAS_TANGENTS\n  vec3 pos_dx = dFdx(pbr_vPosition);\n  vec3 pos_dy = dFdy(pbr_vPosition);\n  vec3 tex_dx = dFdx(vec3(pbr_vUV, 0.0));\n  vec3 tex_dy = dFdy(vec3(pbr_vUV, 0.0));\n  vec3 t = (tex_dy.t * pos_dx - tex_dx.t * pos_dy) / (tex_dx.s * tex_dy.t - tex_dy.s * tex_dx.t);\n\n#ifdef HAS_NORMALS\n  vec3 ng = normalize(pbr_vNormal);\n#else\n  vec3 ng = cross(pos_dx, pos_dy);\n#endif\n\n  t = normalize(t - ng * dot(ng, t));\n  vec3 b = normalize(cross(ng, t));\n  mat3 tbn = mat3(t, b, ng);\n#else\n  mat3 tbn = pbr_vTBN;\n#endif\n\n#ifdef HAS_NORMALMAP\n  vec3 n = texture2D(u_NormalSampler, pbr_vUV).rgb;\n  n = normalize(tbn * ((2.0 * n - 1.0) * vec3(u_NormalScale, u_NormalScale, 1.0)));\n#else\n  vec3 n = normalize(tbn[2].xyz);\n#endif\n\n  return n;\n}\n\n\n#ifdef USE_IBL\nvec3 getIBLContribution(PBRInfo pbrInputs, vec3 n, vec3 reflection)\n{\n  float mipCount = 9.0;\n  float lod = (pbrInputs.perceptualRoughness * mipCount);\n  vec3 brdf = SRGBtoLINEAR(texture2D(u_brdfLUT,\n    vec2(pbrInputs.NdotV, 1.0 - pbrInputs.perceptualRoughness))).rgb;\n  vec3 diffuseLight = SRGBtoLINEAR(textureCube(u_DiffuseEnvSampler, n)).rgb;\n\n#ifdef USE_TEX_LOD\n  vec3 specularLight = SRGBtoLINEAR(textureCubeLod(u_SpecularEnvSampler, reflection, lod)).rgb;\n#else\n  vec3 specularLight = SRGBtoLINEAR(textureCube(u_SpecularEnvSampler, reflection)).rgb;\n#endif\n\n  vec3 diffuse = diffuseLight * pbrInputs.diffuseColor;\n  vec3 specular = specularLight * (pbrInputs.specularColor * brdf.x + brdf.y);\n  diffuse *= u_ScaleIBLAmbient.x;\n  specular *= u_ScaleIBLAmbient.y;\n\n  return diffuse + specular;\n}\n#endif\n\n\nvec3 diffuse(PBRInfo pbrInputs)\n{\n  return pbrInputs.diffuseColor / M_PI;\n}\n\nvec3 specularReflection(PBRInfo pbrInputs)\n{\n  return pbrInputs.reflectance0 +\n    (pbrInputs.reflectance90 - pbrInputs.reflectance0) *\n    pow(clamp(1.0 - pbrInputs.VdotH, 0.0, 1.0), 5.0);\n}\n\n\n\nfloat geometricOcclusion(PBRInfo pbrInputs)\n{\n  float NdotL = pbrInputs.NdotL;\n  float NdotV = pbrInputs.NdotV;\n  float r = pbrInputs.alphaRoughness;\n\n  float attenuationL = 2.0 * NdotL / (NdotL + sqrt(r * r + (1.0 - r * r) * (NdotL * NdotL)));\n  float attenuationV = 2.0 * NdotV / (NdotV + sqrt(r * r + (1.0 - r * r) * (NdotV * NdotV)));\n  return attenuationL * attenuationV;\n}\n\n\n\n\n\nfloat microfacetDistribution(PBRInfo pbrInputs)\n{\n  float roughnessSq = pbrInputs.alphaRoughness * pbrInputs.alphaRoughness;\n  float f = (pbrInputs.NdotH * roughnessSq - pbrInputs.NdotH) * pbrInputs.NdotH + 1.0;\n  return roughnessSq / (M_PI * f * f);\n}\n\nvoid PBRInfo_setAmbientLight(inout PBRInfo pbrInputs) {\n  pbrInputs.NdotL = 1.0;\n  pbrInputs.NdotH = 0.0;\n  pbrInputs.LdotH = 0.0;\n  pbrInputs.VdotH = 1.0;\n}\n\nvoid PBRInfo_setDirectionalLight(inout PBRInfo pbrInputs, vec3 lightDirection) {\n  vec3 n = pbrInputs.n;\n  vec3 v = pbrInputs.v;\n  vec3 l = normalize(lightDirection);\n  vec3 h = normalize(l+v);\n\n  pbrInputs.NdotL = clamp(dot(n, l), 0.001, 1.0);\n  pbrInputs.NdotH = clamp(dot(n, h), 0.0, 1.0);\n  pbrInputs.LdotH = clamp(dot(l, h), 0.0, 1.0);\n  pbrInputs.VdotH = clamp(dot(v, h), 0.0, 1.0);\n}\n\nvoid PBRInfo_setPointLight(inout PBRInfo pbrInputs, PointLight pointLight) {\n  vec3 light_direction = normalize(pointLight.position - pbr_vPosition);\n  PBRInfo_setDirectionalLight(pbrInputs, light_direction);\n}\n\nvec3 calculateFinalColor(PBRInfo pbrInputs, vec3 lightColor) {\n  vec3 F = specularReflection(pbrInputs);\n  float G = geometricOcclusion(pbrInputs);\n  float D = microfacetDistribution(pbrInputs);\n  vec3 diffuseContrib = (1.0 - F) * diffuse(pbrInputs);\n  vec3 specContrib = F * G * D / (4.0 * pbrInputs.NdotL * pbrInputs.NdotV);\n  return pbrInputs.NdotL * lightColor * (diffuseContrib + specContrib);\n}\n\nvec4 pbr_filterColor(vec4 colorUnused)\n{\n#ifdef HAS_BASECOLORMAP\n  vec4 baseColor = SRGBtoLINEAR(texture2D(u_BaseColorSampler, pbr_vUV)) * u_BaseColorFactor;\n#else\n  vec4 baseColor = u_BaseColorFactor;\n#endif\n\n#ifdef ALPHA_CUTOFF\n  if (baseColor.a < u_AlphaCutoff) {\n    discard;\n  }\n#endif\n\n  vec3 color = vec3(0, 0, 0);\n\n  if(pbr_uUnlit){\n    color.rgb = baseColor.rgb;\n  }\n  else{\n\n\n    float perceptualRoughness = u_MetallicRoughnessValues.y;\n    float metallic = u_MetallicRoughnessValues.x;\n#ifdef HAS_METALROUGHNESSMAP\n\n    vec4 mrSample = texture2D(u_MetallicRoughnessSampler, pbr_vUV);\n    perceptualRoughness = mrSample.g * perceptualRoughness;\n    metallic = mrSample.b * metallic;\n#endif\n    perceptualRoughness = clamp(perceptualRoughness, c_MinRoughness, 1.0);\n    metallic = clamp(metallic, 0.0, 1.0);\n\n    float alphaRoughness = perceptualRoughness * perceptualRoughness;\n\n    vec3 f0 = vec3(0.04);\n    vec3 diffuseColor = baseColor.rgb * (vec3(1.0) - f0);\n    diffuseColor *= 1.0 - metallic;\n    vec3 specularColor = mix(f0, baseColor.rgb, metallic);\n    float reflectance = max(max(specularColor.r, specularColor.g), specularColor.b);\n\n\n\n    float reflectance90 = clamp(reflectance * 25.0, 0.0, 1.0);\n    vec3 specularEnvironmentR0 = specularColor.rgb;\n    vec3 specularEnvironmentR90 = vec3(1.0, 1.0, 1.0) * reflectance90;\n\n    vec3 n = getNormal();\n    vec3 v = normalize(u_Camera - pbr_vPosition);\n\n    float NdotV = clamp(abs(dot(n, v)), 0.001, 1.0);\n    vec3 reflection = -normalize(reflect(v, n));\n\n    PBRInfo pbrInputs = PBRInfo(\n      0.0,\n      NdotV,\n      0.0,\n      0.0,\n      0.0,\n      perceptualRoughness,\n      metallic,\n      specularEnvironmentR0,\n      specularEnvironmentR90,\n      alphaRoughness,\n      diffuseColor,\n      specularColor,\n      n,\n      v\n    );\n\n#ifdef USE_LIGHTS\n    PBRInfo_setAmbientLight(pbrInputs);\n    color += calculateFinalColor(pbrInputs, lighting_uAmbientLight.color);\n    SMART_FOR(int i = 0, i < MAX_LIGHTS, i < lighting_uDirectionalLightCount, i++) {\n      if (i < lighting_uDirectionalLightCount) {\n        PBRInfo_setDirectionalLight(pbrInputs, lighting_uDirectionalLight[i].direction);\n        color += calculateFinalColor(pbrInputs, lighting_uDirectionalLight[i].color);\n      }\n    }\n    SMART_FOR(int i = 0, i < MAX_LIGHTS, i < lighting_uPointLightCount, i++) {\n      if (i < lighting_uPointLightCount) {\n        PBRInfo_setPointLight(pbrInputs, lighting_uPointLight[i]);\n        float attenuation = getPointLightAttenuation(lighting_uPointLight[i], distance(lighting_uPointLight[i].position, pbr_vPosition));\n        color += calculateFinalColor(pbrInputs, lighting_uPointLight[i].color / attenuation);\n      }\n    }\n#endif\n#ifdef USE_IBL\n    color += getIBLContribution(pbrInputs, n, reflection);\n#endif\n#ifdef HAS_OCCLUSIONMAP\n    float ao = texture2D(u_OcclusionSampler, pbr_vUV).r;\n    color = mix(color, color * ao, u_OcclusionStrength);\n#endif\n\n#ifdef HAS_EMISSIVEMAP\n    vec3 emissive = SRGBtoLINEAR(texture2D(u_EmissiveSampler, pbr_vUV)).rgb * u_EmissiveFactor;\n    color += emissive;\n#endif\n\n#ifdef PBR_DEBUG\n\n\n\n\n\n    color = mix(color, baseColor.rgb, u_ScaleDiffBaseMR.y);\n    color = mix(color, vec3(metallic), u_ScaleDiffBaseMR.z);\n    color = mix(color, vec3(perceptualRoughness), u_ScaleDiffBaseMR.w);\n#endif\n\n  }\n\n  return vec4(pow(color,vec3(1.0/2.2)), baseColor.a);\n}\n";const _M={name:"pbr",vs:vM,fs:bM,defines:{LIGHTING_FRAGMENT:1},dependencies:[vw]};function wM(t,e,n){return t.fields=e||[],t.fname=n,t}function xM(t){return null==t?null:t.fname}function SM(t){return null==t?null:t.fields}function EM(t){return 1===t.length?AM(t[0]):MM(t)}const AM=t=>(function(e){return e[t]}),MM=t=>{const e=t.length;return function(n){for(let r=0;r<e;++r)n=n[t[r]];return n}};function CM(t){throw Error(t)}function kM(t){const e=[],n=t.length;let r,i,o,s=null,a=0,u="";function c(){e.push(u+t.substring(r,i)),u="",r=i+1}for(t+="",r=i=0;i<n;++i)if(o=t[i],"\\"===o)u+=t.substring(r,i),u+=t.substring(++i,++i),r=i;else if(o===s)c(),s=null,a=-1;else{if(s)continue;r===a&&'"'===o?(r=i+1,s=o):r===a&&"'"===o?(r=i+1,s=o):"."!==o||a?"["===o?(i>r&&c(),a=r=i+1):"]"===o&&(a||CM("Access path missing open bracket: "+t),a>0&&c(),a=0,r=i+1):i>r?c():r=i+1}return a&&CM("Access path missing closing bracket: "+t),s&&CM("Access path missing closing quote: "+t),i>r&&(i++,c()),e}function OM(t,e,n){const r=kM(t);return t=1===r.length?r[0]:t,wM((n&&n.get||EM)(r),[t],e||t)}const PM=OM("id"),TM=wM(t=>t,[],"identity"),LM=wM(()=>0,[],"zero"),IM=wM(()=>1,[],"one"),NM=wM(()=>!0,[],"true"),DM=wM(()=>!1,[],"false");function RM(t,e,n){const r=[e].concat([].slice.call(n));console[t].apply(console,r)}const FM=0,BM=1,jM=2,zM=3,UM=4;function $M(t,e,n=RM){let r=t||FM;return{level(t){return arguments.length?(r=+t,this):r},error(){return r>=BM&&n(e||"error","ERROR",arguments),this},warn(){return r>=jM&&n(e||"warn","WARN",arguments),this},info(){return r>=zM&&n(e||"log","INFO",arguments),this},debug(){return r>=UM&&n(e||"log","DEBUG",arguments),this}}}var VM=Array.isArray;function qM(t){return t===Object(t)}const WM=t=>"__proto__"!==t;function GM(...t){return t.reduce((t,e)=>{for(const n in e)if("signals"===n)t.signals=XM(t.signals,e.signals);else{const r="legend"===n?{layout:1}:"style"===n||null;HM(t,n,e[n],r)}return t},{})}function HM(t,e,n,r){if(!WM(e))return;let i,o;if(qM(n)&&!VM(n))for(i in o=qM(t[e])?t[e]:t[e]={},n)r&&(!0===r||r[i])?HM(o,i,n[i]):WM(i)&&(o[i]=n[i]);else t[e]=n}function XM(t,e){if(null==t)return e;const n={},r=[];function i(t){n[t.name]||(n[t.name]=1,r.push(t))}return e.forEach(i),t.forEach(i),r}function YM(t){return t[t.length-1]}function ZM(t){return null==t||""===t?null:+t}const KM=t=>e=>t*Math.exp(e),JM=t=>e=>Math.log(t*e),QM=t=>e=>Math.sign(e)*Math.log1p(Math.abs(e/t)),tC=t=>e=>Math.sign(e)*Math.expm1(Math.abs(e))*t,eC=t=>e=>e<0?-Math.pow(-e,t):Math.pow(e,t);function nC(t,e,n,r){const i=n(t[0]),o=n(YM(t)),s=(o-i)*e;return[r(i-s),r(o-s)]}function rC(t,e){return nC(t,e,ZM,TM)}function iC(t,e){var n=Math.sign(t[0]);return nC(t,e,JM(n),KM(n))}function oC(t,e,n){return nC(t,e,eC(n),eC(1/n))}function sC(t,e,n){return nC(t,e,QM(n),tC(n))}function aC(t,e,n,r,i){const o=r(t[0]),s=r(YM(t)),a=null!=e?r(e):(o+s)/2;return[i(a+(o-a)*n),i(a+(s-a)*n)]}function uC(t,e,n){return aC(t,e,n,ZM,TM)}function cC(t,e,n){const r=Math.sign(t[0]);return aC(t,e,n,JM(r),KM(r))}function lC(t,e,n,r){return aC(t,e,n,eC(r),eC(1/r))}function hC(t,e,n,r){return aC(t,e,n,QM(r),tC(r))}function fC(t){return 1+~~(new Date(t).getMonth()/3)}function dC(t){return 1+~~(new Date(t).getUTCMonth()/3)}function pC(t){return null!=t?VM(t)?t:[t]:[]}function gC(t,e,n){let r,i=t[0],o=t[1];return o<i&&(r=o,o=i,i=r),r=o-i,r>=n-e?[e,n]:[i=Math.min(Math.max(i,e),n-r),i+r]}function mC(t){return"function"===typeof t}const yC="descending";function vC(t,e,n){n=n||{},e=pC(e)||[];const r=[],i=[],o={},s=n.comparator||_C;return pC(t).forEach((t,s)=>{null!=t&&(r.push(e[s]===yC?-1:1),i.push(t=mC(t)?t:OM(t,null,n)),(SM(t)||[]).forEach(t=>o[t]=1))}),0===i.length?null:wM(s(i,r),Object.keys(o))}const bC=(t,e)=>(t<e||null==t)&&null!=e?-1:(t>e||null==e)&&null!=t?1:(e=e instanceof Date?+e:e,(t=t instanceof Date?+t:t)!==t&&e===e?-1:e!==e&&t===t?1:0),_C=(t,e)=>1===t.length?wC(t[0],e[0]):xC(t,e,t.length),wC=(t,e)=>(function(n,r){return bC(t(n),t(r))*e}),xC=(t,e,n)=>{return e.push(0),function(r,i){let o,s=0,a=-1;while(0===s&&++a<n)o=t[a],s=bC(o(r),o(i));return s*e[a]}};function SC(t){return mC(t)?t:()=>t}function EC(t,e){let n;return r=>{n&&clearTimeout(n),n=setTimeout(()=>(e(r),n=null),t)}}function AC(t){for(let e,n,r=1,i=arguments.length;r<i;++r)for(n in e=arguments[r],e)t[n]=e[n];return t}function MC(t,e){let n,r,i,o,s=0;if(t&&(n=t.length))if(null==e){for(r=t[s];s<n&&(null==r||r!==r);r=t[++s]);for(i=o=r;s<n;++s)r=t[s],null!=r&&(r<i&&(i=r),r>o&&(o=r))}else{for(r=e(t[s]);s<n&&(null==r||r!==r);r=e(t[++s]));for(i=o=r;s<n;++s)r=e(t[s]),null!=r&&(r<i&&(i=r),r>o&&(o=r))}return[i,o]}function CC(t,e){const n=t.length;let r,i,o,s,a,u=-1;if(null==e){while(++u<n)if(i=t[u],null!=i&&i>=i){r=o=i;break}if(u===n)return[-1,-1];s=a=u;while(++u<n)i=t[u],null!=i&&(r>i&&(r=i,s=u),o<i&&(o=i,a=u))}else{while(++u<n)if(i=e(t[u],u,t),null!=i&&i>=i){r=o=i;break}if(u===n)return[-1,-1];s=a=u;while(++u<n)i=e(t[u],u,t),null!=i&&(r>i&&(r=i,s=u),o<i&&(o=i,a=u))}return[s,a]}const kC=Object.prototype.hasOwnProperty;function OC(t,e){return kC.call(t,e)}const PC={};function TC(t){let e,n={};function r(t){return OC(n,t)&&n[t]!==PC}const i={size:0,empty:0,object:n,has:r,get(t){return r(t)?n[t]:void 0},set(t,e){return r(t)||(++i.size,n[t]===PC&&--i.empty),n[t]=e,this},delete(t){return r(t)&&(--i.size,++i.empty,n[t]=PC),this},clear(){i.size=i.empty=0,i.object=n={}},test(t){return arguments.length?(e=t,i):e},clean(){const t={};let r=0;for(const i in n){const o=n[i];o===PC||e&&e(o)||(t[i]=o,++r)}i.size=r,i.empty=0,i.object=n=t}};return t&&Object.keys(t).forEach(e=>{i.set(e,t[e])}),i}function LC(t,e,n,r,i,o){if(!n&&0!==n)return o;const s=+n;let a,u=t[0],c=YM(t);c<u&&(a=u,u=c,c=a),a=Math.abs(e-u);const l=Math.abs(c-e);return a<l&&a<=s?r:l<=s?i:o}function IC(t,e,n){const r=t.prototype=Object.create(e.prototype);return Object.defineProperty(r,"constructor",{value:t,writable:!0,enumerable:!0,configurable:!0}),AC(r,n)}function NC(t,e,n,r){let i,o=e[0],s=e[e.length-1];return o>s&&(i=o,o=s,s=i),n=void 0===n||n,r=void 0===r||r,(n?o<=t:o<t)&&(r?t<=s:t<s)}function DC(t){return"boolean"===typeof t}function RC(t){return"[object Date]"===Object.prototype.toString.call(t)}function FC(t){return t&&mC(t[Symbol.iterator])}function BC(t){return"number"===typeof t}function jC(t){return"[object RegExp]"===Object.prototype.toString.call(t)}function zC(t){return"string"===typeof t}function UC(t,e,n){t&&(t=e?pC(t).map(t=>t.replace(/\\(.)/g,"$1")):pC(t));const r=t&&t.length,i=n&&n.get||EM,o=t=>i(e?[t]:kM(t));let s;if(r)if(1===r){const e=o(t[0]);s=function(t){return""+e(t)}}else{const e=t.map(o);s=function(t){let n=""+e[0](t),i=0;while(++i<r)n+="|"+e[i](t);return n}}else s=function(){return""};return wM(s,t,"key")}function $C(t,e){const n=t[0],r=YM(t),i=+e;return i?1===i?r:n+i*(r-n):n}const VC=1e4;function qC(t){let e,n,r;t=+t||VC;const i=()=>{e={},n={},r=0},o=(i,o)=>{return++r>t&&(n=e,e={},r=1),e[i]=o};return i(),{clear:i,has:t=>OC(e,t)||OC(n,t),get:t=>OC(e,t)?e[t]:OC(n,t)?o(t,n[t]):void 0,set:(t,n)=>OC(e,t)?e[t]=n:o(t,n)}}function WC(t,e,n,r){const i=e.length,o=n.length;if(!o)return e;if(!i)return n;const s=r||new e.constructor(i+o);let a=0,u=0,c=0;for(;a<i&&u<o;++c)s[c]=t(e[a],n[u])>0?n[u++]:e[a++];for(;a<i;++a,++c)s[c]=e[a];for(;u<o;++u,++c)s[c]=n[u];return s}function GC(t,e){let n="";while(--e>=0)n+=t;return n}function HC(t,e,n,r){const i=n||" ",o=t+"",s=e-o.length;return s<=0?o:"left"===r?GC(i,s)+o:"center"===r?GC(i,~~(s/2))+o+GC(i,Math.ceil(s/2)):o+GC(i,s)}function XC(t){return t&&YM(t)-t[0]||0}function YC(t){return VM(t)?"["+t.map(YC)+"]":qM(t)||zC(t)?JSON.stringify(t).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):t}function ZC(t){return null==t||""===t?null:!(!t||"false"===t||"0"===t)&&!!t}const KC=t=>BC(t)?t:RC(t)?t:Date.parse(t);function JC(t,e){return e=e||KC,null==t||""===t?null:e(t)}function QC(t){return null==t||""===t?null:t+""}function tk(t){const e={},n=t.length;for(let r=0;r<n;++r)e[t[r]]=!0;return e}function ek(t,e,n,r){const i=null!=r?r:"…",o=t+"",s=o.length,a=Math.max(0,e-i.length);return s<=e?o:"left"===n?i+o.slice(s-a):"center"===n?o.slice(0,Math.ceil(a/2))+i+o.slice(s-~~(a/2)):o.slice(0,a)+i}function nk(t,e,n){if(t)if(e){const r=t.length;for(let i=0;i<r;++i){const r=e(t[i]);r&&n(r,i,t)}}else t.forEach(n)}function rk(t,e,n){return t.fields=e||[],t.fname=n,t}function ik(t){return 1===t.length?ok(t[0]):sk(t)}const ok=t=>(function(e){return e[t]}),sk=t=>{const e=t.length;return function(n){for(let r=0;r<e;++r)n=n[t[r]];return n}};function ak(t){throw Error(t)}function uk(t){const e=[],n=t.length;let r,i,o,s=null,a=0,u="";function c(){e.push(u+t.substring(r,i)),u="",r=i+1}for(t+="",r=i=0;i<n;++i)if(o=t[i],"\\"===o)u+=t.substring(r,i),u+=t.substring(++i,++i),r=i;else if(o===s)c(),s=null,a=-1;else{if(s)continue;r===a&&'"'===o?(r=i+1,s=o):r===a&&"'"===o?(r=i+1,s=o):"."!==o||a?"["===o?(i>r&&c(),a=r=i+1):"]"===o&&(a||ak("Access path missing open bracket: "+t),a>0&&c(),a=0,r=i+1):i>r?c():r=i+1}return a&&ak("Access path missing closing bracket: "+t),s&&ak("Access path missing closing quote: "+t),i>r&&(i++,c()),e}function ck(t,e,n){const r=uk(t);return t=1===r.length?r[0]:t,rk((n&&n.get||ik)(r),[t],e||t)}const lk=ck("id"),hk=rk(t=>t,[],"identity"),fk=(rk(()=>0,[],"zero"),rk(()=>1,[],"one"),rk(()=>!0,[],"true"));rk(()=>!1,[],"false");function dk(t,e,n){const r=[e].concat([].slice.call(n));console[t].apply(console,r)}const pk=0,gk=1,mk=2,yk=3,vk=4;function bk(t,e,n=dk){let r=t||pk;return{level(t){return arguments.length?(r=+t,this):r},error(){return r>=gk&&n(e||"error","ERROR",arguments),this},warn(){return r>=mk&&n(e||"warn","WARN",arguments),this},info(){return r>=yk&&n(e||"log","INFO",arguments),this},debug(){return r>=vk&&n(e||"log","DEBUG",arguments),this}}}var _k=Array.isArray;function wk(t){return null!=t?_k(t)?t:[t]:[]}function xk(t){return"function"===typeof t}function Sk(t){return xk(t)?t:()=>t}function Ek(t,e){let n;return r=>{n&&clearTimeout(n),n=setTimeout(()=>(e(r),n=null),t)}}function Ak(t){for(let e,n,r=1,i=arguments.length;r<i;++r)for(n in e=arguments[r],e)t[n]=e[n];return t}const Mk=Object.prototype.hasOwnProperty;function Ck(t,e){return Mk.call(t,e)}function kk(t,e,n){const r=t.prototype=Object.create(e.prototype);return Object.defineProperty(r,"constructor",{value:t,writable:!0,enumerable:!0,configurable:!0}),Ak(r,n)}function Ok(t,e,n){if(t)if(e){const r=t.length;for(let i=0;i<r;++i){const r=e(t[i]);r&&n(r,i,t)}}else t.forEach(n)}var Pk=n("7ba4"),Tk=n("c092");function Lk(t){const e=t||hk,n=[],r={};return n.add=t=>{const i=e(t);return r[i]||(r[i]=1,n.push(t)),n},n.remove=t=>{const i=e(t);if(r[i]){r[i]=0;const e=n.indexOf(t);e>=0&&n.splice(e,1)}return n},n}async function Ik(t,e){try{await e(t)}catch(n){t.error(n)}}const Nk=Symbol("vega_id");let Dk=1;function Rk(t){return!(!t||!Fk(t))}function Fk(t){return t[Nk]}function Bk(t,e){return t[Nk]=e,t}function jk(t){const e=t===Object(t)?t:{data:t};return Fk(e)?e:Bk(e,Dk++)}function zk(t){return Uk(t,jk({}))}function Uk(t,e){for(const n in t)e[n]=t[n];return e}function $k(t,e){return Bk(e,Fk(t))}function Vk(t,e){return t?e?(n,r)=>t(n,r)||Fk(e(n))-Fk(e(r)):(e,n)=>t(e,n)||Fk(e)-Fk(n):null}function qk(t){return t&&t.constructor===Wk}function Wk(){const t=[],e=[],n=[],r=[],i=[];let o=null,s=!1;return{constructor:Wk,insert(e){const n=wk(e),r=n.length;for(let i=0;i<r;++i)t.push(n[i]);return this},remove(t){const n=xk(t)?r:e,i=wk(t),o=i.length;for(let e=0;e<o;++e)n.push(i[e]);return this},modify(t,e,r){const o={field:e,value:Sk(r)};return xk(t)?(o.filter=t,i.push(o)):(o.tuple=t,n.push(o)),this},encode(t,e){return xk(t)?i.push({filter:t,field:e}):n.push({tuple:t,field:e}),this},clean(t){return o=t,this},reflow(){return s=!0,this},pulse(a,u){const c={},l={};let h,f,d,p,g,m;for(h=0,f=u.length;h<f;++h)c[Fk(u[h])]=1;for(h=0,f=e.length;h<f;++h)g=e[h],c[Fk(g)]=-1;for(h=0,f=r.length;h<f;++h)p=r[h],u.forEach(t=>{p(t)&&(c[Fk(t)]=-1)});for(h=0,f=t.length;h<f;++h)g=t[h],m=Fk(g),c[m]?c[m]=1:a.add.push(jk(t[h]));for(h=0,f=u.length;h<f;++h)g=u[h],c[Fk(g)]<0&&a.rem.push(g);function y(t,e,n){n?t[e]=n(t):a.encode=e,s||(l[Fk(t)]=t)}for(h=0,f=n.length;h<f;++h)d=n[h],g=d.tuple,p=d.field,m=c[Fk(g)],m>0&&(y(g,p,d.value),a.modifies(p));for(h=0,f=i.length;h<f;++h)d=i[h],p=d.filter,u.forEach(t=>{p(t)&&c[Fk(t)]>0&&y(t,d.field,d.value)}),a.modifies(d.field);if(s)a.mod=e.length||r.length?u.filter(t=>c[Fk(t)]>0):u.slice();else for(m in l)a.mod.push(l[m]);return(o||null==o&&(e.length||r.length))&&a.clean(!0),a}}}const Gk="_:mod:_";function Hk(){Object.defineProperty(this,Gk,{writable:!0,value:{}})}Hk.prototype={set(t,e,n,r){const i=this,o=i[t],s=i[Gk];return null!=e&&e>=0?(o[e]!==n||r)&&(o[e]=n,s[e+":"+t]=-1,s[t]=-1):(o!==n||r)&&(i[t]=n,s[t]=_k(n)?1+n.length:-1),i},modified(t,e){const n=this[Gk];if(!arguments.length){for(const t in n)if(n[t])return!0;return!1}if(_k(t)){for(let e=0;e<t.length;++e)if(n[t[e]])return!0;return!1}return null!=e&&e>=0?e+1<n[t]||!!n[e+":"+t]:!!n[t]},clear(){return this[Gk]={},this}};let Xk=0;const Yk="pulse",Zk=new Hk,Kk=1,Jk=2;function Qk(t,e,n,r){this.id=++Xk,this.value=t,this.stamp=-1,this.rank=-1,this.qrank=-1,this.flags=0,e&&(this._update=e),n&&this.parameters(n,r)}function tO(t){return function(e){const n=this.flags;return 0===arguments.length?!!(n&t):(this.flags=e?n|t:n&~t,this)}}function eO(t,e,n,r){let i,o=1;return t instanceof Qk?i=t:t&&t.prototype instanceof Qk?i=new t:xk(t)?i=new Qk(null,t):(o=0,i=new Qk(t,e)),this.rank(i),o&&(r=n,n=e),n&&this.connect(i,i.parameters(n,r)),this.touch(i),i}function nO(t,e){const n=t.rank,r=e.length;for(let i=0;i<r;++i)if(n<e[i].rank)return void this.rerank(t)}Qk.prototype={targets(){return this._targets||(this._targets=Lk(lk))},set(t){return this.value!==t?(this.value=t,1):0},skip:tO(Kk),modified:tO(Jk),parameters(t,e,n){e=!1!==e;const r=this._argval=this._argval||new Hk,i=this._argops=this._argops||[],o=[];let s,a,u,c;const l=(t,n,s)=>{s instanceof Qk?(s!==this&&(e&&s.targets().add(this),o.push(s)),i.push({op:s,name:t,index:n})):r.set(t,n,s)};for(s in t)if(a=t[s],s===Yk)wk(a).forEach(t=>{t instanceof Qk?t!==this&&(t.targets().add(this),o.push(t)):ak("Pulse parameters must be operator instances.")}),this.source=a;else if(_k(a))for(r.set(s,-1,Array(u=a.length)),c=0;c<u;++c)l(s,c,a[c]);else l(s,-1,a);return this.marshall().clear(),n&&(i.initonly=!0),o},marshall(t){const e=this._argval||Zk,n=this._argops;let r,i,o,s;if(n){const a=n.length;for(i=0;i<a;++i)r=n[i],o=r.op,s=o.modified()&&o.stamp===t,e.set(r.name,r.index,o.value,s);if(n.initonly){for(i=0;i<a;++i)r=n[i],r.op.targets().remove(this);this._argops=null,this._update=null}}return e},detach(){const t=this._argops;let e,n,r,i;if(t)for(e=0,n=t.length;e<n;++e)r=t[e],i=r.op,i._targets&&i._targets.remove(this);this.pulse=null,this.source=null},evaluate(t){const e=this._update;if(e){const n=this.marshall(t.stamp),r=e.call(this,n,t);if(n.clear(),r!==this.value)this.value=r;else if(!this.modified())return t.StopPropagation}},run(t){if(t.stamp<this.stamp)return t.StopPropagation;let e;return this.skip()?(this.skip(!1),e=0):e=this.evaluate(t),this.pulse=e||t}};let rO=0;function iO(t,e,n){this.id=++rO,this.value=null,n&&(this.receive=n),t&&(this._filter=t),e&&(this._apply=e)}function oO(t,e,n){return new iO(t,e,n)}function sO(t,e,n,r){const i=this,o=oO(n,r),s=function(t){t.dataflow=i;try{o.receive(t)}catch(e){i.error(e)}finally{i.run()}};let a;a="string"===typeof t&&"undefined"!==typeof document?document.querySelectorAll(t):wk(t);const u=a.length;for(let c=0;c<u;++c)a[c].addEventListener(e,s);return o}function aO(t,e){const n=this.locale();return Object(Pk["f"])(t,e,n.timeParse,n.utcParse)}function uO(t,e,n){return e=this.parse(e,n),this.pulse(t,this.changeset().insert(e))}async function cO(t,e){const n=this;let r,i=0;try{r=await n.loader().load(t,{context:"dataflow",response:Object(Pk["g"])(e&&e.type)});try{r=n.parse(r,e)}catch(o){i=-2,n.warn("Data ingestion failed",t,o)}}catch(o){i=-1,n.warn("Loading failed",t,o)}return{data:r,status:i}}async function lO(t,e,n){const r=this,i=r._pending||hO(r);i.requests+=1;const o=await r.request(e,n);return r.pulse(t,r.changeset().remove(fk).insert(o.data||[])),i.done(),o}function hO(t){let e;const n=new Promise(t=>e=t);return n.requests=0,n.done=()=>{0===--n.requests&&(t._pending=null,e(t))},t._pending=n}iO.prototype={_filter:fk,_apply:hk,targets(){return this._targets||(this._targets=Lk(lk))},consume(t){return arguments.length?(this._consume=!!t,this):!!this._consume},receive(t){if(this._filter(t)){const e=this.value=this._apply(t),n=this._targets,r=n?n.length:0;for(let t=0;t<r;++t)n[t].receive(e);this._consume&&(t.preventDefault(),t.stopPropagation())}},filter(t){const e=oO(t);return this.targets().add(e),e},apply(t){const e=oO(null,t);return this.targets().add(e),e},merge(){const t=oO();this.targets().add(t);for(let e=0,n=arguments.length;e<n;++e)arguments[e].targets().add(t);return t},throttle(t){let e=-1;return this.filter(()=>{const n=Date.now();return n-e>t?(e=n,1):0})},debounce(t){const e=oO();return this.targets().add(oO(null,null,Ek(t,t=>{const n=t.dataflow;e.receive(t),n&&n.run&&n.run()}))),e},between(t,e){let n=!1;return t.targets().add(oO(null,null,()=>n=!0)),e.targets().add(oO(null,null,()=>n=!1)),this.filter(()=>n)},detach(){this._filter=fk,this._targets=null}};const fO={skip:!0};function dO(t,e,n,r,i){const o=t instanceof Qk?gO:pO;return o(this,t,e,n,r,i),this}function pO(t,e,n,r,i,o){const s=Ak({},o,fO);let a,u;xk(n)||(n=Sk(n)),void 0===r?a=e=>t.touch(n(e)):xk(r)?(u=new Qk(null,r,i,!1),a=e=>{u.evaluate(e);const r=n(e),i=u.value;qk(i)?t.pulse(r,i,o):t.update(r,i,s)}):a=e=>t.update(n(e),r,s),e.apply(a)}function gO(t,e,n,r,i,o){if(void 0===r)e.targets().add(n);else{const s=o||{},a=new Qk(null,mO(n,r),i,!1);a.modified(s.force),a.rank=e.rank,e.targets().add(a),n&&(a.skip(!0),a.value=n.value,a.targets().add(n),t.connect(n,[a]))}}function mO(t,e){return e=xk(e)?e:Sk(e),t?function(n,r){const i=e(n,r);return t.skip()||(t.skip(i!==this.value).value=i),i}:e}function yO(t){t.rank=++this._rank}function vO(t){const e=[t];let n,r,i;while(e.length)if(this.rank(n=e.pop()),r=n._targets)for(i=r.length;--i>=0;)e.push(n=r[i]),n===t&&ak("Cycle detected in dataflow graph.")}const bO={},_O=1,wO=2,xO=4,SO=_O|wO,EO=_O|xO,AO=_O|wO|xO,MO=8,CO=16,kO=32,OO=64;function PO(t,e,n){this.dataflow=t,this.stamp=null==e?-1:e,this.add=[],this.rem=[],this.mod=[],this.fields=null,this.encode=n||null}function TO(t,e){const n=[];return Ok(t,e,t=>n.push(t)),n}function LO(t,e){const n={};return t.visit(e,t=>{n[Fk(t)]=1}),t=>n[Fk(t)]?null:t}function IO(t,e){return t?(n,r)=>t(n,r)&&e(n,r):e}function NO(t,e,n,r){const i=this,o=n.length;let s=0;this.dataflow=t,this.stamp=e,this.fields=null,this.encode=r||null,this.pulses=n;for(let a=0;a<o;++a){const t=n[a];if(t.stamp===e){if(t.fields){const e=i.fields||(i.fields={});for(const n in t.fields)e[n]=1}t.changed(i.ADD)&&(s|=i.ADD),t.changed(i.REM)&&(s|=i.REM),t.changed(i.MOD)&&(s|=i.MOD)}}this.changes=s}async function DO(t,e,n){const r=this,i=[];if(r._pulse)return jO(r);if(r._pending&&await r._pending,e&&await Ik(r,e),!r._touched.length)return r.debug("Dataflow invoked, but nothing to do."),r;const o=++r._clock;r._pulse=new PO(r,o,t),r._touched.forEach(t=>r._enqueue(t,!0)),r._touched=Lk(lk);let s,a,u,c=0;try{while(r._heap.size()>0)s=r._heap.pop(),s.rank===s.qrank?(a=s.run(r._getPulse(s,t)),a.then?a=await a:a.async&&(i.push(a.async),a=bO),a!==bO&&s._targets&&s._targets.forEach(t=>r._enqueue(t)),++c):r._enqueue(s,!0)}catch(l){r._heap.clear(),u=l}if(r._input={},r._pulse=null,r.debug(`Pulse ${o}: ${c} operators`),u&&(r._postrun=[],r.error(u)),r._postrun.length){const t=r._postrun.sort((t,e)=>e.priority-t.priority);r._postrun=[];for(let e=0;e<t.length;++e)await Ik(r,t[e].callback)}return n&&await Ik(r,n),i.length&&Promise.all(i).then(t=>r.runAsync(null,()=>{t.forEach(t=>{try{t(r)}catch(l){r.error(l)}})})),r}async function RO(t,e,n){while(this._running)await this._running;const r=()=>this._running=null;return(this._running=this.evaluate(t,e,n)).then(r,r),this._running}function FO(t,e,n){return this._pulse?jO(this):(this.evaluate(t,e,n),this)}function BO(t,e,n){if(this._pulse||e)this._postrun.push({priority:n||0,callback:t});else try{t(this)}catch(r){this.error(r)}}function jO(t){return t.error("Dataflow already running. Use runAsync() to chain invocations."),t}function zO(t,e){const n=t.stamp<this._clock;n&&(t.stamp=this._clock),(n||e)&&(t.qrank=t.rank,this._heap.push(t))}function UO(t,e){const n=t.source,r=this._clock;return n&&_k(n)?new NO(this,r,n.map(t=>t.pulse),e):this._input[t.id]||$O(this._pulse,n&&n.pulse)}function $O(t,e){return e&&e.stamp===t.stamp?e:(t=t.fork(),e&&e!==bO&&(t.source=e.source),t)}PO.prototype={StopPropagation:bO,ADD:_O,REM:wO,MOD:xO,ADD_REM:SO,ADD_MOD:EO,ALL:AO,REFLOW:MO,SOURCE:CO,NO_SOURCE:kO,NO_FIELDS:OO,fork(t){return new PO(this.dataflow).init(this,t)},clone(){const t=this.fork(AO);return t.add=t.add.slice(),t.rem=t.rem.slice(),t.mod=t.mod.slice(),t.source&&(t.source=t.source.slice()),t.materialize(AO|CO)},addAll(){let t=this;const e=!t.source||t.add===t.rem||!t.rem.length&&t.source.length===t.add.length;return e?t:(t=new PO(this.dataflow).init(this),t.add=t.source,t.rem=[],t)},init(t,e){const n=this;return n.stamp=t.stamp,n.encode=t.encode,!t.fields||e&OO||(n.fields=t.fields),e&_O?(n.addF=t.addF,n.add=t.add):(n.addF=null,n.add=[]),e&wO?(n.remF=t.remF,n.rem=t.rem):(n.remF=null,n.rem=[]),e&xO?(n.modF=t.modF,n.mod=t.mod):(n.modF=null,n.mod=[]),e&kO?(n.srcF=null,n.source=null):(n.srcF=t.srcF,n.source=t.source,t.cleans&&(n.cleans=t.cleans)),n},runAfter(t){this.dataflow.runAfter(t)},changed(t){const e=t||AO;return e&_O&&this.add.length||e&wO&&this.rem.length||e&xO&&this.mod.length},reflow(t){if(t)return this.fork(AO).reflow();const e=this.add.length,n=this.source&&this.source.length;return n&&n!==e&&(this.mod=this.source,e&&this.filter(xO,LO(this,_O))),this},clean(t){return arguments.length?(this.cleans=!!t,this):this.cleans},modifies(t){const e=this.fields||(this.fields={});return _k(t)?t.forEach(t=>e[t]=!0):e[t]=!0,this},modified(t,e){const n=this.fields;return!(!e&&!this.mod.length||!n)&&(arguments.length?_k(t)?t.some(t=>n[t]):n[t]:!!n)},filter(t,e){const n=this;return t&_O&&(n.addF=IO(n.addF,e)),t&wO&&(n.remF=IO(n.remF,e)),t&xO&&(n.modF=IO(n.modF,e)),t&CO&&(n.srcF=IO(n.srcF,e)),n},materialize(t){t=t||AO;const e=this;return t&_O&&e.addF&&(e.add=TO(e.add,e.addF),e.addF=null),t&wO&&e.remF&&(e.rem=TO(e.rem,e.remF),e.remF=null),t&xO&&e.modF&&(e.mod=TO(e.mod,e.modF),e.modF=null),t&CO&&e.srcF&&(e.source=e.source.filter(e.srcF),e.srcF=null),e},visit(t,e){const n=this,r=e;if(t&CO)return Ok(n.source,n.srcF,r),n;t&_O&&Ok(n.add,n.addF,r),t&wO&&Ok(n.rem,n.remF,r),t&xO&&Ok(n.mod,n.modF,r);const i=n.source;if(t&MO&&i){const t=n.add.length+n.mod.length;t===i.length||Ok(i,t?LO(n,EO):n.srcF,r)}return n}},kk(NO,PO,{fork(t){const e=new PO(this.dataflow).init(this,t&this.NO_FIELDS);return void 0!==t&&(t&e.ADD&&this.visit(e.ADD,t=>e.add.push(t)),t&e.REM&&this.visit(e.REM,t=>e.rem.push(t)),t&e.MOD&&this.visit(e.MOD,t=>e.mod.push(t))),e},changed(t){return this.changes&t},modified(t){const e=this,n=e.fields;return n&&e.changes&e.MOD?_k(t)?t.some(t=>n[t]):n[t]:0},filter(){ak("MultiPulse does not support filtering.")},materialize(){ak("MultiPulse does not support materialization.")},visit(t,e){const n=this,r=n.pulses,i=r.length;let o=0;if(t&n.SOURCE)for(;o<i;++o)r[o].visit(t,e);else for(;o<i;++o)r[o].stamp===n.stamp&&r[o].visit(t,e);return n}});const VO={skip:!1,force:!1};function qO(t,e){const n=e||VO;return this._pulse?this._enqueue(t):this._touched.add(t),n.skip&&t.skip(!0),this}function WO(t,e,n){const r=n||VO;return(t.set(e)||r.force)&&this.touch(t,r),this}function GO(t,e,n){this.touch(t,n||VO);const r=new PO(this,this._clock+(this._pulse?0:1)),i=t.pulse&&t.pulse.source||[];return r.target=t,this._input[t.id]=e.pulse(r,i),this}function HO(t){let e=[];return{clear:()=>e=[],size:()=>e.length,peek:()=>e[0],push:n=>{return e.push(n),XO(e,0,e.length-1,t)},pop:()=>{const n=e.pop();let r;return e.length?(r=e[0],e[0]=n,YO(e,0,t)):r=n,r}}}function XO(t,e,n,r){let i,o;const s=t[n];while(n>e){if(o=n-1>>1,i=t[o],!(r(s,i)<0))break;t[n]=i,n=o}return t[n]=s}function YO(t,e,n){const r=e,i=t.length,o=t[e];let s,a=1+(e<<1);while(a<i)s=a+1,s<i&&n(t[a],t[s])>=0&&(a=s),t[e]=t[a],e=a,a=1+(e<<1);return t[e]=o,XO(t,r,e,n)}function ZO(){this.logger(bk()),this.logLevel(gk),this._clock=0,this._rank=0,this._locale=Object(Tk["a"])();try{this._loader=Object(Pk["e"])()}catch(t){}this._touched=Lk(lk),this._input={},this._pulse=null,this._heap=HO((t,e)=>t.qrank-e.qrank),this._postrun=[]}function KO(t){return function(){return this._log[t].apply(this,arguments)}}function JO(t,e){Qk.call(this,t,null,e)}ZO.prototype={stamp(){return this._clock},loader(t){return arguments.length?(this._loader=t,this):this._loader},locale(t){return arguments.length?(this._locale=t,this):this._locale},logger(t){return arguments.length?(this._log=t,this):this._log},error:KO("error"),warn:KO("warn"),info:KO("info"),debug:KO("debug"),logLevel:KO("level"),cleanThreshold:1e4,add:eO,connect:nO,rank:yO,rerank:vO,pulse:GO,touch:qO,update:WO,changeset:Wk,ingest:uO,parse:aO,preload:lO,request:cO,events:sO,on:dO,evaluate:DO,run:FO,runAsync:RO,runAfter:BO,_enqueue:zO,_getPulse:UO},kk(JO,Qk,{run(t){if(t.stamp<this.stamp)return t.StopPropagation;let e;return this.skip()?this.skip(!1):e=this.evaluate(t),e=e||t,e.then?e=e.then(t=>this.pulse=t):e!==t.StopPropagation&&(this.pulse=e),e},evaluate(t){const e=this.marshall(t.stamp),n=this.transform(e,t);return e.clear(),n},transform(){}});const QO={};function tP(t){const e=eP(t);return e&&e.Definition||null}function eP(t){return t=t&&t.toLowerCase(),Ck(QO,t)?QO[t]:null}function nP(t,e,n){return t.fields=e||[],t.fname=n,t}function rP(t){return null==t?null:t.fname}function iP(t){return null==t?null:t.fields}function oP(t){return 1===t.length?sP(t[0]):aP(t)}const sP=t=>(function(e){return e[t]}),aP=t=>{const e=t.length;return function(n){for(let r=0;r<e;++r)n=n[t[r]];return n}};function uP(t){throw Error(t)}function cP(t){const e=[],n=t.length;let r,i,o,s=null,a=0,u="";function c(){e.push(u+t.substring(r,i)),u="",r=i+1}for(t+="",r=i=0;i<n;++i)if(o=t[i],"\\"===o)u+=t.substring(r,i),u+=t.substring(++i,++i),r=i;else if(o===s)c(),s=null,a=-1;else{if(s)continue;r===a&&'"'===o?(r=i+1,s=o):r===a&&"'"===o?(r=i+1,s=o):"."!==o||a?"["===o?(i>r&&c(),a=r=i+1):"]"===o&&(a||uP("Access path missing open bracket: "+t),a>0&&c(),a=0,r=i+1):i>r?c():r=i+1}return a&&uP("Access path missing closing bracket: "+t),s&&uP("Access path missing closing quote: "+t),i>r&&(i++,c()),e}function lP(t,e,n){const r=cP(t);return t=1===r.length?r[0]:t,nP((n&&n.get||oP)(r),[t],e||t)}lP("id");const hP=nP(t=>t,[],"identity"),fP=nP(()=>0,[],"zero"),dP=(nP(()=>1,[],"one"),nP(()=>!0,[],"true"));nP(()=>!1,[],"false");var pP=Array.isArray;function gP(t){return t[t.length-1]}function mP(t){return null==t||""===t?null:+t}function yP(t){return null!=t?pP(t)?t:[t]:[]}function vP(t){return"function"===typeof t}const bP="descending";function _P(t,e,n){n=n||{},e=yP(e)||[];const r=[],i=[],o={},s=n.comparator||xP;return yP(t).forEach((t,s)=>{null!=t&&(r.push(e[s]===bP?-1:1),i.push(t=vP(t)?t:lP(t,null,n)),(iP(t)||[]).forEach(t=>o[t]=1))}),0===i.length?null:nP(s(i,r),Object.keys(o))}const wP=(t,e)=>(t<e||null==t)&&null!=e?-1:(t>e||null==e)&&null!=t?1:(e=e instanceof Date?+e:e,(t=t instanceof Date?+t:t)!==t&&e===e?-1:e!==e&&t===t?1:0),xP=(t,e)=>1===t.length?SP(t[0],e[0]):EP(t,e,t.length),SP=(t,e)=>(function(n,r){return wP(t(n),t(r))*e}),EP=(t,e,n)=>{return e.push(0),function(r,i){let o,s=0,a=-1;while(0===s&&++a<n)o=t[a],s=wP(o(r),o(i));return s*e[a]}};function AP(t){return vP(t)?t:()=>t}function MP(t){for(let e,n,r=1,i=arguments.length;r<i;++r)for(n in e=arguments[r],e)t[n]=e[n];return t}function CP(t,e){let n,r,i,o,s=0;if(t&&(n=t.length))if(null==e){for(r=t[s];s<n&&(null==r||r!==r);r=t[++s]);for(i=o=r;s<n;++s)r=t[s],null!=r&&(r<i&&(i=r),r>o&&(o=r))}else{for(r=e(t[s]);s<n&&(null==r||r!==r);r=e(t[++s]));for(i=o=r;s<n;++s)r=e(t[s]),null!=r&&(r<i&&(i=r),r>o&&(o=r))}return[i,o]}function kP(t,e){const n=t.length;let r,i,o,s,a,u=-1;if(null==e){while(++u<n)if(i=t[u],null!=i&&i>=i){r=o=i;break}if(u===n)return[-1,-1];s=a=u;while(++u<n)i=t[u],null!=i&&(r>i&&(r=i,s=u),o<i&&(o=i,a=u))}else{while(++u<n)if(i=e(t[u],u,t),null!=i&&i>=i){r=o=i;break}if(u===n)return[-1,-1];s=a=u;while(++u<n)i=e(t[u],u,t),null!=i&&(r>i&&(r=i,s=u),o<i&&(o=i,a=u))}return[s,a]}const OP=Object.prototype.hasOwnProperty;function PP(t,e){return OP.call(t,e)}const TP={};function LP(t){let e,n={};function r(t){return PP(n,t)&&n[t]!==TP}const i={size:0,empty:0,object:n,has:r,get(t){return r(t)?n[t]:void 0},set(t,e){return r(t)||(++i.size,n[t]===TP&&--i.empty),n[t]=e,this},delete(t){return r(t)&&(--i.size,++i.empty,n[t]=TP),this},clear(){i.size=i.empty=0,i.object=n={}},test(t){return arguments.length?(e=t,i):e},clean(){const t={};let r=0;for(const i in n){const o=n[i];o===TP||e&&e(o)||(t[i]=o,++r)}i.size=r,i.empty=0,i.object=n=t}};return t&&Object.keys(t).forEach(e=>{i.set(e,t[e])}),i}function IP(t,e,n){const r=t.prototype=Object.create(e.prototype);return Object.defineProperty(r,"constructor",{value:t,writable:!0,enumerable:!0,configurable:!0}),MP(r,n)}function NP(t,e,n){t&&(t=e?yP(t).map(t=>t.replace(/\\(.)/g,"$1")):yP(t));const r=t&&t.length,i=n&&n.get||oP,o=t=>i(e?[t]:cP(t));let s;if(r)if(1===r){const e=o(t[0]);s=function(t){return""+e(t)}}else{const e=t.map(o);s=function(t){let n=""+e[0](t),i=0;while(++i<r)n+="|"+e[i](t);return n}}else s=function(){return""};return nP(s,t,"key")}function DP(t,e,n,r){const i=e.length,o=n.length;if(!o)return e;if(!i)return n;const s=r||new e.constructor(i+o);let a=0,u=0,c=0;for(;a<i&&u<o;++c)s[c]=t(e[a],n[u])>0?n[u++]:e[a++];for(;a<i;++a,++c)s[c]=e[a];for(;u<o;++u,++c)s[c]=n[u];return s}function RP(t){return t&&gP(t)-t[0]||0}var FP=function(t,e){return t<e?-1:t>e?1:t>=e?0:NaN};function BP(t,e){let n;if(void 0===e)for(const r of t)null!=r&&(n<r||void 0===n&&r>=r)&&(n=r);else{let r=-1;for(let i of t)null!=(i=e(i,++r,t))&&(n<i||void 0===n&&i>=i)&&(n=i)}return n}function jP(t,e){let n;if(void 0===e)for(const r of t)null!=r&&(n>r||void 0===n&&r>=r)&&(n=r);else{let r=-1;for(let i of t)null!=(i=e(i,++r,t))&&(n>i||void 0===n&&i>=i)&&(n=i)}return n}function zP(t,e,n=0,r=t.length-1,i=FP){while(r>n){if(r-n>600){const o=r-n+1,s=e-n+1,a=Math.log(o),u=.5*Math.exp(2*a/3),c=.5*Math.sqrt(a*u*(o-u)/o)*(s-o/2<0?-1:1),l=Math.max(n,Math.floor(e-s*u/o+c)),h=Math.min(r,Math.floor(e+(o-s)*u/o+c));zP(t,e,l,h,i)}const o=t[e];let s=n,a=r;UP(t,n,e),i(t[r],o)>0&&UP(t,n,r);while(s<a){UP(t,s,a),++s,--a;while(i(t[s],o)<0)++s;while(i(t[a],o)>0)--a}0===i(t[n],o)?UP(t,n,a):(++a,UP(t,a,r)),a<=e&&(n=a+1),e<=a&&(r=a-1)}return t}function UP(t,e,n){const r=t[e];t[e]=t[n],t[n]=r}var $P=function(t){return null===t?NaN:+t};function*VP(t,e){if(void 0===e)for(let n of t)null!=n&&(n=+n)>=n&&(yield n);else{let n=-1;for(let r of t)null!=(r=e(r,++n,t))&&(r=+r)>=r&&(yield r)}}function qP(t,e,n){if(t=Float64Array.from(VP(t,n)),r=t.length){if((e=+e)<=0||r<2)return jP(t);if(e>=1)return BP(t);var r,i=(r-1)*e,o=Math.floor(i),s=BP(zP(t,o).subarray(0,o+1)),a=jP(t.subarray(o+1));return s+(a-s)*(i-o)}}function WP(t,e,n=$P){if(r=t.length){if((e=+e)<=0||r<2)return+n(t[0],0,t);if(e>=1)return+n(t[r-1],r-1,t);var r,i=(r-1)*e,o=Math.floor(i),s=+n(t[o],o,t),a=+n(t[o+1],o+1,t);return s+(a-s)*(i-o)}}function GP(t,e){let n,r=0,i=0,o=0;if(void 0===e)for(let s of t)null!=s&&(s=+s)>=s&&(n=s-i,i+=n/++r,o+=n*(s-i));else{let s=-1;for(let a of t)null!=(a=e(a,++s,t))&&(a=+a)>=a&&(n=a-i,i+=n/++r,o+=n*(a-i))}if(r>1)return o/(r-1)}function HP(t,e){const n=GP(t,e);return n?Math.sqrt(n):n}var XP=function(t,e){return qP(t,.5,e)};function*YP(t,e){if(null==e)for(let n of t)null!=n&&""!==n&&(n=+n)>=n&&(yield n);else{let n=-1;for(let r of t)r=e(r,++n,t),null!=r&&""!==r&&(r=+r)>=r&&(yield r)}}function ZP(t,e,n){const r=Float64Array.from(YP(t,n));return r.sort(FP),e.map(t=>WP(r,t))}function KP(t,e){return ZP(t,[.25,.5,.75],e)}function JP(t,e){const n=t.length,r=HP(t,e),i=KP(t,e),o=(i[2]-i[0])/1.34,s=Math.min(r,o)||r||Math.abs(i[0])||1;return 1.06*s*Math.pow(n,-.2)}function QP(t){const e=t.maxbins||20,n=t.base||10,r=Math.log(n),i=t.divide||[5,2];let o,s,a,u,c,l,h=t.extent[0],f=t.extent[1];const d=t.span||f-h||Math.abs(h)||1;if(t.step)o=t.step;else if(t.steps){for(u=d/e,c=0,l=t.steps.length;c<l&&t.steps[c]<u;++c);o=t.steps[Math.max(0,c-1)]}else{s=Math.ceil(Math.log(e)/r),a=t.minstep||0,o=Math.max(a,Math.pow(n,Math.round(Math.log(d)/r)-s));while(Math.ceil(d/o)>e)o*=n;for(c=0,l=i.length;c<l;++c)u=o/i[c],u>=a&&d/u<=e&&(o=u)}u=Math.log(o);const p=u>=0?0:1+~~(-u/r),g=Math.pow(n,-p-1);return(t.nice||void 0===t.nice)&&(u=Math.floor(h/o+g)*o,h=h<u?u-o:u,f=Math.ceil(f/o)*o),{start:h,stop:f===h?h+o:f,step:o}}var tT=Math.random;function eT(t){tT=t}function nT(t,e,n,r){if(!t.length)return[void 0,void 0];const i=Float64Array.from(YP(t,r)),o=i.length,s=e;let a,u,c,l;for(c=0,l=Array(s);c<s;++c){for(a=0,u=0;u<o;++u)a+=i[~~(tT()*o)];l[c]=a/o}return l.sort(FP),[qP(l,n/2),qP(l,1-n/2)]}function rT(t,e,n,r){r=r||(t=>t);const i=t.length,o=new Float64Array(i);let s,a=0,u=1,c=r(t[0]),l=c,h=c+e;for(;u<i;++u){if(s=r(t[u]),s>=h){for(l=(c+l)/2;a<u;++a)o[a]=l;h=s+e,c=s}l=s}for(l=(c+l)/2;a<u;++a)o[a]=l;return n?iT(o,e+e/4):o}function iT(t,e){const n=t.length;let r,i,o=0,s=1;while(t[o]===t[s])++s;while(s<n){r=s+1;while(t[s]===t[r])++r;if(t[s]-t[s-1]<e){i=s+(o+r-s-s>>1);while(i<s)t[i++]=t[s];while(i>s)t[i--]=t[o]}o=s,s=r}return t}function oT(t){return function(){return t=(1103515245*t+12345)%2147483647,t/2147483647}}function sT(t,e){let n,r,i;null==e&&(e=t,t=0);const o={min(t){return arguments.length?(n=t||0,i=r-n,o):n},max(t){return arguments.length?(r=t||0,i=r-n,o):r},sample(){return n+Math.floor(i*tT())},pdf(t){return t===Math.floor(t)&&t>=n&&t<r?1/i:0},cdf(t){const e=Math.floor(t);return e<n?0:e>=r?1:(e-n+1)/i},icdf(t){return t>=0&&t<=1?n-1+Math.floor(t*i):NaN}};return o.min(t).max(e)}const aT=Math.sqrt(2*Math.PI),uT=Math.SQRT2;let cT=NaN;function lT(t,e){t=t||0,e=null==e?1:e;let n,r,i=0,o=0;if(cT===cT)i=cT,cT=NaN;else{do{i=2*tT()-1,o=2*tT()-1,n=i*i+o*o}while(0===n||n>1);r=Math.sqrt(-2*Math.log(n)/n),i*=r,cT=o*r}return t+i*e}function hT(t,e,n){n=null==n?1:n;const r=(t-(e||0))/n;return Math.exp(-.5*r*r)/(n*aT)}function fT(t,e,n){e=e||0,n=null==n?1:n;const r=(t-e)/n,i=Math.abs(r);let o;if(i>37)o=0;else{const t=Math.exp(-i*i/2);let e;i<7.07106781186547?(e=.0352624965998911*i+.700383064443688,e=e*i+6.37396220353165,e=e*i+33.912866078383,e=e*i+112.079291497871,e=e*i+221.213596169931,e=e*i+220.206867912376,o=t*e,e=.0883883476483184*i+1.75566716318264,e=e*i+16.064177579207,e=e*i+86.7807322029461,e=e*i+296.564248779674,e=e*i+637.333633378831,e=e*i+793.826512519948,e=e*i+440.413735824752,o/=e):(e=i+.65,e=i+4/e,e=i+3/e,e=i+2/e,e=i+1/e,o=t/e/2.506628274631)}return r>0?1-o:o}function dT(t,e,n){return t<0||t>1?NaN:(e||0)+(null==n?1:n)*uT*pT(2*t-1)}function pT(t){let e,n=-Math.log((1-t)*(1+t));return n<6.25?(n-=3.125,e=-364441206401782e-35,e=e*n-16850591381820166e-35,e=128584807152564e-32+e*n,e=11157877678025181e-33+e*n,e=e*n-1333171662854621e-31,e=20972767875968562e-33+e*n,e=6637638134358324e-30+e*n,e=e*n-4054566272975207e-29,e=e*n-8151934197605472e-29,e=26335093153082323e-28+e*n,e=e*n-12975133253453532e-27,e=e*n-5415412054294628e-26,e=1.0512122733215323e-9+e*n,e=e*n-4.112633980346984e-9,e=e*n-2.9070369957882005e-8,e=4.2347877827932404e-7+e*n,e=e*n-13654692000834679e-22,e=e*n-13882523362786469e-21,e=.00018673420803405714+e*n,e=e*n-.000740702534166267,e=e*n-.006033670871430149,e=.24015818242558962+e*n,e=1.6536545626831027+e*n):n<16?(n=Math.sqrt(n)-3.25,e=2.2137376921775787e-9,e=9.075656193888539e-8+e*n,e=e*n-2.7517406297064545e-7,e=1.8239629214389228e-8+e*n,e=15027403968909828e-22+e*n,e=e*n-4013867526981546e-21,e=29234449089955446e-22+e*n,e=12475304481671779e-21+e*n,e=e*n-47318229009055734e-21,e=6828485145957318e-20+e*n,e=24031110387097894e-21+e*n,e=e*n-.0003550375203628475,e=.0009532893797373805+e*n,e=e*n-.0016882755560235047,e=.002491442096107851+e*n,e=e*n-.003751208507569241,e=.005370914553590064+e*n,e=1.0052589676941592+e*n,e=3.0838856104922208+e*n):Number.isFinite(n)?(n=Math.sqrt(n)-5,e=-27109920616438573e-27,e=e*n-2.555641816996525e-10,e=1.5076572693500548e-9+e*n,e=e*n-3.789465440126737e-9,e=7.61570120807834e-9+e*n,e=e*n-1.496002662714924e-8,e=2.914795345090108e-8+e*n,e=e*n-6.771199775845234e-8,e=2.2900482228026655e-7+e*n,e=e*n-9.9298272942317e-7,e=4526062597223154e-21+e*n,e=e*n-1968177810553167e-20,e=7599527703001776e-20+e*n,e=e*n-.00021503011930044477,e=e*n-.00013871931833623122,e=1.0103004648645344+e*n,e=4.849906401408584+e*n):e=1/0,e*t}function gT(t,e){let n,r;const i={mean(t){return arguments.length?(n=t||0,i):n},stdev(t){return arguments.length?(r=null==t?1:t,i):r},sample:()=>lT(n,r),pdf:t=>hT(t,n,r),cdf:t=>fT(t,n,r),icdf:t=>dT(t,n,r)};return i.mean(t).stdev(e)}function mT(t,e){const n=gT();let r=0;const i={data(n){return arguments.length?(t=n,r=n?n.length:0,i.bandwidth(e)):t},bandwidth(n){return arguments.length?(e=n,!e&&t&&(e=JP(t)),i):e},sample(){return t[~~(tT()*r)]+e*n.sample()},pdf(i){let o=0,s=0;for(;s<r;++s)o+=n.pdf((i-t[s])/e);return o/e/r},cdf(i){let o=0,s=0;for(;s<r;++s)o+=n.cdf((i-t[s])/e);return o/r},icdf(){throw Error("KDE icdf not supported.")}};return i.data(t)}function yT(t,e){return t=t||0,e=null==e?1:e,Math.exp(t+lT()*e)}function vT(t,e,n){if(t<=0)return 0;e=e||0,n=null==n?1:n;const r=(Math.log(t)-e)/n;return Math.exp(-.5*r*r)/(n*aT*t)}function bT(t,e,n){return fT(Math.log(t),e,n)}function _T(t,e,n){return Math.exp(dT(t,e,n))}function wT(t,e){let n,r;const i={mean(t){return arguments.length?(n=t||0,i):n},stdev(t){return arguments.length?(r=null==t?1:t,i):r},sample:()=>yT(n,r),pdf:t=>vT(t,n,r),cdf:t=>bT(t,n,r),icdf:t=>_T(t,n,r)};return i.mean(t).stdev(e)}function xT(t,e){let n,r=0;function i(t){const e=[];let n,i=0;for(n=0;n<r;++n)i+=e[n]=null==t[n]?1:+t[n];for(n=0;n<r;++n)e[n]/=i;return e}const o={weights(t){return arguments.length?(n=i(e=t||[]),o):e},distributions(n){return arguments.length?(n?(r=n.length,t=n):(r=0,t=[]),o.weights(e)):t},sample(){const e=tT();let i=t[r-1],o=n[0],s=0;for(;s<r-1;o+=n[++s])if(e<o){i=t[s];break}return i.sample()},pdf(e){let i=0,o=0;for(;o<r;++o)i+=n[o]*t[o].pdf(e);return i},cdf(e){let i=0,o=0;for(;o<r;++o)i+=n[o]*t[o].cdf(e);return i},icdf(){throw Error("Mixture icdf not supported.")}};return o.distributions(t).weights(e)}function ST(t,e){return null==e&&(e=null==t?1:t,t=0),t+(e-t)*tT()}function ET(t,e,n){return null==n&&(n=null==e?1:e,e=0),t>=e&&t<=n?1/(n-e):0}function AT(t,e,n){return null==n&&(n=null==e?1:e,e=0),t<e?0:t>n?1:(t-e)/(n-e)}function MT(t,e,n){return null==n&&(n=null==e?1:e,e=0),t>=0&&t<=1?e+t*(n-e):NaN}function CT(t,e){let n,r;const i={min(t){return arguments.length?(n=t||0,i):n},max(t){return arguments.length?(r=null==t?1:t,i):r},sample:()=>ST(n,r),pdf:t=>ET(t,n,r),cdf:t=>AT(t,n,r),icdf:t=>MT(t,n,r)};return null==e&&(e=null==t?1:t,t=0),i.min(t).max(e)}function kT(t,e,n,r){const i=r-t*t,o=Math.abs(i)<1e-24?0:(n-t*e)/i,s=e-o*t;return[s,o]}function OT(t,e,n,r){t=t.filter(t=>{let r=e(t),i=n(t);return null!=r&&(r=+r)>=r&&null!=i&&(i=+i)>=i}),r&&t.sort((t,n)=>e(t)-e(n));const i=t.length,o=new Float64Array(i),s=new Float64Array(i);let a,u,c,l=0,h=0,f=0;for(c of t)o[l]=a=+e(c),s[l]=u=+n(c),++l,h+=(a-h)/l,f+=(u-f)/l;for(l=0;l<i;++l)o[l]-=h,s[l]-=f;return[o,s,h,f]}function PT(t,e,n,r){let i,o,s=-1;for(const a of t)i=e(a),o=n(a),null!=i&&(i=+i)>=i&&null!=o&&(o=+o)>=o&&r(i,o,++s)}function TT(t,e,n,r,i){let o=0,s=0;return PT(t,e,n,(t,e)=>{const n=e-i(t),a=e-r;o+=n*n,s+=a*a}),1-o/s}function LT(t,e,n){let r=0,i=0,o=0,s=0,a=0;PT(t,e,n,(t,e)=>{++a,r+=(t-r)/a,i+=(e-i)/a,o+=(t*e-o)/a,s+=(t*t-s)/a});const u=kT(r,i,o,s),c=t=>u[0]+u[1]*t;return{coef:u,predict:c,rSquared:TT(t,e,n,i,c)}}function IT(t,e,n){let r=0,i=0,o=0,s=0,a=0;PT(t,e,n,(t,e)=>{++a,t=Math.log(t),r+=(t-r)/a,i+=(e-i)/a,o+=(t*e-o)/a,s+=(t*t-s)/a});const u=kT(r,i,o,s),c=t=>u[0]+u[1]*Math.log(t);return{coef:u,predict:c,rSquared:TT(t,e,n,i,c)}}function NT(t,e,n){const[r,i,o,s]=OT(t,e,n);let a,u,c,l=0,h=0,f=0,d=0,p=0;PT(t,e,n,(t,e)=>{a=r[p++],u=Math.log(e),c=a*e,l+=(e*u-l)/p,h+=(c-h)/p,f+=(c*u-f)/p,d+=(a*c-d)/p});const[g,m]=kT(h/s,l/s,f/s,d/s),y=t=>Math.exp(g+m*(t-o));return{coef:[Math.exp(g-m*o),m],predict:y,rSquared:TT(t,e,n,s,y)}}function DT(t,e,n){let r=0,i=0,o=0,s=0,a=0,u=0;PT(t,e,n,(t,e)=>{const n=Math.log(t),c=Math.log(e);++u,r+=(n-r)/u,i+=(c-i)/u,o+=(n*c-o)/u,s+=(n*n-s)/u,a+=(e-a)/u});const c=kT(r,i,o,s),l=t=>c[0]*Math.pow(t,c[1]);return c[0]=Math.exp(c[0]),{coef:c,predict:l,rSquared:TT(t,e,n,a,l)}}function RT(t,e,n){const[r,i,o,s]=OT(t,e,n),a=r.length;let u,c,l,h,f=0,d=0,p=0,g=0,m=0;for(u=0;u<a;)c=r[u],l=i[u++],h=c*c,f+=(h-f)/u,d+=(h*c-d)/u,p+=(h*h-p)/u,g+=(c*l-g)/u,m+=(h*l-m)/u;const y=p-f*f,v=f*y-d*d,b=(m*f-g*d)/v,_=(g*y-m*d)/v,w=-b*f,x=t=>{return t-=o,b*t*t+_*t+w+s};return{coef:[w-_*o+b*o*o+s,_-2*b*o,b],predict:x,rSquared:TT(t,e,n,s,x)}}function FT(t,e,n,r){if(1===r)return LT(t,e,n);if(2===r)return RT(t,e,n);const[i,o,s,a]=OT(t,e,n),u=i.length,c=[],l=[],h=r+1;let f,d,p,g,m;for(f=0;f<h;++f){for(p=0,g=0;p<u;++p)g+=Math.pow(i[p],f)*o[p];for(c.push(g),m=new Float64Array(h),d=0;d<h;++d){for(p=0,g=0;p<u;++p)g+=Math.pow(i[p],f+d);m[d]=g}l.push(m)}l.push(c);const y=jT(l),v=t=>{t-=s;let e=a+y[0]+y[1]*t+y[2]*t*t;for(f=3;f<h;++f)e+=y[f]*Math.pow(t,f);return e};return{coef:BT(h,y,-s,a),predict:v,rSquared:TT(t,e,n,a,v)}}function BT(t,e,n,r){const i=Array(t);let o,s,a,u;for(o=0;o<t;++o)i[o]=0;for(o=t-1;o>=0;--o)for(a=e[o],u=1,i[o]+=a,s=1;s<=o;++s)u*=(o+1-s)/s,i[o-s]+=a*Math.pow(n,s)*u;return i[0]+=r,i}function jT(t){const e=t.length-1,n=[];let r,i,o,s,a;for(r=0;r<e;++r){for(s=r,i=r+1;i<e;++i)Math.abs(t[r][i])>Math.abs(t[r][s])&&(s=i);for(o=r;o<e+1;++o)a=t[o][r],t[o][r]=t[o][s],t[o][s]=a;for(i=r+1;i<e;++i)for(o=e;o>=r;o--)t[o][i]-=t[o][r]*t[r][i]/t[r][r]}for(i=e-1;i>=0;--i){for(a=0,o=i+1;o<e;++o)a+=t[o][i]*n[o];n[i]=(t[e][i]-a)/t[i][i]}return n}const zT=2,UT=1e-12;function $T(t,e,n,r){const[i,o,s,a]=OT(t,e,n,!0),u=i.length,c=Math.max(2,~~(r*u)),l=new Float64Array(u),h=new Float64Array(u),f=new Float64Array(u).fill(1);for(let d=-1;++d<=zT;){const t=[0,c-1];for(let n=0;n<u;++n){const e=i[n],r=t[0],s=t[1],a=e-i[r]>i[s]-e?r:s;let u=0,c=0,d=0,p=0,g=0;const m=1/Math.abs(i[a]-e||1);for(let t=r;t<=s;++t){const n=i[t],r=o[t],s=VT(Math.abs(e-n)*m)*f[t],a=n*s;u+=s,c+=a,d+=r*s,p+=r*a,g+=n*a}const[y,v]=kT(c/u,d/u,p/u,g/u);l[n]=y+v*e,h[n]=Math.abs(o[n]-l[n]),qT(i,n+1,t)}if(d===zT)break;const e=XP(h);if(Math.abs(e)<UT)break;for(let n,r,i=0;i<u;++i)n=h[i]/(6*e),f[i]=n>=1?UT:(r=1-n*n)*r}return WT(i,l,s,a)}function VT(t){return(t=1-t*t*t)*t*t}function qT(t,e,n){const r=t[e];let i=n[0],o=n[1]+1;if(!(o>=t.length))while(e>i&&t[o]-r<=r-t[i])n[0]=++i,n[1]=o,++o}function WT(t,e,n,r){const i=t.length,o=[];let s,a=0,u=0,c=[];for(;a<i;++a)s=t[a]+n,c[0]===s?c[1]+=(e[a]-c[1])/++u:(u=0,c[1]+=r,c=[s,e[a]],o.push(c));return c[1]+=r,o}const GT=.5*Math.PI/180;function HT(t,e,n,r){n=n||25,r=Math.max(n,r||200);const i=e=>[e,t(e)],o=e[0],s=e[1],a=s-o,u=a/r,c=[i(o)],l=[];if(n===r){for(let t=1;t<r;++t)c.push(i(o+t/n*a));return c.push(i(s)),c}l.push(i(s));for(let g=n;--g>0;)l.push(i(o+g/n*a));let h=c[0],f=l[l.length-1];const d=1/a,p=XT(h[1],l);while(f){const t=i((h[0]+f[0])/2),e=t[0]-h[0]>=u;e&&YT(h,t,f,d,p)>GT?l.push(t):(h=f,c.push(f),l.pop()),f=l[l.length-1]}return c}function XT(t,e){let n=t,r=t;const i=e.length;for(let o=0;o<i;++o){const t=e[o][1];t<n&&(n=t),t>r&&(r=t)}return 1/(r-n)}function YT(t,e,n,r,i){const o=Math.atan2(i*(n[1]-t[1]),r*(n[0]-t[0])),s=Math.atan2(i*(e[1]-t[1]),r*(e[0]-t[0]));return Math.abs(o-s)}function ZT(t,e){let n;if(void 0===e)for(const r of t)null!=r&&(n<r||void 0===n&&r>=r)&&(n=r);else{let r=-1;for(let i of t)null!=(i=e(i,++r,t))&&(n<i||void 0===n&&i>=i)&&(n=i)}return n}function KT(t,e){let n;if(void 0===e)for(const r of t)null!=r&&(n>r||void 0===n&&r>=r)&&(n=r);else{let r=-1;for(let i of t)null!=(i=e(i,++r,t))&&(n>i||void 0===n&&i>=i)&&(n=i)}return n}var JT=function(t,e){return t<e?-1:t>e?1:t>=e?0:NaN};function QT(t,e,n=0,r=t.length-1,i=JT){while(r>n){if(r-n>600){const o=r-n+1,s=e-n+1,a=Math.log(o),u=.5*Math.exp(2*a/3),c=.5*Math.sqrt(a*u*(o-u)/o)*(s-o/2<0?-1:1),l=Math.max(n,Math.floor(e-s*u/o+c)),h=Math.min(r,Math.floor(e+(o-s)*u/o+c));QT(t,e,l,h,i)}const o=t[e];let s=n,a=r;tL(t,n,e),i(t[r],o)>0&&tL(t,n,r);while(s<a){tL(t,s,a),++s,--a;while(i(t[s],o)<0)++s;while(i(t[a],o)>0)--a}0===i(t[n],o)?tL(t,n,a):(++a,tL(t,a,r)),a<=e&&(n=a+1),e<=a&&(r=a-1)}return t}function tL(t,e,n){const r=t[e];t[e]=t[n],t[n]=r}function*eL(t,e){if(void 0===e)for(let n of t)null!=n&&(n=+n)>=n&&(yield n);else{let n=-1;for(let r of t)null!=(r=e(r,++n,t))&&(r=+r)>=r&&(yield r)}}function nL(t,e,n){if(t=Float64Array.from(eL(t,n)),r=t.length){if((e=+e)<=0||r<2)return KT(t);if(e>=1)return ZT(t);var r,i=(r-1)*e,o=Math.floor(i),s=ZT(QT(t,o).subarray(0,o+1)),a=KT(t.subarray(o+1));return s+(a-s)*(i-o)}}var rL=function(t,e){return nL(t,.5,e)};function iL(t,e){let n=0,r=0;if(void 0===e)for(let i of t)null!=i&&(i=+i)>=i&&(++n,r+=i);else{let i=-1;for(let o of t)null!=(o=e(o,++i,t))&&(o=+o)>=o&&(++n,r+=o)}if(n)return r/n}var oL=function(t,e,n){t=+t,e=+e,n=(i=arguments.length)<2?(e=t,t=0,1):i<3?1:+n;var r=-1,i=0|Math.max(0,Math.ceil((e-t)/n)),o=new Array(i);while(++r<i)o[r]=t+r*n;return o},sL=function(t){let e=t,n=t;function r(t,e,r,i){null==r&&(r=0),null==i&&(i=t.length);while(r<i){const o=r+i>>>1;n(t[o],e)<0?r=o+1:i=o}return r}function i(t,e,r,i){null==r&&(r=0),null==i&&(i=t.length);while(r<i){const o=r+i>>>1;n(t[o],e)>0?i=o:r=o+1}return r}function o(t,n,i,o){null==i&&(i=0),null==o&&(o=t.length);const s=r(t,n,i,o-1);return s>i&&e(t[s-1],n)>-e(t[s],n)?s-1:s}return 1===t.length&&(e=(e,n)=>t(e)-n,n=aL(t)),{left:r,center:o,right:i}};function aL(t){return(e,n)=>JT(t(e),n)}var uL=n("de28");function cL(t){return e=>{const n=t.length;let r=1,i=String(t[0](e));for(;r<n;++r)i+="|"+t[r](e);return i}}function lL(t){return t&&t.length?1===t.length?t[0]:cL(t):function(){return""}}function hL(t,e,n){return n||t+(e?"_"+e:"")}const fL=()=>{},dL={init:fL,add:fL,rem:fL,idx:0},pL={values:{init:t=>t.cell.store=!0,value:t=>t.cell.data.values(),idx:-1},count:{value:t=>t.cell.num},__count__:{value:t=>t.missing+t.valid},missing:{value:t=>t.missing},valid:{value:t=>t.valid},sum:{init:t=>t.sum=0,value:t=>t.sum,add:(t,e)=>t.sum+=+e,rem:(t,e)=>t.sum-=e},product:{init:t=>t.product=1,value:t=>t.valid?t.product:void 0,add:(t,e)=>t.product*=e,rem:(t,e)=>t.product/=e},mean:{init:t=>t.mean=0,value:t=>t.valid?t.mean:void 0,add:(t,e)=>(t.mean_d=e-t.mean,t.mean+=t.mean_d/t.valid),rem:(t,e)=>(t.mean_d=e-t.mean,t.mean-=t.valid?t.mean_d/t.valid:t.mean)},average:{value:t=>t.valid?t.mean:void 0,req:["mean"],idx:1},variance:{init:t=>t.dev=0,value:t=>t.valid>1?t.dev/(t.valid-1):void 0,add:(t,e)=>t.dev+=t.mean_d*(e-t.mean),rem:(t,e)=>t.dev-=t.mean_d*(e-t.mean),req:["mean"],idx:1},variancep:{value:t=>t.valid>1?t.dev/t.valid:void 0,req:["variance"],idx:2},stdev:{value:t=>t.valid>1?Math.sqrt(t.dev/(t.valid-1)):void 0,req:["variance"],idx:2},stdevp:{value:t=>t.valid>1?Math.sqrt(t.dev/t.valid):void 0,req:["variance"],idx:2},stderr:{value:t=>t.valid>1?Math.sqrt(t.dev/(t.valid*(t.valid-1))):void 0,req:["variance"],idx:2},distinct:{value:t=>t.cell.data.distinct(t.get),req:["values"],idx:3},ci0:{value:t=>t.cell.data.ci0(t.get),req:["values"],idx:3},ci1:{value:t=>t.cell.data.ci1(t.get),req:["values"],idx:3},median:{value:t=>t.cell.data.q2(t.get),req:["values"],idx:3},q1:{value:t=>t.cell.data.q1(t.get),req:["values"],idx:3},q3:{value:t=>t.cell.data.q3(t.get),req:["values"],idx:3},min:{init:t=>t.min=void 0,value:t=>t.min=Number.isNaN(t.min)?t.cell.data.min(t.get):t.min,add:(t,e)=>{(e<t.min||void 0===t.min)&&(t.min=e)},rem:(t,e)=>{e<=t.min&&(t.min=NaN)},req:["values"],idx:4},max:{init:t=>t.max=void 0,value:t=>t.max=Number.isNaN(t.max)?t.cell.data.max(t.get):t.max,add:(t,e)=>{(e>t.max||void 0===t.max)&&(t.max=e)},rem:(t,e)=>{e>=t.max&&(t.max=NaN)},req:["values"],idx:4},argmin:{init:t=>t.argmin=void 0,value:t=>t.argmin||t.cell.data.argmin(t.get),add:(t,e,n)=>{e<t.min&&(t.argmin=n)},rem:(t,e)=>{e<=t.min&&(t.argmin=void 0)},req:["min","values"],idx:3},argmax:{init:t=>t.argmax=void 0,value:t=>t.argmax||t.cell.data.argmax(t.get),add:(t,e,n)=>{e>t.max&&(t.argmax=n)},rem:(t,e)=>{e>=t.max&&(t.argmax=void 0)},req:["max","values"],idx:3}},gL=Object.keys(pL);function mL(t,e){return n=>MP({name:t,out:n||t},dL,e)}function yL(t,e){return pL[t](e)}function vL(t,e){return t.idx-e.idx}function bL(t){const e={};t.forEach(t=>e[t.name]=t);const n=t=>{t.req&&t.req.forEach(t=>{e[t]||n(e[t]=pL[t]())})};return t.forEach(n),Object.values(e).sort(vL)}function _L(){this.valid=0,this.missing=0,this._ops.forEach(t=>t.init(this))}function wL(t,e){null!=t&&""!==t?t===t&&(++this.valid,this._ops.forEach(n=>n.add(this,t,e))):++this.missing}function xL(t,e){null!=t&&""!==t?t===t&&(--this.valid,this._ops.forEach(n=>n.rem(this,t,e))):--this.missing}function SL(t){return this._out.forEach(e=>t[e.out]=e.value(this)),t}function EL(t,e){const n=e||hP,r=bL(t),i=t.slice().sort(vL);function o(t){this._ops=r,this._out=i,this.cell=t,this.init()}return o.prototype.init=_L,o.prototype.add=wL,o.prototype.rem=xL,o.prototype.set=SL,o.prototype.get=n,o.fields=t.map(t=>t.out),o}function AL(t){this._key=t?lP(t):Fk,this.reset()}gL.forEach(t=>{pL[t]=mL(t,pL[t])});const ML=AL.prototype;function CL(t){JO.call(this,null,t),this._adds=[],this._mods=[],this._alen=0,this._mlen=0,this._drop=!0,this._cross=!1,this._dims=[],this._dnames=[],this._measures=[],this._countOnly=!1,this._counts=null,this._prev=null,this._inputs=null,this._outputs=null}ML.reset=function(){this._add=[],this._rem=[],this._ext=null,this._get=null,this._q=null},ML.add=function(t){this._add.push(t)},ML.rem=function(t){this._rem.push(t)},ML.values=function(){if(this._get=null,0===this._rem.length)return this._add;const t=this._add,e=this._rem,n=this._key,r=t.length,i=e.length,o=Array(r-i),s={};let a,u,c;for(a=0;a<i;++a)s[n(e[a])]=1;for(a=0,u=0;a<r;++a)s[n(c=t[a])]?s[n(c)]=0:o[u++]=c;return this._rem=[],this._add=o},ML.distinct=function(t){const e=this.values(),n={};let r,i=e.length,o=0;while(--i>=0)r=t(e[i])+"",PP(n,r)||(n[r]=1,++o);return o},ML.extent=function(t){if(this._get!==t||!this._ext){const e=this.values(),n=kP(e,t);this._ext=[e[n[0]],e[n[1]]],this._get=t}return this._ext},ML.argmin=function(t){return this.extent(t)[0]||{}},ML.argmax=function(t){return this.extent(t)[1]||{}},ML.min=function(t){const e=this.extent(t)[0];return null!=e?t(e):void 0},ML.max=function(t){const e=this.extent(t)[1];return null!=e?t(e):void 0},ML.quartile=function(t){return this._get===t&&this._q||(this._q=KP(this.values(),t),this._get=t),this._q},ML.q1=function(t){return this.quartile(t)[0]},ML.q2=function(t){return this.quartile(t)[1]},ML.q3=function(t){return this.quartile(t)[2]},ML.ci=function(t){return this._get===t&&this._ci||(this._ci=nT(this.values(),1e3,.05,t),this._get=t),this._ci},ML.ci0=function(t){return this.ci(t)[0]},ML.ci1=function(t){return this.ci(t)[1]},CL.Definition={type:"Aggregate",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:gL},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"drop",type:"boolean",default:!0},{name:"cross",type:"boolean",default:!1},{name:"key",type:"field"}]},IP(CL,JO,{transform(t,e){const n=this,r=e.fork(e.NO_SOURCE|e.NO_FIELDS),i=t.modified();return n.stamp=r.stamp,n.value&&(i||e.modified(n._inputs,!0))?(n._prev=n.value,n.value=i?n.init(t):{},e.visit(e.SOURCE,t=>n.add(t))):(n.value=n.value||n.init(t),e.visit(e.REM,t=>n.rem(t)),e.visit(e.ADD,t=>n.add(t))),r.modifies(n._outputs),n._drop=!1!==t.drop,t.cross&&n._dims.length>1&&(n._drop=!1,n.cross()),e.clean()&&n._drop&&r.clean(!0).runAfter(()=>this.clean()),n.changes(r)},cross(){const t=this,e=t.value,n=t._dnames,r=n.map(()=>({})),i=n.length;function o(t){let e,o,s,a;for(e in t)for(s=t[e].tuple,o=0;o<i;++o)r[o][a=s[n[o]]]=a}function s(o,a,u){const c=n[u],l=r[u++];for(const n in l){const r=o?o+"|"+n:n;a[c]=l[n],u<i?s(r,a,u):e[r]||t.cell(r,a)}}o(t._prev),o(e),s("",{},0)},init(t){const e=this._inputs=[],n=this._outputs=[],r={};function i(t){const n=yP(iP(t)),i=n.length;let o,s=0;for(;s<i;++s)r[o=n[s]]||(r[o]=1,e.push(o))}this._dims=yP(t.groupby),this._dnames=this._dims.map(t=>{const e=rP(t);return i(t),n.push(e),e}),this.cellkey=t.key?t.key:lL(this._dims),this._countOnly=!0,this._counts=[],this._measures=[];const o=t.fields||[null],s=t.ops||["count"],a=t.as||[],u=o.length,c={};let l,h,f,d,p,g;for(u!==s.length&&uP("Unmatched number of fields and aggregate ops."),g=0;g<u;++g)l=o[g],h=s[g],null==l&&"count"!==h&&uP("Null aggregate field specified."),d=rP(l),p=hL(h,d,a[g]),n.push(p),"count"!==h?(f=c[d],f||(i(l),f=c[d]=[],f.field=l,this._measures.push(f)),"count"!==h&&(this._countOnly=!1),f.push(yL(h,p))):this._counts.push(p);return this._measures=this._measures.map(t=>EL(t,t.field)),{}},cellkey:lL(),cell(t,e){let n=this.value[t];return n?0===n.num&&this._drop&&n.stamp<this.stamp?(n.stamp=this.stamp,this._adds[this._alen++]=n):n.stamp<this.stamp&&(n.stamp=this.stamp,this._mods[this._mlen++]=n):(n=this.value[t]=this.newcell(t,e),this._adds[this._alen++]=n),n},newcell(t,e){const n={key:t,num:0,agg:null,tuple:this.newtuple(e,this._prev&&this._prev[t]),stamp:this.stamp,store:!1};if(!this._countOnly){const t=this._measures,e=t.length;n.agg=Array(e);for(let r=0;r<e;++r)n.agg[r]=new t[r](n)}return n.store&&(n.data=new AL),n},newtuple(t,e){const n=this._dnames,r=this._dims,i=r.length,o={};for(let s=0;s<i;++s)o[n[s]]=r[s](t);return e?$k(e.tuple,o):jk(o)},clean(){const t=this.value;for(const e in t)0===t[e].num&&delete t[e]},add(t){const e=this.cellkey(t),n=this.cell(e,t);if(n.num+=1,this._countOnly)return;n.store&&n.data.add(t);const r=n.agg;for(let i=0,o=r.length;i<o;++i)r[i].add(r[i].get(t),t)},rem(t){const e=this.cellkey(t),n=this.cell(e,t);if(n.num-=1,this._countOnly)return;n.store&&n.data.rem(t);const r=n.agg;for(let i=0,o=r.length;i<o;++i)r[i].rem(r[i].get(t),t)},celltuple(t){const e=t.tuple,n=this._counts;t.store&&t.data.values();for(let r=0,i=n.length;r<i;++r)e[n[r]]=t.num;if(!this._countOnly){const n=t.agg;for(let t=0,r=n.length;t<r;++t)n[t].set(e)}return e},changes(t){const e=this._adds,n=this._mods,r=this._prev,i=this._drop,o=t.add,s=t.rem,a=t.mod;let u,c,l,h;if(r)for(c in r)u=r[c],i&&!u.num||s.push(u.tuple);for(l=0,h=this._alen;l<h;++l)o.push(this.celltuple(e[l])),e[l]=null;for(l=0,h=this._mlen;l<h;++l)u=n[l],(0===u.num&&i?s:a).push(this.celltuple(u)),n[l]=null;return this._alen=this._mlen=0,this._prev=null,t}});const kL=1e-14;function OL(t){JO.call(this,null,t)}function PL(t,e,n){const r=t;let i=e||[],o=n||[],s={},a=0;return{add:t=>o.push(t),remove:t=>s[r(t)]=++a,size:()=>i.length,data:(t,e)=>{return a&&(i=i.filter(t=>!s[r(t)]),s={},a=0),e&&t&&i.sort(t),o.length&&(i=t?DP(t,i,o.sort(t)):i.concat(o),o=[]),i}}}function TL(t){JO.call(this,[],t)}function LL(t){Qk.call(this,null,IL,t)}function IL(t){return this.value&&!t.modified()?this.value:_P(t.fields,t.orders)}function NL(t){JO.call(this,null,t)}function DL(t,e,n){switch(e){case"upper":t=t.toUpperCase();break;case"lower":t=t.toLowerCase();break}return t.match(n)}function RL(t){JO.call(this,null,t)}function FL(t,e,n,r){for(var i,o,s=[],a={},u=t.length,c=0;c<u;++c)for(a[e]=o=t[c],i=0;i<u;++i)a[n]=t[i],r(a)&&(s.push(jk(a)),a={},a[e]=o);return s}OL.Definition={type:"Bin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"interval",type:"boolean",default:!0},{name:"anchor",type:"number"},{name:"maxbins",type:"number",default:20},{name:"base",type:"number",default:10},{name:"divide",type:"number",array:!0,default:[5,2]},{name:"extent",type:"number",array:!0,length:2,required:!0},{name:"span",type:"number"},{name:"step",type:"number"},{name:"steps",type:"number",array:!0},{name:"minstep",type:"number",default:0},{name:"nice",type:"boolean",default:!0},{name:"name",type:"string"},{name:"as",type:"string",array:!0,length:2,default:["bin0","bin1"]}]},IP(OL,JO,{transform(t,e){const n=!1!==t.interval,r=this._bins(t),i=r.start,o=r.step,s=t.as||["bin0","bin1"],a=s[0],u=s[1];let c;return t.modified()?(e=e.reflow(!0),c=e.SOURCE):c=e.modified(iP(t.field))?e.ADD_MOD:e.ADD,e.visit(c,n?t=>{const e=r(t);t[a]=e,t[u]=null==e?null:i+o*(1+(e-i)/o)}:t=>t[a]=r(t)),e.modifies(n?s:a)},_bins(t){if(this.value&&!t.modified())return this.value;const e=t.field,n=QP(t),r=n.step;let i,o,s=n.start,a=s+Math.ceil((n.stop-s)/r)*r;null!=(i=t.anchor)&&(o=i-(s+r*Math.floor((i-s)/r)),s+=o,a+=o);const u=function(t){let n=mP(e(t));return null==n?null:n<s?-1/0:n>a?1/0:(n=Math.max(s,Math.min(n,a-r)),s+r*Math.floor(kL+(n-s)/r))};return u.start=s,u.stop=n.stop,u.step=r,this.value=nP(u,iP(e),t.name||"bin_"+rP(e))}}),TL.Definition={type:"Collect",metadata:{source:!0},params:[{name:"sort",type:"compare"}]},IP(TL,JO,{transform(t,e){const n=e.fork(e.ALL),r=PL(Fk,this.value,n.materialize(n.ADD).add),i=t.sort,o=e.changed()||i&&(t.modified("sort")||e.modified(i.fields));return n.visit(n.REM,r.remove),this.modified(o),this.value=n.source=r.data(Vk(i),o),e.source&&e.source.root&&(this.value.root=e.source.root),n}}),IP(LL,Qk),NL.Definition={type:"CountPattern",metadata:{generates:!0,changes:!0},params:[{name:"field",type:"field",required:!0},{name:"case",type:"enum",values:["upper","lower","mixed"],default:"mixed"},{name:"pattern",type:"string",default:'[\\w"]+'},{name:"stopwords",type:"string",default:""},{name:"as",type:"string",array:!0,length:2,default:["text","count"]}]},IP(NL,JO,{transform(t,e){const n=e=>n=>{for(var r,i=DL(a(n),t.case,o)||[],u=0,c=i.length;u<c;++u)s.test(r=i[u])||e(r)},r=this._parameterCheck(t,e),i=this._counts,o=this._match,s=this._stop,a=t.field,u=t.as||["text","count"],c=n(t=>i[t]=1+(i[t]||0)),l=n(t=>i[t]-=1);return r?e.visit(e.SOURCE,c):(e.visit(e.ADD,c),e.visit(e.REM,l)),this._finish(e,u)},_parameterCheck(t,e){let n=!1;return!t.modified("stopwords")&&this._stop||(this._stop=new RegExp("^"+(t.stopwords||"")+"$","i"),n=!0),!t.modified("pattern")&&this._match||(this._match=new RegExp(t.pattern||"[\\w']+","g"),n=!0),(t.modified("field")||e.modified(t.field.fields))&&(n=!0),n&&(this._counts={}),n},_finish(t,e){const n=this._counts,r=this._tuples||(this._tuples={}),i=e[0],o=e[1],s=t.fork(t.NO_SOURCE|t.NO_FIELDS);let a,u,c;for(a in n)u=r[a],c=n[a]||0,!u&&c?(r[a]=u=jk({}),u[i]=a,u[o]=c,s.add.push(u)):0===c?(u&&s.rem.push(u),n[a]=null,r[a]=null):u[o]!==c&&(u[o]=c,s.mod.push(u));return s.modifies(e)}}),RL.Definition={type:"Cross",metadata:{generates:!0},params:[{name:"filter",type:"expr"},{name:"as",type:"string",array:!0,length:2,default:["a","b"]}]},IP(RL,JO,{transform(t,e){const n=e.fork(e.NO_SOURCE),r=t.as||["a","b"],i=r[0],o=r[1],s=!this.value||e.changed(e.ADD_REM)||t.modified("as")||t.modified("filter");let a=this.value;return s?(a&&(n.rem=a),a=e.materialize(e.SOURCE).source,n.add=this.value=FL(a,i,o,t.filter||dP)):n.mod=a,n.source=this.value,n.modifies(r)}});const BL={kde:mT,mixture:xT,normal:gT,lognormal:wT,uniform:CT},jL="distributions",zL="function",UL="field";function $L(t,e){const n=t[zL];PP(BL,n)||uP("Unknown distribution function: "+n);const r=BL[n]();for(const i in t)i===UL?r.data((t.from||e()).map(t[i])):i===jL?r[i](t[i].map(t=>$L(t,e))):typeof r[i]===zL&&r[i](t[i]);return r}function VL(t){JO.call(this,null,t)}const qL=[{key:{function:"normal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"lognormal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"uniform"},params:[{name:"min",type:"number",default:0},{name:"max",type:"number",default:1}]},{key:{function:"kde"},params:[{name:"field",type:"field",required:!0},{name:"from",type:"data"},{name:"bandwidth",type:"number",default:0}]}],WL={key:{function:"mixture"},params:[{name:"distributions",type:"param",array:!0,params:qL},{name:"weights",type:"number",array:!0}]};function GL(t){return()=>t.materialize(t.SOURCE).source}function HL(t,e){return t?t.map((t,n)=>e[n]||rP(t)):null}function XL(t,e,n){const r=[],i=t=>t(u);let o,s,a,u,c,l;if(null==e)r.push(t.map(n));else for(o={},s=0,a=t.length;s<a;++s)u=t[s],c=e.map(i),l=o[c],l||(o[c]=l=[],l.dims=c,r.push(l)),l.push(n(u));return r}VL.Definition={type:"Density",metadata:{generates:!0},params:[{name:"extent",type:"number",array:!0,length:2},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"method",type:"string",default:"pdf",values:["pdf","cdf"]},{name:"distribution",type:"param",params:qL.concat(WL)},{name:"as",type:"string",array:!0,default:["value","density"]}]},IP(VL,JO,{transform(t,e){const n=e.fork(e.NO_SOURCE|e.NO_FIELDS);if(!this.value||e.changed()||t.modified()){const r=$L(t.distribution,GL(e)),i=t.steps||t.minsteps||25,o=t.steps||t.maxsteps||200;let s=t.method||"pdf";"pdf"!==s&&"cdf"!==s&&uP("Invalid density method: "+s),t.extent||r.data||uP("Missing density extent parameter."),s=r[s];const a=t.as||["value","density"],u=t.extent||CP(r.data()),c=HT(s,u,i,o).map(t=>{const e={};return e[a[0]]=t[0],e[a[1]]=t[1],jk(e)});this.value&&(n.rem=this.value),this.value=n.add=n.source=c}return n}});const YL="bin";function ZL(t){JO.call(this,null,t)}ZL.Definition={type:"DotBin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"step",type:"number"},{name:"smooth",type:"boolean",default:!1},{name:"as",type:"string",default:YL}]};const KL=(t,e)=>RP(CP(t,e))/30;function JL(t){Qk.call(this,null,QL,t),this.modified(!0)}function QL(t){const e=t.expr;return this.value&&!t.modified("expr")?this.value:nP(n=>e(n,t),iP(e),rP(e))}function tI(t){JO.call(this,[void 0,void 0],t)}function eI(t,e){Qk.call(this,t),this.parent=e,this.count=0}function nI(t){JO.call(this,{},t),this._keys=LP();const e=this._targets=[];e.active=0,e.forEach=t=>{for(let n=0,r=e.active;n<r;++n)t(e[n],n,e)}}function rI(t){Qk.call(this,null,iI,t)}function iI(t){return this.value&&!t.modified()?this.value:pP(t.name)?yP(t.name).map(t=>lP(t)):lP(t.name,t.as)}function oI(t){JO.call(this,LP(),t)}function sI(t){JO.call(this,[],t)}function aI(t){JO.call(this,[],t)}function uI(t){JO.call(this,null,t)}function cI(t){JO.call(this,[],t)}IP(ZL,JO,{transform(t,e){if(this.value&&!t.modified()&&!e.changed())return e;const n=e.materialize(e.SOURCE).source,r=XL(e.source,t.groupby,hP),i=t.smooth||!1,o=t.field,s=t.step||KL(n,o),a=Vk((t,e)=>o(t)-o(e)),u=t.as||YL,c=r.length;let l,h=1/0,f=-1/0,d=0;for(;d<c;++d){const t=r[d].sort(a);l=-1;for(const e of rT(t,s,i,o))e<h&&(h=e),e>f&&(f=e),t[++l][u]=e}return this.value={start:h,stop:f,step:s},e.reflow(!0).modifies(u)}}),IP(JL,Qk),tI.Definition={type:"Extent",metadata:{},params:[{name:"field",type:"field",required:!0}]},IP(tI,JO,{transform(t,e){const n=this.value,r=t.field,i=e.changed()||e.modified(r.fields)||t.modified("field");let o=n[0],s=n[1];if((i||null==o)&&(o=1/0,s=-1/0),e.visit(i?e.SOURCE:e.ADD,t=>{const e=mP(r(t));null!=e&&(e<o&&(o=e),e>s&&(s=e))}),!Number.isFinite(o)||!Number.isFinite(s)){let t=rP(r);t&&(t=` for field "${t}"`),e.dataflow.warn(`Infinite extent${t}: [${o}, ${s}]`),o=s=void 0}this.value=[o,s]}}),IP(eI,Qk,{connect(t){return this.detachSubflow=t.detachSubflow,this.targets().add(t),t.source=this},add(t){this.count+=1,this.value.add.push(t)},rem(t){this.count-=1,this.value.rem.push(t)},mod(t){this.value.mod.push(t)},init(t){this.value.init(t,t.NO_SOURCE)},evaluate(){return this.value}}),IP(nI,JO,{activate(t){this._targets[this._targets.active++]=t},subflow(t,e,n,r){const i=this.value;let o,s,a=PP(i,t)&&i[t];return a?a.value.stamp<n.stamp&&(a.init(n),this.activate(a)):(s=r||(s=this._group[t])&&s.tuple,o=n.dataflow,a=new eI(n.fork(n.NO_SOURCE),this),o.add(a).connect(e(o,t,s)),i[t]=a,this.activate(a)),a},clean(){const t=this.value;let e=0;for(const n in t)if(0===t[n].count){const r=t[n].detachSubflow;r&&r(),delete t[n],++e}if(e){const t=this._targets.filter(t=>t&&t.count>0);this.initTargets(t)}},initTargets(t){const e=this._targets,n=e.length,r=t?t.length:0;let i=0;for(;i<r;++i)e[i]=t[i];for(;i<n&&null!=e[i];++i)e[i]=null;e.active=r},transform(t,e){const n=e.dataflow,r=t.key,i=t.subflow,o=this._keys,s=t.modified("key"),a=t=>this.subflow(t,i,e);return this._group=t.group||{},this.initTargets(),e.visit(e.REM,t=>{const e=Fk(t),n=o.get(e);void 0!==n&&(o.delete(e),a(n).rem(t))}),e.visit(e.ADD,t=>{const e=r(t);o.set(Fk(t),e),a(e).add(t)}),s||e.modified(r.fields)?e.visit(e.MOD,t=>{const e=Fk(t),n=o.get(e),i=r(t);n===i?a(i).mod(t):(o.set(e,i),a(n).rem(t),a(i).add(t))}):e.changed(e.MOD)&&e.visit(e.MOD,t=>{a(o.get(Fk(t))).mod(t)}),s&&e.visit(e.REFLOW,t=>{const e=Fk(t),n=o.get(e),i=r(t);n!==i&&(o.set(e,i),a(n).rem(t),a(i).add(t))}),e.clean()?n.runAfter(()=>{this.clean(),o.clean()}):o.empty>n.cleanThreshold&&n.runAfter(o.clean),e}}),IP(rI,Qk),oI.Definition={type:"Filter",metadata:{changes:!0},params:[{name:"expr",type:"expr",required:!0}]},IP(oI,JO,{transform(t,e){const n=e.dataflow,r=this.value,i=e.fork(),o=i.add,s=i.rem,a=i.mod,u=t.expr;let c=!0;function l(e){const n=Fk(e),i=u(e,t),l=r.get(n);i&&l?(r.delete(n),o.push(e)):i||l?c&&i&&!l&&a.push(e):(r.set(n,1),s.push(e))}return e.visit(e.REM,t=>{const e=Fk(t);r.has(e)?r.delete(e):s.push(t)}),e.visit(e.ADD,e=>{u(e,t)?o.push(e):r.set(Fk(e),1)}),e.visit(e.MOD,l),t.modified()&&(c=!1,e.visit(e.REFLOW,l)),r.empty>n.cleanThreshold&&n.runAfter(r.clean),i}}),sI.Definition={type:"Flatten",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"index",type:"string"},{name:"as",type:"string",array:!0}]},IP(sI,JO,{transform(t,e){const n=e.fork(e.NO_SOURCE),r=t.fields,i=HL(r,t.as||[]),o=t.index||null,s=i.length;return n.rem=this.value,e.visit(e.SOURCE,t=>{const e=r.map(e=>e(t)),a=e.reduce((t,e)=>Math.max(t,e.length),0);let u,c,l,h=0;for(;h<a;++h){for(c=zk(t),u=0;u<s;++u)c[i[u]]=null==(l=e[u][h])?null:l;o&&(c[o]=h),n.add.push(c)}}),this.value=n.source=n.add,o&&n.modifies(o),n.modifies(i)}}),aI.Definition={type:"Fold",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0,length:2,default:["key","value"]}]},IP(aI,JO,{transform(t,e){const n=e.fork(e.NO_SOURCE),r=t.fields,i=r.map(rP),o=t.as||["key","value"],s=o[0],a=o[1],u=r.length;return n.rem=this.value,e.visit(e.SOURCE,t=>{for(let e,o=0;o<u;++o)e=zk(t),e[s]=i[o],e[a]=r[o](t),n.add.push(e)}),this.value=n.source=n.add,n.modifies(o)}}),uI.Definition={type:"Formula",metadata:{modifies:!0},params:[{name:"expr",type:"expr",required:!0},{name:"as",type:"string",required:!0},{name:"initonly",type:"boolean"}]},IP(uI,JO,{transform(t,e){const n=t.expr,r=t.as,i=t.modified(),o=t.initonly?e.ADD:i?e.SOURCE:e.modified(n.fields)||e.modified(r)?e.ADD_MOD:e.ADD;return i&&(e=e.materialize().reflow(!0)),t.initonly||e.modifies(r),e.visit(o,e=>e[r]=n(e,t))}}),IP(cI,JO,{transform(t,e){const n=e.fork(e.ALL),r=t.generator;let i,o,s,a=this.value,u=t.size-a.length;if(u>0){for(i=[];--u>=0;)i.push(s=jk(r(t))),a.push(s);n.add=n.add.length?n.materialize(n.ADD).add.concat(i):i}else o=a.slice(0,-u),n.rem=n.rem.length?n.materialize(n.REM).rem.concat(o):o,a=a.slice(-u);return n.source=this.value=a,n}});const lI={value:"value",median:rL,mean:iL,min:KT,max:ZT},hI=[];function fI(t){JO.call(this,[],t)}function dI(t){var e,n=t.method||lI.value;if(null!=lI[n])return n===lI.value?(e=void 0!==t.value?t.value:0,()=>e):lI[n];uP("Unrecognized imputation method: "+n)}function pI(t){const e=t.field;return t=>t?e(t):NaN}function gI(t,e,n,r){var i,o,s,a,u,c,l,h,f=t=>t(h),d=[],p=r?r.slice():[],g={},m={};for(p.forEach((t,e)=>g[t]=e+1),a=0,l=t.length;a<l;++a)h=t[a],c=n(h),u=g[c]||(g[c]=p.push(c)),o=(i=e?e.map(f):hI)+"",(s=m[o])||(s=m[o]=[],d.push(s),s.values=i),s[u-1]=h;return d.domain=p,d}function mI(t){CL.call(this,t)}function yI(t){JO.call(this,null,t)}function vI(t){Qk.call(this,null,bI,t)}function bI(t){return this.value&&!t.modified()?this.value:NP(t.fields,t.flat)}function _I(t){JO.call(this,[],t),this._pending=null}function wI(t){return t.modified("async")&&!(t.modified("values")||t.modified("url")||t.modified("format"))}function xI(t,e,n){n.forEach(jk);const r=e.fork(e.NO_FIELDS&e.NO_SOURCE);return r.rem=t.value,t.value=r.source=r.add=n,t._pending=null,r.rem.length&&r.clean(!0),r}function SI(t){JO.call(this,{},t)}function EI(t){Qk.call(this,null,AI,t)}function AI(t){if(this.value&&!t.modified())return this.value;const e=t.extents,n=e.length;let r,i,o=1/0,s=-1/0;for(r=0;r<n;++r)i=e[r],i[0]<o&&(o=i[0]),i[1]>s&&(s=i[1]);return[o,s]}function MI(t){Qk.call(this,null,CI,t)}function CI(t){return this.value&&!t.modified()?this.value:t.values.reduce((t,e)=>t.concat(e),[])}function kI(t){JO.call(this,null,t)}function OI(t){CL.call(this,t)}function PI(t,e){const n=t.field,r=t.value,i=("count"===t.op?"__count__":t.op)||"sum",o=iP(n).concat(iP(r)),s=LI(n,t.limit||0,e);return e.changed()&&t.set("__pivot__",null,null,!0),{key:t.key,groupby:t.groupby,ops:s.map(()=>i),fields:s.map(t=>TI(t,n,r,o)),as:s.map(t=>t+""),modified:t.modified.bind(t)}}function TI(t,e,n,r){return nP(r=>e(r)===t?n(r):NaN,r,t+"")}function LI(t,e,n){const r={},i=[];return n.visit(n.SOURCE,e=>{const n=t(e);r[n]||(r[n]=1,i.push(n))}),i.sort(wP),e?i.slice(0,e):i}function II(t){nI.call(this,t)}function NI(t){JO.call(this,null,t)}function DI(t,e,n,r){for(let i=0,o=n.length;i<o;++i)e[r[i]]=n[i](t);return e}function RI(t){JO.call(this,null,t)}function FI(t){JO.call(this,null,t)}fI.Definition={type:"Impute",metadata:{changes:!0},params:[{name:"field",type:"field",required:!0},{name:"key",type:"field",required:!0},{name:"keyvals",array:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"enum",default:"value",values:["value","mean","median","max","min"]},{name:"value",default:0}]},IP(fI,JO,{transform(t,e){var n,r,i,o,s,a,u,c,l,h,f=e.fork(e.ALL),d=dI(t),p=pI(t),g=rP(t.field),m=rP(t.key),y=(t.groupby||[]).map(rP),v=gI(e.source,t.groupby,t.key,t.keyvals),b=[],_=this.value,w=v.domain.length;for(s=0,c=v.length;s<c;++s)for(n=v[s],i=n.values,r=NaN,u=0;u<w;++u)if(null==n[u]){for(o=v.domain[u],h={_impute:!0},a=0,l=i.length;a<l;++a)h[y[a]]=i[a];h[m]=o,h[g]=Number.isNaN(r)?r=d(n,p):r,b.push(jk(h))}return b.length&&(f.add=f.materialize(f.ADD).add.concat(b)),_.length&&(f.rem=f.materialize(f.REM).rem.concat(_)),this.value=b,f}}),mI.Definition={type:"JoinAggregate",metadata:{modifies:!0},params:[{name:"groupby",type:"field",array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"ops",type:"enum",array:!0,values:gL},{name:"as",type:"string",null:!0,array:!0},{name:"key",type:"field"}]},IP(mI,CL,{transform(t,e){const n=this,r=t.modified();let i;return n.value&&(r||e.modified(n._inputs,!0))?(i=n.value=r?n.init(t):{},e.visit(e.SOURCE,t=>n.add(t))):(i=n.value=n.value||this.init(t),e.visit(e.REM,t=>n.rem(t)),e.visit(e.ADD,t=>n.add(t))),n.changes(),e.visit(e.SOURCE,t=>{MP(t,i[n.cellkey(t)].tuple)}),e.reflow(r).modifies(this._outputs)},changes(){const t=this._adds,e=this._mods;let n,r;for(n=0,r=this._alen;n<r;++n)this.celltuple(t[n]),t[n]=null;for(n=0,r=this._mlen;n<r;++n)this.celltuple(e[n]),e[n]=null;this._alen=this._mlen=0}}),yI.Definition={type:"KDE",metadata:{generates:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"cumulative",type:"boolean",default:!1},{name:"counts",type:"boolean",default:!1},{name:"bandwidth",type:"number",default:0},{name:"extent",type:"number",array:!0,length:2},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"as",type:"string",array:!0,default:["value","density"]}]},IP(yI,JO,{transform(t,e){const n=e.fork(e.NO_SOURCE|e.NO_FIELDS);if(!this.value||e.changed()||t.modified()){const r=e.materialize(e.SOURCE).source,i=XL(r,t.groupby,t.field),o=(t.groupby||[]).map(rP),s=t.bandwidth,a=t.cumulative?"cdf":"pdf",u=t.as||["value","density"],c=[];let l=t.extent,h=t.steps||t.minsteps||25,f=t.steps||t.maxsteps||200;"pdf"!==a&&"cdf"!==a&&uP("Invalid density method: "+a),"shared"===t.resolve&&(l||(l=CP(r,t.field)),h=f=t.steps||f),i.forEach(e=>{const n=mT(e,s)[a],r=t.counts?e.length:1,i=l||CP(e);HT(n,i,h,f).forEach(t=>{const n={};for(let r=0;r<o.length;++r)n[o[r]]=e.dims[r];n[u[0]]=t[0],n[u[1]]=t[1]*r,c.push(jk(n))})}),this.value&&(n.rem=this.value),this.value=n.add=n.source=c}return n}}),IP(vI,Qk),IP(_I,JO,{transform(t,e){const n=e.dataflow;if(this._pending)return xI(this,e,this._pending);if(wI(t))return e.StopPropagation;if(t.values)return xI(this,e,n.parse(t.values,t.format));if(t.async){const e=n.request(t.url,t.format).then(t=>{return this._pending=yP(t.data),t=>t.touch(this)});return{async:e}}return n.request(t.url,t.format).then(t=>xI(this,e,yP(t.data)))}}),SI.Definition={type:"Lookup",metadata:{modifies:!0},params:[{name:"index",type:"index",params:[{name:"from",type:"data",required:!0},{name:"key",type:"field",required:!0}]},{name:"values",type:"field",array:!0},{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0},{name:"default",default:null}]},IP(SI,JO,{transform(t,e){const n=t.fields,r=t.index,i=t.values,o=null==t.default?null:t.default,s=t.modified(),a=n.length;let u,c,l,h=s?e.SOURCE:e.ADD,f=e,d=t.as;return i?(c=i.length,a>1&&!d&&uP('Multi-field lookup requires explicit "as" parameter.'),d&&d.length!==a*c&&uP('The "as" parameter has too few output field names.'),d=d||i.map(rP),u=function(t){for(var e,s,u=0,l=0;u<a;++u)if(s=r.get(n[u](t)),null==s)for(e=0;e<c;++e,++l)t[d[l]]=o;else for(e=0;e<c;++e,++l)t[d[l]]=i[e](s)}):(d||uP("Missing output field names."),u=function(t){for(var e,i=0;i<a;++i)e=r.get(n[i](t)),t[d[i]]=null==e?o:e}),s?f=e.reflow(!0):(l=n.some(t=>e.modified(t.fields)),h|=l?e.MOD:0),e.visit(h,u),f.modifies(d)}}),IP(EI,Qk),IP(MI,Qk),IP(kI,JO,{transform(t,e){return this.modified(t.modified()),this.value=t,e.fork(e.NO_SOURCE|e.NO_FIELDS)}}),OI.Definition={type:"Pivot",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"value",type:"field",required:!0},{name:"op",type:"enum",values:gL,default:"sum"},{name:"limit",type:"number",default:0},{name:"key",type:"field"}]},IP(OI,CL,{_transform:CL.prototype.transform,transform(t,e){return this._transform(PI(t,e),e)}}),IP(II,nI,{transform(t,e){const n=t.subflow,r=t.field,i=t=>this.subflow(Fk(t),n,e,t);return(t.modified("field")||r&&e.modified(iP(r)))&&uP("PreFacet does not support field modification."),this.initTargets(),r?(e.visit(e.MOD,t=>{const e=i(t);r(t).forEach(t=>e.mod(t))}),e.visit(e.ADD,t=>{const e=i(t);r(t).forEach(t=>e.add(jk(t)))}),e.visit(e.REM,t=>{const e=i(t);r(t).forEach(t=>e.rem(t))})):(e.visit(e.MOD,t=>i(t).mod(t)),e.visit(e.ADD,t=>i(t).add(t)),e.visit(e.REM,t=>i(t).rem(t))),e.clean()&&e.runAfter(()=>this.clean()),e}}),NI.Definition={type:"Project",metadata:{generates:!0,changes:!0},params:[{name:"fields",type:"field",array:!0},{name:"as",type:"string",null:!0,array:!0}]},IP(NI,JO,{transform(t,e){const n=e.fork(e.NO_SOURCE),r=t.fields,i=HL(t.fields,t.as||[]),o=r?(t,e)=>DI(t,e,r,i):Uk;let s;return this.value?s=this.value:(e=e.addAll(),s=this.value={}),e.visit(e.REM,t=>{const e=Fk(t);n.rem.push(s[e]),s[e]=null}),e.visit(e.ADD,t=>{const e=o(t,jk({}));s[Fk(t)]=e,n.add.push(e)}),e.visit(e.MOD,t=>{n.mod.push(o(t,s[Fk(t)]))}),n}}),IP(RI,JO,{transform(t,e){return this.value=t.value,t.modified("value")?e.fork(e.NO_SOURCE|e.NO_FIELDS):e.StopPropagation}}),FI.Definition={type:"Quantile",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"probs",type:"number",array:!0},{name:"step",type:"number",default:.01},{name:"as",type:"string",array:!0,default:["prob","value"]}]};const BI=1e-14;function jI(t){JO.call(this,null,t)}function zI(t){JO.call(this,[],t),this.count=0}function UI(t){JO.call(this,null,t)}function $I(t){JO.call(this,null,t),this.modified(!0)}function VI(t){JO.call(this,null,t)}IP(FI,JO,{transform(t,e){const n=e.fork(e.NO_SOURCE|e.NO_FIELDS),r=t.as||["prob","value"];if(this.value&&!t.modified()&&!e.changed())return n.source=this.value,n;const i=e.materialize(e.SOURCE).source,o=XL(i,t.groupby,t.field),s=(t.groupby||[]).map(rP),a=[],u=t.step||.01,c=t.probs||oL(u/2,1-BI,u),l=c.length;return o.forEach(t=>{const e=ZP(t,c);for(let n=0;n<l;++n){const i={};for(let e=0;e<s.length;++e)i[s[e]]=t.dims[e];i[r[0]]=c[n],i[r[1]]=e[n],a.push(jk(i))}}),this.value&&(n.rem=this.value),this.value=n.add=n.source=a,n}}),IP(jI,JO,{transform(t,e){let n,r;return this.value?r=this.value:(n=e=e.addAll(),r=this.value={}),t.derive&&(n=e.fork(e.NO_SOURCE),e.visit(e.REM,t=>{const e=Fk(t);n.rem.push(r[e]),r[e]=null}),e.visit(e.ADD,t=>{const e=zk(t);r[Fk(t)]=e,n.add.push(e)}),e.visit(e.MOD,t=>{const e=r[Fk(t)];for(const r in t)e[r]=t[r],n.modifies(r);n.mod.push(e)})),n}}),zI.Definition={type:"Sample",metadata:{},params:[{name:"size",type:"number",default:1e3}]},IP(zI,JO,{transform(t,e){const n=e.fork(e.NO_SOURCE),r=t.modified("size"),i=t.size,o=this.value.reduce((t,e)=>(t[Fk(e)]=1,t),{});let s=this.value,a=this.count,u=0;function c(t){let e,r;s.length<i?s.push(t):(r=~~((a+1)*tT()),r<s.length&&r>=u&&(e=s[r],o[Fk(e)]&&n.rem.push(e),s[r]=t)),++a}if(e.rem.length&&(e.visit(e.REM,t=>{const e=Fk(t);o[e]&&(o[e]=-1,n.rem.push(t)),--a}),s=s.filter(t=>-1!==o[Fk(t)])),(e.rem.length||r)&&s.length<i&&e.source&&(u=a=s.length,e.visit(e.SOURCE,t=>{o[Fk(t)]||c(t)}),u=-1),r&&s.length>i){const t=s.length-i;for(let e=0;e<t;++e)o[Fk(s[e])]=-1,n.rem.push(s[e]);s=s.slice(t)}return e.mod.length&&e.visit(e.MOD,t=>{o[Fk(t)]&&n.mod.push(t)}),e.add.length&&e.visit(e.ADD,c),(e.add.length||u<0)&&(n.add=s.filter(t=>!o[Fk(t)])),this.count=a,this.value=n.source=s,n}}),UI.Definition={type:"Sequence",metadata:{generates:!0,changes:!0},params:[{name:"start",type:"number",required:!0},{name:"stop",type:"number",required:!0},{name:"step",type:"number",default:1},{name:"as",type:"string",default:"data"}]},IP(UI,JO,{transform(t,e){if(this.value&&!t.modified())return;const n=e.materialize().fork(e.MOD),r=t.as||"data";return n.rem=this.value?e.rem.concat(this.value):e.rem,this.value=oL(t.start,t.stop,t.step||1).map(t=>{const e={};return e[r]=t,jk(e)}),n.add=e.add.concat(this.value),n}}),IP($I,JO,{transform(t,e){return this.value=e.source,e.changed()?e.fork(e.NO_SOURCE|e.NO_FIELDS):e.StopPropagation}});const qI=["unit0","unit1"];function WI(t){JO.call(this,LP(),t)}function GI(t){JO.call(this,null,t)}function HI(t,e,n,r){const i=XI[t](e,n);return{init:i.init||fP,update:function(t,e){e[r]=i.next(t)}}}VI.Definition={type:"TimeUnit",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"interval",type:"boolean",default:!0},{name:"units",type:"enum",values:uL["j"],array:!0},{name:"step",type:"number",default:1},{name:"maxbins",type:"number",default:40},{name:"extent",type:"date",array:!0},{name:"timezone",type:"enum",default:"local",values:["local","utc"]},{name:"as",type:"string",array:!0,length:2,default:qI}]},IP(VI,JO,{transform(t,e){const n=t.field,r=!1!==t.interval,i="utc"===t.timezone,o=this._floor(t,e),s=(i?uL["v"]:uL["p"])(o.unit).offset,a=t.as||qI,u=a[0],c=a[1],l=o.step;let h=o.start||1/0,f=o.stop||-1/0,d=e.ADD;return(t.modified()||e.modified(iP(n)))&&(e=e.reflow(!0),d=e.SOURCE,h=1/0,f=-1/0),e.visit(d,t=>{const e=n(t);let i,a;null==e?(t[u]=null,r&&(t[c]=null)):(t[u]=i=a=o(e),r&&(t[c]=a=s(i,l)),i<h&&(h=i),a>f&&(f=a))}),o.start=h,o.stop=f,e.modifies(r?a:u)},_floor(t,e){const n="utc"===t.timezone,{units:r,step:i}=t.units?{units:t.units,step:t.step||1}:Object(uL["n"])({extent:t.extent||CP(e.materialize(e.SOURCE).source,t.field),maxbins:t.maxbins}),o=Object(uL["t"])(r),s=this.value||{},a=(n?uL["u"]:uL["o"])(o,i);return a.unit=gP(o),a.units=o,a.step=i,a.start=s.start,a.stop=s.stop,this.value=a}}),IP(WI,JO,{transform(t,e){const n=e.dataflow,r=t.field,i=this.value,o=t=>i.set(r(t),t);let s=!0;return t.modified("field")||e.modified(r.fields)?(i.clear(),e.visit(e.SOURCE,o)):e.changed()?(e.visit(e.REM,t=>i.delete(r(t))),e.visit(e.ADD,o)):s=!1,this.modified(s),i.empty>n.cleanThreshold&&n.runAfter(i.clean),e.fork()}}),IP(GI,JO,{transform(t,e){const n=!this.value||t.modified("field")||t.modified("sort")||e.changed()||t.sort&&e.modified(t.sort.fields);n&&(this.value=(t.sort?e.source.slice().sort(Vk(t.sort)):e.source).map(t.field))}});const XI={row_number:function(){return{next:t=>t.index+1}},rank:function(){let t;return{init:()=>t=1,next:e=>{const n=e.index,r=e.data;return n&&e.compare(r[n-1],r[n])?t=n+1:t}}},dense_rank:function(){let t;return{init:()=>t=1,next:e=>{const n=e.index,r=e.data;return n&&e.compare(r[n-1],r[n])?++t:t}}},percent_rank:function(){const t=XI.rank(),e=t.next;return{init:t.init,next:t=>(e(t)-1)/(t.data.length-1)}},cume_dist:function(){let t;return{init:()=>t=0,next:e=>{const n=e.data,r=e.compare;let i=e.index;if(t<i){while(i+1<n.length&&!r(n[i],n[i+1]))++i;t=i}return(1+t)/n.length}}},ntile:function(t,e){e=+e,e>0||uP("ntile num must be greater than zero.");const n=XI.cume_dist(),r=n.next;return{init:n.init,next:t=>Math.ceil(e*r(t))}},lag:function(t,e){return e=+e||1,{next:n=>{const r=n.index-e;return r>=0?t(n.data[r]):null}}},lead:function(t,e){return e=+e||1,{next:n=>{const r=n.index+e,i=n.data;return r<i.length?t(i[r]):null}}},first_value:function(t){return{next:e=>t(e.data[e.i0])}},last_value:function(t){return{next:e=>t(e.data[e.i1-1])}},nth_value:function(t,e){return e=+e,e>0||uP("nth_value nth must be greater than zero."),{next:n=>{const r=n.i0+(e-1);return r<n.i1?t(n.data[r]):null}}},prev_value:function(t){let e;return{init:()=>e=null,next:n=>{const r=t(n.data[n.index]);return null!=r?e=r:e}}},next_value:function(t){let e,n;return{init:()=>(e=null,n=-1),next:r=>{const i=r.data;return r.index<=n?e:(n=YI(t,i,r.index))<0?(n=i.length,e=null):e=t(i[n])}}}};function YI(t,e,n){for(let r=e.length;n<r;++n){const r=t(e[n]);if(null!=r)return n}return-1}const ZI=Object.keys(XI);function KI(t){const e=yP(t.ops),n=yP(t.fields),r=yP(t.params),i=yP(t.as),o=this.outputs=[],s=this.windows=[],a={},u={},c=[],l=[];let h=!0;function f(t){yP(iP(t)).forEach(t=>a[t]=1)}f(t.sort),e.forEach((t,e)=>{const a=n[e],d=rP(a),p=hL(t,d,i[e]);if(f(a),o.push(p),PP(XI,t))s.push(HI(t,n[e],r[e],p));else{if(null==a&&"count"!==t&&uP("Null aggregate field specified."),"count"===t)return void c.push(p);h=!1;let e=u[d];e||(e=u[d]=[],e.field=a,l.push(e)),e.push(yL(t,p))}}),(c.length||l.length)&&(this.cell=QI(l,c,h)),this.inputs=Object.keys(a)}const JI=KI.prototype;function QI(t,e,n){t=t.map(t=>EL(t,t.field));const r={num:0,agg:null,store:!1,count:e};if(!n)for(var i=t.length,o=r.agg=Array(i),s=0;s<i;++s)o[s]=new t[s](r);if(r.store)var a=r.data=new AL;return r.add=function(t){if(r.num+=1,!n){a&&a.add(t);for(let e=0;e<i;++e)o[e].add(o[e].get(t),t)}},r.rem=function(t){if(r.num-=1,!n){a&&a.rem(t);for(let e=0;e<i;++e)o[e].rem(o[e].get(t),t)}},r.set=function(t){let i,s;for(a&&a.values(),i=0,s=e.length;i<s;++i)t[e[i]]=r.num;if(!n)for(i=0,s=o.length;i<s;++i)o[i].set(t)},r.init=function(){r.num=0,a&&a.reset();for(let t=0;t<i;++t)o[t].init()},r}function tN(t){JO.call(this,{},t),this._mlen=0,this._mods=[]}function eN(t,e,n,r){const i=r.sort,o=i&&!r.ignorePeers,s=r.frame||[null,0],a=t.data(n),u=a.length,c=o?sL(i):null,l={i0:0,i1:0,p0:0,p1:0,index:0,data:a,compare:i||AP(-1)};e.init();for(let h=0;h<u;++h)nN(l,s,h,u),o&&rN(l,c),e.update(l,a[h])}function nN(t,e,n,r){t.p0=t.i0,t.p1=t.i1,t.i0=null==e[0]?0:Math.max(0,n-Math.abs(e[0])),t.i1=null==e[1]?r:Math.min(r,n+Math.abs(e[1])+1),t.index=n}function rN(t,e){const n=t.i0,r=t.i1-1,i=t.compare,o=t.data,s=o.length-1;n>0&&!i(o[n],o[n-1])&&(t.i0=e.left(o,o[n])),r<s&&!i(o[r],o[r+1])&&(t.i1=e.right(o,o[r]))}function iN(t,e,n){return t.fields=e||[],t.fname=n,t}function oN(t){return 1===t.length?sN(t[0]):aN(t)}JI.init=function(){this.windows.forEach(t=>t.init()),this.cell&&this.cell.init()},JI.update=function(t,e){const n=this.cell,r=this.windows,i=t.data,o=r&&r.length;let s;if(n){for(s=t.p0;s<t.i0;++s)n.rem(i[s]);for(s=t.p1;s<t.i1;++s)n.add(i[s]);n.set(e)}for(s=0;s<o;++s)r[s].update(t,e)},tN.Definition={type:"Window",metadata:{modifies:!0},params:[{name:"sort",type:"compare"},{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:ZI.concat(gL)},{name:"params",type:"number",null:!0,array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"frame",type:"number",null:!0,array:!0,length:2,default:[null,0]},{name:"ignorePeers",type:"boolean",default:!1}]},IP(tN,JO,{transform(t,e){this.stamp=e.stamp;const n=t.modified(),r=Vk(t.sort),i=lL(t.groupby),o=t=>this.group(i(t));let s=this.state;s&&!n||(s=this.state=new KI(t)),n||e.modified(s.inputs)?(this.value={},e.visit(e.SOURCE,t=>o(t).add(t))):(e.visit(e.REM,t=>o(t).remove(t)),e.visit(e.ADD,t=>o(t).add(t)));for(let a=0,u=this._mlen;a<u;++a)eN(this._mods[a],s,r,t);return this._mlen=0,this._mods=[],e.reflow(n).modifies(s.outputs)},group(t){let e=this.value[t];return e||(e=this.value[t]=PL(Fk),e.stamp=-1),e.stamp<this.stamp&&(e.stamp=this.stamp,this._mods[this._mlen++]=e),e}});const sN=t=>(function(e){return e[t]}),aN=t=>{const e=t.length;return function(n){for(let r=0;r<e;++r)n=n[t[r]];return n}};function uN(t){throw Error(t)}function cN(t){const e=[],n=t.length;let r,i,o,s=null,a=0,u="";function c(){e.push(u+t.substring(r,i)),u="",r=i+1}for(t+="",r=i=0;i<n;++i)if(o=t[i],"\\"===o)u+=t.substring(r,i),u+=t.substring(++i,++i),r=i;else if(o===s)c(),s=null,a=-1;else{if(s)continue;r===a&&'"'===o?(r=i+1,s=o):r===a&&"'"===o?(r=i+1,s=o):"."!==o||a?"["===o?(i>r&&c(),a=r=i+1):"]"===o&&(a||uN("Access path missing open bracket: "+t),a>0&&c(),a=0,r=i+1):i>r?c():r=i+1}return a&&uN("Access path missing closing bracket: "+t),s&&uN("Access path missing closing quote: "+t),i>r&&(i++,c()),e}function lN(t,e,n){const r=cN(t);return t=1===r.length?r[0]:t,iN((n&&n.get||oN)(r),[t],e||t)}lN("id"),iN(t=>t,[],"identity"),iN(()=>0,[],"zero"),iN(()=>1,[],"one");const hN=iN(()=>!0,[],"true");iN(()=>!1,[],"false");var fN=Array.isArray;function dN(t){return t===Object(t)}function pN(t){return t[t.length-1]}function gN(t){return null!=t?fN(t)?t:[t]:[]}function mN(t){return"function"===typeof t}function yN(t){for(let e,n,r=1,i=arguments.length;r<i;++r)for(n in e=arguments[r],e)t[n]=e[n];return t}const vN=Object.prototype.hasOwnProperty;function bN(t,e){return vN.call(t,e)}function _N(t,e,n){const r=t.prototype=Object.create(e.prototype);return Object.defineProperty(r,"constructor",{value:t,writable:!0,enumerable:!0,configurable:!0}),yN(r,n)}function wN(t){return"number"===typeof t}const xN=1e4;function SN(t){let e,n,r;t=+t||xN;const i=()=>{e={},n={},r=0},o=(i,o)=>{return++r>t&&(n=e,e={},r=1),e[i]=o};return i(),{clear:i,has:t=>bN(e,t)||bN(n,t),get:t=>bN(e,t)?e[t]:bN(n,t)?o(t,n[t]):void 0,set:(t,n)=>bN(e,t)?e[t]=n:o(t,n)}}function EN(t){const e={},n=t.length;for(let r=0;r<n;++r)e[t[r]]=!0;return e}function AN(t,e,n){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+e)/6,(t._y0+4*t._y1+n)/6)}function MN(t){this._context=t}MN.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:AN(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:AN(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};var CN=function(t){return new MN(t)},kN=function(){};function ON(t){this._context=t}ON.prototype={areaStart:kN,areaEnd:kN,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x2,this._y2),this._context.closePath();break;case 2:this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break;case 3:this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x2=t,this._y2=e;break;case 1:this._point=2,this._x3=t,this._y3=e;break;case 2:this._point=3,this._x4=t,this._y4=e,this._context.moveTo((this._x0+4*this._x1+t)/6,(this._y0+4*this._y1+e)/6);break;default:AN(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};var PN=function(t){return new ON(t)};function TN(t){this._context=t}TN.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+t)/6,r=(this._y0+4*this._y1+e)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:AN(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};var LN=function(t){return new TN(t)};function IN(t,e){this._basis=new MN(t),this._beta=e}IN.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var t=this._x,e=this._y,n=t.length-1;if(n>0){var r,i=t[0],o=e[0],s=t[n]-i,a=e[n]-o,u=-1;while(++u<=n)r=u/n,this._basis.point(this._beta*t[u]+(1-this._beta)*(i+r*s),this._beta*e[u]+(1-this._beta)*(o+r*a))}this._x=this._y=null,this._basis.lineEnd()},point:function(t,e){this._x.push(+t),this._y.push(+e)}};var NN=function t(e){function n(t){return 1===e?new MN(t):new IN(t,e)}return n.beta=function(e){return t(+e)},n}(.85);function DN(t,e,n){t._context.bezierCurveTo(t._x1+t._k*(t._x2-t._x0),t._y1+t._k*(t._y2-t._y0),t._x2+t._k*(t._x1-e),t._y2+t._k*(t._y1-n),t._x2,t._y2)}function RN(t,e){this._context=t,this._k=(1-e)/6}RN.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:DN(this,this._x1,this._y1);break}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2,this._x1=t,this._y1=e;break;case 2:this._point=3;default:DN(this,t,e);break}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var FN=function t(e){function n(t){return new RN(t,e)}return n.tension=function(e){return t(+e)},n}(0);function BN(t,e){this._context=t,this._k=(1-e)/6}BN.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:DN(this,t,e);break}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var jN=function t(e){function n(t){return new BN(t,e)}return n.tension=function(e){return t(+e)},n}(0);function zN(t,e){this._context=t,this._k=(1-e)/6}zN.prototype={areaStart:kN,areaEnd:kN,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x3=t,this._y3=e;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=e);break;case 2:this._point=3,this._x5=t,this._y5=e;break;default:DN(this,t,e);break}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var UN=function t(e){function n(t){return new zN(t,e)}return n.tension=function(e){return t(+e)},n}(0),$N=Math.abs,VN=Math.atan2,qN=Math.cos,WN=Math.max,GN=Math.min,HN=Math.sin,XN=Math.sqrt,YN=1e-12,ZN=Math.PI,KN=ZN/2,JN=2*ZN;function QN(t){return t>1?0:t<-1?ZN:Math.acos(t)}function tD(t){return t>=1?KN:t<=-1?-KN:Math.asin(t)}function eD(t,e,n){var r=t._x1,i=t._y1,o=t._x2,s=t._y2;if(t._l01_a>YN){var a=2*t._l01_2a+3*t._l01_a*t._l12_a+t._l12_2a,u=3*t._l01_a*(t._l01_a+t._l12_a);r=(r*a-t._x0*t._l12_2a+t._x2*t._l01_2a)/u,i=(i*a-t._y0*t._l12_2a+t._y2*t._l01_2a)/u}if(t._l23_a>YN){var c=2*t._l23_2a+3*t._l23_a*t._l12_a+t._l12_2a,l=3*t._l23_a*(t._l23_a+t._l12_a);o=(o*c+t._x1*t._l23_2a-e*t._l12_2a)/l,s=(s*c+t._y1*t._l23_2a-n*t._l12_2a)/l}t._context.bezierCurveTo(r,i,o,s,t._x2,t._y2)}function nD(t,e){this._context=t,this._alpha=e}nD.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2);break}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,r=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3;default:eD(this,t,e);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var rD=function t(e){function n(t){return e?new nD(t,e):new RN(t,0)}return n.alpha=function(e){return t(+e)},n}(.5);function iD(t,e){this._context=t,this._alpha=e}iD.prototype={areaStart:kN,areaEnd:kN,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,r=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=t,this._y3=e;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=e);break;case 2:this._point=3,this._x5=t,this._y5=e;break;default:eD(this,t,e);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var oD=function t(e){function n(t){return e?new iD(t,e):new zN(t,0)}return n.alpha=function(e){return t(+e)},n}(.5);function sD(t,e){this._context=t,this._alpha=e}sD.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,r=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:eD(this,t,e);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var aD=function t(e){function n(t){return e?new sD(t,e):new BN(t,0)}return n.alpha=function(e){return t(+e)},n}(.5);function uD(t){this._context=t}uD.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e);break}}};var cD=function(t){return new uD(t)};function lD(t){this._context=t}lD.prototype={areaStart:kN,areaEnd:kN,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(t,e){t=+t,e=+e,this._point?this._context.lineTo(t,e):(this._point=1,this._context.moveTo(t,e))}};var hD=function(t){return new lD(t)};function fD(t){return t<0?-1:1}function dD(t,e,n){var r=t._x1-t._x0,i=e-t._x1,o=(t._y1-t._y0)/(r||i<0&&-0),s=(n-t._y1)/(i||r<0&&-0),a=(o*i+s*r)/(r+i);return(fD(o)+fD(s))*Math.min(Math.abs(o),Math.abs(s),.5*Math.abs(a))||0}function pD(t,e){var n=t._x1-t._x0;return n?(3*(t._y1-t._y0)/n-e)/2:e}function gD(t,e,n){var r=t._x0,i=t._y0,o=t._x1,s=t._y1,a=(o-r)/3;t._context.bezierCurveTo(r+a,i+a*e,o-a,s-a*n,o,s)}function mD(t){this._context=t}function yD(t){this._context=new vD(t)}function vD(t){this._context=t}function bD(t){return new mD(t)}function _D(t){return new yD(t)}function wD(t){this._context=t}function xD(t){var e,n,r=t.length-1,i=new Array(r),o=new Array(r),s=new Array(r);for(i[0]=0,o[0]=2,s[0]=t[0]+2*t[1],e=1;e<r-1;++e)i[e]=1,o[e]=4,s[e]=4*t[e]+2*t[e+1];for(i[r-1]=2,o[r-1]=7,s[r-1]=8*t[r-1]+t[r],e=1;e<r;++e)n=i[e]/o[e-1],o[e]-=n,s[e]-=n*s[e-1];for(i[r-1]=s[r-1]/o[r-1],e=r-2;e>=0;--e)i[e]=(s[e]-i[e+1])/o[e];for(o[r-1]=(t[r]+i[r-1])/2,e=0;e<r-1;++e)o[e]=2*t[e+1]-i[e+1];return[i,o]}mD.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:gD(this,this._t0,pD(this,this._t0));break}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){var n=NaN;if(t=+t,e=+e,t!==this._x1||e!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,gD(this,pD(this,n=dD(this,t,e)),n);break;default:gD(this,this._t0,n=dD(this,t,e));break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e,this._t0=n}}},(yD.prototype=Object.create(mD.prototype)).point=function(t,e){mD.prototype.point.call(this,e,t)},vD.prototype={moveTo:function(t,e){this._context.moveTo(e,t)},closePath:function(){this._context.closePath()},lineTo:function(t,e){this._context.lineTo(e,t)},bezierCurveTo:function(t,e,n,r,i,o){this._context.bezierCurveTo(e,t,r,n,o,i)}},wD.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var t=this._x,e=this._y,n=t.length;if(n)if(this._line?this._context.lineTo(t[0],e[0]):this._context.moveTo(t[0],e[0]),2===n)this._context.lineTo(t[1],e[1]);else for(var r=xD(t),i=xD(e),o=0,s=1;s<n;++o,++s)this._context.bezierCurveTo(r[0][o],i[0][o],r[1][o],i[1][o],t[s],e[s]);(this._line||0!==this._line&&1===n)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(t,e){this._x.push(+t),this._y.push(+e)}};var SD=function(t){return new wD(t)};function ED(t,e){this._context=t,this._t=e}ED.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&2===this._point&&this._context.lineTo(this._x,this._y),(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:if(this._t<=0)this._context.lineTo(this._x,e),this._context.lineTo(t,e);else{var n=this._x*(1-this._t)+t*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,e)}break}this._x=t,this._y=e}};var AD=function(t){return new ED(t,.5)};function MD(t){return new ED(t,0)}function CD(t){return new ED(t,1)}const kD=Math.PI,OD=2*kD,PD=1e-6,TD=OD-PD;function LD(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function ID(){return new LD}LD.prototype=ID.prototype={constructor:LD,moveTo:function(t,e){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(t,e){this._+="L"+(this._x1=+t)+","+(this._y1=+e)},quadraticCurveTo:function(t,e,n,r){this._+="Q"+ +t+","+ +e+","+(this._x1=+n)+","+(this._y1=+r)},bezierCurveTo:function(t,e,n,r,i,o){this._+="C"+ +t+","+ +e+","+ +n+","+ +r+","+(this._x1=+i)+","+(this._y1=+o)},arcTo:function(t,e,n,r,i){t=+t,e=+e,n=+n,r=+r,i=+i;var o=this._x1,s=this._y1,a=n-t,u=r-e,c=o-t,l=s-e,h=c*c+l*l;if(i<0)throw new Error("negative radius: "+i);if(null===this._x1)this._+="M"+(this._x1=t)+","+(this._y1=e);else if(h>PD)if(Math.abs(l*a-u*c)>PD&&i){var f=n-o,d=r-s,p=a*a+u*u,g=f*f+d*d,m=Math.sqrt(p),y=Math.sqrt(h),v=i*Math.tan((kD-Math.acos((p+h-g)/(2*m*y)))/2),b=v/y,_=v/m;Math.abs(b-1)>PD&&(this._+="L"+(t+b*c)+","+(e+b*l)),this._+="A"+i+","+i+",0,0,"+ +(l*f>c*d)+","+(this._x1=t+_*a)+","+(this._y1=e+_*u)}else this._+="L"+(this._x1=t)+","+(this._y1=e);else;},arc:function(t,e,n,r,i,o){t=+t,e=+e,n=+n,o=!!o;var s=n*Math.cos(r),a=n*Math.sin(r),u=t+s,c=e+a,l=1^o,h=o?r-i:i-r;if(n<0)throw new Error("negative radius: "+n);null===this._x1?this._+="M"+u+","+c:(Math.abs(this._x1-u)>PD||Math.abs(this._y1-c)>PD)&&(this._+="L"+u+","+c),n&&(h<0&&(h=h%OD+OD),h>TD?this._+="A"+n+","+n+",0,1,"+l+","+(t-s)+","+(e-a)+"A"+n+","+n+",0,1,"+l+","+(this._x1=u)+","+(this._y1=c):h>PD&&(this._+="A"+n+","+n+",0,"+ +(h>=kD)+","+l+","+(this._x1=t+n*Math.cos(i))+","+(this._y1=e+n*Math.sin(i))))},rect:function(t,e,n,r){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)+"h"+ +n+"v"+ +r+"h"+-n+"Z"},toString:function(){return this._}};var ND=ID,DD=function(t){return function(){return t}};function RD(t){return t.innerRadius}function FD(t){return t.outerRadius}function BD(t){return t.startAngle}function jD(t){return t.endAngle}function zD(t){return t&&t.padAngle}function UD(t,e,n,r,i,o,s,a){var u=n-t,c=r-e,l=s-i,h=a-o,f=h*u-l*c;if(!(f*f<YN))return f=(l*(e-o)-h*(t-i))/f,[t+f*u,e+f*c]}function $D(t,e,n,r,i,o,s){var a=t-n,u=e-r,c=(s?o:-o)/XN(a*a+u*u),l=c*u,h=-c*a,f=t+l,d=e+h,p=n+l,g=r+h,m=(f+p)/2,y=(d+g)/2,v=p-f,b=g-d,_=v*v+b*b,w=i-o,x=f*g-p*d,S=(b<0?-1:1)*XN(WN(0,w*w*_-x*x)),E=(x*b-v*S)/_,A=(-x*v-b*S)/_,M=(x*b+v*S)/_,C=(-x*v+b*S)/_,k=E-m,O=A-y,P=M-m,T=C-y;return k*k+O*O>P*P+T*T&&(E=M,A=C),{cx:E,cy:A,x01:-l,y01:-h,x11:E*(i/w-1),y11:A*(i/w-1)}}var VD=function(){var t=RD,e=FD,n=DD(0),r=null,i=BD,o=jD,s=zD,a=null;function u(){var u,c,l=+t.apply(this,arguments),h=+e.apply(this,arguments),f=i.apply(this,arguments)-KN,d=o.apply(this,arguments)-KN,p=$N(d-f),g=d>f;if(a||(a=u=ND()),h<l&&(c=h,h=l,l=c),h>YN)if(p>JN-YN)a.moveTo(h*qN(f),h*HN(f)),a.arc(0,0,h,f,d,!g),l>YN&&(a.moveTo(l*qN(d),l*HN(d)),a.arc(0,0,l,d,f,g));else{var m,y,v=f,b=d,_=f,w=d,x=p,S=p,E=s.apply(this,arguments)/2,A=E>YN&&(r?+r.apply(this,arguments):XN(l*l+h*h)),M=GN($N(h-l)/2,+n.apply(this,arguments)),C=M,k=M;if(A>YN){var O=tD(A/l*HN(E)),P=tD(A/h*HN(E));(x-=2*O)>YN?(O*=g?1:-1,_+=O,w-=O):(x=0,_=w=(f+d)/2),(S-=2*P)>YN?(P*=g?1:-1,v+=P,b-=P):(S=0,v=b=(f+d)/2)}var T=h*qN(v),L=h*HN(v),I=l*qN(w),N=l*HN(w);if(M>YN){var D,R=h*qN(b),F=h*HN(b),B=l*qN(_),j=l*HN(_);if(p<ZN&&(D=UD(T,L,B,j,R,F,I,N))){var z=T-D[0],U=L-D[1],$=R-D[0],V=F-D[1],q=1/HN(QN((z*$+U*V)/(XN(z*z+U*U)*XN($*$+V*V)))/2),W=XN(D[0]*D[0]+D[1]*D[1]);C=GN(M,(l-W)/(q-1)),k=GN(M,(h-W)/(q+1))}}S>YN?k>YN?(m=$D(B,j,T,L,h,k,g),y=$D(R,F,I,N,h,k,g),a.moveTo(m.cx+m.x01,m.cy+m.y01),k<M?a.arc(m.cx,m.cy,k,VN(m.y01,m.x01),VN(y.y01,y.x01),!g):(a.arc(m.cx,m.cy,k,VN(m.y01,m.x01),VN(m.y11,m.x11),!g),a.arc(0,0,h,VN(m.cy+m.y11,m.cx+m.x11),VN(y.cy+y.y11,y.cx+y.x11),!g),a.arc(y.cx,y.cy,k,VN(y.y11,y.x11),VN(y.y01,y.x01),!g))):(a.moveTo(T,L),a.arc(0,0,h,v,b,!g)):a.moveTo(T,L),l>YN&&x>YN?C>YN?(m=$D(I,N,R,F,l,-C,g),y=$D(T,L,B,j,l,-C,g),a.lineTo(m.cx+m.x01,m.cy+m.y01),C<M?a.arc(m.cx,m.cy,C,VN(m.y01,m.x01),VN(y.y01,y.x01),!g):(a.arc(m.cx,m.cy,C,VN(m.y01,m.x01),VN(m.y11,m.x11),!g),a.arc(0,0,l,VN(m.cy+m.y11,m.cx+m.x11),VN(y.cy+y.y11,y.cx+y.x11),g),a.arc(y.cx,y.cy,C,VN(y.y11,y.x11),VN(y.y01,y.x01),!g))):a.arc(0,0,l,w,_,g):a.lineTo(I,N)}else a.moveTo(0,0);if(a.closePath(),u)return a=null,u+""||null}return u.centroid=function(){var n=(+t.apply(this,arguments)+ +e.apply(this,arguments))/2,r=(+i.apply(this,arguments)+ +o.apply(this,arguments))/2-ZN/2;return[qN(r)*n,HN(r)*n]},u.innerRadius=function(e){return arguments.length?(t="function"===typeof e?e:DD(+e),u):t},u.outerRadius=function(t){return arguments.length?(e="function"===typeof t?t:DD(+t),u):e},u.cornerRadius=function(t){return arguments.length?(n="function"===typeof t?t:DD(+t),u):n},u.padRadius=function(t){return arguments.length?(r=null==t?null:"function"===typeof t?t:DD(+t),u):r},u.startAngle=function(t){return arguments.length?(i="function"===typeof t?t:DD(+t),u):i},u.endAngle=function(t){return arguments.length?(o="function"===typeof t?t:DD(+t),u):o},u.padAngle=function(t){return arguments.length?(s="function"===typeof t?t:DD(+t),u):s},u.context=function(t){return arguments.length?(a=null==t?null:t,u):a},u},qD=(Array.prototype.slice,function(t){return"object"===typeof t&&"length"in t?t:Array.from(t)});function WD(t){return t[0]}function GD(t){return t[1]}var HD=function(t,e){var n=DD(!0),r=null,i=cD,o=null;function s(s){var a,u,c,l=(s=qD(s)).length,h=!1;for(null==r&&(o=i(c=ND())),a=0;a<=l;++a)!(a<l&&n(u=s[a],a,s))===h&&((h=!h)?o.lineStart():o.lineEnd()),h&&o.point(+t(u,a,s),+e(u,a,s));if(c)return o=null,c+""||null}return t="function"===typeof t?t:void 0===t?WD:DD(t),e="function"===typeof e?e:void 0===e?GD:DD(e),s.x=function(e){return arguments.length?(t="function"===typeof e?e:DD(+e),s):t},s.y=function(t){return arguments.length?(e="function"===typeof t?t:DD(+t),s):e},s.defined=function(t){return arguments.length?(n="function"===typeof t?t:DD(!!t),s):n},s.curve=function(t){return arguments.length?(i=t,null!=r&&(o=i(r)),s):i},s.context=function(t){return arguments.length?(null==t?r=o=null:o=i(r=t),s):r},s},XD=function(t,e,n){var r=null,i=DD(!0),o=null,s=cD,a=null;function u(u){var c,l,h,f,d,p=(u=qD(u)).length,g=!1,m=new Array(p),y=new Array(p);for(null==o&&(a=s(d=ND())),c=0;c<=p;++c){if(!(c<p&&i(f=u[c],c,u))===g)if(g=!g)l=c,a.areaStart(),a.lineStart();else{for(a.lineEnd(),a.lineStart(),h=c-1;h>=l;--h)a.point(m[h],y[h]);a.lineEnd(),a.areaEnd()}g&&(m[c]=+t(f,c,u),y[c]=+e(f,c,u),a.point(r?+r(f,c,u):m[c],n?+n(f,c,u):y[c]))}if(d)return a=null,d+""||null}function c(){return HD().defined(i).curve(s).context(o)}return t="function"===typeof t?t:void 0===t?WD:DD(+t),e="function"===typeof e?e:DD(void 0===e?0:+e),n="function"===typeof n?n:void 0===n?GD:DD(+n),u.x=function(e){return arguments.length?(t="function"===typeof e?e:DD(+e),r=null,u):t},u.x0=function(e){return arguments.length?(t="function"===typeof e?e:DD(+e),u):t},u.x1=function(t){return arguments.length?(r=null==t?null:"function"===typeof t?t:DD(+t),u):r},u.y=function(t){return arguments.length?(e="function"===typeof t?t:DD(+t),n=null,u):e},u.y0=function(t){return arguments.length?(e="function"===typeof t?t:DD(+t),u):e},u.y1=function(t){return arguments.length?(n=null==t?null:"function"===typeof t?t:DD(+t),u):n},u.lineX0=u.lineY0=function(){return c().x(t).y(e)},u.lineY1=function(){return c().x(t).y(n)},u.lineX1=function(){return c().x(r).y(e)},u.defined=function(t){return arguments.length?(i="function"===typeof t?t:DD(!!t),u):i},u.curve=function(t){return arguments.length?(s=t,null!=o&&(a=s(o)),u):s},u.context=function(t){return arguments.length?(null==t?o=a=null:a=s(o=t),u):o},u},YD={draw:function(t,e){var n=Math.sqrt(e/ZN);t.moveTo(n,0),t.arc(0,0,n,0,JN)}},ZD=(Math.sqrt(1/3),Math.sin(ZN/10)/Math.sin(7*ZN/10)),KD=(Math.sin(JN/10),Math.cos(JN/10),Math.sqrt(3),Math.sqrt(3),Math.sqrt(12),function(t,e){var n=null;function r(){var r;if(n||(n=r=ND()),t.apply(this,arguments).draw(n,+e.apply(this,arguments)),r)return n=null,r+""||null}return t="function"===typeof t?t:DD(t||YD),e="function"===typeof e?e:DD(void 0===e?64:+e),r.type=function(e){return arguments.length?(t="function"===typeof e?e:DD(e),r):t},r.size=function(t){return arguments.length?(e="function"===typeof t?t:DD(+t),r):e},r.context=function(t){return arguments.length?(n=null==t?null:t,r):n},r});function JD(t,e){if("undefined"!==typeof document&&document.createElement){const n=document.createElement("canvas");if(n&&n.getContext)return n.width=t,n.height=e,n}return null}const QD=()=>"undefined"!==typeof Image?Image:null;function tR(t,e,n){return t.fields=e||[],t.fname=n,t}function eR(t){return 1===t.length?nR(t[0]):rR(t)}const nR=t=>(function(e){return e[t]}),rR=t=>{const e=t.length;return function(n){for(let r=0;r<e;++r)n=n[t[r]];return n}};function iR(t){throw Error(t)}function oR(t){const e=[],n=t.length;let r,i,o,s=null,a=0,u="";function c(){e.push(u+t.substring(r,i)),u="",r=i+1}for(t+="",r=i=0;i<n;++i)if(o=t[i],"\\"===o)u+=t.substring(r,i),u+=t.substring(++i,++i),r=i;else if(o===s)c(),s=null,a=-1;else{if(s)continue;r===a&&'"'===o?(r=i+1,s=o):r===a&&"'"===o?(r=i+1,s=o):"."!==o||a?"["===o?(i>r&&c(),a=r=i+1):"]"===o&&(a||iR("Access path missing open bracket: "+t),a>0&&c(),a=0,r=i+1):i>r?c():r=i+1}return a&&iR("Access path missing closing bracket: "+t),s&&iR("Access path missing closing quote: "+t),i>r&&(i++,c()),e}function sR(t,e,n){const r=oR(t);return t=1===r.length?r[0]:t,tR((n&&n.get||eR)(r),[t],e||t)}sR("id"),tR(t=>t,[],"identity"),tR(()=>0,[],"zero"),tR(()=>1,[],"one"),tR(()=>!0,[],"true"),tR(()=>!1,[],"false");var aR=Array.isArray;function uR(t){return t===Object(t)}function cR(t){return t[t.length-1]}function lR(t){return null==t||""===t?null:+t}function hR(t){return null!=t?aR(t)?t:[t]:[]}function fR(t){return"function"===typeof t}function dR(t){return fR(t)?t:()=>t}const pR=Object.prototype.hasOwnProperty;function gR(t,e){return pR.call(t,e)}function mR(t){return"number"===typeof t}function yR(t){return"string"===typeof t}function vR(t){return t&&cR(t)-t[0]||0}function bR(t){const e={},n=t.length;for(let r=0;r<n;++r)e[t[r]]=!0;return e}var _R=function(t,e,n){t=+t,e=+e,n=(i=arguments.length)<2?(e=t,t=0,1):i<3?1:+n;var r=-1,i=0|Math.max(0,Math.ceil((e-t)/n)),o=new Array(i);while(++r<i)o[r]=t+r*n;return o},wR=function(t,e){return t<e?-1:t>e?1:t>=e?0:NaN},xR=function(t){let e=t,n=t;function r(t,e,r,i){null==r&&(r=0),null==i&&(i=t.length);while(r<i){const o=r+i>>>1;n(t[o],e)<0?r=o+1:i=o}return r}function i(t,e,r,i){null==r&&(r=0),null==i&&(i=t.length);while(r<i){const o=r+i>>>1;n(t[o],e)>0?i=o:r=o+1}return r}function o(t,n,i,o){null==i&&(i=0),null==o&&(o=t.length);const s=r(t,n,i,o-1);return s>i&&e(t[s-1],n)>-e(t[s],n)?s-1:s}return 1===t.length&&(e=(e,n)=>t(e)-n,n=SR(t)),{left:r,center:o,right:i}};function SR(t){return(e,n)=>wR(t(e),n)}var ER=function(t){return null===t?NaN:+t};const AR=xR(wR),MR=AR.right;AR.left,xR(ER).center;var CR=MR;function kR(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t);break}return this}function OR(t,e){switch(arguments.length){case 0:break;case 1:"function"===typeof t?this.interpolator(t):this.range(t);break;default:this.domain(t),"function"===typeof e?this.interpolator(e):this.range(e);break}return this}const PR=Symbol("implicit");function TR(){var t=new Map,e=[],n=[],r=PR;function i(i){var o=i+"",s=t.get(o);if(!s){if(r!==PR)return r;t.set(o,s=e.push(i))}return n[(s-1)%n.length]}return i.domain=function(n){if(!arguments.length)return e.slice();e=[],t=new Map;for(const r of n){const n=r+"";t.has(n)||t.set(n,e.push(r))}return i},i.range=function(t){return arguments.length?(n=Array.from(t),i):n.slice()},i.unknown=function(t){return arguments.length?(r=t,i):r},i.copy=function(){return TR(e,n).unknown(r)},kR.apply(i,arguments),i}var LR=Math.sqrt(50),IR=Math.sqrt(10),NR=Math.sqrt(2),DR=function(t,e,n){var r,i,o,s,a=-1;if(e=+e,t=+t,n=+n,t===e&&n>0)return[t];if((r=e<t)&&(i=t,t=e,e=i),0===(s=RR(t,e,n))||!isFinite(s))return[];if(s>0){let n=Math.round(t/s),r=Math.round(e/s);n*s<t&&++n,r*s>e&&--r,o=new Array(i=r-n+1);while(++a<i)o[a]=(n+a)*s}else{s=-s;let n=Math.round(t*s),r=Math.round(e*s);n/s<t&&++n,r/s>e&&--r,o=new Array(i=r-n+1);while(++a<i)o[a]=(n+a)/s}return r&&o.reverse(),o};function RR(t,e,n){var r=(e-t)/Math.max(0,n),i=Math.floor(Math.log(r)/Math.LN10),o=r/Math.pow(10,i);return i>=0?(o>=LR?10:o>=IR?5:o>=NR?2:1)*Math.pow(10,i):-Math.pow(10,-i)/(o>=LR?10:o>=IR?5:o>=NR?2:1)}function FR(t,e,n){var r=Math.abs(e-t)/Math.max(0,n),i=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),o=r/i;return o>=LR?i*=10:o>=IR?i*=5:o>=NR&&(i*=2),e<t?-i:i}var BR=n("09b8"),jR=n("d933"),zR=n("1231"),UR=n("d989"),$R=n("dad1");function VR(t,e,n,r){var i,o=FR(t,e,n);switch(r=Object(BR["a"])(null==r?",f":r),r.type){case"s":var s=Math.max(Math.abs(t),Math.abs(e));return null!=r.precision||isNaN(i=Object(jR["a"])(o,s))||(r.precision=i),Object(zR["b"])(r,s);case"":case"e":case"g":case"p":case"r":null!=r.precision||isNaN(i=Object(UR["a"])(o,Math.max(Math.abs(t),Math.abs(e))))||(r.precision=i-("e"===r.type));break;case"f":case"%":null!=r.precision||isNaN(i=Object($R["a"])(o))||(r.precision=i-2*("%"===r.type));break}return Object(zR["a"])(r)}var qR=function(t,e){return t<e?-1:t>e?1:t>=e?0:NaN},WR=function(t){let e=t,n=t;function r(t,e,r,i){null==r&&(r=0),null==i&&(i=t.length);while(r<i){const o=r+i>>>1;n(t[o],e)<0?r=o+1:i=o}return r}function i(t,e,r,i){null==r&&(r=0),null==i&&(i=t.length);while(r<i){const o=r+i>>>1;n(t[o],e)>0?i=o:r=o+1}return r}function o(t,n,i,o){null==i&&(i=0),null==o&&(o=t.length);const s=r(t,n,i,o-1);return s>i&&e(t[s-1],n)>-e(t[s],n)?s-1:s}return 1===t.length&&(e=(e,n)=>t(e)-n,n=GR(t)),{left:r,center:o,right:i}};function GR(t){return(e,n)=>qR(t(e),n)}var HR=function(t){return null===t?NaN:+t};const XR=WR(qR),YR=XR.right;XR.left,WR(HR).center;var ZR=YR,KR=n("166a");function JR(t,e,n,r,i){var o=t*t,s=o*t;return((1-3*t+3*o-s)*e+(4-6*o+3*s)*n+(1+3*t+3*o-3*s)*r+s*i)/6}var QR=function(t){var e=t.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,e-1):Math.floor(n*e),i=t[r],o=t[r+1],s=r>0?t[r-1]:2*i-o,a=r<e-1?t[r+2]:2*o-i;return JR((n-r/e)*e,s,i,o,a)}},tF=function(t){var e=t.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*e),i=t[(r+e-1)%e],o=t[r%e],s=t[(r+1)%e],a=t[(r+2)%e];return JR((n-r/e)*e,i,o,s,a)}},eF=t=>()=>t;function nF(t,e){return function(n){return t+n*e}}function rF(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}function iF(t,e){var n=e-t;return n?nF(t,n>180||n<-180?n-360*Math.round(n/360):n):eF(isNaN(t)?e:t)}function oF(t){return 1===(t=+t)?sF:function(e,n){return n-e?rF(e,n,t):eF(isNaN(e)?n:e)}}function sF(t,e){var n=e-t;return n?nF(t,n):eF(isNaN(t)?e:t)}var aF=function t(e){var n=oF(e);function r(t,e){var r=n((t=Object(KR["g"])(t)).r,(e=Object(KR["g"])(e)).r),i=n(t.g,e.g),o=n(t.b,e.b),s=sF(t.opacity,e.opacity);return function(e){return t.r=r(e),t.g=i(e),t.b=o(e),t.opacity=s(e),t+""}}return r.gamma=t,r}(1);function uF(t){return function(e){var n,r,i=e.length,o=new Array(i),s=new Array(i),a=new Array(i);for(n=0;n<i;++n)r=Object(KR["g"])(e[n]),o[n]=r.r||0,s[n]=r.g||0,a[n]=r.b||0;return o=t(o),s=t(s),a=t(a),r.opacity=1,function(t){return r.r=o(t),r.g=s(t),r.b=a(t),r+""}}}var cF=uF(QR),lF=uF(tF),hF=function(t,e){e||(e=[]);var n,r=t?Math.min(e.length,t.length):0,i=e.slice();return function(o){for(n=0;n<r;++n)i[n]=t[n]*(1-o)+e[n]*o;return i}};function fF(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}var dF=function(t,e){return(fF(e)?hF:pF)(t,e)};function pF(t,e){var n,r=e?e.length:0,i=t?Math.min(r,t.length):0,o=new Array(i),s=new Array(r);for(n=0;n<i;++n)o[n]=SF(t[n],e[n]);for(;n<r;++n)s[n]=e[n];return function(t){for(n=0;n<i;++n)s[n]=o[n](t);return s}}var gF=function(t,e){var n=new Date;return t=+t,e=+e,function(r){return n.setTime(t*(1-r)+e*r),n}},mF=function(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}},yF=function(t,e){var n,r={},i={};for(n in null!==t&&"object"===typeof t||(t={}),null!==e&&"object"===typeof e||(e={}),e)n in t?r[n]=SF(t[n],e[n]):i[n]=e[n];return function(t){for(n in r)i[n]=r[n](t);return i}},vF=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,bF=new RegExp(vF.source,"g");function _F(t){return function(){return t}}function wF(t){return function(e){return t(e)+""}}var xF=function(t,e){var n,r,i,o=vF.lastIndex=bF.lastIndex=0,s=-1,a=[],u=[];t+="",e+="";while((n=vF.exec(t))&&(r=bF.exec(e)))(i=r.index)>o&&(i=e.slice(o,i),a[s]?a[s]+=i:a[++s]=i),(n=n[0])===(r=r[0])?a[s]?a[s]+=r:a[++s]=r:(a[++s]=null,u.push({i:s,x:mF(n,r)})),o=bF.lastIndex;return o<e.length&&(i=e.slice(o),a[s]?a[s]+=i:a[++s]=i),a.length<2?u[0]?wF(u[0].x):_F(e):(e=u.length,function(t){for(var n,r=0;r<e;++r)a[(n=u[r]).i]=n.x(t);return a.join("")})},SF=function(t,e){var n,r=typeof e;return null==e||"boolean"===r?eF(e):("number"===r?mF:"string"===r?(n=Object(KR["e"])(e))?(e=n,aF):xF:e instanceof KR["e"]?aF:e instanceof Date?gF:fF(e)?hF:Array.isArray(e)?pF:"function"!==typeof e.valueOf&&"function"!==typeof e.toString||isNaN(e)?yF:mF)(t,e)},EF=function(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}};function AF(t){return function(){return t}}function MF(t){return+t}var CF=[0,1];function kF(t){return t}function OF(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:AF(isNaN(e)?NaN:.5)}function PF(t,e){var n;return t>e&&(n=t,t=e,e=n),function(n){return Math.max(t,Math.min(e,n))}}function TF(t,e,n){var r=t[0],i=t[1],o=e[0],s=e[1];return i<r?(r=OF(i,r),o=n(s,o)):(r=OF(r,i),o=n(o,s)),function(t){return o(r(t))}}function LF(t,e,n){var r=Math.min(t.length,e.length)-1,i=new Array(r),o=new Array(r),s=-1;t[r]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());while(++s<r)i[s]=OF(t[s],t[s+1]),o[s]=n(e[s],e[s+1]);return function(e){var n=ZR(t,e,1,r)-1;return o[n](i[n](e))}}function IF(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function NF(){var t,e,n,r,i,o,s=CF,a=CF,u=SF,c=kF;function l(){var t=Math.min(s.length,a.length);return c!==kF&&(c=PF(s[0],s[t-1])),r=t>2?LF:TF,i=o=null,h}function h(e){return null==e||isNaN(e=+e)?n:(i||(i=r(s.map(t),a,u)))(t(c(e)))}return h.invert=function(n){return c(e((o||(o=r(a,s.map(t),mF)))(n)))},h.domain=function(t){return arguments.length?(s=Array.from(t,MF),l()):s.slice()},h.range=function(t){return arguments.length?(a=Array.from(t),l()):a.slice()},h.rangeRound=function(t){return a=Array.from(t),u=EF,l()},h.clamp=function(t){return arguments.length?(c=!!t||kF,l()):c!==kF},h.interpolate=function(t){return arguments.length?(u=t,l()):u},h.unknown=function(t){return arguments.length?(n=t,h):n},function(n,r){return t=n,e=r,l()}}function DF(){return NF()(kF,kF)}function RF(t){var e=t.domain;return t.ticks=function(t){var n=e();return DR(n[0],n[n.length-1],null==t?10:t)},t.tickFormat=function(t,n){var r=e();return VR(r[0],r[r.length-1],null==t?10:t,n)},t.nice=function(n){null==n&&(n=10);var r,i,o=e(),s=0,a=o.length-1,u=o[s],c=o[a],l=10;c<u&&(i=u,u=c,c=i,i=s,s=a,a=i);while(l-- >0){if(i=RR(u,c,n),i===r)return o[s]=u,o[a]=c,e(o);if(i>0)u=Math.floor(u/i)*i,c=Math.ceil(c/i)*i;else{if(!(i<0))break;u=Math.ceil(u*i)/i,c=Math.floor(c*i)/i}r=i}return t},t}function FF(){var t=DF();return t.copy=function(){return IF(t,FF())},kR.apply(t,arguments),RF(t)}function BF(t){var e;function n(t){return null==t||isNaN(t=+t)?e:t}return n.invert=n,n.domain=n.range=function(e){return arguments.length?(t=Array.from(e,MF),n):t.slice()},n.unknown=function(t){return arguments.length?(e=t,n):e},n.copy=function(){return BF(t).unknown(e)},t=arguments.length?Array.from(t,MF):[0,1],RF(n)}function jF(t,e){t=t.slice();var n,r=0,i=t.length-1,o=t[r],s=t[i];return s<o&&(n=r,r=i,i=n,n=o,o=s,s=n),t[r]=e.floor(o),t[i]=e.ceil(s),t}function zF(t){return Math.log(t)}function UF(t){return Math.exp(t)}function $F(t){return-Math.log(-t)}function VF(t){return-Math.exp(-t)}function qF(t){return isFinite(t)?+("1e"+t):t<0?0:t}function WF(t){return 10===t?qF:t===Math.E?Math.exp:function(e){return Math.pow(t,e)}}function GF(t){return t===Math.E?Math.log:10===t&&Math.log10||2===t&&Math.log2||(t=Math.log(t),function(e){return Math.log(e)/t})}function HF(t){return function(e){return-t(-e)}}function XF(t){var e,n,r=t(zF,UF),i=r.domain,o=10;function s(){return e=GF(o),n=WF(o),i()[0]<0?(e=HF(e),n=HF(n),t($F,VF)):t(zF,UF),r}return r.base=function(t){return arguments.length?(o=+t,s()):o},r.domain=function(t){return arguments.length?(i(t),s()):i()},r.ticks=function(t){var r,s=i(),a=s[0],u=s[s.length-1];(r=u<a)&&(f=a,a=u,u=f);var c,l,h,f=e(a),d=e(u),p=null==t?10:+t,g=[];if(!(o%1)&&d-f<p){if(f=Math.floor(f),d=Math.ceil(d),a>0){for(;f<=d;++f)for(l=1,c=n(f);l<o;++l)if(h=c*l,!(h<a)){if(h>u)break;g.push(h)}}else for(;f<=d;++f)for(l=o-1,c=n(f);l>=1;--l)if(h=c*l,!(h<a)){if(h>u)break;g.push(h)}2*g.length<p&&(g=DR(a,u,p))}else g=DR(f,d,Math.min(d-f,p)).map(n);return r?g.reverse():g},r.tickFormat=function(t,i){if(null==i&&(i=10===o?".0e":","),"function"!==typeof i&&(i=Object(zR["a"])(i)),t===1/0)return i;null==t&&(t=10);var s=Math.max(1,o*t/r.ticks().length);return function(t){var r=t/n(Math.round(e(t)));return r*o<o-.5&&(r*=o),r<=s?i(t):""}},r.nice=function(){return i(jF(i(),{floor:function(t){return n(Math.floor(e(t)))},ceil:function(t){return n(Math.ceil(e(t)))}}))},r}function YF(){var t=XF(NF()).domain([1,10]);return t.copy=function(){return IF(t,YF()).base(t.base())},kR.apply(t,arguments),t}function ZF(t){return function(e){return e<0?-Math.pow(-e,t):Math.pow(e,t)}}function KF(t){return t<0?-Math.sqrt(-t):Math.sqrt(t)}function JF(t){return t<0?-t*t:t*t}function QF(t){var e=t(kF,kF),n=1;function r(){return 1===n?t(kF,kF):.5===n?t(KF,JF):t(ZF(n),ZF(1/n))}return e.exponent=function(t){return arguments.length?(n=+t,r()):n},RF(e)}function tB(){var t=QF(NF());return t.copy=function(){return IF(t,tB()).exponent(t.exponent())},kR.apply(t,arguments),t}function eB(){return tB.apply(null,arguments).exponent(.5)}function nB(t){return function(e){return Math.sign(e)*Math.log1p(Math.abs(e/t))}}function rB(t){return function(e){return Math.sign(e)*Math.expm1(Math.abs(e))*t}}function iB(t){var e=1,n=t(nB(e),rB(e));return n.constant=function(n){return arguments.length?t(nB(e=+n),rB(e)):e},RF(n)}function oB(){var t=iB(NF());return t.copy=function(){return IF(t,oB()).constant(t.constant())},kR.apply(t,arguments)}var sB=function(t,e){return t<e?-1:t>e?1:t>=e?0:NaN},aB=function(t){let e=t,n=t;function r(t,e,r,i){null==r&&(r=0),null==i&&(i=t.length);while(r<i){const o=r+i>>>1;n(t[o],e)<0?r=o+1:i=o}return r}function i(t,e,r,i){null==r&&(r=0),null==i&&(i=t.length);while(r<i){const o=r+i>>>1;n(t[o],e)>0?i=o:r=o+1}return r}function o(t,n,i,o){null==i&&(i=0),null==o&&(o=t.length);const s=r(t,n,i,o-1);return s>i&&e(t[s-1],n)>-e(t[s],n)?s-1:s}return 1===t.length&&(e=(e,n)=>t(e)-n,n=uB(t)),{left:r,center:o,right:i}};function uB(t){return(e,n)=>sB(t(e),n)}var cB=Math.sqrt(50),lB=Math.sqrt(10),hB=Math.sqrt(2);function fB(t,e,n){var r=Math.abs(e-t)/Math.max(0,n),i=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),o=r/i;return o>=cB?i*=10:o>=lB?i*=5:o>=hB&&(i*=2),e<t?-i:i}var dB=n("1738"),pB=n("1809"),gB=n("5edf"),mB=n("2c38"),yB=n("b3c3"),vB=n("742c"),bB=n("b14c"),_B=n("9603"),wB=n("a15a3"),xB=n("f8ee"),SB=n("f623"),EB=n("6eb2"),AB=n("2739"),MB=n("55f8"),CB=n("77ae4");function kB(t,e,n,r,i,o){const s=[[gB["a"],1,dB["e"]],[gB["a"],5,5*dB["e"]],[gB["a"],15,15*dB["e"]],[gB["a"],30,30*dB["e"]],[o,1,dB["c"]],[o,5,5*dB["c"]],[o,15,15*dB["c"]],[o,30,30*dB["c"]],[i,1,dB["b"]],[i,3,3*dB["b"]],[i,6,6*dB["b"]],[i,12,12*dB["b"]],[r,1,dB["a"]],[r,2,2*dB["a"]],[n,1,dB["f"]],[e,1,dB["d"]],[e,3,3*dB["d"]],[t,1,dB["g"]]];function a(t,e,n){const r=e<t;r&&([t,e]=[e,t]);const i=n&&"function"===typeof n.range?n:u(t,e,n),o=i?i.range(t,+e+1):[];return r?o.reverse():o}function u(e,n,r){const i=Math.abs(n-e)/r,o=aB(([,,t])=>t).right(s,i);if(o===s.length)return t.every(fB(e/dB["g"],n/dB["g"],r));if(0===o)return pB["a"].every(Math.max(fB(e,n,r),1));const[a,u]=s[i/s[o-1][2]<s[o][2]/i?o-1:o];return a.every(u)}return[a,u]}const[OB,PB]=kB(CB["a"],MB["a"],AB["b"],EB["a"],SB["a"],xB["a"]),[TB,LB]=kB(wB["a"],_B["a"],bB["b"],vB["a"],yB["a"],mB["a"]);var IB=n("4c23");function NB(t){return new Date(t)}function DB(t){return t instanceof Date?+t:+new Date(+t)}function RB(t,e,n,r,i,o,s,a,u,c){var l=DF(),h=l.invert,f=l.domain,d=c(".%L"),p=c(":%S"),g=c("%I:%M"),m=c("%I %p"),y=c("%a %d"),v=c("%b %d"),b=c("%B"),_=c("%Y");function w(t){return(u(t)<t?d:a(t)<t?p:s(t)<t?g:o(t)<t?m:r(t)<t?i(t)<t?y:v:n(t)<t?b:_)(t)}return l.invert=function(t){return new Date(h(t))},l.domain=function(t){return arguments.length?f(Array.from(t,DB)):f().map(NB)},l.ticks=function(e){var n=f();return t(n[0],n[n.length-1],null==e?10:e)},l.tickFormat=function(t,e){return null==e?w:c(e)},l.nice=function(t){var n=f();return t&&"function"===typeof t.range||(t=e(n[0],n[n.length-1],null==t?10:t)),t?f(jF(n,t)):l},l.copy=function(){return IF(l,RB(t,e,n,r,i,o,s,a,u,c))},l}function FB(){return kR.apply(RB(TB,LB,wB["a"],_B["a"],bB["b"],vB["a"],yB["a"],mB["a"],gB["a"],IB["a"]).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function BB(){return kR.apply(RB(OB,PB,CB["a"],MB["a"],AB["b"],EB["a"],SB["a"],xB["a"],gB["a"],IB["c"]).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function jB(){var t,e,n,r,i,o=0,s=1,a=kF,u=!1;function c(e){return null==e||isNaN(e=+e)?i:a(0===n?.5:(e=(r(e)-t)*n,u?Math.max(0,Math.min(1,e)):e))}function l(t){return function(e){var n,r;return arguments.length?([n,r]=e,a=t(n,r),c):[a(0),a(1)]}}return c.domain=function(i){return arguments.length?([o,s]=i,t=r(o=+o),e=r(s=+s),n=t===e?0:1/(e-t),c):[o,s]},c.clamp=function(t){return arguments.length?(u=!!t,c):u},c.interpolator=function(t){return arguments.length?(a=t,c):a},c.range=l(SF),c.rangeRound=l(EF),c.unknown=function(t){return arguments.length?(i=t,c):i},function(i){return r=i,t=i(o),e=i(s),n=t===e?0:1/(e-t),c}}function zB(t,e){return e.domain(t.domain()).interpolator(t.interpolator()).clamp(t.clamp()).unknown(t.unknown())}function UB(){var t=RF(jB()(kF));return t.copy=function(){return zB(t,UB())},OR.apply(t,arguments)}function $B(){var t=XF(jB()).domain([1,10]);return t.copy=function(){return zB(t,$B()).base(t.base())},OR.apply(t,arguments)}function VB(){var t=iB(jB());return t.copy=function(){return zB(t,VB()).constant(t.constant())},OR.apply(t,arguments)}function qB(){var t=QF(jB());return t.copy=function(){return zB(t,qB()).exponent(t.exponent())},OR.apply(t,arguments)}function WB(){return qB.apply(null,arguments).exponent(.5)}function GB(t,e){void 0===e&&(e=t,t=SF);var n=0,r=e.length-1,i=e[0],o=new Array(r<0?0:r);while(n<r)o[n]=t(i,i=e[++n]);return function(t){var e=Math.max(0,Math.min(r-1,Math.floor(t*=r)));return o[e](t-e)}}function HB(){var t,e,n,r,i,o,s,a=0,u=.5,c=1,l=1,h=kF,f=!1;function d(t){return isNaN(t=+t)?s:(t=.5+((t=+o(t))-e)*(l*t<l*e?r:i),h(f?Math.max(0,Math.min(1,t)):t))}function p(t){return function(e){var n,r,i;return arguments.length?([n,r,i]=e,h=GB(t,[n,r,i]),d):[h(0),h(.5),h(1)]}}return d.domain=function(s){return arguments.length?([a,u,c]=s,t=o(a=+a),e=o(u=+u),n=o(c=+c),r=t===e?0:.5/(e-t),i=e===n?0:.5/(n-e),l=e<t?-1:1,d):[a,u,c]},d.clamp=function(t){return arguments.length?(f=!!t,d):f},d.interpolator=function(t){return arguments.length?(h=t,d):h},d.range=p(SF),d.rangeRound=p(EF),d.unknown=function(t){return arguments.length?(s=t,d):s},function(s){return o=s,t=s(a),e=s(u),n=s(c),r=t===e?0:.5/(e-t),i=e===n?0:.5/(n-e),l=e<t?-1:1,d}}function XB(){var t=RF(HB()(kF));return t.copy=function(){return zB(t,XB())},OR.apply(t,arguments)}function YB(){var t=XF(HB()).domain([.1,1,10]);return t.copy=function(){return zB(t,YB()).base(t.base())},OR.apply(t,arguments)}function ZB(){var t=iB(HB());return t.copy=function(){return zB(t,ZB()).constant(t.constant())},OR.apply(t,arguments)}function KB(){var t=QF(HB());return t.copy=function(){return zB(t,KB()).exponent(t.exponent())},OR.apply(t,arguments)}function JB(){return KB.apply(null,arguments).exponent(.5)}function QB(t,e,n=HR){if(r=t.length){if((e=+e)<=0||r<2)return+n(t[0],0,t);if(e>=1)return+n(t[r-1],r-1,t);var r,i=(r-1)*e,o=Math.floor(i),s=+n(t[o],o,t),a=+n(t[o+1],o+1,t);return s+(a-s)*(i-o)}}function tj(){var t,e=[],n=[],r=[];function i(){var t=0,i=Math.max(1,n.length);r=new Array(i-1);while(++t<i)r[t-1]=QB(e,t/i);return o}function o(e){return null==e||isNaN(e=+e)?t:n[ZR(r,e)]}return o.invertExtent=function(t){var i=n.indexOf(t);return i<0?[NaN,NaN]:[i>0?r[i-1]:e[0],i<r.length?r[i]:e[e.length-1]]},o.domain=function(t){if(!arguments.length)return e.slice();e=[];for(let n of t)null==n||isNaN(n=+n)||e.push(n);return e.sort(qR),i()},o.range=function(t){return arguments.length?(n=Array.from(t),i()):n.slice()},o.unknown=function(e){return arguments.length?(t=e,o):t},o.quantiles=function(){return r.slice()},o.copy=function(){return tj().domain(e).range(n).unknown(t)},kR.apply(o,arguments)}function ej(){var t,e=0,n=1,r=1,i=[.5],o=[0,1];function s(e){return null!=e&&e<=e?o[ZR(i,e,0,r)]:t}function a(){var t=-1;i=new Array(r);while(++t<r)i[t]=((t+1)*n-(t-r)*e)/(r+1);return s}return s.domain=function(t){return arguments.length?([e,n]=t,e=+e,n=+n,a()):[e,n]},s.range=function(t){return arguments.length?(r=(o=Array.from(t)).length-1,a()):o.slice()},s.invertExtent=function(t){var s=o.indexOf(t);return s<0?[NaN,NaN]:s<1?[e,i[0]]:s>=r?[i[r-1],n]:[i[s-1],i[s]]},s.unknown=function(e){return arguments.length?(t=e,s):s},s.thresholds=function(){return i.slice()},s.copy=function(){return ej().domain([e,n]).range(o).unknown(t)},kR.apply(RF(s),arguments)}function nj(){var t,e=[.5],n=[0,1],r=1;function i(i){return null!=i&&i<=i?n[ZR(e,i,0,r)]:t}return i.domain=function(t){return arguments.length?(e=Array.from(t),r=Math.min(e.length,n.length-1),i):e.slice()},i.range=function(t){return arguments.length?(n=Array.from(t),r=Math.min(e.length,n.length-1),i):n.slice()},i.invertExtent=function(t){var r=n.indexOf(t);return[e[r-1],e[r]]},i.unknown=function(e){return arguments.length?(t=e,i):t},i.copy=function(){return nj().domain(e).range(n).unknown(t)},kR.apply(i,arguments)}var rj,ij=function(t){var e=t.length;return function(n){return t[Math.max(0,Math.min(e-1,Math.floor(n*e)))]}},oj=function(t,e){var n=iF(+t,+e);return function(t){var e=n(t);return e-360*Math.floor(e/360)}},sj=180/Math.PI,aj={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1},uj=function(t,e,n,r,i,o){var s,a,u;return(s=Math.sqrt(t*t+e*e))&&(t/=s,e/=s),(u=t*n+e*r)&&(n-=t*u,r-=e*u),(a=Math.sqrt(n*n+r*r))&&(n/=a,r/=a,u/=a),t*r<e*n&&(t=-t,e=-e,u=-u,s=-s),{translateX:i,translateY:o,rotate:Math.atan2(e,t)*sj,skewX:Math.atan(u)*sj,scaleX:s,scaleY:a}};function cj(t){const e=new("function"===typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?aj:uj(e.a,e.b,e.c,e.d,e.e,e.f)}function lj(t){return null==t?aj:(rj||(rj=document.createElementNS("http://www.w3.org/2000/svg","g")),rj.setAttribute("transform",t),(t=rj.transform.baseVal.consolidate())?(t=t.matrix,uj(t.a,t.b,t.c,t.d,t.e,t.f)):aj)}function hj(t,e,n,r){function i(t){return t.length?t.pop()+" ":""}function o(t,r,i,o,s,a){if(t!==i||r!==o){var u=s.push("translate(",null,e,null,n);a.push({i:u-4,x:mF(t,i)},{i:u-2,x:mF(r,o)})}else(i||o)&&s.push("translate("+i+e+o+n)}function s(t,e,n,o){t!==e?(t-e>180?e+=360:e-t>180&&(t+=360),o.push({i:n.push(i(n)+"rotate(",null,r)-2,x:mF(t,e)})):e&&n.push(i(n)+"rotate("+e+r)}function a(t,e,n,o){t!==e?o.push({i:n.push(i(n)+"skewX(",null,r)-2,x:mF(t,e)}):e&&n.push(i(n)+"skewX("+e+r)}function u(t,e,n,r,o,s){if(t!==n||e!==r){var a=o.push(i(o)+"scale(",null,",",null,")");s.push({i:a-4,x:mF(t,n)},{i:a-2,x:mF(e,r)})}else 1===n&&1===r||o.push(i(o)+"scale("+n+","+r+")")}return function(e,n){var r=[],i=[];return e=t(e),n=t(n),o(e.translateX,e.translateY,n.translateX,n.translateY,r,i),s(e.rotate,n.rotate,r,i),a(e.skewX,n.skewX,r,i),u(e.scaleX,e.scaleY,n.scaleX,n.scaleY,r,i),e=n=null,function(t){var e,n=-1,o=i.length;while(++n<o)r[(e=i[n]).i]=e.x(t);return r.join("")}}}var fj=hj(cj,"px, ","px)","deg)"),dj=hj(lj,", ",")",")"),pj=1e-12;function gj(t){return((t=Math.exp(t))+1/t)/2}function mj(t){return((t=Math.exp(t))-1/t)/2}function yj(t){return((t=Math.exp(2*t))-1)/(t+1)}var vj=function t(e,n,r){function i(t,i){var o,s,a=t[0],u=t[1],c=t[2],l=i[0],h=i[1],f=i[2],d=l-a,p=h-u,g=d*d+p*p;if(g<pj)s=Math.log(f/c)/e,o=function(t){return[a+t*d,u+t*p,c*Math.exp(e*t*s)]};else{var m=Math.sqrt(g),y=(f*f-c*c+r*g)/(2*c*n*m),v=(f*f-c*c-r*g)/(2*f*n*m),b=Math.log(Math.sqrt(y*y+1)-y),_=Math.log(Math.sqrt(v*v+1)-v);s=(_-b)/e,o=function(t){var r=t*s,i=gj(b),o=c/(n*m)*(i*yj(e*r+b)-mj(b));return[a+o*d,u+o*p,c*i/gj(e*r+b)]}}return o.duration=1e3*s*e/Math.SQRT2,o}return i.rho=function(e){var n=Math.max(.001,+e),r=n*n,i=r*r;return t(n,r,i)},i}(Math.SQRT2,2,4);function bj(t){return function(e,n){var r=t((e=Object(KR["f"])(e)).h,(n=Object(KR["f"])(n)).h),i=sF(e.s,n.s),o=sF(e.l,n.l),s=sF(e.opacity,n.opacity);return function(t){return e.h=r(t),e.s=i(t),e.l=o(t),e.opacity=s(t),e+""}}}var _j=bj(iF),wj=bj(sF),xj=n("63ad"),Sj=Math.PI/180,Ej=180/Math.PI,Aj=18,Mj=.96422,Cj=1,kj=.82521,Oj=4/29,Pj=6/29,Tj=3*Pj*Pj,Lj=Pj*Pj*Pj;function Ij(t){if(t instanceof Dj)return new Dj(t.l,t.a,t.b,t.opacity);if(t instanceof $j)return Vj(t);t instanceof KR["b"]||(t=Object(KR["h"])(t));var e,n,r=jj(t.r),i=jj(t.g),o=jj(t.b),s=Rj((.2225045*r+.7168786*i+.0606169*o)/Cj);return r===i&&i===o?e=n=s:(e=Rj((.4360747*r+.3850649*i+.1430804*o)/Mj),n=Rj((.0139322*r+.0971045*i+.7141733*o)/kj)),new Dj(116*s-16,500*(e-s),200*(s-n),t.opacity)}function Nj(t,e,n,r){return 1===arguments.length?Ij(t):new Dj(t,e,n,null==r?1:r)}function Dj(t,e,n,r){this.l=+t,this.a=+e,this.b=+n,this.opacity=+r}function Rj(t){return t>Lj?Math.pow(t,1/3):t/Tj+Oj}function Fj(t){return t>Pj?t*t*t:Tj*(t-Oj)}function Bj(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function jj(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function zj(t){if(t instanceof $j)return new $j(t.h,t.c,t.l,t.opacity);if(t instanceof Dj||(t=Ij(t)),0===t.a&&0===t.b)return new $j(NaN,0<t.l&&t.l<100?0:NaN,t.l,t.opacity);var e=Math.atan2(t.b,t.a)*Ej;return new $j(e<0?e+360:e,Math.sqrt(t.a*t.a+t.b*t.b),t.l,t.opacity)}function Uj(t,e,n,r){return 1===arguments.length?zj(t):new $j(t,e,n,null==r?1:r)}function $j(t,e,n,r){this.h=+t,this.c=+e,this.l=+n,this.opacity=+r}function Vj(t){if(isNaN(t.h))return new Dj(t.l,0,0,t.opacity);var e=t.h*Sj;return new Dj(t.l,Math.cos(e)*t.c,Math.sin(e)*t.c,t.opacity)}function qj(t,e){var n=sF((t=Nj(t)).l,(e=Nj(e)).l),r=sF(t.a,e.a),i=sF(t.b,e.b),o=sF(t.opacity,e.opacity);return function(e){return t.l=n(e),t.a=r(e),t.b=i(e),t.opacity=o(e),t+""}}function Wj(t){return function(e,n){var r=t((e=Uj(e)).h,(n=Uj(n)).h),i=sF(e.c,n.c),o=sF(e.l,n.l),s=sF(e.opacity,n.opacity);return function(t){return e.h=r(t),e.c=i(t),e.l=o(t),e.opacity=s(t),e+""}}}Object(xj["a"])(Dj,Nj,Object(xj["b"])(KR["a"],{brighter:function(t){return new Dj(this.l+Aj*(null==t?1:t),this.a,this.b,this.opacity)},darker:function(t){return new Dj(this.l-Aj*(null==t?1:t),this.a,this.b,this.opacity)},rgb:function(){var t=(this.l+16)/116,e=isNaN(this.a)?t:t+this.a/500,n=isNaN(this.b)?t:t-this.b/200;return e=Mj*Fj(e),t=Cj*Fj(t),n=kj*Fj(n),new KR["b"](Bj(3.1338561*e-1.6168667*t-.4906146*n),Bj(-.9787684*e+1.9161415*t+.033454*n),Bj(.0719453*e-.2289914*t+1.4052427*n),this.opacity)}})),Object(xj["a"])($j,Uj,Object(xj["b"])(KR["a"],{brighter:function(t){return new $j(this.h,this.c,this.l+Aj*(null==t?1:t),this.opacity)},darker:function(t){return new $j(this.h,this.c,this.l-Aj*(null==t?1:t),this.opacity)},rgb:function(){return Vj(this).rgb()}}));var Gj=Wj(iF),Hj=Wj(sF),Xj=-.14861,Yj=1.78277,Zj=-.29227,Kj=-.90649,Jj=1.97294,Qj=Jj*Kj,tz=Jj*Yj,ez=Yj*Zj-Kj*Xj;function nz(t){if(t instanceof iz)return new iz(t.h,t.s,t.l,t.opacity);t instanceof KR["b"]||(t=Object(KR["h"])(t));var e=t.r/255,n=t.g/255,r=t.b/255,i=(ez*r+Qj*e-tz*n)/(ez+Qj-tz),o=r-i,s=(Jj*(n-i)-Zj*o)/Kj,a=Math.sqrt(s*s+o*o)/(Jj*i*(1-i)),u=a?Math.atan2(s,o)*Ej-120:NaN;return new iz(u<0?u+360:u,a,i,t.opacity)}function rz(t,e,n,r){return 1===arguments.length?nz(t):new iz(t,e,n,null==r?1:r)}function iz(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function oz(t){return function e(n){function r(e,r){var i=t((e=rz(e)).h,(r=rz(r)).h),o=sF(e.s,r.s),s=sF(e.l,r.l),a=sF(e.opacity,r.opacity);return function(t){return e.h=i(t),e.s=o(t),e.l=s(Math.pow(t,n)),e.opacity=a(t),e+""}}return n=+n,r.gamma=e,r}(1)}Object(xj["a"])(iz,rz,Object(xj["b"])(KR["a"],{brighter:function(t){return t=null==t?KR["c"]:Math.pow(KR["c"],t),new iz(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?KR["d"]:Math.pow(KR["d"],t),new iz(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=isNaN(this.h)?0:(this.h+120)*Sj,e=+this.l,n=isNaN(this.s)?0:this.s*e*(1-e),r=Math.cos(t),i=Math.sin(t);return new KR["b"](255*(e+n*(Xj*r+Yj*i)),255*(e+n*(Zj*r+Kj*i)),255*(e+n*(Jj*r)),this.opacity)}}));var sz=oz(iF),az=oz(sF),uz=function(t,e){for(var n=new Array(e),r=0;r<e;++r)n[r]=t(r/(e-1));return n};function cz(t,e,n){const r=t-e+2*n;return t?r>0?r:1:0}const lz="identity",hz="linear",fz="log",dz="pow",pz="sqrt",gz="symlog",mz="time",yz="utc",vz="sequential",bz="diverging",_z="quantile",wz="quantize",xz="threshold",Sz="ordinal",Ez="point",Az="band",Mz="bin-ordinal",Cz="continuous",kz="discrete",Oz="discretizing",Pz="interpolating",Tz="temporal";function Lz(t){return function(e){let n,r=e[0],i=e[1];return i<r&&(n=r,r=i,i=n),[t.invert(r),t.invert(i)]}}function Iz(t){return function(e){const n=t.range();let r,i,o,s,a=e[0],u=e[1],c=-1;for(u<a&&(i=a,a=u,u=i),o=0,s=n.length;o<s;++o)n[o]>=a&&n[o]<=u&&(c<0&&(c=o),r=o);if(!(c<0))return a=t.invertExtent(n[c]),u=t.invertExtent(n[r]),[void 0===a[0]?a[1]:a[0],void 0===u[1]?u[0]:u[1]]}}function Nz(){const t=TR().unknown(void 0),e=t.domain,n=t.range;let r,i,o=[0,1],s=!1,a=0,u=0,c=.5;function l(){const t=e().length,l=o[1]<o[0],h=o[1-l],f=cz(t,a,u);let d=o[l-0];r=(h-d)/(f||1),s&&(r=Math.floor(r)),d+=(h-d-r*(t-a))*c,i=r*(1-a),s&&(d=Math.round(d),i=Math.round(i));const p=_R(t).map(t=>d+r*t);return n(l?p.reverse():p)}return delete t.unknown,t.domain=function(t){return arguments.length?(e(t),l()):e()},t.range=function(t){return arguments.length?(o=[+t[0],+t[1]],l()):o.slice()},t.rangeRound=function(t){return o=[+t[0],+t[1]],s=!0,l()},t.bandwidth=function(){return i},t.step=function(){return r},t.round=function(t){return arguments.length?(s=!!t,l()):s},t.padding=function(t){return arguments.length?(u=Math.max(0,Math.min(1,t)),a=u,l()):a},t.paddingInner=function(t){return arguments.length?(a=Math.max(0,Math.min(1,t)),l()):a},t.paddingOuter=function(t){return arguments.length?(u=Math.max(0,Math.min(1,t)),l()):u},t.align=function(t){return arguments.length?(c=Math.max(0,Math.min(1,t)),l()):c},t.invertRange=function(t){if(null==t[0]||null==t[1])return;const r=o[1]<o[0],s=r?n().reverse():n(),a=s.length-1;let u,c,l,h=+t[0],f=+t[1];return h!==h||f!==f||(f<h&&(l=h,h=f,f=l),f<s[0]||h>o[1-r])?void 0:(u=Math.max(0,MR(s,h)-1),c=h===f?u:MR(s,f)-1,h-s[u]>i+1e-10&&++u,r&&(l=u,u=a-c,c=a-l),u>c?void 0:e().slice(u,c+1))},t.invert=function(e){const n=t.invertRange([e,e]);return n?n[0]:n},t.copy=function(){return Nz().domain(e()).range(o).round(s).paddingInner(a).paddingOuter(u).align(c)},l()}function Dz(t){const e=t.copy;return t.padding=t.paddingOuter,delete t.paddingInner,t.copy=function(){return Dz(e())},t}function Rz(){return Dz(Nz().paddingInner(1))}var Fz=Array.prototype.map;function Bz(t){return Fz.call(t,lR)}const jz=Array.prototype.slice;function zz(){let t=[],e=[];function n(n){return null==n||n!==n?void 0:e[(CR(t,n)-1)%e.length]}return n.domain=function(e){return arguments.length?(t=Bz(e),n):t.slice()},n.range=function(t){return arguments.length?(e=jz.call(t),n):e.slice()},n.tickFormat=function(e,n){return VR(t[0],cR(t),null==e?10:e,n)},n.copy=function(){return zz().domain(n.domain()).range(n.range())},n}const Uz={};function $z(t,e,n){const r=function(){const n=e();return n.invertRange||(n.invertRange=n.invert?Lz(n):n.invertExtent?Iz(n):void 0),n.type=t,n};return r.metadata=bR(hR(n)),r}function Vz(t,e,n){return arguments.length>1?(Uz[t]=$z(t,e,n),this):qz(t)?Uz[t]:void 0}function qz(t){return gR(Uz,t)}function Wz(t,e){const n=Uz[t];return n&&n.metadata[e]}function Gz(t){return Wz(t,Cz)}function Hz(t){return Wz(t,kz)}function Xz(t){return Wz(t,Oz)}function Yz(t){return Wz(t,fz)}function Zz(t){return Wz(t,Tz)}function Kz(t){return Wz(t,Pz)}function Jz(t){return Wz(t,_z)}Vz(lz,BF),Vz(hz,FF,Cz),Vz(fz,YF,[Cz,fz]),Vz(dz,tB,Cz),Vz(pz,eB,Cz),Vz(gz,oB,Cz),Vz(mz,FB,[Cz,Tz]),Vz(yz,BB,[Cz,Tz]),Vz(vz,UB,[Cz,Pz]),Vz("".concat(vz,"-").concat(hz),UB,[Cz,Pz]),Vz("".concat(vz,"-").concat(fz),$B,[Cz,Pz,fz]),Vz("".concat(vz,"-").concat(dz),qB,[Cz,Pz]),Vz("".concat(vz,"-").concat(pz),WB,[Cz,Pz]),Vz("".concat(vz,"-").concat(gz),VB,[Cz,Pz]),Vz("".concat(bz,"-").concat(hz),XB,[Cz,Pz]),Vz("".concat(bz,"-").concat(fz),YB,[Cz,Pz,fz]),Vz("".concat(bz,"-").concat(dz),KB,[Cz,Pz]),Vz("".concat(bz,"-").concat(pz),JB,[Cz,Pz]),Vz("".concat(bz,"-").concat(gz),ZB,[Cz,Pz]),Vz(_z,tj,[Oz,_z]),Vz(wz,ej,Oz),Vz(xz,nj,Oz),Vz(Mz,zz,[kz,Oz]),Vz(Sz,TR,kz),Vz(Az,Nz,kz),Vz(Ez,Rz,kz);const Qz=["clamp","base","constant","exponent"];function tU(t,e){const n=e[0],r=cR(e)-n;return function(e){return t(n+e*r)}}function eU(t,e,n){return GB(iU(e||"rgb",n),t)}function nU(t,e){const n=new Array(e),r=e+1;for(let i=0;i<e;)n[i]=t(++i/r);return n}function rU(t,e,n){const r=n-e;let i,o,s;return r&&Number.isFinite(r)?(i=(o=t.type).indexOf("-"),o=i<0?o:o.slice(i+1),s=Vz(o)().domain([e,n]).range([0,1]),Qz.forEach(e=>t[e]?s[e](t[e]()):0),s):dR(.5)}function iU(t,e){const n=a[oU(t)];return null!=e&&n&&n.gamma?n.gamma(e):n}function oU(t){return"interpolate"+t.toLowerCase().split("-").map(t=>t[0].toUpperCase()+t.slice(1)).join("")}const sU={blues:"cfe1f2bed8eca8cee58fc1de74b2d75ba3cf4592c63181bd206fb2125ca40a4a90",greens:"d3eecdc0e6baabdda594d3917bc77d60ba6c46ab5e329a512089430e7735036429",greys:"e2e2e2d4d4d4c4c4c4b1b1b19d9d9d8888887575756262624d4d4d3535351e1e1e",oranges:"fdd8b3fdc998fdb87bfda55efc9244f87f2cf06b18e4580bd14904b93d029f3303",purples:"e2e1efd4d4e8c4c5e0b4b3d6a3a0cc928ec3827cb97566ae684ea25c3696501f8c",reds:"fdc9b4fcb49afc9e80fc8767fa7051f6573fec3f2fdc2a25c81b1db21218970b13",blueGreen:"d5efedc1e8e0a7ddd18bd2be70c6a958ba9144ad77319c5d2089460e7736036429",bluePurple:"ccddecbad0e4a8c2dd9ab0d4919cc98d85be8b6db28a55a6873c99822287730f71",greenBlue:"d3eecec5e8c3b1e1bb9bd8bb82cec269c2ca51b2cd3c9fc7288abd1675b10b60a1",orangeRed:"fddcaffdcf9bfdc18afdad77fb9562f67d53ee6545e24932d32d1ebf130da70403",purpleBlue:"dbdaebc8cee4b1c3de97b7d87bacd15b9fc93a90c01e7fb70b70ab056199045281",purpleBlueGreen:"dbd8eac8cee4b0c3de93b7d872acd1549fc83892bb1c88a3097f8702736b016353",purpleRed:"dcc9e2d3b3d7ce9eccd186c0da6bb2e14da0e23189d91e6fc61159ab07498f023a",redPurple:"fccfccfcbec0faa9b8f98faff571a5ec539ddb3695c41b8aa908808d0179700174",yellowGreen:"e4f4acd1eca0b9e2949ed68880c97c62bb6e47aa5e3297502083440e723b036034",yellowOrangeBrown:"feeaa1fedd84fecc63feb746fca031f68921eb7215db5e0bc54c05ab3d038f3204",yellowOrangeRed:"fee087fed16ffebd59fea849fd903efc7335f9522bee3423de1b20ca0b22af0225",blueOrange:"134b852f78b35da2cb9dcae1d2e5eff2f0ebfce0bafbbf74e8932fc5690d994a07",brownBlueGreen:"704108a0651ac79548e3c78af3e6c6eef1eac9e9e48ed1c74da79e187a72025147",purpleGreen:"5b1667834792a67fb6c9aed3e6d6e8eff0efd9efd5aedda971bb75368e490e5e29",purpleOrange:"4114696647968f83b7b9b4d6dadbebf3eeeafce0bafbbf74e8932fc5690d994a07",redBlue:"8c0d25bf363adf745ef4ae91fbdbc9f2efeed2e5ef9dcae15da2cb2f78b3134b85",redGrey:"8c0d25bf363adf745ef4ae91fcdccbfaf4f1e2e2e2c0c0c0969696646464343434",yellowGreenBlue:"eff9bddbf1b4bde5b594d5b969c5be45b4c22c9ec02182b82163aa23479c1c3185",redYellowBlue:"a50026d4322cf16e43fcac64fedd90faf8c1dcf1ecabd6e875abd04a74b4313695",redYellowGreen:"a50026d4322cf16e43fcac63fedd8df9f7aed7ee8ea4d86e64bc6122964f006837",pinkYellowGreen:"8e0152c0267edd72adf0b3d6faddedf5f3efe1f2cab6de8780bb474f9125276419",spectral:"9e0142d13c4bf0704afcac63fedd8dfbf8b0e0f3a1a9dda269bda94288b55e4fa2",viridis:"440154470e61481a6c482575472f7d443a834144873d4e8a39568c35608d31688e2d708e2a788e27818e23888e21918d1f988b1fa08822a8842ab07f35b77943bf7154c56866cc5d7ad1518fd744a5db36bcdf27d2e21be9e51afde725",magma:"0000040404130b0924150e3720114b2c11603b0f704a107957157e651a80721f817f24828c29819a2e80a8327db6377ac43c75d1426fde4968e95462f1605df76f5cfa7f5efc8f65fe9f6dfeaf78febf84fece91fddea0fcedaffcfdbf",inferno:"0000040403130c0826170c3b240c4f330a5f420a68500d6c5d126e6b176e781c6d86216b932667a12b62ae305cbb3755c73e4cd24644dd513ae65c30ed6925f3771af8850ffb9506fca50afcb519fac62df6d645f2e661f3f484fcffa4",plasma:"0d088723069033059742039d5002a25d01a66a00a87801a88405a7900da49c179ea72198b12a90ba3488c33d80cb4779d35171da5a69e16462e76e5bed7953f2834cf68f44fa9a3dfca636fdb32ffec029fcce25f9dc24f5ea27f0f921",cividis:"00205100235800265d002961012b65042e670831690d346b11366c16396d1c3c6e213f6e26426e2c456e31476e374a6e3c4d6e42506e47536d4c566d51586e555b6e5a5e6e5e616e62646f66676f6a6a706e6d717270717573727976737c79747f7c75827f758682768985778c8877908b78938e789691789a94789e9778a19b78a59e77a9a177aea575b2a874b6ab73bbaf71c0b26fc5b66dc9b96acebd68d3c065d8c462ddc85fe2cb5ce7cf58ebd355f0d652f3da4ff7de4cfae249fce647",rainbow:"6e40aa883eb1a43db3bf3cafd83fa4ee4395fe4b83ff576eff6659ff7847ff8c38f3a130e2b72fcfcc36bee044aff05b8ff4576ff65b52f6673af27828ea8d1ddfa319d0b81cbecb23abd82f96e03d82e14c6edb5a5dd0664dbf6e40aa",sinebow:"ff4040fc582af47218e78d0bd5a703bfbf00a7d5038de70b72f41858fc2a40ff402afc5818f4720be78d03d5a700bfbf03a7d50b8de71872f42a58fc4040ff582afc7218f48d0be7a703d5bf00bfd503a7e70b8df41872fc2a58ff4040",turbo:"23171b32204a3e2a71453493493eae4b49c54a53d7485ee44569ee4074f53c7ff8378af93295f72e9ff42ba9ef28b3e926bce125c5d925cdcf27d5c629dcbc2de3b232e9a738ee9d3ff39347f68950f9805afc7765fd6e70fe667cfd5e88fc5795fb51a1f84badf545b9f140c5ec3cd0e637dae034e4d931ecd12ef4c92bfac029ffb626ffad24ffa223ff9821ff8d1fff821dff771cfd6c1af76118f05616e84b14df4111d5380fcb2f0dc0260ab61f07ac1805a313029b0f00950c00910b00",browns:"eedbbdecca96e9b97ae4a865dc9856d18954c7784cc0673fb85536ad44339f3632",tealBlues:"bce4d89dd3d181c3cb65b3c245a2b9368fae347da0306a932c5985",teals:"bbdfdfa2d4d58ac9c975bcbb61b0af4da5a43799982b8b8c1e7f7f127273006667",warmGreys:"dcd4d0cec5c1c0b8b4b3aaa7a59c9998908c8b827f7e7673726866665c5a59504e",goldGreen:"f4d166d5ca60b6c35c98bb597cb25760a6564b9c533f8f4f33834a257740146c36",goldOrange:"f4d166f8be5cf8aa4cf5983bf3852aef701be2621fd65322c54923b142239e3a26",goldRed:"f4d166f6be59f9aa51fc964ef6834bee734ae56249db5247cf4244c43141b71d3e",lightGreyRed:"efe9e6e1dad7d5cbc8c8bdb9bbaea9cd967ddc7b43e15f19df4011dc000b",lightGreyTeal:"e4eaead6dcddc8ced2b7c2c7a6b4bc64b0bf22a6c32295c11f85be1876bc",lightMulti:"e0f1f2c4e9d0b0de9fd0e181f6e072f6c053f3993ef77440ef4a3c",lightOrange:"f2e7daf7d5baf9c499fab184fa9c73f68967ef7860e8645bde515bd43d5b",lightTealBlue:"e3e9e0c0dccf9aceca7abfc859afc0389fb9328dad2f7ca0276b95255988",darkBlue:"3232322d46681a5c930074af008cbf05a7ce25c0dd38daed50f3faffffff",darkGold:"3c3c3c584b37725e348c7631ae8b2bcfa424ecc31ef9de30fff184ffffff",darkGreen:"3a3a3a215748006f4d048942489e4276b340a6c63dd2d836ffeb2cffffaa",darkMulti:"3737371f5287197d8c29a86995ce3fffe800ffffff",darkRed:"3434347036339e3c38cc4037e75d1eec8620eeab29f0ce32ffeb2c"},aU={category10:"1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf",category20:"1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5",category20b:"393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6",category20c:"3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9",tableau10:"4c78a8f58518e4575672b7b254a24beeca3bb279a2ff9da69d755dbab0ac",tableau20:"4c78a89ecae9f58518ffbf7954a24b88d27ab79a20f2cf5b43989483bcb6e45756ff9d9879706ebab0acd67195fcbfd2b279a2d6a5c99e765fd8b5a5",accent:"7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666",dark2:"1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666",paired:"a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928",pastel1:"fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2",pastel2:"b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc",set1:"e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999",set2:"66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3",set3:"8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"};function uU(t){const e=t.length/6|0,n=new Array(e);for(let r=0;r<e;)n[r]="#"+t.slice(6*r,6*++r);return n}function cU(t,e){for(const n in t)hU(n,e(t[n]))}const lU={};function hU(t,e){return t=t&&t.toLowerCase(),arguments.length>1?(lU[t]=e,this):lU[t]}cU(aU,uU),cU(sU,t=>eU(uU(t)));const fU="symbol",dU="discrete",pU="gradient",gU=t=>aR(t)?t.map(t=>String(t)):String(t),mU=(t,e)=>t[1]-e[1],yU=(t,e)=>e[1]-t[1];function vU(t,e,n){let r;return mR(e)&&(t.bins&&(e=Math.max(e,t.bins.length)),null!=n&&(e=Math.min(e,Math.floor(vR(t.domain())/n||1)))),uR(e)&&(r=e.step,e=e.interval),yR(e)&&(e=t.type===mz?Object(uL["p"])(e):t.type==yz?Object(uL["v"])(e):iR("Only time and utc scales accept interval strings."),r&&(e=e.every(r))),e}function bU(t,e,n){let r=t.range(),i=r[0],o=cR(r),s=mU;if(i>o&&(r=o,o=i,i=r,s=yU),i=Math.floor(i),o=Math.ceil(o),e=e.map(e=>[e,t(e)]).filter(t=>i<=t[1]&&t[1]<=o).sort(s).map(t=>t[0]),n>0&&e.length>1){const t=[e[0],cR(e)];while(e.length>n&&e.length>=3)e=e.filter((t,e)=>!(e%2));e.length<3&&(e=t)}return e}function _U(t,e){return t.bins?bU(t,t.bins):t.ticks?t.ticks(e):t.domain()}function wU(t,e,n,r,i,o){const s=e.type;let a=gU;if(s===mz||i===mz)a=t.timeFormat(r);else if(s===yz||i===yz)a=t.utcFormat(r);else if(Yz(s)){const i=t.formatFloat(r);if(o||e.bins)a=i;else{const t=xU(e,n,!1);a=e=>t(e)?i(e):""}}else if(e.tickFormat){const i=e.domain();a=t.formatSpan(i[0],i[i.length-1],n,r)}else r&&(a=t.format(r));return a}function xU(t,e,n){const r=_U(t,e),i=t.base(),o=Math.log(i),s=Math.max(1,i*e/r.length),a=t=>{let e=t/Math.pow(i,Math.round(Math.log(t)/o));return e*i<i-.5&&(e*=i),e<=s};return n?r.filter(a):a}const SU={[_z]:"quantiles",[wz]:"thresholds",[xz]:"domain"},EU={[_z]:"quantiles",[wz]:"domain"};function AU(t,e){return t.bins?kU(t.bins):t.type===fz?xU(t,e,!0):SU[t.type]?CU(t[SU[t.type]]()):_U(t,e)}function MU(t,e,n){const r=e[EU[e.type]](),i=r.length;let o,s=i>1?r[1]-r[0]:r[0];for(o=1;o<i;++o)s=Math.min(s,r[o]-r[o-1]);return t.formatSpan(0,s,30,n)}function CU(t){const e=[-1/0].concat(t);return e.max=1/0,e}function kU(t){const e=t.slice(0,-1);return e.max=cR(t),e}const OU=t=>SU[t.type]||t.bins;function PU(t,e,n,r,i,o,s){const a=EU[e.type]&&o!==mz&&o!==yz?MU(t,e,i):wU(t,e,n,i,o,s);return r===fU&&OU(e)?TU(a):r===dU?IU(a):NU(a)}const TU=t=>(e,n,r)=>{const i=LU(r[n+1],LU(r.max,1/0)),o=DU(e,t),s=DU(i,t);return o&&s?o+" – "+s:s?"< "+s:"≥ "+o},LU=(t,e)=>null!=t?t:e,IU=t=>(e,n)=>n?t(e):null,NU=t=>e=>t(e),DU=(t,e)=>Number.isFinite(t)?e(t):null;function RU(t){const e=t.domain(),n=e.length-1;let r=+e[0],i=+cR(e),o=i-r;if(t.type===xz){const t=n?o/n:.1;r-=t,i+=t,o=i-r}return t=>(t-r)/o}function FU(t,e,n,r){const i=r||e.type;return yR(n)&&Zz(i)&&(n=n.replace(/%a/g,"%A").replace(/%b/g,"%B")),n||i!==mz?n||i!==yz?PU(t,e,5,null,n,r,!0):t.utcFormat("%A, %d %B %Y, %X UTC"):t.timeFormat("%A, %d %B %Y, %X")}function BU(t,e,n){n=n||{};const r=Math.max(3,n.maxlen||7),i=FU(t,e,n.format,n.formatType);if(Xz(e.type)){const t=AU(e).slice(1).map(i),n=t.length;return"".concat(n," boundar").concat(1===n?"y":"ies",": ").concat(t.join(", "))}if(Hz(e.type)){const t=e.domain(),n=t.length,o=n>r?t.slice(0,r-2).map(i).join(", ")+", ending with "+t.slice(-1).map(i):t.map(i).join(", ");return"".concat(n," value").concat(1===n?"":"s",": ").concat(o)}{const t=e.domain();return"values from ".concat(i(t[0])," to ").concat(i(cR(t)))}}let jU=0;function zU(){jU=0}const UU="p_";function $U(t){return t&&t.gradient}function VU(t,e,n){const r=t.gradient;let i=t.id,o="radial"===r?UU:"";return i||(i=t.id="gradient_"+jU++,"radial"===r?(t.x1=qU(t.x1,.5),t.y1=qU(t.y1,.5),t.r1=qU(t.r1,0),t.x2=qU(t.x2,.5),t.y2=qU(t.y2,.5),t.r2=qU(t.r2,.5),o=UU):(t.x1=qU(t.x1,0),t.y1=qU(t.y1,0),t.x2=qU(t.x2,1),t.y2=qU(t.y2,0))),e[i]=t,"url("+(n||"")+"#"+o+i+")"}function qU(t,e){return null!=t?t:e}function WU(t,e){var n,r=[];return n={gradient:"linear",x1:t?t[0]:0,y1:t?t[1]:0,x2:e?e[0]:1,y2:e?e[1]:0,stops:r,stop:function(t,e){return r.push({offset:t,color:e}),n}}}const GU={basis:{curve:CN},"basis-closed":{curve:PN},"basis-open":{curve:LN},bundle:{curve:NN,tension:"beta",value:.85},cardinal:{curve:FN,tension:"tension",value:0},"cardinal-open":{curve:jN,tension:"tension",value:0},"cardinal-closed":{curve:UN,tension:"tension",value:0},"catmull-rom":{curve:rD,tension:"alpha",value:.5},"catmull-rom-closed":{curve:oD,tension:"alpha",value:.5},"catmull-rom-open":{curve:aD,tension:"alpha",value:.5},linear:{curve:cD},"linear-closed":{curve:hD},monotone:{horizontal:_D,vertical:bD},natural:{curve:SD},step:{curve:AD},"step-after":{curve:CD},"step-before":{curve:MD}};function HU(t,e,n){var r=bN(GU,t)&&GU[t],i=null;return r&&(i=r.curve||r[e||"vertical"],r.tension&&null!=n&&(i=i[r.tension](n))),i}const XU={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},YU=[/([MLHVCSQTAZmlhvcsqtaz])/g,/###/,/(\.\d+)(\.\d)/g,/(\d)([-+])/g,/\s|,|###/];function ZU(t){const e=[];let n,r,i,o,s,a,u,c,l,h;const f=t.slice().replace(YU[0],"###$1").split(YU[1]).slice(1);for(u=0,l=f.length;u<l;++u){for(n=f[u],r=n.slice(1).trim().replace(YU[2],"$1###$2").replace(YU[3],"$1###$2").split(YU[4]),s=n.charAt(0),i=[s],c=0,h=r.length;c<h;++c)(o=+r[c])===o&&i.push(o);if(a=XU[s.toLowerCase()],i.length-1>a){const t=i.length;for(c=1,e.push([s].concat(i.slice(c,c+=a))),s="M"===s?"L":"m"===s?"l":s;c<t;c+=a)e.push([s].concat(i.slice(c,c+a)))}else e.push(i)}return e}const KU=Math.PI/180,JU=1e-14,QU=Math.PI/2,t$=2*Math.PI,e$=Math.sqrt(3)/2;var n$={},r$={},i$=[].join;function o$(t,e,n,r,i,o,s,a,u){const c=i$.call(arguments);if(n$[c])return n$[c];const l=s*KU,h=Math.sin(l),f=Math.cos(l);n=Math.abs(n),r=Math.abs(r);const d=f*(a-t)*.5+h*(u-e)*.5,p=f*(u-e)*.5-h*(a-t)*.5;let g=d*d/(n*n)+p*p/(r*r);g>1&&(g=Math.sqrt(g),n*=g,r*=g);const m=f/n,y=h/n,v=-h/r,b=f/r,_=m*a+y*u,w=v*a+b*u,x=m*t+y*e,S=v*t+b*e,E=(x-_)*(x-_)+(S-w)*(S-w);let A=1/E-.25;A<0&&(A=0);let M=Math.sqrt(A);o==i&&(M=-M);const C=.5*(_+x)-M*(S-w),k=.5*(w+S)+M*(x-_),O=Math.atan2(w-k,_-C),P=Math.atan2(S-k,x-C);let T=P-O;T<0&&1===o?T+=t$:T>0&&0===o&&(T-=t$);const L=Math.ceil(Math.abs(T/(QU+.001))),I=[];for(let N=0;N<L;++N){const t=O+N*T/L,e=O+(N+1)*T/L;I[N]=[C,k,t,e,n,r,h,f]}return n$[c]=I}function s$(t){const e=i$.call(t);if(r$[e])return r$[e];var n=t[0],r=t[1],i=t[2],o=t[3],s=t[4],a=t[5],u=t[6],c=t[7];const l=c*s,h=-u*a,f=u*s,d=c*a,p=Math.cos(i),g=Math.sin(i),m=Math.cos(o),y=Math.sin(o),v=.5*(o-i),b=Math.sin(.5*v),_=8/3*b*b/Math.sin(v),w=n+p-_*g,x=r+g+_*p,S=n+m,E=r+y,A=S+_*y,M=E-_*m;return r$[e]=[l*w+h*x,f*w+d*x,l*A+h*M,f*A+d*M,l*S+h*E,f*S+d*E]}const a$=["l",0,0,0,0,0,0,0];function u$(t,e,n){const r=a$[0]=t[0];if("a"===r||"A"===r)a$[1]=e*t[1],a$[2]=n*t[2],a$[3]=t[3],a$[4]=t[4],a$[5]=t[5],a$[6]=e*t[6],a$[7]=n*t[7];else if("h"===r||"H"===r)a$[1]=e*t[1];else if("v"===r||"V"===r)a$[1]=n*t[1];else for(var i=1,o=t.length;i<o;++i)a$[i]=(i%2==1?e:n)*t[i];return a$}function c$(t,e,n,r,i,o){var s,a,u,c,l,h=null,f=0,d=0,p=0,g=0;null==n&&(n=0),null==r&&(r=0),null==i&&(i=1),null==o&&(o=i),t.beginPath&&t.beginPath();for(var m=0,y=e.length;m<y;++m){switch(s=e[m],1===i&&1===o||(s=u$(s,i,o)),s[0]){case"l":f+=s[1],d+=s[2],t.lineTo(f+n,d+r);break;case"L":f=s[1],d=s[2],t.lineTo(f+n,d+r);break;case"h":f+=s[1],t.lineTo(f+n,d+r);break;case"H":f=s[1],t.lineTo(f+n,d+r);break;case"v":d+=s[1],t.lineTo(f+n,d+r);break;case"V":d=s[1],t.lineTo(f+n,d+r);break;case"m":f+=s[1],d+=s[2],t.moveTo(f+n,d+r);break;case"M":f=s[1],d=s[2],t.moveTo(f+n,d+r);break;case"c":a=f+s[5],u=d+s[6],p=f+s[3],g=d+s[4],t.bezierCurveTo(f+s[1]+n,d+s[2]+r,p+n,g+r,a+n,u+r),f=a,d=u;break;case"C":f=s[5],d=s[6],p=s[3],g=s[4],t.bezierCurveTo(s[1]+n,s[2]+r,p+n,g+r,f+n,d+r);break;case"s":a=f+s[3],u=d+s[4],p=2*f-p,g=2*d-g,t.bezierCurveTo(p+n,g+r,f+s[1]+n,d+s[2]+r,a+n,u+r),p=f+s[1],g=d+s[2],f=a,d=u;break;case"S":a=s[3],u=s[4],p=2*f-p,g=2*d-g,t.bezierCurveTo(p+n,g+r,s[1]+n,s[2]+r,a+n,u+r),f=a,d=u,p=s[1],g=s[2];break;case"q":a=f+s[3],u=d+s[4],p=f+s[1],g=d+s[2],t.quadraticCurveTo(p+n,g+r,a+n,u+r),f=a,d=u;break;case"Q":a=s[3],u=s[4],t.quadraticCurveTo(s[1]+n,s[2]+r,a+n,u+r),f=a,d=u,p=s[1],g=s[2];break;case"t":a=f+s[1],u=d+s[2],null===h[0].match(/[QqTt]/)?(p=f,g=d):"t"===h[0]?(p=2*f-c,g=2*d-l):"q"===h[0]&&(p=2*f-p,g=2*d-g),c=p,l=g,t.quadraticCurveTo(p+n,g+r,a+n,u+r),f=a,d=u,p=f+s[1],g=d+s[2];break;case"T":a=s[1],u=s[2],p=2*f-p,g=2*d-g,t.quadraticCurveTo(p+n,g+r,a+n,u+r),f=a,d=u;break;case"a":l$(t,f+n,d+r,[s[1],s[2],s[3],s[4],s[5],s[6]+f+n,s[7]+d+r]),f+=s[6],d+=s[7];break;case"A":l$(t,f+n,d+r,[s[1],s[2],s[3],s[4],s[5],s[6]+n,s[7]+r]),f=s[6],d=s[7];break;case"z":case"Z":t.closePath();break}h=s}}function l$(t,e,n,r){const i=o$(r[5],r[6],r[0],r[1],r[3],r[4],r[2],e,n);for(let o=0;o<i.length;++o){const e=s$(i[o]);t.bezierCurveTo(e[0],e[1],e[2],e[3],e[4],e[5])}}const h$=.5773502691896257,f$={circle:{draw:function(t,e){const n=Math.sqrt(e)/2;t.moveTo(n,0),t.arc(0,0,n,0,t$)}},cross:{draw:function(t,e){var n=Math.sqrt(e)/2,r=n/2.5;t.moveTo(-n,-r),t.lineTo(-n,r),t.lineTo(-r,r),t.lineTo(-r,n),t.lineTo(r,n),t.lineTo(r,r),t.lineTo(n,r),t.lineTo(n,-r),t.lineTo(r,-r),t.lineTo(r,-n),t.lineTo(-r,-n),t.lineTo(-r,-r),t.closePath()}},diamond:{draw:function(t,e){const n=Math.sqrt(e)/2;t.moveTo(-n,0),t.lineTo(0,-n),t.lineTo(n,0),t.lineTo(0,n),t.closePath()}},square:{draw:function(t,e){var n=Math.sqrt(e),r=-n/2;t.rect(r,r,n,n)}},arrow:{draw:function(t,e){var n=Math.sqrt(e)/2,r=n/7,i=n/2.5,o=n/8;t.moveTo(-r,n),t.lineTo(r,n),t.lineTo(r,-o),t.lineTo(i,-o),t.lineTo(0,-n),t.lineTo(-i,-o),t.lineTo(-r,-o),t.closePath()}},wedge:{draw:function(t,e){var n=Math.sqrt(e)/2,r=e$*n,i=r-n*h$,o=n/4;t.moveTo(0,-r-i),t.lineTo(-o,r-i),t.lineTo(o,r-i),t.closePath()}},triangle:{draw:function(t,e){var n=Math.sqrt(e)/2,r=e$*n,i=r-n*h$;t.moveTo(0,-r-i),t.lineTo(-n,r-i),t.lineTo(n,r-i),t.closePath()}},"triangle-up":{draw:function(t,e){var n=Math.sqrt(e)/2,r=e$*n;t.moveTo(0,-r),t.lineTo(-n,r),t.lineTo(n,r),t.closePath()}},"triangle-down":{draw:function(t,e){var n=Math.sqrt(e)/2,r=e$*n;t.moveTo(0,r),t.lineTo(-n,-r),t.lineTo(n,-r),t.closePath()}},"triangle-right":{draw:function(t,e){var n=Math.sqrt(e)/2,r=e$*n;t.moveTo(r,0),t.lineTo(-r,-n),t.lineTo(-r,n),t.closePath()}},"triangle-left":{draw:function(t,e){var n=Math.sqrt(e)/2,r=e$*n;t.moveTo(-r,0),t.lineTo(r,-n),t.lineTo(r,n),t.closePath()}},stroke:{draw:function(t,e){const n=Math.sqrt(e)/2;t.moveTo(-n,0),t.lineTo(n,0)}}};function d$(t){return bN(f$,t)?f$[t]:g$(t)}var p$={};function g$(t){if(!bN(p$,t)){const e=ZU(t);p$[t]={draw:function(t,n){c$(t,e,0,0,Math.sqrt(n)/2)}}}return p$[t]}const m$=.448084975506;function y$(t){return t.x}function v$(t){return t.y}function b$(t){return t.width}function _$(t){return t.height}function w$(t){return"function"===typeof t?t:()=>+t}function x$(t,e,n){return Math.max(e,Math.min(t,n))}function S$(){var t=y$,e=v$,n=b$,r=_$,i=w$(0),o=i,s=i,a=i,u=null;function c(c,l,h){var f,d=null!=l?l:+t.call(this,c),p=null!=h?h:+e.call(this,c),g=+n.call(this,c),m=+r.call(this,c),y=Math.min(g,m)/2,v=x$(+i.call(this,c),0,y),b=x$(+o.call(this,c),0,y),_=x$(+s.call(this,c),0,y),w=x$(+a.call(this,c),0,y);if(u||(u=f=ND()),v<=0&&b<=0&&_<=0&&w<=0)u.rect(d,p,g,m);else{var x=d+g,S=p+m;u.moveTo(d+v,p),u.lineTo(x-b,p),u.bezierCurveTo(x-m$*b,p,x,p+m$*b,x,p+b),u.lineTo(x,S-w),u.bezierCurveTo(x,S-m$*w,x-m$*w,S,x-w,S),u.lineTo(d+_,S),u.bezierCurveTo(d+m$*_,S,d,S-m$*_,d,S-_),u.lineTo(d,p+v),u.bezierCurveTo(d,p+m$*v,d+m$*v,p,d+v,p),u.closePath()}if(f)return u=null,f+""||null}return c.x=function(e){return arguments.length?(t=w$(e),c):t},c.y=function(t){return arguments.length?(e=w$(t),c):e},c.width=function(t){return arguments.length?(n=w$(t),c):n},c.height=function(t){return arguments.length?(r=w$(t),c):r},c.cornerRadius=function(t,e,n,r){return arguments.length?(i=w$(t),o=null!=e?w$(e):i,a=null!=n?w$(n):i,s=null!=r?w$(r):o,c):i},c.context=function(t){return arguments.length?(u=null==t?null:t,c):u},c}function E$(){var t,e,n,r,i,o,s,a,u=null;function c(t,e,n){const r=n/2;if(i){var c=s-e,l=t-o;if(c||l){var h=Math.sqrt(c*c+l*l),f=(c/=h)*a,d=(l/=h)*a,p=Math.atan2(l,c);u.moveTo(o-f,s-d),u.lineTo(t-c*r,e-l*r),u.arc(t,e,r,p-Math.PI,p),u.lineTo(o+f,s+d),u.arc(o,s,a,p,p+Math.PI)}else u.arc(t,e,r,0,t$);u.closePath()}else i=1;o=t,s=e,a=r}function l(o){var s,a,l,h=o.length,f=!1;for(null==u&&(u=l=ND()),s=0;s<=h;++s)!(s<h&&r(a=o[s],s,o))===f&&(f=!f)&&(i=0),f&&c(+t(a,s,o),+e(a,s,o),+n(a,s,o));if(l)return u=null,l+""||null}return l.x=function(e){return arguments.length?(t=e,l):t},l.y=function(t){return arguments.length?(e=t,l):e},l.size=function(t){return arguments.length?(n=t,l):n},l.defined=function(t){return arguments.length?(r=t,l):r},l.context=function(t){return arguments.length?(u=null==t?null:t,l):u},l}function A$(t,e){return null!=t?t:e}const M$=t=>t.x||0,C$=t=>t.y||0,k$=t=>t.width||0,O$=t=>t.height||0,P$=t=>(t.x||0)+(t.width||0),T$=t=>(t.y||0)+(t.height||0),L$=t=>t.startAngle||0,I$=t=>t.endAngle||0,N$=t=>t.padAngle||0,D$=t=>t.innerRadius||0,R$=t=>t.outerRadius||0,F$=t=>t.cornerRadius||0,B$=t=>A$(t.cornerRadiusTopLeft,t.cornerRadius)||0,j$=t=>A$(t.cornerRadiusTopRight,t.cornerRadius)||0,z$=t=>A$(t.cornerRadiusBottomRight,t.cornerRadius)||0,U$=t=>A$(t.cornerRadiusBottomLeft,t.cornerRadius)||0,$$=t=>A$(t.size,64),V$=t=>t.size||1,q$=t=>!(!1===t.defined),W$=t=>d$(t.shape||"circle"),G$=VD().startAngle(L$).endAngle(I$).padAngle(N$).innerRadius(D$).outerRadius(R$).cornerRadius(F$),H$=XD().x(M$).y1(C$).y0(T$).defined(q$),X$=XD().y(C$).x1(M$).x0(P$).defined(q$),Y$=HD().x(M$).y(C$).defined(q$),Z$=S$().x(M$).y(C$).width(k$).height(O$).cornerRadius(B$,j$,z$,U$),K$=KD().type(W$).size($$),J$=E$().x(M$).y(C$).defined(q$).size(V$);function Q$(t){return t.cornerRadius||t.cornerRadiusTopLeft||t.cornerRadiusTopRight||t.cornerRadiusBottomRight||t.cornerRadiusBottomLeft}function tV(t,e){return G$.context(t)(e)}function eV(t,e){const n=e[0],r=n.interpolate||"linear";return("horizontal"===n.orient?X$:H$).curve(HU(r,n.orient,n.tension)).context(t)(e)}function nV(t,e){const n=e[0],r=n.interpolate||"linear";return Y$.curve(HU(r,n.orient,n.tension)).context(t)(e)}function rV(t,e,n,r){return Z$.context(t)(e,n,r)}function iV(t,e){return(e.mark.shape||e.shape).context(t)(e)}function oV(t,e){return K$.context(t)(e)}function sV(t,e){return J$.context(t)(e)}var aV=1;function uV(){aV=1}function cV(t,e,n){var r=e.clip,i=t._defs,o=e.clip_id||(e.clip_id="clip"+aV++),s=i.clipping[o]||(i.clipping[o]={id:o});return mN(r)?s.path=r(null):Q$(n)?s.path=rV(null,n,0,0):(s.width=n.width||0,s.height=n.height||0),"url(#"+o+")"}function lV(t){this.clear(),t&&this.union(t)}function hV(t){this.mark=t,this.bounds=this.bounds||new lV}function fV(t){hV.call(this,t),this.items=this.items||[]}function dV(t){this._pending=0,this._loader=t||Object(Pk["e"])()}function pV(t){t._pending+=1}function gV(t){t._pending-=1}function mV(t,e,n){if(e.stroke&&0!==e.opacity&&0!==e.strokeOpacity){const r=null!=e.strokeWidth?+e.strokeWidth:1;t.expand(r+(n?yV(e,r):0))}return t}function yV(t,e){return t.strokeJoin&&"miter"!==t.strokeJoin?0:e}lV.prototype={clone(){return new lV(this)},clear(){return this.x1=+Number.MAX_VALUE,this.y1=+Number.MAX_VALUE,this.x2=-Number.MAX_VALUE,this.y2=-Number.MAX_VALUE,this},empty(){return this.x1===+Number.MAX_VALUE&&this.y1===+Number.MAX_VALUE&&this.x2===-Number.MAX_VALUE&&this.y2===-Number.MAX_VALUE},equals(t){return this.x1===t.x1&&this.y1===t.y1&&this.x2===t.x2&&this.y2===t.y2},set(t,e,n,r){return n<t?(this.x2=t,this.x1=n):(this.x1=t,this.x2=n),r<e?(this.y2=e,this.y1=r):(this.y1=e,this.y2=r),this},add(t,e){return t<this.x1&&(this.x1=t),e<this.y1&&(this.y1=e),t>this.x2&&(this.x2=t),e>this.y2&&(this.y2=e),this},expand(t){return this.x1-=t,this.y1-=t,this.x2+=t,this.y2+=t,this},round(){return this.x1=Math.floor(this.x1),this.y1=Math.floor(this.y1),this.x2=Math.ceil(this.x2),this.y2=Math.ceil(this.y2),this},scale(t){return this.x1*=t,this.y1*=t,this.x2*=t,this.y2*=t,this},translate(t,e){return this.x1+=t,this.x2+=t,this.y1+=e,this.y2+=e,this},rotate(t,e,n){const r=this.rotatedPoints(t,e,n);return this.clear().add(r[0],r[1]).add(r[2],r[3]).add(r[4],r[5]).add(r[6],r[7])},rotatedPoints(t,e,n){var{x1:r,y1:i,x2:o,y2:s}=this,a=Math.cos(t),u=Math.sin(t),c=e-e*a+n*u,l=n-e*u-n*a;return[a*r-u*i+c,u*r+a*i+l,a*r-u*s+c,u*r+a*s+l,a*o-u*i+c,u*o+a*i+l,a*o-u*s+c,u*o+a*s+l]},union(t){return t.x1<this.x1&&(this.x1=t.x1),t.y1<this.y1&&(this.y1=t.y1),t.x2>this.x2&&(this.x2=t.x2),t.y2>this.y2&&(this.y2=t.y2),this},intersect(t){return t.x1>this.x1&&(this.x1=t.x1),t.y1>this.y1&&(this.y1=t.y1),t.x2<this.x2&&(this.x2=t.x2),t.y2<this.y2&&(this.y2=t.y2),this},encloses(t){return t&&this.x1<=t.x1&&this.x2>=t.x2&&this.y1<=t.y1&&this.y2>=t.y2},alignsWith(t){return t&&(this.x1==t.x1||this.x2==t.x2||this.y1==t.y1||this.y2==t.y2)},intersects(t){return t&&!(this.x2<t.x1||this.x1>t.x2||this.y2<t.y1||this.y1>t.y2)},contains(t,e){return!(t<this.x1||t>this.x2||e<this.y1||e>this.y2)},width(){return this.x2-this.x1},height(){return this.y2-this.y1}},_N(fV,hV),dV.prototype={pending(){return this._pending},sanitizeURL(t){const e=this;return pV(e),e._loader.sanitize(t,{context:"href"}).then(t=>{return gV(e),t}).catch(()=>{return gV(e),null})},loadImage(t){const e=this,n=QD();return pV(e),e._loader.sanitize(t,{context:"image"}).then(t=>{const r=t.href;if(!r||!n)throw{url:r};const i=new n,o=bN(t,"crossOrigin")?t.crossOrigin:"anonymous";return null!=o&&(i.crossOrigin=o),i.onload=()=>gV(e),i.onerror=()=>gV(e),i.src=r,i}).catch(t=>{return gV(e),{complete:!1,width:0,height:0,src:t&&t.url||""}})},ready(){const t=this;return new Promise(e=>{function n(r){t.pending()?setTimeout(()=>{n(!0)},10):e(r)}n(!1)})}};const vV=t$-1e-8;let bV,_V,wV,xV,SV,EV,AV,MV;const CV=(t,e)=>bV.add(t,e),kV=(t,e)=>CV(_V=t,wV=e),OV=t=>CV(t,bV.y1),PV=t=>CV(bV.x1,t),TV=(t,e)=>SV*t+AV*e,LV=(t,e)=>EV*t+MV*e,IV=(t,e)=>CV(TV(t,e),LV(t,e)),NV=(t,e)=>kV(TV(t,e),LV(t,e));function DV(t,e){return bV=t,e?(xV=e*KU,SV=MV=Math.cos(xV),EV=Math.sin(xV),AV=-EV):(SV=MV=1,xV=EV=AV=0),RV}const RV={beginPath(){},closePath(){},moveTo:NV,lineTo:NV,rect(t,e,n,r){xV?(IV(t+n,e),IV(t+n,e+r),IV(t,e+r),NV(t,e)):(CV(t+n,e+r),kV(t,e))},quadraticCurveTo(t,e,n,r){const i=TV(t,e),o=LV(t,e),s=TV(n,r),a=LV(n,r);FV(_V,i,s,OV),FV(wV,o,a,PV),kV(s,a)},bezierCurveTo(t,e,n,r,i,o){const s=TV(t,e),a=LV(t,e),u=TV(n,r),c=LV(n,r),l=TV(i,o),h=LV(i,o);BV(_V,s,u,l,OV),BV(wV,a,c,h,PV),kV(l,h)},arc(t,e,n,r,i,o){if(r+=xV,i+=xV,_V=n*Math.cos(i)+t,wV=n*Math.sin(i)+e,Math.abs(i-r)>vV)CV(t-n,e-n),CV(t+n,e+n);else{const s=r=>CV(n*Math.cos(r)+t,n*Math.sin(r)+e);let a,u;if(s(r),s(i),i!==r)if(r%=t$,r<0&&(r+=t$),i%=t$,i<0&&(i+=t$),i<r&&(o=!o,a=r,r=i,i=a),o)for(i-=t$,a=r-r%QU,u=0;u<4&&a>i;++u,a-=QU)s(a);else for(a=r-r%QU+QU,u=0;u<4&&a<i;++u,a+=QU)s(a)}}};function FV(t,e,n,r){const i=(t-e)/(t+n-2*e);0<i&&i<1&&r(t+(e-t)*i)}function BV(t,e,n,r,i){const o=r-t+3*e-3*n,s=t+n-2*e,a=t-e;let u,c=0,l=0;Math.abs(o)>JU?(u=s*s+a*o,u>=0&&(u=Math.sqrt(u),c=(-s+u)/o,l=(-s-u)/o)):c=.5*a/s,0<c&&c<1&&i(jV(c,t,e,n,r)),0<l&&l<1&&i(jV(l,t,e,n,r))}function jV(t,e,n,r,i){const o=1-t,s=o*o,a=t*t;return s*o*e+3*s*t*n+3*o*a*r+a*t*i}var zV=(zV=JD(1,1))?zV.getContext("2d"):null;const UV=new lV;function $V(t){return function(e,n){if(!zV)return!0;t(zV,e),UV.clear().union(e.bounds).intersect(n).round();const{x1:r,y1:i,x2:o,y2:s}=UV;for(let t=i;t<=s;++t)for(let e=r;e<=o;++e)if(zV.isPointInPath(e,t))return!0;return!1}}function VV(t,e){return e.contains(t.x||0,t.y||0)}function qV(t,e){const n=t.x||0,r=t.y||0,i=t.width||0,o=t.height||0;return e.intersects(UV.set(n,r,n+i,r+o))}function WV(t,e){const n=t.x||0,r=t.y||0,i=null!=t.x2?t.x2:n,o=null!=t.y2?t.y2:r;return GV(e,n,r,i,o)}function GV(t,e,n,r,i){const{x1:o,y1:s,x2:a,y2:u}=t,c=r-e,l=i-n;let h,f,d,p,g=0,m=1;for(p=0;p<4;++p){if(0===p&&(h=-c,f=-(o-e)),1===p&&(h=c,f=a-e),2===p&&(h=-l,f=-(s-n)),3===p&&(h=l,f=u-n),Math.abs(h)<1e-10&&f<0)return!1;if(d=f/h,h<0){if(d>m)return!1;d>g&&(g=d)}else if(h>0){if(d<g)return!1;d<m&&(m=d)}}return!0}function HV(t,e){t.globalCompositeOperation=e.blend||"source-over"}function XV(t,e){return null==t?e:t}function YV(t,e){const n=e.length;for(let r=0;r<n;++r)t.addColorStop(e[r].offset,e[r].color);return t}function ZV(t,e,n){const r=n.width(),i=n.height();let o;if("radial"===e.gradient)o=t.createRadialGradient(n.x1+XV(e.x1,.5)*r,n.y1+XV(e.y1,.5)*i,Math.max(r,i)*XV(e.r1,0),n.x1+XV(e.x2,.5)*r,n.y1+XV(e.y2,.5)*i,Math.max(r,i)*XV(e.r2,.5));else{const s=XV(e.x1,0),a=XV(e.y1,0),u=XV(e.x2,1),c=XV(e.y2,0);if(s!==u&&a!==c&&r!==i){const n=JD(Math.ceil(r),Math.ceil(i)),o=n.getContext("2d");return o.scale(r,i),o.fillStyle=YV(o.createLinearGradient(s,a,u,c),e.stops),o.fillRect(0,0,r,i),t.createPattern(n,"no-repeat")}o=t.createLinearGradient(n.x1+s*r,n.y1+a*i,n.x1+u*r,n.y1+c*i)}return YV(o,e.stops)}function KV(t,e,n){return $U(n)?ZV(t,n,e.bounds):n}function JV(t,e,n){return n*=null==e.fillOpacity?1:e.fillOpacity,n>0&&(t.globalAlpha=n,t.fillStyle=KV(t,e,e.fill),!0)}var QV=[];function tq(t,e,n){var r=null!=(r=e.strokeWidth)?r:1;return!(r<=0)&&(n*=null==e.strokeOpacity?1:e.strokeOpacity,n>0&&(t.globalAlpha=n,t.strokeStyle=KV(t,e,e.stroke),t.lineWidth=r,t.lineCap=e.strokeCap||"butt",t.lineJoin=e.strokeJoin||"miter",t.miterLimit=e.strokeMiterLimit||10,t.setLineDash&&(t.setLineDash(e.strokeDash||QV),t.lineDashOffset=e.strokeDashOffset||0),!0))}function eq(t,e){return t.zindex-e.zindex||t.index-e.index}function nq(t){if(!t.zdirty)return t.zitems;var e,n,r,i=t.items,o=[];for(n=0,r=i.length;n<r;++n)e=i[n],e.index=n,e.zindex&&o.push(e);return t.zdirty=!1,t.zitems=o.sort(eq)}function rq(t,e){var n,r,i=t.items;if(!i||!i.length)return;const o=nq(t);if(o&&o.length){for(n=0,r=i.length;n<r;++n)i[n].zindex||e(i[n]);i=o}for(n=0,r=i.length;n<r;++n)e(i[n])}function iq(t,e){var n,r,i=t.items;if(!i||!i.length)return null;const o=nq(t);for(o&&o.length&&(i=o),r=i.length;--r>=0;)if(n=e(i[r]))return n;if(i===o)for(i=t.items,r=i.length;--r>=0;)if(!i[r].zindex&&(n=e(i[r])))return n;return null}function oq(t){return function(e,n,r){rq(n,n=>{r&&!r.intersects(n.bounds)||aq(t,e,n,n)})}}function sq(t){return function(e,n,r){!n.items.length||r&&!r.intersects(n.bounds)||aq(t,e,n.items[0],n.items)}}function aq(t,e,n,r){var i=null==n.opacity?1:n.opacity;0!==i&&(t(e,r)||(HV(e,n),n.fill&&JV(e,n,i)&&e.fill(),n.stroke&&tq(e,n,i)&&e.stroke()))}function uq(t){return t=t||hN,function(e,n,r,i,o,s){return r*=e.pixelRatio,i*=e.pixelRatio,iq(n,n=>{const a=n.bounds;if((!a||a.contains(o,s))&&a)return t(e,n,r,i,o,s)?n:void 0})}}function cq(t,e){return function(n,r,i,o){var s,a,u=Array.isArray(r)?r[0]:r,c=null==e?u.fill:e,l=u.stroke&&n.isPointInStroke;return l&&(s=u.strokeWidth,a=u.strokeCap,n.lineWidth=null!=s?s:1,n.lineCap=null!=a?a:"butt"),!t(n,r)&&(c&&n.isPointInPath(i,o)||l&&n.isPointInStroke(i,o))}}function lq(t){return uq(cq(t))}function hq(t,e){return"translate("+t+","+e+")"}function fq(t){return"rotate("+t+")"}function dq(t,e){return"scale("+t+","+e+")"}function pq(t){return hq(t.x||0,t.y||0)}function gq(t){return hq(t.x||0,t.y||0)+(t.angle?" "+fq(t.angle):"")}function mq(t){return hq(t.x||0,t.y||0)+(t.angle?" "+fq(t.angle):"")+(t.scaleX||t.scaleY?" "+dq(t.scaleX||1,t.scaleY||1):"")}function yq(t,e,n){function r(t,n){t("transform",gq(n)),t("d",e(null,n))}function i(t,n){return e(DV(t,n.angle),n),mV(t,n).translate(n.x||0,n.y||0)}function o(t,n){var r=n.x||0,i=n.y||0,o=n.angle||0;t.translate(r,i),o&&t.rotate(o*=KU),t.beginPath(),e(t,n),o&&t.rotate(-o),t.translate(-r,-i)}return{type:t,tag:"path",nested:!1,attr:r,bound:i,draw:oq(o),pick:lq(o),isect:n||$V(o)}}var vq=yq("arc",tV);function bq(t,e){var n,r,i="horizontal"===t[0].orient?e[1]:e[0],o="horizontal"===t[0].orient?"y":"x",s=t.length,a=1/0;while(--s>=0)!1!==t[s].defined&&(r=Math.abs(t[s][o]-i),r<a&&(a=r,n=t[s]));return n}function _q(t,e){var n,r,i,o=Math.pow(t[0].strokeWidth||1,2),s=t.length;while(--s>=0)if(!1!==t[s].defined&&(n=t[s].x-e[0],r=t[s].y-e[1],i=n*n+r*r,i<o))return t[s];return null}function wq(t,e){var n,r,i,o=t.length;while(--o>=0)if(!1!==t[o].defined&&(n=t[o].x-e[0],r=t[o].y-e[1],i=n*n+r*r,n=t[o].size||1,i<n*n))return t[o];return null}function xq(t,e,n){function r(t,n){var r=n.mark.items;r.length&&t("d",e(null,r))}function i(t,n){var r=n.items;return 0===r.length?t:(e(DV(t),r),mV(t,r[0]))}function o(t,n){t.beginPath(),e(t,n)}const s=cq(o);function a(t,e,n,r,i,o){var a=e.items,u=e.bounds;return!a||!a.length||u&&!u.contains(i,o)?null:(n*=t.pixelRatio,r*=t.pixelRatio,s(t,a,n,r)?a[0]:null)}return{type:t,tag:"path",nested:!0,attr:r,bound:i,draw:sq(o),pick:a,isect:VV,tip:n}}var Sq=xq("area",eV,bq);function Eq(t,e){var n=e.clip;t.save(),mN(n)?(t.beginPath(),n(t),t.clip()):Aq(t,e.group)}function Aq(t,e){t.beginPath(),Q$(e)?rV(t,e,0,0):t.rect(0,0,e.width||0,e.height||0),t.clip()}function Mq(t){const e=XV(t.strokeWidth,1);return null!=t.strokeOffset?t.strokeOffset:t.stroke&&e>.5&&e<1.5?.5-Math.abs(e-1):0}function Cq(t,e){t("transform",pq(e))}function kq(t,e){const n=Mq(e);t("d",rV(null,e,n,n))}function Oq(t,e){t("class","background"),t("aria-hidden",!0),kq(t,e)}function Pq(t,e){t("class","foreground"),t("aria-hidden",!0),e.strokeForeground?kq(t,e):t("d","")}function Tq(t,e,n){const r=e.clip?cV(n,e,e):null;t("clip-path",r)}function Lq(t,e){if(!e.clip&&e.items){const n=e.items,r=n.length;for(let e=0;e<r;++e)t.union(n[e].bounds)}return(e.clip||e.width||e.height)&&!e.noBound&&t.add(0,0).add(e.width||0,e.height||0),mV(t,e),t.translate(e.x||0,e.y||0)}function Iq(t,e,n,r){const i=Mq(e);t.beginPath(),rV(t,e,(n||0)+i,(r||0)+i)}const Nq=cq(Iq),Dq=cq(Iq,!1),Rq=cq(Iq,!0);function Fq(t,e,n){rq(e,e=>{const r=e.x||0,i=e.y||0,o=e.strokeForeground,s=null==e.opacity?1:e.opacity;(e.stroke||e.fill)&&s&&(Iq(t,e,r,i),HV(t,e),e.fill&&JV(t,e,s)&&t.fill(),e.stroke&&!o&&tq(t,e,s)&&t.stroke()),t.save(),t.translate(r,i),e.clip&&Aq(t,e),n&&n.translate(-r,-i),rq(e,e=>{this.draw(t,e,n)}),n&&n.translate(r,i),t.restore(),o&&e.stroke&&s&&(Iq(t,e,r,i),HV(t,e),tq(t,e,s)&&t.stroke())})}function Bq(t,e,n,r,i,o){if(e.bounds&&!e.bounds.contains(i,o)||!e.items)return null;const s=n*t.pixelRatio,a=r*t.pixelRatio;return iq(e,u=>{let c,l,h;const f=u.bounds;if(f&&!f.contains(i,o))return;l=u.x||0,h=u.y||0;const d=l+(u.width||0),p=h+(u.height||0),g=u.clip;if(g&&(i<l||i>d||o<h||o>p))return;if(t.save(),t.translate(l,h),l=i-l,h=o-h,g&&Q$(u)&&!Rq(t,u,s,a))return t.restore(),null;const m=u.strokeForeground,y=!1!==e.interactive;return y&&m&&u.stroke&&Dq(t,u,s,a)?(t.restore(),u):(c=iq(u,t=>jq(t,l,h)?this.pick(t,n,r,l,h):null),!c&&y&&(u.fill||!m&&u.stroke)&&Nq(t,u,s,a)&&(c=u),t.restore(),c||null)})}function jq(t,e,n){return(!1!==t.interactive||"group"===t.marktype)&&t.bounds&&t.bounds.contains(e,n)}var zq={type:"group",tag:"g",nested:!1,attr:Cq,bound:Lq,draw:Fq,pick:Bq,isect:qV,content:Tq,background:Oq,foreground:Pq},Uq={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1"};function $q(t,e){var n=t.image;return(!n||t.url&&t.url!==n.url)&&(n={complete:!1,width:0,height:0},e.loadImage(t.url).then(e=>{t.image=e,t.image.url=t.url})),n}function Vq(t,e){return null!=t.width?t.width:e&&e.width?!1!==t.aspect&&t.height?t.height*e.width/e.height:e.width:0}function qq(t,e){return null!=t.height?t.height:e&&e.height?!1!==t.aspect&&t.width?t.width*e.height/e.width:e.height:0}function Wq(t,e){return"center"===t?e/2:"right"===t?e:0}function Gq(t,e){return"middle"===t?e/2:"bottom"===t?e:0}function Hq(t,e,n){const r=$q(e,n),i=Vq(e,r),o=qq(e,r),s=(e.x||0)-Wq(e.align,i),a=(e.y||0)-Gq(e.baseline,o),u=!r.src&&r.toDataURL?r.toDataURL():r.src||"";t("href",u,Uq["xmlns:xlink"],"xlink:href"),t("transform",hq(s,a)),t("width",i),t("height",o),t("preserveAspectRatio",!1===e.aspect?"none":"xMidYMid")}function Xq(t,e){const n=e.image,r=Vq(e,n),i=qq(e,n),o=(e.x||0)-Wq(e.align,r),s=(e.y||0)-Gq(e.baseline,i);return t.set(o,s,o+r,s+i)}function Yq(t,e,n){rq(e,e=>{if(n&&!n.intersects(e.bounds))return;const r=$q(e,this);let i=Vq(e,r),o=qq(e,r);if(0===i||0===o)return;let s,a,u,c,l=(e.x||0)-Wq(e.align,i),h=(e.y||0)-Gq(e.baseline,o);!1!==e.aspect&&(a=r.width/r.height,u=e.width/e.height,a===a&&u===u&&a!==u&&(u<a?(c=i/a,h+=(o-c)/2,o=c):(c=o*a,l+=(i-c)/2,i=c))),(r.complete||r.toDataURL)&&(HV(t,e),t.globalAlpha=null!=(s=e.opacity)?s:1,t.imageSmoothingEnabled=!1!==e.smooth,t.drawImage(r,l,h,i,o))})}var Zq={type:"image",tag:"image",nested:!1,attr:Hq,bound:Xq,draw:Yq,pick:uq(),isect:hN,get:$q,xOffset:Wq,yOffset:Gq},Kq=xq("line",nV,_q);function Jq(t,e){var n=e.scaleX||1,r=e.scaleY||1;1===n&&1===r||t("vector-effect","non-scaling-stroke"),t("transform",mq(e)),t("d",e.path)}function Qq(t,e){var n=e.path;if(null==n)return!0;var r=e.x||0,i=e.y||0,o=e.scaleX||1,s=e.scaleY||1,a=(e.angle||0)*KU,u=e.pathCache;u&&u.path===n||((e.pathCache=u=ZU(n)).path=n),a&&t.rotate&&t.translate?(t.translate(r,i),t.rotate(a),c$(t,u,0,0,o,s),t.rotate(-a),t.translate(-r,-i)):c$(t,u,r,i,o,s)}function tW(t,e){return Qq(DV(t,e.angle),e)?t.set(0,0,0,0):mV(t,e,!0)}var eW={type:"path",tag:"path",nested:!1,attr:Jq,bound:tW,draw:oq(Qq),pick:lq(Qq),isect:$V(Qq)};function nW(t,e){t("d",rV(null,e))}function rW(t,e){var n,r;return mV(t.set(n=e.x||0,r=e.y||0,n+e.width||0,r+e.height||0),e)}function iW(t,e){t.beginPath(),rV(t,e)}var oW={type:"rect",tag:"path",nested:!1,attr:nW,bound:rW,draw:oq(iW),pick:lq(iW),isect:qV};function sW(t,e){t("transform",pq(e)),t("x2",null!=e.x2?e.x2-(e.x||0):0),t("y2",null!=e.y2?e.y2-(e.y||0):0)}function aW(t,e){var n,r;return mV(t.set(n=e.x||0,r=e.y||0,null!=e.x2?e.x2:n,null!=e.y2?e.y2:r),e)}function uW(t,e,n){var r,i,o,s;return!(!e.stroke||!tq(t,e,n))&&(r=e.x||0,i=e.y||0,o=null!=e.x2?e.x2:r,s=null!=e.y2?e.y2:i,t.beginPath(),t.moveTo(r,i),t.lineTo(o,s),!0)}function cW(t,e,n){rq(e,e=>{if(!n||n.intersects(e.bounds)){var r=null==e.opacity?1:e.opacity;r&&uW(t,e,r)&&(HV(t,e),t.stroke())}})}function lW(t,e,n,r){return!!t.isPointInStroke&&(uW(t,e,1)&&t.isPointInStroke(n,r))}var hW={type:"rule",tag:"line",nested:!1,attr:sW,bound:aW,draw:cW,pick:uq(lW),isect:WV},fW=yq("shape",iV),dW=yq("symbol",oV,VV);const pW=SN();var gW={height:wW,measureWidth:bW,estimateWidth:yW,width:yW,canvas:mW};function mW(t){gW.width=t&&zV?bW:yW}function yW(t,e){return vW(MW(t,e),wW(t))}function vW(t,e){return~~(.8*t.length*e)}function bW(t,e){return wW(t)<=0||!(e=MW(t,e))?0:_W(e,PW(t))}function _W(t,e){const n=`(${e}) ${t}`;let r=pW.get(n);return void 0===r&&(zV.font=e,r=zV.measureText(t).width,pW.set(n,r)),r}function wW(t){return null!=t.fontSize?+t.fontSize||0:11}function xW(t){return null!=t.lineHeight?t.lineHeight:wW(t)+2}function SW(t){return fN(t)?t.length>1?t:t[0]:t}function EW(t){return SW(t.lineBreak&&t.text&&!fN(t.text)?t.text.split(t.lineBreak):t.text)}function AW(t){const e=EW(t);return(fN(e)?e.length-1:0)*xW(t)}function MW(t,e){const n=null==e?"":(e+"").trim();return t.limit>0&&n.length?kW(t,n):n}function CW(t){if(gW.width===bW){const e=PW(t);return t=>_W(t,e)}{const e=wW(t);return t=>vW(t,e)}}function kW(t,e){var n=+t.limit,r=CW(t);if(r(e)<n)return e;var i,o=t.ellipsis||"…",s="rtl"===t.dir,a=0,u=e.length;if(n-=r(o),s){while(a<u)i=a+u>>>1,r(e.slice(i))>n?a=i+1:u=i;return o+e.slice(a)}while(a<u)i=1+(a+u>>>1),r(e.slice(0,i))<n?a=i:u=i-1;return e.slice(0,a)+o}function OW(t,e){var n=t.font;return(e&&n?String(n).replace(/"/g,"'"):n)||"sans-serif"}function PW(t,e){return(t.fontStyle?t.fontStyle+" ":"")+(t.fontVariant?t.fontVariant+" ":"")+(t.fontWeight?t.fontWeight+" ":"")+wW(t)+"px "+OW(t,e)}function TW(t){var e=t.baseline,n=wW(t);return Math.round("top"===e?.79*n:"middle"===e?.3*n:"bottom"===e?-.21*n:"line-top"===e?.29*n+.5*xW(t):"line-bottom"===e?.29*n-.5*xW(t):0)}mW(!0);const LW={left:"start",center:"middle",right:"end"},IW=new lV;function NW(t){var e,n=t.x||0,r=t.y||0,i=t.radius||0;return i&&(e=(t.theta||0)-QU,n+=i*Math.cos(e),r+=i*Math.sin(e)),IW.x1=n,IW.y1=r,IW}function DW(t,e){var n,r=e.dx||0,i=(e.dy||0)+TW(e),o=NW(e),s=o.x1,a=o.y1,u=e.angle||0;t("text-anchor",LW[e.align]||"start"),u?(n=hq(s,a)+" "+fq(u),(r||i)&&(n+=" "+hq(r,i))):n=hq(s+r,a+i),t("transform",n)}function RW(t,e,n){var r,i=gW.height(e),o=e.align,s=NW(e),a=s.x1,u=s.y1,c=e.dx||0,l=(e.dy||0)+TW(e)-Math.round(.8*i),h=EW(e);if(fN(h)?(i+=xW(e)*(h.length-1),r=h.reduce((t,n)=>Math.max(t,gW.width(e,n)),0)):r=gW.width(e,h),"center"===o?c-=r/2:"right"===o&&(c-=r),t.set(c+=a,l+=u,c+r,l+i),e.angle&&!n)t.rotate(e.angle*KU,a,u);else if(2===n)return t.rotatedPoints(e.angle*KU,a,u);return t}function FW(t,e,n){rq(e,e=>{var r,i,o,s,a,u,c,l=null==e.opacity?1:e.opacity;if(!(n&&!n.intersects(e.bounds)||0===l||e.fontSize<=0||null==e.text||0===e.text.length)){if(t.font=PW(e),t.textAlign=e.align||"left",r=NW(e),i=r.x1,o=r.y1,e.angle&&(t.save(),t.translate(i,o),t.rotate(e.angle*KU),i=o=0),i+=e.dx||0,o+=(e.dy||0)+TW(e),u=EW(e),HV(t,e),fN(u))for(a=xW(e),s=0;s<u.length;++s)c=MW(e,u[s]),e.fill&&JV(t,e,l)&&t.fillText(c,i,o),e.stroke&&tq(t,e,l)&&t.strokeText(c,i,o),o+=a;else c=MW(e,u),e.fill&&JV(t,e,l)&&t.fillText(c,i,o),e.stroke&&tq(t,e,l)&&t.strokeText(c,i,o);e.angle&&t.restore()}})}function BW(t,e,n,r,i,o){if(e.fontSize<=0)return!1;if(!e.angle)return!0;var s=NW(e),a=s.x1,u=s.y1,c=RW(IW,e,1),l=-e.angle*KU,h=Math.cos(l),f=Math.sin(l),d=h*i-f*o+(a-h*a+f*u),p=f*i+h*o+(u-f*a-h*u);return c.contains(d,p)}function jW(t,e){const n=RW(IW,t,2);return GV(e,n[0],n[1],n[2],n[3])||GV(e,n[0],n[1],n[4],n[5])||GV(e,n[4],n[5],n[6],n[7])||GV(e,n[2],n[3],n[6],n[7])}var zW={type:"text",tag:"text",nested:!1,attr:DW,bound:RW,draw:FW,pick:uq(BW),isect:jW},UW=xq("trail",sV,wq),$W={arc:vq,area:Sq,group:zq,image:Zq,line:Kq,path:eW,rect:oW,rule:hW,shape:fW,symbol:dW,text:zW,trail:UW};function VW(t,e,n){var r=$W[t.mark.marktype],i=e||r.bound;return r.nested&&(t=t.mark),i(t.bounds||(t.bounds=new lV),t,n)}var qW={mark:null};function WW(t,e,n){var r,i,o,s,a=$W[t.marktype],u=a.bound,c=t.items,l=c&&c.length;if(a.nested)return l?o=c[0]:(qW.mark=t,o=qW),s=VW(o,u,n),e=e&&e.union(s)||s,e;if(e=e||t.bounds&&t.bounds.clear()||new lV,l)for(r=0,i=c.length;r<i;++r)e.union(VW(c[r],u,n));return t.bounds=e}const GW=["marktype","name","role","interactive","clip","items","zindex","x","y","width","height","align","baseline","fill","fillOpacity","opacity","blend","stroke","strokeOpacity","strokeWidth","strokeCap","strokeDash","strokeDashOffset","strokeForeground","strokeOffset","startAngle","endAngle","innerRadius","outerRadius","cornerRadius","padAngle","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight","interpolate","tension","orient","defined","url","aspect","smooth","path","scaleX","scaleY","x2","y2","size","shape","text","angle","theta","radius","dir","dx","dy","ellipsis","limit","lineBreak","lineHeight","font","fontSize","fontWeight","fontStyle","fontVariant","description","aria","ariaRole","ariaRoleDescription"];function HW(t,e){return JSON.stringify(t,GW,e)}function XW(t){const e="string"===typeof t?JSON.parse(t):t;return YW(e)}function YW(t){var e,n,r,i=t.marktype,o=t.items;if(o)for(n=0,r=o.length;n<r;++n)e=i?"mark":"group",o[n][e]=t,o[n].zindex&&(o[n][e].zdirty=!0),"group"===(i||e)&&YW(o[n]);return i&&WW(t),t}function ZW(t){arguments.length?this.root=XW(t):(this.root=KW({marktype:"group",name:"root",role:"frame"}),this.root.items=[new fV(this.root)])}function KW(t,e){const n={bounds:new lV,clip:!!t.clip,group:e,interactive:!1!==t.interactive,items:[],marktype:t.marktype,name:t.name||void 0,role:t.role||void 0,zindex:t.zindex||0};return null!=t.aria&&(n.aria=t.aria),t.description&&(n.description=t.description),n}function JW(t,e,n){return!t&&"undefined"!==typeof document&&document.createElement&&(t=document),t?n?t.createElementNS(n,e):t.createElement(e):null}function QW(t,e){e=e.toLowerCase();for(var n=t.childNodes,r=0,i=n.length;r<i;++r)if(n[r].tagName.toLowerCase()===e)return n[r]}function tG(t,e,n,r){var i,o=t.childNodes[e];return o&&o.tagName.toLowerCase()===n.toLowerCase()||(i=o||null,o=JW(t.ownerDocument,n,r),t.insertBefore(o,i)),o}function eG(t,e){var n=t.childNodes,r=n.length;while(r>e)t.removeChild(n[--r]);return t}function nG(t){return"mark-"+t.marktype+(t.role?" role-"+t.role:"")+(t.name?" "+t.name:"")}function rG(t,e){const n=e.getBoundingClientRect();return[t.clientX-n.left-(e.clientLeft||0),t.clientY-n.top-(e.clientTop||0)]}function iG(t,e,n,r){var i,o,s=t&&t.mark;if(s&&(i=$W[s.marktype]).tip){o=rG(e,n),o[0]-=r[0],o[1]-=r[1];while(t=t.mark.group)o[0]-=t.x||0,o[1]-=t.y||0;t=i.tip(s.items,o)}return t}function oG(t,e){this._active=null,this._handlers={},this._loader=t||Object(Pk["e"])(),this._tooltip=e||sG}function sG(t,e,n,r){t.element().setAttribute("title",r||"")}function aG(t){this._el=null,this._bgcolor=null,this._loader=new dV(t)}ZW.prototype={toJSON(t){return HW(this.root,t||0)},mark(t,e,n){e=e||this.root.items[0];const r=KW(t,e);return e.items[n]=r,r.zindex&&(r.group.zdirty=!0),r}},oG.prototype={initialize(t,e,n){return this._el=t,this._obj=n||null,this.origin(e)},element(){return this._el},canvas(){return this._el&&this._el.firstChild},origin(t){return arguments.length?(this._origin=t||[0,0],this):this._origin.slice()},scene(t){return arguments.length?(this._scene=t,this):this._scene},on(){},off(){},_handlerIndex(t,e,n){for(let r=t?t.length:0;--r>=0;)if(t[r].type===e&&(!n||t[r].handler===n))return r;return-1},handlers(t){const e=this._handlers,n=[];if(t)n.push(...e[this.eventName(t)]);else for(const r in e)n.push(...e[r]);return n},eventName(t){const e=t.indexOf(".");return e<0?t:t.slice(0,e)},handleHref(t,e,n){this._loader.sanitize(n,{context:"href"}).then(e=>{const n=new MouseEvent(t.type,t),r=JW(null,"a");for(const t in e)r.setAttribute(t,e[t]);r.dispatchEvent(n)}).catch(()=>{})},handleTooltip(t,e,n){if(e&&null!=e.tooltip){e=iG(e,t,this.canvas(),this._origin);const r=n&&e&&e.tooltip||null;this._tooltip.call(this._obj,this,t,e,r)}},getItemBoundingClientRect(t){const e=this.canvas();if(!e)return;const n=e.getBoundingClientRect(),r=this._origin,i=t.bounds,o=i.width(),s=i.height();let a=i.x1+r[0]+n.left,u=i.y1+r[1]+n.top;while(t.mark&&(t=t.mark.group))a+=t.x||0,u+=t.y||0;return{x:a,y:u,width:o,height:s,left:a,top:u,right:a+o,bottom:u+s}}},aG.prototype={initialize(t,e,n,r,i){return this._el=t,this.resize(e,n,r,i)},element(){return this._el},canvas(){return this._el&&this._el.firstChild},background(t){return 0===arguments.length?this._bgcolor:(this._bgcolor=t,this)},resize(t,e,n,r){return this._width=t,this._height=e,this._origin=n||[0,0],this._scale=r||1,this},dirty(){},render(t){const e=this;return e._call=function(){e._render(t)},e._call(),e._call=null,e},_render(){},renderAsync(t){const e=this.render(t);return this._ready?this._ready.then(()=>e):Promise.resolve(e)},_load(t,e){var n=this,r=n._loader[t](e);if(!n._ready){const t=n._call;n._ready=n._loader.ready().then(e=>{e&&t(),n._ready=null})}return r},sanitizeURL(t){return this._load("sanitizeURL",t)},loadImage(t){return this._load("loadImage",t)}};const uG="keydown",cG="keypress",lG="keyup",hG="dragenter",fG="dragleave",dG="dragover",pG="mousedown",gG="mouseup",mG="mousemove",yG="mouseout",vG="mouseover",bG="click",_G="dblclick",wG="wheel",xG="mousewheel",SG="touchstart",EG="touchmove",AG="touchend",MG=[uG,cG,lG,hG,fG,dG,pG,gG,mG,yG,vG,bG,_G,wG,xG,SG,EG,AG],CG=mG,kG=yG,OG=bG;function PG(t,e){oG.call(this,t,e),this._down=null,this._touch=null,this._first=!0,this._events={}}const TG=t=>t===SG||t===EG||t===AG?[SG,EG,AG]:[t];function LG(t,e){TG(e).forEach(e=>IG(t,e))}function IG(t,e){const n=t.canvas();n&&!t._events[e]&&(t._events[e]=1,n.addEventListener(e,t[e]?n=>t[e](n):n=>t.fire(e,n)))}function NG(t,e,n){return function(r){const i=this._active,o=this.pickEvent(r);o===i?this.fire(t,r):(i&&i.exit||this.fire(n,r),this._active=o,this.fire(e,r),this.fire(t,r))}}function DG(t){return function(e){this.fire(t,e),this._active=null}}function RG(){return"undefined"!==typeof window&&window.devicePixelRatio||1}_N(PG,oG,{initialize(t,e,n){return this._canvas=t&&QW(t,"canvas"),[bG,pG,mG,yG,fG].forEach(t=>LG(this,t)),oG.prototype.initialize.call(this,t,e,n)},canvas(){return this._canvas},context(){return this._canvas.getContext("2d")},events:MG,DOMMouseScroll(t){this.fire(xG,t)},mousemove:NG(mG,vG,yG),dragover:NG(dG,hG,fG),mouseout:DG(yG),dragleave:DG(fG),mousedown(t){this._down=this._active,this.fire(pG,t)},click(t){this._down===this._active&&(this.fire(bG,t),this._down=null)},touchstart(t){this._touch=this.pickEvent(t.changedTouches[0]),this._first&&(this._active=this._touch,this._first=!1),this.fire(SG,t,!0)},touchmove(t){this.fire(EG,t,!0)},touchend(t){this.fire(AG,t,!0),this._touch=null},fire(t,e,n){const r=n?this._touch:this._active,i=this._handlers[t];if(e.vegaType=t,t===OG&&r&&r.href?this.handleHref(e,r,r.href):t!==CG&&t!==kG||this.handleTooltip(e,r,t!==kG),i)for(let o=0,s=i.length;o<s;++o)i[o].handler.call(this._obj,e,r)},on(t,e){const n=this.eventName(t),r=this._handlers,i=this._handlerIndex(r[n],t,e);return i<0&&(LG(this,t),(r[n]||(r[n]=[])).push({type:t,handler:e})),this},off(t,e){const n=this.eventName(t),r=this._handlers[n],i=this._handlerIndex(r,t,e);return i>=0&&r.splice(i,1),this},pickEvent(t){const e=rG(t,this._canvas),n=this._origin;return this.pick(this._scene,e[0],e[1],e[0]-n[0],e[1]-n[1])},pick(t,e,n,r,i){const o=this.context(),s=$W[t.marktype];return s.pick.call(this,o,t,e,n,r,i)}});var FG=RG();function BG(t,e,n,r,i,o){const s="undefined"!==typeof HTMLElement&&t instanceof HTMLElement&&null!=t.parentNode,a=t.getContext("2d"),u=s?FG:i;t.width=e*u,t.height=n*u;for(const c in o)a[c]=o[c];return s&&1!==u&&(t.style.width=e+"px",t.style.height=n+"px"),a.pixelRatio=u,a.setTransform(u,0,0,u,u*r[0],u*r[1]),t}function jG(t){aG.call(this,t),this._options={},this._redraw=!1,this._dirty=new lV,this._tempb=new lV}const zG=aG.prototype,UG=(t,e,n)=>(new lV).set(0,0,e,n).translate(-t[0],-t[1]);function $G(t,e,n){return e.expand(1).round(),t.pixelRatio%1&&e.scale(t.pixelRatio).round().scale(1/t.pixelRatio),e.translate(-n[0]%1,-n[1]%1),t.beginPath(),t.rect(e.x1,e.y1,e.width(),e.height()),t.clip(),e}function VG(t,e){oG.call(this,t,e);const n=this;n._hrefHandler=qG(n,(t,e)=>{e&&e.href&&n.handleHref(t,e,e.href)}),n._tooltipHandler=qG(n,(t,e)=>{n.handleTooltip(t,e,t.type!==kG)})}_N(jG,aG,{initialize(t,e,n,r,i,o){return this._options=o||{},this._canvas=this._options.externalContext?null:JD(1,1,this._options.type),t&&this._canvas&&(eG(t,0).appendChild(this._canvas),this._canvas.setAttribute("class","marks")),zG.initialize.call(this,t,e,n,r,i)},resize(t,e,n,r){if(zG.resize.call(this,t,e,n,r),this._canvas)BG(this._canvas,this._width,this._height,this._origin,this._scale,this._options.context);else{const t=this._options.externalContext;t||uN("CanvasRenderer is missing a valid canvas or context"),t.scale(this._scale,this._scale),t.translate(this._origin[0],this._origin[1])}return this._redraw=!0,this},canvas(){return this._canvas},context(){return this._options.externalContext||(this._canvas?this._canvas.getContext("2d"):null)},dirty(t){const e=this._tempb.clear().union(t.bounds);let n=t.mark.group;while(n)e.translate(n.x||0,n.y||0),n=n.mark.group;this._dirty.union(e)},_render(t){const e=this.context(),n=this._origin,r=this._width,i=this._height,o=this._dirty,s=UG(n,r,i);e.save();const a=this._redraw||o.empty()?(this._redraw=!1,s.expand(1)):$G(e,s.intersect(o),n);return this.clear(-n[0],-n[1],r,i),this.draw(e,t,a),e.restore(),o.clear(),this},draw(t,e,n){const r=$W[e.marktype];e.clip&&Eq(t,e),r.draw.call(this,t,e,n),e.clip&&t.restore()},clear(t,e,n,r){const i=this._options,o=this.context();"pdf"===i.type||i.externalContext||o.clearRect(t,e,n,r),null!=this._bgcolor&&(o.fillStyle=this._bgcolor,o.fillRect(t,e,n,r))}});const qG=(t,e)=>n=>{let r=n.target.__data__;r=Array.isArray(r)?r[0]:r,n.vegaType=n.type,e.call(t._obj,n,r)};_N(VG,oG,{initialize(t,e,n){let r=this._svg;return r&&(r.removeEventListener(OG,this._hrefHandler),r.removeEventListener(CG,this._tooltipHandler),r.removeEventListener(kG,this._tooltipHandler)),this._svg=r=t&&QW(t,"svg"),r&&(r.addEventListener(OG,this._hrefHandler),r.addEventListener(CG,this._tooltipHandler),r.addEventListener(kG,this._tooltipHandler)),oG.prototype.initialize.call(this,t,e,n)},canvas(){return this._svg},on(t,e){const n=this.eventName(t),r=this._handlers,i=this._handlerIndex(r[n],t,e);if(i<0){const i={type:t,handler:e,listener:qG(this,e)};(r[n]||(r[n]=[])).push(i),this._svg&&this._svg.addEventListener(n,i.listener)}return this},off(t,e){const n=this.eventName(t),r=this._handlers[n],i=this._handlerIndex(r,t,e);return i>=0&&(this._svg&&this._svg.removeEventListener(n,r[i].listener),r.splice(i,1)),this}});const WG="aria-hidden",GG="aria-label",HG="role",XG="aria-roledescription",YG="graphics-object",ZG="graphics-symbol",KG=(t,e,n)=>({[HG]:t,[XG]:e,[GG]:n||void 0}),JG=EN(["axis-domain","axis-grid","axis-label","axis-tick","axis-title","legend-band","legend-entry","legend-gradient","legend-label","legend-title","legend-symbol","title"]),QG={axis:{desc:"axis",caption:sH},legend:{desc:"legend",caption:aH},"title-text":{desc:"title",caption:t=>`Title text '${oH(t)}'`},"title-subtitle":{desc:"subtitle",caption:t=>`Subtitle text '${oH(t)}'`}},tH={ariaRole:HG,ariaRoleDescription:XG,description:GG};function eH(t,e){const n=!1===e.aria;if(t(WG,n||void 0),n||null==e.description)for(const r in tH)t(tH[r],void 0);else{const n=e.mark.marktype;t(GG,e.description),t(HG,e.ariaRole||("group"===n?YG:ZG)),t(XG,e.ariaRoleDescription||`${n} mark`)}}function nH(t){return!1===t.aria?{[WG]:!0}:JG[t.role]?null:QG[t.role]?iH(t,QG[t.role]):rH(t)}function rH(t){const e=t.marktype,n="group"===e||"text"===e||t.items.some(t=>null!=t.description&&!1!==t.aria);return KG(n?YG:ZG,`${e} mark container`,t.description)}function iH(t,e){try{const n=t.items[0],r=e.caption||(()=>"");return KG(e.role||ZG,e.desc,n.description||r(n))}catch(n){return null}}function oH(t){return gN(t.text).join(" ")}function sH(t){const e=t.datum,n=t.orient,r=e.title?uH(t):null,i=t.context,o=i.scales[e.scale].value,s=i.dataflow.locale(),a=o.type,u="left"===n||"right"===n?"Y":"X";return`${u}-axis`+(r?` titled '${r}'`:"")+` for a ${Hz(a)?"discrete":a} scale`+` with ${BU(s,o,t)}`}function aH(t){const e=t.datum,n=e.title?uH(t):null,r=`${e.type||""} legend`.trim(),i=e.scales,o=Object.keys(i),s=t.context,a=s.scales[i[o[0]]].value,u=s.dataflow.locale();return lH(r)+(n?` titled '${n}'`:"")+` for ${cH(o)}`+` with ${BU(u,a,t)}`}function uH(t){try{return gN(pN(t.items).items[0].text).join(" ")}catch(e){return null}}function cH(t){return t=t.map(t=>t+("fill"===t||"stroke"===t?" color":"")),t.length<2?t[0]:t.slice(0,-1).join(", ")+" and "+pN(t)}function lH(t){return t.length?t[0].toUpperCase()+t.slice(1):t}const hH=t=>(t+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),fH=t=>hH(t).replace(/"/g,"&quot;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;");function dH(){let t="",e="",n="";const r=[],i=()=>e=n="",o=o=>{e&&(t+=`${e}>${n}`,i()),r.push(o)},s=(t,n)=>{return null!=n&&(e+=` ${t}="${fH(n)}"`),a},a={open(t,...n){o(t),e="<"+t;for(const e of n)for(const t in e)s(t,e[t]);return a},close(){const o=r.pop();return t+=e?e+(n?`>${n}</${o}>`:"/>"):`</${o}>`,i(),a},attr:s,text:t=>(n+=hH(t),a),toString:()=>t};return a}const pH=t=>gH(dH(),t)+"";function gH(t,e){if(t.open(e.tagName),e.hasAttributes()){const n=e.attributes,r=n.length;for(let e=0;e<r;++e)t.attr(n[e].name,n[e].value)}if(e.hasChildNodes()){const n=e.childNodes,r=n.length;for(let e=0;e<r;e++){const r=n[e];3===r.nodeType?t.text(r.nodeValue):gH(t,r)}}return t.close()}const mH={fill:"fill",fillOpacity:"fill-opacity",stroke:"stroke",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",strokeCap:"stroke-linecap",strokeJoin:"stroke-linejoin",strokeDash:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeMiterLimit:"stroke-miterlimit",opacity:"opacity",blend:"mix-blend-mode"},yH={fill:"none","stroke-miterlimit":10},vH=0,bH="http://www.w3.org/2000/xmlns/",_H=Uq.xmlns;function wH(t){aG.call(this,t),this._dirtyID=0,this._dirty=[],this._svg=null,this._root=null,this._defs=null}const xH=aG.prototype;function SH(t,e){for(;t&&t.dirty!==e;t=t.mark.group){if(t.dirty=e,!t.mark||t.mark.dirty===e)return;t.mark.dirty=e}}function EH(t,e,n){let r,i,o;if("radial"===e.gradient){let r=tG(t,n++,"pattern",_H);NH(r,{id:UU+e.id,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),r=tG(r,0,"rect",_H),NH(r,{width:1,height:1,fill:`url(${FH()}#${e.id})`}),t=tG(t,n++,"radialGradient",_H),NH(t,{id:e.id,fx:e.x1,fy:e.y1,fr:e.r1,cx:e.x2,cy:e.y2,r:e.r2})}else t=tG(t,n++,"linearGradient",_H),NH(t,{id:e.id,x1:e.x1,x2:e.x2,y1:e.y1,y2:e.y2});for(r=0,i=e.stops.length;r<i;++r)o=tG(t,r,"stop",_H),o.setAttribute("offset",e.stops[r].offset),o.setAttribute("stop-color",e.stops[r].color);return eG(t,r),n}function AH(t,e,n){let r;return t=tG(t,n,"clipPath",_H),t.setAttribute("id",e.id),e.path?(r=tG(t,0,"path",_H),r.setAttribute("d",e.path)):(r=tG(t,0,"rect",_H),NH(r,{x:0,y:0,width:e.width,height:e.height})),eG(t,1),n+1}function MH(t,e,n){e=e.lastChild.previousSibling;let r,i=0;rq(n,n=>{r=t.mark(e,n,r),++i}),eG(e,1+i)}function CH(t,e,n,r,i){let o,s=t._svg;if(!s&&(o=e.ownerDocument,s=JW(o,r,_H),t._svg=s,t.mark&&(s.__data__=t,s.__values__={fill:"default"},"g"===r))){const e=JW(o,"path",_H);s.appendChild(e),e.__data__=t;const n=JW(o,"g",_H);s.appendChild(n),n.__data__=t;const r=JW(o,"path",_H);s.appendChild(r),r.__data__=t,r.__values__={fill:"default"}}return(s.ownerSVGElement!==i||kH(s,n))&&e.insertBefore(s,n?n.nextSibling:e.firstChild),s}function kH(t,e){return t.parentNode&&t.parentNode.childNodes.length>1&&t.previousSibling!=e}_N(wH,aG,{initialize(t,e,n,r,i){return this._defs={},this._clearDefs(),t&&(this._svg=tG(t,0,"svg",_H),this._svg.setAttributeNS(bH,"xmlns",_H),this._svg.setAttributeNS(bH,"xmlns:xlink",Uq["xmlns:xlink"]),this._svg.setAttribute("version",Uq["version"]),this._svg.setAttribute("class","marks"),eG(t,1),this._root=tG(this._svg,vH,"g",_H),NH(this._root,yH),eG(this._svg,vH+1)),this.background(this._bgcolor),xH.initialize.call(this,t,e,n,r,i)},background(t){return arguments.length&&this._svg&&this._svg.style.setProperty("background-color",t),xH.background.apply(this,arguments)},resize(t,e,n,r){return xH.resize.call(this,t,e,n,r),this._svg&&(NH(this._svg,{width:this._width*this._scale,height:this._height*this._scale,viewBox:`0 0 ${this._width} ${this._height}`}),this._root.setAttribute("transform",`translate(${this._origin})`)),this._dirty=[],this},canvas(){return this._svg},svg(){const t=this._svg,e=this._bgcolor;if(!t)return null;let n;e&&(t.removeAttribute("style"),n=tG(t,vH,"rect",_H),NH(n,{width:this._width,height:this._height,fill:e}));const r=pH(t);return e&&(t.removeChild(n),this._svg.style.setProperty("background-color",e)),r},_render(t){return this._dirtyCheck()&&(this._dirtyAll&&this._clearDefs(),this.mark(this._root,t),eG(this._root,1)),this.defs(),this._dirty=[],++this._dirtyID,this},dirty(t){t.dirty!==this._dirtyID&&(t.dirty=this._dirtyID,this._dirty.push(t))},isDirty(t){return this._dirtyAll||!t._svg||t.dirty===this._dirtyID},_dirtyCheck(){this._dirtyAll=!0;const t=this._dirty;if(!t.length||!this._dirtyID)return!0;const e=++this._dirtyID;let n,r,i,o,s,a,u;for(s=0,a=t.length;s<a;++s)n=t[s],r=n.mark,r.marktype!==i&&(i=r.marktype,o=$W[i]),r.zdirty&&r.dirty!==e&&(this._dirtyAll=!1,SH(n,e),r.items.forEach(t=>{t.dirty=e})),r.zdirty||(n.exit?(o.nested&&r.items.length?(u=r.items[0],u._svg&&this._update(o,u._svg,u)):n._svg&&(u=n._svg.parentNode,u&&u.removeChild(n._svg)),n._svg=null):(n=o.nested?r.items[0]:n,n._update!==e&&(n._svg&&n._svg.ownerSVGElement?this._update(o,n._svg,n):(this._dirtyAll=!1,SH(n,e)),n._update=e)));return!this._dirtyAll},mark(t,e,n){if(!this.isDirty(e))return e._svg;const r=this._svg,i=$W[e.marktype],o=!1===e.interactive?"none":null,s="g"===i.tag;let a=null,u=0;const c=CH(e,t,n,"g",r);c.setAttribute("class",nG(e));const l=nH(e);for(const f in l)DH(c,f,l[f]);s||DH(c,"pointer-events",o),DH(c,"clip-path",e.clip?cV(this,e,e.group):null);const h=t=>{const e=this.isDirty(t),n=CH(t,c,a,i.tag,r);e&&(this._update(i,n,t),s&&MH(this,n,t)),a=n,++u};return i.nested?e.items.length&&h(e.items[0]):rq(e,h),eG(c,u),c},_update(t,e,n){OH=e,PH=e.__values__,eH(LH,n),t.attr(LH,n,this);const r=TH[t.type];r&&r.call(this,t,e,n),OH&&this.style(OH,n)},style(t,e){if(null!=e)for(const n in mH){let r="font"===n?OW(e):e[n];if(r===PH[n])continue;const i=mH[n];null==r?t.removeAttribute(i):($U(r)&&(r=VU(r,this._defs.gradient,FH())),t.setAttribute(i,r+"")),PH[n]=r}},defs(){const t=this._svg,e=this._defs;let n=e.el,r=0;for(const i in e.gradient)n||(e.el=n=tG(t,vH+1,"defs",_H)),r=EH(n,e.gradient[i],r);for(const i in e.clipping)n||(e.el=n=tG(t,vH+1,"defs",_H)),r=AH(n,e.clipping[i],r);n&&(0===r?(t.removeChild(n),e.el=null):eG(n,r))},_clearDefs(){const t=this._defs;t.gradient={},t.clipping={}}});let OH=null,PH=null;const TH={group(t,e,n){const r=OH=e.childNodes[2];PH=r.__values__,t.foreground(LH,n,this),PH=e.__values__,OH=e.childNodes[1],t.content(LH,n,this);const i=OH=e.childNodes[0];t.background(LH,n,this);const o=!1===n.mark.interactive?"none":null;if(o!==PH.events&&(DH(r,"pointer-events",o),DH(i,"pointer-events",o),PH.events=o),n.strokeForeground&&n.stroke){const t=n.fill;DH(r,"display",null),this.style(i,n),DH(i,"stroke",null),t&&(n.fill=null),PH=r.__values__,this.style(r,n),t&&(n.fill=t),OH=null}else DH(r,"display","none")},image(t,e,n){!1===n.smooth?(IH(e,"image-rendering","optimizeSpeed"),IH(e,"image-rendering","pixelated")):IH(e,"image-rendering",null)},text(t,e,n){const r=EW(n);let i,o,s,a;fN(r)?(o=r.map(t=>MW(n,t)),i=o.join("\n"),i!==PH.text&&(eG(e,0),s=e.ownerDocument,a=xW(n),o.forEach((t,r)=>{const i=JW(s,"tspan",_H);i.__data__=n,i.textContent=t,r&&(i.setAttribute("x",0),i.setAttribute("dy",a)),e.appendChild(i)}),PH.text=i)):(o=MW(n,r),o!==PH.text&&(e.textContent=o,PH.text=o)),DH(e,"font-family",OW(n)),DH(e,"font-size",wW(n)+"px"),DH(e,"font-style",n.fontStyle),DH(e,"font-variant",n.fontVariant),DH(e,"font-weight",n.fontWeight)}};function LH(t,e,n){e!==PH[t]&&(n?RH(OH,t,e,n):DH(OH,t,e),PH[t]=e)}function IH(t,e,n){n!==PH[e]&&(null==n?t.style.removeProperty(e):t.style.setProperty(e,n+""),PH[e]=n)}function NH(t,e){for(const n in e)DH(t,n,e[n])}function DH(t,e,n){null!=n?t.setAttribute(e,n):t.removeAttribute(e)}function RH(t,e,n,r){null!=n?t.setAttributeNS(r,e,n):t.removeAttributeNS(r,e)}function FH(){let t;return"undefined"===typeof window?"":(t=window.location).hash?t.href.slice(0,-t.hash.length):t.href}function BH(t){aG.call(this,t),this._text=null,this._defs={gradient:{},clipping:{}}}function jH(t,e,n,r,i){if(null==e)return t;if("bgrect"===r&&!1===n.interactive&&(t["pointer-events"]="none"),"bgfore"===r&&(!1===n.interactive&&(t["pointer-events"]="none"),t.display="none",null!==e.fill))return t;"image"===r&&!1===e.smooth&&(t.style="image-rendering: optimizeSpeed; image-rendering: pixelated;"),"text"===r&&(t["font-family"]=OW(e),t["font-size"]=wW(e)+"px",t["font-style"]=e.fontStyle,t["font-variant"]=e.fontVariant,t["font-weight"]=e.fontWeight);for(const o in mH){let n=e[o];const r=mH[o];("transparent"!==n||"fill"!==r&&"stroke"!==r)&&null!=n&&($U(n)&&(n=VU(n,i.gradient,"")),t[r]=n)}return t}_N(BH,aG,{svg(){return this._text},_render(t){const e=dH();e.open("svg",yN({},Uq,{class:"marks",width:this._width*this._scale,height:this._height*this._scale,viewBox:`0 0 ${this._width} ${this._height}`}));const n=this._bgcolor;return n&&"transparent"!==n&&"none"!==n&&e.open("rect",{width:this._width,height:this._height,fill:n}).close(),e.open("g",yH,{transform:"translate("+this._origin+")"}),this.mark(e,t),e.close(),this.defs(e),this._text=e.close()+"",this},mark(t,e){const n=$W[e.marktype],r=n.tag,i=[eH,n.attr];t.open("g",{class:nG(e),"clip-path":e.clip?cV(this,e,e.group):null},nH(e),{"pointer-events":"g"!==r&&!1===e.interactive?"none":null});const o=o=>{const s=this.href(o);if(s&&t.open("a",s),t.open(r,this.attr(e,o,i,"g"!==r?r:null)),"text"===r){const e=EW(o);if(fN(e)){const n={x:0,dy:xW(o)};for(let r=0;r<e.length;++r)t.open("tspan",r?n:null).text(MW(o,e[r])).close()}else t.text(MW(o,e))}else if("g"===r){const r=o.strokeForeground,i=o.fill,s=o.stroke;r&&s&&(o.stroke=null),t.open("path",this.attr(e,o,n.background,"bgrect")).close(),t.open("g",this.attr(e,o,n.content)),rq(o,e=>this.mark(t,e)),t.close(),r&&s?(i&&(o.fill=null),o.stroke=s,t.open("path",this.attr(e,o,n.foreground,"bgrect")).close(),i&&(o.fill=i)):t.open("path",this.attr(e,o,n.foreground,"bgfore")).close()}t.close(),s&&t.close()};return n.nested?e.items&&e.items.length&&o(e.items[0]):rq(e,o),t.close()},href(t){const e=t.href;let n;if(e){if(n=this._hrefs&&this._hrefs[e])return n;this.sanitizeURL(e).then(t=>{t["xlink:href"]=t.href,t.href=null,(this._hrefs||(this._hrefs={}))[e]=t})}return null},attr(t,e,n,r){const i={},o=(t,e,n,r)=>{i[r||t]=e};return Array.isArray(n)?n.forEach(t=>t(o,e,this)):n(o,e,this),r&&jH(i,e,t,r,this._defs),i},defs(t){const e=this._defs.gradient,n=this._defs.clipping,r=Object.keys(e).length+Object.keys(n).length;if(0!==r){t.open("defs");for(const n in e){const r=e[n],i=r.stops;"radial"===r.gradient?(t.open("pattern",{id:UU+n,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),t.open("rect",{width:"1",height:"1",fill:"url(#"+n+")"}).close(),t.close(),t.open("radialGradient",{id:n,fx:r.x1,fy:r.y1,fr:r.r1,cx:r.x2,cy:r.y2,r:r.r2})):t.open("linearGradient",{id:n,x1:r.x1,x2:r.x2,y1:r.y1,y2:r.y2});for(let e=0;e<i.length;++e)t.open("stop",{offset:i[e].offset,"stop-color":i[e].color}).close();t.close()}for(const e in n){const r=n[e];t.open("clipPath",{id:e}),r.path?t.open("path",{d:r.path}).close():t.open("rect",{x:0,y:0,width:r.width,height:r.height}).close(),t.close()}t.close()}}});const zH="canvas",UH="png",$H="svg",VH="none",qH={Canvas:zH,PNG:UH,SVG:$H,None:VH},WH={};function GH(t,e){return t=String(t||"").toLowerCase(),arguments.length>1?(WH[t]=e,this):WH[t]}function HH(t,e,n){const r=[],i=(new lV).union(e),o=t.marktype;return o?XH(t,i,n,r):"group"===o?ZH(t,i,n,r):uN("Intersect scene must be mark node or group item.")}function XH(t,e,n,r){if(YH(t,e,n)){const i=t.items,o=t.marktype,s=i.length;let a=0;if("group"===o)for(;a<s;++a)ZH(i[a],e,n,r);else for(const t=$W[o].isect;a<s;++a){const n=i[a];KH(n,e,t)&&r.push(n)}}return r}function YH(t,e,n){return t.bounds&&e.intersects(t.bounds)&&("group"===t.marktype||!1!==t.interactive&&(!n||n(t)))}function ZH(t,e,n,r){n&&n(t.mark)&&KH(t,e,$W.group.isect)&&r.push(t);const i=t.items,o=i&&i.length;if(o){const s=t.x||0,a=t.y||0;e.translate(-s,-a);for(let t=0;t<o;++t)XH(i[t],e,n,r);e.translate(s,a)}return r}function KH(t,e,n){const r=t.bounds;return e.encloses(r)||e.intersects(r)&&n(t,e)}WH[zH]=WH[UH]={renderer:jG,headless:jG,handler:PG},WH[$H]={renderer:wH,headless:BH,handler:VG},WH[VH]={};const JH=new lV;function QH(t){const e=t.clip;if(mN(e))e(DV(JH.clear()));else{if(!e)return;JH.set(0,0,t.group.width,t.group.height)}t.bounds.intersect(JH)}const tX=1e-9;function eX(t,e,n){return t===e||("path"===n?nX(t,e):t instanceof Date&&e instanceof Date?+t===+e:wN(t)&&wN(e)?Math.abs(t-e)<=tX:t&&e&&(dN(t)||dN(e))?rX(t,e):t==e)}function nX(t,e){return eX(ZU(t),ZU(e))}function rX(t,e){var n,r,i=Object.keys(t),o=Object.keys(e);if(i.length!==o.length)return!1;for(i.sort(),o.sort(),r=i.length-1;r>=0;r--)if(i[r]!=o[r])return!1;for(r=i.length-1;r>=0;r--)if(n=i[r],!eX(t[n],e[n],n))return!1;return typeof t===typeof e}function iX(){uV(),zU()}function oX(t,e,n){return t.fields=e||[],t.fname=n,t}function sX(t){return 1===t.length?aX(t[0]):uX(t)}const aX=t=>(function(e){return e[t]}),uX=t=>{const e=t.length;return function(n){for(let r=0;r<e;++r)n=n[t[r]];return n}};function cX(t){throw Error(t)}function lX(t){const e=[],n=t.length;let r,i,o,s=null,a=0,u="";function c(){e.push(u+t.substring(r,i)),u="",r=i+1}for(t+="",r=i=0;i<n;++i)if(o=t[i],"\\"===o)u+=t.substring(r,i),u+=t.substring(++i,++i),r=i;else if(o===s)c(),s=null,a=-1;else{if(s)continue;r===a&&'"'===o?(r=i+1,s=o):r===a&&"'"===o?(r=i+1,s=o):"."!==o||a?"["===o?(i>r&&c(),a=r=i+1):"]"===o&&(a||cX("Access path missing open bracket: "+t),a>0&&c(),a=0,r=i+1):i>r?c():r=i+1}return a&&cX("Access path missing closing bracket: "+t),s&&cX("Access path missing closing quote: "+t),i>r&&(i++,c()),e}function hX(t,e,n){const r=lX(t);return t=1===r.length?r[0]:t,oX((n&&n.get||sX)(r),[t],e||t)}hX("id"),oX(t=>t,[],"identity"),oX(()=>0,[],"zero"),oX(()=>1,[],"one"),oX(()=>!0,[],"true"),oX(()=>!1,[],"false");Array.isArray;function fX(t){return t===Object(t)}function dX(t){return t[t.length-1]}function pX(t){for(let e,n,r=1,i=arguments.length;r<i;++r)for(n in e=arguments[r],e)t[n]=e[n];return t}Object.prototype.hasOwnProperty;function gX(t,e,n){const r=t.prototype=Object.create(e.prototype);return Object.defineProperty(r,"constructor",{value:t,writable:!0,enumerable:!0,configurable:!0}),pX(r,n)}const mX="top",yX="left",vX="right",bX="bottom",_X="top-left",wX="top-right",xX="bottom-left",SX="bottom-right",EX="start",AX="middle",MX="end",CX="x",kX="y",OX="group",PX="axis",TX="title",LX="frame",IX="scope",NX="legend",DX="row-header",RX="row-footer",FX="row-title",BX="column-header",jX="column-footer",zX="column-title",UX="padding",$X="symbol",VX="fit",qX="fit-x",WX="fit-y",GX="pad",HX="none",XX="all",YX="each",ZX="flush",KX="column",JX="row";function QX(t){JO.call(this,null,t)}function tY(t,e,n){return e(t.bounds.clear(),t,n)}gX(QX,JO,{transform(t,e){const n=e.dataflow,r=t.mark,i=r.marktype,o=$W[i],s=o.bound;let a,u=r.bounds;if(o.nested)r.items.length&&n.dirty(r.items[0]),u=tY(r,s),r.items.forEach(t=>{t.bounds.clear().union(u)});else if(i===OX||t.modified())switch(e.visit(e.MOD,t=>n.dirty(t)),u.clear(),r.items.forEach(t=>u.union(tY(t,s))),r.role){case PX:case NX:case TX:e.reflow()}else a=e.changed(e.REM),e.visit(e.ADD,t=>{u.union(tY(t,s))}),e.visit(e.MOD,t=>{a=a||u.alignsWith(t.bounds),n.dirty(t),u.union(tY(t,s))}),a&&(u.clear(),r.items.forEach(t=>u.union(t.bounds)));return QH(r),e.modifies("bounds")}});const eY=":vega_identifier:";function nY(t){JO.call(this,0,t)}function rY(t){return t._signals[eY]||(t._signals[eY]=t.add(0))}function iY(t){JO.call(this,null,t)}function oY(t){const e=t.groups,n=t.parent;return e&&1===e.size?e.get(Object.keys(e.object)[0]):e&&n?e.lookup(n):null}function sY(t){JO.call(this,null,t)}nY.Definition={type:"Identifier",metadata:{modifies:!0},params:[{name:"as",type:"string",required:!0}]},gX(nY,JO,{transform(t,e){const n=rY(e.dataflow),r=t.as;let i=n.value;return e.visit(e.ADD,t=>t[r]=t[r]||++i),n.set(this.value=i),e}}),gX(iY,JO,{transform(t,e){let n=this.value;n||(n=e.dataflow.scenegraph().mark(t.markdef,oY(t),t.index),n.group.context=t.context,t.context.group||(t.context.group=n.group),n.source=this.source,n.clip=t.clip,n.interactive=t.interactive,this.value=n);const r=n.marktype===OX?fV:hV;return e.visit(e.ADD,t=>r.call(t,n)),(t.modified("clip")||t.modified("interactive"))&&(n.clip=t.clip,n.interactive=!!t.interactive,n.zdirty=!0,e.reflow()),n.items=e.source,e}});const aY={parity:t=>t.filter((t,e)=>e%2?t.opacity=0:1),greedy:(t,e)=>{let n;return t.filter((t,r)=>r&&uY(n.bounds,t.bounds,e)?t.opacity=0:(n=t,1))}},uY=(t,e,n)=>n>Math.max(e.x1-t.x2,t.x1-e.x2,e.y1-t.y2,t.y1-e.y2),cY=(t,e)=>{for(var n,r=1,i=t.length,o=t[0].bounds;r<i;o=n,++r)if(uY(o,n=t[r].bounds,e))return!0},lY=t=>{const e=t.bounds;return e.width()>1&&e.height()>1},hY=(t,e,n)=>{var r=t.range(),i=new lV;return e===mX||e===bX?i.set(r[0],-1/0,r[1],1/0):i.set(-1/0,r[0],1/0,r[1]),i.expand(n||1),t=>i.encloses(t.bounds)},fY=t=>{return t.forEach(t=>t.opacity=1),t},dY=(t,e)=>t.reflow(e.modified()).modifies("opacity");function pY(t){JO.call(this,null,t)}gX(sY,JO,{transform(t,e){const n=aY[t.method]||aY.parity,r=t.separation||0;let i,o,s=e.materialize(e.SOURCE).source;if(!s||!s.length)return;if(!t.method)return t.modified("method")&&(fY(s),e=dY(e,t)),e;if(s=s.filter(lY),!s.length)return;if(t.sort&&(s=s.slice().sort(t.sort)),i=fY(s),e=dY(e,t),i.length>=3&&cY(i,r)){do{i=n(i,r)}while(i.length>=3&&cY(i,r));i.length<3&&!dX(s).opacity&&(i.length>1&&(dX(i).opacity=0),dX(s).opacity=1)}t.boundScale&&t.boundTolerance>=0&&(o=hY(t.boundScale,t.boundOrient,+t.boundTolerance),s.forEach(t=>{o(t)||(t.opacity=0)}));const a=i[0].mark.bounds.clear();return s.forEach(t=>{t.opacity&&a.union(t.bounds)}),e}}),gX(pY,JO,{transform(t,e){const n=e.dataflow;if(e.visit(e.ALL,t=>n.dirty(t)),e.fields&&e.fields["zindex"]){const t=e.source&&e.source[0];t&&(t.mark.zdirty=!0)}}});const gY=new lV;function mY(t,e,n){return t[e]===n?0:(t[e]=n,1)}function yY(t){var e=t.items[0].orient;return e===yX||e===vX}function vY(t){let e=+t.grid;return[t.ticks?e++:-1,t.labels?e++:-1,e+ +t.domain]}function bY(t,e,n,r){var i,o,s=e.items[0],a=s.datum,u=null!=s.translate?s.translate:.5,c=s.orient,l=vY(a),h=s.range,f=s.offset,d=s.position,p=s.minExtent,g=s.maxExtent,m=a.title&&s.items[l[2]].items[0],y=s.titlePadding,v=s.bounds,b=m&&AW(m),_=0,w=0;switch(gY.clear().union(v),v.clear(),(i=l[0])>-1&&v.union(s.items[i].bounds),(i=l[1])>-1&&v.union(s.items[i].bounds),c){case mX:_=d||0,w=-f,o=Math.max(p,Math.min(g,-v.y1)),v.add(0,-o).add(h,0),m&&_Y(t,m,o,y,b,0,-1,v);break;case yX:_=-f,w=d||0,o=Math.max(p,Math.min(g,-v.x1)),v.add(-o,0).add(0,h),m&&_Y(t,m,o,y,b,1,-1,v);break;case vX:_=n+f,w=d||0,o=Math.max(p,Math.min(g,v.x2)),v.add(0,0).add(o,h),m&&_Y(t,m,o,y,b,1,1,v);break;case bX:_=d||0,w=r+f,o=Math.max(p,Math.min(g,v.y2)),v.add(0,0).add(h,o),m&&_Y(t,m,o,y,0,0,1,v);break;default:_=s.x,w=s.y}return mV(v.translate(_,w),s),mY(s,"x",_+u)|mY(s,"y",w+u)&&(s.bounds=gY,t.dirty(s),s.bounds=v,t.dirty(s)),s.mark.bounds.clear().union(v)}function _Y(t,e,n,r,i,o,s,a){const u=e.bounds;if(e.auto){const a=s*(n+i+r);let c=0,l=0;t.dirty(e),o?c=(e.x||0)-(e.x=a):l=(e.y||0)-(e.y=a),e.mark.bounds.clear().union(u.translate(-c,-l)),t.dirty(e)}a.union(u)}const wY=(t,e)=>Math.floor(Math.min(t,e)),xY=(t,e)=>Math.ceil(Math.max(t,e));function SY(t){var e,n,r=t.items,i=r.length,o=0;const s={marks:[],rowheaders:[],rowfooters:[],colheaders:[],colfooters:[],rowtitle:null,coltitle:null};for(;o<i;++o)if(e=r[o],n=e.items,e.marktype===OX)switch(e.role){case PX:case NX:case TX:break;case DX:s.rowheaders.push(...n);break;case RX:s.rowfooters.push(...n);break;case BX:s.colheaders.push(...n);break;case jX:s.colfooters.push(...n);break;case FX:s.rowtitle=n[0];break;case zX:s.coltitle=n[0];break;default:s.marks.push(...n)}return s}function EY(t){return(new lV).set(0,0,t.width||0,t.height||0)}function AY(t){const e=t.bounds.clone();return e.empty()?e.set(0,0,0,0):e.translate(-(t.x||0),-(t.y||0))}function MY(t,e,n){const r=fX(t)?t[e]:t;return null!=r?r:void 0!==n?n:0}function CY(t){return t<0?Math.ceil(-t):0}function kY(t,e,n){var r,i,o,s,a,u,c,l,h,f,d,p=!n.nodirty,g=n.bounds===ZX?EY:AY,m=gY.set(0,0,0,0),y=MY(n.align,KX),v=MY(n.align,JX),b=MY(n.padding,KX),_=MY(n.padding,JX),w=n.columns||e.length,x=w<=0?1:Math.ceil(e.length/w),S=e.length,E=Array(S),A=Array(w),M=0,C=Array(S),k=Array(x),O=0,P=Array(S),T=Array(S),L=Array(S);for(i=0;i<w;++i)A[i]=0;for(i=0;i<x;++i)k[i]=0;for(i=0;i<S;++i)u=e[i],a=L[i]=g(u),u.x=u.x||0,P[i]=0,u.y=u.y||0,T[i]=0,o=i%w,s=~~(i/w),M=Math.max(M,c=Math.ceil(a.x2)),O=Math.max(O,l=Math.ceil(a.y2)),A[o]=Math.max(A[o],c),k[s]=Math.max(k[s],l),E[i]=b+CY(a.x1),C[i]=_+CY(a.y1),p&&t.dirty(e[i]);for(i=0;i<S;++i)i%w===0&&(E[i]=0),i<w&&(C[i]=0);if(y===YX)for(o=1;o<w;++o){for(d=0,i=o;i<S;i+=w)d<E[i]&&(d=E[i]);for(i=o;i<S;i+=w)E[i]=d+A[o-1]}else if(y===XX){for(d=0,i=0;i<S;++i)i%w&&d<E[i]&&(d=E[i]);for(i=0;i<S;++i)i%w&&(E[i]=d+M)}else for(y=!1,o=1;o<w;++o)for(i=o;i<S;i+=w)E[i]+=A[o-1];if(v===YX)for(s=1;s<x;++s){for(d=0,i=s*w,r=i+w;i<r;++i)d<C[i]&&(d=C[i]);for(i=s*w;i<r;++i)C[i]=d+k[s-1]}else if(v===XX){for(d=0,i=w;i<S;++i)d<C[i]&&(d=C[i]);for(i=w;i<S;++i)C[i]=d+O}else for(v=!1,s=1;s<x;++s)for(i=s*w,r=i+w;i<r;++i)C[i]+=k[s-1];for(h=0,i=0;i<S;++i)h=E[i]+(i%w?h:0),P[i]+=h-e[i].x;for(o=0;o<w;++o)for(f=0,i=o;i<S;i+=w)f+=C[i],T[i]+=f-e[i].y;if(y&&MY(n.center,KX)&&x>1)for(i=0;i<S;++i)a=y===XX?M:A[i%w],h=a-L[i].x2-e[i].x-P[i],h>0&&(P[i]+=h/2);if(v&&MY(n.center,JX)&&1!==w)for(i=0;i<S;++i)a=v===XX?O:k[~~(i/w)],f=a-L[i].y2-e[i].y-T[i],f>0&&(T[i]+=f/2);for(i=0;i<S;++i)m.union(L[i].translate(P[i],T[i]));switch(h=MY(n.anchor,CX),f=MY(n.anchor,kX),MY(n.anchor,KX)){case MX:h-=m.width();break;case AX:h-=m.width()/2}switch(MY(n.anchor,JX)){case MX:f-=m.height();break;case AX:f-=m.height()/2}for(h=Math.round(h),f=Math.round(f),m.clear(),i=0;i<S;++i)e[i].mark.bounds.clear();for(i=0;i<S;++i)u=e[i],u.x+=P[i]+=h,u.y+=T[i]+=f,m.union(u.mark.bounds.union(u.bounds.translate(P[i],T[i]))),p&&t.dirty(u);return m}function OY(t,e,n){var r,i,o,s,a,u,c,l=SY(e),h=l.marks,f=n.bounds===ZX?PY:TY,d=n.offset,p=n.columns||h.length,g=p<=0?1:Math.ceil(h.length/p),m=g*p;const y=kY(t,h,n);y.empty()&&y.set(0,0,0,0),l.rowheaders&&(u=MY(n.headerBand,JX,null),r=LY(t,l.rowheaders,h,p,g,-MY(d,"rowHeader"),wY,0,f,"x1",0,p,1,u)),l.colheaders&&(u=MY(n.headerBand,KX,null),i=LY(t,l.colheaders,h,p,p,-MY(d,"columnHeader"),wY,1,f,"y1",0,1,p,u)),l.rowfooters&&(u=MY(n.footerBand,JX,null),o=LY(t,l.rowfooters,h,p,g,MY(d,"rowFooter"),xY,0,f,"x2",p-1,p,1,u)),l.colfooters&&(u=MY(n.footerBand,KX,null),s=LY(t,l.colfooters,h,p,p,MY(d,"columnFooter"),xY,1,f,"y2",m-p,1,p,u)),l.rowtitle&&(a=MY(n.titleAnchor,JX),c=MY(d,"rowTitle"),c=a===MX?o+c:r-c,u=MY(n.titleBand,JX,.5),IY(t,l.rowtitle,c,0,y,u)),l.coltitle&&(a=MY(n.titleAnchor,KX),c=MY(d,"columnTitle"),c=a===MX?s+c:i-c,u=MY(n.titleBand,KX,.5),IY(t,l.coltitle,c,1,y,u))}function PY(t,e){return"x1"===e?t.x||0:"y1"===e?t.y||0:"x2"===e?(t.x||0)+(t.width||0):"y2"===e?(t.y||0)+(t.height||0):void 0}function TY(t,e){return t.bounds[e]}function LY(t,e,n,r,i,o,s,a,u,c,l,h,f,d){var p,g,m,y,v,b,_,w,x,S=n.length,E=0,A=0;if(!S)return E;for(p=l;p<S;p+=h)n[p]&&(E=s(E,u(n[p],c)));if(!e.length)return E;for(e.length>i&&(t.warn("Grid headers exceed limit: "+i),e=e.slice(0,i)),E+=o,g=0,y=e.length;g<y;++g)t.dirty(e[g]),e[g].mark.bounds.clear();for(p=l,g=0,y=e.length;g<y;++g,p+=h){for(b=e[g],v=b.mark.bounds,m=p;m>=0&&null==(_=n[m]);m-=f);a?(w=null==d?_.x:Math.round(_.bounds.x1+d*_.bounds.width()),x=E):(w=E,x=null==d?_.y:Math.round(_.bounds.y1+d*_.bounds.height())),v.union(b.bounds.translate(w-(b.x||0),x-(b.y||0))),b.x=w,b.y=x,t.dirty(b),A=s(A,v[c])}return A}function IY(t,e,n,r,i,o){if(e){t.dirty(e);var s=n,a=n;r?s=Math.round(i.x1+o*i.width()):a=Math.round(i.y1+o*i.height()),e.bounds.translate(s-(e.x||0),a-(e.y||0)),e.mark.bounds.clear().union(e.bounds),e.x=s,e.y=a,t.dirty(e)}}function NY(t,e){const n=t[e]||{};return(e,r)=>null!=n[e]?n[e]:null!=t[e]?t[e]:r}function DY(t,e){let n=-1/0;return t.forEach(t=>{null!=t.offset&&(n=Math.max(n,t.offset))}),n>-1/0?n:e}function RY(t,e,n,r,i,o,s){const a=NY(n,e),u=DY(t,a("offset",0)),c=a("anchor",EX),l=c===MX?1:c===AX?.5:0,h={align:YX,bounds:a("bounds",ZX),columns:"vertical"===a("direction")?1:t.length,padding:a("margin",8),center:a("center"),nodirty:!0};switch(e){case yX:h.anchor={x:Math.floor(r.x1)-u,column:MX,y:l*(s||r.height()+2*r.y1),row:c};break;case vX:h.anchor={x:Math.ceil(r.x2)+u,y:l*(s||r.height()+2*r.y1),row:c};break;case mX:h.anchor={y:Math.floor(i.y1)-u,row:MX,x:l*(o||i.width()+2*i.x1),column:c};break;case bX:h.anchor={y:Math.ceil(i.y2)+u,x:l*(o||i.width()+2*i.x1),column:c};break;case _X:h.anchor={x:u,y:u};break;case wX:h.anchor={x:o-u,y:u,column:MX};break;case xX:h.anchor={x:u,y:s-u,row:MX};break;case SX:h.anchor={x:o-u,y:s-u,column:MX,row:MX};break}return h}function FY(t,e){var n,r,i=e.items[0],o=i.datum,s=i.orient,a=i.bounds,u=i.x,c=i.y;return i._bounds?i._bounds.clear().union(a):i._bounds=a.clone(),a.clear(),jY(t,i,i.items[0].items[0]),a=BY(i,a),n=2*i.padding,r=2*i.padding,a.empty()||(n=Math.ceil(a.width()+n),r=Math.ceil(a.height()+r)),o.type===$X&&$Y(i.items[0].items[0].items[0].items),s!==HX&&(i.x=u=0,i.y=c=0),i.width=n,i.height=r,mV(a.set(u,c,u+n,c+r),i),i.mark.bounds.clear().union(a),i}function BY(t,e){return t.items.forEach(t=>e.union(t.bounds)),e.x1=t.padding,e.y1=t.padding,e}function jY(t,e,n){var r=e.padding,i=r-n.x,o=r-n.y;if(e.datum.title){var s=e.items[1].items[0],a=s.anchor,u=e.titlePadding||0,c=r-s.x,l=r-s.y;switch(s.orient){case yX:i+=Math.ceil(s.bounds.width())+u;break;case vX:case bX:break;default:o+=s.bounds.height()+u}switch((i||o)&&UY(t,n,i,o),s.orient){case yX:l+=zY(e,n,s,a,1,1);break;case vX:c+=zY(e,n,s,MX,0,0)+u,l+=zY(e,n,s,a,1,1);break;case bX:c+=zY(e,n,s,a,0,0),l+=zY(e,n,s,MX,-1,0,1)+u;break;default:c+=zY(e,n,s,a,0,0)}(c||l)&&UY(t,s,c,l),(c=Math.round(s.bounds.x1-r))<0&&(UY(t,n,-c,0),UY(t,s,-c,0))}else(i||o)&&UY(t,n,i,o)}function zY(t,e,n,r,i,o,s){const a="symbol"!==t.datum.type,u=n.datum.vgrad,c=!a||!o&&u||s?e:e.items[0],l=c.bounds[i?"y2":"x2"]-t.padding,h=u&&o?l:0,f=u&&o?0:l,d=i<=0?0:AW(n);return Math.round(r===EX?h:r===MX?f-d:.5*(l-d))}function UY(t,e,n,r){e.x+=n,e.y+=r,e.bounds.translate(n,r),e.mark.bounds.translate(n,r),t.dirty(e)}function $Y(t){const e=t.reduce((t,e)=>{return t[e.column]=Math.max(e.bounds.x2-e.x,t[e.column]||0),t},{});t.forEach(t=>{t.width=e[t.column],t.height=t.bounds.y2-t.y})}function VY(t,e,n,r,i){var o,s=e.items[0],a=s.frame,u=s.orient,c=s.anchor,l=s.offset,h=s.padding,f=s.items[0].items[0],d=s.items[1]&&s.items[1].items[0],p=u===yX||u===vX?r:n,g=0,m=0,y=0,v=0,b=0;if(a!==OX?u===yX?(g=i.y2,p=i.y1):u===vX?(g=i.y1,p=i.y2):(g=i.x1,p=i.x2):u===yX&&(g=r,p=0),o=c===EX?g:c===MX?p:(g+p)/2,d&&d.text){switch(u){case mX:case bX:b=f.bounds.height()+h;break;case yX:v=f.bounds.width()+h;break;case vX:v=-f.bounds.width()-h;break}gY.clear().union(d.bounds),gY.translate(v-(d.x||0),b-(d.y||0)),mY(d,"x",v)|mY(d,"y",b)&&(t.dirty(d),d.bounds.clear().union(gY),d.mark.bounds.clear().union(gY),t.dirty(d)),gY.clear().union(d.bounds)}else gY.clear();switch(gY.union(f.bounds),u){case mX:m=o,y=i.y1-gY.height()-l;break;case yX:m=i.x1-gY.width()-l,y=o;break;case vX:m=i.x2+gY.width()+l,y=o;break;case bX:m=o,y=i.y2+l;break;default:m=s.x,y=s.y}return mY(s,"x",m)|mY(s,"y",y)&&(gY.translate(m,y),t.dirty(s),s.bounds.clear().union(gY),e.bounds.clear().union(gY),t.dirty(s)),s.bounds}function qY(t){JO.call(this,null,t)}function WY(t){return t&&"legend-entry"!==t.mark.role}function GY(t,e,n){var r,i,o,s,a,u,c=e.items,l=Math.max(0,e.width||0),h=Math.max(0,e.height||0),f=(new lV).set(0,0,l,h),d=f.clone(),p=f.clone(),g=[];for(a=0,u=c.length;a<u;++a)switch(i=c[a],i.role){case PX:s=yY(i)?d:p,s.union(bY(t,i,l,h));break;case TX:r=i;break;case NX:g.push(FY(t,i));break;case LX:case IX:case DX:case RX:case FX:case BX:case jX:case zX:d.union(i.bounds),p.union(i.bounds);break;default:f.union(i.bounds)}if(g.length){const e={};g.forEach(t=>{o=t.orient||vX,o!==HX&&(e[o]||(e[o]=[])).push(t)});for(const r in e){const i=e[r];kY(t,i,RY(i,r,n.legends,d,p,l,h))}g.forEach(e=>{const r=e.bounds;if(r.equals(e._bounds)||(e.bounds=e._bounds,t.dirty(e),e.bounds=r,t.dirty(e)),n.autosize&&n.autosize.type===VX)switch(e.orient){case yX:case vX:f.add(r.x1,0).add(r.x2,0);break;case mX:case bX:f.add(0,r.y1).add(0,r.y2)}else f.union(r)})}f.union(d).union(p),r&&f.union(VY(t,r,l,h,f)),e.clip&&f.set(0,0,e.width||0,e.height||0),HY(t,e,f,n)}function HY(t,e,n,r){const i=r.autosize||{},o=i.type;if(t._autosize<1||!o)return;let s=t._width,a=t._height,u=Math.max(0,e.width||0),c=Math.max(0,Math.ceil(-n.x1)),l=Math.max(0,e.height||0),h=Math.max(0,Math.ceil(-n.y1));const f=Math.max(0,Math.ceil(n.x2-u)),d=Math.max(0,Math.ceil(n.y2-l));if(i.contains===UX){const e=t.padding();s-=e.left+e.right,a-=e.top+e.bottom}o===HX?(c=0,h=0,u=s,l=a):o===VX?(u=Math.max(0,s-c-f),l=Math.max(0,a-h-d)):o===qX?(u=Math.max(0,s-c-f),a=l+h+d):o===WX?(s=u+c+f,l=Math.max(0,a-h-d)):o===GX&&(s=u+c+f,a=l+h+d),t._resizeView(s,a,u,l,[c,h],i.resize)}function XY(t,e,n){return t.fields=e||[],t.fname=n,t}function YY(t){return 1===t.length?ZY(t[0]):KY(t)}gX(qY,JO,{transform(t,e){const n=e.dataflow;return t.mark.items.forEach(e=>{t.layout&&OY(n,e,t.layout),GY(n,e,t)}),WY(t.mark.group)?e.reflow():e}});const ZY=t=>(function(e){return e[t]}),KY=t=>{const e=t.length;return function(n){for(let r=0;r<e;++r)n=n[t[r]];return n}};function JY(t){throw Error(t)}function QY(t){const e=[],n=t.length;let r,i,o,s=null,a=0,u="";function c(){e.push(u+t.substring(r,i)),u="",r=i+1}for(t+="",r=i=0;i<n;++i)if(o=t[i],"\\"===o)u+=t.substring(r,i),u+=t.substring(++i,++i),r=i;else if(o===s)c(),s=null,a=-1;else{if(s)continue;r===a&&'"'===o?(r=i+1,s=o):r===a&&"'"===o?(r=i+1,s=o):"."!==o||a?"["===o?(i>r&&c(),a=r=i+1):"]"===o&&(a||JY("Access path missing open bracket: "+t),a>0&&c(),a=0,r=i+1):i>r?c():r=i+1}return a&&JY("Access path missing closing bracket: "+t),s&&JY("Access path missing closing quote: "+t),i>r&&(i++,c()),e}function tZ(t,e,n){const r=QY(t);return t=1===r.length?r[0]:t,XY((n&&n.get||YY)(r),[t],e||t)}tZ("id");const eZ=XY(t=>t,[],"identity"),nZ=(XY(()=>0,[],"zero"),XY(()=>1,[],"one")),rZ=(XY(()=>!0,[],"true"),XY(()=>!1,[],"false"));var iZ=Array.isArray;function oZ(t){return t===Object(t)}function sZ(t){return t[t.length-1]}function aZ(t){return null==t||""===t?null:+t}const uZ=t=>e=>t*Math.exp(e),cZ=t=>e=>Math.log(t*e),lZ=t=>e=>Math.sign(e)*Math.log1p(Math.abs(e/t)),hZ=t=>e=>Math.sign(e)*Math.expm1(Math.abs(e))*t,fZ=t=>e=>e<0?-Math.pow(-e,t):Math.pow(e,t);function dZ(t,e,n,r,i){const o=r(t[0]),s=r(sZ(t)),a=null!=e?r(e):(o+s)/2;return[i(a+(o-a)*n),i(a+(s-a)*n)]}function pZ(t,e,n){return dZ(t,e,n,aZ,eZ)}function gZ(t,e,n){const r=Math.sign(t[0]);return dZ(t,e,n,cZ(r),uZ(r))}function mZ(t,e,n,r){return dZ(t,e,n,fZ(r),fZ(1/r))}function yZ(t,e,n,r){return dZ(t,e,n,lZ(r),hZ(r))}function vZ(t){return"function"===typeof t}function bZ(t){return vZ(t)?t:()=>t}function _Z(t){for(let e,n,r=1,i=arguments.length;r<i;++r)for(n in e=arguments[r],e)t[n]=e[n];return t}const wZ=Object.prototype.hasOwnProperty;function xZ(t,e){return wZ.call(t,e)}const SZ={};function EZ(t){let e,n={};function r(t){return xZ(n,t)&&n[t]!==SZ}const i={size:0,empty:0,object:n,has:r,get(t){return r(t)?n[t]:void 0},set(t,e){return r(t)||(++i.size,n[t]===SZ&&--i.empty),n[t]=e,this},delete(t){return r(t)&&(--i.size,++i.empty,n[t]=SZ),this},clear(){i.size=i.empty=0,i.object=n={}},test(t){return arguments.length?(e=t,i):e},clean(){const t={};let r=0;for(const i in n){const o=n[i];o===SZ||e&&e(o)||(t[i]=o,++r)}i.size=r,i.empty=0,i.object=n=t}};return t&&Object.keys(t).forEach(e=>{i.set(e,t[e])}),i}function AZ(t,e,n){const r=t.prototype=Object.create(e.prototype);return Object.defineProperty(r,"constructor",{value:t,writable:!0,enumerable:!0,configurable:!0}),_Z(r,n)}function MZ(t){return"string"===typeof t}function CZ(t){return iZ(t)?"["+t.map(CZ)+"]":oZ(t)||MZ(t)?JSON.stringify(t).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):t}function kZ(t){const e={},n=t.length;for(let r=0;r<n;++r)e[t[r]]=!0;return e}function OZ(t,e){let n=0;if(void 0===e)for(let r of t)(r=+r)&&(n+=r);else{let r=-1;for(let i of t)(i=+e(i,++r,t))&&(n+=i)}return n}var PZ=function(t,e,n){t=+t,e=+e,n=(i=arguments.length)<2?(e=t,t=0,1):i<3?1:+n;var r=-1,i=0|Math.max(0,Math.ceil((e-t)/n)),o=new Array(i);while(++r<i)o[r]=t+r*n;return o};function TZ(t){JO.call(this,null,t)}function LZ(t){JO.call(this,null,t)}function IZ(){return jk({})}function NZ(t){const e=EZ().test(t=>t.exit);return e.lookup=n=>e.get(t(n)),e}function DZ(t){JO.call(this,null,t)}function RZ(t){JO.call(this,[],t)}AZ(TZ,JO,{transform(t,e){if(this.value&&!t.modified())return e.StopPropagation;var n=e.dataflow.locale(),r=e.fork(e.NO_SOURCE|e.NO_FIELDS),i=this.value,o=t.scale,s=null==t.count?t.values?t.values.length:10:t.count,a=vU(o,s,t.minstep),u=t.format||wU(n,o,a,t.formatSpecifier,t.formatType,!!t.values),c=t.values?bU(o,t.values,a):_U(o,a);return i&&(r.rem=i),i=c.map((t,e)=>jk({index:e/(c.length-1||1),value:t,label:u(t)})),t.extra&&i.length&&i.push(jk({index:-1,extra:{value:i[0].value},label:""})),r.source=i,r.add=i,this.value=i,r}}),AZ(LZ,JO,{transform(t,e){var n=e.dataflow,r=e.fork(e.NO_SOURCE|e.NO_FIELDS),i=t.item||IZ,o=t.key||Fk,s=this.value;return iZ(r.encode)&&(r.encode=null),s&&(t.modified("key")||e.modified(o))&&JY("DataJoin does not support modified key function or fields."),s||(e=e.addAll(),this.value=s=NZ(o)),e.visit(e.ADD,t=>{const e=o(t);let n=s.get(e);n?n.exit?(s.empty--,r.add.push(n)):r.mod.push(n):(n=i(t),s.set(e,n),r.add.push(n)),n.datum=t,n.exit=!1}),e.visit(e.MOD,t=>{const e=o(t),n=s.get(e);n&&(n.datum=t,r.mod.push(n))}),e.visit(e.REM,t=>{const e=o(t),n=s.get(e);t!==n.datum||n.exit||(r.rem.push(n),n.exit=!0,++s.empty)}),e.changed(e.ADD_MOD)&&r.modifies("datum"),(e.clean()||t.clean&&s.empty>n.cleanThreshold)&&n.runAfter(s.clean),r}}),AZ(DZ,JO,{transform(t,e){var n=e.fork(e.ADD_REM),r=t.mod||!1,i=t.encoders,o=e.encode;if(iZ(o)){if(!n.changed()&&!o.every(t=>i[t]))return e.StopPropagation;o=o[0],n.encode=null}var s="enter"===o,a=i.update||rZ,u=i.enter||rZ,c=i.exit||rZ,l=(o&&!s?i[o]:a)||rZ;if(e.changed(e.ADD)&&(e.visit(e.ADD,e=>{u(e,t),a(e,t)}),n.modifies(u.output),n.modifies(a.output),l!==rZ&&l!==a&&(e.visit(e.ADD,e=>{l(e,t)}),n.modifies(l.output))),e.changed(e.REM)&&c!==rZ&&(e.visit(e.REM,e=>{c(e,t)}),n.modifies(c.output)),s||l!==rZ){const i=e.MOD|(t.modified()?e.REFLOW:0);s?(e.visit(i,e=>{const i=u(e,t)||r;(l(e,t)||i)&&n.mod.push(e)}),n.mod.length&&n.modifies(u.output)):e.visit(i,e=>{(l(e,t)||r)&&n.mod.push(e)}),n.mod.length&&n.modifies(l.output)}return n.changed()?n:e.StopPropagation}}),AZ(RZ,JO,{transform(t,e){if(null!=this.value&&!t.modified())return e.StopPropagation;var n,r,i,o,s,a=e.dataflow.locale(),u=e.fork(e.NO_SOURCE|e.NO_FIELDS),c=this.value,l=t.type||fU,h=t.scale,f=+t.limit,d=vU(h,null==t.count?5:t.count,t.minstep),p=!!t.values||l===fU,g=t.format||PU(a,h,d,l,t.formatSpecifier,t.formatType,p),m=t.values||AU(h,d);return c&&(u.rem=c),l===fU?(f&&m.length>f?(e.dataflow.warn("Symbol legend count exceeds limit, filtering items."),c=m.slice(0,f-1),s=!0):c=m,vZ(i=t.size)?(t.values||0!==h(c[0])||(c=c.slice(1)),o=c.reduce((e,n)=>Math.max(e,i(n,t)),0)):i=bZ(o=i||8),c=c.map((e,n)=>jk({index:n,label:g(e,n,c),value:e,offset:o,size:i(e,t)})),s&&(s=m[c.length],c.push(jk({index:c.length,label:"…".concat(m.length-c.length," entries"),value:s,offset:o,size:i(s,t)})))):l===pU?(n=h.domain(),r=rU(h,n[0],sZ(n)),m.length<3&&!t.values&&n[0]!==sZ(n)&&(m=[n[0],sZ(n)]),c=m.map((t,e)=>jk({index:e,label:g(t,e,m),value:t,perc:r(t)}))):(i=m.length-1,r=RU(h),c=m.map((t,e)=>jk({index:e,label:g(t,e,m),value:t,perc:e?r(t):0,perc2:e===i?1:r(m[e+1])}))),u.source=c,u.add=c,this.value=c,u}});const FZ=t=>t.source.x,BZ=t=>t.source.y,jZ=t=>t.target.x,zZ=t=>t.target.y;function UZ(t){JO.call(this,{},t)}UZ.Definition={type:"LinkPath",metadata:{modifies:!0},params:[{name:"sourceX",type:"field",default:"source.x"},{name:"sourceY",type:"field",default:"source.y"},{name:"targetX",type:"field",default:"target.x"},{name:"targetY",type:"field",default:"target.y"},{name:"orient",type:"enum",default:"vertical",values:["horizontal","vertical","radial"]},{name:"shape",type:"enum",default:"line",values:["line","arc","curve","diagonal","orthogonal"]},{name:"require",type:"signal"},{name:"as",type:"string",default:"path"}]},AZ(UZ,JO,{transform(t,e){var n=t.sourceX||FZ,r=t.sourceY||BZ,i=t.targetX||jZ,o=t.targetY||zZ,s=t.as||"path",a=t.orient||"vertical",u=t.shape||"line",c=tK.get(u+"-"+a)||tK.get(u);return c||JY("LinkPath unsupported type: "+t.shape+(t.orient?"-"+t.orient:"")),e.visit(e.SOURCE,t=>{t[s]=c(n(t),r(t),i(t),o(t))}),e.reflow(t.modified()).modifies(s)}});const $Z=(t,e,n,r)=>"M"+t+","+e+"L"+n+","+r,VZ=(t,e,n,r)=>$Z(e*Math.cos(t),e*Math.sin(t),r*Math.cos(n),r*Math.sin(n)),qZ=(t,e,n,r)=>{var i=n-t,o=r-e,s=Math.sqrt(i*i+o*o)/2,a=180*Math.atan2(o,i)/Math.PI;return"M"+t+","+e+"A"+s+","+s+" "+a+" 0 1 "+n+","+r},WZ=(t,e,n,r)=>qZ(e*Math.cos(t),e*Math.sin(t),r*Math.cos(n),r*Math.sin(n)),GZ=(t,e,n,r)=>{const i=n-t,o=r-e,s=.2*(i+o),a=.2*(o-i);return"M"+t+","+e+"C"+(t+s)+","+(e+a)+" "+(n+a)+","+(r-s)+" "+n+","+r},HZ=(t,e,n,r)=>GZ(e*Math.cos(t),e*Math.sin(t),r*Math.cos(n),r*Math.sin(n)),XZ=(t,e,n,r)=>"M"+t+","+e+"V"+r+"H"+n,YZ=(t,e,n,r)=>"M"+t+","+e+"H"+n+"V"+r,ZZ=(t,e,n,r)=>{const i=Math.cos(t),o=Math.sin(t),s=Math.cos(n),a=Math.sin(n),u=Math.abs(n-t)>Math.PI?n<=t:n>t;return"M"+e*i+","+e*o+"A"+e+","+e+" 0 0,"+(u?1:0)+" "+e*s+","+e*a+"L"+r*s+","+r*a},KZ=(t,e,n,r)=>{const i=(t+n)/2;return"M"+t+","+e+"C"+i+","+e+" "+i+","+r+" "+n+","+r},JZ=(t,e,n,r)=>{const i=(e+r)/2;return"M"+t+","+e+"C"+t+","+i+" "+n+","+i+" "+n+","+r},QZ=(t,e,n,r)=>{const i=Math.cos(t),o=Math.sin(t),s=Math.cos(n),a=Math.sin(n),u=(e+r)/2;return"M"+e*i+","+e*o+"C"+u*i+","+u*o+" "+u*s+","+u*a+" "+r*s+","+r*a},tK=EZ({line:$Z,"line-radial":VZ,arc:qZ,"arc-radial":WZ,curve:GZ,"curve-radial":HZ,"orthogonal-horizontal":XZ,"orthogonal-vertical":YZ,"orthogonal-radial":ZZ,"diagonal-horizontal":KZ,"diagonal-vertical":JZ,"diagonal-radial":QZ});function eK(t){JO.call(this,null,t)}eK.Definition={type:"Pie",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"startAngle",type:"number",default:0},{name:"endAngle",type:"number",default:6.283185307179586},{name:"sort",type:"boolean",default:!1},{name:"as",type:"string",array:!0,length:2,default:["startAngle","endAngle"]}]},AZ(eK,JO,{transform(t,e){var n,r,i,o=t.as||["startAngle","endAngle"],s=o[0],a=o[1],u=t.field||nZ,c=t.startAngle||0,l=null!=t.endAngle?t.endAngle:2*Math.PI,h=e.source,f=h.map(u),d=f.length,p=c,g=(l-c)/OZ(f),m=PZ(d);for(t.sort&&m.sort((t,e)=>f[t]-f[e]),n=0;n<d;++n)i=f[m[n]],r=h[m[n]],r[s]=p,r[a]=p+=i*g;return this.value=f,e.reflow(t.modified()).modifies(o)}});const nK=5;function rK(t){const e=t.type;return!t.bins&&(e===hz||e===dz||e===pz)}function iK(t){return Gz(t)&&t!==vz}const oK=kZ(["set","modified","clear","type","scheme","schemeExtent","schemeCount","domain","domainMin","domainMid","domainMax","domainRaw","domainImplicit","nice","zero","bins","range","rangeStep","round","reverse","interpolate","interpolateGamma"]);function sK(t){JO.call(this,null,t),this.modified(!0)}function aK(t){var e,n=t.type,r="";return n===vz?vz+"-"+hz:(uK(t)&&(e=t.rawDomain?t.rawDomain.length:t.domain?t.domain.length+ +(null!=t.domainMid):0,r=2===e?vz+"-":3===e?bz+"-":""),(r+n||hz).toLowerCase())}function uK(t){const e=t.type;return Gz(e)&&e!==mz&&e!==yz&&(t.scheme||t.range&&t.range.length&&t.range.every(MZ))}function cK(t,e,n){const r=lK(t,e.domainRaw,n);if(r>-1)return r;var i,o,s=e.domain,a=t.type,u=e.zero||void 0===e.zero&&rK(t);if(!s)return 0;if(iK(a)&&e.padding&&s[0]!==sZ(s)&&(s=hK(a,s,e.range,e.padding,e.exponent,e.constant)),(u||null!=e.domainMin||null!=e.domainMax||null!=e.domainMid)&&(i=(s=s.slice()).length-1||1,u&&(s[0]>0&&(s[0]=0),s[i]<0&&(s[i]=0)),null!=e.domainMin&&(s[0]=e.domainMin),null!=e.domainMax&&(s[i]=e.domainMax),null!=e.domainMid)){o=e.domainMid;const t=o>s[i]?i+1:o<s[0]?0:i;t!==i&&n.warn("Scale domainMid exceeds domain min or max.",o),s.splice(t,0,o)}return t.domain(fK(a,s,n)),a===Sz&&t.unknown(e.domainImplicit?PR:void 0),e.nice&&t.nice&&t.nice(!0!==e.nice&&vU(t,e.nice)||null),s.length}function lK(t,e,n){return e?(t.domain(fK(t.type,e,n)),e.length):-1}function hK(t,e,n,r,i,o){var s=Math.abs(sZ(n)-n[0]),a=s/(s-2*r),u=t===fz?gZ(e,null,a):t===pz?mZ(e,null,a,.5):t===dz?mZ(e,null,a,i||1):t===gz?yZ(e,null,a,o||1):pZ(e,null,a);return e=e.slice(),e[0]=u[0],e[e.length-1]=u[1],e}function fK(t,e,n){if(Yz(t)){var r=Math.abs(e.reduce((t,e)=>t+(e<0?-1:e>0?1:0),0));r!==e.length&&n.warn("Log scale domain includes zero: "+CZ(e))}return e}function dK(t,e,n){let r=e.bins;if(r&&!iZ(r)){const e=t.domain(),n=e[0],i=sZ(e),o=r.step;let s=null==r.start?n:r.start,a=null==r.stop?i:r.stop;o||JY("Scale bins parameter missing step property."),s<n&&(s=o*Math.ceil(n/o)),a>i&&(a=o*Math.floor(i/o)),r=PZ(s,a+o/2,o)}return r?t.bins=r:t.bins&&delete t.bins,t.type===Mz&&(r?e.domain||e.domainRaw||(t.domain(r),n=r.length):t.bins=t.domain()),n}function pK(t,e,n){var r=t.type,i=e.round||!1,o=e.range;if(null!=e.rangeStep)o=gK(r,e,n);else if(e.scheme&&(o=mK(r,e,n),vZ(o))){if(t.interpolator)return t.interpolator(o);JY("Scale type ".concat(r," does not support interpolating color schemes."))}if(o&&Kz(r))return t.interpolator(eU(vK(o,e.reverse),e.interpolate,e.interpolateGamma));o&&e.interpolate&&t.interpolate?t.interpolate(iU(e.interpolate,e.interpolateGamma)):vZ(t.round)?t.round(i):vZ(t.rangeRound)&&t.interpolate(i?EF:SF),o&&t.range(vK(o,e.reverse))}function gK(t,e,n){t!==Az&&t!==Ez&&JY("Only band and point scales support rangeStep.");var r=(null!=e.paddingOuter?e.paddingOuter:e.padding)||0,i=t===Ez?1:(null!=e.paddingInner?e.paddingInner:e.padding)||0;return[0,e.rangeStep*cz(n,i,r)]}function mK(t,e,n){var r,i,o=e.schemeExtent;return iZ(e.scheme)?i=eU(e.scheme,e.interpolate,e.interpolateGamma):(r=e.scheme.toLowerCase(),i=hU(r),i||JY("Unrecognized scheme name: ".concat(e.scheme))),n=t===xz?n+1:t===Mz?n-1:t===_z||t===wz?+e.schemeCount||nK:n,Kz(t)?yK(i,o,e.reverse):vZ(i)?nU(yK(i,o),n):t===Sz?i:i.slice(0,n)}function yK(t,e,n){return vZ(t)&&(e||n)?tU(t,vK(e||[0,1],n)):t}function vK(t,e){return e?t.slice().reverse():t}function bK(t){JO.call(this,null,t)}AZ(sK,JO,{transform(t,e){var n=e.dataflow,r=this.value,i=aK(t);for(i in r&&i===r.type||(this.value=r=Vz(i)()),t)if(!oK[i]){if("padding"===i&&iK(r.type))continue;vZ(r[i])?r[i](t[i]):n.warn("Unsupported scale property: "+i)}return pK(r,t,dK(r,t,cK(r,t,n))),e.fork(e.NO_SOURCE|e.NO_FIELDS)}}),AZ(bK,JO,{transform(t,e){const n=t.modified("sort")||e.changed(e.ADD)||e.modified(t.sort.fields)||e.modified("datum");return n&&e.source.sort(Vk(t.sort)),this.modified(n),e}});const _K="zero",wK="center",xK="normalize",SK=["y0","y1"];function EK(t){JO.call(this,null,t)}function AK(t,e,n,r,i){for(var o,s=(e-t.sum)/2,a=t.length,u=0;u<a;++u)o=t[u],o[r]=s,o[i]=s+=Math.abs(n(o))}function MK(t,e,n,r,i){for(var o,s=1/t.sum,a=0,u=t.length,c=0,l=0;c<u;++c)o=t[c],o[r]=a,o[i]=a=s*(l+=Math.abs(n(o)))}function CK(t,e,n,r,i){for(var o,s,a=0,u=0,c=t.length,l=0;l<c;++l)s=t[l],o=+n(s),o<0?(s[r]=u,s[i]=u+=o):(s[r]=a,s[i]=a+=o)}function kK(t,e,n,r){var i,o,s,a,u,c,l,h,f,d=[],p=t=>t(u);if(null==e)d.push(t.slice());else for(i={},o=0,s=t.length;o<s;++o)u=t[o],c=e.map(p),l=i[c],l||(i[c]=l=[],d.push(l)),l.push(u);for(c=0,f=0,a=d.length;c<a;++c){for(l=d[c],o=0,h=0,s=l.length;o<s;++o)h+=Math.abs(r(l[o]));l.sum=h,h>f&&(f=h),n&&l.sort(n)}return d.max=f,d}function OK(t,e,n){return t.fields=e||[],t.fname=n,t}function PK(t){return null==t?null:t.fname}function TK(t){return null==t?null:t.fields}function LK(t){return 1===t.length?IK(t[0]):NK(t)}EK.Definition={type:"Stack",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"groupby",type:"field",array:!0},{name:"sort",type:"compare"},{name:"offset",type:"enum",default:_K,values:[_K,wK,xK]},{name:"as",type:"string",array:!0,length:2,default:SK}]},AZ(EK,JO,{transform(t,e){var n,r,i,o,s=t.as||SK,a=s[0],u=s[1],c=Vk(t.sort),l=t.field||nZ,h=t.offset===wK?AK:t.offset===xK?MK:CK;for(n=kK(e.source,t.groupby,c,l),r=0,i=n.length,o=n.max;r<i;++r)h(n[r],o,l,a,u);return e.reflow(t.modified()).modifies(s)}});const IK=t=>(function(e){return e[t]}),NK=t=>{const e=t.length;return function(n){for(let r=0;r<e;++r)n=n[t[r]];return n}};function DK(t){throw Error(t)}function RK(t){const e=[],n=t.length;let r,i,o,s=null,a=0,u="";function c(){e.push(u+t.substring(r,i)),u="",r=i+1}for(t+="",r=i=0;i<n;++i)if(o=t[i],"\\"===o)u+=t.substring(r,i),u+=t.substring(++i,++i),r=i;else if(o===s)c(),s=null,a=-1;else{if(s)continue;r===a&&'"'===o?(r=i+1,s=o):r===a&&"'"===o?(r=i+1,s=o):"."!==o||a?"["===o?(i>r&&c(),a=r=i+1):"]"===o&&(a||DK("Access path missing open bracket: "+t),a>0&&c(),a=0,r=i+1):i>r?c():r=i+1}return a&&DK("Access path missing closing bracket: "+t),s&&DK("Access path missing closing quote: "+t),i>r&&(i++,c()),e}function FK(t,e,n){const r=RK(t);return t=1===r.length?r[0]:t,OK((n&&n.get||LK)(r),[t],e||t)}FK("id");const BK=OK(t=>t,[],"identity"),jK=OK(()=>0,[],"zero"),zK=OK(()=>1,[],"one");OK(()=>!0,[],"true"),OK(()=>!1,[],"false");var UK=Array.isArray;function $K(t){return null!=t?UK(t)?t:[t]:[]}function VK(t){return"function"===typeof t}function qK(t){return VK(t)?t:()=>t}function WK(t){for(let e,n,r=1,i=arguments.length;r<i;++r)for(n in e=arguments[r],e)t[n]=e[n];return t}function GK(t,e){let n,r,i,o,s=0;if(t&&(n=t.length))if(null==e){for(r=t[s];s<n&&(null==r||r!==r);r=t[++s]);for(i=o=r;s<n;++s)r=t[s],null!=r&&(r<i&&(i=r),r>o&&(o=r))}else{for(r=e(t[s]);s<n&&(null==r||r!==r);r=e(t[++s]));for(i=o=r;s<n;++s)r=e(t[s]),null!=r&&(r<i&&(i=r),r>o&&(o=r))}return[i,o]}Object.prototype.hasOwnProperty;function HK(t,e,n){const r=t.prototype=Object.create(e.prototype);return Object.defineProperty(r,"constructor",{value:t,writable:!0,enumerable:!0,configurable:!0}),WK(r,n)}function XK(t){return"number"===typeof t}function YK(t){const e={},n=t.length;for(let r=0;r<n;++r)e[t[r]]=!0;return e}var ZK=Math.sqrt(50),KK=Math.sqrt(10),JK=Math.sqrt(2);function QK(t,e,n){var r=Math.abs(e-t)/Math.max(0,n),i=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),o=r/i;return o>=ZK?i*=10:o>=KK?i*=5:o>=JK&&(i*=2),e<t?-i:i}var tJ=function(t,e,n){t=+t,e=+e,n=(i=arguments.length)<2?(e=t,t=0,1):i<3?1:+n;var r=-1,i=0|Math.max(0,Math.ceil((e-t)/n)),o=new Array(i);while(++r<i)o[r]=t+r*n;return o};function eJ(t,e){let n;if(void 0===e)for(const r of t)null!=r&&(n<r||void 0===n&&r>=r)&&(n=r);else{let r=-1;for(let i of t)null!=(i=e(i,++r,t))&&(n<i||void 0===n&&i>=i)&&(n=i)}return n}function nJ(t,e){let n=0;if(void 0===e)for(let r of t)(r=+r)&&(n+=r);else{let r=-1;for(let i of t)(i=+e(i,++r,t))&&(n+=i)}return n}var rJ=t=>t;function iJ(t,e){t&&sJ.hasOwnProperty(t.type)&&sJ[t.type](t,e)}var oJ={Feature:function(t,e){iJ(t.geometry,e)},FeatureCollection:function(t,e){var n=t.features,r=-1,i=n.length;while(++r<i)iJ(n[r].geometry,e)}},sJ={Sphere:function(t,e){e.sphere()},Point:function(t,e){t=t.coordinates,e.point(t[0],t[1],t[2])},MultiPoint:function(t,e){var n=t.coordinates,r=-1,i=n.length;while(++r<i)t=n[r],e.point(t[0],t[1],t[2])},LineString:function(t,e){aJ(t.coordinates,e,0)},MultiLineString:function(t,e){var n=t.coordinates,r=-1,i=n.length;while(++r<i)aJ(n[r],e,0)},Polygon:function(t,e){uJ(t.coordinates,e)},MultiPolygon:function(t,e){var n=t.coordinates,r=-1,i=n.length;while(++r<i)uJ(n[r],e)},GeometryCollection:function(t,e){var n=t.geometries,r=-1,i=n.length;while(++r<i)iJ(n[r],e)}};function aJ(t,e,n){var r,i=-1,o=t.length-n;e.lineStart();while(++i<o)r=t[i],e.point(r[0],r[1],r[2]);e.lineEnd()}function uJ(t,e){var n=-1,r=t.length;e.polygonStart();while(++n<r)aJ(t[n],e,1);e.polygonEnd()}var cJ=function(t,e){t&&oJ.hasOwnProperty(t.type)?oJ[t.type](t,e):iJ(t,e)};class lJ{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){const e=this._partials;let n=0;for(let r=0;r<this._n&&r<32;r++){const i=e[r],o=t+i,s=Math.abs(t)<Math.abs(i)?t-(o-i):i-(o-t);s&&(e[n++]=s),t=o}return e[n]=t,this._n=n+1,this}valueOf(){const t=this._partials;let e,n,r,i=this._n,o=0;if(i>0){o=t[--i];while(i>0)if(e=o,n=t[--i],o=e+n,r=n-(o-e),r)break;i>0&&(r<0&&t[i-1]<0||r>0&&t[i-1]>0)&&(n=2*r,e=o+n,n==e-o&&(o=e))}return o}}var hJ=1e-6,fJ=1e-12,dJ=Math.PI,pJ=dJ/2,gJ=dJ/4,mJ=2*dJ,yJ=180/dJ,vJ=dJ/180,bJ=Math.abs,_J=Math.atan,wJ=Math.atan2,xJ=Math.cos,SJ=(Math.ceil,Math.exp),EJ=(Math.floor,Math.hypot,Math.log),AJ=Math.pow,MJ=Math.sin,CJ=Math.sign||function(t){return t>0?1:t<0?-1:0},kJ=Math.sqrt,OJ=Math.tan;function PJ(t){return t>1?0:t<-1?dJ:Math.acos(t)}function TJ(t){return t>1?pJ:t<-1?-pJ:Math.asin(t)}function LJ(){}var IJ,NJ,DJ,RJ,FJ=new lJ,BJ=new lJ,jJ={point:LJ,lineStart:LJ,lineEnd:LJ,polygonStart:function(){jJ.lineStart=zJ,jJ.lineEnd=VJ},polygonEnd:function(){jJ.lineStart=jJ.lineEnd=jJ.point=LJ,FJ.add(bJ(BJ)),BJ=new lJ},result:function(){var t=FJ/2;return FJ=new lJ,t}};function zJ(){jJ.point=UJ}function UJ(t,e){jJ.point=$J,IJ=DJ=t,NJ=RJ=e}function $J(t,e){BJ.add(RJ*t-DJ*e),DJ=t,RJ=e}function VJ(){$J(IJ,NJ)}var qJ=jJ,WJ=1/0,GJ=WJ,HJ=-WJ,XJ=HJ,YJ={point:ZJ,lineStart:LJ,lineEnd:LJ,polygonStart:LJ,polygonEnd:LJ,result:function(){var t=[[WJ,GJ],[HJ,XJ]];return HJ=XJ=-(GJ=WJ=1/0),t}};function ZJ(t,e){t<WJ&&(WJ=t),t>HJ&&(HJ=t),e<GJ&&(GJ=e),e>XJ&&(XJ=e)}var KJ,JJ,QJ,tQ,eQ=YJ,nQ=0,rQ=0,iQ=0,oQ=0,sQ=0,aQ=0,uQ=0,cQ=0,lQ=0,hQ={point:fQ,lineStart:dQ,lineEnd:mQ,polygonStart:function(){hQ.lineStart=yQ,hQ.lineEnd=vQ},polygonEnd:function(){hQ.point=fQ,hQ.lineStart=dQ,hQ.lineEnd=mQ},result:function(){var t=lQ?[uQ/lQ,cQ/lQ]:aQ?[oQ/aQ,sQ/aQ]:iQ?[nQ/iQ,rQ/iQ]:[NaN,NaN];return nQ=rQ=iQ=oQ=sQ=aQ=uQ=cQ=lQ=0,t}};function fQ(t,e){nQ+=t,rQ+=e,++iQ}function dQ(){hQ.point=pQ}function pQ(t,e){hQ.point=gQ,fQ(QJ=t,tQ=e)}function gQ(t,e){var n=t-QJ,r=e-tQ,i=kJ(n*n+r*r);oQ+=i*(QJ+t)/2,sQ+=i*(tQ+e)/2,aQ+=i,fQ(QJ=t,tQ=e)}function mQ(){hQ.point=fQ}function yQ(){hQ.point=bQ}function vQ(){_Q(KJ,JJ)}function bQ(t,e){hQ.point=_Q,fQ(KJ=QJ=t,JJ=tQ=e)}function _Q(t,e){var n=t-QJ,r=e-tQ,i=kJ(n*n+r*r);oQ+=i*(QJ+t)/2,sQ+=i*(tQ+e)/2,aQ+=i,i=tQ*t-QJ*e,uQ+=i*(QJ+t),cQ+=i*(tQ+e),lQ+=3*i,fQ(QJ=t,tQ=e)}var wQ=hQ;function xQ(t){this._context=t}xQ.prototype={_radius:4.5,pointRadius:function(t){return this._radius=t,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._context.closePath(),this._point=NaN},point:function(t,e){switch(this._point){case 0:this._context.moveTo(t,e),this._point=1;break;case 1:this._context.lineTo(t,e);break;default:this._context.moveTo(t+this._radius,e),this._context.arc(t,e,this._radius,0,mJ);break}},result:LJ};var SQ,EQ,AQ,MQ,CQ,kQ=new lJ,OQ={point:LJ,lineStart:function(){OQ.point=PQ},lineEnd:function(){SQ&&TQ(EQ,AQ),OQ.point=LJ},polygonStart:function(){SQ=!0},polygonEnd:function(){SQ=null},result:function(){var t=+kQ;return kQ=new lJ,t}};function PQ(t,e){OQ.point=TQ,EQ=MQ=t,AQ=CQ=e}function TQ(t,e){MQ-=t,CQ-=e,kQ.add(kJ(MQ*MQ+CQ*CQ)),MQ=t,CQ=e}var LQ=OQ;function IQ(){this._string=[]}function NQ(t){return"m0,"+t+"a"+t+","+t+" 0 1,1 0,"+-2*t+"a"+t+","+t+" 0 1,1 0,"+2*t+"z"}IQ.prototype={_radius:4.5,_circle:NQ(4.5),pointRadius:function(t){return(t=+t)!==this._radius&&(this._radius=t,this._circle=null),this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._string.push("Z"),this._point=NaN},point:function(t,e){switch(this._point){case 0:this._string.push("M",t,",",e),this._point=1;break;case 1:this._string.push("L",t,",",e);break;default:null==this._circle&&(this._circle=NQ(this._radius)),this._string.push("M",t,",",e,this._circle);break}},result:function(){if(this._string.length){var t=this._string.join("");return this._string=[],t}return null}};var DQ=function(t,e){var n,r,i=4.5;function o(t){return t&&("function"===typeof i&&r.pointRadius(+i.apply(this,arguments)),cJ(t,n(r))),r.result()}return o.area=function(t){return cJ(t,n(qJ)),qJ.result()},o.measure=function(t){return cJ(t,n(LQ)),LQ.result()},o.bounds=function(t){return cJ(t,n(eQ)),eQ.result()},o.centroid=function(t){return cJ(t,n(wQ)),wQ.result()},o.projection=function(e){return arguments.length?(n=null==e?(t=null,rJ):(t=e).stream,o):t},o.context=function(t){return arguments.length?(r=null==t?(e=null,new IQ):new xQ(e=t),"function"!==typeof i&&r.pointRadius(i),o):e},o.pointRadius=function(t){return arguments.length?(i="function"===typeof t?t:(r.pointRadius(+t),+t),o):i},o.projection(t).context(e)},RQ=function(){var t,e=[];return{point:function(e,n,r){t.push([e,n,r])},lineStart:function(){e.push(t=[])},lineEnd:LJ,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var n=e;return e=[],t=null,n}}},FQ=function(t,e){return bJ(t[0]-e[0])<hJ&&bJ(t[1]-e[1])<hJ};function BQ(t,e,n,r){this.x=t,this.z=e,this.o=n,this.e=r,this.v=!1,this.n=this.p=null}var jQ=function(t,e,n,r,i){var o,s,a=[],u=[];if(t.forEach((function(t){if(!((e=t.length-1)<=0)){var e,n,r=t[0],s=t[e];if(FQ(r,s)){if(!r[2]&&!s[2]){for(i.lineStart(),o=0;o<e;++o)i.point((r=t[o])[0],r[1]);return void i.lineEnd()}s[0]+=2*hJ}a.push(n=new BQ(r,t,null,!0)),u.push(n.o=new BQ(r,null,n,!1)),a.push(n=new BQ(s,t,null,!1)),u.push(n.o=new BQ(s,null,n,!0))}})),a.length){for(u.sort(e),zQ(a),zQ(u),o=0,s=u.length;o<s;++o)u[o].e=n=!n;var c,l,h=a[0];while(1){var f=h,d=!0;while(f.v)if((f=f.n)===h)return;c=f.z,i.lineStart();do{if(f.v=f.o.v=!0,f.e){if(d)for(o=0,s=c.length;o<s;++o)i.point((l=c[o])[0],l[1]);else r(f.x,f.n.x,1,i);f=f.n}else{if(d)for(c=f.p.z,o=c.length-1;o>=0;--o)i.point((l=c[o])[0],l[1]);else r(f.x,f.p.x,-1,i);f=f.p}f=f.o,c=f.z,d=!d}while(!f.v);i.lineEnd()}}};function zQ(t){if(e=t.length){var e,n,r=0,i=t[0];while(++r<e)i.n=n=t[r],n.p=i,i=n;i.n=n=t[0],n.p=i}}function UQ(t){return[wJ(t[1],t[0]),TJ(t[2])]}function $Q(t){var e=t[0],n=t[1],r=xJ(n);return[r*xJ(e),r*MJ(e),MJ(n)]}function VQ(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function qQ(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function WQ(t,e){t[0]+=e[0],t[1]+=e[1],t[2]+=e[2]}function GQ(t,e){return[t[0]*e,t[1]*e,t[2]*e]}function HQ(t){var e=kJ(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e,t[1]/=e,t[2]/=e}function XQ(t){return bJ(t[0])<=dJ?t[0]:CJ(t[0])*((bJ(t[0])+dJ)%mJ-dJ)}var YQ=function(t,e){var n=XQ(e),r=e[1],i=MJ(r),o=[MJ(n),-xJ(n),0],s=0,a=0,u=new lJ;1===i?r=pJ+hJ:-1===i&&(r=-pJ-hJ);for(var c=0,l=t.length;c<l;++c)if(f=(h=t[c]).length)for(var h,f,d=h[f-1],p=XQ(d),g=d[1]/2+gJ,m=MJ(g),y=xJ(g),v=0;v<f;++v,p=_,m=x,y=S,d=b){var b=h[v],_=XQ(b),w=b[1]/2+gJ,x=MJ(w),S=xJ(w),E=_-p,A=E>=0?1:-1,M=A*E,C=M>dJ,k=m*x;if(u.add(wJ(k*A*MJ(M),y*S+k*xJ(M))),s+=C?E+A*mJ:E,C^p>=n^_>=n){var O=qQ($Q(d),$Q(b));HQ(O);var P=qQ(o,O);HQ(P);var T=(C^E>=0?-1:1)*TJ(P[2]);(r>T||r===T&&(O[0]||O[1]))&&(a+=C^E>=0?1:-1)}}return(s<-hJ||s<hJ&&u<-fJ)^1&a};function*ZQ(t){for(const e of t)yield*e}function KQ(t){return Array.from(ZQ(t))}var JQ=function(t,e,n,r){return function(i){var o,s,a,u=e(i),c=RQ(),l=e(c),h=!1,f={point:d,lineStart:g,lineEnd:m,polygonStart:function(){f.point=y,f.lineStart=v,f.lineEnd=b,s=[],o=[]},polygonEnd:function(){f.point=d,f.lineStart=g,f.lineEnd=m,s=KQ(s);var t=YQ(o,r);s.length?(h||(i.polygonStart(),h=!0),jQ(s,t0,t,n,i)):t&&(h||(i.polygonStart(),h=!0),i.lineStart(),n(null,null,1,i),i.lineEnd()),h&&(i.polygonEnd(),h=!1),s=o=null},sphere:function(){i.polygonStart(),i.lineStart(),n(null,null,1,i),i.lineEnd(),i.polygonEnd()}};function d(e,n){t(e,n)&&i.point(e,n)}function p(t,e){u.point(t,e)}function g(){f.point=p,u.lineStart()}function m(){f.point=d,u.lineEnd()}function y(t,e){a.push([t,e]),l.point(t,e)}function v(){l.lineStart(),a=[]}function b(){y(a[0][0],a[0][1]),l.lineEnd();var t,e,n,r,u=l.clean(),f=c.result(),d=f.length;if(a.pop(),o.push(a),a=null,d)if(1&u){if(n=f[0],(e=n.length-1)>0){for(h||(i.polygonStart(),h=!0),i.lineStart(),t=0;t<e;++t)i.point((r=n[t])[0],r[1]);i.lineEnd()}}else d>1&&2&u&&f.push(f.pop().concat(f.shift())),s.push(f.filter(QQ))}return f}};function QQ(t){return t.length>1}function t0(t,e){return((t=t.x)[0]<0?t[1]-pJ-hJ:pJ-t[1])-((e=e.x)[0]<0?e[1]-pJ-hJ:pJ-e[1])}var e0=JQ((function(){return!0}),n0,i0,[-dJ,-pJ]);function n0(t){var e,n=NaN,r=NaN,i=NaN;return{lineStart:function(){t.lineStart(),e=1},point:function(o,s){var a=o>0?dJ:-dJ,u=bJ(o-n);bJ(u-dJ)<hJ?(t.point(n,r=(r+s)/2>0?pJ:-pJ),t.point(i,r),t.lineEnd(),t.lineStart(),t.point(a,r),t.point(o,r),e=0):i!==a&&u>=dJ&&(bJ(n-i)<hJ&&(n-=i*hJ),bJ(o-a)<hJ&&(o-=a*hJ),r=r0(n,r,o,s),t.point(i,r),t.lineEnd(),t.lineStart(),t.point(a,r),e=0),t.point(n=o,r=s),i=a},lineEnd:function(){t.lineEnd(),n=r=NaN},clean:function(){return 2-e}}}function r0(t,e,n,r){var i,o,s=MJ(t-n);return bJ(s)>hJ?_J((MJ(e)*(o=xJ(r))*MJ(n)-MJ(r)*(i=xJ(e))*MJ(t))/(i*o*s)):(e+r)/2}function i0(t,e,n,r){var i;if(null==t)i=n*pJ,r.point(-dJ,i),r.point(0,i),r.point(dJ,i),r.point(dJ,0),r.point(dJ,-i),r.point(0,-i),r.point(-dJ,-i),r.point(-dJ,0),r.point(-dJ,i);else if(bJ(t[0]-e[0])>hJ){var o=t[0]<e[0]?dJ:-dJ;i=n*o/2,r.point(-o,i),r.point(0,i),r.point(o,i)}else r.point(e[0],e[1])}var o0=function(t,e){function n(n,r){return n=t(n,r),e(n[0],n[1])}return t.invert&&e.invert&&(n.invert=function(n,r){return n=e.invert(n,r),n&&t.invert(n[0],n[1])}),n};function s0(t,e){return[bJ(t)>dJ?t+Math.round(-t/mJ)*mJ:t,e]}function a0(t,e,n){return(t%=mJ)?e||n?o0(c0(t),l0(e,n)):c0(t):e||n?l0(e,n):s0}function u0(t){return function(e,n){return e+=t,[e>dJ?e-mJ:e<-dJ?e+mJ:e,n]}}function c0(t){var e=u0(t);return e.invert=u0(-t),e}function l0(t,e){var n=xJ(t),r=MJ(t),i=xJ(e),o=MJ(e);function s(t,e){var s=xJ(e),a=xJ(t)*s,u=MJ(t)*s,c=MJ(e),l=c*n+a*r;return[wJ(u*i-l*o,a*n-c*r),TJ(l*i+u*o)]}return s.invert=function(t,e){var s=xJ(e),a=xJ(t)*s,u=MJ(t)*s,c=MJ(e),l=c*i-u*o;return[wJ(u*i+c*o,a*n+l*r),TJ(l*n-a*r)]},s}s0.invert=s0;var h0=function(t){function e(e){return e=t(e[0]*vJ,e[1]*vJ),e[0]*=yJ,e[1]*=yJ,e}return t=a0(t[0]*vJ,t[1]*vJ,t.length>2?t[2]*vJ:0),e.invert=function(e){return e=t.invert(e[0]*vJ,e[1]*vJ),e[0]*=yJ,e[1]*=yJ,e},e};function f0(t,e,n,r,i,o){if(n){var s=xJ(e),a=MJ(e),u=r*n;null==i?(i=e+r*mJ,o=e-u/2):(i=d0(s,i),o=d0(s,o),(r>0?i<o:i>o)&&(i+=r*mJ));for(var c,l=i;r>0?l>o:l<o;l-=u)c=UQ([s,-a*xJ(l),-a*MJ(l)]),t.point(c[0],c[1])}}function d0(t,e){e=$Q(e),e[0]-=t,HQ(e);var n=PJ(-e[1]);return((-e[2]<0?-n:n)+mJ-hJ)%mJ}var p0=function(t){var e=xJ(t),n=6*vJ,r=e>0,i=bJ(e)>hJ;function o(e,r,i,o){f0(o,t,n,i,e,r)}function s(t,n){return xJ(t)*xJ(n)>e}function a(t){var e,n,o,a,l;return{lineStart:function(){a=o=!1,l=1},point:function(h,f){var d,p=[h,f],g=s(h,f),m=r?g?0:c(h,f):g?c(h+(h<0?dJ:-dJ),f):0;if(!e&&(a=o=g)&&t.lineStart(),g!==o&&(d=u(e,p),(!d||FQ(e,d)||FQ(p,d))&&(p[2]=1)),g!==o)l=0,g?(t.lineStart(),d=u(p,e),t.point(d[0],d[1])):(d=u(e,p),t.point(d[0],d[1],2),t.lineEnd()),e=d;else if(i&&e&&r^g){var y;m&n||!(y=u(p,e,!0))||(l=0,r?(t.lineStart(),t.point(y[0][0],y[0][1]),t.point(y[1][0],y[1][1]),t.lineEnd()):(t.point(y[1][0],y[1][1]),t.lineEnd(),t.lineStart(),t.point(y[0][0],y[0][1],3)))}!g||e&&FQ(e,p)||t.point(p[0],p[1]),e=p,o=g,n=m},lineEnd:function(){o&&t.lineEnd(),e=null},clean:function(){return l|(a&&o)<<1}}}function u(t,n,r){var i=$Q(t),o=$Q(n),s=[1,0,0],a=qQ(i,o),u=VQ(a,a),c=a[0],l=u-c*c;if(!l)return!r&&t;var h=e*u/l,f=-e*c/l,d=qQ(s,a),p=GQ(s,h),g=GQ(a,f);WQ(p,g);var m=d,y=VQ(p,m),v=VQ(m,m),b=y*y-v*(VQ(p,p)-1);if(!(b<0)){var _=kJ(b),w=GQ(m,(-y-_)/v);if(WQ(w,p),w=UQ(w),!r)return w;var x,S=t[0],E=n[0],A=t[1],M=n[1];E<S&&(x=S,S=E,E=x);var C=E-S,k=bJ(C-dJ)<hJ,O=k||C<hJ;if(!k&&M<A&&(x=A,A=M,M=x),O?k?A+M>0^w[1]<(bJ(w[0]-S)<hJ?A:M):A<=w[1]&&w[1]<=M:C>dJ^(S<=w[0]&&w[0]<=E)){var P=GQ(m,(-y+_)/v);return WQ(P,p),[w,UQ(P)]}}}function c(e,n){var i=r?t:dJ-t,o=0;return e<-i?o|=1:e>i&&(o|=2),n<-i?o|=4:n>i&&(o|=8),o}return JQ(s,a,o,r?[0,-t]:[-dJ,t-dJ])},g0=function(t,e,n,r,i,o){var s,a=t[0],u=t[1],c=e[0],l=e[1],h=0,f=1,d=c-a,p=l-u;if(s=n-a,d||!(s>0)){if(s/=d,d<0){if(s<h)return;s<f&&(f=s)}else if(d>0){if(s>f)return;s>h&&(h=s)}if(s=i-a,d||!(s<0)){if(s/=d,d<0){if(s>f)return;s>h&&(h=s)}else if(d>0){if(s<h)return;s<f&&(f=s)}if(s=r-u,p||!(s>0)){if(s/=p,p<0){if(s<h)return;s<f&&(f=s)}else if(p>0){if(s>f)return;s>h&&(h=s)}if(s=o-u,p||!(s<0)){if(s/=p,p<0){if(s>f)return;s>h&&(h=s)}else if(p>0){if(s<h)return;s<f&&(f=s)}return h>0&&(t[0]=a+h*d,t[1]=u+h*p),f<1&&(e[0]=a+f*d,e[1]=u+f*p),!0}}}}},m0=1e9,y0=-m0;function v0(t,e,n,r){function i(i,o){return t<=i&&i<=n&&e<=o&&o<=r}function o(i,o,a,c){var l=0,h=0;if(null==i||(l=s(i,a))!==(h=s(o,a))||u(i,o)<0^a>0)do{c.point(0===l||3===l?t:n,l>1?r:e)}while((l=(l+a+4)%4)!==h);else c.point(o[0],o[1])}function s(r,i){return bJ(r[0]-t)<hJ?i>0?0:3:bJ(r[0]-n)<hJ?i>0?2:1:bJ(r[1]-e)<hJ?i>0?1:0:i>0?3:2}function a(t,e){return u(t.x,e.x)}function u(t,e){var n=s(t,1),r=s(e,1);return n!==r?n-r:0===n?e[1]-t[1]:1===n?t[0]-e[0]:2===n?t[1]-e[1]:e[0]-t[0]}return function(s){var u,c,l,h,f,d,p,g,m,y,v,b=s,_=RQ(),w={point:x,lineStart:M,lineEnd:C,polygonStart:E,polygonEnd:A};function x(t,e){i(t,e)&&b.point(t,e)}function S(){for(var e=0,n=0,i=c.length;n<i;++n)for(var o,s,a=c[n],u=1,l=a.length,h=a[0],f=h[0],d=h[1];u<l;++u)o=f,s=d,h=a[u],f=h[0],d=h[1],s<=r?d>r&&(f-o)*(r-s)>(d-s)*(t-o)&&++e:d<=r&&(f-o)*(r-s)<(d-s)*(t-o)&&--e;return e}function E(){b=_,u=[],c=[],v=!0}function A(){var t=S(),e=v&&t,n=(u=KQ(u)).length;(e||n)&&(s.polygonStart(),e&&(s.lineStart(),o(null,null,1,s),s.lineEnd()),n&&jQ(u,a,t,o,s),s.polygonEnd()),b=s,u=c=l=null}function M(){w.point=k,c&&c.push(l=[]),y=!0,m=!1,p=g=NaN}function C(){u&&(k(h,f),d&&m&&_.rejoin(),u.push(_.result())),w.point=x,m&&b.lineEnd()}function k(o,s){var a=i(o,s);if(c&&l.push([o,s]),y)h=o,f=s,d=a,y=!1,a&&(b.lineStart(),b.point(o,s));else if(a&&m)b.point(o,s);else{var u=[p=Math.max(y0,Math.min(m0,p)),g=Math.max(y0,Math.min(m0,g))],_=[o=Math.max(y0,Math.min(m0,o)),s=Math.max(y0,Math.min(m0,s))];g0(u,_,t,e,n,r)?(m||(b.lineStart(),b.point(u[0],u[1])),b.point(_[0],_[1]),a||b.lineEnd(),v=!1):a&&(b.lineStart(),b.point(o,s),v=!1)}p=o,g=s,m=a}return w}}function b0(t){return function(e){var n=new _0;for(var r in t)n[r]=t[r];return n.stream=e,n}}function _0(){}function w0(t,e,n){var r=t.clipExtent&&t.clipExtent();return t.scale(150).translate([0,0]),null!=r&&t.clipExtent(null),cJ(n,t.stream(eQ)),e(eQ.result()),null!=r&&t.clipExtent(r),t}function x0(t,e,n){return w0(t,(function(n){var r=e[1][0]-e[0][0],i=e[1][1]-e[0][1],o=Math.min(r/(n[1][0]-n[0][0]),i/(n[1][1]-n[0][1])),s=+e[0][0]+(r-o*(n[1][0]+n[0][0]))/2,a=+e[0][1]+(i-o*(n[1][1]+n[0][1]))/2;t.scale(150*o).translate([s,a])}),n)}function S0(t,e,n){return x0(t,[[0,0],e],n)}function E0(t,e,n){return w0(t,(function(n){var r=+e,i=r/(n[1][0]-n[0][0]),o=(r-i*(n[1][0]+n[0][0]))/2,s=-i*n[0][1];t.scale(150*i).translate([o,s])}),n)}function A0(t,e,n){return w0(t,(function(n){var r=+e,i=r/(n[1][1]-n[0][1]),o=-i*n[0][0],s=(r-i*(n[1][1]+n[0][1]))/2;t.scale(150*i).translate([o,s])}),n)}_0.prototype={constructor:_0,point:function(t,e){this.stream.point(t,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var M0=16,C0=xJ(30*vJ),k0=function(t,e){return+e?P0(t,e):O0(t)};function O0(t){return b0({point:function(e,n){e=t(e,n),this.stream.point(e[0],e[1])}})}function P0(t,e){function n(r,i,o,s,a,u,c,l,h,f,d,p,g,m){var y=c-r,v=l-i,b=y*y+v*v;if(b>4*e&&g--){var _=s+f,w=a+d,x=u+p,S=kJ(_*_+w*w+x*x),E=TJ(x/=S),A=bJ(bJ(x)-1)<hJ||bJ(o-h)<hJ?(o+h)/2:wJ(w,_),M=t(A,E),C=M[0],k=M[1],O=C-r,P=k-i,T=v*O-y*P;(T*T/b>e||bJ((y*O+v*P)/b-.5)>.3||s*f+a*d+u*p<C0)&&(n(r,i,o,s,a,u,C,k,A,_/=S,w/=S,x,g,m),m.point(C,k),n(C,k,A,_,w,x,c,l,h,f,d,p,g,m))}}return function(e){var r,i,o,s,a,u,c,l,h,f,d,p,g={point:m,lineStart:y,lineEnd:b,polygonStart:function(){e.polygonStart(),g.lineStart=_},polygonEnd:function(){e.polygonEnd(),g.lineStart=y}};function m(n,r){n=t(n,r),e.point(n[0],n[1])}function y(){l=NaN,g.point=v,e.lineStart()}function v(r,i){var o=$Q([r,i]),s=t(r,i);n(l,h,c,f,d,p,l=s[0],h=s[1],c=r,f=o[0],d=o[1],p=o[2],M0,e),e.point(l,h)}function b(){g.point=m,e.lineEnd()}function _(){y(),g.point=w,g.lineEnd=x}function w(t,e){v(r=t,e),i=l,o=h,s=f,a=d,u=p,g.point=v}function x(){n(l,h,c,f,d,p,i,o,r,s,a,u,M0,e),g.lineEnd=b,b()}return g}}var T0=b0({point:function(t,e){this.stream.point(t*vJ,e*vJ)}});function L0(t){return b0({point:function(e,n){var r=t(e,n);return this.stream.point(r[0],r[1])}})}function I0(t,e,n,r,i){function o(o,s){return o*=r,s*=i,[e+t*o,n-t*s]}return o.invert=function(o,s){return[(o-e)/t*r,(n-s)/t*i]},o}function N0(t,e,n,r,i,o){if(!o)return I0(t,e,n,r,i);var s=xJ(o),a=MJ(o),u=s*t,c=a*t,l=s/t,h=a/t,f=(a*n-s*e)/t,d=(a*e+s*n)/t;function p(t,o){return t*=r,o*=i,[u*t-c*o+e,n-c*t-u*o]}return p.invert=function(t,e){return[r*(l*t-h*e+f),i*(d-h*t-l*e)]},p}function D0(t){return R0((function(){return t}))()}function R0(t){var e,n,r,i,o,s,a,u,c,l,h=150,f=480,d=250,p=0,g=0,m=0,y=0,v=0,b=0,_=1,w=1,x=null,S=e0,E=null,A=rJ,M=.5;function C(t){return u(t[0]*vJ,t[1]*vJ)}function k(t){return t=u.invert(t[0],t[1]),t&&[t[0]*yJ,t[1]*yJ]}function O(){var t=N0(h,0,0,_,w,b).apply(null,e(p,g)),r=N0(h,f-t[0],d-t[1],_,w,b);return n=a0(m,y,v),a=o0(e,r),u=o0(n,a),s=k0(a,M),P()}function P(){return c=l=null,C}return C.stream=function(t){return c&&l===t?c:c=T0(L0(n)(S(s(A(l=t)))))},C.preclip=function(t){return arguments.length?(S=t,x=void 0,P()):S},C.postclip=function(t){return arguments.length?(A=t,E=r=i=o=null,P()):A},C.clipAngle=function(t){return arguments.length?(S=+t?p0(x=t*vJ):(x=null,e0),P()):x*yJ},C.clipExtent=function(t){return arguments.length?(A=null==t?(E=r=i=o=null,rJ):v0(E=+t[0][0],r=+t[0][1],i=+t[1][0],o=+t[1][1]),P()):null==E?null:[[E,r],[i,o]]},C.scale=function(t){return arguments.length?(h=+t,O()):h},C.translate=function(t){return arguments.length?(f=+t[0],d=+t[1],O()):[f,d]},C.center=function(t){return arguments.length?(p=t[0]%360*vJ,g=t[1]%360*vJ,O()):[p*yJ,g*yJ]},C.rotate=function(t){return arguments.length?(m=t[0]%360*vJ,y=t[1]%360*vJ,v=t.length>2?t[2]%360*vJ:0,O()):[m*yJ,y*yJ,v*yJ]},C.angle=function(t){return arguments.length?(b=t%360*vJ,O()):b*yJ},C.reflectX=function(t){return arguments.length?(_=t?-1:1,O()):_<0},C.reflectY=function(t){return arguments.length?(w=t?-1:1,O()):w<0},C.precision=function(t){return arguments.length?(s=k0(a,M=t*t),P()):kJ(M)},C.fitExtent=function(t,e){return x0(C,t,e)},C.fitSize=function(t,e){return S0(C,t,e)},C.fitWidth=function(t,e){return E0(C,t,e)},C.fitHeight=function(t,e){return A0(C,t,e)},function(){return e=t.apply(this,arguments),C.invert=e.invert&&k,O()}}function F0(t){var e=0,n=dJ/3,r=R0(t),i=r(e,n);return i.parallels=function(t){return arguments.length?r(e=t[0]*vJ,n=t[1]*vJ):[e*yJ,n*yJ]},i}function B0(t){var e=xJ(t);function n(t,n){return[t*e,MJ(n)/e]}return n.invert=function(t,n){return[t/e,TJ(n*e)]},n}function j0(t,e){var n=MJ(t),r=(n+MJ(e))/2;if(bJ(r)<hJ)return B0(t);var i=1+n*(2*r-n),o=kJ(i)/r;function s(t,e){var n=kJ(i-2*r*MJ(e))/r;return[n*MJ(t*=r),o-n*xJ(t)]}return s.invert=function(t,e){var n=o-e,s=wJ(t,bJ(n))*CJ(n);return n*r<0&&(s-=dJ*CJ(t)*CJ(n)),[s/r,TJ((i-(t*t+n*n)*r*r)/(2*r))]},s}var z0=function(){return F0(j0).scale(155.424).center([0,33.6442])},U0=function(){return z0().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])};function $0(t){var e=t.length;return{point:function(n,r){var i=-1;while(++i<e)t[i].point(n,r)},sphere:function(){var n=-1;while(++n<e)t[n].sphere()},lineStart:function(){var n=-1;while(++n<e)t[n].lineStart()},lineEnd:function(){var n=-1;while(++n<e)t[n].lineEnd()},polygonStart:function(){var n=-1;while(++n<e)t[n].polygonStart()},polygonEnd:function(){var n=-1;while(++n<e)t[n].polygonEnd()}}}var V0=function(){var t,e,n,r,i,o,s=U0(),a=z0().rotate([154,0]).center([-2,58.5]).parallels([55,65]),u=z0().rotate([157,0]).center([-3,19.9]).parallels([8,18]),c={point:function(t,e){o=[t,e]}};function l(t){var e=t[0],s=t[1];return o=null,n.point(e,s),o||(r.point(e,s),o)||(i.point(e,s),o)}function h(){return t=e=null,l}return l.invert=function(t){var e=s.scale(),n=s.translate(),r=(t[0]-n[0])/e,i=(t[1]-n[1])/e;return(i>=.12&&i<.234&&r>=-.425&&r<-.214?a:i>=.166&&i<.234&&r>=-.214&&r<-.115?u:s).invert(t)},l.stream=function(n){return t&&e===n?t:t=$0([s.stream(e=n),a.stream(n),u.stream(n)])},l.precision=function(t){return arguments.length?(s.precision(t),a.precision(t),u.precision(t),h()):s.precision()},l.scale=function(t){return arguments.length?(s.scale(t),a.scale(.35*t),u.scale(t),l.translate(s.translate())):s.scale()},l.translate=function(t){if(!arguments.length)return s.translate();var e=s.scale(),o=+t[0],l=+t[1];return n=s.translate(t).clipExtent([[o-.455*e,l-.238*e],[o+.455*e,l+.238*e]]).stream(c),r=a.translate([o-.307*e,l+.201*e]).clipExtent([[o-.425*e+hJ,l+.12*e+hJ],[o-.214*e-hJ,l+.234*e-hJ]]).stream(c),i=u.translate([o-.205*e,l+.212*e]).clipExtent([[o-.214*e+hJ,l+.166*e+hJ],[o-.115*e-hJ,l+.234*e-hJ]]).stream(c),h()},l.fitExtent=function(t,e){return x0(l,t,e)},l.fitSize=function(t,e){return S0(l,t,e)},l.fitWidth=function(t,e){return E0(l,t,e)},l.fitHeight=function(t,e){return A0(l,t,e)},l.scale(1070)};function q0(t){return function(e,n){var r=xJ(e),i=xJ(n),o=t(r*i);return o===1/0?[2,0]:[o*i*MJ(e),o*MJ(n)]}}function W0(t){return function(e,n){var r=kJ(e*e+n*n),i=t(r),o=MJ(i),s=xJ(i);return[wJ(e*o,r*s),TJ(r&&n*o/r)]}}var G0=q0((function(t){return kJ(2/(1+t))}));G0.invert=W0((function(t){return 2*TJ(t/2)}));var H0=function(){return D0(G0).scale(124.75).clipAngle(179.999)},X0=q0((function(t){return(t=PJ(t))&&t/MJ(t)}));X0.invert=W0((function(t){return t}));var Y0=function(){return D0(X0).scale(79.4188).clipAngle(179.999)};function Z0(t,e){return[t,EJ(OJ((pJ+e)/2))]}Z0.invert=function(t,e){return[t,2*_J(SJ(e))-pJ]};var K0=function(){return J0(Z0).scale(961/mJ)};function J0(t){var e,n,r,i=D0(t),o=i.center,s=i.scale,a=i.translate,u=i.clipExtent,c=null;function l(){var o=dJ*s(),a=i(h0(i.rotate()).invert([0,0]));return u(null==c?[[a[0]-o,a[1]-o],[a[0]+o,a[1]+o]]:t===Z0?[[Math.max(a[0]-o,c),e],[Math.min(a[0]+o,n),r]]:[[c,Math.max(a[1]-o,e)],[n,Math.min(a[1]+o,r)]])}return i.scale=function(t){return arguments.length?(s(t),l()):s()},i.translate=function(t){return arguments.length?(a(t),l()):a()},i.center=function(t){return arguments.length?(o(t),l()):o()},i.clipExtent=function(t){return arguments.length?(null==t?c=e=n=r=null:(c=+t[0][0],e=+t[0][1],n=+t[1][0],r=+t[1][1]),l()):null==c?null:[[c,e],[n,r]]},l()}function Q0(t){return OJ((pJ+t)/2)}function t1(t,e){var n=xJ(t),r=t===e?MJ(t):EJ(n/xJ(e))/EJ(Q0(e)/Q0(t)),i=n*AJ(Q0(t),r)/r;if(!r)return Z0;function o(t,e){i>0?e<-pJ+hJ&&(e=-pJ+hJ):e>pJ-hJ&&(e=pJ-hJ);var n=i/AJ(Q0(e),r);return[n*MJ(r*t),i-n*xJ(r*t)]}return o.invert=function(t,e){var n=i-e,o=CJ(r)*kJ(t*t+n*n),s=wJ(t,bJ(n))*CJ(n);return n*r<0&&(s-=dJ*CJ(t)*CJ(n)),[s/r,2*_J(AJ(i/o,1/r))-pJ]},o}var e1=function(){return F0(t1).scale(109.5).parallels([30,30])};function n1(t,e){return[t,e]}n1.invert=n1;var r1=function(){return D0(n1).scale(152.63)};function i1(t,e){var n=xJ(t),r=t===e?MJ(t):(n-xJ(e))/(e-t),i=n/r+t;if(bJ(r)<hJ)return n1;function o(t,e){var n=i-e,o=r*t;return[n*MJ(o),i-n*xJ(o)]}return o.invert=function(t,e){var n=i-e,o=wJ(t,bJ(n))*CJ(n);return n*r<0&&(o-=dJ*CJ(t)*CJ(n)),[o/r,i-CJ(r)*kJ(t*t+n*n)]},o}var o1=function(){return F0(i1).scale(131.154).center([0,13.9389])},s1=1.340264,a1=-.081106,u1=893e-6,c1=.003796,l1=kJ(3)/2,h1=12;function f1(t,e){var n=TJ(l1*MJ(e)),r=n*n,i=r*r*r;return[t*xJ(n)/(l1*(s1+3*a1*r+i*(7*u1+9*c1*r))),n*(s1+a1*r+i*(u1+c1*r))]}f1.invert=function(t,e){for(var n,r,i,o=e,s=o*o,a=s*s*s,u=0;u<h1;++u)if(r=o*(s1+a1*s+a*(u1+c1*s))-e,i=s1+3*a1*s+a*(7*u1+9*c1*s),o-=n=r/i,s=o*o,a=s*s*s,bJ(n)<fJ)break;return[l1*t*(s1+3*a1*s+a*(7*u1+9*c1*s))/xJ(o),TJ(MJ(o)/l1)]};var d1=function(){return D0(f1).scale(177.158)};function p1(t,e){var n=xJ(e),r=xJ(t)*n;return[n*MJ(t)/r,MJ(e)/r]}p1.invert=W0(_J);var g1=function(){return D0(p1).scale(144.049).clipAngle(60)},m1=function(){var t,e,n,r,i,o,s,a=1,u=0,c=0,l=1,h=1,f=0,d=null,p=1,g=1,m=b0({point:function(t,e){var n=b([t,e]);this.stream.point(n[0],n[1])}}),y=rJ;function v(){return p=a*l,g=a*h,o=s=null,b}function b(n){var r=n[0]*p,i=n[1]*g;if(f){var o=i*t-r*e;r=r*t+i*e,i=o}return[r+u,i+c]}return b.invert=function(n){var r=n[0]-u,i=n[1]-c;if(f){var o=i*t+r*e;r=r*t-i*e,i=o}return[r/p,i/g]},b.stream=function(t){return o&&s===t?o:o=m(y(s=t))},b.postclip=function(t){return arguments.length?(y=t,d=n=r=i=null,v()):y},b.clipExtent=function(t){return arguments.length?(y=null==t?(d=n=r=i=null,rJ):v0(d=+t[0][0],n=+t[0][1],r=+t[1][0],i=+t[1][1]),v()):null==d?null:[[d,n],[r,i]]},b.scale=function(t){return arguments.length?(a=+t,v()):a},b.translate=function(t){return arguments.length?(u=+t[0],c=+t[1],v()):[u,c]},b.angle=function(n){return arguments.length?(f=n%360*vJ,e=MJ(f),t=xJ(f),v()):f*yJ},b.reflectX=function(t){return arguments.length?(l=t?-1:1,v()):l<0},b.reflectY=function(t){return arguments.length?(h=t?-1:1,v()):h<0},b.fitExtent=function(t,e){return x0(b,t,e)},b.fitSize=function(t,e){return S0(b,t,e)},b.fitWidth=function(t,e){return E0(b,t,e)},b.fitHeight=function(t,e){return A0(b,t,e)},b};function y1(t,e){var n=e*e,r=n*n;return[t*(.8707-.131979*n+r*(r*(.003971*n-.001529*r)-.013791)),e*(1.007226+n*(.015085+r*(.028874*n-.044475-.005916*r)))]}y1.invert=function(t,e){var n,r=e,i=25;do{var o=r*r,s=o*o;r-=n=(r*(1.007226+o*(.015085+s*(.028874*o-.044475-.005916*s)))-e)/(1.007226+o*(.045255+s*(.259866*o-.311325-.005916*11*s)))}while(bJ(n)>hJ&&--i>0);return[t/(.8707+(o=r*r)*(o*(o*o*o*(.003971-.001529*o)-.013791)-.131979)),r]};var v1=function(){return D0(y1).scale(175.295)};function b1(t,e){return[xJ(e)*MJ(t),MJ(e)]}b1.invert=W0(TJ);var _1=function(){return D0(b1).scale(249.5).clipAngle(90+hJ)};function w1(t,e){var n=xJ(e),r=1+xJ(t)*n;return[n*MJ(t)/r,MJ(e)/r]}w1.invert=W0((function(t){return 2*_J(t)}));var x1=function(){return D0(w1).scale(250).clipAngle(142)};function S1(t,e){return[EJ(OJ((pJ+e)/2)),-t]}S1.invert=function(t,e){return[-e,2*_J(SJ(t))-pJ]};var E1=function(){var t=J0(S1),e=t.center,n=t.rotate;return t.center=function(t){return arguments.length?e([-t[1],t[0]]):(t=e(),[t[1],-t[0]])},t.rotate=function(t){return arguments.length?n([t[0],t[1],t.length>2?t[2]+90:90]):(t=n(),[t[0],t[1],t[2]-90])},n([0,0,90]).scale(159.155)};function A1(){}var M1=function(){var t,e=[];return{point:function(e,n,r){t.push([e,n,r])},lineStart:function(){e.push(t=[])},lineEnd:A1,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var n=e;return e=[],t=null,n}}},C1=1e-6,k1=1e-12,O1=Math.PI,P1=O1/2,T1=O1/4,L1=2*O1,I1=180/O1,N1=O1/180,D1=Math.abs,R1=Math.atan,F1=Math.atan2,B1=Math.cos,j1=(Math.ceil,Math.exp,Math.floor,Math.hypot,Math.log,Math.pow,Math.sin),z1=Math.sign||function(t){return t>0?1:t<0?-1:0},U1=Math.sqrt;Math.tan;function $1(t){return t>1?0:t<-1?O1:Math.acos(t)}function V1(t){return t>1?P1:t<-1?-P1:Math.asin(t)}var q1=function(t,e){return D1(t[0]-e[0])<C1&&D1(t[1]-e[1])<C1};function W1(t,e,n,r){this.x=t,this.z=e,this.o=n,this.e=r,this.v=!1,this.n=this.p=null}var G1=function(t,e,n,r,i){var o,s,a=[],u=[];if(t.forEach((function(t){if(!((e=t.length-1)<=0)){var e,n,r=t[0],s=t[e];if(q1(r,s)){if(!r[2]&&!s[2]){for(i.lineStart(),o=0;o<e;++o)i.point((r=t[o])[0],r[1]);return void i.lineEnd()}s[0]+=2*C1}a.push(n=new W1(r,t,null,!0)),u.push(n.o=new W1(r,null,n,!1)),a.push(n=new W1(s,t,null,!1)),u.push(n.o=new W1(s,null,n,!0))}})),a.length){for(u.sort(e),H1(a),H1(u),o=0,s=u.length;o<s;++o)u[o].e=n=!n;var c,l,h=a[0];while(1){var f=h,d=!0;while(f.v)if((f=f.n)===h)return;c=f.z,i.lineStart();do{if(f.v=f.o.v=!0,f.e){if(d)for(o=0,s=c.length;o<s;++o)i.point((l=c[o])[0],l[1]);else r(f.x,f.n.x,1,i);f=f.n}else{if(d)for(c=f.p.z,o=c.length-1;o>=0;--o)i.point((l=c[o])[0],l[1]);else r(f.x,f.p.x,-1,i);f=f.p}f=f.o,c=f.z,d=!d}while(!f.v);i.lineEnd()}}};function H1(t){if(e=t.length){var e,n,r=0,i=t[0];while(++r<e)i.n=n=t[r],n.p=i,i=n;i.n=n=t[0],n.p=i}}class X1{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){const e=this._partials;let n=0;for(let r=0;r<this._n&&r<32;r++){const i=e[r],o=t+i,s=Math.abs(t)<Math.abs(i)?t-(o-i):i-(o-t);s&&(e[n++]=s),t=o}return e[n]=t,this._n=n+1,this}valueOf(){const t=this._partials;let e,n,r,i=this._n,o=0;if(i>0){o=t[--i];while(i>0)if(e=o,n=t[--i],o=e+n,r=n-(o-e),r)break;i>0&&(r<0&&t[i-1]<0||r>0&&t[i-1]>0)&&(n=2*r,e=o+n,n==e-o&&(o=e))}return o}}function Y1(t){return[F1(t[1],t[0]),V1(t[2])]}function Z1(t){var e=t[0],n=t[1],r=B1(n);return[r*B1(e),r*j1(e),j1(n)]}function K1(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function J1(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function Q1(t,e){t[0]+=e[0],t[1]+=e[1],t[2]+=e[2]}function t2(t,e){return[t[0]*e,t[1]*e,t[2]*e]}function e2(t){var e=U1(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e,t[1]/=e,t[2]/=e}function n2(t){return D1(t[0])<=O1?t[0]:z1(t[0])*((D1(t[0])+O1)%L1-O1)}var r2=function(t,e){var n=n2(e),r=e[1],i=j1(r),o=[j1(n),-B1(n),0],s=0,a=0,u=new X1;1===i?r=P1+C1:-1===i&&(r=-P1-C1);for(var c=0,l=t.length;c<l;++c)if(f=(h=t[c]).length)for(var h,f,d=h[f-1],p=n2(d),g=d[1]/2+T1,m=j1(g),y=B1(g),v=0;v<f;++v,p=_,m=x,y=S,d=b){var b=h[v],_=n2(b),w=b[1]/2+T1,x=j1(w),S=B1(w),E=_-p,A=E>=0?1:-1,M=A*E,C=M>O1,k=m*x;if(u.add(F1(k*A*j1(M),y*S+k*B1(M))),s+=C?E+A*L1:E,C^p>=n^_>=n){var O=J1(Z1(d),Z1(b));e2(O);var P=J1(o,O);e2(P);var T=(C^E>=0?-1:1)*V1(P[2]);(r>T||r===T&&(O[0]||O[1]))&&(a+=C^E>=0?1:-1)}}return(s<-C1||s<C1&&u<-k1)^1&a};function*i2(t){for(const e of t)yield*e}function o2(t){return Array.from(i2(t))}var s2=function(t,e,n,r){return function(i){var o,s,a,u=e(i),c=M1(),l=e(c),h=!1,f={point:d,lineStart:g,lineEnd:m,polygonStart:function(){f.point=y,f.lineStart=v,f.lineEnd=b,s=[],o=[]},polygonEnd:function(){f.point=d,f.lineStart=g,f.lineEnd=m,s=o2(s);var t=r2(o,r);s.length?(h||(i.polygonStart(),h=!0),G1(s,u2,t,n,i)):t&&(h||(i.polygonStart(),h=!0),i.lineStart(),n(null,null,1,i),i.lineEnd()),h&&(i.polygonEnd(),h=!1),s=o=null},sphere:function(){i.polygonStart(),i.lineStart(),n(null,null,1,i),i.lineEnd(),i.polygonEnd()}};function d(e,n){t(e,n)&&i.point(e,n)}function p(t,e){u.point(t,e)}function g(){f.point=p,u.lineStart()}function m(){f.point=d,u.lineEnd()}function y(t,e){a.push([t,e]),l.point(t,e)}function v(){l.lineStart(),a=[]}function b(){y(a[0][0],a[0][1]),l.lineEnd();var t,e,n,r,u=l.clean(),f=c.result(),d=f.length;if(a.pop(),o.push(a),a=null,d)if(1&u){if(n=f[0],(e=n.length-1)>0){for(h||(i.polygonStart(),h=!0),i.lineStart(),t=0;t<e;++t)i.point((r=n[t])[0],r[1]);i.lineEnd()}}else d>1&&2&u&&f.push(f.pop().concat(f.shift())),s.push(f.filter(a2))}return f}};function a2(t){return t.length>1}function u2(t,e){return((t=t.x)[0]<0?t[1]-P1-C1:P1-t[1])-((e=e.x)[0]<0?e[1]-P1-C1:P1-e[1])}var c2=s2((function(){return!0}),l2,f2,[-O1,-P1]);function l2(t){var e,n=NaN,r=NaN,i=NaN;return{lineStart:function(){t.lineStart(),e=1},point:function(o,s){var a=o>0?O1:-O1,u=D1(o-n);D1(u-O1)<C1?(t.point(n,r=(r+s)/2>0?P1:-P1),t.point(i,r),t.lineEnd(),t.lineStart(),t.point(a,r),t.point(o,r),e=0):i!==a&&u>=O1&&(D1(n-i)<C1&&(n-=i*C1),D1(o-a)<C1&&(o-=a*C1),r=h2(n,r,o,s),t.point(i,r),t.lineEnd(),t.lineStart(),t.point(a,r),e=0),t.point(n=o,r=s),i=a},lineEnd:function(){t.lineEnd(),n=r=NaN},clean:function(){return 2-e}}}function h2(t,e,n,r){var i,o,s=j1(t-n);return D1(s)>C1?R1((j1(e)*(o=B1(r))*j1(n)-j1(r)*(i=B1(e))*j1(t))/(i*o*s)):(e+r)/2}function f2(t,e,n,r){var i;if(null==t)i=n*P1,r.point(-O1,i),r.point(0,i),r.point(O1,i),r.point(O1,0),r.point(O1,-i),r.point(0,-i),r.point(-O1,-i),r.point(-O1,0),r.point(-O1,i);else if(D1(t[0]-e[0])>C1){var o=t[0]<e[0]?O1:-O1;i=n*o/2,r.point(-o,i),r.point(0,i),r.point(o,i)}else r.point(e[0],e[1])}var d2=function(t,e){function n(n,r){return n=t(n,r),e(n[0],n[1])}return t.invert&&e.invert&&(n.invert=function(n,r){return n=e.invert(n,r),n&&t.invert(n[0],n[1])}),n};function p2(t,e){return[D1(t)>O1?t+Math.round(-t/L1)*L1:t,e]}function g2(t,e,n){return(t%=L1)?e||n?d2(y2(t),v2(e,n)):y2(t):e||n?v2(e,n):p2}function m2(t){return function(e,n){return e+=t,[e>O1?e-L1:e<-O1?e+L1:e,n]}}function y2(t){var e=m2(t);return e.invert=m2(-t),e}function v2(t,e){var n=B1(t),r=j1(t),i=B1(e),o=j1(e);function s(t,e){var s=B1(e),a=B1(t)*s,u=j1(t)*s,c=j1(e),l=c*n+a*r;return[F1(u*i-l*o,a*n-c*r),V1(l*i+u*o)]}return s.invert=function(t,e){var s=B1(e),a=B1(t)*s,u=j1(t)*s,c=j1(e),l=c*i-u*o;return[F1(u*i+c*o,a*n+l*r),V1(l*n-a*r)]},s}p2.invert=p2;function b2(t,e,n,r,i,o){if(n){var s=B1(e),a=j1(e),u=r*n;null==i?(i=e+r*L1,o=e-u/2):(i=_2(s,i),o=_2(s,o),(r>0?i<o:i>o)&&(i+=r*L1));for(var c,l=i;r>0?l>o:l<o;l-=u)c=Y1([s,-a*B1(l),-a*j1(l)]),t.point(c[0],c[1])}}function _2(t,e){e=Z1(e),e[0]-=t,e2(e);var n=$1(-e[1]);return((-e[2]<0?-n:n)+L1-C1)%L1}var w2=function(t){var e=B1(t),n=6*N1,r=e>0,i=D1(e)>C1;function o(e,r,i,o){b2(o,t,n,i,e,r)}function s(t,n){return B1(t)*B1(n)>e}function a(t){var e,n,o,a,l;return{lineStart:function(){a=o=!1,l=1},point:function(h,f){var d,p=[h,f],g=s(h,f),m=r?g?0:c(h,f):g?c(h+(h<0?O1:-O1),f):0;if(!e&&(a=o=g)&&t.lineStart(),g!==o&&(d=u(e,p),(!d||q1(e,d)||q1(p,d))&&(p[2]=1)),g!==o)l=0,g?(t.lineStart(),d=u(p,e),t.point(d[0],d[1])):(d=u(e,p),t.point(d[0],d[1],2),t.lineEnd()),e=d;else if(i&&e&&r^g){var y;m&n||!(y=u(p,e,!0))||(l=0,r?(t.lineStart(),t.point(y[0][0],y[0][1]),t.point(y[1][0],y[1][1]),t.lineEnd()):(t.point(y[1][0],y[1][1]),t.lineEnd(),t.lineStart(),t.point(y[0][0],y[0][1],3)))}!g||e&&q1(e,p)||t.point(p[0],p[1]),e=p,o=g,n=m},lineEnd:function(){o&&t.lineEnd(),e=null},clean:function(){return l|(a&&o)<<1}}}function u(t,n,r){var i=Z1(t),o=Z1(n),s=[1,0,0],a=J1(i,o),u=K1(a,a),c=a[0],l=u-c*c;if(!l)return!r&&t;var h=e*u/l,f=-e*c/l,d=J1(s,a),p=t2(s,h),g=t2(a,f);Q1(p,g);var m=d,y=K1(p,m),v=K1(m,m),b=y*y-v*(K1(p,p)-1);if(!(b<0)){var _=U1(b),w=t2(m,(-y-_)/v);if(Q1(w,p),w=Y1(w),!r)return w;var x,S=t[0],E=n[0],A=t[1],M=n[1];E<S&&(x=S,S=E,E=x);var C=E-S,k=D1(C-O1)<C1,O=k||C<C1;if(!k&&M<A&&(x=A,A=M,M=x),O?k?A+M>0^w[1]<(D1(w[0]-S)<C1?A:M):A<=w[1]&&w[1]<=M:C>O1^(S<=w[0]&&w[0]<=E)){var P=t2(m,(-y+_)/v);return Q1(P,p),[w,Y1(P)]}}}function c(e,n){var i=r?t:O1-t,o=0;return e<-i?o|=1:e>i&&(o|=2),n<-i?o|=4:n>i&&(o|=8),o}return s2(s,a,o,r?[0,-t]:[-O1,t-O1])},x2=function(t,e,n,r,i,o){var s,a=t[0],u=t[1],c=e[0],l=e[1],h=0,f=1,d=c-a,p=l-u;if(s=n-a,d||!(s>0)){if(s/=d,d<0){if(s<h)return;s<f&&(f=s)}else if(d>0){if(s>f)return;s>h&&(h=s)}if(s=i-a,d||!(s<0)){if(s/=d,d<0){if(s>f)return;s>h&&(h=s)}else if(d>0){if(s<h)return;s<f&&(f=s)}if(s=r-u,p||!(s>0)){if(s/=p,p<0){if(s<h)return;s<f&&(f=s)}else if(p>0){if(s>f)return;s>h&&(h=s)}if(s=o-u,p||!(s<0)){if(s/=p,p<0){if(s>f)return;s>h&&(h=s)}else if(p>0){if(s<h)return;s<f&&(f=s)}return h>0&&(t[0]=a+h*d,t[1]=u+h*p),f<1&&(e[0]=a+f*d,e[1]=u+f*p),!0}}}}},S2=1e9,E2=-S2;function A2(t,e,n,r){function i(i,o){return t<=i&&i<=n&&e<=o&&o<=r}function o(i,o,a,c){var l=0,h=0;if(null==i||(l=s(i,a))!==(h=s(o,a))||u(i,o)<0^a>0)do{c.point(0===l||3===l?t:n,l>1?r:e)}while((l=(l+a+4)%4)!==h);else c.point(o[0],o[1])}function s(r,i){return D1(r[0]-t)<C1?i>0?0:3:D1(r[0]-n)<C1?i>0?2:1:D1(r[1]-e)<C1?i>0?1:0:i>0?3:2}function a(t,e){return u(t.x,e.x)}function u(t,e){var n=s(t,1),r=s(e,1);return n!==r?n-r:0===n?e[1]-t[1]:1===n?t[0]-e[0]:2===n?t[1]-e[1]:e[0]-t[0]}return function(s){var u,c,l,h,f,d,p,g,m,y,v,b=s,_=M1(),w={point:x,lineStart:M,lineEnd:C,polygonStart:E,polygonEnd:A};function x(t,e){i(t,e)&&b.point(t,e)}function S(){for(var e=0,n=0,i=c.length;n<i;++n)for(var o,s,a=c[n],u=1,l=a.length,h=a[0],f=h[0],d=h[1];u<l;++u)o=f,s=d,h=a[u],f=h[0],d=h[1],s<=r?d>r&&(f-o)*(r-s)>(d-s)*(t-o)&&++e:d<=r&&(f-o)*(r-s)<(d-s)*(t-o)&&--e;return e}function E(){b=_,u=[],c=[],v=!0}function A(){var t=S(),e=v&&t,n=(u=o2(u)).length;(e||n)&&(s.polygonStart(),e&&(s.lineStart(),o(null,null,1,s),s.lineEnd()),n&&G1(u,a,t,o,s),s.polygonEnd()),b=s,u=c=l=null}function M(){w.point=k,c&&c.push(l=[]),y=!0,m=!1,p=g=NaN}function C(){u&&(k(h,f),d&&m&&_.rejoin(),u.push(_.result())),w.point=x,m&&b.lineEnd()}function k(o,s){var a=i(o,s);if(c&&l.push([o,s]),y)h=o,f=s,d=a,y=!1,a&&(b.lineStart(),b.point(o,s));else if(a&&m)b.point(o,s);else{var u=[p=Math.max(E2,Math.min(S2,p)),g=Math.max(E2,Math.min(S2,g))],_=[o=Math.max(E2,Math.min(S2,o)),s=Math.max(E2,Math.min(S2,s))];x2(u,_,t,e,n,r)?(m||(b.lineStart(),b.point(u[0],u[1])),b.point(_[0],_[1]),a||b.lineEnd(),v=!1):a&&(b.lineStart(),b.point(o,s),v=!1)}p=o,g=s,m=a}return w}}var M2=t=>t;function C2(t){return function(e){var n=new k2;for(var r in t)n[r]=t[r];return n.stream=e,n}}function k2(){}function O2(t,e){t&&T2.hasOwnProperty(t.type)&&T2[t.type](t,e)}k2.prototype={constructor:k2,point:function(t,e){this.stream.point(t,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var P2={Feature:function(t,e){O2(t.geometry,e)},FeatureCollection:function(t,e){var n=t.features,r=-1,i=n.length;while(++r<i)O2(n[r].geometry,e)}},T2={Sphere:function(t,e){e.sphere()},Point:function(t,e){t=t.coordinates,e.point(t[0],t[1],t[2])},MultiPoint:function(t,e){var n=t.coordinates,r=-1,i=n.length;while(++r<i)t=n[r],e.point(t[0],t[1],t[2])},LineString:function(t,e){L2(t.coordinates,e,0)},MultiLineString:function(t,e){var n=t.coordinates,r=-1,i=n.length;while(++r<i)L2(n[r],e,0)},Polygon:function(t,e){I2(t.coordinates,e)},MultiPolygon:function(t,e){var n=t.coordinates,r=-1,i=n.length;while(++r<i)I2(n[r],e)},GeometryCollection:function(t,e){var n=t.geometries,r=-1,i=n.length;while(++r<i)O2(n[r],e)}};function L2(t,e,n){var r,i=-1,o=t.length-n;e.lineStart();while(++i<o)r=t[i],e.point(r[0],r[1],r[2]);e.lineEnd()}function I2(t,e){var n=-1,r=t.length;e.polygonStart();while(++n<r)L2(t[n],e,1);e.polygonEnd()}var N2=function(t,e){t&&P2.hasOwnProperty(t.type)?P2[t.type](t,e):O2(t,e)},D2=1/0,R2=D2,F2=-D2,B2=F2,j2={point:z2,lineStart:A1,lineEnd:A1,polygonStart:A1,polygonEnd:A1,result:function(){var t=[[D2,R2],[F2,B2]];return F2=B2=-(R2=D2=1/0),t}};function z2(t,e){t<D2&&(D2=t),t>F2&&(F2=t),e<R2&&(R2=e),e>B2&&(B2=e)}var U2=j2;function $2(t,e,n){var r=t.clipExtent&&t.clipExtent();return t.scale(150).translate([0,0]),null!=r&&t.clipExtent(null),N2(n,t.stream(U2)),e(U2.result()),null!=r&&t.clipExtent(r),t}function V2(t,e,n){return $2(t,(function(n){var r=e[1][0]-e[0][0],i=e[1][1]-e[0][1],o=Math.min(r/(n[1][0]-n[0][0]),i/(n[1][1]-n[0][1])),s=+e[0][0]+(r-o*(n[1][0]+n[0][0]))/2,a=+e[0][1]+(i-o*(n[1][1]+n[0][1]))/2;t.scale(150*o).translate([s,a])}),n)}function q2(t,e,n){return V2(t,[[0,0],e],n)}function W2(t,e,n){return $2(t,(function(n){var r=+e,i=r/(n[1][0]-n[0][0]),o=(r-i*(n[1][0]+n[0][0]))/2,s=-i*n[0][1];t.scale(150*i).translate([o,s])}),n)}function G2(t,e,n){return $2(t,(function(n){var r=+e,i=r/(n[1][1]-n[0][1]),o=-i*n[0][0],s=(r-i*(n[1][1]+n[0][1]))/2;t.scale(150*i).translate([o,s])}),n)}var H2=16,X2=B1(30*N1),Y2=function(t,e){return+e?K2(t,e):Z2(t)};function Z2(t){return C2({point:function(e,n){e=t(e,n),this.stream.point(e[0],e[1])}})}function K2(t,e){function n(r,i,o,s,a,u,c,l,h,f,d,p,g,m){var y=c-r,v=l-i,b=y*y+v*v;if(b>4*e&&g--){var _=s+f,w=a+d,x=u+p,S=U1(_*_+w*w+x*x),E=V1(x/=S),A=D1(D1(x)-1)<C1||D1(o-h)<C1?(o+h)/2:F1(w,_),M=t(A,E),C=M[0],k=M[1],O=C-r,P=k-i,T=v*O-y*P;(T*T/b>e||D1((y*O+v*P)/b-.5)>.3||s*f+a*d+u*p<X2)&&(n(r,i,o,s,a,u,C,k,A,_/=S,w/=S,x,g,m),m.point(C,k),n(C,k,A,_,w,x,c,l,h,f,d,p,g,m))}}return function(e){var r,i,o,s,a,u,c,l,h,f,d,p,g={point:m,lineStart:y,lineEnd:b,polygonStart:function(){e.polygonStart(),g.lineStart=_},polygonEnd:function(){e.polygonEnd(),g.lineStart=y}};function m(n,r){n=t(n,r),e.point(n[0],n[1])}function y(){l=NaN,g.point=v,e.lineStart()}function v(r,i){var o=Z1([r,i]),s=t(r,i);n(l,h,c,f,d,p,l=s[0],h=s[1],c=r,f=o[0],d=o[1],p=o[2],H2,e),e.point(l,h)}function b(){g.point=m,e.lineEnd()}function _(){y(),g.point=w,g.lineEnd=x}function w(t,e){v(r=t,e),i=l,o=h,s=f,a=d,u=p,g.point=v}function x(){n(l,h,c,f,d,p,i,o,r,s,a,u,H2,e),g.lineEnd=b,b()}return g}}var J2=C2({point:function(t,e){this.stream.point(t*N1,e*N1)}});function Q2(t){return C2({point:function(e,n){var r=t(e,n);return this.stream.point(r[0],r[1])}})}function t3(t,e,n,r,i){function o(o,s){return o*=r,s*=i,[e+t*o,n-t*s]}return o.invert=function(o,s){return[(o-e)/t*r,(n-s)/t*i]},o}function e3(t,e,n,r,i,o){if(!o)return t3(t,e,n,r,i);var s=B1(o),a=j1(o),u=s*t,c=a*t,l=s/t,h=a/t,f=(a*n-s*e)/t,d=(a*e+s*n)/t;function p(t,o){return t*=r,o*=i,[u*t-c*o+e,n-c*t-u*o]}return p.invert=function(t,e){return[r*(l*t-h*e+f),i*(d-h*t-l*e)]},p}function n3(t){return r3((function(){return t}))()}function r3(t){var e,n,r,i,o,s,a,u,c,l,h=150,f=480,d=250,p=0,g=0,m=0,y=0,v=0,b=0,_=1,w=1,x=null,S=c2,E=null,A=M2,M=.5;function C(t){return u(t[0]*N1,t[1]*N1)}function k(t){return t=u.invert(t[0],t[1]),t&&[t[0]*I1,t[1]*I1]}function O(){var t=e3(h,0,0,_,w,b).apply(null,e(p,g)),r=e3(h,f-t[0],d-t[1],_,w,b);return n=g2(m,y,v),a=d2(e,r),u=d2(n,a),s=Y2(a,M),P()}function P(){return c=l=null,C}return C.stream=function(t){return c&&l===t?c:c=J2(Q2(n)(S(s(A(l=t)))))},C.preclip=function(t){return arguments.length?(S=t,x=void 0,P()):S},C.postclip=function(t){return arguments.length?(A=t,E=r=i=o=null,P()):A},C.clipAngle=function(t){return arguments.length?(S=+t?w2(x=t*N1):(x=null,c2),P()):x*I1},C.clipExtent=function(t){return arguments.length?(A=null==t?(E=r=i=o=null,M2):A2(E=+t[0][0],r=+t[0][1],i=+t[1][0],o=+t[1][1]),P()):null==E?null:[[E,r],[i,o]]},C.scale=function(t){return arguments.length?(h=+t,O()):h},C.translate=function(t){return arguments.length?(f=+t[0],d=+t[1],O()):[f,d]},C.center=function(t){return arguments.length?(p=t[0]%360*N1,g=t[1]%360*N1,O()):[p*I1,g*I1]},C.rotate=function(t){return arguments.length?(m=t[0]%360*N1,y=t[1]%360*N1,v=t.length>2?t[2]%360*N1:0,O()):[m*I1,y*I1,v*I1]},C.angle=function(t){return arguments.length?(b=t%360*N1,O()):b*I1},C.reflectX=function(t){return arguments.length?(_=t?-1:1,O()):_<0},C.reflectY=function(t){return arguments.length?(w=t?-1:1,O()):w<0},C.precision=function(t){return arguments.length?(s=Y2(a,M=t*t),P()):U1(M)},C.fitExtent=function(t,e){return V2(C,t,e)},C.fitSize=function(t,e){return q2(C,t,e)},C.fitWidth=function(t,e){return W2(C,t,e)},C.fitHeight=function(t,e){return G2(C,t,e)},function(){return e=t.apply(this,arguments),C.invert=e.invert&&k,O()}}var i3=Math.abs,o3=(Math.atan,Math.atan2,Math.ceil,Math.cos),s3=(Math.exp,Math.floor,Math.log,Math.max,Math.min,Math.pow,Math.round,Math.sign,Math.sin),a3=(Math.tan,1e-6),u3=Math.PI,c3=u3/2,l3=(Math.SQRT1_2,f3(2));f3(u3);function h3(t){return t>1?c3:t<-1?-c3:Math.asin(t)}function f3(t){return t>0?Math.sqrt(t):0}function d3(t,e){var n,r=t*s3(e),i=30;do{e-=n=(e+s3(e)-r)/(1+o3(e))}while(i3(n)>a3&&--i>0);return e/2}function p3(t,e,n){function r(r,i){return[t*r*o3(i=d3(n,i)),e*s3(i)]}return r.invert=function(r,i){return i=h3(i/e),[r/(t*o3(i)),h3((2*i+s3(2*i))/n)]},r}var g3=p3(l3/c3,l3,u3),m3=function(){return n3(g3).scale(169.529)};const y3=DQ(),v3=["clipAngle","clipExtent","scale","translate","center","rotate","parallels","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];function b3(t,e){return function n(){const r=e();return r.type=t,r.path=DQ().projection(r),r.copy=r.copy||function(){const t=n();return v3.forEach(e=>{r[e]&&t[e](r[e]())}),t.path.pointRadius(r.path.pointRadius()),t},r}}function _3(t,e){if(!t||"string"!==typeof t)throw new Error("Projection type must be a name string.");return t=t.toLowerCase(),arguments.length>1?(x3[t]=b3(t,e),this):x3[t]||null}function w3(t){return t&&t.path||y3}const x3={albers:U0,albersusa:V0,azimuthalequalarea:H0,azimuthalequidistant:Y0,conicconformal:e1,conicequalarea:z0,conicequidistant:o1,equalEarth:d1,equirectangular:r1,gnomonic:g1,identity:m1,mercator:K0,mollweide:m3,naturalEarth1:v1,orthographic:_1,stereographic:x1,transversemercator:E1};for(const L in x3)_3(L,x3[L]);var S3=1e-6,E3=(Math.PI,Math.abs),A3=(Math.atan,Math.atan2,Math.cos,Math.ceil);Math.exp,Math.floor,Math.hypot,Math.log,Math.pow,Math.sin,Math.sign,Math.sqrt,Math.tan;function M3(t,e,n){var r=tJ(t,e-S3,n).concat(e);return function(t){return r.map((function(e){return[t,e]}))}}function C3(t,e,n){var r=tJ(t,e-S3,n).concat(e);return function(t){return r.map((function(e){return[e,t]}))}}function k3(){var t,e,n,r,i,o,s,a,u,c,l,h,f=10,d=f,p=90,g=360,m=2.5;function y(){return{type:"MultiLineString",coordinates:v()}}function v(){return tJ(A3(r/p)*p,n,p).map(l).concat(tJ(A3(a/g)*g,s,g).map(h)).concat(tJ(A3(e/f)*f,t,f).filter((function(t){return E3(t%p)>S3})).map(u)).concat(tJ(A3(o/d)*d,i,d).filter((function(t){return E3(t%g)>S3})).map(c))}return y.lines=function(){return v().map((function(t){return{type:"LineString",coordinates:t}}))},y.outline=function(){return{type:"Polygon",coordinates:[l(r).concat(h(s).slice(1),l(n).reverse().slice(1),h(a).reverse().slice(1))]}},y.extent=function(t){return arguments.length?y.extentMajor(t).extentMinor(t):y.extentMinor()},y.extentMajor=function(t){return arguments.length?(r=+t[0][0],n=+t[1][0],a=+t[0][1],s=+t[1][1],r>n&&(t=r,r=n,n=t),a>s&&(t=a,a=s,s=t),y.precision(m)):[[r,a],[n,s]]},y.extentMinor=function(n){return arguments.length?(e=+n[0][0],t=+n[1][0],o=+n[0][1],i=+n[1][1],e>t&&(n=e,e=t,t=n),o>i&&(n=o,o=i,i=n),y.precision(m)):[[e,o],[t,i]]},y.step=function(t){return arguments.length?y.stepMajor(t).stepMinor(t):y.stepMinor()},y.stepMajor=function(t){return arguments.length?(p=+t[0],g=+t[1],y):[p,g]},y.stepMinor=function(t){return arguments.length?(f=+t[0],d=+t[1],y):[f,d]},y.precision=function(f){return arguments.length?(m=+f,u=M3(o,i,90),c=C3(e,t,m),l=M3(a,s,90),h=C3(r,n,m),y):m},y.extentMajor([[-180,-90+S3],[180,90-S3]]).extentMinor([[-180,-80-S3],[180,80+S3]])}var O3=function(t,e,n){t.prototype=e.prototype=n,n.constructor=t};function P3(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function T3(){}var L3=.7,I3=1/L3,N3="\\s*([+-]?\\d+)\\s*",D3="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",R3="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",F3=/^#([0-9a-f]{3,8})$/,B3=new RegExp("^rgb\\("+[N3,N3,N3]+"\\)$"),j3=new RegExp("^rgb\\("+[R3,R3,R3]+"\\)$"),z3=new RegExp("^rgba\\("+[N3,N3,N3,D3]+"\\)$"),U3=new RegExp("^rgba\\("+[R3,R3,R3,D3]+"\\)$"),$3=new RegExp("^hsl\\("+[D3,R3,R3]+"\\)$"),V3=new RegExp("^hsla\\("+[D3,R3,R3,D3]+"\\)$"),q3={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function W3(){return this.rgb().formatHex()}function G3(){return i4(this).formatHsl()}function H3(){return this.rgb().formatRgb()}function X3(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=F3.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?Y3(e):3===n?new Q3(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?Z3(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?Z3(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=B3.exec(t))?new Q3(e[1],e[2],e[3],1):(e=j3.exec(t))?new Q3(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=z3.exec(t))?Z3(e[1],e[2],e[3],e[4]):(e=U3.exec(t))?Z3(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=$3.exec(t))?r4(e[1],e[2]/100,e[3]/100,1):(e=V3.exec(t))?r4(e[1],e[2]/100,e[3]/100,e[4]):q3.hasOwnProperty(t)?Y3(q3[t]):"transparent"===t?new Q3(NaN,NaN,NaN,0):null}function Y3(t){return new Q3(t>>16&255,t>>8&255,255&t,1)}function Z3(t,e,n,r){return r<=0&&(t=e=n=NaN),new Q3(t,e,n,r)}function K3(t){return t instanceof T3||(t=X3(t)),t?(t=t.rgb(),new Q3(t.r,t.g,t.b,t.opacity)):new Q3}function J3(t,e,n,r){return 1===arguments.length?K3(t):new Q3(t,e,n,null==r?1:r)}function Q3(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}function t4(){return"#"+n4(this.r)+n4(this.g)+n4(this.b)}function e4(){var t=this.opacity;return t=isNaN(t)?1:Math.max(0,Math.min(1,t)),(1===t?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===t?")":", "+t+")")}function n4(t){return t=Math.max(0,Math.min(255,Math.round(t)||0)),(t<16?"0":"")+t.toString(16)}function r4(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new s4(t,e,n,r)}function i4(t){if(t instanceof s4)return new s4(t.h,t.s,t.l,t.opacity);if(t instanceof T3||(t=X3(t)),!t)return new s4;if(t instanceof s4)return t;t=t.rgb();var e=t.r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),o=Math.max(e,n,r),s=NaN,a=o-i,u=(o+i)/2;return a?(s=e===o?(n-r)/a+6*(n<r):n===o?(r-e)/a+2:(e-n)/a+4,a/=u<.5?o+i:2-o-i,s*=60):a=u>0&&u<1?0:s,new s4(s,a,u,t.opacity)}function o4(t,e,n,r){return 1===arguments.length?i4(t):new s4(t,e,n,null==r?1:r)}function s4(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function a4(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}function u4(){}O3(T3,X3,{copy:function(t){return Object.assign(new this.constructor,this,t)},displayable:function(){return this.rgb().displayable()},hex:W3,formatHex:W3,formatHsl:G3,formatRgb:H3,toString:H3}),O3(Q3,J3,P3(T3,{brighter:function(t){return t=null==t?I3:Math.pow(I3,t),new Q3(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=null==t?L3:Math.pow(L3,t),new Q3(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:t4,formatHex:t4,formatRgb:e4,toString:e4})),O3(s4,o4,P3(T3,{brighter:function(t){return t=null==t?I3:Math.pow(I3,t),new s4(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?L3:Math.pow(L3,t),new s4(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new Q3(a4(t>=240?t-240:t+120,i,r),a4(t,i,r),a4(t<120?t+240:t-120,i,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var t=this.opacity;return t=isNaN(t)?1:Math.max(0,Math.min(1,t)),(1===t?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===t?")":", "+t+")")}}));const c4=[[],[[[1,1.5],[.5,1]]],[[[1.5,1],[1,1.5]]],[[[1.5,1],[.5,1]]],[[[1,.5],[1.5,1]]],[[[1,1.5],[.5,1]],[[1,.5],[1.5,1]]],[[[1,.5],[1,1.5]]],[[[1,.5],[.5,1]]],[[[.5,1],[1,.5]]],[[[1,1.5],[1,.5]]],[[[.5,1],[1,.5]],[[1.5,1],[1,1.5]]],[[[1.5,1],[1,.5]]],[[[.5,1],[1.5,1]]],[[[1,1.5],[1.5,1]]],[[[.5,1],[1,1.5]]],[]];function l4(){var t=1,e=1,n=a;function r(t,e){return e.map(e=>i(t,e))}function i(t,e){var r=[],i=[];return o(t,e,o=>{n(o,t,e),h4(o)>0?r.push([o]):i.push(o)}),i.forEach(t=>{for(var e,n=0,i=r.length;n<i;++n)if(-1!==f4((e=r[n])[0],t))return void e.push(t)}),{type:"MultiPolygon",value:e,coordinates:r}}function o(n,r,i){var o,a,u,c,l,h,f=new Array,d=new Array;o=a=-1,c=n[0]>=r,c4[c<<1].forEach(p);while(++o<t-1)u=c,c=n[o+1]>=r,c4[u|c<<1].forEach(p);c4[c<<0].forEach(p);while(++a<e-1){o=-1,c=n[a*t+t]>=r,l=n[a*t]>=r,c4[c<<1|l<<2].forEach(p);while(++o<t-1)u=c,c=n[a*t+t+o+1]>=r,h=l,l=n[a*t+o+1]>=r,c4[u|c<<1|l<<2|h<<3].forEach(p);c4[c|l<<3].forEach(p)}o=-1,l=n[a*t]>=r,c4[l<<2].forEach(p);while(++o<t-1)h=l,l=n[a*t+o+1]>=r,c4[l<<2|h<<3].forEach(p);function p(t){var e,n,r=[t[0][0]+o,t[0][1]+a],u=[t[1][0]+o,t[1][1]+a],c=s(r),l=s(u);(e=d[c])?(n=f[l])?(delete d[e.end],delete f[n.start],e===n?(e.ring.push(u),i(e.ring)):f[e.start]=d[n.end]={start:e.start,end:n.end,ring:e.ring.concat(n.ring)}):(delete d[e.end],e.ring.push(u),d[e.end=l]=e):(e=f[l])?(n=d[c])?(delete f[e.start],delete d[n.end],e===n?(e.ring.push(u),i(e.ring)):f[n.start]=d[e.end]={start:n.start,end:e.end,ring:n.ring.concat(e.ring)}):(delete f[e.start],e.ring.unshift(r),f[e.start=c]=e):f[c]=d[l]={start:c,end:l,ring:[r,u]}}c4[l<<3].forEach(p)}function s(e){return 2*e[0]+e[1]*(t+1)*4}function a(n,r,i){n.forEach(n=>{var o,s=n[0],a=n[1],u=0|s,c=0|a,l=r[c*t+u];s>0&&s<t&&u===s&&(o=r[c*t+u-1],n[0]=s+(i-o)/(l-o)-.5),a>0&&a<e&&c===a&&(o=r[(c-1)*t+u],n[1]=a+(i-o)/(l-o)-.5)})}return r.contour=i,r.size=function(n){if(!arguments.length)return[t,e];var i=Math.floor(n[0]),o=Math.floor(n[1]);return i>=0&&o>=0||DK("invalid size"),t=i,e=o,r},r.smooth=function(t){return arguments.length?(n=t?a:u4,r):n===a},r}function h4(t){var e=0,n=t.length,r=t[n-1][1]*t[0][0]-t[n-1][0]*t[0][1];while(++e<n)r+=t[e-1][1]*t[e][0]-t[e-1][0]*t[e][1];return r}function f4(t,e){var n,r=-1,i=e.length;while(++r<i)if(n=d4(t,e[r]))return n;return 0}function d4(t,e){for(var n=e[0],r=e[1],i=-1,o=0,s=t.length,a=s-1;o<s;a=o++){var u=t[o],c=u[0],l=u[1],h=t[a],f=h[0],d=h[1];if(p4(u,h,e))return 0;l>r!==d>r&&n<(f-c)*(r-l)/(d-l)+c&&(i=-i)}return i}function p4(t,e,n){var r;return g4(t,e,n)&&m4(t[r=+(t[0]===e[0])],n[r],e[r])}function g4(t,e,n){return(e[0]-t[0])*(n[1]-t[1])===(n[0]-t[0])*(e[1]-t[1])}function m4(t,e,n){return t<=e&&e<=n||n<=e&&e<=t}function y4(t,e,n){return function(r){var i=GK(r),o=n?Math.min(i[0],0):i[0],s=i[1],a=s-o,u=e?QK(o,s,t):a/(t+1);return tJ(o+u,s,u)}}function v4(t){JO.call(this,null,t)}function b4(t,e,n){const r=y4(n.levels||10,n.nice,!1!==n.zero);return"shared"!==n.resolve?r:r(t.map(t=>eJ(e(t).values)))}function _4(t,e,n,r){let i=r.scale||e.scale,o=r.translate||e.translate;if(VK(i)&&(i=i(n,r)),VK(o)&&(o=o(n,r)),(1===i||null==i)&&!o)return;const s=(XK(i)?i:i[0])||1,a=(XK(i)?i:i[1])||1,u=o&&o[0]||0,c=o&&o[1]||0;t.forEach(w4(e,s,a,u,c))}function w4(t,e,n,r,i){const o=t.x1||0,s=t.y1||0,a=e*n<0;function u(t){t.forEach(c)}function c(t){a&&t.reverse(),t.forEach(l)}function l(t){t[0]=(t[0]-o)*e+r,t[1]=(t[1]-s)*n+i}return function(t){return t.coordinates.forEach(u),t}}function x4(t,e,n){const r=t>=0?t:JP(e,n);return Math.round((Math.sqrt(4*r*r+1)-1)/2)}function S4(t){return VK(t)?t:qK(+t)}function E4(){var t=t=>t[0],e=t=>t[1],n=zK,r=[-1,-1],i=960,o=500,s=2;function a(a,u){const c=x4(r[0],a,t)>>s,l=x4(r[1],a,e)>>s,h=c?c+2:0,f=l?l+2:0,d=2*h+(i>>s),p=2*f+(o>>s),g=new Float32Array(d*p),m=new Float32Array(d*p);let y=g;a.forEach(r=>{const i=h+(+t(r)>>s),o=f+(+e(r)>>s);i>=0&&i<d&&o>=0&&o<p&&(g[i+o*d]+=+n(r))}),c>0&&l>0?(A4(d,p,g,m,c),M4(d,p,m,g,l),A4(d,p,g,m,c),M4(d,p,m,g,l),A4(d,p,g,m,c),M4(d,p,m,g,l)):c>0?(A4(d,p,g,m,c),A4(d,p,m,g,c),A4(d,p,g,m,c),y=m):l>0&&(M4(d,p,g,m,l),M4(d,p,m,g,l),M4(d,p,g,m,l),y=m);const v=u?Math.pow(2,-2*s):1/nJ(y);for(let t=0,e=d*p;t<e;++t)y[t]*=v;return{values:y,scale:1<<s,width:d,height:p,x1:h,y1:f,x2:h+(i>>s),y2:f+(o>>s)}}return a.x=function(e){return arguments.length?(t=S4(e),a):t},a.y=function(t){return arguments.length?(e=S4(t),a):e},a.weight=function(t){return arguments.length?(n=S4(t),a):n},a.size=function(t){if(!arguments.length)return[i,o];var e=+t[0],n=+t[1];return e>=0&&n>=0||DK("invalid size"),i=e,o=n,a},a.cellSize=function(t){return arguments.length?((t=+t)>=1||DK("invalid cell size"),s=Math.floor(Math.log(t)/Math.LN2),a):1<<s},a.bandwidth=function(t){return arguments.length?(t=$K(t),1===t.length&&(t=[+t[0],+t[0]]),2!==t.length&&DK("invalid bandwidth"),r=t,a):r},a}function A4(t,e,n,r,i){const o=1+(i<<1);for(let s=0;s<e;++s)for(let e=0,a=0;e<t+i;++e)e<t&&(a+=n[e+s*t]),e>=i&&(e>=o&&(a-=n[e-o+s*t]),r[e-i+s*t]=a/Math.min(e+1,t-1+o-e,o))}function M4(t,e,n,r,i){const o=1+(i<<1);for(let s=0;s<t;++s)for(let a=0,u=0;a<e+i;++a)a<e&&(u+=n[s+a*t]),a>=i&&(a>=o&&(u-=n[s+(a-o)*t]),r[s+(a-i)*t]=u/Math.min(a+1,e-1+o-a,o))}function C4(t){JO.call(this,null,t)}v4.Definition={type:"Isocontour",metadata:{generates:!0},params:[{name:"field",type:"field"},{name:"thresholds",type:"number",array:!0},{name:"levels",type:"number"},{name:"nice",type:"boolean",default:!1},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"zero",type:"boolean",default:!0},{name:"smooth",type:"boolean",default:!0},{name:"scale",type:"number",expr:!0},{name:"translate",type:"number",array:!0,expr:!0},{name:"as",type:"string",null:!0,default:"contour"}]},HK(v4,JO,{transform(t,e){if(this.value&&!e.changed()&&!t.modified())return e.StopPropagation;var n=e.fork(e.NO_SOURCE|e.NO_FIELDS),r=e.materialize(e.SOURCE).source,i=t.field||BK,o=l4().smooth(!1!==t.smooth),s=t.thresholds||b4(r,i,t),a=null===t.as?null:t.as||"contour",u=[];return r.forEach(e=>{const n=i(e),r=o.size([n.width,n.height])(n.values,UK(s)?s:s(n.values));_4(r,n,e,t),r.forEach(t=>{u.push(Uk(e,jk(null!=a?{[a]:t}:t)))})}),this.value&&(n.rem=this.value),this.value=n.source=n.add=u,n}}),C4.Definition={type:"KDE2D",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"weight",type:"field"},{name:"groupby",type:"field",array:!0},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number",array:!0,length:2},{name:"counts",type:"boolean",default:!1},{name:"as",type:"string",default:"grid"}]};const k4=["x","y","weight","size","cellSize","bandwidth"];function O4(t,e){return k4.forEach(n=>null!=e[n]?t[n](e[n]):0),t}function P4(t,e){var n,r,i,o,s,a,u=[],c=t=>t(o);if(null==e)u.push(t);else for(n={},r=0,i=t.length;r<i;++r)o=t[r],s=e.map(c),a=n[s],a||(n[s]=a=[],a.dims=s,u.push(a)),a.push(o);return u}function T4(t){JO.call(this,null,t)}HK(C4,JO,{transform(t,e){if(this.value&&!e.changed()&&!t.modified())return e.StopPropagation;var n=e.fork(e.NO_SOURCE|e.NO_FIELDS),r=e.materialize(e.SOURCE).source,i=P4(r,t.groupby),o=(t.groupby||[]).map(PK),s=O4(E4(),t),a=t.as||"grid",u=[];function c(t,e){for(let n=0;n<o.length;++n)t[o[n]]=e[n];return t}return u=i.map(e=>jk(c({[a]:s(e,t.counts)},e.dims))),this.value&&(n.rem=this.value),this.value=n.source=n.add=u,n}}),T4.Definition={type:"Contour",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"values",type:"number",array:!0},{name:"x",type:"field"},{name:"y",type:"field"},{name:"weight",type:"field"},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number"},{name:"count",type:"number"},{name:"nice",type:"boolean",default:!1},{name:"thresholds",type:"number",array:!0},{name:"smooth",type:"boolean",default:!0}]},HK(T4,JO,{transform(t,e){if(this.value&&!e.changed()&&!t.modified())return e.StopPropagation;var n,r,i=e.fork(e.NO_SOURCE|e.NO_FIELDS),o=l4().smooth(!1!==t.smooth),s=t.values,a=t.thresholds||y4(t.count||10,t.nice,!!s),u=t.size;return s||(s=e.materialize(e.SOURCE).source,n=O4(E4(),t)(s,!0),r=w4(n,n.scale||1,n.scale||1,0,0),u=[n.width,n.height],s=n.values),a=UK(a)?a:a(s),s=o.size(u)(s,a),r&&s.forEach(r),this.value&&(i.rem=this.value),this.value=i.source=i.add=(s||[]).map(jk),i}});const L4="Feature",I4="FeatureCollection",N4="MultiPoint";function D4(t){JO.call(this,null,t)}function R4(t){JO.call(this,null,t)}function F4(t,e){const n=t.pointRadius();return t.context(null),null!=e&&t.pointRadius(e),n}function B4(t){JO.call(this,null,t)}function j4(t){JO.call(this,null,t)}function z4(t,e,n){const r=null==n?n=>t(e(n)):r=>{var i=t.pointRadius(),o=t.pointRadius(n)(e(r));return t.pointRadius(i),o};return r.context=e=>{return t.context(e),r},r}function U4(t){JO.call(this,[],t),this.generator=k3()}function $4(t){JO.call(this,null,t)}function V4(t,e){let n;return VK(t)?(n=n=>J3(t(n,e)),n.dep=W4(t)):n=qK(J3(t||"#888")),n}function q4(t,e){let n;return VK(t)?(n=n=>t(n,e),n.dep=W4(t)):t?n=qK(t):(n=t=>t.$value/t.$max||0,n.dep=!0),n}function W4(t){if(!VK(t))return!1;const e=YK(TK(t));return e.$x||e.$y||e.$value||e.$max}function G4(t,e,n,r){const i=t.width,o=t.height,s=t.x1||0,a=t.y1||0,u=t.x2||i,c=t.y2||o,l=t.values,h=l?t=>l[t]:jK,f=JD(u-s,c-a),d=f.getContext("2d"),p=d.getImageData(0,0,u-s,c-a),g=p.data;for(let m=a,y=0;m<c;++m){e.$y=m-a;for(let t=s,o=m*i;t<u;++t,y+=4){e.$x=t-s,e.$value=h(t+o);const i=n(e);g[y+0]=i.r,g[y+1]=i.g,g[y+2]=i.b,g[y+3]=~~(255*r(e))}}return d.putImageData(p,0,0),f}function H4(t){JO.call(this,null,t),this.modified(!0)}function X4(t,e){const n=K4(e.fit);e.extent?t.fitExtent(e.extent,n):e.size&&t.fitSize(e.size,n)}function Y4(t){const e=_3((t||"mercator").toLowerCase());return e||DK("Unrecognized projection type: "+t),e()}function Z4(t,e,n){VK(t[e])&&t[e](n)}function K4(t){return t=$K(t),1===t.length?t[0]:{type:I4,features:t.reduce((t,e)=>t.concat(J4(e)),[])}}function J4(t){return t.type===I4?t.features:$K(t).filter(t=>null!=t).map(t=>t.type===L4?t:{type:L4,geometry:t})}function Q4(t,e,n){return t.fields=e||[],t.fname=n,t}function t6(t){return null==t?null:t.fields}function e6(t){return 1===t.length?n6(t[0]):r6(t)}D4.Definition={type:"GeoJSON",metadata:{},params:[{name:"fields",type:"field",array:!0,length:2},{name:"geojson",type:"field"}]},HK(D4,JO,{transform(t,e){var n,r=this._features,i=this._points,o=t.fields,s=o&&o[0],a=o&&o[1],u=t.geojson||!o&&BK,c=e.ADD;n=t.modified()||e.changed(e.REM)||e.modified(TK(u))||s&&e.modified(TK(s))||a&&e.modified(TK(a)),this.value&&!n||(c=e.SOURCE,this._features=r=[],this._points=i=[]),u&&e.visit(c,t=>r.push(u(t))),s&&a&&(e.visit(c,t=>{var e=s(t),n=a(t);null!=e&&null!=n&&(e=+e)===e&&(n=+n)===n&&i.push([e,n])}),r=r.concat({type:L4,geometry:{type:N4,coordinates:i}})),this.value={type:I4,features:r}}}),R4.Definition={type:"GeoPath",metadata:{modifies:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"path"}]},HK(R4,JO,{transform(t,e){var n=e.fork(e.ALL),r=this.value,i=t.field||BK,o=t.as||"path",s=n.SOURCE;!r||t.modified()?(this.value=r=w3(t.projection),n.materialize().reflow()):s=i===BK||e.modified(i.fields)?n.ADD_MOD:n.ADD;const a=F4(r,t.pointRadius);return n.visit(s,t=>t[o]=r(i(t))),r.pointRadius(a),n.modifies(o)}}),B4.Definition={type:"GeoPoint",metadata:{modifies:!0},params:[{name:"projection",type:"projection",required:!0},{name:"fields",type:"field",array:!0,required:!0,length:2},{name:"as",type:"string",array:!0,length:2,default:["x","y"]}]},HK(B4,JO,{transform(t,e){var n,r=t.projection,i=t.fields[0],o=t.fields[1],s=t.as||["x","y"],a=s[0],u=s[1];function c(t){const e=r([i(t),o(t)]);e?(t[a]=e[0],t[u]=e[1]):(t[a]=void 0,t[u]=void 0)}return t.modified()?e=e.materialize().reflow(!0).visit(e.SOURCE,c):(n=e.modified(i.fields)||e.modified(o.fields),e.visit(n?e.ADD_MOD:e.ADD,c)),e.modifies(s)}}),j4.Definition={type:"GeoShape",metadata:{modifies:!0,nomod:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field",default:"datum"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"shape"}]},HK(j4,JO,{transform(t,e){var n=e.fork(e.ALL),r=this.value,i=t.as||"shape",o=n.ADD;return r&&!t.modified()||(this.value=r=z4(w3(t.projection),t.field||FK("datum"),t.pointRadius),n.materialize().reflow(),o=n.SOURCE),n.visit(o,t=>t[i]=r),n.modifies(i)}}),U4.Definition={type:"Graticule",metadata:{changes:!0,generates:!0},params:[{name:"extent",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMajor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMinor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"step",type:"number",array:!0,length:2},{name:"stepMajor",type:"number",array:!0,length:2,default:[90,360]},{name:"stepMinor",type:"number",array:!0,length:2,default:[10,10]},{name:"precision",type:"number",default:2.5}]},HK(U4,JO,{transform(t,e){var n,r=this.value,i=this.generator;if(!r.length||t.modified())for(const o in t)VK(i[o])&&i[o](t[o]);return n=i(),r.length?e.mod.push($k(r[0],n)):e.add.push(jk(n)),r[0]=n,e}}),$4.Definition={type:"heatmap",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"color",type:"string",expr:!0},{name:"opacity",type:"number",expr:!0},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"as",type:"string",default:"image"}]},HK($4,JO,{transform(t,e){if(!e.changed()&&!t.modified())return e.StopPropagation;var n=e.materialize(e.SOURCE).source,r="shared"===t.resolve,i=t.field||BK,o=q4(t.opacity,t),s=V4(t.color,t),a=t.as||"image",u={$x:0,$y:0,$value:0,$max:r?eJ(n.map(t=>eJ(i(t).values))):0};return n.forEach(t=>{const e=i(t),n=WK({},t,u);r||(n.$max=eJ(e.values||[])),t[a]=G4(e,n,s.dep?s:qK(s(n)),o.dep?o:qK(o(n)))}),e.reflow(!0).modifies(a)}}),HK(H4,JO,{transform(t,e){let n=this.value;return!n||t.modified("type")?(this.value=n=Y4(t.type),v3.forEach(e=>{null!=t[e]&&Z4(n,e,t[e])})):v3.forEach(e=>{t.modified(e)&&Z4(n,e,t[e])}),null!=t.pointRadius&&n.path.pointRadius(t.pointRadius),t.fit&&X4(n,t),e.fork(e.NO_SOURCE|e.NO_FIELDS)}});const n6=t=>(function(e){return e[t]}),r6=t=>{const e=t.length;return function(n){for(let r=0;r<e;++r)n=n[t[r]];return n}};function i6(t){throw Error(t)}function o6(t){const e=[],n=t.length;let r,i,o,s=null,a=0,u="";function c(){e.push(u+t.substring(r,i)),u="",r=i+1}for(t+="",r=i=0;i<n;++i)if(o=t[i],"\\"===o)u+=t.substring(r,i),u+=t.substring(++i,++i),r=i;else if(o===s)c(),s=null,a=-1;else{if(s)continue;r===a&&'"'===o?(r=i+1,s=o):r===a&&"'"===o?(r=i+1,s=o):"."!==o||a?"["===o?(i>r&&c(),a=r=i+1):"]"===o&&(a||i6("Access path missing open bracket: "+t),a>0&&c(),a=0,r=i+1):i>r?c():r=i+1}return a&&i6("Access path missing closing bracket: "+t),s&&i6("Access path missing closing quote: "+t),i>r&&(i++,c()),e}function s6(t,e,n){const r=o6(t);return t=1===r.length?r[0]:t,Q4((n&&n.get||e6)(r),[t],e||t)}s6("id"),Q4(t=>t,[],"identity"),Q4(()=>0,[],"zero"),Q4(()=>1,[],"one"),Q4(()=>!0,[],"true"),Q4(()=>!1,[],"false");var a6=Array.isArray;function u6(t){return null!=t?a6(t)?t:[t]:[]}function c6(t){return"function"===typeof t}function l6(t){for(let e,n,r=1,i=arguments.length;r<i;++r)for(n in e=arguments[r],e)t[n]=e[n];return t}const h6=Object.prototype.hasOwnProperty;function f6(t,e){return h6.call(t,e)}function d6(t,e,n){const r=t.prototype=Object.create(e.prototype);return Object.defineProperty(r,"constructor",{value:t,writable:!0,enumerable:!0,configurable:!0}),l6(r,n)}var p6=function(t,e){var n,r=1;function i(){var i,o,s=n.length,a=0,u=0;for(i=0;i<s;++i)o=n[i],a+=o.x,u+=o.y;for(a=(a/s-t)*r,u=(u/s-e)*r,i=0;i<s;++i)o=n[i],o.x-=a,o.y-=u}return null==t&&(t=0),null==e&&(e=0),i.initialize=function(t){n=t},i.x=function(e){return arguments.length?(t=+e,i):t},i.y=function(t){return arguments.length?(e=+t,i):e},i.strength=function(t){return arguments.length?(r=+t,i):r},i},g6=function(t){const e=+this._x.call(null,t),n=+this._y.call(null,t);return m6(this.cover(e,n),e,n,t)};function m6(t,e,n,r){if(isNaN(e)||isNaN(n))return t;var i,o,s,a,u,c,l,h,f,d=t._root,p={data:r},g=t._x0,m=t._y0,y=t._x1,v=t._y1;if(!d)return t._root=p,t;while(d.length)if((c=e>=(o=(g+y)/2))?g=o:y=o,(l=n>=(s=(m+v)/2))?m=s:v=s,i=d,!(d=d[h=l<<1|c]))return i[h]=p,t;if(a=+t._x.call(null,d.data),u=+t._y.call(null,d.data),e===a&&n===u)return p.next=d,i?i[h]=p:t._root=p,t;do{i=i?i[h]=new Array(4):t._root=new Array(4),(c=e>=(o=(g+y)/2))?g=o:y=o,(l=n>=(s=(m+v)/2))?m=s:v=s}while((h=l<<1|c)===(f=(u>=s)<<1|a>=o));return i[f]=d,i[h]=p,t}function y6(t){var e,n,r,i,o=t.length,s=new Array(o),a=new Array(o),u=1/0,c=1/0,l=-1/0,h=-1/0;for(n=0;n<o;++n)isNaN(r=+this._x.call(null,e=t[n]))||isNaN(i=+this._y.call(null,e))||(s[n]=r,a[n]=i,r<u&&(u=r),r>l&&(l=r),i<c&&(c=i),i>h&&(h=i));if(u>l||c>h)return this;for(this.cover(u,c).cover(l,h),n=0;n<o;++n)m6(this,s[n],a[n],t[n]);return this}var v6=function(t,e){if(isNaN(t=+t)||isNaN(e=+e))return this;var n=this._x0,r=this._y0,i=this._x1,o=this._y1;if(isNaN(n))i=(n=Math.floor(t))+1,o=(r=Math.floor(e))+1;else{var s,a,u=i-n||1,c=this._root;while(n>t||t>=i||r>e||e>=o)switch(a=(e<r)<<1|t<n,s=new Array(4),s[a]=c,c=s,u*=2,a){case 0:i=n+u,o=r+u;break;case 1:n=i-u,o=r+u;break;case 2:i=n+u,r=o-u;break;case 3:n=i-u,r=o-u;break}this._root&&this._root.length&&(this._root=c)}return this._x0=n,this._y0=r,this._x1=i,this._y1=o,this},b6=function(){var t=[];return this.visit((function(e){if(!e.length)do{t.push(e.data)}while(e=e.next)})),t},_6=function(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},w6=function(t,e,n,r,i){this.node=t,this.x0=e,this.y0=n,this.x1=r,this.y1=i},x6=function(t,e,n){var r,i,o,s,a,u,c,l=this._x0,h=this._y0,f=this._x1,d=this._y1,p=[],g=this._root;g&&p.push(new w6(g,l,h,f,d)),null==n?n=1/0:(l=t-n,h=e-n,f=t+n,d=e+n,n*=n);while(u=p.pop())if(!(!(g=u.node)||(i=u.x0)>f||(o=u.y0)>d||(s=u.x1)<l||(a=u.y1)<h))if(g.length){var m=(i+s)/2,y=(o+a)/2;p.push(new w6(g[3],m,y,s,a),new w6(g[2],i,y,m,a),new w6(g[1],m,o,s,y),new w6(g[0],i,o,m,y)),(c=(e>=y)<<1|t>=m)&&(u=p[p.length-1],p[p.length-1]=p[p.length-1-c],p[p.length-1-c]=u)}else{var v=t-+this._x.call(null,g.data),b=e-+this._y.call(null,g.data),_=v*v+b*b;if(_<n){var w=Math.sqrt(n=_);l=t-w,h=e-w,f=t+w,d=e+w,r=g.data}}return r},S6=function(t){if(isNaN(o=+this._x.call(null,t))||isNaN(s=+this._y.call(null,t)))return this;var e,n,r,i,o,s,a,u,c,l,h,f,d=this._root,p=this._x0,g=this._y0,m=this._x1,y=this._y1;if(!d)return this;if(d.length)while(1){if((c=o>=(a=(p+m)/2))?p=a:m=a,(l=s>=(u=(g+y)/2))?g=u:y=u,e=d,!(d=d[h=l<<1|c]))return this;if(!d.length)break;(e[h+1&3]||e[h+2&3]||e[h+3&3])&&(n=e,f=h)}while(d.data!==t)if(r=d,!(d=d.next))return this;return(i=d.next)&&delete d.next,r?(i?r.next=i:delete r.next,this):e?(i?e[h]=i:delete e[h],(d=e[0]||e[1]||e[2]||e[3])&&d===(e[3]||e[2]||e[1]||e[0])&&!d.length&&(n?n[f]=d:this._root=d),this):(this._root=i,this)};function E6(t){for(var e=0,n=t.length;e<n;++e)this.remove(t[e]);return this}var A6=function(){return this._root},M6=function(){var t=0;return this.visit((function(e){if(!e.length)do{++t}while(e=e.next)})),t},C6=function(t){var e,n,r,i,o,s,a=[],u=this._root;u&&a.push(new w6(u,this._x0,this._y0,this._x1,this._y1));while(e=a.pop())if(!t(u=e.node,r=e.x0,i=e.y0,o=e.x1,s=e.y1)&&u.length){var c=(r+o)/2,l=(i+s)/2;(n=u[3])&&a.push(new w6(n,c,l,o,s)),(n=u[2])&&a.push(new w6(n,r,l,c,s)),(n=u[1])&&a.push(new w6(n,c,i,o,l)),(n=u[0])&&a.push(new w6(n,r,i,c,l))}return this},k6=function(t){var e,n=[],r=[];this._root&&n.push(new w6(this._root,this._x0,this._y0,this._x1,this._y1));while(e=n.pop()){var i=e.node;if(i.length){var o,s=e.x0,a=e.y0,u=e.x1,c=e.y1,l=(s+u)/2,h=(a+c)/2;(o=i[0])&&n.push(new w6(o,s,a,l,h)),(o=i[1])&&n.push(new w6(o,l,a,u,h)),(o=i[2])&&n.push(new w6(o,s,h,l,c)),(o=i[3])&&n.push(new w6(o,l,h,u,c))}r.push(e)}while(e=r.pop())t(e.node,e.x0,e.y0,e.x1,e.y1);return this};function O6(t){return t[0]}var P6=function(t){return arguments.length?(this._x=t,this):this._x};function T6(t){return t[1]}var L6=function(t){return arguments.length?(this._y=t,this):this._y};function I6(t,e,n){var r=new N6(null==e?O6:e,null==n?T6:n,NaN,NaN,NaN,NaN);return null==t?r:r.addAll(t)}function N6(t,e,n,r,i,o){this._x=t,this._y=e,this._x0=n,this._y0=r,this._x1=i,this._y1=o,this._root=void 0}function D6(t){var e={data:t.data},n=e;while(t=t.next)n=n.next={data:t.data};return e}var R6=I6.prototype=N6.prototype;R6.copy=function(){var t,e,n=new N6(this._x,this._y,this._x0,this._y0,this._x1,this._y1),r=this._root;if(!r)return n;if(!r.length)return n._root=D6(r),n;t=[{source:r,target:n._root=new Array(4)}];while(r=t.pop())for(var i=0;i<4;++i)(e=r.source[i])&&(e.length?t.push({source:e,target:r.target[i]=new Array(4)}):r.target[i]=D6(e));return n},R6.add=g6,R6.addAll=y6,R6.cover=v6,R6.data=b6,R6.extent=_6,R6.find=x6,R6.remove=S6,R6.removeAll=E6,R6.root=A6,R6.size=M6,R6.visit=C6,R6.visitAfter=k6,R6.x=P6,R6.y=L6;var F6=function(t){return function(){return t}},B6=function(t){return 1e-6*(t()-.5)};function j6(t){return t.x+t.vx}function z6(t){return t.y+t.vy}var U6=function(t){var e,n,r,i=1,o=1;function s(){for(var t,s,u,c,l,h,f,d=e.length,p=0;p<o;++p)for(s=I6(e,j6,z6).visitAfter(a),t=0;t<d;++t)u=e[t],h=n[u.index],f=h*h,c=u.x+u.vx,l=u.y+u.vy,s.visit(g);function g(t,e,n,o,s){var a=t.data,d=t.r,p=h+d;if(!a)return e>c+p||o<c-p||n>l+p||s<l-p;if(a.index>u.index){var g=c-a.x-a.vx,m=l-a.y-a.vy,y=g*g+m*m;y<p*p&&(0===g&&(g=B6(r),y+=g*g),0===m&&(m=B6(r),y+=m*m),y=(p-(y=Math.sqrt(y)))/y*i,u.vx+=(g*=y)*(p=(d*=d)/(f+d)),u.vy+=(m*=y)*p,a.vx-=g*(p=1-p),a.vy-=m*p)}}}function a(t){if(t.data)return t.r=n[t.data.index];for(var e=t.r=0;e<4;++e)t[e]&&t[e].r>t.r&&(t.r=t[e].r)}function u(){if(e){var r,i,o=e.length;for(n=new Array(o),r=0;r<o;++r)i=e[r],n[i.index]=+t(i,r,e)}}return"function"!==typeof t&&(t=F6(null==t?1:+t)),s.initialize=function(t,n){e=t,r=n,u()},s.iterations=function(t){return arguments.length?(o=+t,s):o},s.strength=function(t){return arguments.length?(i=+t,s):i},s.radius=function(e){return arguments.length?(t="function"===typeof e?e:F6(+e),u(),s):t},s},$6={value:()=>{}};function V6(){for(var t,e=0,n=arguments.length,r={};e<n;++e){if(!(t=arguments[e]+"")||t in r||/[\s.]/.test(t))throw new Error("illegal type: "+t);r[t]=[]}return new q6(r)}function q6(t){this._=t}function W6(t,e){return t.trim().split(/^|\s+/).map((function(t){var n="",r=t.indexOf(".");if(r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),t&&!e.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:n}}))}function G6(t,e){for(var n,r=0,i=t.length;r<i;++r)if((n=t[r]).name===e)return n.value}function H6(t,e,n){for(var r=0,i=t.length;r<i;++r)if(t[r].name===e){t[r]=$6,t=t.slice(0,r).concat(t.slice(r+1));break}return null!=n&&t.push({name:e,value:n}),t}q6.prototype=V6.prototype={constructor:q6,on:function(t,e){var n,r=this._,i=W6(t+"",r),o=-1,s=i.length;if(!(arguments.length<2)){if(null!=e&&"function"!==typeof e)throw new Error("invalid callback: "+e);while(++o<s)if(n=(t=i[o]).type)r[n]=H6(r[n],t.name,e);else if(null==e)for(n in r)r[n]=H6(r[n],t.name,null);return this}while(++o<s)if((n=(t=i[o]).type)&&(n=G6(r[n],t.name)))return n},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new q6(t)},call:function(t,e){if((n=arguments.length-2)>0)for(var n,r,i=new Array(n),o=0;o<n;++o)i[o]=arguments[o+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(r=this._[t],o=0,n=r.length;o<n;++o)r[o].value.apply(e,i)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],i=0,o=r.length;i<o;++i)r[i].value.apply(e,n)}};var X6,Y6,Z6=V6,K6=0,J6=0,Q6=0,t5=1e3,e5=0,n5=0,r5=0,i5="object"===typeof performance&&performance.now?performance:Date,o5="object"===typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function s5(){return n5||(o5(a5),n5=i5.now()+r5)}function a5(){n5=0}function u5(){this._call=this._time=this._next=null}function c5(t,e,n){var r=new u5;return r.restart(t,e,n),r}function l5(){s5(),++K6;var t,e=X6;while(e)(t=n5-e._time)>=0&&e._call.call(null,t),e=e._next;--K6}function h5(){n5=(e5=i5.now())+r5,K6=J6=0;try{l5()}finally{K6=0,d5(),n5=0}}function f5(){var t=i5.now(),e=t-e5;e>t5&&(r5-=e,e5=t)}function d5(){var t,e,n=X6,r=1/0;while(n)n._call?(r>n._time&&(r=n._time),t=n,n=n._next):(e=n._next,n._next=null,n=t?t._next=e:X6=e);Y6=t,p5(r)}function p5(t){if(!K6){J6&&(J6=clearTimeout(J6));var e=t-n5;e>24?(t<1/0&&(J6=setTimeout(h5,t-i5.now()-r5)),Q6&&(Q6=clearInterval(Q6))):(Q6||(e5=i5.now(),Q6=setInterval(f5,t5)),K6=1,o5(h5))}}u5.prototype=c5.prototype={constructor:u5,restart:function(t,e,n){if("function"!==typeof t)throw new TypeError("callback is not a function");n=(null==n?s5():+n)+(null==e?0:+e),this._next||Y6===this||(Y6?Y6._next=this:X6=this,Y6=this),this._call=t,this._time=n,p5()},stop:function(){this._call&&(this._call=null,this._time=1/0,p5())}};const g5=1664525,m5=1013904223,y5=4294967296;var v5=function(){let t=1;return()=>(t=(g5*t+m5)%y5)/y5};function b5(t){return t.x}function _5(t){return t.y}var w5=10,x5=Math.PI*(3-Math.sqrt(5)),S5=function(t){var e,n=1,r=.001,i=1-Math.pow(r,1/300),o=0,s=.6,a=new Map,u=c5(h),c=Z6("tick","end"),l=v5();function h(){f(),c.call("tick",e),n<r&&(u.stop(),c.call("end",e))}function f(r){var u,c,l=t.length;void 0===r&&(r=1);for(var h=0;h<r;++h)for(n+=(o-n)*i,a.forEach((function(t){t(n)})),u=0;u<l;++u)c=t[u],null==c.fx?c.x+=c.vx*=s:(c.x=c.fx,c.vx=0),null==c.fy?c.y+=c.vy*=s:(c.y=c.fy,c.vy=0);return e}function d(){for(var e,n=0,r=t.length;n<r;++n){if(e=t[n],e.index=n,null!=e.fx&&(e.x=e.fx),null!=e.fy&&(e.y=e.fy),isNaN(e.x)||isNaN(e.y)){var i=w5*Math.sqrt(.5+n),o=n*x5;e.x=i*Math.cos(o),e.y=i*Math.sin(o)}(isNaN(e.vx)||isNaN(e.vy))&&(e.vx=e.vy=0)}}function p(e){return e.initialize&&e.initialize(t,l),e}return null==t&&(t=[]),d(),e={tick:f,restart:function(){return u.restart(h),e},stop:function(){return u.stop(),e},nodes:function(n){return arguments.length?(t=n,d(),a.forEach(p),e):t},alpha:function(t){return arguments.length?(n=+t,e):n},alphaMin:function(t){return arguments.length?(r=+t,e):r},alphaDecay:function(t){return arguments.length?(i=+t,e):+i},alphaTarget:function(t){return arguments.length?(o=+t,e):o},velocityDecay:function(t){return arguments.length?(s=1-t,e):1-s},randomSource:function(t){return arguments.length?(l=t,a.forEach(p),e):l},force:function(t,n){return arguments.length>1?(null==n?a.delete(t):a.set(t,p(n)),e):a.get(t)},find:function(e,n,r){var i,o,s,a,u,c=0,l=t.length;for(null==r?r=1/0:r*=r,c=0;c<l;++c)a=t[c],i=e-a.x,o=n-a.y,s=i*i+o*o,s<r&&(u=a,r=s);return u},on:function(t,n){return arguments.length>1?(c.on(t,n),e):c.on(t)}}},E5=function(){var t,e,n,r,i,o=F6(-30),s=1,a=1/0,u=.81;function c(n){var i,o=t.length,s=I6(t,b5,_5).visitAfter(h);for(r=n,i=0;i<o;++i)e=t[i],s.visit(f)}function l(){if(t){var e,n,r=t.length;for(i=new Array(r),e=0;e<r;++e)n=t[e],i[n.index]=+o(n,e,t)}}function h(t){var e,n,r,o,s,a=0,u=0;if(t.length){for(r=o=s=0;s<4;++s)(e=t[s])&&(n=Math.abs(e.value))&&(a+=e.value,u+=n,r+=n*e.x,o+=n*e.y);t.x=r/u,t.y=o/u}else{e=t,e.x=e.data.x,e.y=e.data.y;do{a+=i[e.data.index]}while(e=e.next)}t.value=a}function f(t,o,c,l){if(!t.value)return!0;var h=t.x-e.x,f=t.y-e.y,d=l-o,p=h*h+f*f;if(d*d/u<p)return p<a&&(0===h&&(h=B6(n),p+=h*h),0===f&&(f=B6(n),p+=f*f),p<s&&(p=Math.sqrt(s*p)),e.vx+=h*t.value*r/p,e.vy+=f*t.value*r/p),!0;if(!(t.length||p>=a)){(t.data!==e||t.next)&&(0===h&&(h=B6(n),p+=h*h),0===f&&(f=B6(n),p+=f*f),p<s&&(p=Math.sqrt(s*p)));do{t.data!==e&&(d=i[t.data.index]*r/p,e.vx+=h*d,e.vy+=f*d)}while(t=t.next)}}return c.initialize=function(e,r){t=e,n=r,l()},c.strength=function(t){return arguments.length?(o="function"===typeof t?t:F6(+t),l(),c):o},c.distanceMin=function(t){return arguments.length?(s=t*t,c):Math.sqrt(s)},c.distanceMax=function(t){return arguments.length?(a=t*t,c):Math.sqrt(a)},c.theta=function(t){return arguments.length?(u=t*t,c):Math.sqrt(u)},c};function A5(t){return t.index}function M5(t,e){var n=t.get(e);if(!n)throw new Error("node not found: "+e);return n}var C5=function(t){var e,n,r,i,o,s,a=A5,u=h,c=F6(30),l=1;function h(t){return 1/Math.min(i[t.source.index],i[t.target.index])}function f(r){for(var i=0,a=t.length;i<l;++i)for(var u,c,h,f,d,p,g,m=0;m<a;++m)u=t[m],c=u.source,h=u.target,f=h.x+h.vx-c.x-c.vx||B6(s),d=h.y+h.vy-c.y-c.vy||B6(s),p=Math.sqrt(f*f+d*d),p=(p-n[m])/p*r*e[m],f*=p,d*=p,h.vx-=f*(g=o[m]),h.vy-=d*g,c.vx+=f*(g=1-g),c.vy+=d*g}function d(){if(r){var s,u,c=r.length,l=t.length,h=new Map(r.map((t,e)=>[a(t,e,r),t]));for(s=0,i=new Array(c);s<l;++s)u=t[s],u.index=s,"object"!==typeof u.source&&(u.source=M5(h,u.source)),"object"!==typeof u.target&&(u.target=M5(h,u.target)),i[u.source.index]=(i[u.source.index]||0)+1,i[u.target.index]=(i[u.target.index]||0)+1;for(s=0,o=new Array(l);s<l;++s)u=t[s],o[s]=i[u.source.index]/(i[u.source.index]+i[u.target.index]);e=new Array(l),p(),n=new Array(l),g()}}function p(){if(r)for(var n=0,i=t.length;n<i;++n)e[n]=+u(t[n],n,t)}function g(){if(r)for(var e=0,i=t.length;e<i;++e)n[e]=+c(t[e],e,t)}return null==t&&(t=[]),f.initialize=function(t,e){r=t,s=e,d()},f.links=function(e){return arguments.length?(t=e,d(),f):t},f.id=function(t){return arguments.length?(a=t,f):a},f.iterations=function(t){return arguments.length?(l=+t,f):l},f.strength=function(t){return arguments.length?(u="function"===typeof t?t:F6(+t),p(),f):u},f.distance=function(t){return arguments.length?(c="function"===typeof t?t:F6(+t),g(),f):c},f},k5=function(t){var e,n,r,i=F6(.1);function o(t){for(var i,o=0,s=e.length;o<s;++o)i=e[o],i.vx+=(r[o]-i.x)*n[o]*t}function s(){if(e){var o,s=e.length;for(n=new Array(s),r=new Array(s),o=0;o<s;++o)n[o]=isNaN(r[o]=+t(e[o],o,e))?0:+i(e[o],o,e)}}return"function"!==typeof t&&(t=F6(null==t?0:+t)),o.initialize=function(t){e=t,s()},o.strength=function(t){return arguments.length?(i="function"===typeof t?t:F6(+t),s(),o):i},o.x=function(e){return arguments.length?(t="function"===typeof e?e:F6(+e),s(),o):t},o},O5=function(t){var e,n,r,i=F6(.1);function o(t){for(var i,o=0,s=e.length;o<s;++o)i=e[o],i.vy+=(r[o]-i.y)*n[o]*t}function s(){if(e){var o,s=e.length;for(n=new Array(s),r=new Array(s),o=0;o<s;++o)n[o]=isNaN(r[o]=+t(e[o],o,e))?0:+i(e[o],o,e)}}return"function"!==typeof t&&(t=F6(null==t?0:+t)),o.initialize=function(t){e=t,s()},o.strength=function(t){return arguments.length?(i="function"===typeof t?t:F6(+t),s(),o):i},o.y=function(e){return arguments.length?(t="function"===typeof e?e:F6(+e),s(),o):t},o};const P5={center:p6,collide:U6,nbody:E5,link:C5,x:k5,y:O5},T5="forces",L5=["alpha","alphaMin","alphaTarget","velocityDecay","forces"],I5=["static","iterations"],N5=["x","y","vx","vy"];function D5(t){JO.call(this,null,t)}function R5(t,e){return()=>t.touch(e).run()}function F5(t,e){const n=S5(t),r=n.stop,i=n.restart;let o=!1;return n.stopped=()=>o,n.restart=()=>(o=!1,i()),n.stop=()=>(o=!0,r()),B5(n,e,!0).on("end",()=>o=!0)}function B5(t,e,n,r){var i,o,s,a,u=u6(e.forces);for(i=0,o=L5.length;i<o;++i)s=L5[i],s!==T5&&e.modified(s)&&t[s](e[s]);for(i=0,o=u.length;i<o;++i)a=T5+i,s=n||e.modified(T5,i)?z5(u[i]):r&&j5(u[i],r)?t.force(a):null,s&&t.force(a,s);for(o=t.numForces||0;i<o;++i)t.force(T5+i,null);return t.numForces=u.length,t}function j5(t,e){var n,r;for(n in t)if(c6(r=t[n])&&e.modified(t6(r)))return 1;return 0}function z5(t){var e,n;for(n in f6(P5,t.force)||i6("Unrecognized force: "+t.force),e=P5[t.force](),t)c6(e[n])&&U5(e[n],t[n],t);return e}function U5(t,e,n){t(c6(e)?t=>e(t,n):e)}function $5(t,e,n){return t.fields=e||[],t.fname=n,t}function V5(t){return 1===t.length?q5(t[0]):W5(t)}D5.Definition={type:"Force",metadata:{modifies:!0},params:[{name:"static",type:"boolean",default:!1},{name:"restart",type:"boolean",default:!1},{name:"iterations",type:"number",default:300},{name:"alpha",type:"number",default:1},{name:"alphaMin",type:"number",default:.001},{name:"alphaTarget",type:"number",default:0},{name:"velocityDecay",type:"number",default:.4},{name:"forces",type:"param",array:!0,params:[{key:{force:"center"},params:[{name:"x",type:"number",default:0},{name:"y",type:"number",default:0}]},{key:{force:"collide"},params:[{name:"radius",type:"number",expr:!0},{name:"strength",type:"number",default:.7},{name:"iterations",type:"number",default:1}]},{key:{force:"nbody"},params:[{name:"strength",type:"number",default:-30},{name:"theta",type:"number",default:.9},{name:"distanceMin",type:"number",default:1},{name:"distanceMax",type:"number"}]},{key:{force:"link"},params:[{name:"links",type:"data"},{name:"id",type:"field"},{name:"distance",type:"number",default:30,expr:!0},{name:"strength",type:"number",expr:!0},{name:"iterations",type:"number",default:1}]},{key:{force:"x"},params:[{name:"strength",type:"number",default:.1},{name:"x",type:"field"}]},{key:{force:"y"},params:[{name:"strength",type:"number",default:.1},{name:"y",type:"field"}]}]},{name:"as",type:"string",array:!0,modify:!1,default:N5}]},d6(D5,JO,{transform(t,e){var n=this.value,r=e.changed(e.ADD_REM),i=t.modified(L5),o=t.iterations||300;if(n?(r&&(e.modifies("index"),n.nodes(e.source)),(i||e.changed(e.MOD))&&B5(n,t,0,e)):(this.value=n=F5(e.source,t),n.on("tick",R5(e.dataflow,this)),t.static||(r=!0,n.tick()),e.modifies("index")),i||r||t.modified(I5)||e.changed()&&t.restart)if(n.alpha(Math.max(n.alpha(),t.alpha||1)).alphaDecay(1-Math.pow(n.alphaMin(),1/o)),t.static)for(n.stop();--o>=0;)n.tick();else if(n.stopped()&&n.restart(),!r)return e.StopPropagation;return this.finish(t,e)},finish(t,e){const n=e.dataflow;for(let a,u=this._argops,c=0,l=u.length;c<l;++c)if(a=u[c],a.name===T5&&"link"===a.op._argval.force)for(var r,i=a.op._argops,o=0,s=i.length;o<s;++o)if("links"===i[o].name&&(r=i[o].op.source)){n.pulse(r,n.changeset().reflow());break}return e.reflow(t.modified()).modifies(N5)}});const q5=t=>(function(e){return e[t]}),W5=t=>{const e=t.length;return function(n){for(let r=0;r<e;++r)n=n[t[r]];return n}};function G5(t){throw Error(t)}function H5(t){const e=[],n=t.length;let r,i,o,s=null,a=0,u="";function c(){e.push(u+t.substring(r,i)),u="",r=i+1}for(t+="",r=i=0;i<n;++i)if(o=t[i],"\\"===o)u+=t.substring(r,i),u+=t.substring(++i,++i),r=i;else if(o===s)c(),s=null,a=-1;else{if(s)continue;r===a&&'"'===o?(r=i+1,s=o):r===a&&"'"===o?(r=i+1,s=o):"."!==o||a?"["===o?(i>r&&c(),a=r=i+1):"]"===o&&(a||G5("Access path missing open bracket: "+t),a>0&&c(),a=0,r=i+1):i>r?c():r=i+1}return a&&G5("Access path missing closing bracket: "+t),s&&G5("Access path missing closing quote: "+t),i>r&&(i++,c()),e}function X5(t,e,n){const r=H5(t);return t=1===r.length?r[0]:t,$5((n&&n.get||V5)(r),[t],e||t)}X5("id"),$5(t=>t,[],"identity"),$5(()=>0,[],"zero");const Y5=$5(()=>1,[],"one"),Z5=$5(()=>!0,[],"true");$5(()=>!1,[],"false");var K5=Array.isArray;function J5(t){return null!=t?K5(t)?t:[t]:[]}function Q5(t){for(let e,n,r=1,i=arguments.length;r<i;++r)for(n in e=arguments[r],e)t[n]=e[n];return t}const t8=Object.prototype.hasOwnProperty;function e8(t,e){return t8.call(t,e)}function n8(t,e,n){const r=t.prototype=Object.create(e.prototype);return Object.defineProperty(r,"constructor",{value:t,writable:!0,enumerable:!0,configurable:!0}),Q5(r,n)}function r8(t){var e=0,n=t.children,r=n&&n.length;if(r)while(--r>=0)e+=n[r].value;else e=1;t.value=e}var i8=function(){return this.eachAfter(r8)},o8=function(t,e){let n=-1;for(const r of this)t.call(e,r,++n,this);return this},s8=function(t,e){var n,r,i=this,o=[i],s=-1;while(i=o.pop())if(t.call(e,i,++s,this),n=i.children)for(r=n.length-1;r>=0;--r)o.push(n[r]);return this},a8=function(t,e){var n,r,i,o=this,s=[o],a=[],u=-1;while(o=s.pop())if(a.push(o),n=o.children)for(r=0,i=n.length;r<i;++r)s.push(n[r]);while(o=a.pop())t.call(e,o,++u,this);return this},u8=function(t,e){let n=-1;for(const r of this)if(t.call(e,r,++n,this))return r},c8=function(t){return this.eachAfter((function(e){var n=+t(e.data)||0,r=e.children,i=r&&r.length;while(--i>=0)n+=r[i].value;e.value=n}))},l8=function(t){return this.eachBefore((function(e){e.children&&e.children.sort(t)}))},h8=function(t){var e=this,n=f8(e,t),r=[e];while(e!==n)e=e.parent,r.push(e);var i=r.length;while(t!==n)r.splice(i,0,t),t=t.parent;return r};function f8(t,e){if(t===e)return t;var n=t.ancestors(),r=e.ancestors(),i=null;t=n.pop(),e=r.pop();while(t===e)i=t,t=n.pop(),e=r.pop();return i}var d8=function(){var t=this,e=[t];while(t=t.parent)e.push(t);return e},p8=function(){return Array.from(this)},g8=function(){var t=[];return this.eachBefore((function(e){e.children||t.push(e)})),t},m8=function(){var t=this,e=[];return t.each((function(n){n!==t&&e.push({source:n.parent,target:n})})),e},y8=function*(){var t,e,n,r,i=this,o=[i];do{t=o.reverse(),o=[];while(i=t.pop())if(yield i,e=i.children)for(n=0,r=e.length;n<r;++n)o.push(e[n])}while(o.length)};function v8(t,e){t instanceof Map?(t=[void 0,t],void 0===e&&(e=w8)):void 0===e&&(e=_8);var n,r,i,o,s,a=new E8(t),u=[a];while(n=u.pop())if((i=e(n.data))&&(s=(i=Array.from(i)).length))for(n.children=i,o=s-1;o>=0;--o)u.push(r=i[o]=new E8(i[o])),r.parent=n,r.depth=n.depth+1;return a.eachBefore(S8)}function b8(){return v8(this).eachBefore(x8)}function _8(t){return t.children}function w8(t){return Array.isArray(t)?t[1]:null}function x8(t){void 0!==t.data.value&&(t.value=t.data.value),t.data=t.data.data}function S8(t){var e=0;do{t.height=e}while((t=t.parent)&&t.height<++e)}function E8(t){this.data=t,this.depth=this.height=0,this.parent=null}E8.prototype=v8.prototype={constructor:E8,count:i8,each:o8,eachAfter:a8,eachBefore:s8,find:u8,sum:c8,sort:l8,path:h8,ancestors:d8,descendants:p8,leaves:g8,links:m8,copy:b8,[Symbol.iterator]:y8};var A8=function(t){return"object"===typeof t&&"length"in t?t:Array.from(t)};function M8(t){var e,n,r=t.length;while(r)n=Math.random()*r--|0,e=t[r],t[r]=t[n],t[n]=e;return t}var C8=function(t){var e,n,r=0,i=(t=M8(Array.from(t))).length,o=[];while(r<i)e=t[r],n&&P8(n,e)?++r:(n=L8(o=k8(o,e)),r=0);return n};function k8(t,e){var n,r;if(T8(e,t))return[e];for(n=0;n<t.length;++n)if(O8(e,t[n])&&T8(N8(t[n],e),t))return[t[n],e];for(n=0;n<t.length-1;++n)for(r=n+1;r<t.length;++r)if(O8(N8(t[n],t[r]),e)&&O8(N8(t[n],e),t[r])&&O8(N8(t[r],e),t[n])&&T8(D8(t[n],t[r],e),t))return[t[n],t[r],e];throw new Error}function O8(t,e){var n=t.r-e.r,r=e.x-t.x,i=e.y-t.y;return n<0||n*n<r*r+i*i}function P8(t,e){var n=t.r-e.r+1e-9*Math.max(t.r,e.r,1),r=e.x-t.x,i=e.y-t.y;return n>0&&n*n>r*r+i*i}function T8(t,e){for(var n=0;n<e.length;++n)if(!P8(t,e[n]))return!1;return!0}function L8(t){switch(t.length){case 1:return I8(t[0]);case 2:return N8(t[0],t[1]);case 3:return D8(t[0],t[1],t[2])}}function I8(t){return{x:t.x,y:t.y,r:t.r}}function N8(t,e){var n=t.x,r=t.y,i=t.r,o=e.x,s=e.y,a=e.r,u=o-n,c=s-r,l=a-i,h=Math.sqrt(u*u+c*c);return{x:(n+o+u/h*l)/2,y:(r+s+c/h*l)/2,r:(h+i+a)/2}}function D8(t,e,n){var r=t.x,i=t.y,o=t.r,s=e.x,a=e.y,u=e.r,c=n.x,l=n.y,h=n.r,f=r-s,d=r-c,p=i-a,g=i-l,m=u-o,y=h-o,v=r*r+i*i-o*o,b=v-s*s-a*a+u*u,_=v-c*c-l*l+h*h,w=d*p-f*g,x=(p*_-g*b)/(2*w)-r,S=(g*m-p*y)/w,E=(d*b-f*_)/(2*w)-i,A=(f*y-d*m)/w,M=S*S+A*A-1,C=2*(o+x*S+E*A),k=x*x+E*E-o*o,O=-(M?(C+Math.sqrt(C*C-4*M*k))/(2*M):k/C);return{x:r+x+S*O,y:i+E+A*O,r:O}}function R8(t,e,n){var r,i,o,s,a=t.x-e.x,u=t.y-e.y,c=a*a+u*u;c?(i=e.r+n.r,i*=i,s=t.r+n.r,s*=s,i>s?(r=(c+s-i)/(2*c),o=Math.sqrt(Math.max(0,s/c-r*r)),n.x=t.x-r*a-o*u,n.y=t.y-r*u+o*a):(r=(c+i-s)/(2*c),o=Math.sqrt(Math.max(0,i/c-r*r)),n.x=e.x+r*a-o*u,n.y=e.y+r*u+o*a)):(n.x=e.x+n.r,n.y=e.y)}function F8(t,e){var n=t.r+e.r-1e-6,r=e.x-t.x,i=e.y-t.y;return n>0&&n*n>r*r+i*i}function B8(t){var e=t._,n=t.next._,r=e.r+n.r,i=(e.x*n.r+n.x*e.r)/r,o=(e.y*n.r+n.y*e.r)/r;return i*i+o*o}function j8(t){this._=t,this.next=null,this.previous=null}function z8(t){if(!(i=(t=A8(t)).length))return 0;var e,n,r,i,o,s,a,u,c,l,h;if(e=t[0],e.x=0,e.y=0,!(i>1))return e.r;if(n=t[1],e.x=-n.r,n.x=e.r,n.y=0,!(i>2))return e.r+n.r;R8(n,e,r=t[2]),e=new j8(e),n=new j8(n),r=new j8(r),e.next=r.previous=n,n.next=e.previous=r,r.next=n.previous=e;t:for(a=3;a<i;++a){R8(e._,n._,r=t[a]),r=new j8(r),u=n.next,c=e.previous,l=n._.r,h=e._.r;do{if(l<=h){if(F8(u._,r._)){n=u,e.next=n,n.previous=e,--a;continue t}l+=u._.r,u=u.next}else{if(F8(c._,r._)){e=c,e.next=n,n.previous=e,--a;continue t}h+=c._.r,c=c.previous}}while(u!==c.next);r.previous=e,r.next=n,e.next=n.previous=n=r,o=B8(e);while((r=r.next)!==n)(s=B8(r))<o&&(e=r,o=s);n=e.next}e=[n._],r=n;while((r=r.next)!==n)e.push(r._);for(r=C8(e),a=0;a<i;++a)e=t[a],e.x-=r.x,e.y-=r.y;return r.r}function U8(t){return null==t?null:$8(t)}function $8(t){if("function"!==typeof t)throw new Error;return t}function V8(){return 0}var q8=function(t){return function(){return t}};function W8(t){return Math.sqrt(t.value)}var G8=function(){var t=null,e=1,n=1,r=V8;function i(i){return i.x=e/2,i.y=n/2,t?i.eachBefore(H8(t)).eachAfter(X8(r,.5)).eachBefore(Y8(1)):i.eachBefore(H8(W8)).eachAfter(X8(V8,1)).eachAfter(X8(r,i.r/Math.min(e,n))).eachBefore(Y8(Math.min(e,n)/(2*i.r))),i}return i.radius=function(e){return arguments.length?(t=U8(e),i):t},i.size=function(t){return arguments.length?(e=+t[0],n=+t[1],i):[e,n]},i.padding=function(t){return arguments.length?(r="function"===typeof t?t:q8(+t),i):r},i};function H8(t){return function(e){e.children||(e.r=Math.max(0,+t(e)||0))}}function X8(t,e){return function(n){if(r=n.children){var r,i,o,s=r.length,a=t(n)*e||0;if(a)for(i=0;i<s;++i)r[i].r+=a;if(o=z8(r),a)for(i=0;i<s;++i)r[i].r-=a;n.r=o+a}}}function Y8(t){return function(e){var n=e.parent;e.r*=t,n&&(e.x=n.x+t*e.x,e.y=n.y+t*e.y)}}var Z8=function(t){t.x0=Math.round(t.x0),t.y0=Math.round(t.y0),t.x1=Math.round(t.x1),t.y1=Math.round(t.y1)},K8=function(t,e,n,r,i){var o,s=t.children,a=-1,u=s.length,c=t.value&&(r-e)/t.value;while(++a<u)o=s[a],o.y0=n,o.y1=i,o.x0=e,o.x1=e+=o.value*c},J8=function(){var t=1,e=1,n=0,r=!1;function i(i){var s=i.height+1;return i.x0=i.y0=n,i.x1=t,i.y1=e/s,i.eachBefore(o(e,s)),r&&i.eachBefore(Z8),i}function o(t,e){return function(r){r.children&&K8(r,r.x0,t*(r.depth+1)/e,r.x1,t*(r.depth+2)/e);var i=r.x0,o=r.y0,s=r.x1-n,a=r.y1-n;s<i&&(i=s=(i+s)/2),a<o&&(o=a=(o+a)/2),r.x0=i,r.y0=o,r.x1=s,r.y1=a}}return i.round=function(t){return arguments.length?(r=!!t,i):r},i.size=function(n){return arguments.length?(t=+n[0],e=+n[1],i):[t,e]},i.padding=function(t){return arguments.length?(n=+t,i):n},i},Q8={depth:-1},t9={};function e9(t){return t.id}function n9(t){return t.parentId}var r9=function(){var t=e9,e=n9;function n(n){var r,i,o,s,a,u,c,l=Array.from(n),h=l.length,f=new Map;for(i=0;i<h;++i)r=l[i],a=l[i]=new E8(r),null!=(u=t(r,i,n))&&(u+="")&&(c=a.id=u,f.set(c,f.has(c)?t9:a)),null!=(u=e(r,i,n))&&(u+="")&&(a.parent=u);for(i=0;i<h;++i)if(a=l[i],u=a.parent){if(s=f.get(u),!s)throw new Error("missing: "+u);if(s===t9)throw new Error("ambiguous: "+u);s.children?s.children.push(a):s.children=[a],a.parent=s}else{if(o)throw new Error("multiple roots");o=a}if(!o)throw new Error("no root");if(o.parent=Q8,o.eachBefore((function(t){t.depth=t.parent.depth+1,--h})).eachBefore(S8),o.parent=null,h>0)throw new Error("cycle");return o}return n.id=function(e){return arguments.length?(t=$8(e),n):t},n.parentId=function(t){return arguments.length?(e=$8(t),n):e},n};function i9(t,e){return t.parent===e.parent?1:2}function o9(t){var e=t.children;return e?e[0]:t.t}function s9(t){var e=t.children;return e?e[e.length-1]:t.t}function a9(t,e,n){var r=n/(e.i-t.i);e.c-=r,e.s+=n,t.c+=r,e.z+=n,e.m+=n}function u9(t){var e,n=0,r=0,i=t.children,o=i.length;while(--o>=0)e=i[o],e.z+=n,e.m+=n,n+=e.s+(r+=e.c)}function c9(t,e,n){return t.a.parent===e.parent?t.a:n}function l9(t,e){this._=t,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=e}function h9(t){var e,n,r,i,o,s=new l9(t,0),a=[s];while(e=a.pop())if(r=e._.children)for(e.children=new Array(o=r.length),i=o-1;i>=0;--i)a.push(n=e.children[i]=new l9(r[i],i)),n.parent=e;return(s.parent=new l9(null,0)).children=[s],s}l9.prototype=Object.create(E8.prototype);var f9=function(){var t=i9,e=1,n=1,r=null;function i(i){var a=h9(i);if(a.eachAfter(o),a.parent.m=-a.z,a.eachBefore(s),r)i.eachBefore(u);else{var c=i,l=i,h=i;i.eachBefore((function(t){t.x<c.x&&(c=t),t.x>l.x&&(l=t),t.depth>h.depth&&(h=t)}));var f=c===l?1:t(c,l)/2,d=f-c.x,p=e/(l.x+f+d),g=n/(h.depth||1);i.eachBefore((function(t){t.x=(t.x+d)*p,t.y=t.depth*g}))}return i}function o(e){var n=e.children,r=e.parent.children,i=e.i?r[e.i-1]:null;if(n){u9(e);var o=(n[0].z+n[n.length-1].z)/2;i?(e.z=i.z+t(e._,i._),e.m=e.z-o):e.z=o}else i&&(e.z=i.z+t(e._,i._));e.parent.A=a(e,i,e.parent.A||r[0])}function s(t){t._.x=t.z+t.parent.m,t.m+=t.parent.m}function a(e,n,r){if(n){var i,o=e,s=e,a=n,u=o.parent.children[0],c=o.m,l=s.m,h=a.m,f=u.m;while(a=s9(a),o=o9(o),a&&o)u=o9(u),s=s9(s),s.a=e,i=a.z+h-o.z-c+t(a._,o._),i>0&&(a9(c9(a,e,r),e,i),c+=i,l+=i),h+=a.m,c+=o.m,f+=u.m,l+=s.m;a&&!s9(s)&&(s.t=a,s.m+=h-l),o&&!o9(u)&&(u.t=o,u.m+=c-f,r=e)}return r}function u(t){t.x*=e,t.y=t.depth*n}return i.separation=function(e){return arguments.length?(t=e,i):t},i.size=function(t){return arguments.length?(r=!1,e=+t[0],n=+t[1],i):r?null:[e,n]},i.nodeSize=function(t){return arguments.length?(r=!0,e=+t[0],n=+t[1],i):r?[e,n]:null},i};function d9(t,e){return t.parent===e.parent?1:2}function p9(t){return t.reduce(g9,0)/t.length}function g9(t,e){return t+e.x}function m9(t){return 1+t.reduce(y9,0)}function y9(t,e){return Math.max(t,e.y)}function v9(t){var e;while(e=t.children)t=e[0];return t}function b9(t){var e;while(e=t.children)t=e[e.length-1];return t}var _9=function(){var t=d9,e=1,n=1,r=!1;function i(i){var o,s=0;i.eachAfter((function(e){var n=e.children;n?(e.x=p9(n),e.y=m9(n)):(e.x=o?s+=t(e,o):0,e.y=0,o=e)}));var a=v9(i),u=b9(i),c=a.x-t(a,u)/2,l=u.x+t(u,a)/2;return i.eachAfter(r?function(t){t.x=(t.x-i.x)*e,t.y=(i.y-t.y)*n}:function(t){t.x=(t.x-c)/(l-c)*e,t.y=(1-(i.y?t.y/i.y:1))*n})}return i.separation=function(e){return arguments.length?(t=e,i):t},i.size=function(t){return arguments.length?(r=!1,e=+t[0],n=+t[1],i):r?null:[e,n]},i.nodeSize=function(t){return arguments.length?(r=!0,e=+t[0],n=+t[1],i):r?[e,n]:null},i},w9=function(t,e,n,r,i){var o,s,a=t.children,u=a.length,c=new Array(u+1);for(c[0]=s=o=0;o<u;++o)c[o+1]=s+=a[o].value;function l(t,e,n,r,i,o,s){if(t>=e-1){var u=a[t];return u.x0=r,u.y0=i,u.x1=o,void(u.y1=s)}var h=c[t],f=n/2+h,d=t+1,p=e-1;while(d<p){var g=d+p>>>1;c[g]<f?d=g+1:p=g}f-c[d-1]<c[d]-f&&t+1<d&&--d;var m=c[d]-h,y=n-m;if(o-r>s-i){var v=n?(r*y+o*m)/n:o;l(t,d,m,r,i,v,s),l(d,e,y,v,i,o,s)}else{var b=n?(i*y+s*m)/n:s;l(t,d,m,r,i,o,b),l(d,e,y,r,b,o,s)}}l(0,u,t.value,e,n,r,i)},x9=function(t,e,n,r,i){var o,s=t.children,a=-1,u=s.length,c=t.value&&(i-n)/t.value;while(++a<u)o=s[a],o.x0=e,o.x1=r,o.y0=n,o.y1=n+=o.value*c},S9=function(t,e,n,r,i){(1&t.depth?x9:K8)(t,e,n,r,i)},E9=(1+Math.sqrt(5))/2;function A9(t,e,n,r,i,o){var s,a,u,c,l,h,f,d,p,g,m,y=[],v=e.children,b=0,_=0,w=v.length,x=e.value;while(b<w){u=i-n,c=o-r;do{l=v[_++].value}while(!l&&_<w);for(h=f=l,g=Math.max(c/u,u/c)/(x*t),m=l*l*g,p=Math.max(f/m,m/h);_<w;++_){if(l+=a=v[_].value,a<h&&(h=a),a>f&&(f=a),m=l*l*g,d=Math.max(f/m,m/h),d>p){l-=a;break}p=d}y.push(s={value:l,dice:u<c,children:v.slice(b,_)}),s.dice?K8(s,n,r,i,x?r+=c*l/x:o):x9(s,n,r,x?n+=u*l/x:i,o),x-=l,b=_}return y}var M9=function t(e){function n(t,n,r,i,o){A9(e,t,n,r,i,o)}return n.ratio=function(e){return t((e=+e)>1?e:1)},n}(E9),C9=function t(e){function n(t,n,r,i,o){if((s=t._squarify)&&s.ratio===e){var s,a,u,c,l,h=-1,f=s.length,d=t.value;while(++h<f){for(a=s[h],u=a.children,c=a.value=0,l=u.length;c<l;++c)a.value+=u[c].value;a.dice?K8(a,n,r,i,d?r+=(o-r)*a.value/d:o):x9(a,n,r,d?n+=(i-n)*a.value/d:i,o),d-=a.value}}else t._squarify=s=A9(e,t,n,r,i,o),s.ratio=e}return n.ratio=function(e){return t((e=+e)>1?e:1)},n}(E9),k9=function(){var t=M9,e=!1,n=1,r=1,i=[0],o=V8,s=V8,a=V8,u=V8,c=V8;function l(t){return t.x0=t.y0=0,t.x1=n,t.y1=r,t.eachBefore(h),i=[0],e&&t.eachBefore(Z8),t}function h(e){var n=i[e.depth],r=e.x0+n,l=e.y0+n,h=e.x1-n,f=e.y1-n;h<r&&(r=h=(r+h)/2),f<l&&(l=f=(l+f)/2),e.x0=r,e.y0=l,e.x1=h,e.y1=f,e.children&&(n=i[e.depth+1]=o(e)/2,r+=c(e)-n,l+=s(e)-n,h-=a(e)-n,f-=u(e)-n,h<r&&(r=h=(r+h)/2),f<l&&(l=f=(l+f)/2),t(e,r,l,h,f))}return l.round=function(t){return arguments.length?(e=!!t,l):e},l.size=function(t){return arguments.length?(n=+t[0],r=+t[1],l):[n,r]},l.tile=function(e){return arguments.length?(t=$8(e),l):t},l.padding=function(t){return arguments.length?l.paddingInner(t).paddingOuter(t):l.paddingInner()},l.paddingInner=function(t){return arguments.length?(o="function"===typeof t?t:q8(+t),l):o},l.paddingOuter=function(t){return arguments.length?l.paddingTop(t).paddingRight(t).paddingBottom(t).paddingLeft(t):l.paddingTop()},l.paddingTop=function(t){return arguments.length?(s="function"===typeof t?t:q8(+t),l):s},l.paddingRight=function(t){return arguments.length?(a="function"===typeof t?t:q8(+t),l):a},l.paddingBottom=function(t){return arguments.length?(u="function"===typeof t?t:q8(+t),l):u},l.paddingLeft=function(t){return arguments.length?(c="function"===typeof t?t:q8(+t),l):c},l};function O9(t,e,n){const r={};return t.each(t=>{const i=t.data;n(i)&&(r[e(i)]=t)}),t.lookup=r,t}function P9(t){JO.call(this,null,t)}P9.Definition={type:"Nest",metadata:{treesource:!0,changes:!0},params:[{name:"keys",type:"field",array:!0},{name:"generate",type:"boolean"}]};const T9=t=>t.values;function L9(){const t=[],e={entries:t=>r(n(t,0),0),key:n=>(t.push(n),e)};function n(e,r){if(r>=t.length)return e;const i=e.length,o=t[r++],s={},a={};let u,c,l,h=-1;while(++h<i)u=o(c=e[h])+"",(l=s[u])?l.push(c):s[u]=[c];for(u in s)a[u]=n(s[u],r);return a}function r(e,n){if(++n>t.length)return e;const i=[];for(const t in e)i.push({key:t,values:r(e[t],n)});return i}return e}function I9(t){JO.call(this,null,t)}n8(P9,JO,{transform(t,e){e.source||G5("Nest transform requires an upstream data source.");var n=t.generate,r=t.modified(),i=e.clone(),o=this.value;return(!o||r||e.changed())&&(o&&o.each(t=>{t.children&&Rk(t.data)&&i.rem.push(t.data)}),this.value=o=v8({values:J5(t.keys).reduce((t,e)=>{return t.key(e),t},L9()).entries(i.source)},T9),n&&o.each(t=>{t.children&&(t=jk(t.data),i.add.push(t),i.source.push(t))}),O9(o,Fk,Fk)),i.source.root=o,i}});const N9=(t,e)=>t.parent===e.parent?1:2;function D9(t,e,n){for(let r,i=0,o=e.length;i<o;++i)r=e[i],r in n&&t[r](n[r])}function R9(t,e,n){const r=t.data,i=e.length-1;for(let o=0;o<i;++o)r[n[o]]=t[e[o]];r[n[i]]=t.children?t.children.length:0}n8(I9,JO,{transform(t,e){e.source&&e.source.root||G5(this.constructor.name+" transform requires a backing tree data source.");const n=this.layout(t.method),r=this.fields,i=e.source.root,o=t.as||r;t.field?i.sum(t.field):i.count(),t.sort&&i.sort(Vk(t.sort,t=>t.data)),D9(n,this.params,t),n.separation&&n.separation(!1!==t.separation?N9:Y5);try{this.value=n(i)}catch(s){G5(s)}return i.each(t=>R9(t,r,o)),e.reflow(t.modified()).modifies(o).modifies("leaf")}});const F9=["x","y","r","depth","children"];function B9(t){I9.call(this,t)}B9.Definition={type:"Pack",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"radius",type:"field",default:null},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:F9.length,default:F9}]},n8(B9,I9,{layout:G8,params:["radius","size","padding"],fields:F9});const j9=["x0","y0","x1","y1","depth","children"];function z9(t){I9.call(this,t)}function U9(t){JO.call(this,null,t)}z9.Definition={type:"Partition",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:j9.length,default:j9}]},n8(z9,I9,{layout:J8,params:["size","round","padding"],fields:j9}),U9.Definition={type:"Stratify",metadata:{treesource:!0},params:[{name:"key",type:"field",required:!0},{name:"parentKey",type:"field",required:!0}]},n8(U9,JO,{transform(t,e){e.source||G5("Stratify transform requires an upstream data source.");let n=this.value;const r=t.modified(),i=e.fork(e.ALL).materialize(e.SOURCE),o=!n||r||e.changed(e.ADD_REM)||e.modified(t.key.fields)||e.modified(t.parentKey.fields);return i.source=i.source.slice(),o&&(n=i.source.length?O9(r9().id(t.key).parentId(t.parentKey)(i.source),t.key,Z5):O9(r9()([{}]),t.key,t.key)),i.source.root=this.value=n,i}});const $9={tidy:f9,cluster:_9},V9=["x","y","depth","children"];function q9(t){I9.call(this,t)}function W9(t){JO.call(this,[],t)}q9.Definition={type:"Tree",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"tidy",values:["tidy","cluster"]},{name:"size",type:"number",array:!0,length:2},{name:"nodeSize",type:"number",array:!0,length:2},{name:"separation",type:"boolean",default:!0},{name:"as",type:"string",array:!0,length:V9.length,default:V9}]},n8(q9,I9,{layout(t){const e=t||"tidy";if(e8($9,e))return $9[e]();G5("Unrecognized Tree layout method: "+e)},params:["size","nodeSize"],fields:V9}),W9.Definition={type:"TreeLinks",metadata:{tree:!0,generates:!0,changes:!0},params:[]},n8(W9,JO,{transform(t,e){const n=this.value,r=e.source&&e.source.root,i=e.fork(e.NO_SOURCE),o={};return r||G5("TreeLinks transform requires a tree data source."),e.changed(e.ADD_REM)?(i.rem=n,e.visit(e.SOURCE,t=>o[Fk(t)]=1),r.each(t=>{const e=t.data,n=t.parent&&t.parent.data;n&&o[Fk(e)]&&o[Fk(n)]&&i.add.push(jk({source:n,target:e}))}),this.value=i.add):e.changed(e.MOD)&&(e.visit(e.MOD,t=>o[Fk(t)]=1),n.forEach(t=>{(o[Fk(t.source)]||o[Fk(t.target)])&&i.mod.push(t)})),i}});const G9={binary:w9,dice:K8,slice:x9,slicedice:S9,squarify:M9,resquarify:C9},H9=["x0","y0","x1","y1","depth","children"];function X9(t){I9.call(this,t)}function Y9(t,e,n){return t.fields=e||[],t.fname=n,t}function Z9(t){return 1===t.length?K9(t[0]):J9(t)}X9.Definition={type:"Treemap",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"squarify",values:["squarify","resquarify","binary","dice","slice","slicedice"]},{name:"padding",type:"number",default:0},{name:"paddingInner",type:"number",default:0},{name:"paddingOuter",type:"number",default:0},{name:"paddingTop",type:"number",default:0},{name:"paddingRight",type:"number",default:0},{name:"paddingBottom",type:"number",default:0},{name:"paddingLeft",type:"number",default:0},{name:"ratio",type:"number",default:1.618033988749895},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:H9.length,default:H9}]},n8(X9,I9,{layout(){const t=k9();return t.ratio=e=>{const n=t.tile();n.ratio&&t.tile(n.ratio(e))},t.method=e=>{e8(G9,e)?t.tile(G9[e]):G5("Unrecognized Treemap layout method: "+e)},t},params:["method","ratio","size","round","padding","paddingInner","paddingOuter","paddingTop","paddingRight","paddingBottom","paddingLeft"],fields:H9});const K9=t=>(function(e){return e[t]}),J9=t=>{const e=t.length;return function(n){for(let r=0;r<e;++r)n=n[t[r]];return n}};function Q9(t){throw Error(t)}function t7(t){const e=[],n=t.length;let r,i,o,s=null,a=0,u="";function c(){e.push(u+t.substring(r,i)),u="",r=i+1}for(t+="",r=i=0;i<n;++i)if(o=t[i],"\\"===o)u+=t.substring(r,i),u+=t.substring(++i,++i),r=i;else if(o===s)c(),s=null,a=-1;else{if(s)continue;r===a&&'"'===o?(r=i+1,s=o):r===a&&"'"===o?(r=i+1,s=o):"."!==o||a?"["===o?(i>r&&c(),a=r=i+1):"]"===o&&(a||Q9("Access path missing open bracket: "+t),a>0&&c(),a=0,r=i+1):i>r?c():r=i+1}return a&&Q9("Access path missing closing bracket: "+t),s&&Q9("Access path missing closing quote: "+t),i>r&&(i++,c()),e}function e7(t,e,n){const r=t7(t);return t=1===r.length?r[0]:t,Y9((n&&n.get||Z9)(r),[t],e||t)}e7("id"),Y9(t=>t,[],"identity"),Y9(()=>0,[],"zero"),Y9(()=>1,[],"one"),Y9(()=>!0,[],"true"),Y9(()=>!1,[],"false");var n7=Array.isArray;function r7(t){return null!=t?n7(t)?t:[t]:[]}function i7(t){return"function"===typeof t}function o7(t){for(let e,n,r=1,i=arguments.length;r<i;++r)for(n in e=arguments[r],e)t[n]=e[n];return t}Object.prototype.hasOwnProperty;function s7(t,e,n){const r=t.prototype=Object.create(e.prototype);return Object.defineProperty(r,"constructor",{value:t,writable:!0,enumerable:!0,configurable:!0}),o7(r,n)}const a7=4278190080,u7=268435456,c7=.0625;function l7(t,e){const n=t.bitmap();return(e||[]).forEach(e=>n.set(t(e.boundary[0]),t(e.boundary[3]))),[n,void 0]}function h7(t,e,n,r){const i=t.width,o=t.height,s=n||r,a=JD(i,o).getContext("2d");e.forEach(t=>f7(a,t,s));const u=new Uint32Array(a.getImageData(0,0,i,o).data.buffer),c=t.bitmap(),l=s&&t.bitmap();let h,f,d,p,g;for(f=0;f<o;++f)for(h=0;h<i;++h)g=u[f*i+h]&a7,g&&(d=t(h),p=t(f),r||c.set(d,p),s&&g^u7&&l.set(d,p));return[c,l]}function f7(t,e,n){if(!e.length)return;const r=e[0].mark.marktype;"group"===r?e.forEach(e=>{e.items.forEach(e=>f7(t,e.items,n))}):$W[r].draw(t,{items:n?e.map(d7):e})}function d7(t){const e=Uk(t,{});return e.stroke&&(e.strokeOpacity=1),e.fill&&(e.fillOpacity=c7,e.stroke="#000",e.strokeOpacity=1,e.strokeWidth=2),e}const p7=5,g7=31,m7=32,y7=new Uint32Array(m7+1),v7=new Uint32Array(m7+1);v7[0]=0,y7[0]=~v7[0];for(let L=1;L<=m7;++L)v7[L]=v7[L-1]<<1|1,y7[L]=~v7[L];function b7(t,e){const n=new Uint32Array(~~((t*e+m7)/m7));function r(t,e){n[t]|=e}function i(t,e){n[t]&=e}return{array:n,get:(e,r)=>{const i=r*t+e;return n[i>>>p7]&1<<(i&g7)},set:(e,n)=>{const i=n*t+e;r(i>>>p7,1<<(i&g7))},clear:(e,n)=>{const r=n*t+e;i(r>>>p7,~(1<<(r&g7)))},getRange:(e,r,i,o)=>{let s,a,u,c,l=o;for(;l>=r;--l)if(s=l*t+e,a=l*t+i,u=s>>>p7,c=a>>>p7,u===c){if(n[u]&y7[s&g7]&v7[1+(a&g7)])return!0}else{if(n[u]&y7[s&g7])return!0;if(n[c]&v7[1+(a&g7)])return!0;for(let t=u+1;t<c;++t)if(n[t])return!0}return!1},setRange:(e,n,i,o)=>{let s,a,u,c,l;for(;n<=o;++n)if(s=n*t+e,a=n*t+i,u=s>>>p7,c=a>>>p7,u===c)r(u,y7[s&g7]&v7[1+(a&g7)]);else for(r(u,y7[s&g7]),r(c,v7[1+(a&g7)]),l=u+1;l<c;++l)r(l,4294967295)},clearRange:(e,n,r,o)=>{let s,a,u,c,l;for(;n<=o;++n)if(s=n*t+e,a=n*t+r,u=s>>>p7,c=a>>>p7,u===c)i(u,v7[s&g7]|y7[1+(a&g7)]);else for(i(u,v7[s&g7]),i(c,y7[1+(a&g7)]),l=u+1;l<c;++l)i(l,0)},outOfBounds:(n,r,i,o)=>n<0||r<0||o>=e||i>=t}}function _7(t,e,n){const r=Math.max(1,Math.sqrt(t*e/1e6)),i=~~((t+2*n+r)/r),o=~~((e+2*n+r)/r),s=t=>~~((t+n)/r);return s.invert=t=>t*r-n,s.bitmap=()=>b7(i,o),s.ratio=r,s.padding=n,s.width=t,s.height=e,s}function w7(t,e,n,r){const i=t.width,o=t.height;return function(t){const e=t.datum.datum.items[r].items,n=e.length,s=t.datum.fontSize,a=gW.width(t.datum,t.datum.text);let u,c,l,h,f,d,p,g=0;for(let r=0;r<n;++r)u=e[r].x,l=e[r].y,c=void 0===e[r].x2?u:e[r].x2,h=void 0===e[r].y2?l:e[r].y2,f=(u+c)/2,d=(l+h)/2,p=Math.abs(c-u+h-l),p>=g&&(g=p,t.x=f,t.y=d);return f=a/2,d=s/2,u=t.x-f,c=t.x+f,l=t.y-d,h=t.y+d,t.align="center",u<0&&c<=i?t.align="left":0<=u&&i<c&&(t.align="right"),t.baseline="middle",l<0&&h<=o?t.baseline="top":0<=l&&o<h&&(t.baseline="bottom"),!0}}function x7(t,e,n,r,i,o){let s=n/2;return t-s<0||t+s>i||e-(s=r/2)<0||e+s>o}function S7(){return!1}function E7(t,e,n,r,i,o,s,a){const u=i*o/(2*r),c=t(e-u),l=t(e+u),h=t(n-(o/=2)),f=t(n+o);return s.outOfBounds(c,h,l,f)||s.getRange(c,h,l,f)||a&&a.getRange(c,h,l,f)}function A7(t,e,n,r,i,o,s,a){const u=i*o/(2*r);let c=t(e-u),l=t(e+u),h=t(n-(o/=2)),f=t(n+o);return c=c>0?c:0,h=h>0?h:0,l=l<t.width?l:t.width-1,f=f<t.height?f:t.height-1,s.getRange(c,h,l,f)||a&&a.getRange(c,h,l,f)}function M7(t){return t?[A7,S7]:[E7,x7]}function C7(t,e,n,r,i){const o=t.width,s=t.height,[a,u]=M7(i),c=e[0],l=e[1];function h(e,n,r,i,h){const f=t.invert(e),d=t.invert(n);let p,g=r,m=s;if(!u(f,d,i,h,o,s)&&!a(t,f,d,h,i,g,c,l)&&!a(t,f,d,h,i,h,c,null)){while(m-g>=1)p=(g+m)/2,a(t,f,d,h,i,p,c,l)?m=p:g=p;if(g>r)return[f,d,g,!0]}}return function(e){const i=e.datum.datum.items[r].items,l=i.length,f=e.datum.fontSize,d=gW.width(e.datum,e.datum.text);let p,g,m,y,v,b,_,w,x,S,E,A,M,C,k,O,P,T=n?f:0,L=!1,I=!1,N=0;for(let r=0;r<l;++r){for(p=i[r].x,m=i[r].y,g=void 0===i[r].x2?p:i[r].x2,y=void 0===i[r].y2?m:i[r].y2,p>g&&(P=p,p=g,g=P),m>y&&(P=m,m=y,y=P),x=t(p),E=t(g),S=~~((x+E)/2),A=t(m),C=t(y),M=~~((A+C)/2),_=S;_>=x;--_)for(w=M;w>=A;--w)O=h(_,w,T,d,f),O&&([e.x,e.y,T,L]=O);for(_=S;_<=E;++_)for(w=M;w<=C;++w)O=h(_,w,T,d,f),O&&([e.x,e.y,T,L]=O);L||n||(k=Math.abs(g-p+y-m),v=(p+g)/2,b=(m+y)/2,k>=N&&!u(v,b,d,f,o,s)&&!a(t,v,b,f,d,f,c,null)&&(N=k,e.x=v,e.y=b,I=!0))}return!(!L&&!I)&&(v=d/2,b=f/2,c.setRange(t(e.x-v),t(e.y-b),t(e.x+v),t(e.y+b)),e.align="center",e.baseline="middle",!0)}}const k7=[-1,-1,1,1],O7=[-1,1,-1,1];function P7(t,e,n,r,i){const o=t.width,s=t.height,[a,u]=M7(i),c=e[0],l=e[1],h=t.bitmap();return function(e){const i=e.datum.datum.items[r].items,f=i.length,d=e.datum.fontSize,p=gW.width(e.datum,e.datum.text),g=[];let m,y,v,b,_,w,x,S,E,A,M,C,k=n?d:0,O=!1,P=!1,T=0;for(let r=0;r<f;++r){m=i[r].x,v=i[r].y,y=void 0===i[r].x2?m:i[r].x2,b=void 0===i[r].y2?v:i[r].y2,g.push([t((m+y)/2),t((v+b)/2)]);while(g.length)if([x,S]=g.pop(),!(c.get(x,S)||l.get(x,S)||h.get(x,S))){h.set(x,S);for(let t=0;t<4;++t)_=x+k7[t],w=S+O7[t],h.outOfBounds(_,w,_,w)||g.push([_,w]);if(_=t.invert(x),w=t.invert(S),E=k,A=s,!u(_,w,p,d,o,s)&&!a(t,_,w,d,p,E,c,l)&&!a(t,_,w,d,p,d,c,null)){while(A-E>=1)M=(E+A)/2,a(t,_,w,d,p,M,c,l)?A=M:E=M;E>k&&(e.x=_,e.y=w,k=E,O=!0)}}O||n||(C=Math.abs(y-m+b-v),_=(m+y)/2,w=(v+b)/2,C>=T&&!u(_,w,p,d,o,s)&&!a(t,_,w,d,p,d,c,null)&&(T=C,e.x=_,e.y=w,P=!0))}return!(!O&&!P)&&(_=p/2,w=d/2,c.setRange(t(e.x-_),t(e.y-w),t(e.x+_),t(e.y+w)),e.align="center",e.baseline="middle",!0)}}const T7=["right","center","left"],L7=["bottom","middle","top"];function I7(t,e,n,r,i){const o=t.width,s=t.height,a=e[0],u=e[1],c=r.length;return function(e){const l=e.boundary,h=e.datum.fontSize;if(!i&&(l[2]<0||l[5]<0||l[0]>o||l[3]>s))return!1;let f,d,p,g,m,y,v,b,_,w,x,S,E,A,M,C=0;for(let o=0;o<c;++o){if(f=(3&n[o])-1,d=(n[o]>>>2&3)-1,p=0===f&&0===d||r[o]<0,g=f&&d?Math.SQRT1_2:1,m=r[o]<0?-1:1,y=l[1+f]+r[o]*f*g,x=l[4+d]+m*h*d/2+r[o]*d*g,b=x-h/2,_=x+h/2,S=t(y),A=t(b),M=t(_),i&&(S=S<0?0:S,A=A<0?0:A,M=M>=t.height?t.height-1:M),!C){if(!N7(S,S,A,M,a,u,y,y,b,_,l,p))continue;C=gW.width(e.datum,e.datum.text)}if(w=y+m*C*f/2,y=w-C/2,v=w+C/2,S=t(y),E=t(v),i&&(S=S<0?0:S,E=E>=t.width?t.width-1:E),N7(S,E,A,M,a,u,y,v,b,_,l,p))return e.x=f?f*m<0?v:y:w,e.y=d?d*m<0?_:b:x,e.align=T7[f*m+1],e.baseline=L7[d*m+1],a.setRange(S,A,E,M),!0}return!1}}function N7(t,e,n,r,i,o,s,a,u,c,l,h){return!(i.outOfBounds(t,n,e,r)||(h&&o?o.getRange(t,n,e,r)||!D7(s,u,a,c,l):i.getRange(t,n,e,r)))}function D7(t,e,n,r,i){return i[0]<=t&&n<=i[2]&&i[3]<=e&&r<=i[5]}const R7=0,F7=4,B7=8,j7=0,z7=1,U7=2,$7={"top-left":R7+j7,top:R7+z7,"top-right":R7+U7,left:F7+j7,middle:F7+z7,right:F7+U7,"bottom-left":B7+j7,bottom:B7+z7,"bottom-right":B7+U7},V7={naive:w7,"reduced-search":C7,floodfill:P7};function q7(t,e,n,r,i,o,s,a,u,c,l){if(!t.length)return t;const h=Math.max(r.length,i.length),f=W7(r,h),d=G7(i,h),p=H7(t[0].datum),g="group"===p&&t[0].datum.items[u].marktype,m="area"===g,y=X7(p,g,a,u),v=null===c||c===1/0,b=_7(e[0],e[1],v?0:c),_=m&&"naive"===l,w=t.map(t=>({datum:t,opacity:0,x:void 0,y:void 0,align:void 0,baseline:void 0,boundary:y(t)}));let x;if(!_){n&&w.sort((t,e)=>n(t.datum,e.datum));let e=!1;for(let t=0;t<d.length&&!e;++t)e=5===d[t]||f[t]<0;p&&(s||m)&&(o=[t.map(t=>t.datum)].concat(o)),x=o.length?h7(b,o,e,m):l7(b,s&&w)}const S=m?V7[l](b,x,s,u,v):I7(b,x,d,f,v);return w.forEach(t=>t.opacity=+S(t)),w}function W7(t,e){const n=new Float64Array(e),r=t.length;for(let i=0;i<r;++i)n[i]=t[i]||0;for(let i=r;i<e;++i)n[i]=n[r-1];return n}function G7(t,e){const n=new Int8Array(e),r=t.length;for(let i=0;i<r;++i)n[i]|=$7[t[i]];for(let i=r;i<e;++i)n[i]=n[r-1];return n}function H7(t){return t&&t.mark&&t.mark.marktype}function X7(t,e,n,r){const i=t=>[t.x,t.x,t.x,t.y,t.y,t.y];return t?"line"===t||"area"===t?t=>i(t.datum):"line"===e?t=>{const e=t.datum.items[r].items;return i(e.length?e["start"===n?0:e.length-1]:{x:NaN,y:NaN})}:t=>{const e=t.datum.bounds;return[e.x1,(e.x1+e.x2)/2,e.x2,e.y1,(e.y1+e.y2)/2,e.y2]}:i}const Y7=["x","y","opacity","align","baseline"],Z7=["top-left","left","bottom-left","top","bottom","top-right","right","bottom-right"];function K7(t){JO.call(this,null,t)}function J7(t,e,n){return t.fields=e||[],t.fname=n,t}function Q7(t){return null==t?null:t.fname}function ttt(t){return 1===t.length?ett(t[0]):ntt(t)}K7.Definition={type:"Label",metadata:{modifies:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"sort",type:"compare"},{name:"anchor",type:"string",array:!0,default:Z7},{name:"offset",type:"number",array:!0,default:[1]},{name:"padding",type:"number",default:0,null:!0},{name:"lineAnchor",type:"string",values:["start","end"],default:"end"},{name:"markIndex",type:"number",default:0},{name:"avoidBaseMark",type:"boolean",default:!0},{name:"avoidMarks",type:"data",array:!0},{name:"method",type:"string",default:"naive"},{name:"as",type:"string",array:!0,length:Y7.length,default:Y7}]},s7(K7,JO,{transform(t,e){function n(n){const r=t[n];return i7(r)&&e.modified(r.fields)}const r=t.modified();if(!(r||e.changed(e.ADD_REM)||n("sort")))return;t.size&&2===t.size.length||Q9("Size parameter should be specified as a [width, height] array.");const i=t.as||Y7;return q7(e.materialize(e.SOURCE).source||[],t.size,t.sort,r7(null==t.offset?1:t.offset),r7(t.anchor||Z7),t.avoidMarks||[],!1!==t.avoidBaseMark,t.lineAnchor||"end",t.markIndex||0,void 0===t.padding?0:t.padding,t.method||"naive").forEach(t=>{const e=t.datum;e[i[0]]=t.x,e[i[1]]=t.y,e[i[2]]=t.opacity,e[i[3]]=t.align,e[i[4]]=t.baseline}),e.reflow(r).modifies(i)}});const ett=t=>(function(e){return e[t]}),ntt=t=>{const e=t.length;return function(n){for(let r=0;r<e;++r)n=n[t[r]];return n}};function rtt(t){throw Error(t)}function itt(t){const e=[],n=t.length;let r,i,o,s=null,a=0,u="";function c(){e.push(u+t.substring(r,i)),u="",r=i+1}for(t+="",r=i=0;i<n;++i)if(o=t[i],"\\"===o)u+=t.substring(r,i),u+=t.substring(++i,++i),r=i;else if(o===s)c(),s=null,a=-1;else{if(s)continue;r===a&&'"'===o?(r=i+1,s=o):r===a&&"'"===o?(r=i+1,s=o):"."!==o||a?"["===o?(i>r&&c(),a=r=i+1):"]"===o&&(a||rtt("Access path missing open bracket: "+t),a>0&&c(),a=0,r=i+1):i>r?c():r=i+1}return a&&rtt("Access path missing closing bracket: "+t),s&&rtt("Access path missing closing quote: "+t),i>r&&(i++,c()),e}function ott(t,e,n){const r=itt(t);return t=1===r.length?r[0]:t,J7((n&&n.get||ttt)(r),[t],e||t)}ott("id"),J7(t=>t,[],"identity"),J7(()=>0,[],"zero"),J7(()=>1,[],"one"),J7(()=>!0,[],"true"),J7(()=>!1,[],"false");Array.isArray;function stt(t){for(let e,n,r=1,i=arguments.length;r<i;++r)for(n in e=arguments[r],e)t[n]=e[n];return t}function att(t,e){let n,r,i,o,s=0;if(t&&(n=t.length))if(null==e){for(r=t[s];s<n&&(null==r||r!==r);r=t[++s]);for(i=o=r;s<n;++s)r=t[s],null!=r&&(r<i&&(i=r),r>o&&(o=r))}else{for(r=e(t[s]);s<n&&(null==r||r!==r);r=e(t[++s]));for(i=o=r;s<n;++s)r=e(t[s]),null!=r&&(r<i&&(i=r),r>o&&(o=r))}return[i,o]}const utt=Object.prototype.hasOwnProperty;function ctt(t,e){return utt.call(t,e)}function ltt(t,e,n){const r=t.prototype=Object.create(e.prototype);return Object.defineProperty(r,"constructor",{value:t,writable:!0,enumerable:!0,configurable:!0}),stt(r,n)}function htt(t,e){var n,r,i,o,s,a,u=[],c=function(t){return t(o)};if(null==e)u.push(t);else for(n={},r=0,i=t.length;r<i;++r)o=t[r],s=e.map(c),a=n[s],a||(n[s]=a=[],a.dims=s,u.push(a)),a.push(o);return u}function ftt(t){JO.call(this,null,t)}ftt.Definition={type:"Loess",metadata:{generates:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"bandwidth",type:"number",default:.3},{name:"as",type:"string",array:!0}]},ltt(ftt,JO,{transform(t,e){const n=e.fork(e.NO_SOURCE|e.NO_FIELDS);if(!this.value||e.changed()||t.modified()){const r=e.materialize(e.SOURCE).source,i=htt(r,t.groupby),o=(t.groupby||[]).map(Q7),s=o.length,a=t.as||[Q7(t.x),Q7(t.y)],u=[];i.forEach(e=>{$T(e,t.x,t.y,t.bandwidth||.3).forEach(t=>{const n={};for(let r=0;r<s;++r)n[o[r]]=e.dims[r];n[a[0]]=t[0],n[a[1]]=t[1],u.push(jk(n))})}),this.value&&(n.rem=this.value),this.value=n.add=n.source=u}return n}});const dtt={linear:LT,log:IT,exp:NT,pow:DT,quad:RT,poly:FT},ptt=(t,e)=>"poly"===t?e:"quad"===t?2:1;function gtt(t){JO.call(this,null,t)}function mtt(t,e,n){return t.fields=e||[],t.fname=n,t}function ytt(t){return 1===t.length?vtt(t[0]):btt(t)}gtt.Definition={type:"Regression",metadata:{generates:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"string",default:"linear",values:Object.keys(dtt)},{name:"order",type:"number",default:3},{name:"extent",type:"number",array:!0,length:2},{name:"params",type:"boolean",default:!1},{name:"as",type:"string",array:!0}]},ltt(gtt,JO,{transform(t,e){const n=e.fork(e.NO_SOURCE|e.NO_FIELDS);if(!this.value||e.changed()||t.modified()){const r=e.materialize(e.SOURCE).source,i=htt(r,t.groupby),o=(t.groupby||[]).map(Q7),s=t.method||"linear",a=t.order||3,u=ptt(s,a),c=t.as||[Q7(t.x),Q7(t.y)],l=dtt[s],h=[];let f=t.extent;ctt(dtt,s)||rtt("Invalid regression method: "+s),null!=f&&"log"===s&&f[0]<=0&&(e.dataflow.warn("Ignoring extent with values <= 0 for log regression."),f=null),i.forEach(n=>{const r=n.length;if(r<=u)return void e.dataflow.warn("Skipping regression with more parameters than data points.");const i=l(n,t.x,t.y,a);if(t.params)return void h.push(jk({keys:n.dims,coef:i.coef,rSquared:i.rSquared}));const d=f||att(n,t.x),p=t=>{const e={};for(let r=0;r<o.length;++r)e[o[r]]=n.dims[r];e[c[0]]=t[0],e[c[1]]=t[1],h.push(jk(e))};"linear"===s?d.forEach(t=>p([t,i.predict(t)])):HT(i.predict,d,25,200).forEach(p)}),this.value&&(n.rem=this.value),this.value=n.add=n.source=h}return n}});const vtt=t=>(function(e){return e[t]}),btt=t=>{const e=t.length;return function(n){for(let r=0;r<e;++r)n=n[t[r]];return n}};function _tt(t){throw Error(t)}function wtt(t){const e=[],n=t.length;let r,i,o,s=null,a=0,u="";function c(){e.push(u+t.substring(r,i)),u="",r=i+1}for(t+="",r=i=0;i<n;++i)if(o=t[i],"\\"===o)u+=t.substring(r,i),u+=t.substring(++i,++i),r=i;else if(o===s)c(),s=null,a=-1;else{if(s)continue;r===a&&'"'===o?(r=i+1,s=o):r===a&&"'"===o?(r=i+1,s=o):"."!==o||a?"["===o?(i>r&&c(),a=r=i+1):"]"===o&&(a||_tt("Access path missing open bracket: "+t),a>0&&c(),a=0,r=i+1):i>r?c():r=i+1}return a&&_tt("Access path missing closing bracket: "+t),s&&_tt("Access path missing closing quote: "+t),i>r&&(i++,c()),e}function xtt(t,e,n){const r=wtt(t);return t=1===r.length?r[0]:t,mtt((n&&n.get||ytt)(r),[t],e||t)}xtt("id"),mtt(t=>t,[],"identity"),mtt(()=>0,[],"zero"),mtt(()=>1,[],"one"),mtt(()=>!0,[],"true"),mtt(()=>!1,[],"false");Array.isArray;function Stt(t){for(let e,n,r=1,i=arguments.length;r<i;++r)for(n in e=arguments[r],e)t[n]=e[n];return t}Object.prototype.hasOwnProperty;function Ett(t,e,n){const r=t.prototype=Object.create(e.prototype);return Object.defineProperty(r,"constructor",{value:t,writable:!0,enumerable:!0,configurable:!0}),Stt(r,n)}const Att=Math.pow(2,-52),Mtt=new Uint32Array(512);class Ctt{static from(t,e=Ftt,n=Btt){const r=t.length,i=new Float64Array(2*r);for(let o=0;o<r;o++){const r=t[o];i[2*o]=e(r),i[2*o+1]=n(r)}return new Ctt(i)}constructor(t){const e=t.length>>1;if(e>0&&"number"!==typeof t[0])throw new Error("Expected coords to contain numbers.");this.coords=t;const n=Math.max(2*e-5,0);this._triangles=new Uint32Array(3*n),this._halfedges=new Int32Array(3*n),this._hashSize=Math.ceil(Math.sqrt(e)),this._hullPrev=new Uint32Array(e),this._hullNext=new Uint32Array(e),this._hullTri=new Uint32Array(e),this._hullHash=new Int32Array(this._hashSize).fill(-1),this._ids=new Uint32Array(e),this._dists=new Float64Array(e),this.update()}update(){const{coords:t,_hullPrev:e,_hullNext:n,_hullTri:r,_hullHash:i}=this,o=t.length>>1;let s=1/0,a=1/0,u=-1/0,c=-1/0;for(let A=0;A<o;A++){const e=t[2*A],n=t[2*A+1];e<s&&(s=e),n<a&&(a=n),e>u&&(u=e),n>c&&(c=n),this._ids[A]=A}const l=(s+u)/2,h=(a+c)/2;let f,d,p,g=1/0;for(let A=0;A<o;A++){const e=Ott(l,h,t[2*A],t[2*A+1]);e<g&&(f=A,g=e)}const m=t[2*f],y=t[2*f+1];g=1/0;for(let A=0;A<o;A++){if(A===f)continue;const e=Ott(m,y,t[2*A],t[2*A+1]);e<g&&e>0&&(d=A,g=e)}let v=t[2*d],b=t[2*d+1],_=1/0;for(let A=0;A<o;A++){if(A===f||A===d)continue;const e=Itt(m,y,v,b,t[2*A],t[2*A+1]);e<_&&(p=A,_=e)}let w=t[2*p],x=t[2*p+1];if(_===1/0){for(let r=0;r<o;r++)this._dists[r]=t[2*r]-t[0]||t[2*r+1]-t[1];Dtt(this._ids,this._dists,0,o-1);const e=new Uint32Array(o);let n=0;for(let t=0,r=-1/0;t<o;t++){const i=this._ids[t];this._dists[i]>r&&(e[n++]=i,r=this._dists[i])}return this.hull=e.subarray(0,n),this.triangles=new Uint32Array(0),void(this.halfedges=new Uint32Array(0))}if(Ttt(m,y,v,b,w,x)){const t=d,e=v,n=b;d=p,v=w,b=x,p=t,w=e,x=n}const S=Ntt(m,y,v,b,w,x);this._cx=S.x,this._cy=S.y;for(let A=0;A<o;A++)this._dists[A]=Ott(t[2*A],t[2*A+1],S.x,S.y);Dtt(this._ids,this._dists,0,o-1),this._hullStart=f;let E=3;n[f]=e[p]=d,n[d]=e[f]=p,n[p]=e[d]=f,r[f]=0,r[d]=1,r[p]=2,i.fill(-1),i[this._hashKey(m,y)]=f,i[this._hashKey(v,b)]=d,i[this._hashKey(w,x)]=p,this.trianglesLen=0,this._addTriangle(f,d,p,-1,-1,-1);for(let A,M,C=0;C<this._ids.length;C++){const o=this._ids[C],s=t[2*o],a=t[2*o+1];if(C>0&&Math.abs(s-A)<=Att&&Math.abs(a-M)<=Att)continue;if(A=s,M=a,o===f||o===d||o===p)continue;let u=0;for(let t=0,e=this._hashKey(s,a);t<this._hashSize;t++)if(u=i[(e+t)%this._hashSize],-1!==u&&u!==n[u])break;u=e[u];let c,l=u;while(c=n[l],!Ttt(s,a,t[2*l],t[2*l+1],t[2*c],t[2*c+1]))if(l=c,l===u){l=-1;break}if(-1===l)continue;let h=this._addTriangle(l,o,n[l],-1,-1,r[l]);r[o]=this._legalize(h+2),r[l]=h,E++;let g=n[l];while(c=n[g],Ttt(s,a,t[2*g],t[2*g+1],t[2*c],t[2*c+1]))h=this._addTriangle(g,o,c,r[o],-1,r[g]),r[o]=this._legalize(h+2),n[g]=g,E--,g=c;if(l===u)while(c=e[l],Ttt(s,a,t[2*c],t[2*c+1],t[2*l],t[2*l+1]))h=this._addTriangle(c,o,l,-1,r[l],r[c]),this._legalize(h+2),r[c]=h,n[l]=l,E--,l=c;this._hullStart=e[o]=l,n[l]=e[g]=o,n[o]=g,i[this._hashKey(s,a)]=o,i[this._hashKey(t[2*l],t[2*l+1])]=l}this.hull=new Uint32Array(E);for(let A=0,M=this._hullStart;A<E;A++)this.hull[A]=M,M=n[M];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}_hashKey(t,e){return Math.floor(ktt(t-this._cx,e-this._cy)*this._hashSize)%this._hashSize}_legalize(t){const{_triangles:e,_halfedges:n,coords:r}=this;let i=0,o=0;while(1){const s=n[t],a=t-t%3;if(o=a+(t+2)%3,-1===s){if(0===i)break;t=Mtt[--i];continue}const u=s-s%3,c=a+(t+1)%3,l=u+(s+2)%3,h=e[o],f=e[t],d=e[c],p=e[l],g=Ltt(r[2*h],r[2*h+1],r[2*f],r[2*f+1],r[2*d],r[2*d+1],r[2*p],r[2*p+1]);if(g){e[t]=p,e[s]=h;const r=n[l];if(-1===r){let e=this._hullStart;do{if(this._hullTri[e]===l){this._hullTri[e]=t;break}e=this._hullPrev[e]}while(e!==this._hullStart)}this._link(t,r),this._link(s,n[o]),this._link(o,l);const a=u+(s+1)%3;i<Mtt.length&&(Mtt[i++]=a)}else{if(0===i)break;t=Mtt[--i]}}return o}_link(t,e){this._halfedges[t]=e,-1!==e&&(this._halfedges[e]=t)}_addTriangle(t,e,n,r,i,o){const s=this.trianglesLen;return this._triangles[s]=t,this._triangles[s+1]=e,this._triangles[s+2]=n,this._link(s,r),this._link(s+1,i),this._link(s+2,o),this.trianglesLen+=3,s}}function ktt(t,e){const n=t/(Math.abs(t)+Math.abs(e));return(e>0?3-n:1+n)/4}function Ott(t,e,n,r){const i=t-n,o=e-r;return i*i+o*o}function Ptt(t,e,n,r,i,o){const s=(r-e)*(i-t),a=(n-t)*(o-e);return Math.abs(s-a)>=33306690738754716e-32*Math.abs(s+a)?s-a:0}function Ttt(t,e,n,r,i,o){const s=Ptt(i,o,t,e,n,r)||Ptt(t,e,n,r,i,o)||Ptt(n,r,i,o,t,e);return s<0}function Ltt(t,e,n,r,i,o,s,a){const u=t-s,c=e-a,l=n-s,h=r-a,f=i-s,d=o-a,p=u*u+c*c,g=l*l+h*h,m=f*f+d*d;return u*(h*m-g*d)-c*(l*m-g*f)+p*(l*d-h*f)<0}function Itt(t,e,n,r,i,o){const s=n-t,a=r-e,u=i-t,c=o-e,l=s*s+a*a,h=u*u+c*c,f=.5/(s*c-a*u),d=(c*l-a*h)*f,p=(s*h-u*l)*f;return d*d+p*p}function Ntt(t,e,n,r,i,o){const s=n-t,a=r-e,u=i-t,c=o-e,l=s*s+a*a,h=u*u+c*c,f=.5/(s*c-a*u),d=t+(c*l-a*h)*f,p=e+(s*h-u*l)*f;return{x:d,y:p}}function Dtt(t,e,n,r){if(r-n<=20)for(let i=n+1;i<=r;i++){const r=t[i],o=e[r];let s=i-1;while(s>=n&&e[t[s]]>o)t[s+1]=t[s--];t[s+1]=r}else{const i=n+r>>1;let o=n+1,s=r;Rtt(t,i,o),e[t[n]]>e[t[r]]&&Rtt(t,n,r),e[t[o]]>e[t[r]]&&Rtt(t,o,r),e[t[n]]>e[t[o]]&&Rtt(t,n,o);const a=t[o],u=e[a];while(1){do{o++}while(e[t[o]]<u);do{s--}while(e[t[s]]>u);if(s<o)break;Rtt(t,o,s)}t[n+1]=t[s],t[s]=a,r-o+1>=s-n?(Dtt(t,e,o,r),Dtt(t,e,n,s-1)):(Dtt(t,e,n,s-1),Dtt(t,e,o,r))}}function Rtt(t,e,n){const r=t[e];t[e]=t[n],t[n]=r}function Ftt(t){return t[0]}function Btt(t){return t[1]}const jtt=1e-6;class ztt{constructor(){this._x0=this._y0=this._x1=this._y1=null,this._=""}moveTo(t,e){this._+=`M${this._x0=this._x1=+t},${this._y0=this._y1=+e}`}closePath(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")}lineTo(t,e){this._+=`L${this._x1=+t},${this._y1=+e}`}arc(t,e,n){t=+t,e=+e,n=+n;const r=t+n,i=e;if(n<0)throw new Error("negative radius");null===this._x1?this._+=`M${r},${i}`:(Math.abs(this._x1-r)>jtt||Math.abs(this._y1-i)>jtt)&&(this._+="L"+r+","+i),n&&(this._+=`A${n},${n},0,1,1,${t-n},${e}A${n},${n},0,1,1,${this._x1=r},${this._y1=i}`)}rect(t,e,n,r){this._+=`M${this._x0=this._x1=+t},${this._y0=this._y1=+e}h${+n}v${+r}h${-n}Z`}value(){return this._||null}}class Utt{constructor(){this._=[]}moveTo(t,e){this._.push([t,e])}closePath(){this._.push(this._[0].slice())}lineTo(t,e){this._.push([t,e])}value(){return this._.length?this._:null}}class $tt{constructor(t,[e,n,r,i]=[0,0,960,500]){if(!((r=+r)>=(e=+e))||!((i=+i)>=(n=+n)))throw new Error("invalid bounds");this.delaunay=t,this._circumcenters=new Float64Array(2*t.points.length),this.vectors=new Float64Array(2*t.points.length),this.xmax=r,this.xmin=e,this.ymax=i,this.ymin=n,this._init()}update(){return this.delaunay.update(),this._init(),this}_init(){const{delaunay:{points:t,hull:e,triangles:n},vectors:r}=this,i=this.circumcenters=this._circumcenters.subarray(0,n.length/3*2);for(let f,d,p=0,g=0,m=n.length;p<m;p+=3,g+=2){const e=2*n[p],r=2*n[p+1],o=2*n[p+2],s=t[e],a=t[e+1],u=t[r],c=t[r+1],l=t[o],h=t[o+1],m=u-s,y=c-a,v=l-s,b=h-a,_=m*m+y*y,w=v*v+b*b,x=2*(m*b-y*v);if(x)if(Math.abs(x)<1e-8)f=(s+l)/2,d=(a+h)/2;else{const t=1/x;f=s+(b*_-y*w)*t,d=a+(m*w-v*_)*t}else f=(s+l)/2-1e8*b,d=(a+h)/2+1e8*v;i[g]=f,i[g+1]=d}let o,s,a,u=e[e.length-1],c=4*u,l=t[2*u],h=t[2*u+1];r.fill(0);for(let f=0;f<e.length;++f)u=e[f],o=c,s=l,a=h,c=4*u,l=t[2*u],h=t[2*u+1],r[o+2]=r[c]=a-h,r[o+3]=r[c+1]=l-s}render(t){const e=null==t?t=new ztt:void 0,{delaunay:{halfedges:n,inedges:r,hull:i},circumcenters:o,vectors:s}=this;if(i.length<=1)return null;for(let c=0,l=n.length;c<l;++c){const e=n[c];if(e<c)continue;const r=2*Math.floor(c/3),i=2*Math.floor(e/3),s=o[r],a=o[r+1],u=o[i],l=o[i+1];this._renderSegment(s,a,u,l,t)}let a,u=i[i.length-1];for(let c=0;c<i.length;++c){a=u,u=i[c];const e=2*Math.floor(r[u]/3),n=o[e],l=o[e+1],h=4*a,f=this._project(n,l,s[h+2],s[h+3]);f&&this._renderSegment(n,l,f[0],f[1],t)}return e&&e.value()}renderBounds(t){const e=null==t?t=new ztt:void 0;return t.rect(this.xmin,this.ymin,this.xmax-this.xmin,this.ymax-this.ymin),e&&e.value()}renderCell(t,e){const n=null==e?e=new ztt:void 0,r=this._clip(t);if(null===r||!r.length)return;e.moveTo(r[0],r[1]);let i=r.length;while(r[0]===r[i-2]&&r[1]===r[i-1]&&i>1)i-=2;for(let o=2;o<i;o+=2)r[o]===r[o-2]&&r[o+1]===r[o-1]||e.lineTo(r[o],r[o+1]);return e.closePath(),n&&n.value()}*cellPolygons(){const{delaunay:{points:t}}=this;for(let e=0,n=t.length/2;e<n;++e){const t=this.cellPolygon(e);t&&(t.index=e,yield t)}}cellPolygon(t){const e=new Utt;return this.renderCell(t,e),e.value()}_renderSegment(t,e,n,r,i){let o;const s=this._regioncode(t,e),a=this._regioncode(n,r);0===s&&0===a?(i.moveTo(t,e),i.lineTo(n,r)):(o=this._clipSegment(t,e,n,r,s,a))&&(i.moveTo(o[0],o[1]),i.lineTo(o[2],o[3]))}contains(t,e,n){return e=+e,e===e&&(n=+n,n===n)&&this.delaunay._step(t,e,n)===t}*neighbors(t){const e=this._clip(t);if(e)for(const n of this.delaunay.neighbors(t)){const t=this._clip(n);if(t)t:for(let r=0,i=e.length;r<i;r+=2)for(let o=0,s=t.length;o<s;o+=2)if(e[r]==t[o]&&e[r+1]==t[o+1]&&e[(r+2)%i]==t[(o+s-2)%s]&&e[(r+3)%i]==t[(o+s-1)%s]){yield n;break t}}}_cell(t){const{circumcenters:e,delaunay:{inedges:n,halfedges:r,triangles:i}}=this,o=n[t];if(-1===o)return null;const s=[];let a=o;do{const n=Math.floor(a/3);if(s.push(e[2*n],e[2*n+1]),a=a%3===2?a-2:a+1,i[a]!==t)break;a=r[a]}while(a!==o&&-1!==a);return s}_clip(t){if(0===t&&1===this.delaunay.hull.length)return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];const e=this._cell(t);if(null===e)return null;const{vectors:n}=this,r=4*t;return n[r]||n[r+1]?this._clipInfinite(t,e,n[r],n[r+1],n[r+2],n[r+3]):this._clipFinite(t,e)}_clipFinite(t,e){const n=e.length;let r,i,o,s,a,u=null,c=e[n-2],l=e[n-1],h=this._regioncode(c,l);for(let f=0;f<n;f+=2)if(r=c,i=l,c=e[f],l=e[f+1],o=h,h=this._regioncode(c,l),0===o&&0===h)s=a,a=0,u?u.push(c,l):u=[c,l];else{let e,n,f,d,p;if(0===o){if(null===(e=this._clipSegment(r,i,c,l,o,h)))continue;[n,f,d,p]=e}else{if(null===(e=this._clipSegment(c,l,r,i,h,o)))continue;[d,p,n,f]=e,s=a,a=this._edgecode(n,f),s&&a&&this._edge(t,s,a,u,u.length),u?u.push(n,f):u=[n,f]}s=a,a=this._edgecode(d,p),s&&a&&this._edge(t,s,a,u,u.length),u?u.push(d,p):u=[d,p]}if(u)s=a,a=this._edgecode(u[0],u[1]),s&&a&&this._edge(t,s,a,u,u.length);else if(this.contains(t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2))return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];return u}_clipSegment(t,e,n,r,i,o){while(1){if(0===i&&0===o)return[t,e,n,r];if(i&o)return null;let s,a,u=i||o;8&u?(s=t+(n-t)*(this.ymax-e)/(r-e),a=this.ymax):4&u?(s=t+(n-t)*(this.ymin-e)/(r-e),a=this.ymin):2&u?(a=e+(r-e)*(this.xmax-t)/(n-t),s=this.xmax):(a=e+(r-e)*(this.xmin-t)/(n-t),s=this.xmin),i?(t=s,e=a,i=this._regioncode(t,e)):(n=s,r=a,o=this._regioncode(n,r))}}_clipInfinite(t,e,n,r,i,o){let s,a=Array.from(e);if((s=this._project(a[0],a[1],n,r))&&a.unshift(s[0],s[1]),(s=this._project(a[a.length-2],a[a.length-1],i,o))&&a.push(s[0],s[1]),a=this._clipFinite(t,a))for(let u,c=0,l=a.length,h=this._edgecode(a[l-2],a[l-1]);c<l;c+=2)u=h,h=this._edgecode(a[c],a[c+1]),u&&h&&(c=this._edge(t,u,h,a,c),l=a.length);else this.contains(t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2)&&(a=[this.xmin,this.ymin,this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax]);return a}_edge(t,e,n,r,i){while(e!==n){let n,o;switch(e){case 5:e=4;continue;case 4:e=6,n=this.xmax,o=this.ymin;break;case 6:e=2;continue;case 2:e=10,n=this.xmax,o=this.ymax;break;case 10:e=8;continue;case 8:e=9,n=this.xmin,o=this.ymax;break;case 9:e=1;continue;case 1:e=5,n=this.xmin,o=this.ymin;break}r[i]===n&&r[i+1]===o||!this.contains(t,n,o)||(r.splice(i,0,n,o),i+=2)}if(r.length>4)for(let o=0;o<r.length;o+=2){const t=(o+2)%r.length,e=(o+4)%r.length;(r[o]===r[t]&&r[t]===r[e]||r[o+1]===r[t+1]&&r[t+1]===r[e+1])&&(r.splice(t,2),o-=2)}return i}_project(t,e,n,r){let i,o,s,a=1/0;if(r<0){if(e<=this.ymin)return null;(i=(this.ymin-e)/r)<a&&(s=this.ymin,o=t+(a=i)*n)}else if(r>0){if(e>=this.ymax)return null;(i=(this.ymax-e)/r)<a&&(s=this.ymax,o=t+(a=i)*n)}if(n>0){if(t>=this.xmax)return null;(i=(this.xmax-t)/n)<a&&(o=this.xmax,s=e+(a=i)*r)}else if(n<0){if(t<=this.xmin)return null;(i=(this.xmin-t)/n)<a&&(o=this.xmin,s=e+(a=i)*r)}return[o,s]}_edgecode(t,e){return(t===this.xmin?1:t===this.xmax?2:0)|(e===this.ymin?4:e===this.ymax?8:0)}_regioncode(t,e){return(t<this.xmin?1:t>this.xmax?2:0)|(e<this.ymin?4:e>this.ymax?8:0)}}const Vtt=2*Math.PI,qtt=Math.pow;function Wtt(t){return t[0]}function Gtt(t){return t[1]}function Htt(t){const{triangles:e,coords:n}=t;for(let r=0;r<e.length;r+=3){const t=2*e[r],i=2*e[r+1],o=2*e[r+2],s=(n[o]-n[t])*(n[i+1]-n[t+1])-(n[i]-n[t])*(n[o+1]-n[t+1]);if(s>1e-10)return!1}return!0}function Xtt(t,e,n){return[t+Math.sin(t+e)*n,e+Math.cos(t-e)*n]}class Ytt{static from(t,e=Wtt,n=Gtt,r){return new Ytt("length"in t?Ztt(t,e,n,r):Float64Array.from(Ktt(t,e,n,r)))}constructor(t){this._delaunator=new Ctt(t),this.inedges=new Int32Array(t.length/2),this._hullIndex=new Int32Array(t.length/2),this.points=this._delaunator.coords,this._init()}update(){return this._delaunator.update(),this._init(),this}_init(){const t=this._delaunator,e=this.points;if(t.hull&&t.hull.length>2&&Htt(t)){this.collinear=Int32Array.from({length:e.length/2},(t,e)=>e).sort((t,n)=>e[2*t]-e[2*n]||e[2*t+1]-e[2*n+1]);const t=this.collinear[0],n=this.collinear[this.collinear.length-1],r=[e[2*t],e[2*t+1],e[2*n],e[2*n+1]],i=1e-8*Math.hypot(r[3]-r[1],r[2]-r[0]);for(let o=0,s=e.length/2;o<s;++o){const t=Xtt(e[2*o],e[2*o+1],i);e[2*o]=t[0],e[2*o+1]=t[1]}this._delaunator=new Ctt(e)}else delete this.collinear;const n=this.halfedges=this._delaunator.halfedges,r=this.hull=this._delaunator.hull,i=this.triangles=this._delaunator.triangles,o=this.inedges.fill(-1),s=this._hullIndex.fill(-1);for(let a=0,u=n.length;a<u;++a){const t=i[a%3===2?a-2:a+1];-1!==n[a]&&-1!==o[t]||(o[t]=a)}for(let a=0,u=r.length;a<u;++a)s[r[a]]=a;r.length<=2&&r.length>0&&(this.triangles=new Int32Array(3).fill(-1),this.halfedges=new Int32Array(3).fill(-1),this.triangles[0]=r[0],this.triangles[1]=r[1],this.triangles[2]=r[1],o[r[0]]=1,2===r.length&&(o[r[1]]=0))}voronoi(t){return new $tt(this,t)}*neighbors(t){const{inedges:e,hull:n,_hullIndex:r,halfedges:i,triangles:o,collinear:s}=this;if(s){const e=s.indexOf(t);return e>0&&(yield s[e-1]),void(e<s.length-1&&(yield s[e+1]))}const a=e[t];if(-1===a)return;let u=a,c=-1;do{if(yield c=o[u],u=u%3===2?u-2:u+1,o[u]!==t)return;if(u=i[u],-1===u){const e=n[(r[t]+1)%n.length];return void(e!==c&&(yield e))}}while(u!==a)}find(t,e,n=0){if(t=+t,t!==t||(e=+e,e!==e))return-1;const r=n;let i;while((i=this._step(n,t,e))>=0&&i!==n&&i!==r)n=i;return i}_step(t,e,n){const{inedges:r,hull:i,_hullIndex:o,halfedges:s,triangles:a,points:u}=this;if(-1===r[t]||!u.length)return(t+1)%(u.length>>1);let c=t,l=qtt(e-u[2*t],2)+qtt(n-u[2*t+1],2);const h=r[t];let f=h;do{let r=a[f];const h=qtt(e-u[2*r],2)+qtt(n-u[2*r+1],2);if(h<l&&(l=h,c=r),f=f%3===2?f-2:f+1,a[f]!==t)break;if(f=s[f],-1===f){if(f=i[(o[t]+1)%i.length],f!==r&&qtt(e-u[2*f],2)+qtt(n-u[2*f+1],2)<l)return f;break}}while(f!==h);return c}render(t){const e=null==t?t=new ztt:void 0,{points:n,halfedges:r,triangles:i}=this;for(let o=0,s=r.length;o<s;++o){const e=r[o];if(e<o)continue;const s=2*i[o],a=2*i[e];t.moveTo(n[s],n[s+1]),t.lineTo(n[a],n[a+1])}return this.renderHull(t),e&&e.value()}renderPoints(t,e=2){const n=null==t?t=new ztt:void 0,{points:r}=this;for(let i=0,o=r.length;i<o;i+=2){const n=r[i],o=r[i+1];t.moveTo(n+e,o),t.arc(n,o,e,0,Vtt)}return n&&n.value()}renderHull(t){const e=null==t?t=new ztt:void 0,{hull:n,points:r}=this,i=2*n[0],o=n.length;t.moveTo(r[i],r[i+1]);for(let s=1;s<o;++s){const e=2*n[s];t.lineTo(r[e],r[e+1])}return t.closePath(),e&&e.value()}hullPolygon(){const t=new Utt;return this.renderHull(t),t.value()}renderTriangle(t,e){const n=null==e?e=new ztt:void 0,{points:r,triangles:i}=this,o=2*i[t*=3],s=2*i[t+1],a=2*i[t+2];return e.moveTo(r[o],r[o+1]),e.lineTo(r[s],r[s+1]),e.lineTo(r[a],r[a+1]),e.closePath(),n&&n.value()}*trianglePolygons(){const{triangles:t}=this;for(let e=0,n=t.length/3;e<n;++e)yield this.trianglePolygon(e)}trianglePolygon(t){const e=new Utt;return this.renderTriangle(t,e),e.value()}}function Ztt(t,e,n,r){const i=t.length,o=new Float64Array(2*i);for(let s=0;s<i;++s){const i=t[s];o[2*s]=e.call(r,i,s,t),o[2*s+1]=n.call(r,i,s,t)}return o}function*Ktt(t,e,n,r){let i=0;for(const o of t)yield e.call(r,o,i,t),yield n.call(r,o,i,t),++i}function Jtt(t){JO.call(this,null,t)}Jtt.Definition={type:"Voronoi",metadata:{modifies:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"size",type:"number",array:!0,length:2},{name:"extent",type:"array",array:!0,length:2,default:[[-1e5,-1e5],[1e5,1e5]],content:{type:"number",array:!0,length:2}},{name:"as",type:"string",default:"path"}]};const Qtt=[-1e5,-1e5,1e5,1e5];function tet(t){const e=t[0][0],n=t[0][1];let r=t.length-1;for(;t[r][0]===e&&t[r][1]===n;--r);return"M"+t.slice(0,r+1).join("L")+"Z"}function eet(t,e,n){return t.fields=e||[],t.fname=n,t}function net(t){return 1===t.length?ret(t[0]):iet(t)}Ett(Jtt,JO,{transform(t,e){const n=t.as||"path",r=e.source;if(!r||!r.length)return e;let i=t.size;i=i?[0,0,i[0],i[1]]:(i=t.extent)?[i[0][0],i[0][1],i[1][0],i[1][1]]:Qtt;const o=this.value=Ytt.from(r,t.x,t.y).voronoi(i);for(let s=0,a=r.length;s<a;++s){const t=o.cellPolygon(s);r[s][n]=t?tet(t):null}return e.reflow(t.modified()).modifies(n)}});const ret=t=>(function(e){return e[t]}),iet=t=>{const e=t.length;return function(n){for(let r=0;r<e;++r)n=n[t[r]];return n}};function oet(t){throw Error(t)}function set(t){const e=[],n=t.length;let r,i,o,s=null,a=0,u="";function c(){e.push(u+t.substring(r,i)),u="",r=i+1}for(t+="",r=i=0;i<n;++i)if(o=t[i],"\\"===o)u+=t.substring(r,i),u+=t.substring(++i,++i),r=i;else if(o===s)c(),s=null,a=-1;else{if(s)continue;r===a&&'"'===o?(r=i+1,s=o):r===a&&"'"===o?(r=i+1,s=o):"."!==o||a?"["===o?(i>r&&c(),a=r=i+1):"]"===o&&(a||oet("Access path missing open bracket: "+t),a>0&&c(),a=0,r=i+1):i>r?c():r=i+1}return a&&oet("Access path missing closing bracket: "+t),s&&oet("Access path missing closing quote: "+t),i>r&&(i++,c()),e}function aet(t,e,n){const r=set(t);return t=1===r.length?r[0]:t,eet((n&&n.get||net)(r),[t],e||t)}aet("id"),eet(t=>t,[],"identity"),eet(()=>0,[],"zero"),eet(()=>1,[],"one"),eet(()=>!0,[],"true"),eet(()=>!1,[],"false");Array.isArray;function uet(t){return"function"===typeof t}function cet(t){return uet(t)?t:()=>t}function het(t){for(let e,n,r=1,i=arguments.length;r<i;++r)for(n in e=arguments[r],e)t[n]=e[n];return t}function fet(t,e){let n,r,i,o,s=0;if(t&&(n=t.length))if(null==e){for(r=t[s];s<n&&(null==r||r!==r);r=t[++s]);for(i=o=r;s<n;++s)r=t[s],null!=r&&(r<i&&(i=r),r>o&&(o=r))}else{for(r=e(t[s]);s<n&&(null==r||r!==r);r=e(t[++s]));for(i=o=r;s<n;++s)r=e(t[s]),null!=r&&(r<i&&(i=r),r>o&&(o=r))}return[i,o]}Object.prototype.hasOwnProperty;function det(t,e,n){const r=t.prototype=Object.create(e.prototype);return Object.defineProperty(r,"constructor",{value:t,writable:!0,enumerable:!0,configurable:!0}),het(r,n)}var pet=Math.PI/180,get=64,met=2048;function yet(){var t,e,n,r,i,o,s,a=[256,256],u=xet,c=[],l=Math.random,h={};function f(t){t.width=t.height=1;var e=Math.sqrt(t.getContext("2d").getImageData(0,0,1,1).data.length>>2);t.width=(get<<5)/e,t.height=met/e;var n=t.getContext("2d");return n.fillStyle=n.strokeStyle="red",n.textAlign="center",{context:n,ratio:e}}function d(t,e,n){var r,i,o,s=e.x,c=e.y,h=Math.sqrt(a[0]*a[0]+a[1]*a[1]),f=u(a),d=l()<.5?1:-1,p=-d;while(r=f(p+=d)){if(i=~~r[0],o=~~r[1],Math.min(Math.abs(i),Math.abs(o))>=h)break;if(e.x=s+i,e.y=c+o,!(e.x+e.x0<0||e.y+e.y0<0||e.x+e.x1>a[0]||e.y+e.y1>a[1])&&(!n||!bet(e,t,a[0]))&&(!n||wet(e,n))){for(var g,m=e.sprite,y=e.width>>5,v=a[0]>>5,b=e.x-(y<<4),_=127&b,w=32-_,x=e.y1-e.y0,S=(e.y+e.y0)*v+(b>>5),E=0;E<x;E++){g=0;for(var A=0;A<=y;A++)t[S+A]|=g<<w|(A<y?(g=m[E*y+A])>>>_:0);S+=v}return e.sprite=null,!0}}return!1}return h.layout=function(){var u=f(JD()),h=Aet((a[0]>>5)*a[1]),p=null,g=c.length,m=-1,y=[],v=c.map(a=>({text:t(a),font:e(a),style:r(a),weight:i(a),rotate:o(a),size:~~(n(a)+1e-14),padding:s(a),xoff:0,yoff:0,x1:0,y1:0,x0:0,y0:0,hasText:!1,sprite:null,datum:a})).sort((t,e)=>e.size-t.size);while(++m<g){var b=v[m];b.x=a[0]*(l()+.5)>>1,b.y=a[1]*(l()+.5)>>1,vet(u,b,v,m),b.hasText&&d(h,b,p)&&(y.push(b),p?_et(p,b):p=[{x:b.x+b.x0,y:b.y+b.y0},{x:b.x+b.x1,y:b.y+b.y1}],b.x-=a[0]>>1,b.y-=a[1]>>1)}return y},h.words=function(t){return arguments.length?(c=t,h):c},h.size=function(t){return arguments.length?(a=[+t[0],+t[1]],h):a},h.font=function(t){return arguments.length?(e=Met(t),h):e},h.fontStyle=function(t){return arguments.length?(r=Met(t),h):r},h.fontWeight=function(t){return arguments.length?(i=Met(t),h):i},h.rotate=function(t){return arguments.length?(o=Met(t),h):o},h.text=function(e){return arguments.length?(t=Met(e),h):t},h.spiral=function(t){return arguments.length?(u=Cet[t]||t,h):u},h.fontSize=function(t){return arguments.length?(n=Met(t),h):n},h.padding=function(t){return arguments.length?(s=Met(t),h):s},h.random=function(t){return arguments.length?(l=t,h):l},h}function vet(t,e,n,r){if(!e.sprite){var i=t.context,o=t.ratio;i.clearRect(0,0,(get<<5)/o,met/o);var s,a,u,c,l,h=0,f=0,d=0,p=n.length;--r;while(++r<p){if(e=n[r],i.save(),i.font=e.style+" "+e.weight+" "+~~((e.size+1)/o)+"px "+e.font,s=i.measureText(e.text+"m").width*o,u=e.size<<1,e.rotate){var g=Math.sin(e.rotate*pet),m=Math.cos(e.rotate*pet),y=s*m,v=s*g,b=u*m,_=u*g;s=Math.max(Math.abs(y+_),Math.abs(y-_))+31>>5<<5,u=~~Math.max(Math.abs(v+b),Math.abs(v-b))}else s=s+31>>5<<5;if(u>d&&(d=u),h+s>=get<<5&&(h=0,f+=d,d=0),f+u>=met)break;i.translate((h+(s>>1))/o,(f+(u>>1))/o),e.rotate&&i.rotate(e.rotate*pet),i.fillText(e.text,0,0),e.padding&&(i.lineWidth=2*e.padding,i.strokeText(e.text,0,0)),i.restore(),e.width=s,e.height=u,e.xoff=h,e.yoff=f,e.x1=s>>1,e.y1=u>>1,e.x0=-e.x1,e.y0=-e.y1,e.hasText=!0,h+=s}var w=i.getImageData(0,0,(get<<5)/o,met/o).data,x=[];while(--r>=0)if(e=n[r],e.hasText){for(s=e.width,a=s>>5,u=e.y1-e.y0,c=0;c<u*a;c++)x[c]=0;if(h=e.xoff,null==h)return;f=e.yoff;var S=0,E=-1;for(l=0;l<u;l++){for(c=0;c<s;c++){var A=a*l+(c>>5),M=w[(f+l)*(get<<5)+(h+c)<<2]?1<<31-c%32:0;x[A]|=M,S|=M}S?E=l:(e.y0++,u--,l--,f++)}e.y1=e.y0+E,e.sprite=x.slice(0,(e.y1-e.y0)*a)}}}function bet(t,e,n){n>>=5;for(var r,i=t.sprite,o=t.width>>5,s=t.x-(o<<4),a=127&s,u=32-a,c=t.y1-t.y0,l=(t.y+t.y0)*n+(s>>5),h=0;h<c;h++){r=0;for(var f=0;f<=o;f++)if((r<<u|(f<o?(r=i[h*o+f])>>>a:0))&e[l+f])return!0;l+=n}return!1}function _et(t,e){var n=t[0],r=t[1];e.x+e.x0<n.x&&(n.x=e.x+e.x0),e.y+e.y0<n.y&&(n.y=e.y+e.y0),e.x+e.x1>r.x&&(r.x=e.x+e.x1),e.y+e.y1>r.y&&(r.y=e.y+e.y1)}function wet(t,e){return t.x+t.x1>e[0].x&&t.x+t.x0<e[1].x&&t.y+t.y1>e[0].y&&t.y+t.y0<e[1].y}function xet(t){var e=t[0]/t[1];return function(t){return[e*(t*=.1)*Math.cos(t),t*Math.sin(t)]}}function Eet(t){var e=4,n=e*t[0]/t[1],r=0,i=0;return function(t){var o=t<0?-1:1;switch(Math.sqrt(1+4*o*t)-o&3){case 0:r+=n;break;case 1:i+=e;break;case 2:r-=n;break;default:i-=e;break}return[r,i]}}function Aet(t){var e=[],n=-1;while(++n<t)e[n]=0;return e}function Met(t){return"function"===typeof t?t:function(){return t}}var Cet={archimedean:xet,rectangular:Eet};const ket=["x","y","font","fontSize","fontStyle","fontWeight","angle"],Oet=["text","font","rotate","fontSize","fontStyle","fontWeight"];function Pet(t){JO.call(this,yet(),t)}Pet.Definition={type:"Wordcloud",metadata:{modifies:!0},params:[{name:"size",type:"number",array:!0,length:2},{name:"font",type:"string",expr:!0,default:"sans-serif"},{name:"fontStyle",type:"string",expr:!0,default:"normal"},{name:"fontWeight",type:"string",expr:!0,default:"normal"},{name:"fontSize",type:"number",expr:!0,default:14},{name:"fontSizeRange",type:"number",array:"nullable",default:[10,50]},{name:"rotate",type:"number",expr:!0,default:0},{name:"text",type:"field"},{name:"spiral",type:"string",values:["archimedean","rectangular"]},{name:"padding",type:"number",expr:!0},{name:"as",type:"string",array:!0,length:7,default:ket}]},det(Pet,JO,{transform(t,e){function n(n){const r=t[n];return uet(r)&&e.modified(r.fields)}!t.size||t.size[0]&&t.size[1]||oet("Wordcloud size dimensions must be non-zero.");const r=t.modified();if(!(r||e.changed(e.ADD_REM)||Oet.some(n)))return;const i=e.materialize(e.SOURCE).source,o=this.value,s=t.as||ket;let a,u=t.fontSize||14;if(uet(u)?a=t.fontSizeRange:u=cet(u),a){const t=u,e=Vz("sqrt")().domain(fet(i,t)).range(a);u=n=>e(t(n))}i.forEach(t=>{t[s[0]]=NaN,t[s[1]]=NaN,t[s[3]]=0});const c=o.words(i).text(t.text).size(t.size||[500,500]).padding(t.padding||1).spiral(t.spiral||"archimedean").rotate(t.rotate||0).font(t.font||"sans-serif").fontStyle(t.fontStyle||"normal").fontWeight(t.fontWeight||"normal").fontSize(u).random(tT).layout(),l=o.size(),h=l[0]>>1,f=l[1]>>1,d=c.length;for(let p,g,m=0;m<d;++m)p=c[m],g=p.datum,g[s[0]]=p.x+h,g[s[1]]=p.y+f,g[s[2]]=p.font,g[s[3]]=p.size,g[s[4]]=p.style,g[s[5]]=p.weight,g[s[6]]=p.rotate;return e.reflow(r).modifies(s)}});var Tet=function(t,e){return t<e?-1:t>e?1:t>=e?0:NaN},Let=function(t){let e=t,n=t;function r(t,e,r,i){null==r&&(r=0),null==i&&(i=t.length);while(r<i){const o=r+i>>>1;n(t[o],e)<0?r=o+1:i=o}return r}function i(t,e,r,i){null==r&&(r=0),null==i&&(i=t.length);while(r<i){const o=r+i>>>1;n(t[o],e)>0?i=o:r=o+1}return r}function o(t,n,i,o){null==i&&(i=0),null==o&&(o=t.length);const s=r(t,n,i,o-1);return s>i&&e(t[s-1],n)>-e(t[s],n)?s-1:s}return 1===t.length&&(e=(e,n)=>t(e)-n,n=Iet(t)),{left:r,center:o,right:i}};function Iet(t){return(e,n)=>Tet(t(e),n)}var Net=function(t){return null===t?NaN:+t};const Det=Let(Tet),Ret=Det.right,Fet=Det.left;Let(Net).center;var Bet=function(t,e){return Array.from(e,e=>t[e])};function jet(t,e,n){return t.fields=e||[],t.fname=n,t}function zet(t){return 1===t.length?Uet(t[0]):$et(t)}const Uet=t=>(function(e){return e[t]}),$et=t=>{const e=t.length;return function(n){for(let r=0;r<e;++r)n=n[t[r]];return n}};function Vet(t){throw Error(t)}function qet(t){const e=[],n=t.length;let r,i,o,s=null,a=0,u="";function c(){e.push(u+t.substring(r,i)),u="",r=i+1}for(t+="",r=i=0;i<n;++i)if(o=t[i],"\\"===o)u+=t.substring(r,i),u+=t.substring(++i,++i),r=i;else if(o===s)c(),s=null,a=-1;else{if(s)continue;r===a&&'"'===o?(r=i+1,s=o):r===a&&"'"===o?(r=i+1,s=o):"."!==o||a?"["===o?(i>r&&c(),a=r=i+1):"]"===o&&(a||Vet("Access path missing open bracket: "+t),a>0&&c(),a=0,r=i+1):i>r?c():r=i+1}return a&&Vet("Access path missing closing bracket: "+t),s&&Vet("Access path missing closing quote: "+t),i>r&&(i++,c()),e}function Wet(t,e,n){const r=qet(t);return t=1===r.length?r[0]:t,jet((n&&n.get||zet)(r),[t],e||t)}Wet("id"),jet(t=>t,[],"identity"),jet(()=>0,[],"zero"),jet(()=>1,[],"one"),jet(()=>!0,[],"true"),jet(()=>!1,[],"false");Array.isArray;function Get(t){for(let e,n,r=1,i=arguments.length;r<i;++r)for(n in e=arguments[r],e)t[n]=e[n];return t}Object.prototype.hasOwnProperty;function Het(t,e,n){const r=t.prototype=Object.create(e.prototype);return Object.defineProperty(r,"constructor",{value:t,writable:!0,enumerable:!0,configurable:!0}),Get(r,n)}const Xet=t=>new Uint8Array(t),Yet=t=>new Uint16Array(t),Zet=t=>new Uint32Array(t);function Ket(){let t=8,e=[],n=Zet(0),r=Qet(0,t),i=Qet(0,t);return{data:()=>e,seen:()=>n=Jet(n,e.length),add(t){for(let n,r=0,i=e.length,o=t.length;r<o;++r)n=t[r],n._index=i++,e.push(n)},remove(t,n){const o=e.length,s=Array(o-t),a=e;let u,c,l;for(c=0;!n[c]&&c<o;++c)s[c]=e[c],a[c]=c;for(l=c;c<o;++c)u=e[c],n[c]?a[c]=-1:(a[c]=l,r[l]=r[c],i[l]=i[c],s[l]=u,u._index=l++),r[c]=0;return e=s,a},size:()=>e.length,curr:()=>r,prev:()=>i,reset:t=>i[t]=r[t],all:()=>t<257?255:t<65537?65535:4294967295,set(t,e){r[t]|=e},clear(t,e){r[t]&=~e},resize(e,n){const o=r.length;(e>o||n>t)&&(t=Math.max(n,t),r=Qet(e,t,r),i=Qet(e,t))}}}function Jet(t,e,n){return t.length>=e?t:(n=n||new t.constructor(e),n.set(t),n)}function Qet(t,e,n){const r=(e<257?Xet:e<65537?Yet:Zet)(t);return n&&r.set(n),r}function tnt(t,e,n){const r=1<<e;return{one:r,zero:~r,range:n.slice(),bisect:t.bisect,index:t.index,size:t.size,onAdd(t,e){const n=this,i=n.bisect(n.range,t.value),o=t.index,s=i[0],a=i[1],u=o.length;let c;for(c=0;c<s;++c)e[o[c]]|=r;for(c=a;c<u;++c)e[o[c]]|=r;return n}}}function ent(){let t=Zet(0),e=[],n=0;function r(r,i,o){if(!i.length)return[];const s=n,a=i.length,u=Zet(a);let c,l,h,f=Array(a);for(h=0;h<a;++h)f[h]=r(i[h]),u[h]=h;if(f=nnt(f,u),s)c=e,l=t,e=Array(s+a),t=Zet(s+a),rnt(o,c,l,s,f,u,a,e,t);else{if(o>0)for(h=0;h<a;++h)u[h]+=o;e=f,t=u}return n=s+a,{index:u,value:f}}function i(r,i){const o=n;let s,a,u;for(a=0;!i[t[a]]&&a<o;++a);for(u=a;a<o;++a)i[s=t[a]]||(t[u]=s,e[u]=e[a],++u);n=o-r}function o(e){for(let r=0,i=n;r<i;++r)t[r]=e[t[r]]}function s(t,r){let i;return r?i=r.length:(r=e,i=n),[Fet(r,t[0],0,i),Ret(r,t[1],0,i)]}return{insert:r,remove:i,bisect:s,reindex:o,index:()=>t,size:()=>n}}function nnt(t,e){return t.sort.call(e,(e,n)=>{const r=t[e],i=t[n];return r<i?-1:r>i?1:0}),Bet(t,e)}function rnt(t,e,n,r,i,o,s,a,u){let c,l=0,h=0;for(c=0;l<r&&h<s;++c)e[l]<i[h]?(a[c]=e[l],u[c]=n[l++]):(a[c]=i[h],u[c]=o[h++]+t);for(;l<r;++l,++c)a[c]=e[l],u[c]=n[l];for(;h<s;++h,++c)a[c]=i[h],u[c]=o[h]+t}function int(t){JO.call(this,Ket(),t),this._indices=null,this._dims=null}function ont(t){JO.call(this,null,t)}function snt(t,e,n){return t.fields=e||[],t.fname=n,t}function ant(t){return 1===t.length?unt(t[0]):cnt(t)}int.Definition={type:"CrossFilter",metadata:{},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"query",type:"array",array:!0,required:!0,content:{type:"number",array:!0,length:2}}]},Het(int,JO,{transform(t,e){if(this._dims){var n=t.modified("fields")||t.fields.some(t=>e.modified(t.fields));return n?this.reinit(t,e):this.eval(t,e)}return this.init(t,e)},init(t,e){const n=t.fields,r=t.query,i=this._indices={},o=this._dims=[],s=r.length;let a,u,c=0;for(;c<s;++c)a=n[c].fname,u=i[a]||(i[a]=ent()),o.push(tnt(u,c,r[c]));return this.eval(t,e)},reinit(t,e){const n=e.materialize().fork(),r=t.fields,i=t.query,o=this._indices,s=this._dims,a=this.value,u=a.curr(),c=a.prev(),l=a.all(),h=n.rem=n.add,f=n.mod,d=i.length,p={};let g,m,y,v,b,_,w,x,S;if(c.set(u),e.rem.length&&(b=this.remove(t,e,n)),e.add.length&&a.add(e.add),e.mod.length)for(_={},v=e.mod,w=0,x=v.length;w<x;++w)_[v[w]._index]=1;for(w=0;w<d;++w)S=r[w],(!s[w]||t.modified("fields",w)||e.modified(S.fields))&&(y=S.fname,(g=p[y])||(o[y]=m=ent(),p[y]=g=m.insert(S,e.source,0)),s[w]=tnt(m,w,i[w]).onAdd(g,u));for(w=0,x=a.data().length;w<x;++w)b[w]||(c[w]!==u[w]?h.push(w):_[w]&&u[w]!==l&&f.push(w));return a.mask=(1<<d)-1,n},eval(t,e){const n=e.materialize().fork(),r=this._dims.length;let i=0;return e.rem.length&&(this.remove(t,e,n),i|=(1<<r)-1),t.modified("query")&&!t.modified("fields")&&(i|=this.update(t,e,n)),e.add.length&&(this.insert(t,e,n),i|=(1<<r)-1),e.mod.length&&(this.modify(e,n),i|=(1<<r)-1),this.value.mask=i,n},insert(t,e,n){const r=e.add,i=this.value,o=this._dims,s=this._indices,a=t.fields,u={},c=n.add,l=i.size()+r.length,h=o.length;let f,d,p,g=i.size();i.resize(l,h),i.add(r);const m=i.curr(),y=i.prev(),v=i.all();for(f=0;f<h;++f)d=a[f].fname,p=u[d]||(u[d]=s[d].insert(a[f],r,g)),o[f].onAdd(p,m);for(;g<l;++g)y[g]=v,m[g]!==v&&c.push(g)},modify(t,e){const n=e.mod,r=this.value,i=r.curr(),o=r.all(),s=t.mod;let a,u,c;for(a=0,u=s.length;a<u;++a)c=s[a]._index,i[c]!==o&&n.push(c)},remove(t,e,n){const r=this._indices,i=this.value,o=i.curr(),s=i.prev(),a=i.all(),u={},c=n.rem,l=e.rem;let h,f,d,p;for(h=0,f=l.length;h<f;++h)d=l[h]._index,u[d]=1,s[d]=p=o[d],o[d]=a,p!==a&&c.push(d);for(d in r)r[d].remove(f,u);return this.reindex(e,f,u),u},reindex(t,e,n){const r=this._indices,i=this.value;t.runAfter(()=>{const t=i.remove(e,n);for(const e in r)r[e].reindex(t)})},update(t,e,n){const r=this._dims,i=t.query,o=e.stamp,s=r.length;let a,u,c=0;for(n.filters=0,u=0;u<s;++u)t.modified("query",u)&&(a=u,++c);if(1===c)c=r[a].one,this.incrementOne(r[a],i[a],n.add,n.rem);else for(u=0,c=0;u<s;++u)t.modified("query",u)&&(c|=r[u].one,this.incrementAll(r[u],i[u],o,n.add),n.rem=n.add);return c},incrementAll(t,e,n,r){const i=this.value,o=i.seen(),s=i.curr(),a=i.prev(),u=t.index(),c=t.bisect(t.range),l=t.bisect(e),h=l[0],f=l[1],d=c[0],p=c[1],g=t.one;let m,y,v;if(h<d)for(m=h,y=Math.min(d,f);m<y;++m)v=u[m],o[v]!==n&&(a[v]=s[v],o[v]=n,r.push(v)),s[v]^=g;else if(h>d)for(m=d,y=Math.min(h,p);m<y;++m)v=u[m],o[v]!==n&&(a[v]=s[v],o[v]=n,r.push(v)),s[v]^=g;if(f>p)for(m=Math.max(h,p),y=f;m<y;++m)v=u[m],o[v]!==n&&(a[v]=s[v],o[v]=n,r.push(v)),s[v]^=g;else if(f<p)for(m=Math.max(d,f),y=p;m<y;++m)v=u[m],o[v]!==n&&(a[v]=s[v],o[v]=n,r.push(v)),s[v]^=g;t.range=e.slice()},incrementOne(t,e,n,r){const i=this.value,o=i.curr(),s=t.index(),a=t.bisect(t.range),u=t.bisect(e),c=u[0],l=u[1],h=a[0],f=a[1],d=t.one;let p,g,m;if(c<h)for(p=c,g=Math.min(h,l);p<g;++p)m=s[p],o[m]^=d,n.push(m);else if(c>h)for(p=h,g=Math.min(c,f);p<g;++p)m=s[p],o[m]^=d,r.push(m);if(l>f)for(p=Math.max(c,f),g=l;p<g;++p)m=s[p],o[m]^=d,n.push(m);else if(l<f)for(p=Math.max(h,l),g=f;p<g;++p)m=s[p],o[m]^=d,r.push(m);t.range=e.slice()}}),ont.Definition={type:"ResolveFilter",metadata:{},params:[{name:"ignore",type:"number",required:!0,description:"A bit mask indicating which filters to ignore."},{name:"filter",type:"object",required:!0,description:"Per-tuple filter bitmaps from a CrossFilter transform."}]},Het(ont,JO,{transform(t,e){const n=~(t.ignore||0),r=t.filter,i=r.mask;if(0===(i&n))return e.StopPropagation;const o=e.fork(e.ALL),s=r.data(),a=r.curr(),u=r.prev(),c=t=>a[t]&n?null:s[t];return o.filter(o.MOD,c),i&i-1?(o.filter(o.ADD,t=>{const e=a[t]&n,r=!e&&e^u[t]&n;return r?s[t]:null}),o.filter(o.REM,t=>{const e=a[t]&n,r=e&&!(e^e^u[t]&n);return r?s[t]:null})):(o.filter(o.ADD,c),o.filter(o.REM,t=>(a[t]&n)===i?s[t]:null)),o.filter(o.SOURCE,t=>c(t._index))}});const unt=t=>(function(e){return e[t]}),cnt=t=>{const e=t.length;return function(n){for(let r=0;r<e;++r)n=n[t[r]];return n}};function lnt(t){throw Error(t)}function hnt(t){const e=[],n=t.length;let r,i,o,s=null,a=0,u="";function c(){e.push(u+t.substring(r,i)),u="",r=i+1}for(t+="",r=i=0;i<n;++i)if(o=t[i],"\\"===o)u+=t.substring(r,i),u+=t.substring(++i,++i),r=i;else if(o===s)c(),s=null,a=-1;else{if(s)continue;r===a&&'"'===o?(r=i+1,s=o):r===a&&"'"===o?(r=i+1,s=o):"."!==o||a?"["===o?(i>r&&c(),a=r=i+1):"]"===o&&(a||lnt("Access path missing open bracket: "+t),a>0&&c(),a=0,r=i+1):i>r?c():r=i+1}return a&&lnt("Access path missing closing bracket: "+t),s&&lnt("Access path missing closing quote: "+t),i>r&&(i++,c()),e}function fnt(t,e,n){const r=hnt(t);return t=1===r.length?r[0]:t,snt((n&&n.get||ant)(r),[t],e||t)}fnt("id"),snt(t=>t,[],"identity"),snt(()=>0,[],"zero"),snt(()=>1,[],"one");const dnt=snt(()=>!0,[],"true");snt(()=>!1,[],"false");var pnt=Array.isArray;function gnt(t){return t===Object(t)}function mnt(t){return null!=t?pnt(t)?t:[t]:[]}function ynt(t){return"function"===typeof t}function vnt(t){return ynt(t)?t:()=>t}function bnt(t,e){let n;return r=>{n&&clearTimeout(n),n=setTimeout(()=>(e(r),n=null),t)}}function _nt(t){for(let e,n,r=1,i=arguments.length;r<i;++r)for(n in e=arguments[r],e)t[n]=e[n];return t}const wnt=Object.prototype.hasOwnProperty;function xnt(t,e){return wnt.call(t,e)}function Snt(t,e,n){const r=t.prototype=Object.create(e.prototype);return Object.defineProperty(r,"constructor",{value:t,writable:!0,enumerable:!0,configurable:!0}),_nt(r,n)}function Ent(t){return"[object Date]"===Object.prototype.toString.call(t)}function Ant(t){return"string"===typeof t}function Mnt(t){return pnt(t)?"["+t.map(Mnt)+"]":gnt(t)||Ant(t)?JSON.stringify(t).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):t}function Cnt(t){const e={},n=t.length;for(let r=0;r<n;++r)e[t[r]]=!0;return e}var knt=Math.sqrt(50),Ont=Math.sqrt(10),Pnt=Math.sqrt(2);function Tnt(t,e,n){var r=Math.abs(e-t)/Math.max(0,n),i=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),o=r/i;return o>=knt?i*=10:o>=Ont?i*=5:o>=Pnt&&(i*=2),e<t?-i:i}function Lnt(t,e,n){return t.fields=e||[],t.fname=n,t}function Int(t){return 1===t.length?Nnt(t[0]):Dnt(t)}const Nnt=t=>(function(e){return e[t]}),Dnt=t=>{const e=t.length;return function(n){for(let r=0;r<e;++r)n=n[t[r]];return n}};function Rnt(t){throw Error(t)}function Fnt(t){const e=[],n=t.length;let r,i,o,s=null,a=0,u="";function c(){e.push(u+t.substring(r,i)),u="",r=i+1}for(t+="",r=i=0;i<n;++i)if(o=t[i],"\\"===o)u+=t.substring(r,i),u+=t.substring(++i,++i),r=i;else if(o===s)c(),s=null,a=-1;else{if(s)continue;r===a&&'"'===o?(r=i+1,s=o):r===a&&"'"===o?(r=i+1,s=o):"."!==o||a?"["===o?(i>r&&c(),a=r=i+1):"]"===o&&(a||Rnt("Access path missing open bracket: "+t),a>0&&c(),a=0,r=i+1):i>r?c():r=i+1}return a&&Rnt("Access path missing closing bracket: "+t),s&&Rnt("Access path missing closing quote: "+t),i>r&&(i++,c()),e}function Bnt(t,e,n){const r=Fnt(t);return t=1===r.length?r[0]:t,Lnt((n&&n.get||Int)(r),[t],e||t)}Bnt("id");const jnt=Lnt(t=>t,[],"identity"),znt=(Lnt(()=>0,[],"zero"),Lnt(()=>1,[],"one"),Lnt(()=>!0,[],"true"));Lnt(()=>!1,[],"false");var Unt=Array.isArray;function $nt(t){return t===Object(t)}function Vnt(t){return t[t.length-1]}function qnt(t){return null==t||""===t?null:+t}const Wnt=t=>e=>t*Math.exp(e),Gnt=t=>e=>Math.log(t*e),Hnt=t=>e=>Math.sign(e)*Math.log1p(Math.abs(e/t)),Xnt=t=>e=>Math.sign(e)*Math.expm1(Math.abs(e))*t,Ynt=t=>e=>e<0?-Math.pow(-e,t):Math.pow(e,t);function Znt(t,e,n,r){const i=n(t[0]),o=n(Vnt(t)),s=(o-i)*e;return[r(i-s),r(o-s)]}function Knt(t,e){return Znt(t,e,qnt,jnt)}function Jnt(t,e){var n=Math.sign(t[0]);return Znt(t,e,Gnt(n),Wnt(n))}function Qnt(t,e,n){return Znt(t,e,Ynt(n),Ynt(1/n))}function trt(t,e,n){return Znt(t,e,Hnt(n),Xnt(n))}function ert(t,e,n,r,i){const o=r(t[0]),s=r(Vnt(t)),a=null!=e?r(e):(o+s)/2;return[i(a+(o-a)*n),i(a+(s-a)*n)]}function nrt(t,e,n){return ert(t,e,n,qnt,jnt)}function rrt(t,e,n){const r=Math.sign(t[0]);return ert(t,e,n,Gnt(r),Wnt(r))}function irt(t,e,n,r){return ert(t,e,n,Ynt(r),Ynt(1/r))}function ort(t,e,n,r){return ert(t,e,n,Hnt(r),Xnt(r))}function srt(t){return 1+~~(new Date(t).getMonth()/3)}function art(t){return 1+~~(new Date(t).getUTCMonth()/3)}function urt(t){return null!=t?Unt(t)?t:[t]:[]}function crt(t,e,n){let r,i=t[0],o=t[1];return o<i&&(r=o,o=i,i=r),r=o-i,r>=n-e?[e,n]:[i=Math.min(Math.max(i,e),n-r),i+r]}function lrt(t){return"function"===typeof t}function hrt(t){for(let e,n,r=1,i=arguments.length;r<i;++r)for(n in e=arguments[r],e)t[n]=e[n];return t}function frt(t,e){let n,r,i,o,s=0;if(t&&(n=t.length))if(null==e){for(r=t[s];s<n&&(null==r||r!==r);r=t[++s]);for(i=o=r;s<n;++s)r=t[s],null!=r&&(r<i&&(i=r),r>o&&(o=r))}else{for(r=e(t[s]);s<n&&(null==r||r!==r);r=e(t[++s]));for(i=o=r;s<n;++s)r=e(t[s]),null!=r&&(r<i&&(i=r),r>o&&(o=r))}return[i,o]}const drt=Object.prototype.hasOwnProperty;function prt(t,e){return drt.call(t,e)}function grt(t,e,n,r,i,o){if(!n&&0!==n)return o;const s=+n;let a,u=t[0],c=Vnt(t);c<u&&(a=u,u=c,c=a),a=Math.abs(e-u);const l=Math.abs(c-e);return a<l&&a<=s?r:l<=s?i:o}function mrt(t,e,n,r){let i,o=e[0],s=e[e.length-1];return o>s&&(i=o,o=s,s=i),n=void 0===n||n,r=void 0===r||r,(n?o<=t:o<t)&&(r?t<=s:t<s)}function yrt(t){return"boolean"===typeof t}function vrt(t){return"[object Date]"===Object.prototype.toString.call(t)}function brt(t){return"number"===typeof t}function _rt(t){return"[object RegExp]"===Object.prototype.toString.call(t)}function wrt(t){return"string"===typeof t}function xrt(t,e){const n=t[0],r=Vnt(t),i=+e;return i?1===i?r:n+i*(r-n):n}function Srt(t,e){let n="";while(--e>=0)n+=t;return n}function Ert(t,e,n,r){const i=n||" ",o=t+"",s=e-o.length;return s<=0?o:"left"===r?Srt(i,s)+o:"center"===r?Srt(i,~~(s/2))+o+Srt(i,Math.ceil(s/2)):o+Srt(i,s)}function Art(t){return t&&Vnt(t)-t[0]||0}function Mrt(t){return Unt(t)?"["+t.map(Mrt)+"]":$nt(t)||wrt(t)?JSON.stringify(t).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):t}function Crt(t){return null==t||""===t?null:!(!t||"false"===t||"0"===t)&&!!t}const krt=t=>brt(t)?t:vrt(t)?t:Date.parse(t);function Ort(t,e){return e=e||krt,null==t||""===t?null:e(t)}function Prt(t){return null==t||""===t?null:t+""}function Trt(t,e,n,r){const i=null!=r?r:"…",o=t+"",s=o.length,a=Math.max(0,e-i.length);return s<=e?o:"left"===n?i+o.slice(s-a):"center"===n?o.slice(0,Math.ceil(a/2))+i+o.slice(s-~~(a/2)):o.slice(0,a)+i}function Lrt(t,e,n){return t.fields=e||[],t.fname=n,t}function Irt(t){return 1===t.length?Nrt(t[0]):Drt(t)}const Nrt=t=>(function(e){return e[t]}),Drt=t=>{const e=t.length;return function(n){for(let r=0;r<e;++r)n=n[t[r]];return n}};function Rrt(t){throw Error(t)}function Frt(t){const e=[],n=t.length;let r,i,o,s=null,a=0,u="";function c(){e.push(u+t.substring(r,i)),u="",r=i+1}for(t+="",r=i=0;i<n;++i)if(o=t[i],"\\"===o)u+=t.substring(r,i),u+=t.substring(++i,++i),r=i;else if(o===s)c(),s=null,a=-1;else{if(s)continue;r===a&&'"'===o?(r=i+1,s=o):r===a&&"'"===o?(r=i+1,s=o):"."!==o||a?"["===o?(i>r&&c(),a=r=i+1):"]"===o&&(a||Rrt("Access path missing open bracket: "+t),a>0&&c(),a=0,r=i+1):i>r?c():r=i+1}return a&&Rrt("Access path missing closing bracket: "+t),s&&Rrt("Access path missing closing quote: "+t),i>r&&(i++,c()),e}function Brt(t,e,n){const r=Frt(t);return t=1===r.length?r[0]:t,Lrt((n&&n.get||Irt)(r),[t],e||t)}Brt("id"),Lrt(t=>t,[],"identity"),Lrt(()=>0,[],"zero"),Lrt(()=>1,[],"one"),Lrt(()=>!0,[],"true"),Lrt(()=>!1,[],"false");Array.isArray;function jrt(t){return"function"===typeof t}const zrt=Object.prototype.hasOwnProperty;function Urt(t,e){return zrt.call(t,e)}function $rt(t){return"string"===typeof t}function Vrt(t){const e={},n=t.length;for(let r=0;r<n;++r)e[t[r]]=!0;return e}const qrt="RawCode",Wrt="Literal",Grt="Property",Hrt="Identifier",Xrt="ArrayExpression",Yrt="BinaryExpression",Zrt="CallExpression",Krt="ConditionalExpression",Jrt="LogicalExpression",Qrt="MemberExpression",tit="ObjectExpression",eit="UnaryExpression";function nit(t){this.type=t}function rit(t){switch(t.type){case Xrt:return t.elements;case Yrt:case Jrt:return[t.left,t.right];case Zrt:return[t.callee].concat(t.arguments);case Krt:return[t.test,t.consequent,t.alternate];case Qrt:return[t.object,t.property];case tit:return t.properties;case Grt:return[t.key,t.value];case eit:return[t.argument];case Hrt:case Wrt:case qrt:default:return[]}}var iit,oit,sit,ait,uit;nit.prototype.visit=function(t){let e,n,r;if(t(this))return 1;for(e=rit(this),n=0,r=e.length;n<r;++n)if(e[n].visit(t))return 1};var cit=1,lit=2,hit=3,fit=4,dit=5,pit=6,git=7,mit=8,yit=9;iit={},iit[cit]="Boolean",iit[lit]="<end>",iit[hit]="Identifier",iit[fit]="Keyword",iit[dit]="Null",iit[pit]="Numeric",iit[git]="Punctuator",iit[mit]="String",iit[yit]="RegularExpression";var vit="ArrayExpression",bit="BinaryExpression",_it="CallExpression",wit="ConditionalExpression",xit="Identifier",Sit="Literal",Eit="LogicalExpression",Ait="MemberExpression",Mit="ObjectExpression",Cit="Property",kit="UnaryExpression",Oit="Unexpected token %0",Pit="Unexpected number",Tit="Unexpected string",Lit="Unexpected identifier",Iit="Unexpected reserved word",Nit="Unexpected end of input",Dit="Invalid regular expression",Rit="Invalid regular expression: missing /",Fit="Octal literals are not allowed in strict mode.",Bit="Duplicate data property in object literal not allowed in strict mode",jit="ILLEGAL",zit="Disabled.",Uit=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B2\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]"),$it=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0300-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u0483-\\u0487\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0610-\\u061A\\u0620-\\u0669\\u066E-\\u06D3\\u06D5-\\u06DC\\u06DF-\\u06E8\\u06EA-\\u06FC\\u06FF\\u0710-\\u074A\\u074D-\\u07B1\\u07C0-\\u07F5\\u07FA\\u0800-\\u082D\\u0840-\\u085B\\u08A0-\\u08B2\\u08E4-\\u0963\\u0966-\\u096F\\u0971-\\u0983\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BC-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CE\\u09D7\\u09DC\\u09DD\\u09DF-\\u09E3\\u09E6-\\u09F1\\u0A01-\\u0A03\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A59-\\u0A5C\\u0A5E\\u0A66-\\u0A75\\u0A81-\\u0A83\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABC-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AD0\\u0AE0-\\u0AE3\\u0AE6-\\u0AEF\\u0B01-\\u0B03\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3C-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B5C\\u0B5D\\u0B5F-\\u0B63\\u0B66-\\u0B6F\\u0B71\\u0B82\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD0\\u0BD7\\u0BE6-\\u0BEF\\u0C00-\\u0C03\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C58\\u0C59\\u0C60-\\u0C63\\u0C66-\\u0C6F\\u0C81-\\u0C83\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBC-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CDE\\u0CE0-\\u0CE3\\u0CE6-\\u0CEF\\u0CF1\\u0CF2\\u0D01-\\u0D03\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4E\\u0D57\\u0D60-\\u0D63\\u0D66-\\u0D6F\\u0D7A-\\u0D7F\\u0D82\\u0D83\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DE6-\\u0DEF\\u0DF2\\u0DF3\\u0E01-\\u0E3A\\u0E40-\\u0E4E\\u0E50-\\u0E59\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB9\\u0EBB-\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EC8-\\u0ECD\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF\\u0F00\\u0F18\\u0F19\\u0F20-\\u0F29\\u0F35\\u0F37\\u0F39\\u0F3E-\\u0F47\\u0F49-\\u0F6C\\u0F71-\\u0F84\\u0F86-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u1000-\\u1049\\u1050-\\u109D\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u135D-\\u135F\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1714\\u1720-\\u1734\\u1740-\\u1753\\u1760-\\u176C\\u176E-\\u1770\\u1772\\u1773\\u1780-\\u17D3\\u17D7\\u17DC\\u17DD\\u17E0-\\u17E9\\u180B-\\u180D\\u1810-\\u1819\\u1820-\\u1877\\u1880-\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1920-\\u192B\\u1930-\\u193B\\u1946-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u19D0-\\u19D9\\u1A00-\\u1A1B\\u1A20-\\u1A5E\\u1A60-\\u1A7C\\u1A7F-\\u1A89\\u1A90-\\u1A99\\u1AA7\\u1AB0-\\u1ABD\\u1B00-\\u1B4B\\u1B50-\\u1B59\\u1B6B-\\u1B73\\u1B80-\\u1BF3\\u1C00-\\u1C37\\u1C40-\\u1C49\\u1C4D-\\u1C7D\\u1CD0-\\u1CD2\\u1CD4-\\u1CF6\\u1CF8\\u1CF9\\u1D00-\\u1DF5\\u1DFC-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u200C\\u200D\\u203F\\u2040\\u2054\\u2071\\u207F\\u2090-\\u209C\\u20D0-\\u20DC\\u20E1\\u20E5-\\u20F0\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D7F-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2DE0-\\u2DFF\\u2E2F\\u3005-\\u3007\\u3021-\\u302F\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u3099\\u309A\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA62B\\uA640-\\uA66F\\uA674-\\uA67D\\uA67F-\\uA69D\\uA69F-\\uA6F1\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA827\\uA840-\\uA873\\uA880-\\uA8C4\\uA8D0-\\uA8D9\\uA8E0-\\uA8F7\\uA8FB\\uA900-\\uA92D\\uA930-\\uA953\\uA960-\\uA97C\\uA980-\\uA9C0\\uA9CF-\\uA9D9\\uA9E0-\\uA9FE\\uAA00-\\uAA36\\uAA40-\\uAA4D\\uAA50-\\uAA59\\uAA60-\\uAA76\\uAA7A-\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEF\\uAAF2-\\uAAF6\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABEA\\uABEC\\uABED\\uABF0-\\uABF9\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE00-\\uFE0F\\uFE20-\\uFE2D\\uFE33\\uFE34\\uFE4D-\\uFE4F\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF10-\\uFF19\\uFF21-\\uFF3A\\uFF3F\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]");function Vit(t,e){if(!t)throw new Error("ASSERT: "+e)}function qit(t){return t>=48&&t<=57}function Wit(t){return"0123456789abcdefABCDEF".indexOf(t)>=0}function Git(t){return"01234567".indexOf(t)>=0}function Hit(t){return 32===t||9===t||11===t||12===t||160===t||t>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(t)>=0}function Xit(t){return 10===t||13===t||8232===t||8233===t}function Yit(t){return 36===t||95===t||t>=65&&t<=90||t>=97&&t<=122||92===t||t>=128&&Uit.test(String.fromCharCode(t))}function Zit(t){return 36===t||95===t||t>=65&&t<=90||t>=97&&t<=122||t>=48&&t<=57||92===t||t>=128&&$it.test(String.fromCharCode(t))}const Kit={if:1,in:1,do:1,var:1,for:1,new:1,try:1,let:1,this:1,else:1,case:1,void:1,with:1,enum:1,while:1,break:1,catch:1,throw:1,const:1,yield:1,class:1,super:1,return:1,typeof:1,delete:1,switch:1,export:1,import:1,public:1,static:1,default:1,finally:1,extends:1,package:1,private:1,function:1,continue:1,debugger:1,interface:1,protected:1,instanceof:1,implements:1};function Jit(){while(sit<ait){const t=oit.charCodeAt(sit);if(!Hit(t)&&!Xit(t))break;++sit}}function Qit(t){var e,n,r,i=0;for(n="u"===t?4:2,e=0;e<n;++e)sit<ait&&Wit(oit[sit])?(r=oit[sit++],i=16*i+"0123456789abcdef".indexOf(r.toLowerCase())):Cot({},Oit,jit);return String.fromCharCode(i)}function tot(){var t,e,n,r;t=oit[sit],e=0,"}"===t&&Cot({},Oit,jit);while(sit<ait){if(t=oit[sit++],!Wit(t))break;e=16*e+"0123456789abcdef".indexOf(t.toLowerCase())}return(e>1114111||"}"!==t)&&Cot({},Oit,jit),e<=65535?String.fromCharCode(e):(n=55296+(e-65536>>10),r=56320+(e-65536&1023),String.fromCharCode(n,r))}function eot(){var t,e;t=oit.charCodeAt(sit++),e=String.fromCharCode(t),92===t&&(117!==oit.charCodeAt(sit)&&Cot({},Oit,jit),++sit,t=Qit("u"),t&&"\\"!==t&&Yit(t.charCodeAt(0))||Cot({},Oit,jit),e=t);while(sit<ait){if(t=oit.charCodeAt(sit),!Zit(t))break;++sit,e+=String.fromCharCode(t),92===t&&(e=e.substr(0,e.length-1),117!==oit.charCodeAt(sit)&&Cot({},Oit,jit),++sit,t=Qit("u"),t&&"\\"!==t&&Zit(t.charCodeAt(0))||Cot({},Oit,jit),e+=t)}return e}function not(){var t,e;t=sit++;while(sit<ait){if(e=oit.charCodeAt(sit),92===e)return sit=t,eot();if(!Zit(e))break;++sit}return oit.slice(t,sit)}function rot(){var t,e,n;return t=sit,e=92===oit.charCodeAt(sit)?eot():not(),n=1===e.length?hit:Kit.hasOwnProperty(e)?fit:"null"===e?dit:"true"===e||"false"===e?cit:hit,{type:n,value:e,start:t,end:sit}}function iot(){var t,e,n,r,i=sit,o=oit.charCodeAt(sit),s=oit[sit];switch(o){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++sit,{type:git,value:String.fromCharCode(o),start:i,end:sit};default:if(t=oit.charCodeAt(sit+1),61===t)switch(o){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return sit+=2,{type:git,value:String.fromCharCode(o)+String.fromCharCode(t),start:i,end:sit};case 33:case 61:return sit+=2,61===oit.charCodeAt(sit)&&++sit,{type:git,value:oit.slice(i,sit),start:i,end:sit}}}return r=oit.substr(sit,4),">>>="===r?(sit+=4,{type:git,value:r,start:i,end:sit}):(n=r.substr(0,3),">>>"===n||"<<="===n||">>="===n?(sit+=3,{type:git,value:n,start:i,end:sit}):(e=n.substr(0,2),s===e[1]&&"+-<>&|".indexOf(s)>=0||"=>"===e?(sit+=2,{type:git,value:e,start:i,end:sit}):("//"===e&&Cot({},Oit,jit),"<>=!+-*%&|^/".indexOf(s)>=0?(++sit,{type:git,value:s,start:i,end:sit}):void Cot({},Oit,jit))))}function oot(t){let e="";while(sit<ait){if(!Wit(oit[sit]))break;e+=oit[sit++]}return 0===e.length&&Cot({},Oit,jit),Yit(oit.charCodeAt(sit))&&Cot({},Oit,jit),{type:pit,value:parseInt("0x"+e,16),start:t,end:sit}}function sot(t){let e="0"+oit[sit++];while(sit<ait){if(!Git(oit[sit]))break;e+=oit[sit++]}return(Yit(oit.charCodeAt(sit))||qit(oit.charCodeAt(sit)))&&Cot({},Oit,jit),{type:pit,value:parseInt(e,8),octal:!0,start:t,end:sit}}function aot(){var t,e,n;if(n=oit[sit],Vit(qit(n.charCodeAt(0))||"."===n,"Numeric literal must start with a decimal digit or a decimal point"),e=sit,t="","."!==n){if(t=oit[sit++],n=oit[sit],"0"===t){if("x"===n||"X"===n)return++sit,oot(e);if(Git(n))return sot(e);n&&qit(n.charCodeAt(0))&&Cot({},Oit,jit)}while(qit(oit.charCodeAt(sit)))t+=oit[sit++];n=oit[sit]}if("."===n){t+=oit[sit++];while(qit(oit.charCodeAt(sit)))t+=oit[sit++];n=oit[sit]}if("e"===n||"E"===n)if(t+=oit[sit++],n=oit[sit],"+"!==n&&"-"!==n||(t+=oit[sit++]),qit(oit.charCodeAt(sit)))while(qit(oit.charCodeAt(sit)))t+=oit[sit++];else Cot({},Oit,jit);return Yit(oit.charCodeAt(sit))&&Cot({},Oit,jit),{type:pit,value:parseFloat(t),start:e,end:sit}}function uot(){var t,e,n,r,i="",o=!1;t=oit[sit],Vit("'"===t||'"'===t,"String literal must starts with a quote"),e=sit,++sit;while(sit<ait){if(n=oit[sit++],n===t){t="";break}if("\\"===n)if(n=oit[sit++],n&&Xit(n.charCodeAt(0)))"\r"===n&&"\n"===oit[sit]&&++sit;else switch(n){case"u":case"x":"{"===oit[sit]?(++sit,i+=tot()):i+=Qit(n);break;case"n":i+="\n";break;case"r":i+="\r";break;case"t":i+="\t";break;case"b":i+="\b";break;case"f":i+="\f";break;case"v":i+="\v";break;default:Git(n)?(r="01234567".indexOf(n),0!==r&&(o=!0),sit<ait&&Git(oit[sit])&&(o=!0,r=8*r+"01234567".indexOf(oit[sit++]),"0123".indexOf(n)>=0&&sit<ait&&Git(oit[sit])&&(r=8*r+"01234567".indexOf(oit[sit++]))),i+=String.fromCharCode(r)):i+=n;break}else{if(Xit(n.charCodeAt(0)))break;i+=n}}return""!==t&&Cot({},Oit,jit),{type:mit,value:i,octal:o,start:e,end:sit}}function cot(t,e){let n=t;e.indexOf("u")>=0&&(n=n.replace(/\\u\{([0-9a-fA-F]+)\}/g,(t,e)=>{if(parseInt(e,16)<=1114111)return"x";Cot({},Dit)}).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x"));try{new RegExp(n)}catch(r){Cot({},Dit)}try{return new RegExp(t,e)}catch(i){return null}}function lot(){var t,e,n,r,i;t=oit[sit],Vit("/"===t,"Regular expression literal must start with a slash"),e=oit[sit++],n=!1,r=!1;while(sit<ait)if(t=oit[sit++],e+=t,"\\"===t)t=oit[sit++],Xit(t.charCodeAt(0))&&Cot({},Rit),e+=t;else if(Xit(t.charCodeAt(0)))Cot({},Rit);else if(n)"]"===t&&(n=!1);else{if("/"===t){r=!0;break}"["===t&&(n=!0)}return r||Cot({},Rit),i=e.substr(1,e.length-2),{value:i,literal:e}}function hot(){var t,e,n;e="",n="";while(sit<ait){if(t=oit[sit],!Zit(t.charCodeAt(0)))break;++sit,"\\"===t&&sit<ait?Cot({},Oit,jit):(n+=t,e+=t)}return n.search(/[^gimuy]/g)>=0&&Cot({},Dit,n),{value:n,literal:e}}function fot(){var t,e,n,r;return uit=null,Jit(),t=sit,e=lot(),n=hot(),r=cot(e.value,n.value),{literal:e.literal+n.literal,value:r,regex:{pattern:e.value,flags:n.value},start:t,end:sit}}function dot(t){return t.type===hit||t.type===fit||t.type===cit||t.type===dit}function pot(){if(Jit(),sit>=ait)return{type:lit,start:sit,end:sit};const t=oit.charCodeAt(sit);return Yit(t)?rot():40===t||41===t||59===t?iot():39===t||34===t?uot():46===t?qit(oit.charCodeAt(sit+1))?aot():iot():qit(t)?aot():iot()}function got(){const t=uit;return sit=t.end,uit=pot(),sit=t.end,t}function mot(){const t=sit;uit=pot(),sit=t}function yot(t){const e=new nit(vit);return e.elements=t,e}function vot(t,e,n){const r=new nit("||"===t||"&&"===t?Eit:bit);return r.operator=t,r.left=e,r.right=n,r}function bot(t,e){const n=new nit(_it);return n.callee=t,n.arguments=e,n}function _ot(t,e,n){const r=new nit(wit);return r.test=t,r.consequent=e,r.alternate=n,r}function wot(t){const e=new nit(xit);return e.name=t,e}function xot(t){const e=new nit(Sit);return e.value=t.value,e.raw=oit.slice(t.start,t.end),t.regex&&("//"===e.raw&&(e.raw="/(?:)/"),e.regex=t.regex),e}function Sot(t,e,n){const r=new nit(Ait);return r.computed="["===t,r.object=e,r.property=n,r.computed||(n.member=!0),r}function Eot(t){const e=new nit(Mit);return e.properties=t,e}function Aot(t,e,n){const r=new nit(Cit);return r.key=e,r.value=n,r.kind=t,r}function Mot(t,e){const n=new nit(kit);return n.operator=t,n.argument=e,n.prefix=!0,n}function Cot(t,e){var n,r=Array.prototype.slice.call(arguments,2),i=e.replace(/%(\d)/g,(t,e)=>{return Vit(e<r.length,"Message reference must be in range"),r[e]});throw n=new Error(i),n.index=sit,n.description=i,n}function kot(t){t.type===lit&&Cot(t,Nit),t.type===pit&&Cot(t,Pit),t.type===mit&&Cot(t,Tit),t.type===hit&&Cot(t,Lit),t.type===fit&&Cot(t,Iit),Cot(t,Oit,t.value)}function Oot(t){const e=got();e.type===git&&e.value===t||kot(e)}function Pot(t){return uit.type===git&&uit.value===t}function Tot(t){return uit.type===fit&&uit.value===t}function Lot(){const t=[];sit=uit.start,Oot("[");while(!Pot("]"))Pot(",")?(got(),t.push(null)):(t.push(Xot()),Pot("]")||Oot(","));return got(),yot(t)}function Iot(){sit=uit.start;const t=got();return t.type===mit||t.type===pit?(t.octal&&Cot(t,Fit),xot(t)):wot(t.value)}function Not(){var t,e,n,r;return sit=uit.start,t=uit,t.type===hit?(n=Iot(),Oot(":"),r=Xot(),Aot("init",n,r)):t.type!==lit&&t.type!==git?(e=Iot(),Oot(":"),r=Xot(),Aot("init",e,r)):void kot(t)}function Dot(){var t,e,n,r=[],i={},o=String;sit=uit.start,Oot("{");while(!Pot("}"))t=Not(),e=t.key.type===xit?t.key.name:o(t.key.value),n="$"+e,Object.prototype.hasOwnProperty.call(i,n)?Cot({},Bit):i[n]=!0,r.push(t),Pot("}")||Oot(",");return Oot("}"),Eot(r)}function Rot(){Oot("(");const t=Yot();return Oot(")"),t}const Fot={if:1};function Bot(){var t,e,n;if(Pot("("))return Rot();if(Pot("["))return Lot();if(Pot("{"))return Dot();if(t=uit.type,sit=uit.start,t===hit||Fot[uit.value])n=wot(got().value);else if(t===mit||t===pit)uit.octal&&Cot(uit,Fit),n=xot(got());else{if(t===fit)throw new Error(zit);t===cit?(e=got(),e.value="true"===e.value,n=xot(e)):t===dit?(e=got(),e.value=null,n=xot(e)):Pot("/")||Pot("/=")?(n=xot(fot()),mot()):kot(got())}return n}function jot(){const t=[];if(Oot("("),!Pot(")"))while(sit<ait){if(t.push(Xot()),Pot(")"))break;Oot(",")}return Oot(")"),t}function zot(){sit=uit.start;const t=got();return dot(t)||kot(t),wot(t.value)}function Uot(){return Oot("."),zot()}function $ot(){Oot("[");const t=Yot();return Oot("]"),t}function Vot(){var t,e,n;for(t=Bot();;)if(Pot("."))n=Uot(),t=Sot(".",t,n);else if(Pot("("))e=jot(),t=bot(t,e);else{if(!Pot("["))break;n=$ot(),t=Sot("[",t,n)}return t}function qot(){const t=Vot();if(uit.type===git&&(Pot("++")||Pot("--")))throw new Error(zit);return t}function Wot(){var t,e;if(uit.type!==git&&uit.type!==fit)e=qot();else{if(Pot("++")||Pot("--"))throw new Error(zit);if(Pot("+")||Pot("-")||Pot("~")||Pot("!"))t=got(),e=Wot(),e=Mot(t.value,e);else{if(Tot("delete")||Tot("void")||Tot("typeof"))throw new Error(zit);e=qot()}}return e}function Got(t){let e=0;if(t.type!==git&&t.type!==fit)return 0;switch(t.value){case"||":e=1;break;case"&&":e=2;break;case"|":e=3;break;case"^":e=4;break;case"&":e=5;break;case"==":case"!=":case"===":case"!==":e=6;break;case"<":case">":case"<=":case">=":case"instanceof":case"in":e=7;break;case"<<":case">>":case">>>":e=8;break;case"+":case"-":e=9;break;case"*":case"/":case"%":e=11;break}return e}function Hot(){var t,e,n,r,i,o,s,a,u,c;if(t=uit,u=Wot(),r=uit,i=Got(r),0===i)return u;r.prec=i,got(),e=[t,uit],s=Wot(),o=[u,r,s];while((i=Got(uit))>0){while(o.length>2&&i<=o[o.length-2].prec)s=o.pop(),a=o.pop().value,u=o.pop(),e.pop(),n=vot(a,u,s),o.push(n);r=got(),r.prec=i,o.push(r),e.push(uit),n=Wot(),o.push(n)}c=o.length-1,n=o[c],e.pop();while(c>1)e.pop(),n=vot(o[c-1].value,o[c-2],n),c-=2;return n}function Xot(){var t,e,n;return t=Hot(),Pot("?")&&(got(),e=Xot(),Oot(":"),n=Xot(),t=_ot(t,e,n)),t}function Yot(){const t=Xot();if(Pot(","))throw new Error(zit);return t}function Zot(t){oit=t,sit=0,ait=oit.length,uit=null,mot();const e=Yot();if(uit.type!==lit)throw new Error("Unexpect token after expression.");return e}var Kot={NaN:"NaN",E:"Math.E",LN2:"Math.LN2",LN10:"Math.LN10",LOG2E:"Math.LOG2E",LOG10E:"Math.LOG10E",PI:"Math.PI",SQRT1_2:"Math.SQRT1_2",SQRT2:"Math.SQRT2",MIN_VALUE:"Number.MIN_VALUE",MAX_VALUE:"Number.MAX_VALUE"};function Jot(t){function e(e,n,r,i){let o=t(n[0]);return r&&(o=r+"("+o+")",0===r.lastIndexOf("new ",0)&&(o="("+o+")")),o+"."+e+(i<0?"":0===i?"()":"("+n.slice(1).map(t).join(",")+")")}function n(t,n,r){return i=>e(t,i,n,r)}const r="new Date",i="String",o="RegExp";return{isNaN:"Number.isNaN",isFinite:"Number.isFinite",abs:"Math.abs",acos:"Math.acos",asin:"Math.asin",atan:"Math.atan",atan2:"Math.atan2",ceil:"Math.ceil",cos:"Math.cos",exp:"Math.exp",floor:"Math.floor",log:"Math.log",max:"Math.max",min:"Math.min",pow:"Math.pow",random:"Math.random",round:"Math.round",sin:"Math.sin",sqrt:"Math.sqrt",tan:"Math.tan",clamp:function(e){e.length<3&&Rrt("Missing arguments to clamp function."),e.length>3&&Rrt("Too many arguments to clamp function.");const n=e.map(t);return"Math.max("+n[1]+", Math.min("+n[2]+","+n[0]+"))"},now:"Date.now",utc:"Date.UTC",datetime:r,date:n("getDate",r,0),day:n("getDay",r,0),year:n("getFullYear",r,0),month:n("getMonth",r,0),hours:n("getHours",r,0),minutes:n("getMinutes",r,0),seconds:n("getSeconds",r,0),milliseconds:n("getMilliseconds",r,0),time:n("getTime",r,0),timezoneoffset:n("getTimezoneOffset",r,0),utcdate:n("getUTCDate",r,0),utcday:n("getUTCDay",r,0),utcyear:n("getUTCFullYear",r,0),utcmonth:n("getUTCMonth",r,0),utchours:n("getUTCHours",r,0),utcminutes:n("getUTCMinutes",r,0),utcseconds:n("getUTCSeconds",r,0),utcmilliseconds:n("getUTCMilliseconds",r,0),length:n("length",null,-1),parseFloat:"parseFloat",parseInt:"parseInt",upper:n("toUpperCase",i,0),lower:n("toLowerCase",i,0),substring:n("substring",i),split:n("split",i),trim:n("trim",i,0),regexp:o,test:n("test",o),if:function(e){e.length<3&&Rrt("Missing arguments to if function."),e.length>3&&Rrt("Too many arguments to if function.");const n=e.map(t);return"("+n[0]+"?"+n[1]+":"+n[2]+")"}}}function Qot(t){const e=t&&t.length-1;return e&&('"'===t[0]&&'"'===t[e]||"'"===t[0]&&"'"===t[e])?t.slice(1,-1):t}function tst(t){t=t||{};const e=t.allowed?Vrt(t.allowed):{},n=t.forbidden?Vrt(t.forbidden):{},r=t.constants||Kot,i=(t.functions||Jot)(h),o=t.globalvar,s=t.fieldvar,a=jrt(o)?o:t=>`${o}["${t}"]`;let u={},c={},l=0;function h(t){if($rt(t))return t;const e=f[t.type];return null==e&&Rrt("Unsupported type: "+t.type),e(t)}const f={Literal:t=>t.raw,Identifier:t=>{const i=t.name;return l>0?i:Urt(n,i)?Rrt("Illegal identifier: "+i):Urt(r,i)?r[i]:Urt(e,i)?i:(u[i]=1,a(i))},MemberExpression:t=>{const e=!t.computed,n=h(t.object);e&&(l+=1);const r=h(t.property);return n===s&&(c[Qot(r)]=1),e&&(l-=1),n+(e?"."+r:"["+r+"]")},CallExpression:t=>{"Identifier"!==t.callee.type&&Rrt("Illegal callee type: "+t.callee.type);const e=t.callee.name,n=t.arguments,r=Urt(i,e)&&i[e];return r||Rrt("Unrecognized function: "+e),jrt(r)?r(n):r+"("+n.map(h).join(",")+")"},ArrayExpression:t=>"["+t.elements.map(h).join(",")+"]",BinaryExpression:t=>"("+h(t.left)+" "+t.operator+" "+h(t.right)+")",UnaryExpression:t=>"("+t.operator+h(t.argument)+")",ConditionalExpression:t=>"("+h(t.test)+"?"+h(t.consequent)+":"+h(t.alternate)+")",LogicalExpression:t=>"("+h(t.left)+t.operator+h(t.right)+")",ObjectExpression:t=>"{"+t.properties.map(h).join(",")+"}",Property:t=>{l+=1;const e=h(t.key);return l-=1,e+":"+h(t.value)}};function d(t){const e={code:h(t),globals:Object.keys(u),fields:Object.keys(c)};return u={},c={},e}return d.functions=i,d.constants=r,d}class est{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){const e=this._partials;let n=0;for(let r=0;r<this._n&&r<32;r++){const i=e[r],o=t+i,s=Math.abs(t)<Math.abs(i)?t-(o-i):i-(o-t);s&&(e[n++]=s),t=o}return e[n]=t,this._n=n+1,this}valueOf(){const t=this._partials;let e,n,r,i=this._n,o=0;if(i>0){o=t[--i];while(i>0)if(e=o,n=t[--i],o=e+n,r=n-(o-e),r)break;i>0&&(r<0&&t[i-1]<0||r>0&&t[i-1]>0)&&(n=2*r,e=o+n,n==e-o&&(o=e))}return o}}var nst=1e-6,rst=1e-12,ist=Math.PI,ost=ist/2,sst=ist/4,ast=2*ist,ust=180/ist,cst=ist/180,lst=Math.abs,hst=(Math.atan,Math.atan2),fst=Math.cos,dst=(Math.ceil,Math.exp,Math.floor,Math.hypot),pst=(Math.log,Math.pow,Math.sin),gst=(Math.sign,Math.sqrt);Math.tan;function mst(t){return t>1?ost:t<-1?-ost:Math.asin(t)}function yst(){}function vst(t,e){t&&_st.hasOwnProperty(t.type)&&_st[t.type](t,e)}var bst={Feature:function(t,e){vst(t.geometry,e)},FeatureCollection:function(t,e){var n=t.features,r=-1,i=n.length;while(++r<i)vst(n[r].geometry,e)}},_st={Sphere:function(t,e){e.sphere()},Point:function(t,e){t=t.coordinates,e.point(t[0],t[1],t[2])},MultiPoint:function(t,e){var n=t.coordinates,r=-1,i=n.length;while(++r<i)t=n[r],e.point(t[0],t[1],t[2])},LineString:function(t,e){wst(t.coordinates,e,0)},MultiLineString:function(t,e){var n=t.coordinates,r=-1,i=n.length;while(++r<i)wst(n[r],e,0)},Polygon:function(t,e){xst(t.coordinates,e)},MultiPolygon:function(t,e){var n=t.coordinates,r=-1,i=n.length;while(++r<i)xst(n[r],e)},GeometryCollection:function(t,e){var n=t.geometries,r=-1,i=n.length;while(++r<i)vst(n[r],e)}};function wst(t,e,n){var r,i=-1,o=t.length-n;e.lineStart();while(++i<o)r=t[i],e.point(r[0],r[1],r[2]);e.lineEnd()}function xst(t,e){var n=-1,r=t.length;e.polygonStart();while(++n<r)wst(t[n],e,1);e.polygonEnd()}var Sst,Est,Ast,Mst,Cst,kst=function(t,e){t&&bst.hasOwnProperty(t.type)?bst[t.type](t,e):vst(t,e)},Ost=new est,Pst=new est,Tst={point:yst,lineStart:yst,lineEnd:yst,polygonStart:function(){Ost=new est,Tst.lineStart=Lst,Tst.lineEnd=Ist},polygonEnd:function(){var t=+Ost;Pst.add(t<0?ast+t:t),this.lineStart=this.lineEnd=this.point=yst},sphere:function(){Pst.add(ast)}};function Lst(){Tst.point=Nst}function Ist(){Dst(Sst,Est)}function Nst(t,e){Tst.point=Dst,Sst=t,Est=e,t*=cst,e*=cst,Ast=t,Mst=fst(e=e/2+sst),Cst=pst(e)}function Dst(t,e){t*=cst,e*=cst,e=e/2+sst;var n=t-Ast,r=n>=0?1:-1,i=r*n,o=fst(e),s=pst(e),a=Cst*s,u=Mst*o+a*fst(i),c=a*r*pst(i);Ost.add(hst(c,u)),Ast=t,Mst=o,Cst=s}var Rst,Fst,Bst,jst,zst,Ust,$st,Vst,qst,Wst,Gst,Hst=function(t){return Pst=new est,kst(t,Tst),2*Pst};function Xst(t){return[hst(t[1],t[0]),mst(t[2])]}function Yst(t){var e=t[0],n=t[1],r=fst(n);return[r*fst(e),r*pst(e),pst(n)]}function Zst(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function Kst(t){var e=gst(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e,t[1]/=e,t[2]/=e}var Jst={point:Qst,lineStart:eat,lineEnd:nat,polygonStart:function(){Jst.point=rat,Jst.lineStart=iat,Jst.lineEnd=oat,qst=new est,Tst.polygonStart()},polygonEnd:function(){Tst.polygonEnd(),Jst.point=Qst,Jst.lineStart=eat,Jst.lineEnd=nat,Ost<0?(Rst=-(Bst=180),Fst=-(jst=90)):qst>nst?jst=90:qst<-nst&&(Fst=-90),Gst[0]=Rst,Gst[1]=Bst},sphere:function(){Rst=-(Bst=180),Fst=-(jst=90)}};function Qst(t,e){Wst.push(Gst=[Rst=t,Bst=t]),e<Fst&&(Fst=e),e>jst&&(jst=e)}function tat(t,e){var n=Yst([t*cst,e*cst]);if(Vst){var r=Zst(Vst,n),i=[r[1],-r[0],0],o=Zst(i,r);Kst(o),o=Xst(o);var s,a=t-zst,u=a>0?1:-1,c=o[0]*ust*u,l=lst(a)>180;l^(u*zst<c&&c<u*t)?(s=o[1]*ust,s>jst&&(jst=s)):(c=(c+360)%360-180,l^(u*zst<c&&c<u*t)?(s=-o[1]*ust,s<Fst&&(Fst=s)):(e<Fst&&(Fst=e),e>jst&&(jst=e))),l?t<zst?sat(Rst,t)>sat(Rst,Bst)&&(Bst=t):sat(t,Bst)>sat(Rst,Bst)&&(Rst=t):Bst>=Rst?(t<Rst&&(Rst=t),t>Bst&&(Bst=t)):t>zst?sat(Rst,t)>sat(Rst,Bst)&&(Bst=t):sat(t,Bst)>sat(Rst,Bst)&&(Rst=t)}else Wst.push(Gst=[Rst=t,Bst=t]);e<Fst&&(Fst=e),e>jst&&(jst=e),Vst=n,zst=t}function eat(){Jst.point=tat}function nat(){Gst[0]=Rst,Gst[1]=Bst,Jst.point=Qst,Vst=null}function rat(t,e){if(Vst){var n=t-zst;qst.add(lst(n)>180?n+(n>0?360:-360):n)}else Ust=t,$st=e;Tst.point(t,e),tat(t,e)}function iat(){Tst.lineStart()}function oat(){rat(Ust,$st),Tst.lineEnd(),lst(qst)>nst&&(Rst=-(Bst=180)),Gst[0]=Rst,Gst[1]=Bst,Vst=null}function sat(t,e){return(e-=t)<0?e+360:e}function aat(t,e){return t[0]-e[0]}function uat(t,e){return t[0]<=t[1]?t[0]<=e&&e<=t[1]:e<t[0]||t[1]<e}var cat,lat,hat,fat,dat,pat,gat,mat,yat,vat,bat,_at,wat,xat,Sat,Eat,Aat=function(t){var e,n,r,i,o,s,a;if(jst=Bst=-(Rst=Fst=1/0),Wst=[],kst(t,Jst),n=Wst.length){for(Wst.sort(aat),e=1,r=Wst[0],o=[r];e<n;++e)i=Wst[e],uat(r,i[0])||uat(r,i[1])?(sat(r[0],i[1])>sat(r[0],r[1])&&(r[1]=i[1]),sat(i[0],r[1])>sat(r[0],r[1])&&(r[0]=i[0])):o.push(r=i);for(s=-1/0,n=o.length-1,e=0,r=o[n];e<=n;r=i,++e)i=o[e],(a=sat(r[1],i[0]))>s&&(s=a,Rst=i[0],Bst=r[1])}return Wst=Gst=null,Rst===1/0||Fst===1/0?[[NaN,NaN],[NaN,NaN]]:[[Rst,Fst],[Bst,jst]]},Mat={sphere:yst,point:Cat,lineStart:Oat,lineEnd:Lat,polygonStart:function(){Mat.lineStart=Iat,Mat.lineEnd=Nat},polygonEnd:function(){Mat.lineStart=Oat,Mat.lineEnd=Lat}};function Cat(t,e){t*=cst,e*=cst;var n=fst(e);kat(n*fst(t),n*pst(t),pst(e))}function kat(t,e,n){++cat,hat+=(t-hat)/cat,fat+=(e-fat)/cat,dat+=(n-dat)/cat}function Oat(){Mat.point=Pat}function Pat(t,e){t*=cst,e*=cst;var n=fst(e);xat=n*fst(t),Sat=n*pst(t),Eat=pst(e),Mat.point=Tat,kat(xat,Sat,Eat)}function Tat(t,e){t*=cst,e*=cst;var n=fst(e),r=n*fst(t),i=n*pst(t),o=pst(e),s=hst(gst((s=Sat*o-Eat*i)*s+(s=Eat*r-xat*o)*s+(s=xat*i-Sat*r)*s),xat*r+Sat*i+Eat*o);lat+=s,pat+=s*(xat+(xat=r)),gat+=s*(Sat+(Sat=i)),mat+=s*(Eat+(Eat=o)),kat(xat,Sat,Eat)}function Lat(){Mat.point=Cat}function Iat(){Mat.point=Dat}function Nat(){Rat(_at,wat),Mat.point=Cat}function Dat(t,e){_at=t,wat=e,t*=cst,e*=cst,Mat.point=Rat;var n=fst(e);xat=n*fst(t),Sat=n*pst(t),Eat=pst(e),kat(xat,Sat,Eat)}function Rat(t,e){t*=cst,e*=cst;var n=fst(e),r=n*fst(t),i=n*pst(t),o=pst(e),s=Sat*o-Eat*i,a=Eat*r-xat*o,u=xat*i-Sat*r,c=dst(s,a,u),l=mst(c),h=c&&-l/c;yat.add(h*s),vat.add(h*a),bat.add(h*u),lat+=l,pat+=l*(xat+(xat=r)),gat+=l*(Sat+(Sat=i)),mat+=l*(Eat+(Eat=o)),kat(xat,Sat,Eat)}var Fat=function(t){cat=lat=hat=fat=dat=pat=gat=mat=0,yat=new est,vat=new est,bat=new est,kst(t,Mat);var e=+yat,n=+vat,r=+bat,i=dst(e,n,r);return i<rst&&(e=pat,n=gat,r=mat,lat<nst&&(e=hat,n=fat,r=dat),i=dst(e,n,r),i<rst)?[NaN,NaN]:[hst(n,e)*ust,mst(r/i)*ust]},Bat=function(t,e,n){t.prototype=e.prototype=n,n.constructor=t};function jat(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function zat(){}var Uat=.7,$at=1/Uat,Vat="\\s*([+-]?\\d+)\\s*",qat="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",Wat="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Gat=/^#([0-9a-f]{3,8})$/,Hat=new RegExp("^rgb\\("+[Vat,Vat,Vat]+"\\)$"),Xat=new RegExp("^rgb\\("+[Wat,Wat,Wat]+"\\)$"),Yat=new RegExp("^rgba\\("+[Vat,Vat,Vat,qat]+"\\)$"),Zat=new RegExp("^rgba\\("+[Wat,Wat,Wat,qat]+"\\)$"),Kat=new RegExp("^hsl\\("+[qat,Wat,Wat]+"\\)$"),Jat=new RegExp("^hsla\\("+[qat,Wat,Wat,qat]+"\\)$"),Qat={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function tut(){return this.rgb().formatHex()}function eut(){return dut(this).formatHsl()}function nut(){return this.rgb().formatRgb()}function rut(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=Gat.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?iut(e):3===n?new uut(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?out(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?out(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=Hat.exec(t))?new uut(e[1],e[2],e[3],1):(e=Xat.exec(t))?new uut(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=Yat.exec(t))?out(e[1],e[2],e[3],e[4]):(e=Zat.exec(t))?out(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=Kat.exec(t))?fut(e[1],e[2]/100,e[3]/100,1):(e=Jat.exec(t))?fut(e[1],e[2]/100,e[3]/100,e[4]):Qat.hasOwnProperty(t)?iut(Qat[t]):"transparent"===t?new uut(NaN,NaN,NaN,0):null}function iut(t){return new uut(t>>16&255,t>>8&255,255&t,1)}function out(t,e,n,r){return r<=0&&(t=e=n=NaN),new uut(t,e,n,r)}function sut(t){return t instanceof zat||(t=rut(t)),t?(t=t.rgb(),new uut(t.r,t.g,t.b,t.opacity)):new uut}function aut(t,e,n,r){return 1===arguments.length?sut(t):new uut(t,e,n,null==r?1:r)}function uut(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}function cut(){return"#"+hut(this.r)+hut(this.g)+hut(this.b)}function lut(){var t=this.opacity;return t=isNaN(t)?1:Math.max(0,Math.min(1,t)),(1===t?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===t?")":", "+t+")")}function hut(t){return t=Math.max(0,Math.min(255,Math.round(t)||0)),(t<16?"0":"")+t.toString(16)}function fut(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new gut(t,e,n,r)}function dut(t){if(t instanceof gut)return new gut(t.h,t.s,t.l,t.opacity);if(t instanceof zat||(t=rut(t)),!t)return new gut;if(t instanceof gut)return t;t=t.rgb();var e=t.r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),o=Math.max(e,n,r),s=NaN,a=o-i,u=(o+i)/2;return a?(s=e===o?(n-r)/a+6*(n<r):n===o?(r-e)/a+2:(e-n)/a+4,a/=u<.5?o+i:2-o-i,s*=60):a=u>0&&u<1?0:s,new gut(s,a,u,t.opacity)}function put(t,e,n,r){return 1===arguments.length?dut(t):new gut(t,e,n,null==r?1:r)}function gut(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function mut(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}Bat(zat,rut,{copy:function(t){return Object.assign(new this.constructor,this,t)},displayable:function(){return this.rgb().displayable()},hex:tut,formatHex:tut,formatHsl:eut,formatRgb:nut,toString:nut}),Bat(uut,aut,jat(zat,{brighter:function(t){return t=null==t?$at:Math.pow($at,t),new uut(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=null==t?Uat:Math.pow(Uat,t),new uut(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:cut,formatHex:cut,formatRgb:lut,toString:lut})),Bat(gut,put,jat(zat,{brighter:function(t){return t=null==t?$at:Math.pow($at,t),new gut(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?Uat:Math.pow(Uat,t),new gut(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new uut(mut(t>=240?t-240:t+120,i,r),mut(t,i,r),mut(t<120?t+240:t-120,i,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var t=this.opacity;return t=isNaN(t)?1:Math.max(0,Math.min(1,t)),(1===t?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===t?")":", "+t+")")}}));const yut=Math.PI/180,vut=180/Math.PI,but=18,_ut=.96422,wut=1,xut=.82521,Sut=4/29,Eut=6/29,Aut=3*Eut*Eut,Mut=Eut*Eut*Eut;function Cut(t){if(t instanceof Out)return new Out(t.l,t.a,t.b,t.opacity);if(t instanceof Rut)return Fut(t);t instanceof uut||(t=sut(t));var e,n,r=Iut(t.r),i=Iut(t.g),o=Iut(t.b),s=Put((.2225045*r+.7168786*i+.0606169*o)/wut);return r===i&&i===o?e=n=s:(e=Put((.4360747*r+.3850649*i+.1430804*o)/_ut),n=Put((.0139322*r+.0971045*i+.7141733*o)/xut)),new Out(116*s-16,500*(e-s),200*(s-n),t.opacity)}function kut(t,e,n,r){return 1===arguments.length?Cut(t):new Out(t,e,n,null==r?1:r)}function Out(t,e,n,r){this.l=+t,this.a=+e,this.b=+n,this.opacity=+r}function Put(t){return t>Mut?Math.pow(t,1/3):t/Aut+Sut}function Tut(t){return t>Eut?t*t*t:Aut*(t-Sut)}function Lut(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function Iut(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function Nut(t){if(t instanceof Rut)return new Rut(t.h,t.c,t.l,t.opacity);if(t instanceof Out||(t=Cut(t)),0===t.a&&0===t.b)return new Rut(NaN,0<t.l&&t.l<100?0:NaN,t.l,t.opacity);var e=Math.atan2(t.b,t.a)*vut;return new Rut(e<0?e+360:e,Math.sqrt(t.a*t.a+t.b*t.b),t.l,t.opacity)}function Dut(t,e,n,r){return 1===arguments.length?Nut(t):new Rut(t,e,n,null==r?1:r)}function Rut(t,e,n,r){this.h=+t,this.c=+e,this.l=+n,this.opacity=+r}function Fut(t){if(isNaN(t.h))return new Out(t.l,0,0,t.opacity);var e=t.h*yut;return new Out(t.l,Math.cos(e)*t.c,Math.sin(e)*t.c,t.opacity)}function But(t,e,n){return t.fields=e||[],t.fname=n,t}function jut(t){return 1===t.length?zut(t[0]):Uut(t)}Bat(Out,kut,jat(zat,{brighter:function(t){return new Out(this.l+but*(null==t?1:t),this.a,this.b,this.opacity)},darker:function(t){return new Out(this.l-but*(null==t?1:t),this.a,this.b,this.opacity)},rgb:function(){var t=(this.l+16)/116,e=isNaN(this.a)?t:t+this.a/500,n=isNaN(this.b)?t:t-this.b/200;return e=_ut*Tut(e),t=wut*Tut(t),n=xut*Tut(n),new uut(Lut(3.1338561*e-1.6168667*t-.4906146*n),Lut(-.9787684*e+1.9161415*t+.033454*n),Lut(.0719453*e-.2289914*t+1.4052427*n),this.opacity)}})),Bat(Rut,Dut,jat(zat,{brighter:function(t){return new Rut(this.h,this.c,this.l+but*(null==t?1:t),this.opacity)},darker:function(t){return new Rut(this.h,this.c,this.l-but*(null==t?1:t),this.opacity)},rgb:function(){return Fut(this).rgb()}}));const zut=t=>(function(e){return e[t]}),Uut=t=>{const e=t.length;return function(n){for(let r=0;r<e;++r)n=n[t[r]];return n}};function $ut(t){throw Error(t)}function Vut(t){const e=[],n=t.length;let r,i,o,s=null,a=0,u="";function c(){e.push(u+t.substring(r,i)),u="",r=i+1}for(t+="",r=i=0;i<n;++i)if(o=t[i],"\\"===o)u+=t.substring(r,i),u+=t.substring(++i,++i),r=i;else if(o===s)c(),s=null,a=-1;else{if(s)continue;r===a&&'"'===o?(r=i+1,s=o):r===a&&"'"===o?(r=i+1,s=o):"."!==o||a?"["===o?(i>r&&c(),a=r=i+1):"]"===o&&(a||$ut("Access path missing open bracket: "+t),a>0&&c(),a=0,r=i+1):i>r?c():r=i+1}return a&&$ut("Access path missing closing bracket: "+t),s&&$ut("Access path missing closing quote: "+t),i>r&&(i++,c()),e}function qut(t,e,n){const r=Vut(t);return t=1===r.length?r[0]:t,But((n&&n.get||jut)(r),[t],e||t)}qut("id"),But(t=>t,[],"identity"),But(()=>0,[],"zero"),But(()=>1,[],"one"),But(()=>!0,[],"true"),But(()=>!1,[],"false");var Wut=Array.isArray;function Gut(t){return t[t.length-1]}function Hut(t){return null==t||""===t?null:+t}function Xut(t){return null!=t?Wut(t)?t:[t]:[]}function Yut(t){for(let e,n,r=1,i=arguments.length;r<i;++r)for(n in e=arguments[r],e)t[n]=e[n];return t}const Zut=Object.prototype.hasOwnProperty;function Kut(t,e){return Zut.call(t,e)}function Jut(t,e,n,r){let i,o=e[0],s=e[e.length-1];return o>s&&(i=o,o=s,s=i),n=void 0===n||n,r=void 0===r||r,(n?o<=t:o<t)&&(r?t<=s:t<s)}function Qut(t){return"[object Date]"===Object.prototype.toString.call(t)}function tct(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function ect(t){let e=t,n=t;function r(t,e,r,i){null==r&&(r=0),null==i&&(i=t.length);while(r<i){const o=r+i>>>1;n(t[o],e)<0?r=o+1:i=o}return r}function i(t,e,r,i){null==r&&(r=0),null==i&&(i=t.length);while(r<i){const o=r+i>>>1;n(t[o],e)>0?i=o:r=o+1}return r}function o(t,n,i,o){null==i&&(i=0),null==o&&(o=t.length);const s=r(t,n,i,o-1);return s>i&&e(t[s-1],n)>-e(t[s],n)?s-1:s}return 1===t.length&&(e=(e,n)=>t(e)-n,n=nct(t)),{left:r,center:o,right:i}}function nct(t){return(e,n)=>tct(t(e),n)}const rct="intersect",ict="union",oct="vlMulti",sct="vlPoint",act="or",uct="and",cct="_vgsid_",lct="E",hct="R",fct="R-E",dct="R-LE",pct="R-RE",gct="index:unit";function mct(t,e){for(var n,r,i=e.fields,o=e.values,s=i.length,a=0;a<s;++a)if(r=i[a],r.getter=qut.getter||qut(r.field),n=r.getter(t),Qut(n)&&(n=Hut(n)),Qut(o[a])&&(o[a]=Hut(o[a])),Qut(o[a][0])&&(o[a]=o[a].map(Hut)),r.type===lct){if(Wut(o[a])?o[a].indexOf(n)<0:n!==o[a])return!1}else if(r.type===hct){if(!Jut(n,o[a]))return!1}else if(r.type===pct){if(!Jut(n,o[a],!0,!1))return!1}else if(r.type===fct){if(!Jut(n,o[a],!1,!1))return!1}else if(r.type===dct&&!Jut(n,o[a],!1,!0))return!1;return!0}function yct(t,e,n){for(var r,i,o,s,a,u=this.context.data[t],c=u?u.values.value:[],l=u?u[gct]&&u[gct].value:void 0,h=n===rct,f=c.length,d=0;d<f;++d)if(r=c[d],l&&h){if(i=i||{},o=i[s=r.unit]||0,-1===o)continue;if(a=mct(e,r),i[s]=a?-1:++o,a&&1===l.size)return!0;if(!a&&o===l.get(s).count)return!1}else if(a=mct(e,r),h^a)return a;return f&&h}const vct=qut(cct),bct=ect(vct),_ct=bct.left,wct=bct.right;function xct(t,e,n){const r=this.context.data[t],i=r?r.values.value:[],o=r?r[gct]&&r[gct].value:void 0,s=n===rct,a=vct(e),u=_ct(i,a);if(u===i.length)return!1;if(vct(i[u])!==a)return!1;if(o&&s){if(1===o.size)return!0;if(wct(i,a)-u<o.size)return!1}return!0}function Sct(t,e){return t.map(t=>Yut({values:e.fields.map(e=>(e.getter||(e.getter=qut(e.field)))(t.datum))},e))}function Ect(t,e,n,r){for(var i,o,s,a,u,c,l,h,f,d,p,g=this.context.data[t],m=g?g.values.value:[],y={},v={},b={},_=m.length,w=0;w<_;++w){for(i=m[w],a=i.unit,o=i.fields,s=i.values,d=0,p=o.length;d<p;++d)u=o[d],c=y[u.field]||(y[u.field]={}),l=c[a]||(c[a]=[]),b[u.field]=h=u.type.charAt(0),f=Act[h+"_union"],c[a]=f(l,Xut(s[d]));n&&(l=v[a]||(v[a]=[]),l.push(Xut(s).reduce((t,e,n)=>(t[o[n].field]=e,t),{})))}if(e=e||ict,Object.keys(y).forEach(t=>{y[t]=Object.keys(y[t]).map(e=>y[t][e]).reduce((n,r)=>void 0===n?r:Act[b[t]+"_"+e](n,r))}),m=Object.keys(v),n&&m.length){const t=r?sct:oct;y[t]=e===ict?{[act]:m.reduce((t,e)=>(t.push(...v[e]),t),[])}:{[uct]:m.map(t=>({[act]:v[t]}))}}return y}var Act={E_union:function(t,e){if(!t.length)return e;for(var n=0,r=e.length;n<r;++n)t.indexOf(e[n])<0&&t.push(e[n]);return t},E_intersect:function(t,e){return t.length?t.filter(t=>e.indexOf(t)>=0):e},R_union:function(t,e){var n=Hut(e[0]),r=Hut(e[1]);return n>r&&(n=e[1],r=e[0]),t.length?(t[0]>n&&(t[0]=n),t[1]<r&&(t[1]=r),t):[n,r]},R_intersect:function(t,e){var n=Hut(e[0]),r=Hut(e[1]);return n>r&&(n=e[1],r=e[0]),t.length?r<t[0]||t[1]<n?[]:(t[0]<n&&(t[0]=n),t[1]>r&&(t[1]=r),t):[n,r]}};const Mct=":",Cct="@";function kct(t,e,n,r){e[0].type!==Wrt&&$ut("First argument to selection functions must be a string literal.");const i=e[0].value,o=e.length>=2&&Gut(e).value,s="unit",a=Cct+s,u=Mct+i;o!==rct||Kut(r,a)||(r[a]=n.getData(i).indataRef(n,s)),Kut(r,u)||(r[u]=n.getData(i).tuplesRef())}var Oct=function(t,e,n){t=+t,e=+e,n=(i=arguments.length)<2?(e=t,t=0,1):i<3?1:+n;var r=-1,i=0|Math.max(0,Math.ceil((e-t)/n)),o=new Array(i);while(++r<i)o[r]=t+r*n;return o};function Pct(t){const e=this.context.data[t];return e?e.values.value:[]}function Tct(t,e,n){const r=this.context.data[t]["index:"+e],i=r?r.value.get(n):void 0;return i?i.count:i}function Lct(t,e){const n=this.context.dataflow,r=this.context.data[t],i=r.input;return n.pulse(i,n.changeset().remove(znt).insert(e)),1}function Ict(t,e,n){if(t){const n=this.context.dataflow,r=t.mark.source;n.pulse(r,n.changeset().encode(t,e))}return void 0!==n?n:t}const Nct=t=>(function(e,n){const r=this.context.dataflow.locale();return r[t](n)(e)}),Dct=Nct("format"),Rct=Nct("timeFormat"),Fct=Nct("utcFormat"),Bct=Nct("timeParse"),jct=Nct("utcParse"),zct=new Date(2e3,0,1);function Uct(t,e,n){return Number.isInteger(t)&&Number.isInteger(e)?(zct.setYear(2e3),zct.setMonth(t),zct.setDate(e),Rct.call(this,zct,n)):""}function $ct(t){return Uct.call(this,t,1,"%B")}function Vct(t){return Uct.call(this,t,1,"%b")}function qct(t){return Uct.call(this,0,2+t,"%A")}function Wct(t){return Uct.call(this,0,2+t,"%a")}const Gct=":",Hct="@",Xct="%",Yct="$";function Zct(t,e,n,r){e[0].type!==Wrt&&Rnt("First argument to data functions must be a string literal.");const i=e[0].value,o=Gct+i;if(!prt(o,r))try{r[o]=n.getData(i).tuplesRef()}catch(s){}}function Kct(t,e,n,r){e[0].type!==Wrt&&Rnt("First argument to indata must be a string literal."),e[1].type!==Wrt&&Rnt("Second argument to indata must be a string literal.");const i=e[0].value,o=e[1].value,s=Hct+o;prt(s,r)||(r[s]=n.getData(i).indataRef(n,o))}function Jct(t,e,n,r){if(e[0].type===Wrt)Qct(n,r,e[0].value);else for(t in n.scales)Qct(n,r,t)}function Qct(t,e,n){const r=Xct+n;if(!prt(e,r))try{e[r]=t.scaleRef(n)}catch(i){}}function tlt(t,e){let n;return lrt(t)?t:wrt(t)?(n=e.scales[t])&&n.value:void 0}function elt(t,e,n){e.__bandwidth=t=>t&&t.bandwidth?t.bandwidth():0,n._bandwidth=Jct,n._range=Jct,n._scale=Jct;const r=e=>"_["+(e.type===Wrt?Mrt(Xct+e.value):Mrt(Xct)+"+"+t(e))+"]";return{_bandwidth:t=>`this.__bandwidth(${r(t[0])})`,_range:t=>`${r(t[0])}.range()`,_scale:e=>`${r(e[0])}(${t(e[1])})`}}function nlt(t,e){return function(n,r,i){if(n){const e=tlt(n,(i||this).context);return e&&e.path[t](r)}return e(r)}}const rlt=nlt("area",Hst),ilt=nlt("bounds",Aat),olt=nlt("centroid",Fat);function slt(t){const e=this.context.group;let n=!1;if(e)while(t){if(t===e){n=!0;break}t=t.mark.group}return n}function alt(t,e,n){try{t[e].apply(t,["EXPRESSION"].concat([].slice.call(n)))}catch(r){t.warn(r)}return n[n.length-1]}function ult(){return alt(this.context.dataflow,"warn",arguments)}function clt(){return alt(this.context.dataflow,"info",arguments)}function llt(){return alt(this.context.dataflow,"debug",arguments)}function hlt(t){const e=t/255;return e<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4)}function flt(t){const e=aut(t),n=hlt(e.r),r=hlt(e.g),i=hlt(e.b);return.2126*n+.7152*r+.0722*i}function dlt(t,e){const n=flt(t),r=flt(e),i=Math.max(n,r),o=Math.min(n,r);return(i+.05)/(o+.05)}function plt(){const t=[].slice.call(arguments);return t.unshift({}),hrt(...t)}function glt(t,e){return t===e||t!==t&&e!==e||(Unt(t)?!(!Unt(e)||t.length!==e.length)&&mlt(t,e):!(!$nt(t)||!$nt(e))&&ylt(t,e))}function mlt(t,e){for(let n=0,r=t.length;n<r;++n)if(!glt(t[n],e[n]))return!1;return!0}function ylt(t,e){for(const n in t)if(!glt(t[n],e[n]))return!1;return!0}function vlt(t){return e=>ylt(t,e)}function blt(t,e,n,r,i,o){const s=this.context.dataflow,a=this.context.data[t],u=a.input,c=s.stamp();let l,h,f=a.changes;if(!1===s._trigger||!(u.value.length||e||r))return 0;if((!f||f.stamp<c)&&(a.changes=f=s.changeset(),f.stamp=c,s.runAfter(()=>{a.modified=!0,s.pulse(u,f).run()},!0,1)),n&&(l=!0===n?znt:Unt(n)||Rk(n)?n:vlt(n),f.remove(l)),e&&f.insert(e),r&&(l=vlt(r),u.value.some(l)?f.remove(l):f.insert(r)),i)for(h in o)f.modify(i,h,o[h]);return 1}function _lt(t){const e=t.touches,n=e[0].clientX-e[1].clientX,r=e[0].clientY-e[1].clientY;return Math.sqrt(n*n+r*r)}function wlt(t){const e=t.touches;return Math.atan2(e[0].clientY-e[1].clientY,e[0].clientX-e[1].clientX)}const xlt={};function Slt(t,e){const n=xlt[e]||(xlt[e]=Bnt(e));return Unt(t)?t.map(n):n(t)}function Elt(t){return Unt(t)||ArrayBuffer.isView(t)?t:null}function Alt(t){return Elt(t)||(wrt(t)?t:null)}function Mlt(t,...e){return Elt(t).join(...e)}function Clt(t,...e){return Alt(t).indexOf(...e)}function klt(t,...e){return Alt(t).lastIndexOf(...e)}function Olt(t,...e){return Alt(t).slice(...e)}function Plt(t,e,n){return lrt(n)&&Rnt("Function argument passed to replace."),String(t).replace(e,n)}function Tlt(t){return Elt(t).slice().reverse()}function Llt(t,e,n){return cz(t||0,e||0,n||0)}function Ilt(t,e){const n=tlt(t,(e||this).context);return n&&n.bandwidth?n.bandwidth():0}function Nlt(t,e){const n=tlt(t,(e||this).context);return n?n.copy():void 0}function Dlt(t,e){const n=tlt(t,(e||this).context);return n?n.domain():[]}function Rlt(t,e,n){const r=tlt(t,(n||this).context);return r?Unt(e)?(r.invertRange||r.invert)(e):(r.invert||r.invertExtent)(e):void 0}function Flt(t,e){const n=tlt(t,(e||this).context);return n&&n.range?n.range():[]}function Blt(t,e,n){const r=tlt(t,(n||this).context);return r?r(e):void 0}function jlt(t,e,n,r,i){t=tlt(t,(i||this).context);const o=WU(e,n);let s=t.domain(),a=s[0],u=Vnt(s),c=jnt;return u-a?c=rU(t,a,u):t=(t.interpolator?Vz("sequential")().interpolator(t.interpolator()):Vz("linear")().interpolate(t.interpolate()).range(t.range())).domain([a=0,u=1]),t.ticks&&(s=t.ticks(+r||15),a!==s[0]&&s.unshift(a),u!==Vnt(s)&&s.push(u)),s.forEach(e=>o.stop(c(e),t(e))),o}function zlt(t,e,n){const r=tlt(t,(n||this).context);return function(t){return r?r.path.context(t)(e):""}}function Ult(t){let e=null;return function(n){return n?c$(n,e=e||ZU(t)):t}}const $lt=t=>t.data;function Vlt(t,e){const n=Pct.call(e,t);return n.root&&n.root.lookup||{}}function qlt(t,e,n){const r=Vlt(t,this),i=r[e],o=r[n];return i&&o?i.path(o).map($lt):void 0}function Wlt(t,e){const n=Vlt(t,this)[e];return n?n.ancestors().map($lt):void 0}const Glt=()=>"undefined"!==typeof window&&window||null;function Hlt(){const t=Glt();return t?t.screen:{}}function Xlt(){const t=Glt();return t?[t.innerWidth,t.innerHeight]:[void 0,void 0]}function Ylt(){const t=this.context.dataflow,e=t.container&&t.container();return e?[e.clientWidth,e.clientHeight]:[void 0,void 0]}function Zlt(t,e,n){if(!t)return[];const[r,i]=t,o=(new lV).set(r[0],r[1],i[0],i[1]),s=n||this.context.dataflow.scenegraph().root;return HH(s,o,Klt(e))}function Klt(t){let e=null;if(t){const n=urt(t.marktype),r=urt(t.markname);e=t=>(!n.length||n.some(e=>t.marktype===e))&&(!r.length||r.some(e=>t.name===e))}return e}const Jlt={random(){return tT()},cumulativeNormal:fT,cumulativeLogNormal:bT,cumulativeUniform:AT,densityNormal:hT,densityLogNormal:vT,densityUniform:ET,quantileNormal:dT,quantileLogNormal:_T,quantileUniform:MT,sampleNormal:lT,sampleLogNormal:yT,sampleUniform:ST,isArray:Unt,isBoolean:yrt,isDate:vrt,isDefined(t){return void 0!==t},isNumber:brt,isObject:$nt,isRegExp:_rt,isString:wrt,isTuple:Rk,isValid(t){return null!=t&&t===t},toBoolean:Crt,toDate:Ort,toNumber:qnt,toString:Prt,indexof:Clt,join:Mlt,lastindexof:klt,replace:Plt,reverse:Tlt,slice:Olt,flush:grt,lerp:xrt,merge:plt,pad:Ert,peek:Vnt,pluck:Slt,span:Art,inrange:mrt,truncate:Trt,rgb:aut,lab:kut,hcl:Dut,hsl:put,luminance:flt,contrast:dlt,sequence:Oct,format:Dct,utcFormat:Fct,utcParse:jct,utcOffset:uL["w"],utcSequence:uL["x"],timeFormat:Rct,timeParse:Bct,timeOffset:uL["q"],timeSequence:uL["r"],timeUnitSpecifier:uL["s"],monthFormat:$ct,monthAbbrevFormat:Vct,dayFormat:qct,dayAbbrevFormat:Wct,quarter:srt,utcquarter:art,week:uL["A"],utcweek:uL["z"],dayofyear:uL["m"],utcdayofyear:uL["y"],warn:ult,info:clt,debug:llt,extent:frt,inScope:slt,intersect:Zlt,clampRange:crt,pinchDistance:_lt,pinchAngle:wlt,screen:Hlt,containerSize:Ylt,windowSize:Xlt,bandspace:Llt,setdata:Lct,pathShape:Ult,panLinear:Knt,panLog:Jnt,panPow:Qnt,panSymlog:trt,zoomLinear:nrt,zoomLog:rrt,zoomPow:irt,zoomSymlog:ort,encode:Ict,modify:blt},Qlt=["view","item","group","xy","x","y"],tht="event.vega.",eht="this.",nht={},rht={forbidden:["_"],allowed:["datum","event","item"],fieldvar:"datum",globalvar:t=>`_[${Mrt(Yct+t)}]`,functions:oht,constants:Kot,visitors:nht},iht=tst(rht);function oht(t){const e=Jot(t);Qlt.forEach(t=>e[t]=tht+t);for(const n in Jlt)e[n]=eht+n;return hrt(e,elt(t,Jlt,nht)),e}function sht(t,e,n){return 1===arguments.length?Jlt[t]:(Jlt[t]=e,n&&(nht[t]=n),iht&&(iht.functions[t]=eht+t),this)}function aht(t,e){const n={};let r;try{t=wrt(t)?t:Mrt(t)+"",r=Zot(t)}catch(o){Rnt("Expression parse error: "+t)}r.visit(t=>{if(t.type!==Zrt)return;const r=t.callee.name,i=rht.visitors[r];i&&i(r,t.arguments,e,n)});const i=iht(r);return i.globals.forEach(t=>{const r=Yct+t;!prt(n,r)&&e.getSignal(t)&&(n[r]=e.signalRef(t))}),{$expr:hrt({code:i.code},e.options.ast?{ast:r}:null),$fields:i.fields,$params:n}}function uht(t,e,n){return t.fields=e||[],t.fname=n,t}function cht(t){return null==t?null:t.fields}function lht(t){return 1===t.length?hht(t[0]):fht(t)}sht("bandwidth",Ilt,Jct),sht("copy",Nlt,Jct),sht("domain",Dlt,Jct),sht("range",Flt,Jct),sht("invert",Rlt,Jct),sht("scale",Blt,Jct),sht("gradient",jlt,Jct),sht("geoArea",rlt,Jct),sht("geoBounds",ilt,Jct),sht("geoCentroid",olt,Jct),sht("geoShape",zlt,Jct),sht("indata",Tct,Kct),sht("data",Pct,Zct),sht("treePath",qlt,Zct),sht("treeAncestors",Wlt,Zct),sht("vlSelectionTest",yct,kct),sht("vlSelectionIdTest",xct,kct),sht("vlSelectionResolve",Ect,kct),sht("vlSelectionTuples",Sct);const hht=t=>(function(e){return e[t]}),fht=t=>{const e=t.length;return function(n){for(let r=0;r<e;++r)n=n[t[r]];return n}};function dht(t){throw Error(t)}function pht(t){const e=[],n=t.length;let r,i,o,s=null,a=0,u="";function c(){e.push(u+t.substring(r,i)),u="",r=i+1}for(t+="",r=i=0;i<n;++i)if(o=t[i],"\\"===o)u+=t.substring(r,i),u+=t.substring(++i,++i),r=i;else if(o===s)c(),s=null,a=-1;else{if(s)continue;r===a&&'"'===o?(r=i+1,s=o):r===a&&"'"===o?(r=i+1,s=o):"."!==o||a?"["===o?(i>r&&c(),a=r=i+1):"]"===o&&(a||dht("Access path missing open bracket: "+t),a>0&&c(),a=0,r=i+1):i>r?c():r=i+1}return a&&dht("Access path missing closing bracket: "+t),s&&dht("Access path missing closing quote: "+t),i>r&&(i++,c()),e}function ght(t,e,n){const r=pht(t);return t=1===r.length?r[0]:t,uht((n&&n.get||lht)(r),[t],e||t)}ght("id"),uht(t=>t,[],"identity"),uht(()=>0,[],"zero"),uht(()=>1,[],"one");const mht=uht(()=>!0,[],"true");uht(()=>!1,[],"false");var yht=Array.isArray;function vht(t){return t===Object(t)}function bht(t){return null!=t?yht(t)?t:[t]:[]}function _ht(t){return"function"===typeof t}const wht="descending";function xht(t,e,n){n=n||{},e=bht(e)||[];const r=[],i=[],o={},s=n.comparator||Eht;return bht(t).forEach((t,s)=>{null!=t&&(r.push(e[s]===wht?-1:1),i.push(t=_ht(t)?t:ght(t,null,n)),(cht(t)||[]).forEach(t=>o[t]=1))}),0===i.length?null:uht(s(i,r),Object.keys(o))}const Sht=(t,e)=>(t<e||null==t)&&null!=e?-1:(t>e||null==e)&&null!=t?1:(e=e instanceof Date?+e:e,(t=t instanceof Date?+t:t)!==t&&e===e?-1:e!==e&&t===t?1:0),Eht=(t,e)=>1===t.length?Aht(t[0],e[0]):Mht(t,e,t.length),Aht=(t,e)=>(function(n,r){return Sht(t(n),t(r))*e}),Mht=(t,e,n)=>{return e.push(0),function(r,i){let o,s=0,a=-1;while(0===s&&++a<n)o=t[a],s=Sht(o(r),o(i));return s*e[a]}};const Cht=Object.prototype.hasOwnProperty;function kht(t,e){return Cht.call(t,e)}function Oht(t){return"string"===typeof t}function Pht(t,e,n){t&&(t=e?bht(t).map(t=>t.replace(/\\(.)/g,"$1")):bht(t));const r=t&&t.length,i=n&&n.get||lht,o=t=>i(e?[t]:pht(t));let s;if(r)if(1===r){const e=o(t[0]);s=function(t){return""+e(t)}}else{const e=t.map(o);s=function(t){let n=""+e[0](t),i=0;while(++i<r)n+="|"+e[i](t);return n}}else s=function(){return""};return uht(s,t,"key")}function Tht(t){return yht(t)?"["+t.map(Tht)+"]":vht(t)||Oht(t)?JSON.stringify(t).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):t}function Lht(t){const e={},n=t.length;for(let r=0;r<n;++r)e[t[r]]=!0;return e}function Iht(t){const e=this,n=t.operators||[];return t.background&&(e.background=t.background),t.eventConfig&&(e.eventConfig=t.eventConfig),t.locale&&(e.locale=t.locale),n.forEach(t=>e.parseOperator(t)),n.forEach(t=>e.parseOperatorParameters(t)),(t.streams||[]).forEach(t=>e.parseStream(t)),(t.updates||[]).forEach(t=>e.parseUpdate(t)),e.resolve()}const Nht=Lht(["rule"]),Dht=Lht(["group","image","rect"]);function Rht(t,e){let n="";return Nht[e]?n:(t.x2&&(t.x?(Dht[e]&&(n+="if(o.x>o.x2)$=o.x,o.x=o.x2,o.x2=$;"),n+="o.width=o.x2-o.x;"):n+="o.x=o.x2-(o.width||0);"),t.xc&&(n+="o.x=o.xc-(o.width||0)/2;"),t.y2&&(t.y?(Dht[e]&&(n+="if(o.y>o.y2)$=o.y,o.y=o.y2,o.y2=$;"),n+="o.height=o.y2-o.y;"):n+="o.y=o.y2-(o.height||0);"),t.yc&&(n+="o.y=o.yc-(o.height||0)/2;"),n)}function Fht(t){return(t+"").toLowerCase()}function Bht(t){return"operator"===Fht(t)}function jht(t){return"collect"===Fht(t)}function zht(t,e,n){";"!==n[n.length-1]&&(n="return("+n+");");const r=Function(...e.concat(n));return t&&t.functions?r.bind(t.functions):r}function Uht(t,e,n,r){return"((u = ".concat(t,") < (v = ").concat(e,") || u == null) && v != null ? ").concat(n,"\n  : (u > v || v == null) && u != null ? ").concat(r,"\n  : ((v = v instanceof Date ? +v : v), (u = u instanceof Date ? +u : u)) !== u && v === v ? ").concat(n,"\n  : v !== v && u === u ? ").concat(r," : ")}var $ht={operator:(t,e)=>zht(t,["_"],e.code),parameter:(t,e)=>zht(t,["datum","_"],e.code),event:(t,e)=>zht(t,["event"],e.code),handler:(t,e)=>{const n="var datum=event.item&&event.item.datum;return ".concat(e.code,";");return zht(t,["_","event"],n)},encode:(t,e)=>{const{marktype:n,channels:r}=e;let i="var o=item,datum=o.datum,m=0,$;";for(const o in r){const t="o["+Tht(o)+"]";i+="$=".concat(r[o].code,";if(").concat(t,"!==$)").concat(t,"=$,m=1;")}return i+=Rht(r,n),i+="return m;",zht(t,["item","_"],i)},codegen:{get(t){const e="[".concat(t.map(Tht).join("]["),"]"),n=Function("_","return _".concat(e,";"));return n.path=e,n},comparator(t,e){let n;const r=(t,r)=>{const i=e[r];let o,s;return t.path?(o="a".concat(t.path),s="b".concat(t.path)):((n=n||{})["f"+r]=t,o="this.f".concat(r,"(a)"),s="this.f".concat(r,"(b)")),Uht(o,s,-i,i)},i=Function("a","b","var u, v; return "+t.map(r).join("")+"0;");return n?i.bind(n):i}}};function Vht(t){const e=this;Bht(t.type)||!t.type?e.operator(t,t.update?e.operatorExpression(t.update):null):e.transform(t,t.type)}function qht(t){const e=this;if(t.params){const n=e.get(t.id);n||dht("Invalid operator id: "+t.id),e.dataflow.connect(n,n.parameters(e.parseParameters(t.params),t.react,t.initonly))}}function Wht(t,e){e=e||{};const n=this;for(const r in t){const i=t[r];e[r]=yht(i)?i.map(t=>Ght(t,n,e)):Ght(i,n,e)}return e}function Ght(t,e,n){if(!t||!vht(t))return t;for(let r,i=0,o=Hht.length;i<o;++i)if(r=Hht[i],kht(t,r.key))return r.parse(t,e,n);return t}var Hht=[{key:"$ref",parse:Xht},{key:"$key",parse:Zht},{key:"$expr",parse:Yht},{key:"$field",parse:Kht},{key:"$encode",parse:Qht},{key:"$compare",parse:Jht},{key:"$context",parse:tft},{key:"$subflow",parse:eft},{key:"$tupleid",parse:nft}];function Xht(t,e){return e.get(t.$ref)||dht("Operator not defined: "+t.$ref)}function Yht(t,e,n){t.$params&&e.parseParameters(t.$params,n);const r="e:"+t.$expr.code+"_"+t.$name;return e.fn[r]||(e.fn[r]=uht(e.parameterExpression(t.$expr),t.$fields,t.$name))}function Zht(t,e){const n="k:"+t.$key+"_"+!!t.$flat;return e.fn[n]||(e.fn[n]=Pht(t.$key,t.$flat,e.expr.codegen))}function Kht(t,e){if(!t.$field)return null;const n="f:"+t.$field+"_"+t.$name;return e.fn[n]||(e.fn[n]=ght(t.$field,t.$name,e.expr.codegen))}function Jht(t,e){const n="c:"+t.$compare+"_"+t.$order,r=bht(t.$compare).map(t=>t&&t.$tupleid?Fk:t);return e.fn[n]||(e.fn[n]=xht(r,t.$order,e.expr.codegen))}function Qht(t,e){const n=t.$encode,r={};for(const i in n){const t=n[i];r[i]=uht(e.encodeExpression(t.$expr),t.$fields),r[i].output=t.$output}return r}function tft(t,e){return e}function eft(t,e){const n=t.$subflow;return function(t,r,i){const o=e.fork().parse(n),s=o.get(n.operators[0].id),a=o.signals.parent;return a&&a.set(i),s.detachSubflow=()=>e.detach(o),s}}function nft(){return Fk}function rft(t){var e,n=this,r=null!=t.filter?n.eventExpression(t.filter):void 0,i=null!=t.stream?n.get(t.stream):void 0;t.source?i=n.events(t.source,t.type,r):t.merge&&(e=t.merge.map(t=>n.get(t)),i=e[0].merge.apply(e[0],e.slice(1))),t.between&&(e=t.between.map(t=>n.get(t)),i=i.between(e[0],e[1])),t.filter&&(i=i.filter(r)),null!=t.throttle&&(i=i.throttle(+t.throttle)),null!=t.debounce&&(i=i.debounce(+t.debounce)),null==i&&dht("Invalid stream definition: "+JSON.stringify(t)),t.consume&&i.consume(!0),n.stream(t,i)}function ift(t){var e=this,n=vht(n=t.source)?n.$ref:n,r=e.get(n),i=null,o=t.update,s=void 0;r||dht("Source not defined: "+t.source),i=t.target&&t.target.$expr?e.eventExpression(t.target.$expr):e.get(t.target),o&&o.$expr&&(o.$params&&(s=e.parseParameters(o.$params)),o=e.handlerExpression(o.$expr)),e.update(t,r,i,o,s)}const oft={skip:!0};function sft(t){var e=this,n={};if(t.signals){var r=n.signals={};Object.keys(e.signals).forEach(n=>{const i=e.signals[n];t.signals(n,i)&&(r[n]=i.value)})}if(t.data){var i=n.data={};Object.keys(e.data).forEach(n=>{const r=e.data[n];t.data(n,r)&&(i[n]=r.input.value)})}return e.subcontext&&!1!==t.recurse&&(n.subcontext=e.subcontext.map(e=>e.getState(t))),n}function aft(t){var e=this,n=e.dataflow,r=t.data,i=t.signals;Object.keys(i||{}).forEach(t=>{n.update(e.signals[t],i[t],oft)}),Object.keys(r||{}).forEach(t=>{n.pulse(e.data[t].input,n.changeset().remove(mht).insert(r[t]))}),(t.subcontext||[]).forEach((t,n)=>{const r=e.subcontext[n];r&&r.setState(t)})}function uft(t,e,n,r){return new cft(t,e,n,r)}function cft(t,e,n,r){this.dataflow=t,this.transforms=e,this.events=t.events.bind(t),this.expr=r||$ht,this.signals={},this.scales={},this.nodes={},this.data={},this.fn={},n&&(this.functions=Object.create(n),this.functions.context=this)}function lft(t){this.dataflow=t.dataflow,this.transforms=t.transforms,this.events=t.events,this.expr=t.expr,this.signals=Object.create(t.signals),this.scales=Object.create(t.scales),this.nodes=Object.create(t.nodes),this.data=Object.create(t.data),this.fn=Object.create(t.fn),t.functions&&(this.functions=Object.create(t.functions),this.functions.context=this)}cft.prototype=lft.prototype={fork(){const t=new lft(this);return(this.subcontext||(this.subcontext=[])).push(t),t},detach(t){this.subcontext=this.subcontext.filter(e=>e!==t);const e=Object.keys(t.nodes);for(const n of e)t.nodes[n]._targets=null;for(const n of e)t.nodes[n].detach();t.nodes=null},get(t){return this.nodes[t]},set(t,e){return this.nodes[t]=e},add(t,e){const n=this,r=n.dataflow,i=t.value;if(n.set(t.id,e),jht(t.type)&&i&&(i.$ingest?r.ingest(e,i.$ingest,i.$format):i.$request?r.preload(e,i.$request,i.$format):r.pulse(e,r.changeset().insert(i))),t.root&&(n.root=e),t.parent){let i=n.get(t.parent.$ref);i?(r.connect(i,[e]),e.targets().add(i)):(n.unresolved=n.unresolved||[]).push(()=>{i=n.get(t.parent.$ref),r.connect(i,[e]),e.targets().add(i)})}if(t.signal&&(n.signals[t.signal]=e),t.scale&&(n.scales[t.scale]=e),t.data)for(const o in t.data){const r=n.data[o]||(n.data[o]={});t.data[o].forEach(t=>r[t]=e)}},resolve(){return(this.unresolved||[]).forEach(t=>t()),delete this.unresolved,this},operator(t,e){this.add(t,this.dataflow.add(t.value,e))},transform(t,e){this.add(t,this.dataflow.add(this.transforms[Fht(e)]))},stream(t,e){this.set(t.id,e)},update(t,e,n,r,i){this.dataflow.on(e,n,r,i,t.options)},operatorExpression(t){return this.expr.operator(this,t)},parameterExpression(t){return this.expr.parameter(this,t)},eventExpression(t){return this.expr.event(this,t)},handlerExpression(t){return this.expr.handler(this,t)},encodeExpression(t){return this.expr.encode(this,t)},parse:Iht,parseOperator:Vht,parseOperatorParameters:qht,parseParameters:Wht,parseStream:rft,parseUpdate:ift,getState:sft,setState:aft};var hft=function(t,e,n){var r=new u5,i=e;return null==e?(r.restart(t,e,n),r):(r._restart=r.restart,r.restart=function(t,e,n){e=+e,n=null==n?s5():+n,r._restart((function o(s){s+=i,r._restart(o,i+=e,n),t(s)}),e,n)},r.restart(t,e,n),r)};function fft(t){const e=t.container();e&&(e.setAttribute("role","graphics-document"),e.setAttribute("aria-roleDescription","visualization"),dft(e,t.description()))}function dft(t,e){t&&(null==e?t.removeAttribute("aria-label"):t.setAttribute("aria-label",e))}function pft(t){t.add(null,e=>{return t._background=e.bg,t._resize=1,e.bg},{bg:t._signals.background})}const gft="default";function mft(t){const e=t._signals.cursor||(t._signals.cursor=t.add({user:gft,item:null}));t.on(t.events("view","mousemove"),e,(t,n)=>{const r=e.value,i=r?Ant(r)?r:r.user:gft,o=n.item&&n.item.cursor||null;return r&&i===r.user&&o==r.item?r:{user:i,item:o}}),t.add(null,(function(e){let n=e.cursor,r=this.value;return Ant(n)||(r=n.item,n=n.user),yft(t,n&&n!==gft?n:r||n),r}),{cursor:e})}function yft(t,e){const n=t.globalCursor()?"undefined"!==typeof document&&document.body:t.container();if(n)return null==e?n.style.removeProperty("cursor"):n.style.cursor=e}function vft(t,e){var n=t._runtime.data;return xnt(n,e)||lnt("Unrecognized data set: "+e),n[e]}function bft(t,e){return arguments.length<2?vft(this,t).values.value:_ft.call(this,t,Wk().remove(dnt).insert(e))}function _ft(t,e){qk(e)||lnt("Second argument to changes must be a changeset.");const n=vft(this,t);return n.modified=!0,this.pulse(n.input,e)}function wft(t,e){return _ft.call(this,t,Wk().insert(e))}function xft(t,e){return _ft.call(this,t,Wk().remove(e))}function Sft(t){var e=t.padding();return Math.max(0,t._viewWidth+e.left+e.right)}function Eft(t){var e=t.padding();return Math.max(0,t._viewHeight+e.top+e.bottom)}function Aft(t){var e=t.padding(),n=t._origin;return[e.left+n[0],e.top+n[1]]}function Mft(t){var e=Aft(t),n=Sft(t),r=Eft(t);t._renderer.background(t.background()),t._renderer.resize(n,r,e),t._handler.origin(e),t._resizeListeners.forEach(e=>{try{e(n,r)}catch(i){t.error(i)}})}function Cft(t,e,n){var r,i,o,s=t._renderer,a=s&&s.canvas();return a&&(o=Aft(t),i=e.changedTouches?e.changedTouches[0]:e,r=rG(i,a),r[0]-=o[0],r[1]-=o[1]),e.dataflow=t,e.item=n,e.vega=kft(t,n,r),e}function kft(t,e,n){const r=e?"group"===e.mark.marktype?e:e.mark.group:null;function i(t){var n,i=r;if(t)for(n=e;n;n=n.mark.group)if(n.mark.name===t){i=n;break}return i&&i.mark&&i.mark.interactive?i:{}}function o(t){if(!t)return n;Ant(t)&&(t=i(t));const e=n.slice();while(t)e[0]-=t.x||0,e[1]-=t.y||0,t=t.mark&&t.mark.group;return e}return{view:vnt(t),item:vnt(e||{}),group:i,xy:o,x:t=>o(t)[0],y:t=>o(t)[1]}}const Oft="view",Pft="timer",Tft="window",Lft={trap:!1};function Ift(t){const e=_nt({defaults:{}},t),n=(t,e)=>{e.forEach(e=>{pnt(t[e])&&(t[e]=Cnt(t[e]))})};return n(e.defaults,["prevent","allow"]),n(e,["view","window","selector"]),e}function Nft(t,e,n,r){t._eventListeners.push({type:n,sources:mnt(e),handler:r})}function Dft(t,e){var n=t._eventConfig.defaults,r=n.prevent,i=n.allow;return!1!==r&&!0!==i&&(!0===r||!1===i||(r?r[e]:i?!i[e]:t.preventDefault()))}function Rft(t,e,n){const r=t._eventConfig&&t._eventConfig[e];return!(!1===r||gnt(r)&&!r[n])||(t.warn(`Blocked ${e} ${n} event listener.`),!1)}function Fft(t,e,n){var r,i=this,o=new iO(n),s=function(n,r){i.runAsync(null,()=>{t===Oft&&Dft(i,e)&&n.preventDefault(),o.receive(Cft(i,n,r))})};if(t===Pft)Rft(i,"timer",e)&&i.timer(s,e);else if(t===Oft)Rft(i,"view",e)&&i.addEventListener(e,s,Lft);else if(t===Tft?Rft(i,"window",e)&&"undefined"!==typeof window&&(r=[window]):"undefined"!==typeof document&&Rft(i,"selector",e)&&(r=document.querySelectorAll(t)),r){for(var a=0,u=r.length;a<u;++a)r[a].addEventListener(e,s);Nft(i,r,e,s)}else i.warn("Can not resolve event source: "+t);return o}function Bft(t){return t.item}function jft(t){return t.item.mark.source}function zft(t){return function(e,n){return n.vega.view().changeset().encode(n.item,t)}}function Uft(t,e){return t=[t||"hover"],e=[e||"update",t[0]],this.on(this.events("view","mouseover",Bft),jft,zft(t)),this.on(this.events("view","mouseout",Bft),jft,zft(e)),this}function $ft(){var t,e,n,r=this._tooltip,i=this._timers,o=this._eventListeners;t=i.length;while(--t>=0)i[t].stop();t=o.length;while(--t>=0){n=o[t],e=n.sources.length;while(--e>=0)n.sources[e].removeEventListener(n.type,n.handler)}return r&&r.call(this,this._handler,null,null,null),this}function Vft(t,e,n){const r=document.createElement(t);for(const i in e)r.setAttribute(i,e[i]);return null!=n&&(r.textContent=n),r}const qft="vega-bind",Wft="vega-bind-name",Gft="vega-bind-radio";function Hft(t,e,n){if(!e)return;const r=n.param;let i=n.state;i||(i=n.state={elements:null,active:!1,set:null,update:e=>{e!=t.signal(r.signal)&&t.runAsync(null,()=>{i.source=!0,t.signal(r.signal,e)})}},r.debounce&&(i.update=bnt(r.debounce,i.update)));const o=null==r.input&&r.element?Xft:Zft;return o(i,e,r,t),i.active||(t.on(t._signals[r.signal],null,()=>{i.source?i.source=!1:i.set(t.signal(r.signal))}),i.active=!0),i}function Xft(t,e,n,r){const i=n.event||"input",o=()=>t.update(e.value);r.signal(n.signal,e.value),e.addEventListener(i,o),Nft(r,e,i,o),t.set=t=>{e.value=t,e.dispatchEvent(Yft(i))}}function Yft(t){return"undefined"!==typeof Event?new Event(t):{type:t}}function Zft(t,e,n,r){const i=r.signal(n.signal),o=Vft("div",{class:qft}),s="radio"===n.input?o:o.appendChild(Vft("label"));s.appendChild(Vft("span",{class:Wft},n.name||n.signal)),e.appendChild(o);let a=Kft;switch(n.input){case"checkbox":a=Jft;break;case"select":a=Qft;break;case"radio":a=tdt;break;case"range":a=edt;break}a(t,s,n,i)}function Kft(t,e,n,r){const i=Vft("input");for(const o in n)"signal"!==o&&"element"!==o&&i.setAttribute("input"===o?"type":o,n[o]);i.setAttribute("name",n.signal),i.value=r,e.appendChild(i),i.addEventListener("input",()=>t.update(i.value)),t.elements=[i],t.set=t=>i.value=t}function Jft(t,e,n,r){const i={type:"checkbox",name:n.signal};r&&(i.checked=!0);const o=Vft("input",i);e.appendChild(o),o.addEventListener("change",()=>t.update(o.checked)),t.elements=[o],t.set=t=>o.checked=!!t||null}function Qft(t,e,n,r){const i=Vft("select",{name:n.signal}),o=n.labels||[];n.options.forEach((t,e)=>{const n={value:t};ndt(t,r)&&(n.selected=!0),i.appendChild(Vft("option",n,(o[e]||t)+""))}),e.appendChild(i),i.addEventListener("change",()=>{t.update(n.options[i.selectedIndex])}),t.elements=[i],t.set=t=>{for(let e=0,r=n.options.length;e<r;++e)if(ndt(n.options[e],t))return void(i.selectedIndex=e)}}function tdt(t,e,n,r){const i=Vft("span",{class:Gft}),o=n.labels||[];e.appendChild(i),t.elements=n.options.map((e,s)=>{const a={type:"radio",name:n.signal,value:e};ndt(e,r)&&(a.checked=!0);const u=Vft("input",a);u.addEventListener("change",()=>t.update(e));const c=Vft("label",{},(o[s]||e)+"");return c.prepend(u),i.appendChild(c),u}),t.set=e=>{const n=t.elements,r=n.length;for(let t=0;t<r;++t)ndt(n[t].value,e)&&(n[t].checked=!0)}}function edt(t,e,n,r){r=void 0!==r?r:(+n.max+ +n.min)/2;const i=null!=n.max?n.max:Math.max(100,+r)||100,o=n.min||Math.min(0,i,+r)||0,s=n.step||Tnt(o,i,100),a=Vft("input",{type:"range",name:n.signal,min:o,max:i,step:s});a.value=r;const u=Vft("span",{},+r);e.appendChild(a),e.appendChild(u);const c=()=>{u.textContent=a.value,t.update(+a.value)};a.addEventListener("input",c),a.addEventListener("change",c),t.elements=[a],t.set=t=>{a.value=t,u.textContent=t}}function ndt(t,e){return t===e||t+""===e+""}function rdt(t,e,n,r,i,o){return e=e||new r(t.loader()),e.initialize(n,Sft(t),Eft(t),Aft(t),i,o).background(t.background())}function idt(t,e){return e?function(){try{e.apply(this,arguments)}catch(n){t.error(n)}}:null}function odt(t,e,n,r){const i=new r(t.loader(),idt(t,t.tooltip())).scene(t.scenegraph().root).initialize(n,Aft(t),t);return e&&e.handlers().forEach(t=>{i.on(t.type,t.handler)}),i}function sdt(t,e){const n=this,r=n._renderType,i=n._eventConfig.bind,o=GH(r);t=n._el=t?adt(n,t,!0):null,fft(n),o||n.error("Unrecognized renderer type: "+r);const s=o.handler||PG,a=t?o.renderer:o.headless;return n._renderer=a?rdt(n,n._renderer,t,a):null,n._handler=odt(n,n._handler,t,s),n._redraw=!0,t&&"none"!==i&&(e=e?n._elBind=adt(n,e,!0):t.appendChild(Vft("form",{class:"vega-bindings"})),n._bind.forEach(t=>{t.param.element&&"container"!==i&&(t.element=adt(n,t.param.element,!!t.param.input))}),n._bind.forEach(t=>{Hft(n,t.element||e,t)})),n}function adt(t,e,n){if("string"===typeof e){if("undefined"===typeof document)return t.error("DOM document instance not found."),null;if(e=document.querySelector(e),!e)return t.error("Signal bind element not found: "+e),null}if(e&&n)try{e.innerHTML=""}catch(r){e=null,t.error(r)}return e}const udt=t=>+t||0,cdt=t=>({top:t,bottom:t,left:t,right:t});function ldt(t){return gnt(t)?{top:udt(t.top),bottom:udt(t.bottom),left:udt(t.left),right:udt(t.right)}:cdt(udt(t))}async function hdt(t,e,n,r){const i=GH(e),o=i&&i.headless;return o||lnt("Unrecognized renderer type: "+e),await t.runAsync(),rdt(t,null,null,o,n,r).renderAsync(t._scenegraph.root)}async function fdt(t,e){t!==qH.Canvas&&t!==qH.SVG&&t!==qH.PNG&&lnt("Unrecognized image type: "+t);const n=await hdt(this,t,e);return t===qH.SVG?ddt(n.svg(),"image/svg+xml"):n.canvas().toDataURL("image/png")}function ddt(t,e){const n=new Blob([t],{type:e});return window.URL.createObjectURL(n)}async function pdt(t,e){const n=await hdt(this,qH.Canvas,t,e);return n.canvas()}async function gdt(t){const e=await hdt(this,qH.SVG,t);return e.svg()}function mdt(t,e,n){return uft(t,QO,Jlt,n).parse(e)}function ydt(t){var e=this._runtime.scales;return xnt(e,t)||lnt("Unrecognized scale or projection: "+t),e[t].value}var vdt="width",bdt="height",_dt="padding",wdt={skip:!0};function xdt(t,e){var n=t.autosize(),r=t.padding();return e-(n&&n.contains===_dt?r.left+r.right:0)}function Sdt(t,e){var n=t.autosize(),r=t.padding();return e-(n&&n.contains===_dt?r.top+r.bottom:0)}function Edt(t){var e=t._signals,n=e[vdt],r=e[bdt],i=e[_dt];function o(){t._autosize=t._resize=1}t._resizeWidth=t.add(null,e=>{t._width=e.size,t._viewWidth=xdt(t,e.size),o()},{size:n}),t._resizeHeight=t.add(null,e=>{t._height=e.size,t._viewHeight=Sdt(t,e.size),o()},{size:r});const s=t.add(null,o,{pad:i});t._resizeWidth.rank=n.rank+1,t._resizeHeight.rank=r.rank+1,s.rank=i.rank+1}function Adt(t,e,n,r,i,o){this.runAfter(s=>{let a=0;s._autosize=0,s.width()!==n&&(a=1,s.signal(vdt,n,wdt),s._resizeWidth.skip(!0)),s.height()!==r&&(a=1,s.signal(bdt,r,wdt),s._resizeHeight.skip(!0)),s._viewWidth!==t&&(s._resize=1,s._viewWidth=t),s._viewHeight!==e&&(s._resize=1,s._viewHeight=e),s._origin[0]===i[0]&&s._origin[1]===i[1]||(s._resize=1,s._origin=i),a&&s.run("enter"),o&&s.runAfter(t=>t.resize())},!1,1)}function Mdt(t){return this._runtime.getState(t||{data:Cdt,signals:kdt,recurse:!0})}function Cdt(t,e){return e.modified&&pnt(e.input.value)&&t.indexOf("_:vega:_")}function kdt(t,e){return!("parent"===t||e instanceof QO.proxy)}function Odt(t){return this.runAsync(null,e=>{e._trigger=!1,e._runtime.setState(t)},t=>{t._trigger=!0}),this}function Pdt(t,e){function n(e){t({timestamp:Date.now(),elapsed:e})}this._timers.push(hft(n,e))}function Tdt(t,e,n,r){const i=t.element();i&&i.setAttribute("title",Ldt(r))}function Ldt(t){return null==t?"":pnt(t)?Ndt(t):gnt(t)&&!Ent(t)?Idt(t):t+""}function Idt(t){return Object.keys(t).map(e=>{const n=t[e];return e+": "+(pnt(n)?Ndt(n):Ddt(n))}).join("\n")}function Ndt(t){return"["+t.map(Ddt).join(", ")+"]"}function Ddt(t){return pnt(t)?"[…]":gnt(t)&&!Ent(t)?"{…}":t}function Rdt(t,e){const n=this;if(e=e||{},ZO.call(n),e.loader&&n.loader(e.loader),e.logger&&n.logger(e.logger),null!=e.logLevel&&n.logLevel(e.logLevel),e.locale||t.locale){const r=_nt({},t.locale,e.locale);n.locale(Object(Tk["b"])(r.number,r.time))}n._el=null,n._elBind=null,n._renderType=e.renderer||qH.Canvas,n._scenegraph=new ZW;const r=n._scenegraph.root;n._renderer=null,n._tooltip=e.tooltip||Tdt,n._redraw=!0,n._handler=(new PG).scene(r),n._globalCursor=!1,n._preventDefault=!1,n._timers=[],n._eventListeners=[],n._resizeListeners=[],n._eventConfig=Ift(t.eventConfig),n.globalCursor(n._eventConfig.globalCursor);const i=mdt(n,t,e.expr);n._runtime=i,n._signals=i.signals,n._bind=(t.bindings||[]).map(t=>({state:null,param:_nt({},t)})),i.root&&i.root.set(r),r.source=i.data.root.input,n.pulse(i.data.root.input,n.changeset().insert(r.items)),n._width=n.width(),n._height=n.height(),n._viewWidth=xdt(n,n._width),n._viewHeight=Sdt(n,n._height),n._origin=[0,0],n._resize=0,n._autosize=1,Edt(n),pft(n),mft(n),n.description(t.description),e.hover&&n.hover(),e.container&&n.initialize(e.container,e.bind)}function Fdt(t,e){return xnt(t._signals,e)?t._signals[e]:lnt("Unrecognized signal name: "+Mnt(e))}function Bdt(t,e){const n=(t._targets||[]).filter(t=>t._update&&t._update.handler===e);return n.length?n[0]:null}function jdt(t,e,n,r){let i=Bdt(n,r);return i||(i=idt(t,()=>r(e,n.value)),i.handler=r,t.on(n,null,i)),t}function zdt(t,e,n){const r=Bdt(e,n);return r&&e._targets.remove(r),t}function Udt(t,e,n){return t.fields=e||[],t.fname=n,t}function $dt(t){return 1===t.length?Vdt(t[0]):qdt(t)}Snt(Rdt,ZO,{async evaluate(t,e,n){if(await ZO.prototype.evaluate.call(this,t,e),this._redraw||this._resize)try{this._renderer&&(this._resize&&(this._resize=0,Mft(this)),await this._renderer.renderAsync(this._scenegraph.root)),this._redraw=!1}catch(r){this.error(r)}return n&&Ik(this,n),this},dirty(t){this._redraw=!0,this._renderer&&this._renderer.dirty(t)},description(t){if(arguments.length){const e=null!=t?t+"":null;return e!==this._desc&&dft(this._el,this._desc=e),this}return this._desc},container(){return this._el},scenegraph(){return this._scenegraph},origin(){return this._origin.slice()},signal(t,e,n){const r=Fdt(this,t);return 1===arguments.length?r.value:this.update(r,e,n)},width(t){return arguments.length?this.signal("width",t):this.signal("width")},height(t){return arguments.length?this.signal("height",t):this.signal("height")},padding(t){return arguments.length?this.signal("padding",ldt(t)):ldt(this.signal("padding"))},autosize(t){return arguments.length?this.signal("autosize",t):this.signal("autosize")},background(t){return arguments.length?this.signal("background",t):this.signal("background")},renderer(t){return arguments.length?(GH(t)||lnt("Unrecognized renderer type: "+t),t!==this._renderType&&(this._renderType=t,this._resetRenderer()),this):this._renderType},tooltip(t){return arguments.length?(t!==this._tooltip&&(this._tooltip=t,this._resetRenderer()),this):this._tooltip},loader(t){return arguments.length?(t!==this._loader&&(ZO.prototype.loader.call(this,t),this._resetRenderer()),this):this._loader},resize(){return this._autosize=1,this.touch(Fdt(this,"autosize"))},_resetRenderer(){this._renderer&&(this._renderer=null,this.initialize(this._el,this._elBind))},_resizeView:Adt,addEventListener(t,e,n){let r=e;return n&&!1===n.trap||(r=idt(this,e),r.raw=e),this._handler.on(t,r),this},removeEventListener(t,e){var n,r,i=this._handler.handlers(t),o=i.length;while(--o>=0)if(r=i[o].type,n=i[o].handler,t===r&&(e===n||e===n.raw)){this._handler.off(r,n);break}return this},addResizeListener(t){const e=this._resizeListeners;return e.indexOf(t)<0&&e.push(t),this},removeResizeListener(t){var e=this._resizeListeners,n=e.indexOf(t);return n>=0&&e.splice(n,1),this},addSignalListener(t,e){return jdt(this,t,Fdt(this,t),e)},removeSignalListener(t,e){return zdt(this,Fdt(this,t),e)},addDataListener(t,e){return jdt(this,t,vft(this,t).values,e)},removeDataListener(t,e){return zdt(this,vft(this,t).values,e)},globalCursor(t){if(arguments.length){if(this._globalCursor!==!!t){const e=yft(this,null);this._globalCursor=!!t,e&&yft(this,e)}return this}return this._globalCursor},preventDefault(t){return arguments.length?(this._preventDefault=t,this):this._preventDefault},timer:Pdt,events:Fft,finalize:$ft,hover:Uft,data:bft,change:_ft,insert:wft,remove:xft,scale:ydt,initialize:sdt,toImageURL:fdt,toCanvas:pdt,toSVG:gdt,getState:Mdt,setState:Odt});const Vdt=t=>(function(e){return e[t]}),qdt=t=>{const e=t.length;return function(n){for(let r=0;r<e;++r)n=n[t[r]];return n}};function Wdt(t){throw Error(t)}function Gdt(t){const e=[],n=t.length;let r,i,o,s=null,a=0,u="";function c(){e.push(u+t.substring(r,i)),u="",r=i+1}for(t+="",r=i=0;i<n;++i)if(o=t[i],"\\"===o)u+=t.substring(r,i),u+=t.substring(++i,++i),r=i;else if(o===s)c(),s=null,a=-1;else{if(s)continue;r===a&&'"'===o?(r=i+1,s=o):r===a&&"'"===o?(r=i+1,s=o):"."!==o||a?"["===o?(i>r&&c(),a=r=i+1):"]"===o&&(a||Wdt("Access path missing open bracket: "+t),a>0&&c(),a=0,r=i+1):i>r?c():r=i+1}return a&&Wdt("Access path missing closing bracket: "+t),s&&Wdt("Access path missing closing quote: "+t),i>r&&(i++,c()),e}function Hdt(t,e,n){const r=Gdt(t);return t=1===r.length?r[0]:t,Udt((n&&n.get||$dt)(r),[t],e||t)}Hdt("id"),Udt(t=>t,[],"identity"),Udt(()=>0,[],"zero"),Udt(()=>1,[],"one"),Udt(()=>!0,[],"true"),Udt(()=>!1,[],"false");var Xdt=Array.isArray;function Ydt(t){return t===Object(t)}const Zdt=t=>"__proto__"!==t;function Kdt(...t){return t.reduce((t,e)=>{for(const n in e)if("signals"===n)t.signals=Qdt(t.signals,e.signals);else{const r="legend"===n?{layout:1}:"style"===n||null;Jdt(t,n,e[n],r)}return t},{})}function Jdt(t,e,n,r){if(!Zdt(e))return;let i,o;if(Ydt(n)&&!Xdt(n))for(i in o=Ydt(t[e])?t[e]:t[e]={},n)r&&(!0===r||r[i])?Jdt(o,i,n[i]):Zdt(i)&&(o[i]=n[i]);else t[e]=n}function Qdt(t,e){if(null==t)return e;const n={},r=[];function i(t){n[t.name]||(n[t.name]=1,r.push(t))}return e.forEach(i),t.forEach(i),r}function tpt(t){return t[t.length-1]}function ept(t){return null!=t?Xdt(t)?t:[t]:[]}function npt(t){for(let e,n,r=1,i=arguments.length;r<i;++r)for(n in e=arguments[r],e)t[n]=e[n];return t}const rpt=Object.prototype.hasOwnProperty;function ipt(t,e){return rpt.call(t,e)}function opt(t){return"string"===typeof t}function spt(t){return Xdt(t)?"["+t.map(spt)+"]":Ydt(t)||opt(t)?JSON.stringify(t).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):t}const apt="view",upt="[",cpt="]",lpt="{",hpt="}",fpt=":",dpt=",",ppt="@",gpt=">",mpt=/[[\]{}]/,ypt={"*":1,arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1};let vpt,bpt;function _pt(t,e,n){return vpt=e||apt,bpt=n||ypt,Spt(t.trim()).map(Ept)}function wpt(t){return bpt[t]}function xpt(t,e,n,r,i){const o=t.length;let s,a=0;for(;e<o;++e){if(s=t[e],!a&&s===n)return e;i&&i.indexOf(s)>=0?--a:r&&r.indexOf(s)>=0&&++a}return e}function Spt(t){const e=[],n=t.length;let r=0,i=0;while(i<n)i=xpt(t,i,dpt,upt+lpt,cpt+hpt),e.push(t.substring(r,i).trim()),r=++i;if(0===e.length)throw"Empty event selector: "+t;return e}function Ept(t){return"["===t[0]?Apt(t):Mpt(t)}function Apt(t){const e=t.length;let n,r=1;if(r=xpt(t,r,cpt,upt,cpt),r===e)throw"Empty between selector: "+t;if(n=Spt(t.substring(1,r)),2!==n.length)throw"Between selector must have two elements: "+t;if(t=t.slice(r+1).trim(),t[0]!==gpt)throw"Expected '>' after between selector: "+t;n=n.map(Ept);const i=Ept(t.slice(1).trim());return i.between?{between:n,stream:i}:(i.between=n,i)}function Mpt(t){const e={source:vpt},n=[];let r,i,o=[0,0],s=0,a=0,u=t.length,c=0;if(t[u-1]===hpt){if(c=t.lastIndexOf(lpt),!(c>=0))throw"Unmatched right brace: "+t;try{o=Cpt(t.substring(c+1,u-1))}catch(l){throw"Invalid throttle specification: "+t}t=t.slice(0,c).trim(),u=t.length,c=0}if(!u)throw t;if(t[0]===ppt&&(s=++c),r=xpt(t,c,fpt),r<u&&(n.push(t.substring(a,r).trim()),a=c=++r),c=xpt(t,c,upt),c===u)n.push(t.substring(a,u).trim());else if(n.push(t.substring(a,c).trim()),i=[],a=++c,a===u)throw"Unmatched left bracket: "+t;while(c<u){if(c=xpt(t,c,cpt),c===u)throw"Unmatched left bracket: "+t;if(i.push(t.substring(a,c).trim()),c<u-1&&t[++c]!==upt)throw"Expected left bracket: "+t;a=++c}if(!(u=n.length)||mpt.test(n[u-1]))throw"Invalid event selector: "+t;return u>1?(e.type=n[1],s?e.markname=n[0].slice(1):wpt(n[0])?e.marktype=n[0]:e.source=n[0]):e.type=n[0],"!"===e.type.slice(-1)&&(e.consume=!0,e.type=e.type.slice(0,-1)),null!=i&&(e.filter=i),o[0]&&(e.throttle=o[0]),o[1]&&(e.debounce=o[1]),e}function Cpt(t){const e=t.split(dpt);if(!t.length||e.length>2)throw t;return e.map(e=>{const n=+e;if(n!==n)throw t;return n})}function kpt(t){return Ydt(t)?t:{type:t||"pad"}}const Opt=t=>+t||0,Ppt=t=>({top:t,bottom:t,left:t,right:t});function Tpt(t){return Ydt(t)?t.signal?t:{top:Opt(t.top),bottom:Opt(t.bottom),left:Opt(t.left),right:Opt(t.right)}:Ppt(Opt(t))}const Lpt=t=>Ydt(t)&&!Xdt(t)?npt({},t):{value:t};function Ipt(t,e,n,r){if(null!=n){const i=Ydt(n)&&!Xdt(n)||Xdt(n)&&n.length&&Ydt(n[0]);return i?t.update[e]=n:t[r||"enter"][e]={value:n},1}return 0}function Npt(t,e,n){for(const r in e)Ipt(t,r,e[r]);for(const r in n)Ipt(t,r,n[r],"update")}function Dpt(t,e,n){for(const r in e)n&&ipt(n,r)||(t[r]=npt(t[r]||{},e[r]));return t}function Rpt(t,e){return e&&(e.enter&&e.enter[t]||e.update&&e.update[t])}const Fpt="mark",Bpt="frame",jpt="scope",zpt="axis",Upt="axis-domain",$pt="axis-grid",Vpt="axis-label",qpt="axis-tick",Wpt="axis-title",Gpt="legend",Hpt="legend-band",Xpt="legend-entry",Ypt="legend-gradient",Zpt="legend-label",Kpt="legend-symbol",Jpt="legend-title",Qpt="title",tgt="title-text",egt="title-subtitle";function ngt(t,e,n,r,i){const o={},s={};let a,u,c,l;for(u in u="lineBreak","text"!==e||null==i[u]||Rpt(u,t)||rgt(o,u,i[u]),("legend"==n||String(n).startsWith("axis"))&&(n=null),l=n===Bpt?i.group:n===Fpt?npt({},i.mark,i[e]):null,l)c=Rpt(u,t)||("fill"===u||"stroke"===u)&&(Rpt("fill",t)||Rpt("stroke",t)),c||rgt(o,u,l[u]);for(u in ept(r).forEach(e=>{const n=i.style&&i.style[e];for(const r in n)Rpt(r,t)||rgt(o,r,n[r])}),t=npt({},t),o)l=o[u],l.signal?(a=a||{})[u]=l:s[u]=l;return t.enter=npt(s,t.enter),a&&(t.update=npt(a,t.update)),t}function rgt(t,e,n){t[e]=n&&n.signal?{signal:n.signal}:{value:n}}const igt=t=>opt(t)?spt(t):t.signal?`(${t.signal})`:lgt(t);function ogt(t){if(null!=t.gradient)return ugt(t);let e=t.signal?`(${t.signal})`:t.color?agt(t.color):null!=t.field?lgt(t.field):void 0!==t.value?spt(t.value):void 0;return null!=t.scale&&(e=fgt(t,e)),void 0===e&&(e=null),null!=t.exponent&&(e=`pow(${e},${cgt(t.exponent)})`),null!=t.mult&&(e+=`*${cgt(t.mult)}`),null!=t.offset&&(e+=`+${cgt(t.offset)}`),t.round&&(e=`round(${e})`),e}const sgt=(t,e,n,r)=>`(${t}(${[e,n,r].map(ogt).join(",")})+'')`;function agt(t){return t.c?sgt("hcl",t.h,t.c,t.l):t.h||t.s?sgt("hsl",t.h,t.s,t.l):t.l||t.a?sgt("lab",t.l,t.a,t.b):t.r||t.g||t.b?sgt("rgb",t.r,t.g,t.b):null}function ugt(t){const e=[t.start,t.stop,t.count].map(t=>null==t?null:spt(t));while(e.length&&null==tpt(e))e.pop();return e.unshift(igt(t.gradient)),`gradient(${e.join(",")})`}function cgt(t){return Ydt(t)?"("+ogt(t)+")":t}function lgt(t){return hgt(Ydt(t)?t:{datum:t})}function hgt(t){let e,n,r;if(t.signal)e="datum",r=t.signal;else if(t.group||t.parent){n=Math.max(1,t.level||1),e="item";while(n-- >0)e+=".mark.group";t.parent?(r=t.parent,e+=".datum"):r=t.group}else t.datum?(e="datum",r=t.datum):Wdt("Invalid field reference: "+spt(t));return t.signal||(r=opt(r)?Gdt(r).map(spt).join("]["):hgt(r)),e+"["+r+"]"}function fgt(t,e){const n=igt(t.scale);return null!=t.range?e=`lerp(_range(${n}), ${+t.range})`:(void 0!==e&&(e=`_scale(${n}, ${e})`),t.band&&(e=(e?e+"+":"")+`_bandwidth(${n})`+(1===+t.band?"":"*"+cgt(t.band)),t.extra&&(e=`(datum.extra ? _scale(${n}, datum.extra.value) : ${e})`)),null==e&&(e="0")),e}function dgt(t){let e="";return t.forEach(t=>{const n=ogt(t);e+=t.test?`(${t.test})?${n}:`:n}),":"===tpt(e)&&(e+="null"),e}function pgt(t,e,n,r,i,o){const s={};o=o||{},o.encoders={$encode:s},t=ngt(t,e,n,r,i.config);for(const a in t)s[a]=ggt(t[a],e,o,i);return o}function ggt(t,e,n,r){const i={},o={};for(const s in t)null!=t[s]&&(i[s]=ygt(mgt(t[s]),r,n,o));return{$expr:{marktype:e,channels:i},$fields:Object.keys(o),$output:Object.keys(t)}}function mgt(t){return Xdt(t)?dgt(t):ogt(t)}function ygt(t,e,n,r){const i=aht(t,e);return i.$fields.forEach(t=>r[t]=1),npt(n,i.$params),i.$expr}const vgt="outer",bgt=["value","update","init","react","bind"];function _gt(t,e){Wdt(t+' for "outer" push: '+spt(e))}function wgt(t,e){const n=t.name;if(t.push===vgt)e.signals[n]||_gt("No prior signal definition",n),bgt.forEach(e=>{void 0!==t[e]&&_gt("Invalid property ",e)});else{const r=e.addSignal(n,t.value);!1===t.react&&(r.react=!1),t.bind&&e.addBinding(n,t.bind)}}function xgt(t,e,n,r){this.id=-1,this.type=t,this.value=e,this.params=n,r&&(this.parent=r)}function Sgt(t,e,n,r){return new xgt(t,e,n,r)}function Egt(t,e){return Sgt("operator",t,e)}function Agt(t){const e={$ref:t.id};return t.id<0&&(t.refs=t.refs||[]).push(e),e}function Mgt(t,e){return e?{$field:t,$name:e}:{$field:t}}const Cgt=Mgt("key");function kgt(t,e){return{$compare:t,$order:e}}function Ogt(t,e){const n={$key:t};return e&&(n.$flat=!0),n}const Pgt="ascending",Tgt="descending";function Lgt(t){return Ydt(t)?(t.order===Tgt?"-":"+")+Igt(t.op,t.field):""}function Igt(t,e){return(t&&t.signal?"$"+t.signal:t||"")+(t&&e?"_":"")+(e&&e.signal?"$"+e.signal:e||"")}const Ngt="scope",Dgt="view";function Rgt(t){return t&&t.signal}function Fgt(t){return t&&t.expr}function Bgt(t){if(Rgt(t))return!0;if(Ydt(t))for(const e in t)if(Bgt(t[e]))return!0;return!1}function jgt(t,e){return null!=t?t:e}function zgt(t){return t&&t.signal||t}const Ugt="timer";function $gt(t,e){const n=t.merge?qgt:t.stream?Wgt:t.type?Ggt:Wdt("Invalid stream specification: "+spt(t));return n(t,e)}function Vgt(t){return t===Ngt?Dgt:t||Dgt}function qgt(t,e){const n=t.merge.map(t=>$gt(t,e)),r=Hgt({merge:n},t,e);return e.addStream(r).id}function Wgt(t,e){const n=$gt(t.stream,e),r=Hgt({stream:n},t,e);return e.addStream(r).id}function Ggt(t,e){let n;t.type===Ugt?(n=e.event(Ugt,t.throttle),t={between:t.between,filter:t.filter}):n=e.event(Vgt(t.source),t.type);const r=Hgt({stream:n},t,e);return 1===Object.keys(r).length?n:e.addStream(r).id}function Hgt(t,e,n){let r=e.between;return r&&(2!==r.length&&Wdt('Stream "between" parameter must have 2 entries: '+spt(e)),t.between=[$gt(r[0],n),$gt(r[1],n)]),r=e.filter?[].concat(e.filter):[],(e.marktype||e.markname||e.markrole)&&r.push(Xgt(e.marktype,e.markname,e.markrole)),e.source===Ngt&&r.push("inScope(event.item)"),r.length&&(t.filter=aht("("+r.join(")&&(")+")",n).$expr),null!=(r=e.throttle)&&(t.throttle=+r),null!=(r=e.debounce)&&(t.debounce=+r),e.consume&&(t.consume=!0),t}function Xgt(t,e,n){const r="event.item";return r+(t&&"*"!==t?"&&"+r+".mark.marktype==='"+t+"'":"")+(n?"&&"+r+".mark.role==='"+n+"'":"")+(e?"&&"+r+".mark.name==='"+e+"'":"")}const Ygt={code:"_.$value",ast:{type:"Identifier",value:"value"}};function Zgt(t,e,n){const r=t.encode,i={target:n};let o=t.events,s=t.update,a=[];o||Wdt("Signal update missing events specification."),opt(o)&&(o=_pt(o,e.isSubscope()?Ngt:Dgt)),o=ept(o).filter(t=>t.signal||t.scale?(a.push(t),0):1),a.length>1&&(a=[Jgt(a)]),o.length&&a.push(o.length>1?{merge:o}:o[0]),null!=r&&(s&&Wdt("Signal encode and update are mutually exclusive."),s="encode(item(),"+spt(r)+")"),i.update=opt(s)?aht(s,e):null!=s.expr?aht(s.expr,e):null!=s.value?s.value:null!=s.signal?{$expr:Ygt,$params:{$value:e.signalRef(s.signal)}}:Wdt("Invalid signal update specification."),t.force&&(i.options={force:!0}),a.forEach(t=>e.addUpdate(npt(Kgt(t,e),i)))}function Kgt(t,e){return{source:t.signal?e.signalRef(t.signal):t.scale?e.scaleRef(t.scale):$gt(t,e)}}function Jgt(t){return{signal:"["+t.map(t=>t.scale?'scale("'+t.scale+'")':t.signal)+"]"}}function Qgt(t,e){const n=e.getSignal(t.name);let r=t.update;t.init&&(r?Wdt("Signals can not include both init and update expressions."):(r=t.init,n.initonly=!0)),r&&(r=aht(r,e),n.update=r.$expr,n.params=r.$params),t.on&&t.on.forEach(t=>Zgt(t,e,n.id))}const tmt=t=>(e,n,r)=>Sgt(t,n,e||void 0,r),emt=tmt("aggregate"),nmt=tmt("axisticks"),rmt=tmt("bound"),imt=tmt("collect"),omt=tmt("compare"),smt=tmt("datajoin"),amt=tmt("encode"),umt=tmt("expression"),cmt=tmt("facet"),lmt=tmt("field"),hmt=tmt("key"),fmt=tmt("legendentries"),dmt=tmt("load"),pmt=tmt("mark"),gmt=tmt("multiextent"),mmt=tmt("multivalues"),ymt=tmt("overlap"),vmt=tmt("params"),bmt=tmt("prefacet"),_mt=tmt("projection"),wmt=tmt("proxy"),xmt=tmt("relay"),Smt=tmt("render"),Emt=tmt("scale"),Amt=tmt("sieve"),Mmt=tmt("sortitems"),Cmt=tmt("viewlayout"),kmt=tmt("values");let Omt=0;const Pmt={min:"min",max:"max",count:"sum"};function Tmt(t,e){const n=t.type||"linear";qz(n)||Wdt("Unrecognized scale type: "+spt(n)),e.addScale(t.name,{type:n,domain:void 0})}function Lmt(t,e){const n=e.getScale(t.name).params;let r;for(r in n.domain=Rmt(t.domain,t,e),null!=t.range&&(n.range=Xmt(t,e,n)),null!=t.interpolate&&Hmt(t.interpolate,n),null!=t.nice&&(n.nice=Gmt(t.nice)),null!=t.bins&&(n.bins=Wmt(t.bins,e)),t)ipt(n,r)||"name"===r||(n[r]=Imt(t[r],e))}function Imt(t,e){return Ydt(t)?t.signal?e.signalRef(t.signal):Wdt("Unsupported object: "+spt(t)):t}function Nmt(t,e){return t.signal?e.signalRef(t.signal):t.map(t=>Imt(t,e))}function Dmt(t){Wdt("Can not find data set: "+spt(t))}function Rmt(t,e,n){if(t)return t.signal?n.signalRef(t.signal):(Xdt(t)?Fmt:t.fields?jmt:Bmt)(t,e,n);null==e.domainMin&&null==e.domainMax||Wdt("No scale domain defined for domainMin/domainMax to override.")}function Fmt(t,e,n){return t.map(t=>Imt(t,n))}function Bmt(t,e,n){const r=n.getData(t.data);return r||Dmt(t.data),Hz(e.type)?r.valuesRef(n,t.field,$mt(t.sort,!1)):Jz(e.type)?r.domainRef(n,t.field):r.extentRef(n,t.field)}function jmt(t,e,n){const r=t.data,i=t.fields.reduce((t,e)=>{return e=opt(e)?{data:r,field:e}:Xdt(e)||e.signal?zmt(e,n):e,t.push(e),t},[]);return(Hz(e.type)?Umt:Jz(e.type)?Vmt:qmt)(t,n,i)}function zmt(t,e){const n="_:vega:_"+Omt++,r=imt({});if(Xdt(t))r.value={$ingest:t};else if(t.signal){const i="setdata("+spt(n)+","+t.signal+")";r.params.input=e.signalRef(i)}return e.addDataPipeline(n,[r,Amt({})]),{data:n,field:"data"}}function Umt(t,e,n){const r=$mt(t.sort,!0);let i,o;const s=n.map(t=>{const n=e.getData(t.data);return n||Dmt(t.data),n.countsRef(e,t.field,r)}),a={groupby:Cgt,pulse:s};r&&(i=r.op||"count",o=r.field?Igt(i,r.field):"count",a.ops=[Pmt[i]],a.fields=[e.fieldRef(o)],a.as=[o]),i=e.add(emt(a));const u=e.add(imt({pulse:Agt(i)}));return o=e.add(kmt({field:Cgt,sort:e.sortRef(r),pulse:Agt(u)})),Agt(o)}function $mt(t,e){return t&&(t.field||t.op?t.field||"count"===t.op?e&&t.field&&t.op&&!Pmt[t.op]&&Wdt("Multiple domain scales can not be sorted using "+t.op):Wdt("No field provided for sort aggregate op: "+t.op):Ydt(t)?t.field="key":t={field:"key"}),t}function Vmt(t,e,n){const r=n.map(t=>{const n=e.getData(t.data);return n||Dmt(t.data),n.domainRef(e,t.field)});return Agt(e.add(mmt({values:r})))}function qmt(t,e,n){const r=n.map(t=>{const n=e.getData(t.data);return n||Dmt(t.data),n.extentRef(e,t.field)});return Agt(e.add(gmt({extents:r})))}function Wmt(t,e){return t.signal||Xdt(t)?Nmt(t,e):e.objectProperty(t)}function Gmt(t){return Ydt(t)?{interval:Imt(t.interval),step:Imt(t.step)}:Imt(t)}function Hmt(t,e){e.interpolate=Imt(t.type||t),null!=t.gamma&&(e.interpolateGamma=Imt(t.gamma))}function Xmt(t,e,n){const r=e.config.range;let i=t.range;if(i.signal)return e.signalRef(i.signal);if(opt(i)){if(r&&ipt(r,i))return t=npt({},t,{range:r[i]}),Xmt(t,e,n);"width"===i?i=[0,{signal:"width"}]:"height"===i?i=Hz(t.type)?[0,{signal:"height"}]:[{signal:"height"},0]:Wdt("Unrecognized scale range value: "+spt(i))}else{if(i.scheme)return n.scheme=Xdt(i.scheme)?Nmt(i.scheme,e):Imt(i.scheme,e),i.extent&&(n.schemeExtent=Nmt(i.extent,e)),void(i.count&&(n.schemeCount=Imt(i.count,e)));if(i.step)return void(n.rangeStep=Imt(i.step,e));if(Hz(t.type)&&!Xdt(i))return Rmt(i,t,e);Xdt(i)||Wdt("Unsupported range type: "+spt(i))}return i.map(t=>(Xdt(t)?Nmt:Imt)(t,e))}function Ymt(t,e){const n=e.config.projection||{},r={};for(const i in t)"name"!==i&&(r[i]=Zmt(t[i],i,e));for(const i in n)null==r[i]&&(r[i]=Zmt(n[i],i,e));e.addProjection(t.name,r)}function Zmt(t,e,n){return Xdt(t)?t.map(t=>Zmt(t,e,n)):Ydt(t)?t.signal?n.signalRef(t.signal):"fit"===e?t:Wdt("Unsupported parameter object: "+spt(t)):t}const Kmt="top",Jmt="left",Qmt="right",tyt="bottom",eyt="center",nyt="vertical",ryt="start",iyt="middle",oyt="end",syt="index",ayt="label",uyt="offset",cyt="perc",lyt="perc2",hyt="value",fyt="guide-label",dyt="guide-title",pyt="group-title",gyt="group-subtitle",myt="symbol",yyt="gradient",vyt="discrete",byt="size",_yt="shape",wyt="fill",xyt="stroke",Syt="strokeWidth",Eyt="strokeDash",Ayt="opacity",Myt=[byt,_yt,wyt,xyt,Syt,Eyt,Ayt],Cyt={name:1,style:1,interactive:1},kyt={value:0},Oyt={value:1},Pyt="group",Tyt="rect",Lyt="rule",Iyt="symbol",Nyt="text";function Dyt(t){return t.type=Pyt,t.interactive=t.interactive||!1,t}function Ryt(t,e){const n=(n,r)=>jgt(t[n],jgt(e[n],r));return n.isVertical=n=>nyt===jgt(t.direction,e.direction||(n?e.symbolDirection:e.gradientDirection)),n.gradientLength=()=>jgt(t.gradientLength,e.gradientLength||e.gradientWidth),n.gradientThickness=()=>jgt(t.gradientThickness,e.gradientThickness||e.gradientHeight),n.entryColumns=()=>jgt(t.columns,jgt(e.columns,+n.isVertical(!0))),n}function Fyt(t,e){const n=e&&(e.update&&e.update[t]||e.enter&&e.enter[t]);return n&&n.signal?n:n?n.value:null}function Byt(t,e,n){const r=e.config.style[n];return r&&r[t]}function jyt(t,e,n){return`item.anchor === '${ryt}' ? ${t} : item.anchor === '${oyt}' ? ${e} : ${n}`}const zyt=jyt(spt(Jmt),spt(Qmt),spt(eyt));function Uyt(t){const e=t("tickBand");let n,r,i=t("tickOffset");return e?e.signal?(n={signal:`(${e.signal}) === 'extent' ? 1 : 0.5`},r={signal:`(${e.signal}) === 'extent'`},Ydt(i)||(i={signal:`(${e.signal}) === 'extent' ? 0 : ${i}`})):"extent"===e?(n=1,r=!0,i=0):(n=.5,r=!1):(n=t("bandPosition"),r=t("tickExtra")),{extra:r,band:n,offset:i}}function $yt(t,e){return e?t?Ydt(t)?Object.assign({},t,{offset:$yt(t.offset,e)}):{value:t,offset:e}:e:t}function Vyt(t,e){return e?(t.name=e.name,t.style=e.style||t.style,t.interactive=!!e.interactive,t.encode=Dpt(t.encode,e,Cyt)):t.interactive=!1,t}function qyt(t,e,n,r){const i=Ryt(t,n),o=i.isVertical(),s=i.gradientThickness(),a=i.gradientLength();let u,c,l,h,f;o?(c=[0,1],l=[0,0],h=s,f=a):(c=[0,0],l=[1,0],h=a,f=s);const d={enter:u={opacity:kyt,x:kyt,y:kyt,width:Lpt(h),height:Lpt(f)},update:npt({},u,{opacity:Oyt,fill:{gradient:e,start:c,stop:l}}),exit:{opacity:kyt}};return Npt(d,{stroke:i("gradientStrokeColor"),strokeWidth:i("gradientStrokeWidth")},{opacity:i("gradientOpacity")}),Vyt({type:Tyt,role:Ypt,encode:d},r)}function Wyt(t,e,n,r,i){const o=Ryt(t,n),s=o.isVertical(),a=o.gradientThickness(),u=o.gradientLength();let c,l,h,f,d="";s?(c="y",h="y2",l="x",f="width",d="1-"):(c="x",h="x2",l="y",f="height");const p={opacity:kyt,fill:{scale:e,field:hyt}};p[c]={signal:d+"datum."+cyt,mult:u},p[l]=kyt,p[h]={signal:d+"datum."+lyt,mult:u},p[f]=Lpt(a);const g={enter:p,update:npt({},p,{opacity:Oyt}),exit:{opacity:kyt}};return Npt(g,{stroke:o("gradientStrokeColor"),strokeWidth:o("gradientStrokeWidth")},{opacity:o("gradientOpacity")}),Vyt({type:Tyt,role:Hpt,key:hyt,from:i,encode:g},r)}const Gyt=`datum.${cyt}<=0?"${Jmt}":datum.${cyt}>=1?"${Qmt}":"${eyt}"`,Hyt=`datum.${cyt}<=0?"${tyt}":datum.${cyt}>=1?"${Kmt}":"${iyt}"`;function Xyt(t,e,n,r){const i=Ryt(t,e),o=i.isVertical(),s=Lpt(i.gradientThickness()),a=i.gradientLength();let u,c,l,h,f=i("labelOverlap"),d="";const p={enter:u={opacity:kyt},update:c={opacity:Oyt,text:{field:ayt}},exit:{opacity:kyt}};return Npt(p,{fill:i("labelColor"),fillOpacity:i("labelOpacity"),font:i("labelFont"),fontSize:i("labelFontSize"),fontStyle:i("labelFontStyle"),fontWeight:i("labelFontWeight"),limit:jgt(t.labelLimit,e.gradientLabelLimit)}),o?(u.align={value:"left"},u.baseline=c.baseline={signal:Hyt},l="y",h="x",d="1-"):(u.align=c.align={signal:Gyt},u.baseline={value:"top"},l="x",h="y"),u[l]=c[l]={signal:d+"datum."+cyt,mult:a},u[h]=c[h]=s,s.offset=jgt(t.labelOffset,e.gradientLabelOffset)||0,f=f?{separation:i("labelSeparation"),method:f,order:"datum."+syt}:void 0,Vyt({type:Nyt,role:Zpt,style:fyt,key:hyt,from:r,encode:p,overlap:f},n)}function Yyt(t,e,n,r,i){const o=Ryt(t,e),s=n.entries,a=!(!s||!s.interactive),u=s?s.name:void 0,c=o("clipHeight"),l=o("symbolOffset"),h={data:"value"},f=`(${i}) ? datum.${uyt} : datum.${byt}`,d=c?Lpt(c):{field:byt},p=`datum.${syt}`,g=`max(1, ${i})`;let m,y,v,b,_;d.mult=.5,m={enter:y={opacity:kyt,x:{signal:f,mult:.5,offset:l},y:d},update:v={opacity:Oyt,x:y.x,y:y.y},exit:{opacity:kyt}};let w=null,x=null;t.fill||(w=e.symbolBaseFillColor,x=e.symbolBaseStrokeColor),Npt(m,{fill:o("symbolFillColor",w),shape:o("symbolType"),size:o("symbolSize"),stroke:o("symbolStrokeColor",x),strokeDash:o("symbolDash"),strokeDashOffset:o("symbolDashOffset"),strokeWidth:o("symbolStrokeWidth")},{opacity:o("symbolOpacity")}),Myt.forEach(e=>{t[e]&&(v[e]=y[e]={scale:t[e],field:hyt})});const S=Vyt({type:Iyt,role:Kpt,key:hyt,from:h,clip:!!c||void 0,encode:m},n.symbols),E=Lpt(l);E.offset=o("labelOffset"),m={enter:y={opacity:kyt,x:{signal:f,offset:E},y:d},update:v={opacity:Oyt,text:{field:ayt},x:y.x,y:y.y},exit:{opacity:kyt}},Npt(m,{align:o("labelAlign"),baseline:o("labelBaseline"),fill:o("labelColor"),fillOpacity:o("labelOpacity"),font:o("labelFont"),fontSize:o("labelFontSize"),fontStyle:o("labelFontStyle"),fontWeight:o("labelFontWeight"),limit:o("labelLimit")});const A=Vyt({type:Nyt,role:Zpt,style:fyt,key:hyt,from:h,encode:m},n.labels);return m={enter:{noBound:{value:!c},width:kyt,height:c?Lpt(c):kyt,opacity:kyt},exit:{opacity:kyt},update:v={opacity:Oyt,row:{signal:null},column:{signal:null}}},o.isVertical(!0)?(b=`ceil(item.mark.items.length / ${g})`,v.row.signal=`${p}%${b}`,v.column.signal=`floor(${p} / ${b})`,_={field:["row",p]}):(v.row.signal=`floor(${p} / ${g})`,v.column.signal=`${p} % ${g}`,_={field:p}),v.column.signal=`(${i})?${v.column.signal}:${p}`,r={facet:{data:r,name:"value",groupby:syt}},Dyt({role:jpt,from:r,encode:Dpt(m,s,Cyt),marks:[S,A],name:u,interactive:a,sort:_})}function Zyt(t,e){const n=Ryt(t,e);return{align:n("gridAlign"),columns:n.entryColumns(),center:{row:!0,column:!1},padding:{row:n("rowPadding"),column:n("columnPadding")}}}const Kyt='item.orient === "left"',Jyt='item.orient === "right"',Qyt=`(${Kyt} || ${Jyt})`,tvt=`datum.vgrad && ${Qyt}`,evt=jyt('"top"','"bottom"','"middle"'),nvt=jyt('"right"','"left"','"center"'),rvt=`datum.vgrad && ${Jyt} ? (${nvt}) : (${Qyt} && !(datum.vgrad && ${Kyt})) ? "left" : ${zyt}`,ivt=`item._anchor || (${Qyt} ? "middle" : "start")`,ovt=`${tvt} ? (${Kyt} ? -90 : 90) : 0`,svt=`${Qyt} ? (datum.vgrad ? (${Jyt} ? "bottom" : "top") : ${evt}) : "top"`;function avt(t,e,n,r){const i=Ryt(t,e),o={enter:{opacity:kyt},update:{opacity:Oyt,x:{field:{group:"padding"}},y:{field:{group:"padding"}}},exit:{opacity:kyt}};return Npt(o,{orient:i("titleOrient"),_anchor:i("titleAnchor"),anchor:{signal:ivt},angle:{signal:ovt},align:{signal:rvt},baseline:{signal:svt},text:t.title,fill:i("titleColor"),fillOpacity:i("titleOpacity"),font:i("titleFont"),fontSize:i("titleFontSize"),fontStyle:i("titleFontStyle"),fontWeight:i("titleFontWeight"),limit:i("titleLimit"),lineHeight:i("titleLineHeight")},{align:i("titleAlign"),baseline:i("titleBaseline")}),Vyt({type:Nyt,role:Jpt,style:dyt,from:r,encode:o},n)}function uvt(t,e){let n;return Ydt(t)&&(t.signal?n=t.signal:t.path?n="pathShape("+cvt(t.path)+")":t.sphere&&(n="geoShape("+cvt(t.sphere)+', {type: "Sphere"})')),n?e.signalRef(n):!!t}function cvt(t){return Ydt(t)&&t.signal?t.signal:spt(t)}function lvt(t){const e=t.role||"";return e.indexOf("axis")&&e.indexOf("legend")&&e.indexOf("title")?t.type===Pyt?jpt:e||Fpt:e}function hvt(t){return{marktype:t.type,name:t.name||void 0,role:t.role||lvt(t),zindex:+t.zindex||void 0,aria:t.aria,description:t.description}}function fvt(t,e){return t&&t.signal?e.signalRef(t.signal):!1!==t}function dvt(t,e){const n=tP(t.type);n||Wdt("Unrecognized transform type: "+spt(t.type));const r=Sgt(n.type.toLowerCase(),null,pvt(n,t,e));return t.signal&&e.addSignal(t.signal,e.proxy(r)),r.metadata=n.metadata||{},r}function pvt(t,e,n){const r={},i=t.params.length;for(let o=0;o<i;++o){const i=t.params[o];r[i.name]=gvt(i,e,n)}return r}function gvt(t,e,n){const r=t.type,i=e[t.name];return"index"===r?yvt(t,e,n):void 0!==i?"param"===r?vvt(t,e,n):"projection"===r?n.projectionRef(e[t.name]):t.array&&!Rgt(i)?i.map(e=>mvt(t,e,n)):mvt(t,i,n):void(t.required&&Wdt("Missing required "+spt(e.type)+" parameter: "+spt(t.name)))}function mvt(t,e,n){const r=t.type;if(Rgt(e))return Svt(r)?Wdt("Expression references can not be signals."):Evt(r)?n.fieldRef(e):Avt(r)?n.compareRef(e):n.signalRef(e.signal);{const i=t.expr||Evt(r);return i&&_vt(e)?n.exprRef(e.expr,e.as):i&&wvt(e)?Mgt(e.field,e.as):Svt(r)?aht(e,n):xvt(r)?Agt(n.getData(e).values):Evt(r)?Mgt(e):Avt(r)?n.compareRef(e):e}}function yvt(t,e,n){return opt(e.from)||Wdt('Lookup "from" parameter must be a string literal.'),n.getData(e.from).lookupRef(n,e.key)}function vvt(t,e,n){const r=e[t.name];return t.array?(Xdt(r)||Wdt("Expected an array of sub-parameters. Instead: "+spt(r)),r.map(e=>bvt(t,e,n))):bvt(t,r,n)}function bvt(t,e,n){const r=t.params.length;let i;for(let s=0;s<r;++s){i=t.params[s];for(const t in i.key)if(i.key[t]!==e[t]){i=null;break}if(i)break}i||Wdt("Unsupported parameter: "+spt(e));const o=npt(pvt(i,e,n),i.key);return Agt(n.add(vmt(o)))}const _vt=t=>t&&t.expr,wvt=t=>t&&t.field,xvt=t=>"data"===t,Svt=t=>"expr"===t,Evt=t=>"field"===t,Avt=t=>"compare"===t;function Mvt(t,e,n){let r,i,o,s,a;return t?(r=t.facet)&&(e||Wdt("Only group marks can be faceted."),null!=r.field?s=a=Cvt(r,n):(t.data?a=Agt(n.getData(t.data).aggregate):(o=dvt(npt({type:"aggregate",groupby:ept(r.groupby)},r.aggregate),n),o.params.key=n.keyRef(r.groupby),o.params.pulse=Cvt(r,n),s=a=Agt(n.add(o))),i=n.keyRef(r.groupby,!0))):s=Agt(n.add(imt(null,[{}]))),s||(s=Cvt(t,n)),{key:i,pulse:s,parent:a}}function Cvt(t,e){return t.$ref?t:t.data&&t.data.$ref?t.data:Agt(e.getData(t.data).output)}function kvt(t,e,n,r,i){this.scope=t,this.input=e,this.output=n,this.values=r,this.aggregate=i,this.index={}}function Ovt(t){return opt(t)?t:null}function Pvt(t,e,n){const r=Igt(n.op,n.field);let i;if(e.ops){for(let o=0,s=e.as.length;o<s;++o)if(e.as[o]===r)return}else e.ops=["count"],e.fields=[null],e.as=["count"];n.op&&(e.ops.push((i=n.op.signal)?t.signalRef(i):n.op),e.fields.push(t.fieldRef(n.field)),e.as.push(r))}function Tvt(t,e,n,r,i,o,s){const a=e[n]||(e[n]={}),u=Lgt(o);let c,l,h=Ovt(i);if(null!=h&&(t=e.scope,h+=u?"|"+u:"",c=a[h]),!c){const n=o?{field:Cgt,pulse:e.countsRef(t,i,o)}:{field:t.fieldRef(i),pulse:Agt(e.output)};u&&(n.sort=t.sortRef(o)),l=t.add(Sgt(r,void 0,n)),s&&(e.index[i]=l),c=Agt(l),null!=h&&(a[h]=c)}return c}function Lvt(t,e,n){const r=t.from.facet,i=r.name,o=Cvt(r,e);let s;r.name||Wdt("Facet must have a name: "+spt(r)),r.data||Wdt("Facet must reference a data set: "+spt(r)),r.field?s=e.add(bmt({field:e.fieldRef(r.field),pulse:o})):r.groupby?s=e.add(cmt({key:e.keyRef(r.groupby),group:Agt(e.proxy(n.parent)),pulse:o})):Wdt("Facet must specify groupby or field: "+spt(r));const a=e.fork(),u=a.add(imt()),c=a.add(Amt({pulse:Agt(u)}));a.addData(i,new kvt(a,u,u,c)),a.addSignal("parent",null),s.params.subflow={$subflow:a.parse(t).toRuntime()}}function Ivt(t,e,n){const r=e.add(bmt({pulse:n.pulse})),i=e.fork();i.add(Amt()),i.addSignal("parent",null),r.params.subflow={$subflow:i.parse(t).toRuntime()}}function Nvt(t,e,n){const r=t.remove,i=t.insert,o=t.toggle,s=t.modify,a=t.values,u=e.add(Egt()),c="if("+t.trigger+',modify("'+n+'",'+[i,r,o,s,a].map(t=>null==t?"null":t).join(",")+"),0)",l=aht(c,e);u.update=l.$expr,u.params=l.$params}function Dvt(t,e){const n=lvt(t),r=t.type===Pyt,i=t.from&&t.from.facet,o=t.overlap;let s,a,u,c,l,h,f,d=t.layout||n===jpt||n===Bpt;const p=n===Fpt||d||i,g=Mvt(t.from,r,e);a=e.add(smt({key:g.key||(t.key?Mgt(t.key):void 0),pulse:g.pulse,clean:!r}));const m=Agt(a);a=u=e.add(imt({pulse:m})),a=e.add(pmt({markdef:hvt(t),interactive:fvt(t.interactive,e),clip:uvt(t.clip,e),context:{$context:!0},groups:e.lookup(),parent:e.signals.parent?e.signalRef("parent"):null,index:e.markpath(),pulse:Agt(a)}));const y=Agt(a);a=c=e.add(amt(pgt(t.encode,t.type,n,t.style,e,{mod:!1,pulse:y}))),a.params.parent=e.encode(),t.transform&&t.transform.forEach(t=>{const n=dvt(t,e),r=n.metadata;(r.generates||r.changes)&&Wdt("Mark transforms should not generate new data."),r.nomod||(c.params.mod=!0),n.params.pulse=Agt(a),e.add(a=n)}),t.sort&&(a=e.add(Mmt({sort:e.compareRef(t.sort),pulse:Agt(a)})));const v=Agt(a);(i||d)&&(d=e.add(Cmt({layout:e.objectProperty(t.layout),legends:e.legends,mark:y,pulse:v})),h=Agt(d));const b=e.add(rmt({mark:y,pulse:h||v}));f=Agt(b),r&&(p&&(s=e.operators,s.pop(),d&&s.pop()),e.pushState(v,h||f,m),i?Lvt(t,e,g):p?Ivt(t,e,g):e.parse(t),e.popState(),p&&(d&&s.push(d),s.push(b))),o&&(f=Rvt(o,f,e));const _=e.add(Smt({pulse:f})),w=e.add(Amt({pulse:Agt(_)},void 0,e.parent()));null!=t.name&&(l=t.name,e.addData(l,new kvt(e,u,_,w)),t.on&&t.on.forEach(t=>{(t.insert||t.remove||t.toggle)&&Wdt("Marks only support modify triggers."),Nvt(t,e,l)}))}function Rvt(t,e,n){const r=t.method,i=t.bound,o=t.separation,s={separation:Rgt(o)?n.signalRef(o.signal):o,method:Rgt(r)?n.signalRef(r.signal):r,pulse:e};if(t.order&&(s.sort=n.compareRef({field:t.order})),i){const t=i.tolerance;s.boundTolerance=Rgt(t)?n.signalRef(t.signal):+t,s.boundScale=n.scaleRef(i.scale),s.boundOrient=i.orient}return Agt(n.add(ymt(s)))}function Fvt(t,e){const n=e.config.legend,r=t.encode||{},i=Ryt(t,n),o=r.legend||{},s=o.name||void 0,a=o.interactive,u=o.style,c={};let l,h,f,d=0;Myt.forEach(e=>t[e]?(c[e]=t[e],d=d||t[e]):0),d||Wdt("Missing valid scale for legend.");const p=Bvt(t,e.scaleType(d)),g={title:null!=t.title,scales:c,type:p,vgrad:"symbol"!==p&&i.isVertical()},m=Agt(e.add(imt(null,[g]))),y={enter:{x:{value:0},y:{value:0}}},v=Agt(e.add(fmt(h={type:p,scale:e.scaleRef(d),count:e.objectProperty(i("tickCount")),limit:e.property(i("symbolLimit")),values:e.objectProperty(t.values),minstep:e.property(t.tickMinStep),formatType:e.property(t.formatType),formatSpecifier:e.property(t.format)})));return p===yyt?(f=[qyt(t,d,n,r.gradient),Xyt(t,n,r.labels,v)],h.count=h.count||e.signalRef(`max(2,2*floor((${zgt(i.gradientLength())})/100))`)):p===vyt?f=[Wyt(t,d,n,r.gradient,v),Xyt(t,n,r.labels,v)]:(l=Zyt(t,n),f=[Yyt(t,n,r,v,zgt(l.columns))],h.size=Uvt(t,e,f[0].marks)),f=[Dyt({role:Xpt,from:m,encode:y,marks:f,layout:l,interactive:a})],g.title&&f.push(avt(t,n,r.title,m)),Dvt(Dyt({role:Gpt,from:m,encode:Dpt(zvt(i,t,n),o,Cyt),marks:f,aria:i("aria"),description:i("description"),zindex:i("zindex"),name:s,interactive:a,style:u}),e)}function Bvt(t,e){let n=t.type||myt;return t.type||1!==jvt(t)||!t.fill&&!t.stroke||(n=Gz(e)?yyt:Xz(e)?vyt:myt),n!==yyt?n:Xz(e)?vyt:yyt}function jvt(t){return Myt.reduce((e,n)=>e+(t[n]?1:0),0)}function zvt(t,e,n){const r={enter:{},update:{}};return Npt(r,{orient:t("orient"),offset:t("offset"),padding:t("padding"),titlePadding:t("titlePadding"),cornerRadius:t("cornerRadius"),fill:t("fillColor"),stroke:t("strokeColor"),strokeWidth:n.strokeWidth,strokeDash:n.strokeDash,x:t("legendX"),y:t("legendY"),format:e.format,formatType:e.formatType}),r}function Uvt(t,e,n){const r=zgt($vt("size",t,n)),i=zgt($vt("strokeWidth",t,n)),o=zgt(Vvt(n[1].encode,e,fyt));return aht(`max(ceil(sqrt(${r})+${i}),${o})`,e)}function $vt(t,e,n){return e[t]?`scale("${e[t]}",datum)`:Fyt(t,n[0].encode)}function Vvt(t,e,n){return Fyt("fontSize",t)||Byt("fontSize",e,n)}kvt.fromEntries=function(t,e){const n=e.length,r=e[n-1],i=e[n-2];let o=e[0],s=null,a=1;for(o&&"load"===o.type&&(o=e[1]),t.add(e[0]);a<n;++a)e[a].params.pulse=Agt(e[a-1]),t.add(e[a]),"aggregate"===e[a].type&&(s=e[a]);return new kvt(t,o,i,r,s)},kvt.prototype={countsRef(t,e,n){const r=this,i=r.counts||(r.counts={}),o=Ovt(e);let s,a,u;return null!=o&&(t=r.scope,s=i[o]),s?n&&n.field&&Pvt(t,s.agg.params,n):(u={groupby:t.fieldRef(e,"key"),pulse:Agt(r.output)},n&&n.field&&Pvt(t,u,n),a=t.add(emt(u)),s=t.add(imt({pulse:Agt(a)})),s={agg:a,ref:Agt(s)},null!=o&&(i[o]=s)),s.ref},tuplesRef(){return Agt(this.values)},extentRef(t,e){return Tvt(t,this,"extent","extent",e,!1)},domainRef(t,e){return Tvt(t,this,"domain","values",e,!1)},valuesRef(t,e,n){return Tvt(t,this,"vals","values",e,n||!0)},lookupRef(t,e){return Tvt(t,this,"lookup","tupleindex",e,!1)},indataRef(t,e){return Tvt(t,this,"indata","tupleindex",e,!0,!0)}};const qvt=`item.orient==="${Jmt}"?-90:item.orient==="${Qmt}"?90:0`;function Wvt(t,e){t=opt(t)?{text:t}:t;const n=Ryt(t,e.config.title),r=t.encode||{},i=r.group||{},o=i.name||void 0,s=i.interactive,a=i.style,u=[],c={},l=Agt(e.add(imt(null,[c])));return u.push(Xvt(t,n,Gvt(t),l)),t.subtitle&&u.push(Yvt(t,n,r.subtitle,l)),Dvt(Dyt({role:Qpt,from:l,encode:Hvt(n,i),marks:u,aria:n("aria"),description:n("description"),zindex:n("zindex"),name:o,interactive:s,style:a}),e)}function Gvt(t){const e=t.encode;return e&&e.title||npt({name:t.name,interactive:t.interactive,style:t.style},e)}function Hvt(t,e){const n={enter:{},update:{}};return Npt(n,{orient:t("orient"),anchor:t("anchor"),align:{signal:zyt},angle:{signal:qvt},limit:t("limit"),frame:t("frame"),offset:t("offset")||0,padding:t("subtitlePadding")}),Dpt(n,e,Cyt)}function Xvt(t,e,n,r){const i={value:0},o=t.text,s={enter:{opacity:i},update:{opacity:{value:1}},exit:{opacity:i}};return Npt(s,{text:o,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:e("dx"),dy:e("dy"),fill:e("color"),font:e("font"),fontSize:e("fontSize"),fontStyle:e("fontStyle"),fontWeight:e("fontWeight"),lineHeight:e("lineHeight")},{align:e("align"),angle:e("angle"),baseline:e("baseline")}),Vyt({type:Nyt,role:tgt,style:pyt,from:r,encode:s},n)}function Yvt(t,e,n,r){const i={value:0},o=t.subtitle,s={enter:{opacity:i},update:{opacity:{value:1}},exit:{opacity:i}};return Npt(s,{text:o,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:e("dx"),dy:e("dy"),fill:e("subtitleColor"),font:e("subtitleFont"),fontSize:e("subtitleFontSize"),fontStyle:e("subtitleFontStyle"),fontWeight:e("subtitleFontWeight"),lineHeight:e("subtitleLineHeight")},{align:e("align"),angle:e("angle"),baseline:e("baseline")}),Vyt({type:Nyt,role:egt,style:gyt,from:r,encode:s},n)}function Zvt(t,e){const n=[];t.transform&&t.transform.forEach(t=>{n.push(dvt(t,e))}),t.on&&t.on.forEach(n=>{Nvt(n,e,t.name)}),e.addDataPipeline(t.name,Kvt(t,e,n))}function Kvt(t,e,n){const r=[];let i,o,s,a,u,c=null,l=!1,h=!1;for(t.values?Rgt(t.values)||Bgt(t.format)?(r.push(Qvt(e,t)),r.push(c=Jvt())):r.push(c=Jvt({$ingest:t.values,$format:t.format})):t.url?Bgt(t.url)||Bgt(t.format)?(r.push(Qvt(e,t)),r.push(c=Jvt())):r.push(c=Jvt({$request:t.url,$format:t.format})):t.source&&(c=i=ept(t.source).map(t=>Agt(e.getData(t).output)),r.push(null)),o=0,s=n.length;o<s;++o)a=n[o],u=a.metadata,c||u.source||r.push(c=Jvt()),r.push(a),u.generates&&(h=!0),u.modifies&&!h&&(l=!0),u.source?c=a:u.changes&&(c=null);return i&&(s=i.length-1,r[0]=xmt({derive:l,pulse:s?i:i[0]}),(l||s)&&r.splice(1,0,Jvt())),c||r.push(Jvt()),r.push(Amt({})),r}function Jvt(t){const e=imt({},t);return e.metadata={source:!0},e}function Qvt(t,e){return dmt({url:e.url?t.property(e.url):void 0,async:e.async?t.property(e.async):void 0,values:e.values?t.property(e.values):void 0,format:t.objectProperty(e.format)})}const tbt=t=>t===tyt||t===Kmt,ebt=(t,e,n)=>Rgt(t)?ubt(t.signal,e,n):t===Jmt||t===Kmt?e:n,nbt=(t,e,n)=>Rgt(t)?sbt(t.signal,e,n):tbt(t)?e:n,rbt=(t,e,n)=>Rgt(t)?abt(t.signal,e,n):tbt(t)?n:e,ibt=(t,e,n)=>Rgt(t)?cbt(t.signal,e,n):t===Kmt?{value:e}:{value:n},obt=(t,e,n)=>Rgt(t)?lbt(t.signal,e,n):t===Qmt?{value:e}:{value:n},sbt=(t,e,n)=>hbt(`${t} === '${Kmt}' || ${t} === '${tyt}'`,e,n),abt=(t,e,n)=>hbt(`${t} !== '${Kmt}' && ${t} !== '${tyt}'`,e,n),ubt=(t,e,n)=>dbt(`${t} === '${Jmt}' || ${t} === '${Kmt}'`,e,n),cbt=(t,e,n)=>dbt(`${t} === '${Kmt}'`,e,n),lbt=(t,e,n)=>dbt(`${t} === '${Qmt}'`,e,n),hbt=(t,e,n)=>{return e=null!=e?Lpt(e):e,n=null!=n?Lpt(n):n,fbt(e)&&fbt(n)?(e=e?e.signal||spt(e.value):null,n=n?n.signal||spt(n.value):null,{signal:`${t} ? (${e}) : (${n})`}):[npt({test:t},e)].concat(n||[])},fbt=t=>null==t||1===Object.keys(t).length,dbt=(t,e,n)=>({signal:`${t} ? (${gbt(e)}) : (${gbt(n)})`}),pbt=(t,e,n,r,i)=>({signal:(null!=r?`${t} === '${Jmt}' ? (${gbt(r)}) : `:"")+(null!=n?`${t} === '${tyt}' ? (${gbt(n)}) : `:"")+(null!=i?`${t} === '${Qmt}' ? (${gbt(i)}) : `:"")+(null!=e?`${t} === '${Kmt}' ? (${gbt(e)}) : `:"")+"(null)"}),gbt=t=>Rgt(t)?t.signal:null==t?null:spt(t),mbt=(t,e)=>0===e?0:Rgt(t)?{signal:`(${t.signal}) * ${e}`}:{value:t*e},ybt=(t,e)=>{const n=t.signal;return n&&n.endsWith("(null)")?{signal:n.slice(0,-6)+e.signal}:t};function vbt(t,e,n,r){let i;if(e&&ipt(e,t))return e[t];if(ipt(n,t))return n[t];if(t.startsWith("title")){switch(t){case"titleColor":i="fill";break;case"titleFont":case"titleFontSize":case"titleFontWeight":i=t[5].toLowerCase()+t.slice(6)}return r[dyt][i]}if(t.startsWith("label")){switch(t){case"labelColor":i="fill";break;case"labelFont":case"labelFontSize":i=t[5].toLowerCase()+t.slice(6)}return r[fyt][i]}return null}function bbt(t){const e={};for(const n of t)if(n)for(const t in n)e[t]=1;return Object.keys(e)}function _bt(t,e){var n,r,i,o=e.config,s=o.style,a=o.axis,u="band"===e.scaleType(t.scale)&&o.axisBand,c=t.orient;if(Rgt(c)){const t=bbt([o.axisX,o.axisY]),e=bbt([o.axisTop,o.axisBottom,o.axisLeft,o.axisRight]);for(i of(n={},t))n[i]=nbt(c,vbt(i,o.axisX,a,s),vbt(i,o.axisY,a,s));for(i of(r={},e))r[i]=pbt(c.signal,vbt(i,o.axisTop,a,s),vbt(i,o.axisBottom,a,s),vbt(i,o.axisLeft,a,s),vbt(i,o.axisRight,a,s))}else n=c===Kmt||c===tyt?o.axisX:o.axisY,r=o["axis"+c[0].toUpperCase()+c.slice(1)];const l=n||r||u?npt({},a,n,r,u):a;return l}function wbt(t,e,n,r){const i=Ryt(t,e),o=t.orient;let s,a;const u={enter:s={opacity:kyt},update:a={opacity:Oyt},exit:{opacity:kyt}};Npt(u,{stroke:i("domainColor"),strokeCap:i("domainCap"),strokeDash:i("domainDash"),strokeDashOffset:i("domainDashOffset"),strokeWidth:i("domainWidth"),strokeOpacity:i("domainOpacity")});const c=xbt(t,0),l=xbt(t,1);return s.x=a.x=nbt(o,c,kyt),s.x2=a.x2=nbt(o,l),s.y=a.y=rbt(o,c,kyt),s.y2=a.y2=rbt(o,l),Vyt({type:Lyt,role:Upt,from:r,encode:u},n)}function xbt(t,e){return{scale:t.scale,range:e}}function Sbt(t,e,n,r,i){const o=Ryt(t,e),s=t.orient,a=t.gridScale,u=ebt(s,1,-1),c=Ebt(t.offset,u);let l,h,f;const d={enter:l={opacity:kyt},update:f={opacity:Oyt},exit:h={opacity:kyt}};Npt(d,{stroke:o("gridColor"),strokeCap:o("gridCap"),strokeDash:o("gridDash"),strokeDashOffset:o("gridDashOffset"),strokeOpacity:o("gridOpacity"),strokeWidth:o("gridWidth")});const p={scale:t.scale,field:hyt,band:i.band,extra:i.extra,offset:i.offset,round:o("tickRound")},g=nbt(s,{signal:"height"},{signal:"width"}),m=a?{scale:a,range:0,mult:u,offset:c}:{value:0,offset:c},y=a?{scale:a,range:1,mult:u,offset:c}:npt(g,{mult:u,offset:c});return l.x=f.x=nbt(s,p,m),l.y=f.y=rbt(s,p,m),l.x2=f.x2=rbt(s,y),l.y2=f.y2=nbt(s,y),h.x=nbt(s,p),h.y=rbt(s,p),Vyt({type:Lyt,role:$pt,key:hyt,from:r,encode:d},n)}function Ebt(t,e){if(1===e);else if(Ydt(t)){let n=t=npt({},t);while(null!=n.mult){if(!Ydt(n.mult))return n.mult=Rgt(e)?{signal:`(${n.mult}) * (${e.signal})`}:n.mult*e,t;n=n.mult=npt({},n.mult)}n.mult=e}else t=Rgt(e)?{signal:`(${e.signal}) * (${t||0})`}:e*(t||0);return t}function Abt(t,e,n,r,i,o){const s=Ryt(t,e),a=t.orient,u=ebt(a,-1,1);let c,l,h;const f={enter:c={opacity:kyt},update:h={opacity:Oyt},exit:l={opacity:kyt}};Npt(f,{stroke:s("tickColor"),strokeCap:s("tickCap"),strokeDash:s("tickDash"),strokeDashOffset:s("tickDashOffset"),strokeOpacity:s("tickOpacity"),strokeWidth:s("tickWidth")});const d=Lpt(i);d.mult=u;const p={scale:t.scale,field:hyt,band:o.band,extra:o.extra,offset:o.offset,round:s("tickRound")};return h.y=c.y=nbt(a,kyt,p),h.y2=c.y2=nbt(a,d),l.x=nbt(a,p),h.x=c.x=rbt(a,kyt,p),h.x2=c.x2=rbt(a,d),l.y=rbt(a,p),Vyt({type:Lyt,role:qpt,key:hyt,from:r,encode:f},n)}function Mbt(t,e,n,r,i){return{signal:'flush(range("'+t+'"), scale("'+t+'", datum.value), '+e+","+n+","+r+","+i+")"}}function Cbt(t,e,n,r,i,o){const s=Ryt(t,e),a=t.orient,u=t.scale,c=ebt(a,-1,1),l=zgt(s("labelFlush")),h=zgt(s("labelFlushOffset")),f=s("labelAlign"),d=s("labelBaseline");let p,g=0===l||!!l;const m=Lpt(i);m.mult=c,m.offset=Lpt(s("labelPadding")||0),m.offset.mult=c;const y={scale:u,field:hyt,band:.5,offset:$yt(o.offset,s("labelOffset"))},v=nbt(a,g?Mbt(u,l,'"left"','"right"','"center"'):{value:"center"},obt(a,"left","right")),b=nbt(a,ibt(a,"bottom","top"),g?Mbt(u,l,'"top"','"bottom"','"middle"'):{value:"middle"}),_=Mbt(u,l,`-(${h})`,h,0);g=g&&h;const w={opacity:kyt,x:nbt(a,y,m),y:rbt(a,y,m)},x={enter:w,update:p={opacity:Oyt,text:{field:ayt},x:w.x,y:w.y,align:v,baseline:b},exit:{opacity:kyt,x:w.x,y:w.y}};Npt(x,{dx:!f&&g?nbt(a,_):null,dy:!d&&g?rbt(a,_):null}),Npt(x,{angle:s("labelAngle"),fill:s("labelColor"),fillOpacity:s("labelOpacity"),font:s("labelFont"),fontSize:s("labelFontSize"),fontWeight:s("labelFontWeight"),fontStyle:s("labelFontStyle"),limit:s("labelLimit"),lineHeight:s("labelLineHeight")},{align:f,baseline:d});const S=s("labelBound");let E=s("labelOverlap");return E=E||S?{separation:s("labelSeparation"),method:E,order:"datum.index",bound:S?{scale:u,orient:a,tolerance:S}:null}:void 0,p.align!==v&&(p.align=ybt(p.align,v)),p.baseline!==b&&(p.baseline=ybt(p.baseline,b)),Vyt({type:Nyt,role:Vpt,style:fyt,key:hyt,from:r,encode:x,overlap:E},n)}function kbt(t,e,n,r){const i=Ryt(t,e),o=t.orient,s=ebt(o,-1,1);let a,u;const c={enter:a={opacity:kyt,anchor:Lpt(i("titleAnchor",null)),align:{signal:zyt}},update:u=npt({},a,{opacity:Oyt,text:Lpt(t.title)}),exit:{opacity:kyt}},l={signal:`lerp(range("${t.scale}"), ${jyt(0,1,.5)})`};return u.x=nbt(o,l),u.y=rbt(o,l),a.angle=nbt(o,kyt,mbt(s,90)),a.baseline=nbt(o,ibt(o,tyt,Kmt),{value:tyt}),u.angle=a.angle,u.baseline=a.baseline,Npt(c,{fill:i("titleColor"),fillOpacity:i("titleOpacity"),font:i("titleFont"),fontSize:i("titleFontSize"),fontStyle:i("titleFontStyle"),fontWeight:i("titleFontWeight"),limit:i("titleLimit"),lineHeight:i("titleLineHeight")},{align:i("titleAlign"),angle:i("titleAngle"),baseline:i("titleBaseline")}),Obt(i,o,c,n),c.update.align=ybt(c.update.align,a.align),c.update.angle=ybt(c.update.angle,a.angle),c.update.baseline=ybt(c.update.baseline,a.baseline),Vyt({type:Nyt,role:Wpt,style:dyt,from:r,encode:c},n)}function Obt(t,e,n,r){const i=(t,e)=>null!=t?(n.update[e]=ybt(Lpt(t),n.update[e]),!1):!Rpt(e,r),o=i(t("titleX"),"x"),s=i(t("titleY"),"y");n.enter.auto=s===o?Lpt(s):nbt(e,Lpt(s),Lpt(o))}function Pbt(t,e){const n=_bt(t,e),r=t.encode||{},i=r.axis||{},o=i.name||void 0,s=i.interactive,a=i.style,u=Ryt(t,n),c=Uyt(u),l={scale:t.scale,ticks:!!u("ticks"),labels:!!u("labels"),grid:!!u("grid"),domain:!!u("domain"),title:null!=t.title},h=Agt(e.add(imt({},[l]))),f=Agt(e.add(nmt({scale:e.scaleRef(t.scale),extra:e.property(c.extra),count:e.objectProperty(t.tickCount),values:e.objectProperty(t.values),minstep:e.property(t.tickMinStep),formatType:e.property(t.formatType),formatSpecifier:e.property(t.format)}))),d=[];let p;return l.grid&&d.push(Sbt(t,n,r.grid,f,c)),l.ticks&&(p=u("tickSize"),d.push(Abt(t,n,r.ticks,f,p,c))),l.labels&&(p=l.ticks?p:0,d.push(Cbt(t,n,r.labels,f,p,c))),l.domain&&d.push(wbt(t,n,r.domain,h)),l.title&&d.push(kbt(t,n,r.title,h)),Dvt(Dyt({role:zpt,from:h,encode:Dpt(Tbt(u,t),i,Cyt),marks:d,aria:u("aria"),description:u("description"),zindex:u("zindex"),name:o,interactive:s,style:a}),e)}function Tbt(t,e){const n={enter:{},update:{}};return Npt(n,{orient:t("orient"),offset:t("offset")||0,position:jgt(e.position,0),titlePadding:t("titlePadding"),minExtent:t("minExtent"),maxExtent:t("maxExtent"),range:{signal:`abs(span(range("${e.scale}")))`},translate:t("translate"),format:e.format,formatType:e.formatType}),n}function Lbt(t,e,n){const r=ept(t.signals),i=ept(t.scales);return n||r.forEach(t=>wgt(t,e)),ept(t.projections).forEach(t=>Ymt(t,e)),i.forEach(t=>Tmt(t,e)),ept(t.data).forEach(t=>Zvt(t,e)),i.forEach(t=>Lmt(t,e)),(n||r).forEach(t=>Qgt(t,e)),ept(t.axes).forEach(t=>Pbt(t,e)),ept(t.marks).forEach(t=>Dvt(t,e)),ept(t.legends).forEach(t=>Fvt(t,e)),t.title&&Wvt(t.title,e),e.parseLambdas(),e}const Ibt=t=>Dpt({enter:{x:{value:0},y:{value:0}},update:{width:{signal:"width"},height:{signal:"height"}}},t);function Nbt(t,e){const n=e.config,r=Agt(e.root=e.add(Egt())),i=Rbt(t,n);i.forEach(t=>wgt(t,e)),e.description=t.description||n.description,e.eventConfig=n.events,e.legends=e.objectProperty(n.legend&&n.legend.layout),e.locale=n.locale;const o=e.add(imt()),s=e.add(amt(pgt(Ibt(t.encode),Pyt,Bpt,t.style,e,{pulse:Agt(o)}))),a=e.add(Cmt({layout:e.objectProperty(t.layout),legends:e.legends,autosize:e.signalRef("autosize"),mark:r,pulse:Agt(s)}));e.operators.pop(),e.pushState(Agt(s),Agt(a),null),Lbt(t,e,i),e.operators.push(a);let u=e.add(rmt({mark:r,pulse:Agt(a)}));return u=e.add(Smt({pulse:Agt(u)})),u=e.add(Amt({pulse:Agt(u)})),e.addData("root",new kvt(e,o,o,u)),e}function Dbt(t,e){return e&&e.signal?{name:t,update:e.signal}:{name:t,value:e}}function Rbt(t,e){const n=n=>jgt(t[n],e[n]),r=[Dbt("background",n("background")),Dbt("autosize",kpt(n("autosize"))),Dbt("padding",Tpt(n("padding"))),Dbt("width",n("width")||0),Dbt("height",n("height")||0)],i=r.reduce((t,e)=>(t[e.name]=e,t),{}),o={};return ept(t.signals).forEach(t=>{ipt(i,t.name)?t=npt(i[t.name],t):r.push(t),o[t.name]=t}),ept(e.signals).forEach(t=>{ipt(o,t.name)||ipt(i,t.name)||r.push(t)}),r}function Fbt(t,e){this.config=t||{},this.options=e||{},this.bindings=[],this.field={},this.signals={},this.lambdas={},this.scales={},this.events={},this.data={},this.streams=[],this.updates=[],this.operators=[],this.eventConfig=null,this.locale=null,this._id=0,this._subid=0,this._nextsub=[0],this._parent=[],this._encode=[],this._lookup=[],this._markpath=[]}function Bbt(t){this.config=t.config,this.options=t.options,this.legends=t.legends,this.field=Object.create(t.field),this.signals=Object.create(t.signals),this.lambdas=Object.create(t.lambdas),this.scales=Object.create(t.scales),this.events=Object.create(t.events),this.data=Object.create(t.data),this.streams=[],this.updates=[],this.operators=[],this._id=0,this._subid=++t._nextsub[0],this._nextsub=t._nextsub,this._parent=t._parent.slice(),this._encode=t._encode.slice(),this._lookup=t._lookup.slice(),this._markpath=t._markpath}function jbt(t){return(Xdt(t)?zbt:Ubt)(t)}function zbt(t){const e=t.length;let n="[";for(let r=0;r<e;++r){const e=t[r];n+=(r>0?",":"")+(Ydt(e)?e.signal||jbt(e):spt(e))}return n+"]"}function Ubt(t){let e,n,r="{",i=0;for(e in t)n=t[e],r+=(++i>1?",":"")+spt(e)+":"+(Ydt(n)?n.signal||jbt(n):spt(n));return r+"}"}function $bt(){const t="sans-serif",e=30,n=2,r="#4c78a8",i="#000",o="#888",s="#ddd";return{description:"Vega visualization",padding:0,autosize:"pad",background:null,events:{defaults:{allow:["wheel"]}},group:null,mark:null,arc:{fill:r},area:{fill:r},image:null,line:{stroke:r,strokeWidth:n},path:{stroke:r},rect:{fill:r},rule:{stroke:i},shape:{stroke:r},symbol:{fill:r,size:64},text:{fill:i,font:t,fontSize:11},trail:{fill:r,size:n},style:{"guide-label":{fill:i,font:t,fontSize:10},"guide-title":{fill:i,font:t,fontSize:11,fontWeight:"bold"},"group-title":{fill:i,font:t,fontSize:13,fontWeight:"bold"},"group-subtitle":{fill:i,font:t,fontSize:12},point:{size:e,strokeWidth:n,shape:"circle"},circle:{size:e,strokeWidth:n},square:{size:e,strokeWidth:n,shape:"square"},cell:{fill:"transparent",stroke:s}},title:{orient:"top",anchor:"middle",offset:4,subtitlePadding:3},axis:{minExtent:0,maxExtent:200,bandPosition:.5,domain:!0,domainWidth:1,domainColor:o,grid:!1,gridWidth:1,gridColor:s,labels:!0,labelAngle:0,labelLimit:180,labelOffset:0,labelPadding:2,ticks:!0,tickColor:o,tickOffset:0,tickRound:!0,tickSize:5,tickWidth:1,titlePadding:4},axisBand:{tickOffset:-.5},projection:{type:"mercator"},legend:{orient:"right",padding:0,gridAlign:"each",columnPadding:10,rowPadding:2,symbolDirection:"vertical",gradientDirection:"vertical",gradientLength:200,gradientThickness:16,gradientStrokeColor:s,gradientStrokeWidth:0,gradientLabelOffset:2,labelAlign:"left",labelBaseline:"middle",labelLimit:160,labelOffset:4,labelOverlap:!0,symbolLimit:30,symbolType:"circle",symbolSize:100,symbolOffset:0,symbolStrokeWidth:1.5,symbolBaseFillColor:"transparent",symbolBaseStrokeColor:o,titleLimit:180,titleOrient:"top",titlePadding:5,layout:{offset:18,direction:"horizontal",left:{direction:"vertical"},right:{direction:"vertical"}}},range:{category:{scheme:"tableau10"},ordinal:{scheme:"blues"},heatmap:{scheme:"yellowgreenblue"},ramp:{scheme:"blues"},diverging:{scheme:"blueorange",extent:[1,0]},symbol:["circle","square","triangle-up","cross","diamond","triangle-right","triangle-down","triangle-left"]}}}function Vbt(t,e,n){return Ydt(t)||Wdt("Input Vega specification must be an object."),e=Kdt($bt(),e,t.config),Nbt(t,new Fbt(e,n)).toRuntime()}Fbt.prototype=Bbt.prototype={parse(t){return Lbt(t,this)},fork(){return new Bbt(this)},isSubscope(){return this._subid>0},toRuntime(){return this.finish(),{description:this.description,operators:this.operators,streams:this.streams,updates:this.updates,bindings:this.bindings,eventConfig:this.eventConfig,locale:this.locale}},id(){return(this._subid?this._subid+":":0)+this._id++},add(t){return this.operators.push(t),t.id=this.id(),t.refs&&(t.refs.forEach(e=>{e.$ref=t.id}),t.refs=null),t},proxy(t){const e=t instanceof xgt?Agt(t):t;return this.add(wmt({value:e}))},addStream(t){return this.streams.push(t),t.id=this.id(),t},addUpdate(t){return this.updates.push(t),t},finish(){let t,e;for(t in this.root&&(this.root.root=!0),this.signals)this.signals[t].signal=t;for(t in this.scales)this.scales[t].scale=t;function n(t,e,n){let r,i;t&&(r=t.data||(t.data={}),i=r[e]||(r[e]=[]),i.push(n))}for(t in this.data){e=this.data[t],n(e.input,t,"input"),n(e.output,t,"output"),n(e.values,t,"values");for(const r in e.index)n(e.index[r],t,"index:"+r)}return this},pushState(t,e,n){this._encode.push(Agt(this.add(Amt({pulse:t})))),this._parent.push(e),this._lookup.push(n?Agt(this.proxy(n)):null),this._markpath.push(-1)},popState(){this._encode.pop(),this._parent.pop(),this._lookup.pop(),this._markpath.pop()},parent(){return tpt(this._parent)},encode(){return tpt(this._encode)},lookup(){return tpt(this._lookup)},markpath(){const t=this._markpath;return++t[t.length-1]},fieldRef(t,e){if(opt(t))return Mgt(t,e);t.signal||Wdt("Unsupported field reference: "+spt(t));const n=t.signal;let r=this.field[n];if(!r){const t={name:this.signalRef(n)};e&&(t.as=e),this.field[n]=r=Agt(this.add(lmt(t)))}return r},compareRef(t){let e=!1;const n=t=>Rgt(t)?(e=!0,this.signalRef(t.signal)):Fgt(t)?(e=!0,this.exprRef(t.expr)):t,r=ept(t.field).map(n),i=ept(t.order).map(n);return e?Agt(this.add(omt({fields:r,orders:i}))):kgt(r,i)},keyRef(t,e){let n=!1;const r=t=>Rgt(t)?(n=!0,Agt(i[t.signal])):t,i=this.signals;return t=ept(t).map(r),n?Agt(this.add(hmt({fields:t,flat:e}))):Ogt(t,e)},sortRef(t){if(!t)return t;const e=Igt(t.op,t.field),n=t.order||Pgt;return n.signal?Agt(this.add(omt({fields:e,orders:this.signalRef(n.signal)}))):kgt(e,n)},event(t,e){const n=t+":"+e;if(!this.events[n]){const r=this.id();this.streams.push({id:r,source:t,type:e}),this.events[n]=r}return this.events[n]},hasOwnSignal(t){return ipt(this.signals,t)},addSignal(t,e){this.hasOwnSignal(t)&&Wdt("Duplicate signal name: "+spt(t));const n=e instanceof xgt?e:this.add(Egt(e));return this.signals[t]=n},getSignal(t){return this.signals[t]||Wdt("Unrecognized signal name: "+spt(t)),this.signals[t]},signalRef(t){return this.signals[t]?Agt(this.signals[t]):(ipt(this.lambdas,t)||(this.lambdas[t]=this.add(Egt(null))),Agt(this.lambdas[t]))},parseLambdas(){const t=Object.keys(this.lambdas);for(let e=0,n=t.length;e<n;++e){const n=t[e],r=aht(n,this),i=this.lambdas[n];i.params=r.$params,i.update=r.$expr}},property(t){return t&&t.signal?this.signalRef(t.signal):t},objectProperty(t){return t&&Ydt(t)?this.signalRef(t.signal||jbt(t)):t},exprRef(t,e){const n={expr:aht(t,this)};return e&&(n.expr.$name=e),Agt(this.add(umt(n)))},addBinding(t,e){this.bindings||Wdt("Nested signals do not support binding: "+spt(t)),this.bindings.push(npt({signal:t},e))},addScaleProj(t,e){ipt(this.scales,t)&&Wdt("Duplicate scale or projection name: "+spt(t)),this.scales[t]=this.add(e)},addScale(t,e){this.addScaleProj(t,Emt(e))},addProjection(t,e){this.addScaleProj(t,_mt(e))},getScale(t){return this.scales[t]||Wdt("Unrecognized scale name: "+spt(t)),this.scales[t]},scaleRef(t){return Agt(this.getScale(t))},scaleType(t){return this.getScale(t).params.type},projectionRef(t){return this.scaleRef(t)},projectionType(t){return this.scaleType(t)},addData(t,e){return ipt(this.data,t)&&Wdt("Duplicate data set name: "+spt(t)),this.data[t]=e},getData(t){return this.data[t]||Wdt("Undefined data set name: "+spt(t)),this.data[t]},addDataPipeline(t,e){return ipt(this.data,t)&&Wdt("Duplicate data set name: "+spt(t)),this.addData(t,kvt.fromEntries(this,e))}};var qbt="vega",Wbt="5.21.0",Gbt="The Vega visualization grammar.",Hbt=["vega","visualization","interaction","dataflow","library","data","d3"],Xbt="BSD-3-Clause",Ybt="UW Interactive Data Lab (http://idl.cs.washington.edu)",Zbt="build/vega-node.js",Kbt="build/vega.module.js",Jbt="build/vega.min.js",Qbt="build/vega.min.js",t_t="index.d.ts",e_t="vega/vega",n_t={bundle:"rollup -c --config-bundle",prebuild:"rimraf build && rimraf build-es5",build:"rollup -c --config-core --config-bundle --config-ie",postbuild:"node schema-copy",pretest:"yarn build --config-test",test:"TZ=America/Los_Angeles tape 'test/**/*-test.js'",prepublishOnly:"yarn test && yarn build",postpublish:"./schema-deploy.sh"},r_t={"vega-crossfilter":"~4.0.5","vega-dataflow":"~5.7.4","vega-encode":"~4.8.3","vega-event-selector":"~3.0.0","vega-expression":"~5.0.0","vega-force":"~4.0.7","vega-format":"~1.0.4","vega-functions":"~5.12.1","vega-geo":"~4.3.8","vega-hierarchy":"~4.0.9","vega-label":"~1.1.0","vega-loader":"~4.4.1","vega-parser":"~6.1.4","vega-projection":"~1.4.5","vega-regression":"~1.0.9","vega-runtime":"~6.1.3","vega-scale":"~7.1.1","vega-scenegraph":"~4.9.4","vega-statistics":"~1.7.10","vega-time":"~2.0.4","vega-transforms":"~4.9.4","vega-typings":"~0.22.0","vega-util":"~1.17.0","vega-view":"~5.10.1","vega-view-transforms":"~4.5.8","vega-voronoi":"~4.1.5","vega-wordcloud":"~4.1.3"},i_t={"vega-schema":"*"},o_t="774165e29850b66ec8b79ba52a7955f1ab936ea6",s_t={name:qbt,version:Wbt,description:Gbt,keywords:Hbt,license:Xbt,author:Ybt,main:Zbt,module:Kbt,unpkg:Jbt,jsdelivr:Qbt,types:t_t,repository:e_t,scripts:n_t,dependencies:r_t,devDependencies:i_t,gitHead:o_t};AC(QO,s,u,c,l,h,d,f,p,g,m,y);const a_t=s_t.version;var u_t=n("9891");u_t["a"].use(v,r,i,o);var c_t,l_t,h_t={},f_t={data:function(){return{Interval:"",anchor:0,loadDataLength:0,loadArray:[]}},created:function(){this.preProcess()},mounted:function(){var t=this;this.initTable(),this.init(),this.Interval=setInterval((function(){t.change()}),5e3)},methods:{init:function(){h_t.viewer=new u_t["a"].Viewer(document.getElementById("sanddance"),{hideSidebarControls:!0}),h_t.viewer.options.colors.axisLine=[255,255,255,255],h_t.viewer.options.colors.axisText=[255,255,255,255],h_t.viewer.options.colors.hoveredCube=[255,255,255,255];var t=h_t.viewer.presenter.getElement(u_t["a"].VegaDeckGl.PresenterElement.gl);c_t={colorBin:"quantize",columns:{color:"Vpu",sort:"FreqHz",uid:"Id",x:"Longitude",y:"Latitude",z:"LoadMW",size:"LoadMW",group:"GenMW"},facets:null,hideLegend:!1,signaValues:null,view:"2d",scheme:"redblue",size:{height:t.offsetHeight,width:t.offsetWidth},chart:"scatterplot"},h_t.viewer.render(c_t,l_t)},change:function(){this.updateTable(),"barchartV"==c_t["chart"]?c_t["chart"]="density":"scatterplot"==c_t["chart"]?c_t["chart"]="barchartV":"density"==c_t["chart"]&&(c_t["chart"]="scatterplot"),h_t.viewer.render(c_t,l_t)},preProcess:function(){var t,e,n=0;for(var r in this.$store.state.fieldstore){if(t=this.$store.state.fieldstore[r]["Field"].length,e=Object.keys(this.$store.state.areadetail.content[r]),"Bus"==r)break;n+=t*e.length}this.anchor=n,this.loadDataLength=t},initTable:function(){var t,e=[],n=0;for(var r in this.$store.state.areadetail.content.Bus)this.$store.state.areadetail.content.Bus[r]["Int.Area Number"]==+this.$store.state.area&&(this.loadArray.push(n),t=this.$store.state.areadetail.content.Bus[r]["Int.Sub Number"],e.push({Id:r,"Symbol(vega_id)":r,Latitude:this.$store.state.areadetail.content.Substation[t.toString()]["Double.Latitude"],Longitude:this.$store.state.areadetail.content.Substation[t.toString()]["Double.Longitude"],name:this.$store.state.areadetail.content.Bus[r.split(",")[0]]["String.Name"]+" "+r.split(",")[1],Status:1,Vpu:1,FreqHz:60,GenMW:0,GenMvar:0,LoadMW:0})),n++;return l_t=e,l_t.length>1?Promise.resolve("Table initialized properly"):Promise.reject("Error in initialization")},updateTable:function(){try{var t=this.$store.state.parsedData;for(var e in l_t)l_t[e].Vpu=t[this.anchor+this.loadArray[e]*this.loadDataLength],l_t[e].Vangle=t[this.anchor+1+this.loadArray[e]*this.loadDataLength],l_t[e].FreqHz=t[this.anchor+2+this.loadArray[e]*this.loadDataLength],l_t[e].Status=t[this.anchor+3+this.loadArray[e]*this.loadDataLength],l_t[e].GenMW=t[this.anchor+4+this.loadArray[e]*this.loadDataLength],l_t[e].GenMvar=t[this.anchor+5+this.loadArray[e]*this.loadDataLength],l_t[e].LoadMW=t[this.anchor+6+this.loadArray[e]*this.loadDataLength]}catch(n){console.log("The raw data are not ready")}}},beforeDestroy:function(){clearInterval(this.Interval)}},d_t=f_t,p_t=(n("a303"),Object(P["a"])(d_t,$e,Ve,!1,null,null,null)),g_t=p_t.exports,m_t=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("barPlot")],1)},y_t=[],v_t=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-container",{attrs:{"grid-list-xl":"","text-xs-center":"",fluid:""}},[n("v-layout",{attrs:{row:"",wrap:""}},[n("v-flex",{attrs:{lg12:"",sm12:"",xs12:""}},[n("v-chart",{attrs:{option:t.genBar,theme:t.theme,autoresize:""}})],1)],1)],1)},b_t=[],__t=n("5c7f"),w_t={components:{"v-chart":__t["a"]},data:function(){return{theme:"dark",genXaxis:[],genYaxis:[],maxGen:[]}},methods:{initGenPlot:function(){for(var t in this.$store.state.genData)this.genXaxis.push(this.$store.state.genData[t]["name"]),this.genYaxis.push(this.$store.state.genData[t]["MW"]),this.maxGen.push(this.$store.state.genData[t]["MWMax"])},updateGenPlot:function(){try{var t=[];for(var e in this.$store.state.genData)t.push(this.$store.state.genData[e]["MW"]),this.genYaxis=t}catch(n){console.log(n)}}},mounted:function(){var t=this;this.initGenPlot(),this.Process=setInterval((function(){t.updateGenPlot()}),1e3)},beforeDestroy:function(){clearInterval(this.Process)},computed:{genBar:function(){return{title:{text:"Current Generation",left:"center",textStyle:{fontSize:48}},grid:{right:"3%",left:"3%",bottom:100},xAxis:{type:"category",data:this.genXaxis,axisLabel:{rotate:90,inside:!0,fontWeight:"bold",fontSize:16},z:3},yAxis:{type:"value",axisLine:{show:!1}},tooltip:{trigger:"axis"},series:[{name:"Current Generation",data:this.genYaxis,type:"bar"},{name:"Maximum Generation",data:this.maxGen,type:"bar",itemStyle:{normal:{color:"none",borderColor:"#ddd",borderWidth:3,barBorderRadius:0}},barGap:"-100%",barCategoryGap:"40%"}]}}}},x_t=w_t,S_t=(n("3bd4"),Object(P["a"])(x_t,v_t,b_t,!1,null,null,null)),E_t=S_t.exports,A_t={name:"vis",components:{barPlot:E_t}},M_t=A_t,C_t=(n("f717"),Object(P["a"])(M_t,m_t,y_t,!1,null,null,null)),k_t=C_t.exports,O_t=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("genPie")],1)},P_t=[],T_t=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-container",{attrs:{"grid-list-xl":"","text-xs-center":"",fluid:""}},[n("v-layout",{attrs:{row:"",wrap:""}},[n("v-flex",{attrs:{lg6:"",sm12:"",xs12:""}},[n("pieDistribute",{attrs:{areatotal:t.areaData[0]}})],1),n("v-flex",{attrs:{lg6:"",sm12:"",xs12:""}},[n("v-chart",{attrs:{option:t.genPie,theme:t.theme,autoresize:""}})],1)],1)],1)},L_t=[],I_t=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"chartdiv",attrs:{id:"pie"}})},N_t=[],D_t={props:{areatotal:Number},data:function(){return{chart:"",anchor:0,genDataLength:0,color:H.a,Process:null}},methods:{preProcess:function(){var t,e,n=0;for(var r in this.$store.state.fieldstore){if(t=this.$store.state.fieldstore[r]["Field"].length,e=Object.keys(this.$store.state.areadetail.content[r]),"Gen"==r)break;n+=t*e.length}this.anchor=n,this.genDataLength=t},initdraw:function(){this.chart=j["e"](document.getElementById("pie"),"dark"),this.chart.setOption({title:{text:"Area Generation Overview",textStyle:{fontSize:24},x:"center"},legend:{bottom:20},color:[this.color.lightBlue.base,this.color.indigo.base,this.color.pink.base],series:[{id:"pie",type:"pie",center:["50%","50%"],radius:["30%","60%"],selectedMode:"single",label:{position:"outside",formatter:"{a|{b}}\n{hr|}\n{c|{c} MW}\n{hr|}\n{per|{d}%}{abg|}",backgroundColor:"#eee",borderColor:"#aaa",borderWidth:1,borderRadius:4,rich:{a:{color:"#000",lineHeight:22,align:"center"},abg:{backgroundColor:"#333",width:"100%",align:"right",height:15,borderRadius:[0,0,4,4]},hr:{borderColor:"#aaa",width:"100%",borderWidth:.5,height:0},b:{fontSize:16,lineHeight:33},c:{color:"#999",lineHeight:20,align:"center"},per:{color:"#eee",align:"center"}}},labelLine:{show:!0},data:[],itemStyle:{emphasis:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]})},updateData:function(){try{this.chart.setOption({series:{id:"pie",data:[{value:Math.round(this.areatotal),name:"Current Generation"},{value:this.$store.state.genStat[0],name:"Online Capacity"},{value:Math.round(this.$store.state.genStat[1]),name:"Offline Capacity"}]}})}catch(t){console.log(t)}},resizeChart:function(){var t=this;window.onresize=function(){t.chart&&t.chart.resize()}}},created:function(){},mounted:function(){var t=this;this.initdraw(),this.preProcess(),this.resizeChart(),this.Process=setInterval((function(){t.updateData()}),1e3)},beforeDestroy:function(){clearInterval(this.Process),this.chart.clear()}},R_t=D_t,F_t=(n("3d96"),Object(P["a"])(R_t,I_t,N_t,!1,null,"053953a8",null)),B_t=F_t.exports,j_t={components:{"v-chart":__t["a"],pieDistribute:B_t},data:function(){return{theme:"dark",genName:[],genVal:[]}},methods:{initGenPlot:function(){for(var t in console.log(this.$store.state),this.$store.state.genData)this.genName.push(this.$store.state.genData[t]["name"]),this.genVal.push({name:this.$store.state.genData[t]["name"],value:this.$store.state.genData[t]["MW"]})},updateGenPlot:function(){try{var t=[];for(var e in this.$store.state.genData)this.genName.push(this.$store.state.genData[e]["name"]),t.push({name:this.$store.state.genData[e]["name"],value:this.$store.state.genData[e]["MW"]}),this.genVal=t}catch(n){console.log(n)}}},mounted:function(){var t=this;this.initGenPlot(),this.Process=setInterval((function(){t.updateGenPlot()}),1e3)},computed:Object(x["a"])(Object(x["a"])({},Object(C["c"])(["areaData"])),{},{genPie:function(){return{title:{text:"Current Generation Distribution (By Generator)",textStyle:{fontSize:24},x:"center"},grid:{right:"3%",left:"3%",bottom:100},tooltip:{trigger:"item",formatter:"{a} <br/>{b} : {c} ({d}%)"},legend:{type:"scroll",orient:"horizontal",bottom:20,data:this.genName},series:[{name:"Current Generation",data:this.genVal,type:"pie"}]}}}),beforeDestroy:function(){clearInterval(this.Process)}},z_t=j_t,U_t=(n("43eb"),Object(P["a"])(z_t,T_t,L_t,!1,null,null,null)),$_t=U_t.exports,V_t={components:{genPie:$_t}},q_t=V_t,W_t=(n("7ab7"),Object(P["a"])(q_t,O_t,P_t,!1,null,null,null)),G_t=W_t.exports,H_t=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-container",{attrs:{"fill-height":"",fluid:"","grid-list-xl":""}},[n("v-layout",{attrs:{wrap:""}},[n("v-flex",{attrs:{lg6:"",xs12:""}},[n("v-card",{attrs:{color:"rgb(255, 255, 255, 0.3)",height:"85",raised:""}},[n("div",{staticClass:"display-3 font-weight-bold",attrs:{align:"center"}},[n("v-icon",{attrs:{size:"65"}},[t._v("mdi-clock-outline")]),t._v("System Date and Time ")],1)])],1),n("v-flex",{attrs:{lg6:"",xs12:""}},[n("v-card",{attrs:{color:"rgb(255, 255, 255, 0.3)",height:"85",raised:""}},[n("div",{staticClass:"display-3 font-weight-bold",attrs:{align:"center"}},[t._v("November 29, 2018 at "+t._s(t.clockTime))])])],1),n("v-flex",{attrs:{lg6:"",xs12:""}},[n("v-card",{attrs:{color:"rgb(0, 255, 0, 0.3)",height:"85",raised:""}},[n("div",{staticClass:"display-3 font-weight-bold",attrs:{align:"center"}},[n("v-icon",{attrs:{size:"65"}},[t._v("mdi-current-ac")]),t._v("Area Frequency ")],1)])],1),n("v-flex",{attrs:{lg6:"",xs12:""}},[n("v-card",{attrs:{color:"rgb(0, 255, 0, 0.3)",height:"85",raised:""}},[n("div",{staticClass:"display-3 font-weight-bold",attrs:{align:"center"}},[t._v(t._s(t.areaData[6])+" Hz")])])],1),n("v-flex",{attrs:{lg6:"",xs12:""}},[n("v-card",{attrs:{color:"rgb(0, 0, 255, 0.6)",height:"85",raised:""}},[n("div",{staticClass:"display-3 font-weight-bold",attrs:{align:"center"}},[n("v-icon",{attrs:{size:"65"}},[t._v("mdi-battery")]),t._v("Area Generation ")],1)])],1),n("v-flex",{attrs:{lg6:"",xs12:""}},[n("v-card",{attrs:{color:"rgb(0, 0, 255, 0.6)",height:"85",raised:""}},[n("div",{staticClass:"display-3 font-weight-bold",attrs:{align:"center"}},[t._v(t._s(t.areaData[0])+" MW")])])],1),n("v-flex",{attrs:{lg6:"",xs12:""}},[n("v-card",{attrs:{color:"rgb(255, 255, 0, 0.8)",height:"85",raised:""}},[n("div",{staticClass:"display-3 font-weight-bold",attrs:{align:"center"}},[n("v-icon",{attrs:{size:"65"}},[t._v("mdi-flash")]),t._v("Area Load ")],1)])],1),n("v-flex",{attrs:{lg6:"",xs12:""}},[n("v-card",{attrs:{color:"rgb(255, 255, 0, 0.8)",height:"85",raised:""}},[n("div",{staticClass:"display-3 font-weight-bold",attrs:{align:"center"}},[t._v(t._s(t.areaData[2])+" MW")])])],1),n("v-flex",{attrs:{lg6:"",xs12:""}},[n("v-card",{attrs:{color:"rgb(0, 255, 127, 0.8)",height:"85",raised:""}},[n("div",{staticClass:"display-3 font-weight-bold",attrs:{align:"center"}},[n("v-icon",{attrs:{size:"65"}},[t._v("mdi-cash-usd-outline")]),t._v("Total Cost ")],1)])],1),n("v-flex",{attrs:{lg6:"",xs12:""}},[n("v-card",{attrs:{color:"rgb(0, 255, 127, 0.8)",height:"85",raised:""}},[n("div",{staticClass:"display-3 font-weight-bold",attrs:{align:"center"}},[t._v("$"+t._s(t.totalCost))])])],1),n("v-flex",{attrs:{lg6:"",xs12:""}},[n("v-card",{attrs:{color:"rgb(255, 127, 80)",height:"85",raised:""}},[n("div",{staticClass:"display-3 font-weight-bold",attrs:{align:"center"}},[n("v-icon",{attrs:{size:"65"}},[t._v("mdi-send")]),t._v("Export Power ")],1)])],1),n("v-flex",{attrs:{lg6:"",xs12:""}},[n("v-card",{attrs:{color:"rgb(255, 127, 80)",height:"85",raised:""}},[n("div",{staticClass:"display-3 font-weight-bold",attrs:{align:"center"}},[t._v(t._s(t.areaData[5])+" MW")])])],1),n("v-flex",{attrs:{lg12:""}},[n("barPlot")],1)],1)],1)},X_t=[],Y_t={components:{barPlot:E_t},computed:Object(x["a"])({},Object(C["c"])(["clockTime","areaData","totalCost"]))},Z_t=Y_t,K_t=Object(P["a"])(Z_t,H_t,X_t,!1,null,null,null),J_t=K_t.exports,Q_t=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[t.chatShow?n("chatpop",{attrs:{visible:t.chatShow,topic:t.chatTopic},on:{close:function(e){t.chatShow=!1}}}):t._e(),t.lineshowDialog?n("linepop",{attrs:{visible:t.lineshowDialog,type:t.type,id:t.id,name:t.name},on:{close:function(e){t.lineshowDialog=!1}}}):t._e(),t.subshowDialog?n("subpop",{attrs:{visible:t.subshowDialog,children:t.children,type:t.type,id:t.id,name:t.name},on:{close:function(e){t.subshowDialog=!1}}}):t._e()],1)},twt=[],ewt=(n("99af"),n("e9c4"),n("7db0"),n("6e8e")),nwt=n.n(ewt),rwt=n("e813"),iwt=n.n(rwt),owt=n("2685"),swt=n.n(owt);function awt(t){return(t<0?"-":"")+"0x"+Math.abs(t).toString(16).padStart(2,"0")}var uwt=function(){function t(t,e){this.type=t,this.data=e}return t}(),cwt=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),lwt=function(t){function e(n){var r=t.call(this,n)||this,i=Object.create(e.prototype);return Object.setPrototypeOf(r,i),Object.defineProperty(r,"name",{configurable:!0,enumerable:!1,value:e.name}),r}return cwt(e,t),e}(Error),hwt=n("7ac2"),fwt=-1,dwt=4294967295,pwt=17179869183;function gwt(t){var e=t.sec,n=t.nsec;if(e>=0&&n>=0&&e<=pwt){if(0===n&&e<=dwt){var r=new Uint8Array(4),i=new DataView(r.buffer);return i.setUint32(0,e),r}var o=e/4294967296,s=4294967295&e;r=new Uint8Array(8),i=new DataView(r.buffer);return i.setUint32(0,n<<2|3&o),i.setUint32(4,s),r}r=new Uint8Array(12),i=new DataView(r.buffer);return i.setUint32(0,n),Object(hwt["d"])(i,4,e),r}function mwt(t){var e=t.getTime(),n=Math.floor(e/1e3),r=1e6*(e-1e3*n),i=Math.floor(r/1e9);return{sec:n+i,nsec:r-1e9*i}}function ywt(t){if(t instanceof Date){var e=mwt(t);return gwt(e)}return null}function vwt(t){var e=new DataView(t.buffer,t.byteOffset,t.byteLength);switch(t.byteLength){case 4:var n=e.getUint32(0),r=0;return{sec:n,nsec:r};case 8:var i=e.getUint32(0),o=e.getUint32(4);n=4294967296*(3&i)+o,r=i>>>2;return{sec:n,nsec:r};case 12:n=Object(hwt["b"])(e,4),r=e.getUint32(0);return{sec:n,nsec:r};default:throw new lwt("Unrecognized data size for timestamp (expected 4, 8, or 12): "+t.length)}}function bwt(t){var e=vwt(t);return new Date(1e3*e.sec+e.nsec/1e6)}var _wt={type:fwt,encode:ywt,decode:bwt},wwt=function(){function t(){this.builtInEncoders=[],this.builtInDecoders=[],this.encoders=[],this.decoders=[],this.register(_wt)}return t.prototype.register=function(t){var e=t.type,n=t.encode,r=t.decode;if(e>=0)this.encoders[e]=n,this.decoders[e]=r;else{var i=1+e;this.builtInEncoders[i]=n,this.builtInDecoders[i]=r}},t.prototype.tryToEncode=function(t,e){for(var n=0;n<this.builtInEncoders.length;n++){var r=this.builtInEncoders[n];if(null!=r){var i=r(t,e);if(null!=i){var o=-1-n;return new uwt(o,i)}}}for(n=0;n<this.encoders.length;n++){r=this.encoders[n];if(null!=r){i=r(t,e);if(null!=i){o=n;return new uwt(o,i)}}}return t instanceof uwt?t:null},t.prototype.decode=function(t,e,n){var r=e<0?this.builtInDecoders[-1-e]:this.decoders[e];return r?r(t,e,n):new uwt(e,t)},t.defaultCodec=new t,t}(),xwt=n("13b9");function Swt(t){return t instanceof Uint8Array?t:ArrayBuffer.isView(t)?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t instanceof ArrayBuffer?new Uint8Array(t):Uint8Array.from(t)}function Ewt(t){if(t instanceof ArrayBuffer)return new DataView(t);var e=Swt(t);return new DataView(e.buffer,e.byteOffset,e.byteLength)}var Awt=16,Mwt=16,Cwt=function(){function t(t,e){void 0===t&&(t=Awt),void 0===e&&(e=Mwt),this.maxKeyLength=t,this.maxLengthPerKey=e,this.hit=0,this.miss=0,this.caches=[];for(var n=0;n<this.maxKeyLength;n++)this.caches.push([])}return t.prototype.canBeCached=function(t){return t>0&&t<=this.maxKeyLength},t.prototype.find=function(t,e,n){var r=this.caches[n-1];t:for(var i=0,o=r;i<o.length;i++){for(var s=o[i],a=s.bytes,u=0;u<n;u++)if(a[u]!==t[e+u])continue t;return s.str}return null},t.prototype.store=function(t,e){var n=this.caches[t.length-1],r={bytes:t,str:e};n.length>=this.maxLengthPerKey?n[Math.random()*n.length|0]=r:n.push(r)},t.prototype.decode=function(t,e,n){var r=this.find(t,e,n);if(null!=r)return this.hit++,r;this.miss++;var i=Object(xwt["b"])(t,e,n),o=Uint8Array.prototype.slice.call(t,e,e+n);return this.store(o,i),i},t}(),kwt=function(t,e,n,r){function i(t){return t instanceof n?t:new n((function(e){e(t)}))}return new(n||(n=Promise))((function(n,o){function s(t){try{u(r.next(t))}catch(e){o(e)}}function a(t){try{u(r["throw"](t))}catch(e){o(e)}}function u(t){t.done?n(t.value):i(t.value).then(s,a)}u((r=r.apply(t,e||[])).next())}))},Owt=function(t,e){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(t){return function(e){return u([t,e])}}function u(o){if(n)throw new TypeError("Generator is already executing.");while(s)try{if(n=1,r&&(i=2&o[0]?r["return"]:o[0]?r["throw"]||((i=r["return"])&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(i=s.trys,!(i=i.length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(a){o=[6,a],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}},Pwt=function(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,n=t[Symbol.asyncIterator];return n?n.call(t):(t="function"===typeof __values?__values(t):t[Symbol.iterator](),e={},r("next"),r("throw"),r("return"),e[Symbol.asyncIterator]=function(){return this},e);function r(n){e[n]=t[n]&&function(e){return new Promise((function(r,o){e=t[n](e),i(r,o,e.done,e.value)}))}}function i(t,e,n,r){Promise.resolve(r).then((function(e){t({value:e,done:n})}),e)}},Twt=function(t){return this instanceof Twt?(this.v=t,this):new Twt(t)},Lwt=function(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=n.apply(t,e||[]),o=[];return r={},s("next"),s("throw"),s("return"),r[Symbol.asyncIterator]=function(){return this},r;function s(t){i[t]&&(r[t]=function(e){return new Promise((function(n,r){o.push([t,e,n,r])>1||a(t,e)}))})}function a(t,e){try{u(i[t](e))}catch(n){h(o[0][3],n)}}function u(t){t.value instanceof Twt?Promise.resolve(t.value.v).then(c,l):h(o[0][2],t)}function c(t){a("next",t)}function l(t){a("throw",t)}function h(t,e){t(e),o.shift(),o.length&&a(o[0][0],o[0][1])}},Iwt=function(t){var e=typeof t;return"string"===e||"number"===e},Nwt=-1,Dwt=new DataView(new ArrayBuffer(0)),Rwt=new Uint8Array(Dwt.buffer),Fwt=function(){try{Dwt.getInt8(0)}catch(t){return t.constructor}throw new Error("never reached")}(),Bwt=new Fwt("Insufficient data"),jwt=new Cwt,zwt=function(){function t(t,e,n,r,i,o,s,a){void 0===t&&(t=wwt.defaultCodec),void 0===e&&(e=void 0),void 0===n&&(n=hwt["a"]),void 0===r&&(r=hwt["a"]),void 0===i&&(i=hwt["a"]),void 0===o&&(o=hwt["a"]),void 0===s&&(s=hwt["a"]),void 0===a&&(a=jwt),this.extensionCodec=t,this.context=e,this.maxStrLength=n,this.maxBinLength=r,this.maxArrayLength=i,this.maxMapLength=o,this.maxExtLength=s,this.keyDecoder=a,this.totalPos=0,this.pos=0,this.view=Dwt,this.bytes=Rwt,this.headByte=Nwt,this.stack=[]}return t.prototype.reinitializeState=function(){this.totalPos=0,this.headByte=Nwt,this.stack.length=0},t.prototype.setBuffer=function(t){this.bytes=Swt(t),this.view=Ewt(this.bytes),this.pos=0},t.prototype.appendBuffer=function(t){if(this.headByte!==Nwt||this.hasRemaining(1)){var e=this.bytes.subarray(this.pos),n=Swt(t),r=new Uint8Array(e.length+n.length);r.set(e),r.set(n,e.length),this.setBuffer(r)}else this.setBuffer(t)},t.prototype.hasRemaining=function(t){return this.view.byteLength-this.pos>=t},t.prototype.createExtraByteError=function(t){var e=this,n=e.view,r=e.pos;return new RangeError("Extra "+(n.byteLength-r)+" of "+n.byteLength+" byte(s) found at buffer["+t+"]")},t.prototype.decode=function(t){this.reinitializeState(),this.setBuffer(t);var e=this.doDecodeSync();if(this.hasRemaining(1))throw this.createExtraByteError(this.pos);return e},t.prototype.decodeMulti=function(t){return Owt(this,(function(e){switch(e.label){case 0:this.reinitializeState(),this.setBuffer(t),e.label=1;case 1:return this.hasRemaining(1)?[4,this.doDecodeSync()]:[3,3];case 2:return e.sent(),[3,1];case 3:return[2]}}))},t.prototype.decodeAsync=function(t){var e,n,r,i;return kwt(this,void 0,void 0,(function(){var o,s,a,u,c,l,h,f;return Owt(this,(function(d){switch(d.label){case 0:o=!1,d.label=1;case 1:d.trys.push([1,6,7,12]),e=Pwt(t),d.label=2;case 2:return[4,e.next()];case 3:if(n=d.sent(),n.done)return[3,5];if(a=n.value,o)throw this.createExtraByteError(this.totalPos);this.appendBuffer(a);try{s=this.doDecodeSync(),o=!0}catch(p){if(!(p instanceof Fwt))throw p}this.totalPos+=this.pos,d.label=4;case 4:return[3,2];case 5:return[3,12];case 6:return u=d.sent(),r={error:u},[3,12];case 7:return d.trys.push([7,,10,11]),n&&!n.done&&(i=e.return)?[4,i.call(e)]:[3,9];case 8:d.sent(),d.label=9;case 9:return[3,11];case 10:if(r)throw r.error;return[7];case 11:return[7];case 12:if(o){if(this.hasRemaining(1))throw this.createExtraByteError(this.totalPos);return[2,s]}throw c=this,l=c.headByte,h=c.pos,f=c.totalPos,new RangeError("Insufficient data in parsing "+awt(l)+" at "+f+" ("+h+" in the current buffer)")}}))}))},t.prototype.decodeArrayStream=function(t){return this.decodeMultiAsync(t,!0)},t.prototype.decodeStream=function(t){return this.decodeMultiAsync(t,!1)},t.prototype.decodeMultiAsync=function(t,e){return Lwt(this,arguments,(function(){var n,r,i,o,s,a,u,c,l;return Owt(this,(function(h){switch(h.label){case 0:n=e,r=-1,h.label=1;case 1:h.trys.push([1,13,14,19]),i=Pwt(t),h.label=2;case 2:return[4,Twt(i.next())];case 3:if(o=h.sent(),o.done)return[3,12];if(s=o.value,e&&0===r)throw this.createExtraByteError(this.totalPos);this.appendBuffer(s),n&&(r=this.readArraySize(),n=!1,this.complete()),h.label=4;case 4:h.trys.push([4,9,,10]),h.label=5;case 5:return[4,Twt(this.doDecodeSync())];case 6:return[4,h.sent()];case 7:return h.sent(),0===--r?[3,8]:[3,5];case 8:return[3,10];case 9:if(a=h.sent(),!(a instanceof Fwt))throw a;return[3,10];case 10:this.totalPos+=this.pos,h.label=11;case 11:return[3,2];case 12:return[3,19];case 13:return u=h.sent(),c={error:u},[3,19];case 14:return h.trys.push([14,,17,18]),o&&!o.done&&(l=i.return)?[4,Twt(l.call(i))]:[3,16];case 15:h.sent(),h.label=16;case 16:return[3,18];case 17:if(c)throw c.error;return[7];case 18:return[7];case 19:return[2]}}))}))},t.prototype.doDecodeSync=function(){t:while(1){var t=this.readHeadByte(),e=void 0;if(t>=224)e=t-256;else if(t<192)if(t<128)e=t;else if(t<144){var n=t-128;if(0!==n){this.pushMapState(n),this.complete();continue t}e={}}else if(t<160){n=t-144;if(0!==n){this.pushArrayState(n),this.complete();continue t}e=[]}else{var r=t-160;e=this.decodeUtf8String(r,0)}else if(192===t)e=null;else if(194===t)e=!1;else if(195===t)e=!0;else if(202===t)e=this.readF32();else if(203===t)e=this.readF64();else if(204===t)e=this.readU8();else if(205===t)e=this.readU16();else if(206===t)e=this.readU32();else if(207===t)e=this.readU64();else if(208===t)e=this.readI8();else if(209===t)e=this.readI16();else if(210===t)e=this.readI32();else if(211===t)e=this.readI64();else if(217===t){r=this.lookU8();e=this.decodeUtf8String(r,1)}else if(218===t){r=this.lookU16();e=this.decodeUtf8String(r,2)}else if(219===t){r=this.lookU32();e=this.decodeUtf8String(r,4)}else if(220===t){n=this.readU16();if(0!==n){this.pushArrayState(n),this.complete();continue t}e=[]}else if(221===t){n=this.readU32();if(0!==n){this.pushArrayState(n),this.complete();continue t}e=[]}else if(222===t){n=this.readU16();if(0!==n){this.pushMapState(n),this.complete();continue t}e={}}else if(223===t){n=this.readU32();if(0!==n){this.pushMapState(n),this.complete();continue t}e={}}else if(196===t){n=this.lookU8();e=this.decodeBinary(n,1)}else if(197===t){n=this.lookU16();e=this.decodeBinary(n,2)}else if(198===t){n=this.lookU32();e=this.decodeBinary(n,4)}else if(212===t)e=this.decodeExtension(1,0);else if(213===t)e=this.decodeExtension(2,0);else if(214===t)e=this.decodeExtension(4,0);else if(215===t)e=this.decodeExtension(8,0);else if(216===t)e=this.decodeExtension(16,0);else if(199===t){n=this.lookU8();e=this.decodeExtension(n,1)}else if(200===t){n=this.lookU16();e=this.decodeExtension(n,2)}else{if(201!==t)throw new lwt("Unrecognized type byte: "+awt(t));n=this.lookU32();e=this.decodeExtension(n,4)}this.complete();var i=this.stack;while(i.length>0){var o=i[i.length-1];if(0===o.type){if(o.array[o.position]=e,o.position++,o.position!==o.size)continue t;i.pop(),e=o.array}else{if(1===o.type){if(!Iwt(e))throw new lwt("The type of key must be string or number but "+typeof e);if("__proto__"===e)throw new lwt("The key __proto__ is not allowed");o.key=e,o.type=2;continue t}if(o.map[o.key]=e,o.readCount++,o.readCount!==o.size){o.key=null,o.type=1;continue t}i.pop(),e=o.map}}return e}},t.prototype.readHeadByte=function(){return this.headByte===Nwt&&(this.headByte=this.readU8()),this.headByte},t.prototype.complete=function(){this.headByte=Nwt},t.prototype.readArraySize=function(){var t=this.readHeadByte();switch(t){case 220:return this.readU16();case 221:return this.readU32();default:if(t<160)return t-144;throw new lwt("Unrecognized array type byte: "+awt(t))}},t.prototype.pushMapState=function(t){if(t>this.maxMapLength)throw new lwt("Max length exceeded: map length ("+t+") > maxMapLengthLength ("+this.maxMapLength+")");this.stack.push({type:1,size:t,key:null,readCount:0,map:{}})},t.prototype.pushArrayState=function(t){if(t>this.maxArrayLength)throw new lwt("Max length exceeded: array length ("+t+") > maxArrayLength ("+this.maxArrayLength+")");this.stack.push({type:0,size:t,array:new Array(t),position:0})},t.prototype.decodeUtf8String=function(t,e){var n;if(t>this.maxStrLength)throw new lwt("Max length exceeded: UTF-8 byte length ("+t+") > maxStrLength ("+this.maxStrLength+")");if(this.bytes.byteLength<this.pos+e+t)throw Bwt;var r,i=this.pos+e;return r=this.stateIsMapKey()&&(null===(n=this.keyDecoder)||void 0===n?void 0:n.canBeCached(t))?this.keyDecoder.decode(this.bytes,i,t):t>xwt["a"]?Object(xwt["c"])(this.bytes,i,t):Object(xwt["b"])(this.bytes,i,t),this.pos+=e+t,r},t.prototype.stateIsMapKey=function(){if(this.stack.length>0){var t=this.stack[this.stack.length-1];return 1===t.type}return!1},t.prototype.decodeBinary=function(t,e){if(t>this.maxBinLength)throw new lwt("Max length exceeded: bin length ("+t+") > maxBinLength ("+this.maxBinLength+")");if(!this.hasRemaining(t+e))throw Bwt;var n=this.pos+e,r=this.bytes.subarray(n,n+t);return this.pos+=e+t,r},t.prototype.decodeExtension=function(t,e){if(t>this.maxExtLength)throw new lwt("Max length exceeded: ext length ("+t+") > maxExtLength ("+this.maxExtLength+")");var n=this.view.getInt8(this.pos+e),r=this.decodeBinary(t,e+1);return this.extensionCodec.decode(r,n,this.context)},t.prototype.lookU8=function(){return this.view.getUint8(this.pos)},t.prototype.lookU16=function(){return this.view.getUint16(this.pos)},t.prototype.lookU32=function(){return this.view.getUint32(this.pos)},t.prototype.readU8=function(){var t=this.view.getUint8(this.pos);return this.pos++,t},t.prototype.readI8=function(){var t=this.view.getInt8(this.pos);return this.pos++,t},t.prototype.readU16=function(){var t=this.view.getUint16(this.pos);return this.pos+=2,t},t.prototype.readI16=function(){var t=this.view.getInt16(this.pos);return this.pos+=2,t},t.prototype.readU32=function(){var t=this.view.getUint32(this.pos);return this.pos+=4,t},t.prototype.readI32=function(){var t=this.view.getInt32(this.pos);return this.pos+=4,t},t.prototype.readU64=function(){var t=Object(hwt["c"])(this.view,this.pos);return this.pos+=8,t},t.prototype.readI64=function(){var t=Object(hwt["b"])(this.view,this.pos);return this.pos+=8,t},t.prototype.readF32=function(){var t=this.view.getFloat32(this.pos);return this.pos+=4,t},t.prototype.readF64=function(){var t=this.view.getFloat64(this.pos);return this.pos+=8,t},t}(),Uwt={};function $wt(t,e){void 0===e&&(e=Uwt);var n=new zwt(e.extensionCodec,e.context,e.maxStrLength,e.maxBinLength,e.maxArrayLength,e.maxMapLength,e.maxExtLength);return n.decode(t)}var Vwt=n("5317"),qwt=n.n(Vwt);function Wwt(t,e="",n){let r=t;n=n||"undefined"!==typeof location&&location,null==t&&(t=n.protocol+"//"+n.host),"string"===typeof t&&("/"===t.charAt(0)&&(t="/"===t.charAt(1)?n.protocol+t:n.host+t),/^(https?|wss?):\/\//.test(t)||(t="undefined"!==typeof n?n.protocol+"//"+t:"https://"+t),r=qwt()(t)),r.port||(/^(http|ws)$/.test(r.protocol)?r.port="80":/^(http|ws)s$/.test(r.protocol)&&(r.port="443")),r.path=r.path||"/";const i=-1!==r.host.indexOf(":"),o=i?"["+r.host+"]":r.host;return r.id=r.protocol+"://"+o+":"+r.port+e,r.href=r.protocol+"://"+o+(n&&n.port===r.port?"":":"+r.port),r}var Gwt=n("c9eb"),Hwt=n.n(Gwt),Xwt=n("20a4"),Ywt=function(t){const e=t.xdomain;try{if("undefined"!==typeof XMLHttpRequest&&(!e||Hwt.a))return new XMLHttpRequest}catch(n){}if(!e)try{return new(Xwt["a"][["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(n){}},Zwt=n("af7f"),Kwt=n("b19d"),Jwt=n("34ba"),Qwt=n("0299"),txt=n.n(Qwt),ext=n("4f2a"),nxt=n.n(ext),rxt=n("33e8");class ixt extends Jwt["a"]{constructor(){super(...arguments),this.polling=!1}get name(){return"polling"}doOpen(){this.poll()}pause(t){this.readyState="pausing";const e=()=>{this.readyState="paused",t()};if(this.polling||!this.writable){let t=0;this.polling&&(t++,this.once("pollComplete",(function(){--t||e()}))),this.writable||(t++,this.once("drain",(function(){--t||e()})))}else e()}poll(){this.polling=!0,this.doPoll(),this.emit("poll")}onData(t){const e=t=>{if("opening"===this.readyState&&"open"===t.type&&this.onOpen(),"close"===t.type)return this.onClose(),!1;this.onPacket(t)};Object(rxt["b"])(t,this.socket.binaryType).forEach(e),"closed"!==this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"===this.readyState&&this.poll())}doClose(){const t=()=>{this.write([{type:"close"}])};"open"===this.readyState?t():this.once("open",t)}write(t){this.writable=!1,Object(rxt["d"])(t,t=>{this.doWrite(t,()=>{this.writable=!0,this.emit("drain")})})}uri(){let t=this.query||{};const e=this.opts.secure?"https":"http";let n="";!1!==this.opts.timestampRequests&&(t[this.opts.timestampParam]=txt()()),this.supportsBinary||t.sid||(t.b64=1),this.opts.port&&("https"===e&&443!==Number(this.opts.port)||"http"===e&&80!==Number(this.opts.port))&&(n=":"+this.opts.port);const r=nxt.a.encode(t),i=-1!==this.opts.hostname.indexOf(":");return e+"://"+(i?"["+this.opts.hostname+"]":this.opts.hostname)+n+this.opts.path+(r.length?"?"+r:"")}}function oxt(){}const sxt=function(){const t=new Ywt({xdomain:!1});return null!=t.responseType}();class axt extends ixt{constructor(t){if(super(t),"undefined"!==typeof location){const e="https:"===location.protocol;let n=location.port;n||(n=e?"443":"80"),this.xd="undefined"!==typeof location&&t.hostname!==location.hostname||n!==t.port,this.xs=t.secure!==e}const e=t&&t.forceBase64;this.supportsBinary=sxt&&!e}request(t={}){return Object.assign(t,{xd:this.xd,xs:this.xs},this.opts),new uxt(this.uri(),t)}doWrite(t,e){const n=this.request({method:"POST",data:t});n.on("success",e),n.on("error",t=>{this.onError("xhr post error",t)})}doPoll(){const t=this.request();t.on("data",this.onData.bind(this)),t.on("error",t=>{this.onError("xhr poll error",t)}),this.pollXhr=t}}class uxt extends Kwt["Emitter"]{constructor(t,e){super(),Object(Zwt["a"])(this,e),this.opts=e,this.method=e.method||"GET",this.uri=t,this.async=!1!==e.async,this.data=void 0!==e.data?e.data:null,this.create()}create(){const t=Object(Zwt["b"])(this.opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");t.xdomain=!!this.opts.xd,t.xscheme=!!this.opts.xs;const e=this.xhr=new Ywt(t);try{e.open(this.method,this.uri,this.async);try{if(this.opts.extraHeaders){e.setDisableHeaderCheck&&e.setDisableHeaderCheck(!0);for(let t in this.opts.extraHeaders)this.opts.extraHeaders.hasOwnProperty(t)&&e.setRequestHeader(t,this.opts.extraHeaders[t])}}catch(n){}if("POST"===this.method)try{e.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(n){}try{e.setRequestHeader("Accept","*/*")}catch(n){}"withCredentials"in e&&(e.withCredentials=this.opts.withCredentials),this.opts.requestTimeout&&(e.timeout=this.opts.requestTimeout),e.onreadystatechange=()=>{4===e.readyState&&(200===e.status||1223===e.status?this.onLoad():this.setTimeoutFn(()=>{this.onError("number"===typeof e.status?e.status:0)},0))},e.send(this.data)}catch(n){return void this.setTimeoutFn(()=>{this.onError(n)},0)}"undefined"!==typeof document&&(this.index=uxt.requestsCount++,uxt.requests[this.index]=this)}onSuccess(){this.emit("success"),this.cleanup()}onData(t){this.emit("data",t),this.onSuccess()}onError(t){this.emit("error",t),this.cleanup(!0)}cleanup(t){if("undefined"!==typeof this.xhr&&null!==this.xhr){if(this.xhr.onreadystatechange=oxt,t)try{this.xhr.abort()}catch(e){}"undefined"!==typeof document&&delete uxt.requests[this.index],this.xhr=null}}onLoad(){const t=this.xhr.responseText;null!==t&&this.onData(t)}abort(){this.cleanup()}}if(uxt.requestsCount=0,uxt.requests={},"undefined"!==typeof document)if("function"===typeof attachEvent)attachEvent("onunload",cxt);else if("function"===typeof addEventListener){const t="onpagehide"in Xwt["a"]?"pagehide":"unload";addEventListener(t,cxt,!1)}function cxt(){for(let t in uxt.requests)uxt.requests.hasOwnProperty(t)&&uxt.requests[t].abort()}var lxt=n("1f49");const hxt={websocket:lxt["a"],polling:axt};class fxt extends Kwt["Emitter"]{constructor(t,e={}){super(),t&&"object"===typeof t&&(e=t,t=null),t?(t=qwt()(t),e.hostname=t.host,e.secure="https"===t.protocol||"wss"===t.protocol,e.port=t.port,t.query&&(e.query=t.query)):e.host&&(e.hostname=qwt()(e.host).host),Object(Zwt["a"])(this,e),this.secure=null!=e.secure?e.secure:"undefined"!==typeof location&&"https:"===location.protocol,e.hostname&&!e.port&&(e.port=this.secure?"443":"80"),this.hostname=e.hostname||("undefined"!==typeof location?location.hostname:"localhost"),this.port=e.port||("undefined"!==typeof location&&location.port?location.port:this.secure?"443":"80"),this.transports=e.transports||["polling","websocket"],this.readyState="",this.writeBuffer=[],this.prevBufferLen=0,this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!0},e),this.opts.path=this.opts.path.replace(/\/$/,"")+"/","string"===typeof this.opts.query&&(this.opts.query=nxt.a.decode(this.opts.query)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingTimeoutTimer=null,"function"===typeof addEventListener&&(this.opts.closeOnBeforeunload&&addEventListener("beforeunload",()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},!1),"localhost"!==this.hostname&&(this.offlineEventListener=()=>{this.onClose("transport close")},addEventListener("offline",this.offlineEventListener,!1))),this.open()}createTransport(t){const e=dxt(this.opts.query);e.EIO=rxt["e"],e.transport=t,this.id&&(e.sid=this.id);const n=Object.assign({},this.opts.transportOptions[t],this.opts,{query:e,socket:this,hostname:this.hostname,secure:this.secure,port:this.port});return new hxt[t](n)}open(){let t;if(this.opts.rememberUpgrade&&fxt.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket"))t="websocket";else{if(0===this.transports.length)return void this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);t=this.transports[0]}this.readyState="opening";try{t=this.createTransport(t)}catch(e){return this.transports.shift(),void this.open()}t.open(),this.setTransport(t)}setTransport(t){this.transport&&this.transport.removeAllListeners(),this.transport=t,t.on("drain",this.onDrain.bind(this)).on("packet",this.onPacket.bind(this)).on("error",this.onError.bind(this)).on("close",()=>{this.onClose("transport close")})}probe(t){let e=this.createTransport(t),n=!1;fxt.priorWebsocketSuccess=!1;const r=()=>{n||(e.send([{type:"ping",data:"probe"}]),e.once("packet",t=>{if(!n)if("pong"===t.type&&"probe"===t.data){if(this.upgrading=!0,this.emitReserved("upgrading",e),!e)return;fxt.priorWebsocketSuccess="websocket"===e.name,this.transport.pause(()=>{n||"closed"!==this.readyState&&(c(),this.setTransport(e),e.send([{type:"upgrade"}]),this.emitReserved("upgrade",e),e=null,this.upgrading=!1,this.flush())})}else{const t=new Error("probe error");t.transport=e.name,this.emitReserved("upgradeError",t)}}))};function i(){n||(n=!0,c(),e.close(),e=null)}const o=t=>{const n=new Error("probe error: "+t);n.transport=e.name,i(),this.emitReserved("upgradeError",n)};function s(){o("transport closed")}function a(){o("socket closed")}function u(t){e&&t.name!==e.name&&i()}const c=()=>{e.removeListener("open",r),e.removeListener("error",o),e.removeListener("close",s),this.off("close",a),this.off("upgrading",u)};e.once("open",r),e.once("error",o),e.once("close",s),this.once("close",a),this.once("upgrading",u),e.open()}onOpen(){if(this.readyState="open",fxt.priorWebsocketSuccess="websocket"===this.transport.name,this.emitReserved("open"),this.flush(),"open"===this.readyState&&this.opts.upgrade&&this.transport.pause){let t=0;const e=this.upgrades.length;for(;t<e;t++)this.probe(this.upgrades[t])}}onPacket(t){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(this.emitReserved("packet",t),this.emitReserved("heartbeat"),t.type){case"open":this.onHandshake(JSON.parse(t.data));break;case"ping":this.resetPingTimeout(),this.sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong");break;case"error":const e=new Error("server error");e.code=t.data,this.onError(e);break;case"message":this.emitReserved("data",t.data),this.emitReserved("message",t.data);break}}onHandshake(t){this.emitReserved("handshake",t),this.id=t.sid,this.transport.query.sid=t.sid,this.upgrades=this.filterUpgrades(t.upgrades),this.pingInterval=t.pingInterval,this.pingTimeout=t.pingTimeout,this.onOpen(),"closed"!==this.readyState&&this.resetPingTimeout()}resetPingTimeout(){this.clearTimeoutFn(this.pingTimeoutTimer),this.pingTimeoutTimer=this.setTimeoutFn(()=>{this.onClose("ping timeout")},this.pingInterval+this.pingTimeout),this.opts.autoUnref&&this.pingTimeoutTimer.unref()}onDrain(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0===this.writeBuffer.length?this.emitReserved("drain"):this.flush()}flush(){"closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emitReserved("flush"))}write(t,e,n){return this.sendPacket("message",t,e,n),this}send(t,e,n){return this.sendPacket("message",t,e,n),this}sendPacket(t,e,n,r){if("function"===typeof e&&(r=e,e=void 0),"function"===typeof n&&(r=n,n=null),"closing"===this.readyState||"closed"===this.readyState)return;n=n||{},n.compress=!1!==n.compress;const i={type:t,data:e,options:n};this.emitReserved("packetCreate",i),this.writeBuffer.push(i),r&&this.once("flush",r),this.flush()}close(){const t=()=>{this.onClose("forced close"),this.transport.close()},e=()=>{this.off("upgrade",e),this.off("upgradeError",e),t()},n=()=>{this.once("upgrade",e),this.once("upgradeError",e)};return"opening"!==this.readyState&&"open"!==this.readyState||(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?n():t()}):this.upgrading?n():t()),this}onError(t){fxt.priorWebsocketSuccess=!1,this.emitReserved("error",t),this.onClose("transport error",t)}onClose(t,e){"opening"!==this.readyState&&"open"!==this.readyState&&"closing"!==this.readyState||(this.clearTimeoutFn(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),"function"===typeof removeEventListener&&removeEventListener("offline",this.offlineEventListener,!1),this.readyState="closed",this.id=null,this.emitReserved("close",t,e),this.writeBuffer=[],this.prevBufferLen=0)}filterUpgrades(t){const e=[];let n=0;const r=t.length;for(;n<r;n++)~this.transports.indexOf(t[n])&&e.push(t[n]);return e}}function dxt(t){const e={};for(let n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}fxt.protocol=rxt["e"];fxt.protocol;const pxt="function"===typeof ArrayBuffer,gxt=t=>{return"function"===typeof ArrayBuffer.isView?ArrayBuffer.isView(t):t.buffer instanceof ArrayBuffer},mxt=Object.prototype.toString,yxt="function"===typeof Blob||"undefined"!==typeof Blob&&"[object BlobConstructor]"===mxt.call(Blob),vxt="function"===typeof File||"undefined"!==typeof File&&"[object FileConstructor]"===mxt.call(File);function bxt(t){return pxt&&(t instanceof ArrayBuffer||gxt(t))||yxt&&t instanceof Blob||vxt&&t instanceof File}function _xt(t,e){if(!t||"object"!==typeof t)return!1;if(Array.isArray(t)){for(let e=0,n=t.length;e<n;e++)if(_xt(t[e]))return!0;return!1}if(bxt(t))return!0;if(t.toJSON&&"function"===typeof t.toJSON&&1===arguments.length)return _xt(t.toJSON(),!0);for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n)&&_xt(t[n]))return!0;return!1}function wxt(t){const e=[],n=t.data,r=t;return r.data=xxt(n,e),r.attachments=e.length,{packet:r,buffers:e}}function xxt(t,e){if(!t)return t;if(bxt(t)){const n={_placeholder:!0,num:e.length};return e.push(t),n}if(Array.isArray(t)){const n=new Array(t.length);for(let r=0;r<t.length;r++)n[r]=xxt(t[r],e);return n}if("object"===typeof t&&!(t instanceof Date)){const n={};for(const r in t)t.hasOwnProperty(r)&&(n[r]=xxt(t[r],e));return n}return t}function Sxt(t,e){return t.data=Ext(t.data,e),t.attachments=void 0,t}function Ext(t,e){if(!t)return t;if(t&&t._placeholder)return e[t.num];if(Array.isArray(t))for(let n=0;n<t.length;n++)t[n]=Ext(t[n],e);else if("object"===typeof t)for(const n in t)t.hasOwnProperty(n)&&(t[n]=Ext(t[n],e));return t}const Axt=5;var Mxt;(function(t){t[t["CONNECT"]=0]="CONNECT",t[t["DISCONNECT"]=1]="DISCONNECT",t[t["EVENT"]=2]="EVENT",t[t["ACK"]=3]="ACK",t[t["CONNECT_ERROR"]=4]="CONNECT_ERROR",t[t["BINARY_EVENT"]=5]="BINARY_EVENT",t[t["BINARY_ACK"]=6]="BINARY_ACK"})(Mxt||(Mxt={}));class Cxt{encode(t){return t.type!==Mxt.EVENT&&t.type!==Mxt.ACK||!_xt(t)?[this.encodeAsString(t)]:(t.type=t.type===Mxt.EVENT?Mxt.BINARY_EVENT:Mxt.BINARY_ACK,this.encodeAsBinary(t))}encodeAsString(t){let e=""+t.type;return t.type!==Mxt.BINARY_EVENT&&t.type!==Mxt.BINARY_ACK||(e+=t.attachments+"-"),t.nsp&&"/"!==t.nsp&&(e+=t.nsp+","),null!=t.id&&(e+=t.id),null!=t.data&&(e+=JSON.stringify(t.data)),e}encodeAsBinary(t){const e=wxt(t),n=this.encodeAsString(e.packet),r=e.buffers;return r.unshift(n),r}}class kxt extends Kwt["Emitter"]{constructor(){super()}add(t){let e;if("string"===typeof t)e=this.decodeString(t),e.type===Mxt.BINARY_EVENT||e.type===Mxt.BINARY_ACK?(this.reconstructor=new Pxt(e),0===e.attachments&&super.emitReserved("decoded",e)):super.emitReserved("decoded",e);else{if(!bxt(t)&&!t.base64)throw new Error("Unknown type: "+t);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");e=this.reconstructor.takeBinaryData(t),e&&(this.reconstructor=null,super.emitReserved("decoded",e))}}decodeString(t){let e=0;const n={type:Number(t.charAt(0))};if(void 0===Mxt[n.type])throw new Error("unknown packet type "+n.type);if(n.type===Mxt.BINARY_EVENT||n.type===Mxt.BINARY_ACK){const r=e+1;while("-"!==t.charAt(++e)&&e!=t.length);const i=t.substring(r,e);if(i!=Number(i)||"-"!==t.charAt(e))throw new Error("Illegal attachments");n.attachments=Number(i)}if("/"===t.charAt(e+1)){const r=e+1;while(++e){const n=t.charAt(e);if(","===n)break;if(e===t.length)break}n.nsp=t.substring(r,e)}else n.nsp="/";const r=t.charAt(e+1);if(""!==r&&Number(r)==r){const r=e+1;while(++e){const n=t.charAt(e);if(null==n||Number(n)!=n){--e;break}if(e===t.length)break}n.id=Number(t.substring(r,e+1))}if(t.charAt(++e)){const r=Oxt(t.substr(e));if(!kxt.isPayloadValid(n.type,r))throw new Error("invalid payload");n.data=r}return n}static isPayloadValid(t,e){switch(t){case Mxt.CONNECT:return"object"===typeof e;case Mxt.DISCONNECT:return void 0===e;case Mxt.CONNECT_ERROR:return"string"===typeof e||"object"===typeof e;case Mxt.EVENT:case Mxt.BINARY_EVENT:return Array.isArray(e)&&e.length>0;case Mxt.ACK:case Mxt.BINARY_ACK:return Array.isArray(e)}}destroy(){this.reconstructor&&this.reconstructor.finishedReconstruction()}}function Oxt(t){try{return JSON.parse(t)}catch(e){return!1}}class Pxt{constructor(t){this.packet=t,this.buffers=[],this.reconPack=t}takeBinaryData(t){if(this.buffers.push(t),this.buffers.length===this.reconPack.attachments){const t=Sxt(this.reconPack,this.buffers);return this.finishedReconstruction(),t}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}function Txt(t,e,n){return t.on(e,n),function(){t.off(e,n)}}const Lxt=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class Ixt extends Kwt["Emitter"]{constructor(t,e,n){super(),this.connected=!1,this.disconnected=!0,this.receiveBuffer=[],this.sendBuffer=[],this.ids=0,this.acks={},this.flags={},this.io=t,this.nsp=e,n&&n.auth&&(this.auth=n.auth),this.io._autoConnect&&this.open()}subEvents(){if(this.subs)return;const t=this.io;this.subs=[Txt(t,"open",this.onopen.bind(this)),Txt(t,"packet",this.onpacket.bind(this)),Txt(t,"error",this.onerror.bind(this)),Txt(t,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io["_reconnecting"]||this.io.open(),"open"===this.io._readyState&&this.onopen(),this)}open(){return this.connect()}send(...t){return t.unshift("message"),this.emit.apply(this,t),this}emit(t,...e){if(Lxt.hasOwnProperty(t))throw new Error('"'+t+'" is a reserved event name');e.unshift(t);const n={type:Mxt.EVENT,data:e,options:{}};n.options.compress=!1!==this.flags.compress,"function"===typeof e[e.length-1]&&(this.acks[this.ids]=e.pop(),n.id=this.ids++);const r=this.io.engine&&this.io.engine.transport&&this.io.engine.transport.writable,i=this.flags.volatile&&(!r||!this.connected);return i||(this.connected?this.packet(n):this.sendBuffer.push(n)),this.flags={},this}packet(t){t.nsp=this.nsp,this.io._packet(t)}onopen(){"function"==typeof this.auth?this.auth(t=>{this.packet({type:Mxt.CONNECT,data:t})}):this.packet({type:Mxt.CONNECT,data:this.auth})}onerror(t){this.connected||this.emitReserved("connect_error",t)}onclose(t){this.connected=!1,this.disconnected=!0,delete this.id,this.emitReserved("disconnect",t)}onpacket(t){const e=t.nsp===this.nsp;if(e)switch(t.type){case Mxt.CONNECT:if(t.data&&t.data.sid){const e=t.data.sid;this.onconnect(e)}else this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case Mxt.EVENT:this.onevent(t);break;case Mxt.BINARY_EVENT:this.onevent(t);break;case Mxt.ACK:this.onack(t);break;case Mxt.BINARY_ACK:this.onack(t);break;case Mxt.DISCONNECT:this.ondisconnect();break;case Mxt.CONNECT_ERROR:const e=new Error(t.data.message);e.data=t.data.data,this.emitReserved("connect_error",e);break}}onevent(t){const e=t.data||[];null!=t.id&&e.push(this.ack(t.id)),this.connected?this.emitEvent(e):this.receiveBuffer.push(Object.freeze(e))}emitEvent(t){if(this._anyListeners&&this._anyListeners.length){const e=this._anyListeners.slice();for(const n of e)n.apply(this,t)}super.emit.apply(this,t)}ack(t){const e=this;let n=!1;return function(...r){n||(n=!0,e.packet({type:Mxt.ACK,id:t,data:r}))}}onack(t){const e=this.acks[t.id];"function"===typeof e&&(e.apply(this,t.data),delete this.acks[t.id])}onconnect(t){this.id=t,this.connected=!0,this.disconnected=!1,this.emitBuffered(),this.emitReserved("connect")}emitBuffered(){this.receiveBuffer.forEach(t=>this.emitEvent(t)),this.receiveBuffer=[],this.sendBuffer.forEach(t=>this.packet(t)),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(t=>t()),this.subs=void 0),this.io["_destroy"](this)}disconnect(){return this.connected&&this.packet({type:Mxt.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(t){return this.flags.compress=t,this}get volatile(){return this.flags.volatile=!0,this}onAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(t),this}prependAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(t),this}offAny(t){if(!this._anyListeners)return this;if(t){const e=this._anyListeners;for(let n=0;n<e.length;n++)if(t===e[n])return e.splice(n,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}}var Nxt=n("0b64"),Dxt=n.n(Nxt);class Rxt extends Kwt["Emitter"]{constructor(t,e){var n;super(),this.nsps={},this.subs=[],t&&"object"===typeof t&&(e=t,t=void 0),e=e||{},e.path=e.path||"/socket.io",this.opts=e,Object(Zwt["a"])(this,e),this.reconnection(!1!==e.reconnection),this.reconnectionAttempts(e.reconnectionAttempts||1/0),this.reconnectionDelay(e.reconnectionDelay||1e3),this.reconnectionDelayMax(e.reconnectionDelayMax||5e3),this.randomizationFactor(null!==(n=e.randomizationFactor)&&void 0!==n?n:.5),this.backoff=new Dxt.a({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==e.timeout?2e4:e.timeout),this._readyState="closed",this.uri=t;const r=e.parser||b;this.encoder=new r.Encoder,this.decoder=new r.Decoder,this._autoConnect=!1!==e.autoConnect,this._autoConnect&&this.open()}reconnection(t){return arguments.length?(this._reconnection=!!t,this):this._reconnection}reconnectionAttempts(t){return void 0===t?this._reconnectionAttempts:(this._reconnectionAttempts=t,this)}reconnectionDelay(t){var e;return void 0===t?this._reconnectionDelay:(this._reconnectionDelay=t,null===(e=this.backoff)||void 0===e||e.setMin(t),this)}randomizationFactor(t){var e;return void 0===t?this._randomizationFactor:(this._randomizationFactor=t,null===(e=this.backoff)||void 0===e||e.setJitter(t),this)}reconnectionDelayMax(t){var e;return void 0===t?this._reconnectionDelayMax:(this._reconnectionDelayMax=t,null===(e=this.backoff)||void 0===e||e.setMax(t),this)}timeout(t){return arguments.length?(this._timeout=t,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()}open(t){if(~this._readyState.indexOf("open"))return this;this.engine=new fxt(this.uri,this.opts);const e=this.engine,n=this;this._readyState="opening",this.skipReconnect=!1;const r=Txt(e,"open",(function(){n.onopen(),t&&t()})),i=Txt(e,"error",e=>{n.cleanup(),n._readyState="closed",this.emitReserved("error",e),t?t(e):n.maybeReconnectOnOpen()});if(!1!==this._timeout){const t=this._timeout;0===t&&r();const n=this.setTimeoutFn(()=>{r(),e.close(),e.emit("error",new Error("timeout"))},t);this.opts.autoUnref&&n.unref(),this.subs.push((function(){clearTimeout(n)}))}return this.subs.push(r),this.subs.push(i),this}connect(t){return this.open(t)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const t=this.engine;this.subs.push(Txt(t,"ping",this.onping.bind(this)),Txt(t,"data",this.ondata.bind(this)),Txt(t,"error",this.onerror.bind(this)),Txt(t,"close",this.onclose.bind(this)),Txt(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(t){this.decoder.add(t)}ondecoded(t){this.emitReserved("packet",t)}onerror(t){this.emitReserved("error",t)}socket(t,e){let n=this.nsps[t];return n||(n=new Ixt(this,t,e),this.nsps[t]=n),n}_destroy(t){const e=Object.keys(this.nsps);for(const n of e){const t=this.nsps[n];if(t.active)return}this._close()}_packet(t){const e=this.encoder.encode(t);for(let n=0;n<e.length;n++)this.engine.write(e[n],t.options)}cleanup(){this.subs.forEach(t=>t()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,"opening"===this._readyState&&this.cleanup(),this.backoff.reset(),this._readyState="closed",this.engine&&this.engine.close()}disconnect(){return this._close()}onclose(t){this.cleanup(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",t),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const t=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const e=this.backoff.duration();this._reconnecting=!0;const n=this.setTimeoutFn(()=>{t.skipReconnect||(this.emitReserved("reconnect_attempt",t.backoff.attempts),t.skipReconnect||t.open(e=>{e?(t._reconnecting=!1,t.reconnect(),this.emitReserved("reconnect_error",e)):t.onreconnect()}))},e);this.opts.autoUnref&&n.unref(),this.subs.push((function(){clearTimeout(n)}))}}onreconnect(){const t=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",t)}}const Fxt={};function Bxt(t,e){"object"===typeof t&&(e=t,t=void 0),e=e||{};const n=Wwt(t,e.path||"/socket.io"),r=n.source,i=n.id,o=n.path,s=Fxt[i]&&o in Fxt[i]["nsps"],a=e.forceNew||e["force new connection"]||!1===e.multiplex||s;let u;return a?u=new Rxt(r,e):(Fxt[i]||(Fxt[i]=new Rxt(r,e)),u=Fxt[i]),n.query&&!e.query&&(e.query=n.queryKey),u.socket(n.path,e)}Object.assign(Bxt,{Manager:Rxt,Socket:Ixt,io:Bxt,connect:Bxt});var jxt,zxt,Uxt={},$xt={name:"MqttClient",data:function(){return{client:null,usermessage:"Initialized",datamessage:"Initialized",clientid:null,backend_online:null,chatShow:!1,chatTopic:"",id:null,type:null,lineshowDialog:!1,subshowDialog:!1,children:{},name:"",simID:this.$store.state.simID,socket:null}},props:{subtopic:{type:Array||String||Object,default:function(){return["ds/data","ds/note","ds/system","user/schedule","user/share"]}},pubtopic:{type:String||Array||Object,default:"/user/cmd"},address:{type:String,default:"localhost:8083/mqtt"},qos:{type:Number,default:0},protocol:{type:String,default:"ws"},username:{type:String,default:""},password:{type:String,default:""}},created:function(){},mounted:function(){var t=this,e=["/ds/data","/ds/note","/ds/system","/ds/schedule","/ds/share","test"],n=this.$store.state.loginInfo;n.direct?this.socket=Bxt("ws://localhost:".concat(n.server_port)):this.socket=Bxt("ws://".concat(n.ip,":").concat(n.server_port)),this.socket.on("connect",(function(){console.log(t.socket.id)})),this.socket.on("disconnect",(function(){console.log(t.socket.id)})),e.forEach((function(e){t.socket.on(e,(function(n){t.onMessage(e,$wt(n))}))}))},computed:Object(x["a"])({},Object(C["b"])(["getPubStatus","getNewSubscribe","getNewPublish","startsimtrigger","pausesimtrigger","continuesimtrigger","abortsimtrigger","getSchedule","ViolatedBuses"])),watch:{getPubStatus:function(t,e){var n={user:this.$store.state.username,type:this.$store.state.message[0],id:this.$store.state.message[1],name:this.$store.state.message[2],action:this.$store.state.message[3]};if(this.socket.emit(this.simID+"/user/cmd",n),this.$store.commit("addReportUser",{time:this.$store.state.currentTime,event:[n.type,n.id,n.action]}),"Gen"==n.type&&["OPEN","CLOSE"].includes(n.action)){var r=n.name.split("#")[0];this.$store.commit("addCost",this.$store.state.areadetail.content.Gen[r]["OperationCost"])}},getNewSubscribe:function(t,e){var n=this;this.socket.on(t,(function(e){n.onMessage(t,$wt(e))})),swt.a.success({title:"System",message:"Successfully subscribed to a new topic #"+t,position:"topRight"})},getNewPublish:function(t,e){this.socket.emit(t[0],"User #"+this.$store.state.username+": "+t[1])},startsimtrigger:function(){this.$store.state.simtime?(this.socket.emit(this.simID+"/user/system",this.$store.state.username+":run till seconds "+this.$store.state.simtime),this.$store.commit("clearsimtime")):this.socket.emit(this.simID+"/user/system",this.$store.state.username+":Start")},continuesimtrigger:function(){this.socket.emit(this.simID+"/user/system",this.$store.state.username+":Continue")},pausesimtrigger:function(){this.socket.emit(this.simID+"/user/system",this.$store.state.username+":Pause")},abortsimtrigger:function(){this.socket.emit(this.simID+"/user/system",this.$store.state.username+":Abort")},backend_online:function(){swt.a.success({title:"System",message:"DS backend is connected",position:"topRight"})},getSchedule:function(t,e){this.socket.emit(this.simID+"/user/schedule",JSON.stringify({user:this.$store.state.username,type:"Import",schedule:t}))}},methods:{onInitClient:function(){this.onGetUUID(),Uxt=nwt.a.connect(this.protocol+"://"+this.address,{clientId:this.clientid,username:this.username,password:this.password}),console.log(this.protocol+"://"+this.address),Uxt.on("connect",this.onConnect),Uxt.on("message",this.onMessage),Uxt.on("close",this.onClose),Uxt.on("reconnect",this.onReconnect),Uxt.on("offline",this.onOffline),Uxt.on("error",this.onError),Uxt.on("end",this.onEnd)},onGetUUID:function(){var t=this;iwt()().get((function(e,n){t.clientid=e.substring(0,4),t.$store.commit("setUUID",t.clientid)}))},onConnect:function(t){var e=this;console.log("MQTT broker is connected");var n=this.subtopic;n=n.map((function(t){return e.simID+"/"+t})),Uxt.subscribe(n),console.log(n),swt.a.success({title:"System",message:"MQTT broker is connected",position:"topRight"})},onMessage:function(t,e){var n=this;if(t.includes("ds/data"))this.$store.commit("updateRawData",e),this.backend_online=!0;else if(t.includes("ds/note")){var r=e.toString().split("@");this.usermessage=r[0],this.$store.state.notMuted&&swt.a.warning({title:"System",message:this.usermessage,position:"topCenter",timeout:3e3,buttons:[["<button>What?!</button>",function(){if(n.usermessage.includes("Branch"))n.id=r[1],n.name=r[2],n.type="Branch",n.lineshowDialog=!0;else if(n.usermessage.includes("Load")||n.usermessage.includes("Gen")||n.usermessage.includes("Shunt")){var t;(function(){var e=r[1].split(",")[0];n.name=r[2].split("Bus")[0],n.type="Substation";var i=function(r){if(t=n.$store.state.subDetail[r].Bus.find((function(t){if(t["Int.Bus Number"]==e)return n.id=r,n.children=n.$store.state.subDetail[r].Bus,!0})),t)return n.subshowDialog=!0,"break"};for(var o in n.$store.state.subDetail){var s=i(o);if("break"===s)break}})()}}]]}),this.$store.commit("updatebadge"),this.$store.commit("updatebadgelist",{title:this.usermessage,source:"System",color:"yellow",time:Date.now()})}else if(t.includes("ds/system"))swt.a.warning({title:"System",message:e.toString(),position:"topCenter",timeout:6500}),["The simulation has been aborted","The system goes blackout"].includes(e.toString())?(this.$store.commit("setstartready"),e.toString().includes("blackout")&&this.$store.commit("setRIndex",0)):e.toString().includes("The simulation is started")?(this.$store.commit("resetClock"),this.$store.commit("resetReport"),this.$store.commit("resetAreaLoad"),this.$store.commit("resetBusVoltage"),this.$store.commit("resetAction"),this.$store.commit("resetTotalCost"),this.$store.commit("setStartTime",+e.toString().split("@")[1]),this.$store.commit("setstartdisable"),this.$store.commit("flipStartToggler")):e.toString().includes("The simulation has finished")&&this.$store.commit("setSimOver"),this.$store.commit("updatebadge"),this.$store.commit("updatebadgelist",{title:e.toString(),source:"System",color:"red",time:Date.now()});else if(t.includes("user/schedule")){var i=e.toString();this.$store.commit("setSchedule",JSON.parse(i)["schedule"]),swt.a.show({title:"Schedule",message:"The import schedule has been changed to "+JSON.parse(i)["schedule"].split("@")[0]+"MW @ $"+JSON.parse(i)["schedule"].split("@")[1]+"/MW",color:"yellow",position:"topCenter"})}else swt.a.show({title:e.toString().split(":")[0],message:e.toString().split(":")[1],color:"yellow",position:"topCenter",buttons:[["<button>Chat</button>",function(){n.chatTopic=t,n.chatShow=!0}]]}),this.$store.commit("updatebadge"),this.$store.commit("updatebadgelist",{title:e.toString(),source:"user",color:"light-blue",time:Date.now()})},onClose:function(){console.log("onClose")},onReconnect:function(){console.log("onReconnect"),swt.a.success({title:"System",message:"MQTT broker is being reconnected",position:"topRight"})},onOffline:function(){console.log("onOffline"),swt.a.error({title:"System",message:"MQTT broker is disconnected",position:"topRight"})},onError:function(t){console.log("onError: "+t)},onEnd:function(){console.log("onEnd")}},components:{chatpop:function(){return n.e("chunk-2d0b9d2c").then(n.bind(null,"351e"))},linepop:function(){return n.e("chunk-2d213000").then(n.bind(null,"ab8a"))},subpop:function(){return n.e("chunk-2d0d0083").then(n.bind(null,"65f4"))}}},Vxt=$xt,qxt=Object(P["a"])(Vxt,Q_t,twt,!1,null,"54ec8332",null),Wxt=qxt.exports,Gxt=(n("5319"),function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return t[Math.floor(Math.random()*t.length)]}),Hxt=function(t){return(t||"").replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()},Xxt=function(){var t=window.document,e=t.documentElement,n=e.requestFullscreen||e.mozRequestFullScreen||e.webkitRequestFullScreen||e.msRequestFullscreen,r=t.exitFullscreen||t.mozCancelFullScreen||t.webkitExitFullscreen||t.msExitFullscreen;t.fullscreenElement||t.mozFullScreenElement||t.webkitFullscreenElement||t.msFullscreenElement?r.call(t):n.call(e)},Yxt={randomElement:Gxt,toggleFullScreen:Xxt,kebab:Hxt},Zxt=(n("159b"),n("7909")),Kxt=[],Jxt=[],Qxt=[],tSt=[],eSt=[],nSt={data:function(){return{anchor:null,genDataLength:null,show:!1,marginalcost:[],gens:null,areaData:[],areaDataLength:this.$store.state.fieldstore["Area"]["Field"].length,busAnchor:0,busDataLength:0,busArrLength:0,formatRiskBuses:[],busData:[],violateBuses:[],branchData:[],transformerData:[],branchAnchor:0,branchDataLength:0,branchArrLength:0,transformerAnchor:0,transformerDataLength:0,transformerArrLength:0,highRiskLines:{},formatRiskLines:[],subdata:[],linedata:[],transformerDict:[],subdetail:[],busdetail:[],area_index:0,genArray:[],busArray:[],areaBus:{},branchArray:[],transformerArray:[],busIDArray:[4195,4146,4056,4181,4192,4039,4151,4196,4073,4070,4158,4140,4113,4080,4004,4183,4041],busIndexArray:[]}},methods:{before_init:function(){var t=this,e=this.$store.state.casedetail,n=this.$store.state.areadetail,r=0,i=0,o=[],s=[],a=[],u=[];if(this.area_index=Object.keys(this.$store.state.casedetail.content.Area).indexOf(this.$store.state.area.toString()),"dsmDictionary"==e.content.type){for(var c in e.content.Substation)e.content.Substation[c]["Int.Area Number"]==+this.$store.state.area?(a.push(e.content.Substation[c]["Double.Longitude"]),u.push(e.content.Substation[c]["Double.Latitude"]),this.subdata.push({id:c,name:e.content.Substation[c]["String.Name"],value:[e.content.Substation[c]["Double.Longitude"],e.content.Substation[c]["Double.Latitude"]],attributes:{Gen:!1,Shunt:!1},bus:[]})):o.push({name:e.content.Substation[c]["String.Name"],value:[e.content.Substation[c]["Double.Longitude"],e.content.Substation[c]["Double.Latitude"]]});for(var l in this.$store.commit("setCenter",[Zxt["c"](a),Zxt["c"](u)]),e.content.Branch){var h=l.split(",")[0],f=l.split(",")[1],d=[[e.content.Substation[e.content.Bus[h]["Int.Sub Number"].toString()]["Double.Longitude"],e.content.Substation[e.content.Bus[h]["Int.Sub Number"].toString()]["Double.Latitude"]],[e.content.Substation[e.content.Bus[f]["Int.Sub Number"].toString()]["Double.Longitude"],e.content.Substation[e.content.Bus[f]["Int.Sub Number"].toString()]["Double.Latitude"]]];[e.content.Branch[l]["FromArea"],e.content.Branch[l]["ToArea"]].includes(+this.$store.state.area)?(this.branchArray.push(i),this.linedata.push({id:l,name:e.content.Substation[e.content.Bus[h]["Int.Sub Number"].toString()]["String.Name"].split("_")[0]+"-"+e.content.Substation[e.content.Bus[f]["Int.Sub Number"].toString()]["String.Name"].split("_")[0],coords:d,count:1,attributes:{MVALimit:e.content.Branch[l]["Single.MVA Limit"],volt:e.content.Bus[h]["Single.Nominal kV"]}})):0==e.content.Branch[l]["Byte.Type"]&&s.push({name:e.content.Substation[e.content.Bus[h]["Int.Sub Number"].toString()]["String.Name"].split("_")[0]+"-"+e.content.Substation[e.content.Bus[f]["Int.Sub Number"].toString()]["String.Name"].split("_")[0],coords:d}),i++}for(var p in e.content.Transformer){var g=p.split(",")[0],m=p.split(",")[1],y=[[e.content.Substation[e.content.Bus[g]["Int.Sub Number"].toString()]["Double.Longitude"],e.content.Substation[e.content.Bus[g]["Int.Sub Number"].toString()]["Double.Latitude"]],[e.content.Substation[e.content.Bus[m]["Int.Sub Number"].toString()]["Double.Longitude"],e.content.Substation[e.content.Bus[m]["Int.Sub Number"].toString()]["Double.Latitude"]]];[e.content.Transformer[p]["FromArea"],e.content.Transformer[p]["ToArea"]].includes(+this.$store.state.area)&&(this.transformerArray.push(i),this.transformerDict.push({id:p,name:e.content.Substation[e.content.Bus[g]["Int.Sub Number"].toString()]["String.Name"].split("_")[0]+"-"+e.content.Substation[e.content.Bus[m]["Int.Sub Number"].toString()]["String.Name"].split("_")[0],coords:y,count:1,attributes:{}})),i++}for(var v in this.$store.state.areadetail.content.Bus)this.$store.state.areadetail.content.Bus[v]["Int.Area Number"]==+this.$store.state.area&&(this.busArray.push(r),this.areaBus[v]=this.$store.state.areadetail.content.Bus[v]),r++;this.subdetail=n.content.Substation,this.busdetail=n.content.Bus;var b=Object.keys(n.content.Bus);this.busIDArray.forEach((function(e){t.busIndexArray.push(b.indexOf(e.toString()))}));var _=Object.keys(n.content.Substation);for(var w in this.subdetail)this.subdetail[w].Bus=[];for(var x in n.content.Gen)this.busdetail[x.split(",")[0]].Gen=n.content.Gen[x],this.subdata[_.indexOf(n.content.Bus[n.content.Gen[x]["Int.Bus Number"].toString()]["Int.Sub Number"].toString())].attributes.Gen=!0;for(var S in n.content.Load)this.busdetail[S.split(",")[0]].Load=n.content.Load[S];for(var E in n.content.Shunt)this.busdetail[E.split(",")[0]].Shunt=n.content.Shunt[E],this.subdata[_.indexOf(n.content.Bus[n.content.Shunt[E]["Int.Bus Number"].toString()]["Int.Sub Number"].toString())].attributes.Shunt=!0;for(var A in n.content.Bus)this.subdetail[n.content.Bus[A]["Int.Sub Number"]].Bus.push(this.busdetail[A]);this.$store.commit("setSubData",this.subdata),this.$store.commit("setLineData",this.linedata),this.$store.commit("setTransformerDict",this.transformerDict),this.$store.commit("setOtherArea",{Substation:o,Branch:s}),this.$store.commit("updateSubDetail",this.subdetail)}},initRiskBus:function(){var t,e;for(var n in this.$store.state.fieldstore){if(t=this.$store.state.fieldstore[n]["Field"].length,e=Object.keys(this.$store.state.areadetail.content[n]),Object.values(this.$store.state.fieldstore[n]),"Bus"==n){this.busDataLength=t*e.length,this.busArrLength=t;break}this.busAnchor+=t*e.length}},onMonitorRiskBus:function(){for(var t=0,e=0,n=Object.entries(this.areaBus);e<n.length;e++){var r=Object(Lt["a"])(n[e],2),i=r[0],o=r[1];Qxt[this.busArray[t]*this.busArrLength]<=o["Single.Max Limit"]||Qxt[this.busArray[t]*this.busArrLength]>=o["Single.Min Limit"]?(this.violateBuses[i]={},this.violateBuses[i]["name"]=this.$store.state.areadetail.content.Bus[i]["String.Name"],this.violateBuses[i]["Vpu"]=Qxt[this.busArray[t]*this.busArrLength],this.violateBuses[i]["Max"]=o["Single.Min Limit"],this.violateBuses[i]["Min"]=o["Single.Max Limit"],this.violateBuses[i]["SubID"]=o["Int.Sub Number"],this.violateBuses[i]["value"]=[this.$store.state.areadetail.content.Substation[o["Int.Sub Number"].toString()]["Double.Longitude"],this.$store.state.areadetail.content.Substation[o["Int.Sub Number"].toString()]["Double.Latitude"]]):i in this.violateBuses&&delete this.violateBuses[i],t++}this.formatRiskBuses=Object.values(this.violateBuses),this.$store.commit("setRiskBuses",this.formatRiskBuses)},initRiskBranch:function(){var t,e;for(var n in this.$store.state.fieldstore){if(t=this.$store.state.fieldstore[n]["Field"].length,e=Object.keys(this.$store.state.areadetail.content[n]),Object.values(this.$store.state.fieldstore[n]),"Branch"==n){this.branchDataLength=t*e.length,this.branchArrLength=t;break}this.branchAnchor+=t*e.length}},initRiskTransformer:function(){var t,e;for(var n in this.$store.state.fieldstore){if(t=this.$store.state.fieldstore[n]["Field"].length,e=Object.keys(this.$store.state.areadetail.content[n]),Object.values(this.$store.state.fieldstore[n]),"Transformer"==n){this.transformerDataLength=t*e.length,this.transformerArrLength=t;break}this.transformerAnchor+=t*e.length}},onMonitorRiskBranch:function(){var t;for(var e in this.linedata)t=this.linedata[e].id,tSt[e*this.branchArrLength+3]>=.85*this.linedata[e].attributes.MVALimit?(this.highRiskLines[t]={},this.highRiskLines[t]["name"]=this.$store.state.casedetail.content.Bus[t.split(",")[0]]["String.Name"]+"-"+this.$store.state.casedetail.content.Bus[t.split(",")[1]]["String.Name"],this.highRiskLines[t]["MVA"]=tSt[e*this.branchArrLength+3],this.highRiskLines[t]["Ratio"]=(tSt[e*this.branchArrLength+3]/this.linedata[e].attributes.MVALimit*100).toFixed(2),this.highRiskLines[t]["MVALimit"]=this.linedata[e].attributes.MVALimit,this.highRiskLines[t]["coords"]=this.linedata[e].coords):t in this.highRiskLines&&delete this.highRiskLines[t];this.formatRiskLines=Object.values(this.highRiskLines),this.$store.commit("setRiskBranches",this.formatRiskLines),this.$store.commit("updateSelectedBranches",this.formatRiskLines)},initData:function(){var t,e=[],n=0;for(var r in this.$store.state.areadetail.content.Gen)this.$store.state.areadetail.content.Gen[r]["Int.Area Number"]==+this.$store.state.area&&(this.genArray.push(n),t=this.$store.state.areadetail.content.Bus[r.split(",")[0]]["Int.Sub Number"],e.push({value:[this.$store.state.areadetail.content.Substation[t.toString()]["Double.Longitude"],this.$store.state.areadetail.content.Substation[t.toString()]["Double.Latitude"]],key:r,name:this.$store.state.areadetail.content.Bus[r.split(",")[0]]["String.Name"],Status:1,vStatus:1,MWMax:this.$store.state.areadetail.content.Gen[r]["Single.MW Max Limit"],MWMin:this.$store.state.areadetail.content.Gen[r]["Single.MW Min Limit"],MW:0,Mvar:0,MWSetpoint:0,VpuSetpoint:1,OperationCost:this.$store.state.areadetail.content.Gen[r]["MarginalCostCoefficients"][1],MarginalCostCoefficients:this.$store.state.areadetail.content.Gen[r]["MarginalCostCoefficients"],MarginalCost:this.$store.state.areadetail.content.Gen[r]["MarginalCostCoefficients"][0],id:this.$store.state.areadetail.content.Gen[r]["String.ID"],AGC:!1})),n++;return Kxt=e,Kxt.length>1?Promise.resolve("Table initialized properly"):Promise.reject("Error in initialization")},preProcess:function(){var t,e,n=0;for(var r in this.$store.state.fieldstore){if(t=this.$store.state.fieldstore[r]["Field"].length,e=Object.keys(this.$store.state.areadetail.content[r]),"Gen"==r)break;n+=t*e.length,console.log([r,n])}this.anchor=n,this.genDataLength=t},regularLoop:function(){var t=this.rawData;this.$store.commit("setCurrentTime",+t["SOC"]),this.$store.commit("setCurrentStatus",t["Status"]);var e=t.Data;this.$store.commit("setParsedData",e),Jxt=e.slice(this.area_index*this.areaDataLength,this.area_index*this.areaDataLength+this.areaDataLength),Qxt=e.slice(this.busAnchor,this.busAnchor+this.busDataLength);var n=["2018/11/29 "+this.$store.state.clockTime];for(var r in this.busIndexArray.forEach((function(t){n.push(Qxt[9*t]+(Math.random()-.5)/100)})),tSt=e.slice(this.branchAnchor,this.branchAnchor+this.branchDataLength),eSt=e.slice(this.transformerAnchor,this.transformerAnchor+this.transformerDataLength),this.$store.commit("setBranchData",tSt),this.$store.commit("setTransformerData",eSt),this.$store.commit("setData",e),this.$store.commit("setAreaData",Jxt),this.$store.commit("setBusVoltage",n),this.$store.commit("setAreaLoad",["2018/11/29 "+this.$store.state.clockTime,Jxt[2]]),Kxt)Kxt[r].MW=e[this.anchor+6+this.genArray[r]*this.genDataLength],Kxt[r].Mvar=e[this.anchor+7+this.genArray[r]*this.genDataLength],Kxt[r].MWSetpoint=e[this.anchor+9+this.genArray[r]*this.genDataLength],Kxt[r].VpuSetpoint=e[this.anchor+8+this.genArray[r]*this.genDataLength],Kxt[r].Status=e[this.anchor+5+this.genArray[r]*this.genDataLength],void 0!=this.$store.state.genAction["Gen"][Kxt[r].key]?this.$store.state.currentTime>=Math.max(this.$store.state.genAction["Gen"][Kxt[r].key])+3&&(Kxt[r].vStatus=Kxt[r].Status):Kxt[r].vStatus=Kxt[r].Status;this.$store.commit("updateGenData",Kxt)},updateMC:function(){for(var t in Kxt)Kxt[t].MarginalCost=Kxt[t].MarginalCostCoefficients[0].toFixed(2);this.$store.commit("updateGenData",Kxt)},updateTotalCost:function(){var t=this;setInterval((function(){var e=0;if(t.$store.state.schedule?(e=+t.$store.state.schedule.split("@")[0]*+t.$store.state.schedule.split("@")[1],t.$store.commit("setACE",-(+t.$store.state.schedule.split("@")[0]+t.$store.state.areaData[6]))):t.$store.commit("setACE",-t.$store.state.areaData[6]),"running"===t.$store.state.status){var n=0,r=t.$store.state.areaData[2];for(var i in Kxt)n+=Kxt[i].MarginalCostCoefficients[0]*Kxt[i].MW*1+Kxt[i].MarginalCostCoefficients[1];n+=Zxt["a"](t.$store.state.ACE,0)*t.$store.state.aceCost+e,t.$store.commit("updateUnitTimeCost",+n.toFixed(0)),n/=120,r=1*r/120,t.$store.commit("addCost",+n.toFixed(0)),t.$store.commit("addMWh",+r.toFixed(2))}}),500)},addAreaHelper:function(){var t={Bus:{anchor:this.busAnchor,length:this.busArrLength,list:this.busArray},Gen:{anchor:this.anchor,length:this.genDataLength,list:this.genArray},Branch:{anchor:this.branchAnchor,length:this.branchArrLength,list:this.branchArray},Transformer:{anchor:this.transformerAnchor,length:this.transformerArrLength,list:this.transformerArray}};this.$store.commit("setAreaHelper",t)}},created:function(){var t=this;this.before_init(),this.preProcess(),this.initData(),this.initRiskBus(),this.initRiskBranch(),this.initRiskTransformer(),this.addAreaHelper(),this.updateTotalCost(),setInterval((function(){var e,n;"running"===t.$store.state.status&&t.$store.commit("addReportData",{time:t.$store.state.currentTime,areaData:Jxt});var r=0;for(var i in t.$store.state.genData)e=t.$store.state.genData[i].Status,n=t.$store.state.genData[i].MWMax,0==e&&0!=n&&(r+=t.$store.state.genData[i].MWMax);var o=Math.abs(Math.round(t.$store.state.totalCapacity-r-t.$store.state.areaData[0]));t.$store.commit("setGenStat",[o,r])}),1e3),setInterval((function(){"running"===t.$store.state.status&&(t.formatRiskBuses.length>0&&t.$store.commit("addReportViolate",{time:t.$store.state.currentTime,Bus:t.formatRiskBuses}),t.formatRiskLines.length>0&&t.$store.commit("addReportViolate",{time:t.$store.state.currentTime,Branch:t.formatRiskLines}))}),5e3),setInterval((function(){if("running"===t.$store.state.status){var e=0;if(t.formatRiskLines.length)for(var n in t.formatRiskLines)+t.formatRiskLines[n]["Ratio"]>100&&e++;var r=Math.round(50*(Math.exp(-.05*t.formatRiskBuses.length)+Math.exp(-.1*e)));t.$store.commit("setRIndex",r),t.$store.commit("addReportScore",{time:t.$store.state.currentTime,RIndex:r,TCost:t.$store.state.totalCost})}}),1e3)},computed:Object(x["a"])({},Object(C["b"])({rawData:"rawData"})),watch:{rawData:function(){this.regularLoop(),this.onMonitorRiskBus(),this.onMonitorRiskBranch()}},render:function(){return null}},rSt=nSt,iSt=Object(P["a"])(rSt,jxt,zxt,!1,null,null,null),oSt=iSt.exports,sSt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div")},aSt=[],uSt=n("2ef0"),cSt=n.n(uSt),lSt={data:function(){return{anchor:null,genDataLength:null,show:!1,marginalcost:[],gens:null,Interval:null}},methods:{updateAGC:function(){var t=this;this.Interval=setInterval((function(){if("running"==t.$store.state.status&&t.$store.state.ACE){var e=[];for(var n in t.$store.state.genData)t.$store.state.genData[n].AGC&&e.push(t.$store.state.genData[n]);e.length>0&&t.dispatchAGC(e)}}),3e3)},dispatchAGC:function(t){var e;if(t.length>1)for(var n in e=this.$store.state.ACE>0?cSt.a.orderBy(t,["MarginalCost"],["asc"]):cSt.a.orderBy(t,["MarginalCost"],["desc"]),e){if(e[n].MWSetpoint<e[n].MWMax&&this.$store.state.ACE>0){this.updateSingleAGC(e[n]);break}if(e[n].MWSetpoint>e[n].MWMin&&this.$store.state.ACE<0){this.updateSingleAGC(e[n]);break}}else this.updateSingleAGC(t[0])},updateSingleAGC:function(t){var e,n;e=Math.min(t.MWMax,Math.max(t.MW+this.$store.state.ACE,0)).toFixed(2),e!=t.MWSetpoint&&(n="Set Power "+e+" MW",this.$store.commit("setMessage",["Gen",t.key+","+t.id,t.key+"#"+t.id,n]),this.$store.commit("setPublish"),this.$store.commit("addReportUser",{time:this.$store.state.currentTime,event:["AGC",t.key+","+t.id,n]}))}},created:function(){this.updateAGC()},beforeDestroy:function(){clearInterval(this.Interval)}},hSt=lSt,fSt=Object(P["a"])(hSt,sSt,aSt,!1,null,null,null),dSt=fSt.exports,pSt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("div",{directives:[{name:"show",rawName:"v-show",value:"running"===t.status,expression:"status==='running'"}]},[n("marquee-text",{attrs:{repeat:30,duration:10}},[n("span",{staticStyle:{"background-color":"#80e27e","padding-right":"30px","box-sizing":"border-box"}},[t._v("RUNNING")])])],1),n("div",{directives:[{name:"show",rawName:"v-show",value:"paused"===t.status,expression:"status==='paused'"}]},[n("marquee-text",{attrs:{repeat:30}},[n("span",{staticStyle:{"background-color":"#ffff8b","padding-right":"30px","box-sizing":"border-box"}},[t._v("PAUSED")])])],1),n("div",{directives:[{name:"show",rawName:"v-show",value:"initialized"===t.status,expression:"status==='initialized'"}]},[n("marquee-text",{attrs:{repeat:30}},[n("span",{staticStyle:{"background-color":"#ffff8b","padding-right":"30px","box-sizing":"border-box"}},[t._v("INITIALIZED")])])],1),n("div",{directives:[{name:"show",rawName:"v-show",value:"aborted"===t.status,expression:"status==='aborted'"}]},[n("marquee-text",{attrs:{repeat:30}},[n("span",{staticStyle:{"background-color":"#be9c91","padding-right":"30px","box-sizing":"border-box"}},[t._v("ABORTED")])])],1),n("div",{directives:[{name:"show",rawName:"v-show",value:"finished"===t.status,expression:"status==='finished'"}]},[n("marquee-text",{attrs:{repeat:30}},[n("span",{staticStyle:{"background-color":"#ff5f52","padding-right":"30px","box-sizing":"border-box"}},[t._v("FINISHED")])])],1),n("div",{directives:[{name:"show",rawName:"v-show",value:"offline"===t.status,expression:"status==='offline'"}]},[n("marquee-text",{attrs:{repeat:30,duration:30}},[n("span",{staticStyle:{"background-color":"#8e8e8e","padding-right":"30px","box-sizing":"border-box"}},[t._v("DISCONNECTED")])])],1),n("div",{directives:[{name:"show",rawName:"v-show",value:"error"===t.status,expression:"status==='error'"}]},[n("marquee-text",{attrs:{repeat:30,duration:30}},[n("span",{staticStyle:{"background-color":"#ff6f60","padding-right":"30px","box-sizing":"border-box"}},[t._v("DS needs to be reset manually")])])],1)])},gSt=[],mSt=n("0150"),ySt=n.n(mSt),vSt={data:function(){return{content:"offline"}},computed:Object(x["a"])({},Object(C["c"])(["status"])),mounted:function(){},components:{MarqueeText:ySt.a}},bSt=vSt,_St=Object(P["a"])(bSt,pSt,gSt,!1,null,null,null),wSt=_St.exports,xSt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"clock",attrs:{id:"MyClockDisplay"}})},SSt=[],ESt={methods:{showTime:function(){if(this.$store.state.currentTime){var t=new Date(1e3*this.$store.state.currentTime),e=t.getHours(),n=t.getMinutes(),r=t.getSeconds();0==e&&(e=12),n=(60*e+n)%24,e=e<10?"0"+e:e,n=n<10?"0"+n:n,r=r<10?"0"+r:r;var i=n+":"+r+":00";this.$store.commit("setClock",i),document.getElementById("MyClockDisplay").innerText=i,document.getElementById("MyClockDisplay").textContent=i}}},mounted:function(){this.showTime()},computed:Object(x["a"])({},Object(C["b"])(["getCurrentTime"])),watch:{getCurrentTime:function(){this.showTime()}}},ASt=ESt,MSt=(n("2904"),Object(P["a"])(ASt,xSt,SSt,!1,null,null,null)),CSt=MSt.exports,kSt={data:function(){return{drawer:!0,dialog:!1,show:!1,startDialog:!1,reportDialog:!1,showToolbar:!0}},computed:Object(x["a"])(Object(x["a"])(Object(x["a"])({},Object(C["c"])(["rIndex","badge","ready4start","isAdmin","badgeShow"])),Object(C["b"])({simOverFlag:"getSimOver"})),{},{page:function(){return this.$store.getters.page}}),components:{chatpop:function(){return n.e("chunk-2d0b9d2c").then(n.bind(null,"351e"))},startpop:function(){return n.e("chunk-2d0f0898").then(n.bind(null,"9d90"))},reportpop:function(){return n.e("chunk-c66c6efe").then(n.bind(null,"3ec6"))},MqttClient:Wxt,Home:function(){return Promise.resolve().then(n.bind(null,"bb51"))},IkView:function(){return n.e("chunk-5019b404").then(n.bind(null,"d4b7"))},generator:ct,load:wt,shunt:zt,admin:te,NotificationList:function(){return n.e("chunk-2a4e6cda").then(n.bind(null,"a95e"))},AGCBot:dSt,branch:fe,areastrip:be,hourlystrip:Ae,busstrip:Ie,oneline:Ue,sanddance:g_t,marquee:wSt,Clock:CSt,generationVis:k_t,generationPie:G_t,sysInfo:J_t,DataProcessing:oSt},methods:{handleFullScreen:function(){Yxt.toggleFullScreen()},changeHeight:function(t){this.showToolbar=!1}},watch:{show:function(t,e){0==t&&this.$store.commit("resetbadgelist")},simOverFlag:function(){this.reportDialog=!0}},mounted:function(){}},OSt=kSt,PSt=(n("812b"),Object(P["a"])(OSt,_,w,!1,null,null,null));e["default"]=PSt.exports},"0cb2":function(t,e,n){var r=n("e330"),i=n("7b0b"),o=Math.floor,s=r("".charAt),a=r("".replace),u=r("".slice),c=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,l=/\$([$&'`]|\d{1,2})/g;t.exports=function(t,e,n,r,h,f){var d=n+t.length,p=r.length,g=l;return void 0!==h&&(h=i(h),g=c),a(f,g,(function(i,a){var c;switch(s(a,0)){case"$":return"$";case"&":return t;case"`":return u(e,0,n);case"'":return u(e,d);case"<":c=h[u(a,1,-1)];break;default:var l=+a;if(0===l)return i;if(l>p){var f=o(l/10);return 0===f?i:f<=p?void 0===r[f-1]?s(a,1):r[f-1]+s(a,1):i}c=r[l-1]}return void 0===c?"":c}))}},"0de6":function(t,e,n){},"0df6":function(t,e,n){"use strict";t.exports=function(t){return function(e){return t.apply(null,e)}}},1050:function(t,e,n){"use strict";(function(t){var r=n("4ea4");Object.defineProperty(e,"__esModule",{value:!0}),e.default=s,e.isBrowserMainThread=a;var i=r(n("7037")),o=r(n("4ed1"));function s(){var e="object"===("undefined"===typeof t?"undefined":(0,i.default)(t))&&"[object process]"===String(t)&&!t.browser;return!e||(0,o.default)()}function a(){return s()&&"undefined"!==typeof document}}).call(this,n("4362"))},"109a":function(t,e,n){(function(t){var r;(function(t,i,o){function s(t){var e=this,n="";e.x=0,e.y=0,e.z=0,e.w=0,e.next=function(){var t=e.x^e.x<<11;return e.x=e.y,e.y=e.z,e.z=e.w,e.w^=e.w>>>19^t^t>>>8},t===(0|t)?e.x=t:n+=t;for(var r=0;r<n.length+64;r++)e.x^=0|n.charCodeAt(r),e.next()}function a(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e}function u(t,e){var n=new s(t),r=e&&e.state,i=function(){return(n.next()>>>0)/4294967296};return i.double=function(){do{var t=n.next()>>>11,e=(n.next()>>>0)/4294967296,r=(t+e)/(1<<21)}while(0===r);return r},i.int32=n.next,i.quick=i,r&&("object"==typeof r&&a(r,n),i.state=function(){return a(n,{})}),i}i&&i.exports?i.exports=u:n("07d6")&&n("3c35")?(r=function(){return u}.call(e,n,e,i),void 0===r||(i.exports=r)):this.xor128=u})(0,t,n("07d6"))}).call(this,n("62e4")(t))},1133:function(t,e,n){"use strict";n("7197")},1231:function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return o}));var r,i,o,s=n("b170");function a(t){return r=Object(s["a"])(t),i=r.format,o=r.formatPrefix,r}a({thousands:",",grouping:[3],currency:["$",""]})},"13b9":function(t,e,n){"use strict";(function(t){n.d(e,"b",(function(){return c})),n.d(e,"a",(function(){return h})),n.d(e,"c",(function(){return f}));var r=n("7ac2"),i=("undefined"===typeof t||"never"!==Object({NODE_ENV:"production",BASE_URL:"",IS_TAURI:!0})["TEXT_ENCODING"])&&"undefined"!==typeof TextEncoder&&"undefined"!==typeof TextDecoder;var o=i?new TextEncoder:void 0;i?"undefined"!==typeof t&&Object({NODE_ENV:"production",BASE_URL:"",IS_TAURI:!0})["TEXT_ENCODING"]:r["a"];function s(t,e,n){e.set(o.encode(t),n)}function a(t,e,n){o.encodeInto(t,e.subarray(n))}null===o||void 0===o||o.encodeInto;var u=4096;function c(t,e,n){var r=e,i=r+n,o=[],s="";while(r<i){var a=t[r++];if(0===(128&a))o.push(a);else if(192===(224&a)){var c=63&t[r++];o.push((31&a)<<6|c)}else if(224===(240&a)){c=63&t[r++];var l=63&t[r++];o.push((31&a)<<12|c<<6|l)}else if(240===(248&a)){c=63&t[r++],l=63&t[r++];var h=63&t[r++],f=(7&a)<<18|c<<12|l<<6|h;f>65535&&(f-=65536,o.push(f>>>10&1023|55296),f=56320|1023&f),o.push(f)}else o.push(a);o.length>=u&&(s+=String.fromCharCode.apply(String,o),o.length=0)}return o.length>0&&(s+=String.fromCharCode.apply(String,o)),s}var l=i?new TextDecoder:null,h=i?"undefined"!==typeof t&&"force"!==Object({NODE_ENV:"production",BASE_URL:"",IS_TAURI:!0})["TEXT_DECODER"]?200:0:r["a"];function f(t,e,n){var r=t.subarray(e,e+n);return l.decode(r)}}).call(this,n("4362"))},"151e":function(t,e,n){},"166a":function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"d",(function(){return o})),n.d(e,"c",(function(){return s})),n.d(e,"e",(function(){return w})),n.d(e,"h",(function(){return E})),n.d(e,"g",(function(){return A})),n.d(e,"b",(function(){return M})),n.d(e,"f",(function(){return L}));var r=n("63ad");function i(){}var o=.7,s=1/o,a="\\s*([+-]?\\d+)\\s*",u="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",c="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",l=/^#([0-9a-f]{3,8})$/,h=new RegExp("^rgb\\("+[a,a,a]+"\\)$"),f=new RegExp("^rgb\\("+[c,c,c]+"\\)$"),d=new RegExp("^rgba\\("+[a,a,a,u]+"\\)$"),p=new RegExp("^rgba\\("+[c,c,c,u]+"\\)$"),g=new RegExp("^hsl\\("+[u,c,c]+"\\)$"),m=new RegExp("^hsla\\("+[u,c,c,u]+"\\)$"),y={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function v(){return this.rgb().formatHex()}function b(){return T(this).formatHsl()}function _(){return this.rgb().formatRgb()}function w(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=l.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?x(e):3===n?new M(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?new M(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?new M(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=h.exec(t))?new M(e[1],e[2],e[3],1):(e=f.exec(t))?new M(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=d.exec(t))?S(e[1],e[2],e[3],e[4]):(e=p.exec(t))?S(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=g.exec(t))?P(e[1],e[2]/100,e[3]/100,1):(e=m.exec(t))?P(e[1],e[2]/100,e[3]/100,e[4]):y.hasOwnProperty(t)?x(y[t]):"transparent"===t?new M(NaN,NaN,NaN,0):null}function x(t){return new M(t>>16&255,t>>8&255,255&t,1)}function S(t,e,n,r){return r<=0&&(t=e=n=NaN),new M(t,e,n,r)}function E(t){return t instanceof i||(t=w(t)),t?(t=t.rgb(),new M(t.r,t.g,t.b,t.opacity)):new M}function A(t,e,n,r){return 1===arguments.length?E(t):new M(t,e,n,null==r?1:r)}function M(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}function C(){return"#"+O(this.r)+O(this.g)+O(this.b)}function k(){var t=this.opacity;return t=isNaN(t)?1:Math.max(0,Math.min(1,t)),(1===t?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===t?")":", "+t+")")}function O(t){return t=Math.max(0,Math.min(255,Math.round(t)||0)),(t<16?"0":"")+t.toString(16)}function P(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new I(t,e,n,r)}function T(t){if(t instanceof I)return new I(t.h,t.s,t.l,t.opacity);if(t instanceof i||(t=w(t)),!t)return new I;if(t instanceof I)return t;t=t.rgb();var e=t.r/255,n=t.g/255,r=t.b/255,o=Math.min(e,n,r),s=Math.max(e,n,r),a=NaN,u=s-o,c=(s+o)/2;return u?(a=e===s?(n-r)/u+6*(n<r):n===s?(r-e)/u+2:(e-n)/u+4,u/=c<.5?s+o:2-s-o,a*=60):u=c>0&&c<1?0:a,new I(a,u,c,t.opacity)}function L(t,e,n,r){return 1===arguments.length?T(t):new I(t,e,n,null==r?1:r)}function I(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function N(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}Object(r["a"])(i,w,{copy:function(t){return Object.assign(new this.constructor,this,t)},displayable:function(){return this.rgb().displayable()},hex:v,formatHex:v,formatHsl:b,formatRgb:_,toString:_}),Object(r["a"])(M,A,Object(r["b"])(i,{brighter:function(t){return t=null==t?s:Math.pow(s,t),new M(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=null==t?o:Math.pow(o,t),new M(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:C,formatHex:C,formatRgb:k,toString:k})),Object(r["a"])(I,L,Object(r["b"])(i,{brighter:function(t){return t=null==t?s:Math.pow(s,t),new I(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?o:Math.pow(o,t),new I(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new M(N(t>=240?t-240:t+120,i,r),N(t,i,r),N(t<120?t+240:t-120,i,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var t=this.opacity;return t=isNaN(t)?1:Math.max(0,Math.min(1,t)),(1===t?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===t?")":", "+t+")")}}))},1738:function(t,e,n){"use strict";n.d(e,"e",(function(){return r})),n.d(e,"c",(function(){return i})),n.d(e,"b",(function(){return o})),n.d(e,"a",(function(){return s})),n.d(e,"f",(function(){return a})),n.d(e,"d",(function(){return u})),n.d(e,"g",(function(){return c}));const r=1e3,i=60*r,o=60*i,s=24*o,a=7*s,u=30*s,c=365*s},1809:function(t,e,n){"use strict";var r=n("18e2"),i=Object(r["a"])((function(){}),(function(t,e){t.setTime(+t+e)}),(function(t,e){return e-t}));i.every=function(t){return t=Math.floor(t),isFinite(t)&&t>0?t>1?Object(r["a"])((function(e){e.setTime(Math.floor(e/t)*t)}),(function(e,n){e.setTime(+e+n*t)}),(function(e,n){return(n-e)/t})):i:null},e["a"]=i;i.range},"18e2":function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=new Date,i=new Date;function o(t,e,n,s){function a(e){return t(e=0===arguments.length?new Date:new Date(+e)),e}return a.floor=function(e){return t(e=new Date(+e)),e},a.ceil=function(n){return t(n=new Date(n-1)),e(n,1),t(n),n},a.round=function(t){var e=a(t),n=a.ceil(t);return t-e<n-t?e:n},a.offset=function(t,n){return e(t=new Date(+t),null==n?1:Math.floor(n)),t},a.range=function(n,r,i){var o,s=[];if(n=a.ceil(n),i=null==i?1:Math.floor(i),!(n<r)||!(i>0))return s;do{s.push(o=new Date(+n)),e(n,i),t(n)}while(o<n&&n<r);return s},a.filter=function(n){return o((function(e){if(e>=e)while(t(e),!n(e))e.setTime(e-1)}),(function(t,r){if(t>=t)if(r<0)while(++r<=0)while(e(t,-1),!n(t));else while(--r>=0)while(e(t,1),!n(t));}))},n&&(a.count=function(e,o){return r.setTime(+e),i.setTime(+o),t(r),t(i),Math.floor(n(r,i))},a.every=function(t){return t=Math.floor(t),isFinite(t)&&t>0?t>1?a.filter(s?function(e){return s(e)%t===0}:function(e){return a.count(0,e)%t===0}):a:null}),a}},"19ac":function(t,e,n){"use strict";(function(t){function r(){let e;if("undefined"!==typeof window&&window.performance)e=window.performance.now();else if("undefined"!==typeof t&&t.hrtime){const n=t.hrtime();e=1e3*n[0]+n[1]/1e6}else e=Date.now();return e}n.d(e,"a",(function(){return r}))}).call(this,n("4362"))},"1a71":function(t,e,n){},"1adc":function(t,e,n){"use strict";(function(t,r){var i=n("4ea4");Object.defineProperty(e,"__esModule",{value:!0}),e.console=e.process=e.document=e.global=e.window=e.self=void 0;var o=i(n("7037")),s={self:"undefined"!==typeof self&&self,window:"undefined"!==typeof window&&window,global:"undefined"!==typeof t&&t,document:"undefined"!==typeof document&&document,process:"object"===("undefined"===typeof r?"undefined":(0,o.default)(r))&&r},a=s.self||s.window||s.global;e.self=a;var u=s.window||s.self||s.global;e.window=u;var c=s.global||s.self||s.window;e.global=c;var l=s.document||{};e.document=l;var h=s.process||{};e.process=h;var f=console;e.console=f}).call(this,n("c8ba"),n("4362"))},"1d2b":function(t,e,n){"use strict";t.exports=function(t,e){return function(){for(var n=new Array(arguments.length),r=0;r<n.length;r++)n[r]=arguments[r];return t.apply(e,n)}}},"1e88":function(t,e,n){"use strict";(function(t){var e=n("26b5"),r=n("5729"),i=n("3f90");function o(t){t.luma=t.luma||{};const{luma:n}=t;return n.polyfilled||(Object(e["a"])(t),a(t),c(t,i["b"]),u(t,{target:n,target2:t}),n.polyfilled=!0),t}const s="undefined"!==typeof t?t:window;function a(t){t.luma.extensions={};const e=t.getSupportedExtensions()||[];for(const n of e)t.luma[n]=t.getExtension(n)}function u(t,{target:e,target2:n}){Object.keys(i["a"]).forEach(r=>{if("function"===typeof i["a"][r]){const o=t[r]?t[r].bind(t):()=>{},s=i["a"][r].bind(null,t,o);e[r]=s,n[r]=s}})}function c(t,e){for(const n of Object.getOwnPropertyNames(e))"overrides"!==n&&l(t,{extension:n,target:t.luma,target2:t})}function l(t,{extension:e,target:n,target2:o}){const s=i["b"][e];Object(r["a"])(s);const{meta:a={}}=s,{suffix:u=""}=a,c=t.getExtension(e);for(const r of Object.keys(s)){const e=`${r}${u}`;let i=null;"meta"===r||"function"===typeof t[r]||(c&&"function"===typeof c[e]?i=(...t)=>c[e](...t):"function"===typeof s[r]&&(i=s[r].bind(n))),i&&(n[r]=i,o[r]=i)}}s.polyfillContext=o}).call(this,n("c8ba"))},"1f31":function(t,e,n){(function(t){var r;(function(t,i,o){function s(t){var e=this;function n(t,e){var n,r=[];if(e===(0|e))r[0]=e;else for(e=""+e,n=0;n<e.length;++n)r[7&n]=r[7&n]<<15^e.charCodeAt(n)+r[n+1&7]<<13;while(r.length<8)r.push(0);for(n=0;n<8&&0===r[n];++n);for(8==n?r[7]=-1:r[n],t.x=r,t.i=0,n=256;n>0;--n)t.next()}e.next=function(){var t,n,r=e.x,i=e.i;return t=r[i],t^=t>>>7,n=t^t<<24,t=r[i+1&7],n^=t^t>>>10,t=r[i+3&7],n^=t^t>>>3,t=r[i+4&7],n^=t^t<<7,t=r[i+7&7],t^=t<<13,n^=t^t<<9,r[i]=n,e.i=i+1&7,n},n(e,t)}function a(t,e){return e.x=t.x.slice(),e.i=t.i,e}function u(t,e){null==t&&(t=+new Date);var n=new s(t),r=e&&e.state,i=function(){return(n.next()>>>0)/4294967296};return i.double=function(){do{var t=n.next()>>>11,e=(n.next()>>>0)/4294967296,r=(t+e)/(1<<21)}while(0===r);return r},i.int32=n.next,i.quick=i,r&&(r.x&&a(r,n),i.state=function(){return a(n,{})}),i}i&&i.exports?i.exports=u:n("07d6")&&n("3c35")?(r=function(){return u}.call(e,n,e,i),void 0===r||(i.exports=r)):this.xorshift7=u})(0,t,n("07d6"))}).call(this,n("62e4")(t))},"1f49":function(t,e,n){"use strict";(function(t){n.d(e,"a",(function(){return f}));var r=n("34ba"),i=n("4f2a"),o=n.n(i),s=n("0299"),a=n.n(s),u=n("af7f"),c=n("744a"),l=n("33e8");const h="undefined"!==typeof navigator&&"string"===typeof navigator.product&&"reactnative"===navigator.product.toLowerCase();class f extends r["a"]{constructor(t){super(t),this.supportsBinary=!t.forceBase64}get name(){return"websocket"}doOpen(){if(!this.check())return;const t=this.uri(),e=this.opts.protocols,n=h?{}:Object(u["b"])(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(n.headers=this.opts.extraHeaders);try{this.ws=c["d"]&&!h?e?new c["a"](t,e):new c["a"](t):new c["a"](t,e,n)}catch(r){return this.emit("error",r)}this.ws.binaryType=this.socket.binaryType||c["b"],this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=this.onClose.bind(this),this.ws.onmessage=t=>this.onData(t.data),this.ws.onerror=t=>this.onError("websocket error",t)}write(e){this.writable=!1;for(let n=0;n<e.length;n++){const r=e[n],i=n===e.length-1;Object(l["c"])(r,this.supportsBinary,e=>{const n={};if(!c["d"]&&(r.options&&(n.compress=r.options.compress),this.opts.perMessageDeflate)){const r="string"===typeof e?t.byteLength(e):e.length;r<this.opts.perMessageDeflate.threshold&&(n.compress=!1)}try{c["d"]?this.ws.send(e):this.ws.send(e,n)}catch(o){}i&&Object(c["c"])(()=>{this.writable=!0,this.emit("drain")},this.setTimeoutFn)})}}doClose(){"undefined"!==typeof this.ws&&(this.ws.close(),this.ws=null)}uri(){let t=this.query||{};const e=this.opts.secure?"wss":"ws";let n="";this.opts.port&&("wss"===e&&443!==Number(this.opts.port)||"ws"===e&&80!==Number(this.opts.port))&&(n=":"+this.opts.port),this.opts.timestampRequests&&(t[this.opts.timestampParam]=a()()),this.supportsBinary||(t.b64=1);const r=o.a.encode(t),i=-1!==this.opts.hostname.indexOf(":");return e+"://"+(i?"["+this.opts.hostname+"]":this.opts.hostname)+n+this.opts.path+(r.length?"?"+r:"")}check(){return!!c["a"]&&!("__initialize"in c["a"]&&this.name===f.prototype.name)}}}).call(this,n("b639").Buffer)},"1f77":function(t,e,n){},"20a4":function(t,e,n){"use strict";e["a"]=(()=>{return"undefined"!==typeof self?self:"undefined"!==typeof window?window:Function("return this")()})()},"221d":function(t,e,n){},2239:function(t,e,n){"use strict";(function(t,r){n.d(e,"b",(function(){return o})),n.d(e,"a",(function(){return s}));const i={self:"undefined"!==typeof self&&self,window:"undefined"!==typeof window&&window,global:"undefined"!==typeof t&&t,document:"undefined"!==typeof document&&document,process:"object"===typeof r&&r},o=(i.self||i.window||i.global,i.window||i.self||i.global),s=(i.global||i.self||i.window,i.document,i.process||{});console}).call(this,n("c8ba"),n("4362"))},"22dc":function(t,e,n){"use strict";(function(t,r){n.d(e,"a",(function(){return o})),n.d(e,"b",(function(){return s}));const i={self:"undefined"!==typeof self&&self,window:"undefined"!==typeof window&&window,global:"undefined"!==typeof t&&t,document:"undefined"!==typeof document&&document},o=(i.self||i.window||i.global,i.window||i.self||i.global,i.global||i.self||i.window||{}),s=(i.document,"object"!==typeof r||"[object process]"!==String(r)||r.browser),a="undefined"!==typeof r&&r.version&&/v([0-9]*)/.exec(r.version);a&&parseFloat(a[1])}).call(this,n("c8ba"),n("4362"))},"234e":function(t,e,n){(function(t){var r;(function(t,i,o){function s(t){var e=this,n="";e.next=function(){var t=e.x^e.x>>>2;return e.x=e.y,e.y=e.z,e.z=e.w,e.w=e.v,(e.d=e.d+362437|0)+(e.v=e.v^e.v<<4^t^t<<1)|0},e.x=0,e.y=0,e.z=0,e.w=0,e.v=0,t===(0|t)?e.x=t:n+=t;for(var r=0;r<n.length+64;r++)e.x^=0|n.charCodeAt(r),r==n.length&&(e.d=e.x<<10^e.x>>>4),e.next()}function a(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e.v=t.v,e.d=t.d,e}function u(t,e){var n=new s(t),r=e&&e.state,i=function(){return(n.next()>>>0)/4294967296};return i.double=function(){do{var t=n.next()>>>11,e=(n.next()>>>0)/4294967296,r=(t+e)/(1<<21)}while(0===r);return r},i.int32=n.next,i.quick=i,r&&("object"==typeof r&&a(r,n),i.state=function(){return a(n,{})}),i}i&&i.exports?i.exports=u:n("07d6")&&n("3c35")?(r=function(){return u}.call(e,n,e,i),void 0===r||(i.exports=r)):this.xorwow=u})(0,t,n("07d6"))}).call(this,n("62e4")(t))},2444:function(t,e,n){"use strict";(function(e){var r=n("c532"),i=n("c8af"),o=n("387f"),s={"Content-Type":"application/x-www-form-urlencoded"};function a(t,e){!r.isUndefined(t)&&r.isUndefined(t["Content-Type"])&&(t["Content-Type"]=e)}function u(){var t;return"undefined"!==typeof XMLHttpRequest?t=n("b50d"):"undefined"!==typeof e&&"[object process]"===Object.prototype.toString.call(e)&&(t=n("b50d")),t}function c(t,e,n){if(r.isString(t))try{return(e||JSON.parse)(t),r.trim(t)}catch(i){if("SyntaxError"!==i.name)throw i}return(n||JSON.stringify)(t)}var l={transitional:{silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},adapter:u(),transformRequest:[function(t,e){return i(e,"Accept"),i(e,"Content-Type"),r.isFormData(t)||r.isArrayBuffer(t)||r.isBuffer(t)||r.isStream(t)||r.isFile(t)||r.isBlob(t)?t:r.isArrayBufferView(t)?t.buffer:r.isURLSearchParams(t)?(a(e,"application/x-www-form-urlencoded;charset=utf-8"),t.toString()):r.isObject(t)||e&&"application/json"===e["Content-Type"]?(a(e,"application/json"),c(t)):t}],transformResponse:[function(t){var e=this.transitional||l.transitional,n=e&&e.silentJSONParsing,i=e&&e.forcedJSONParsing,s=!n&&"json"===this.responseType;if(s||i&&r.isString(t)&&t.length)try{return JSON.parse(t)}catch(a){if(s){if("SyntaxError"===a.name)throw o(a,this,"E_JSON_PARSE");throw a}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};r.forEach(["delete","get","head"],(function(t){l.headers[t]={}})),r.forEach(["post","put","patch"],(function(t){l.headers[t]=r.merge(s)})),t.exports=l}).call(this,n("4362"))},2532:function(t,e,n){"use strict";var r=n("23e7"),i=n("e330"),o=n("5a34"),s=n("1d80"),a=n("577e"),u=n("ab13"),c=i("".indexOf);r({target:"String",proto:!0,forced:!u("includes")},{includes:function(t){return!!~c(a(s(this)),a(o(t)),arguments.length>1?arguments[1]:void 0)}})},2685:function(t,e,n){(function(n){var r,i,o;(function(n,s){i=[],r=s(n),o="function"===typeof r?r.apply(e,i):r,void 0===o||(t.exports=o)})("undefined"!==typeof n?n:window||this.window||this.global,(function(t){"use strict";var e={},n="iziToast",r=(document.querySelector("body"),!!/Mobi/.test(navigator.userAgent)),i=/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor),o="undefined"!==typeof InstallTrigger,s="ontouchstart"in document.documentElement,a=["bottomRight","bottomLeft","bottomCenter","topRight","topLeft","topCenter","center"],u={info:{color:"blue",icon:"ico-info"},success:{color:"green",icon:"ico-success"},warning:{color:"orange",icon:"ico-warning"},error:{color:"red",icon:"ico-error"},question:{color:"yellow",icon:"ico-question"}},c=568,l={};e.children={};var h={id:null,class:"",title:"",titleColor:"",titleSize:"",titleLineHeight:"",message:"",messageColor:"",messageSize:"",messageLineHeight:"",backgroundColor:"",theme:"light",color:"",icon:"",iconText:"",iconColor:"",iconUrl:null,image:"",imageWidth:50,maxWidth:null,zindex:null,layout:1,balloon:!1,close:!0,closeOnEscape:!1,closeOnClick:!1,displayMode:0,position:"bottomRight",target:"",targetFirst:!0,timeout:5e3,rtl:!1,animateInside:!0,drag:!0,pauseOnHover:!0,resetOnHover:!1,progressBar:!0,progressBarColor:"",progressBarEasing:"linear",overlay:!1,overlayClose:!1,overlayColor:"rgba(0, 0, 0, 0.6)",transitionIn:"fadeInUp",transitionOut:"fadeOut",transitionInMobile:"fadeInUp",transitionOutMobile:"fadeOutDown",buttons:{},inputs:{},onOpening:function(){},onOpened:function(){},onClosing:function(){},onClosed:function(){}};if("remove"in Element.prototype||(Element.prototype.remove=function(){this.parentNode&&this.parentNode.removeChild(this)}),"function"!==typeof window.CustomEvent){var f=function(t,e){e=e||{bubbles:!1,cancelable:!1,detail:void 0};var n=document.createEvent("CustomEvent");return n.initCustomEvent(t,e.bubbles,e.cancelable,e.detail),n};f.prototype=window.Event.prototype,window.CustomEvent=f}var d=function(t,e,n){if("[object Object]"===Object.prototype.toString.call(t))for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.call(n,t[r],r,t);else if(t)for(var i=0,o=t.length;i<o;i++)e.call(n,t[i],i,t)},p=function(t,e){var n={};return d(t,(function(e,r){n[r]=t[r]})),d(e,(function(t,r){n[r]=e[r]})),n},g=function(t){var e=document.createDocumentFragment(),n=document.createElement("div");n.innerHTML=t;while(n.firstChild)e.appendChild(n.firstChild);return e},m=function(t){var e=btoa(encodeURIComponent(t));return e.replace(/=/g,"")},y=function(t){return"#"==t.substring(0,1)||"rgb"==t.substring(0,3)||"hsl"==t.substring(0,3)},v=function(t){try{return btoa(atob(t))==t}catch(e){return!1}},b=function(){return{move:function(t,e,r,s){var a,u=.3,c=180;0!==s&&(t.classList.add(n+"-dragged"),t.style.transform="translateX("+s+"px)",s>0?(a=(c-s)/c,a<u&&e.hide(p(r,{transitionOut:"fadeOutRight",transitionOutMobile:"fadeOutRight"}),t,"drag")):(a=(c+s)/c,a<u&&e.hide(p(r,{transitionOut:"fadeOutLeft",transitionOutMobile:"fadeOutLeft"}),t,"drag")),t.style.opacity=a,a<u&&((i||o)&&(t.style.left=s+"px"),t.parentNode.style.opacity=u,this.stopMoving(t,null)))},startMoving:function(t,e,n,r){r=r||window.event;var i=s?r.touches[0].clientX:r.clientX,o=t.style.transform.replace("px)","");o=o.replace("translateX(","");var a=i-o;n.transitionIn&&t.classList.remove(n.transitionIn),n.transitionInMobile&&t.classList.remove(n.transitionInMobile),t.style.transition="",s?document.ontouchmove=function(r){r.preventDefault(),r=r||window.event;var i=r.touches[0].clientX,o=i-a;b.move(t,e,n,o)}:document.onmousemove=function(r){r.preventDefault(),r=r||window.event;var i=r.clientX,o=i-a;b.move(t,e,n,o)}},stopMoving:function(t,e){s?document.ontouchmove=function(){}:document.onmousemove=function(){},t.style.opacity="",t.style.transform="",t.classList.contains(n+"-dragged")&&(t.classList.remove(n+"-dragged"),t.style.transition="transform 0.4s ease, opacity 0.4s ease",setTimeout((function(){t.style.transition=""}),400))}}}();return e.setSetting=function(t,n,r){e.children[t][n]=r},e.getSetting=function(t,n){return e.children[t][n]},e.destroy=function(){d(document.querySelectorAll("."+n+"-overlay"),(function(t,e){t.remove()})),d(document.querySelectorAll("."+n+"-wrapper"),(function(t,e){t.remove()})),d(document.querySelectorAll("."+n),(function(t,e){t.remove()})),this.children={},document.removeEventListener(n+"-opened",{},!1),document.removeEventListener(n+"-opening",{},!1),document.removeEventListener(n+"-closing",{},!1),document.removeEventListener(n+"-closed",{},!1),document.removeEventListener("keyup",{},!1),l={}},e.settings=function(t){e.destroy(),l=t,h=p(h,t||{})},d(u,(function(t,n){e[n]=function(e){var n=p(l,e||{});n=p(t,n||{}),this.show(n)}})),e.progress=function(t,e,r){var i=this,o=e.getAttribute("data-iziToast-ref"),s=p(this.children[o],t||{}),a=e.querySelector("."+n+"-progressbar div");return{start:function(){"undefined"==typeof s.time.REMAINING&&(e.classList.remove(n+"-reseted"),null!==a&&(a.style.transition="width "+s.timeout+"ms "+s.progressBarEasing,a.style.width="0%"),s.time.START=(new Date).getTime(),s.time.END=s.time.START+s.timeout,s.time.TIMER=setTimeout((function(){clearTimeout(s.time.TIMER),e.classList.contains(n+"-closing")||(i.hide(s,e,"timeout"),"function"===typeof r&&r.apply(i))}),s.timeout),i.setSetting(o,"time",s.time))},pause:function(){if("undefined"!==typeof s.time.START&&!e.classList.contains(n+"-paused")&&!e.classList.contains(n+"-reseted")){if(e.classList.add(n+"-paused"),s.time.REMAINING=s.time.END-(new Date).getTime(),clearTimeout(s.time.TIMER),i.setSetting(o,"time",s.time),null!==a){var t=window.getComputedStyle(a),u=t.getPropertyValue("width");a.style.transition="none",a.style.width=u}"function"===typeof r&&setTimeout((function(){r.apply(i)}),10)}},resume:function(){"undefined"!==typeof s.time.REMAINING?(e.classList.remove(n+"-paused"),null!==a&&(a.style.transition="width "+s.time.REMAINING+"ms "+s.progressBarEasing,a.style.width="0%"),s.time.END=(new Date).getTime()+s.time.REMAINING,s.time.TIMER=setTimeout((function(){clearTimeout(s.time.TIMER),e.classList.contains(n+"-closing")||(i.hide(s,e,"timeout"),"function"===typeof r&&r.apply(i))}),s.time.REMAINING),i.setSetting(o,"time",s.time)):this.start()},reset:function(){clearTimeout(s.time.TIMER),delete s.time.REMAINING,i.setSetting(o,"time",s.time),e.classList.add(n+"-reseted"),e.classList.remove(n+"-paused"),null!==a&&(a.style.transition="none",a.style.width="100%"),"function"===typeof r&&setTimeout((function(){r.apply(i)}),10)}}},e.hide=function(t,e,i){"object"!=typeof e&&(e=document.querySelector(e));var o=this,s=p(this.children[e.getAttribute("data-iziToast-ref")],t||{});s.closedBy=i||null,delete s.time.REMAINING,e.classList.add(n+"-closing"),function(){var t=document.querySelector("."+n+"-overlay");if(null!==t){var e=t.getAttribute("data-iziToast-ref");e=e.split(",");var r=e.indexOf(String(s.ref));-1!==r&&e.splice(r,1),t.setAttribute("data-iziToast-ref",e.join()),0===e.length&&(t.classList.remove("fadeIn"),t.classList.add("fadeOut"),setTimeout((function(){t.remove()}),700))}}(),s.transitionIn&&e.classList.remove(s.transitionIn),s.transitionInMobile&&e.classList.remove(s.transitionInMobile),r||window.innerWidth<=c?s.transitionOutMobile&&e.classList.add(s.transitionOutMobile):s.transitionOut&&e.classList.add(s.transitionOut);var a=e.parentNode.offsetHeight;e.parentNode.style.height=a+"px",e.style.pointerEvents="none",(!r||window.innerWidth>c)&&(e.parentNode.style.transitionDelay="0.2s");try{var u=new CustomEvent(n+"-closing",{detail:s,bubbles:!0,cancelable:!0});document.dispatchEvent(u)}catch(l){console.warn(l)}setTimeout((function(){e.parentNode.style.height="0px",e.parentNode.style.overflow="",setTimeout((function(){delete o.children[s.ref],e.parentNode.remove();try{var t=new CustomEvent(n+"-closed",{detail:s,bubbles:!0,cancelable:!0});document.dispatchEvent(t)}catch(l){console.warn(l)}"undefined"!==typeof s.onClosed&&s.onClosed.apply(null,[s,e,i])}),1e3)}),200),"undefined"!==typeof s.onClosing&&s.onClosing.apply(null,[s,e,i])},e.show=function(t){var i=this,o=p(l,t||{});if(o=p(h,o),o.time={},null===o.id&&(o.id=m(o.title+o.message+o.color)),1===o.displayMode||"once"==o.displayMode)try{if(document.querySelectorAll("."+n+"#"+o.id).length>0)return!1}catch(w){console.warn("["+n+"] Could not find an element with this selector: #"+o.id+". Try to set an valid id.")}if(2===o.displayMode||"replace"==o.displayMode)try{d(document.querySelectorAll("."+n+"#"+o.id),(function(t,e){i.hide(o,t,"replaced")}))}catch(w){console.warn("["+n+"] Could not find an element with this selector: #"+o.id+". Try to set an valid id.")}o.ref=(new Date).getTime()+Math.floor(1e7*Math.random()+1),e.children[o.ref]=o;var u,f={body:document.querySelector("body"),overlay:document.createElement("div"),toast:document.createElement("div"),toastBody:document.createElement("div"),toastTexts:document.createElement("div"),toastCapsule:document.createElement("div"),cover:document.createElement("div"),buttons:document.createElement("div"),inputs:document.createElement("div"),icon:o.iconUrl?document.createElement("img"):document.createElement("i"),wrapper:null};f.toast.setAttribute("data-iziToast-ref",o.ref),f.toast.appendChild(f.toastBody),f.toastCapsule.appendChild(f.toast),function(){if(f.toast.classList.add(n),f.toast.classList.add(n+"-opening"),f.toastCapsule.classList.add(n+"-capsule"),f.toastBody.classList.add(n+"-body"),f.toastTexts.classList.add(n+"-texts"),r||window.innerWidth<=c?o.transitionInMobile&&f.toast.classList.add(o.transitionInMobile):o.transitionIn&&f.toast.classList.add(o.transitionIn),o.class){var t=o.class.split(" ");d(t,(function(t,e){f.toast.classList.add(t)}))}o.id&&(f.toast.id=o.id),o.rtl&&(f.toast.classList.add(n+"-rtl"),f.toast.setAttribute("dir","rtl")),o.layout>1&&f.toast.classList.add(n+"-layout"+o.layout),o.balloon&&f.toast.classList.add(n+"-balloon"),o.maxWidth&&(isNaN(o.maxWidth)?f.toast.style.maxWidth=o.maxWidth:f.toast.style.maxWidth=o.maxWidth+"px"),""===o.theme&&"light"===o.theme||f.toast.classList.add(n+"-theme-"+o.theme),o.color&&(y(o.color)?f.toast.style.background=o.color:f.toast.classList.add(n+"-color-"+o.color)),o.backgroundColor&&(f.toast.style.background=o.backgroundColor,o.balloon&&(f.toast.style.borderColor=o.backgroundColor))}(),function(){o.image&&(f.cover.classList.add(n+"-cover"),f.cover.style.width=o.imageWidth+"px",v(o.image.replace(/ /g,""))?f.cover.style.backgroundImage="url(data:image/png;base64,"+o.image.replace(/ /g,"")+")":f.cover.style.backgroundImage="url("+o.image+")",o.rtl?f.toastBody.style.marginRight=o.imageWidth+10+"px":f.toastBody.style.marginLeft=o.imageWidth+10+"px",f.toast.appendChild(f.cover))}(),function(){o.close?(f.buttonClose=document.createElement("button"),f.buttonClose.type="button",f.buttonClose.classList.add(n+"-close"),f.buttonClose.addEventListener("click",(function(t){t.target;i.hide(o,f.toast,"button")})),f.toast.appendChild(f.buttonClose)):o.rtl?f.toast.style.paddingLeft="18px":f.toast.style.paddingRight="18px"}(),function(){o.progressBar&&(f.progressBar=document.createElement("div"),f.progressBarDiv=document.createElement("div"),f.progressBar.classList.add(n+"-progressbar"),f.progressBarDiv.style.background=o.progressBarColor,f.progressBar.appendChild(f.progressBarDiv),f.toast.appendChild(f.progressBar)),o.timeout&&(o.pauseOnHover&&!o.resetOnHover&&(f.toast.addEventListener("mouseenter",(function(t){i.progress(o,f.toast).pause()})),f.toast.addEventListener("mouseleave",(function(t){i.progress(o,f.toast).resume()}))),o.resetOnHover&&(f.toast.addEventListener("mouseenter",(function(t){i.progress(o,f.toast).reset()})),f.toast.addEventListener("mouseleave",(function(t){i.progress(o,f.toast).start()}))))}(),function(){o.iconUrl?(f.icon.setAttribute("class",n+"-icon"),f.icon.setAttribute("src",o.iconUrl)):o.icon&&(f.icon.setAttribute("class",n+"-icon "+o.icon),o.iconText&&f.icon.appendChild(document.createTextNode(o.iconText)),o.iconColor&&(f.icon.style.color=o.iconColor)),(o.icon||o.iconUrl)&&(o.rtl?f.toastBody.style.paddingRight="33px":f.toastBody.style.paddingLeft="33px",f.toastBody.appendChild(f.icon))}(),function(){o.title.length>0&&(f.strong=document.createElement("strong"),f.strong.classList.add(n+"-title"),f.strong.appendChild(g(o.title)),f.toastTexts.appendChild(f.strong),o.titleColor&&(f.strong.style.color=o.titleColor),o.titleSize&&(isNaN(o.titleSize)?f.strong.style.fontSize=o.titleSize:f.strong.style.fontSize=o.titleSize+"px"),o.titleLineHeight&&(isNaN(o.titleSize)?f.strong.style.lineHeight=o.titleLineHeight:f.strong.style.lineHeight=o.titleLineHeight+"px")),o.message.length>0&&(f.p=document.createElement("p"),f.p.classList.add(n+"-message"),f.p.appendChild(g(o.message)),f.toastTexts.appendChild(f.p),o.messageColor&&(f.p.style.color=o.messageColor),o.messageSize&&(isNaN(o.titleSize)?f.p.style.fontSize=o.messageSize:f.p.style.fontSize=o.messageSize+"px"),o.messageLineHeight&&(isNaN(o.titleSize)?f.p.style.lineHeight=o.messageLineHeight:f.p.style.lineHeight=o.messageLineHeight+"px")),o.title.length>0&&o.message.length>0&&(o.rtl?f.strong.style.marginLeft="10px":2===o.layout||o.rtl||(f.strong.style.marginRight="10px"))}(),f.toastBody.appendChild(f.toastTexts),function(){o.inputs.length>0&&(f.inputs.classList.add(n+"-inputs"),d(o.inputs,(function(t,e){f.inputs.appendChild(g(t[0])),u=f.inputs.childNodes,u[e].classList.add(n+"-inputs-child"),t[3]&&setTimeout((function(){u[e].focus()}),300),u[e].addEventListener(t[1],(function(e){var n=t[2];return n(i,f.toast,this,e)}))})),f.toastBody.appendChild(f.inputs))}(),function(){o.buttons.length>0&&(f.buttons.classList.add(n+"-buttons"),d(o.buttons,(function(t,e){f.buttons.appendChild(g(t[0]));var r=f.buttons.childNodes;r[e].classList.add(n+"-buttons-child"),t[2]&&setTimeout((function(){r[e].focus()}),300),r[e].addEventListener("click",(function(e){e.preventDefault();var n=t[1];return n(i,f.toast,this,e,u)}))}))),f.toastBody.appendChild(f.buttons)}(),o.message.length>0&&(o.inputs.length>0||o.buttons.length>0)&&(f.p.style.marginBottom="0"),(o.inputs.length>0||o.buttons.length>0)&&(o.rtl?f.toastTexts.style.marginLeft="10px":f.toastTexts.style.marginRight="10px",o.inputs.length>0&&o.buttons.length>0&&(o.rtl?f.inputs.style.marginLeft="8px":f.inputs.style.marginRight="8px")),function(){f.toastCapsule.style.visibility="hidden",setTimeout((function(){var t=f.toast.offsetHeight,e=f.toast.currentStyle||window.getComputedStyle(f.toast),n=e.marginTop;n=n.split("px"),n=parseInt(n[0]);var r=e.marginBottom;r=r.split("px"),r=parseInt(r[0]),f.toastCapsule.style.visibility="",f.toastCapsule.style.height=t+r+n+"px",setTimeout((function(){f.toastCapsule.style.height="auto",o.target&&(f.toastCapsule.style.overflow="visible")}),500),o.timeout&&i.progress(o,f.toast).start()}),100)}(),function(){var t=o.position;if(o.target)f.wrapper=document.querySelector(o.target),f.wrapper.classList.add(n+"-target"),o.targetFirst?f.wrapper.insertBefore(f.toastCapsule,f.wrapper.firstChild):f.wrapper.appendChild(f.toastCapsule);else{if(-1==a.indexOf(o.position))return void console.warn("["+n+"] Incorrect position.\nIt can be › "+a);t=r||window.innerWidth<=c?"bottomLeft"==o.position||"bottomRight"==o.position||"bottomCenter"==o.position?n+"-wrapper-bottomCenter":"topLeft"==o.position||"topRight"==o.position||"topCenter"==o.position?n+"-wrapper-topCenter":n+"-wrapper-center":n+"-wrapper-"+t,f.wrapper=document.querySelector("."+n+"-wrapper."+t),f.wrapper||(f.wrapper=document.createElement("div"),f.wrapper.classList.add(n+"-wrapper"),f.wrapper.classList.add(t),document.body.appendChild(f.wrapper)),"topLeft"==o.position||"topCenter"==o.position||"topRight"==o.position?f.wrapper.insertBefore(f.toastCapsule,f.wrapper.firstChild):f.wrapper.appendChild(f.toastCapsule)}isNaN(o.zindex)?console.warn("["+n+"] Invalid zIndex."):f.wrapper.style.zIndex=o.zindex}(),function(){o.overlay&&(null!==document.querySelector("."+n+"-overlay.fadeIn")?(f.overlay=document.querySelector("."+n+"-overlay"),f.overlay.setAttribute("data-iziToast-ref",f.overlay.getAttribute("data-iziToast-ref")+","+o.ref),isNaN(o.zindex)||null===o.zindex||(f.overlay.style.zIndex=o.zindex-1)):(f.overlay.classList.add(n+"-overlay"),f.overlay.classList.add("fadeIn"),f.overlay.style.background=o.overlayColor,f.overlay.setAttribute("data-iziToast-ref",o.ref),isNaN(o.zindex)||null===o.zindex||(f.overlay.style.zIndex=o.zindex-1),document.querySelector("body").appendChild(f.overlay)),o.overlayClose?(f.overlay.removeEventListener("click",{}),f.overlay.addEventListener("click",(function(t){i.hide(o,f.toast,"overlay")}))):f.overlay.removeEventListener("click",{}))}(),function(){if(o.animateInside){f.toast.classList.add(n+"-animateInside");var t=[200,100,300];"bounceInLeft"!=o.transitionIn&&"bounceInRight"!=o.transitionIn||(t=[400,200,400]),o.title.length>0&&setTimeout((function(){f.strong.classList.add("slideIn")}),t[0]),o.message.length>0&&setTimeout((function(){f.p.classList.add("slideIn")}),t[1]),(o.icon||o.iconUrl)&&setTimeout((function(){f.icon.classList.add("revealIn")}),t[2]);var e=150;o.buttons.length>0&&f.buttons&&setTimeout((function(){d(f.buttons.childNodes,(function(t,n){setTimeout((function(){t.classList.add("revealIn")}),e),e+=150}))}),o.inputs.length>0?150:0),o.inputs.length>0&&f.inputs&&(e=150,d(f.inputs.childNodes,(function(t,n){setTimeout((function(){t.classList.add("revealIn")}),e),e+=150})))}}(),o.onOpening.apply(null,[o,f.toast]);try{var _=new CustomEvent(n+"-opening",{detail:o,bubbles:!0,cancelable:!0});document.dispatchEvent(_)}catch(x){console.warn(x)}setTimeout((function(){f.toast.classList.remove(n+"-opening"),f.toast.classList.add(n+"-opened");try{var t=new CustomEvent(n+"-opened",{detail:o,bubbles:!0,cancelable:!0});document.dispatchEvent(t)}catch(x){console.warn(x)}o.onOpened.apply(null,[o,f.toast])}),1e3),o.drag&&(s?(f.toast.addEventListener("touchstart",(function(t){b.startMoving(this,i,o,t)}),!1),f.toast.addEventListener("touchend",(function(t){b.stopMoving(this,t)}),!1)):(f.toast.addEventListener("mousedown",(function(t){t.preventDefault(),b.startMoving(this,i,o,t)}),!1),f.toast.addEventListener("mouseup",(function(t){t.preventDefault(),b.stopMoving(this,t)}),!1))),o.closeOnEscape&&document.addEventListener("keyup",(function(t){t=t||window.event,27==t.keyCode&&i.hide(o,f.toast,"esc")})),o.closeOnClick&&f.toast.addEventListener("click",(function(t){i.hide(o,f.toast,"toast")})),i.toast=f.toast},e}))}).call(this,n("c8ba"))},"26b5":function(t,e,n){"use strict";n.d(e,"a",(function(){return h}));var r=n("b2b4");const i={};function o(t){r["global"].console&&r["global"].console.error&&r["global"].console.error(t)}function s(t){r["global"].console&&r["global"].console.log&&r["global"].console.log(t)}function a(t,e){i[t]=!0,void 0!==e&&o(e)}function u(t){const e=t.getError;t.getError=function(){let n;do{n=e.apply(t),0!==n&&(i[n]=!0)}while(0!==n);for(n in i)if(i[n])return delete i[n],parseInt(n,10);return 0}}const c=function t(e){const n=e.gl;this.ext=e,this.isAlive=!0,this.hasBeenBound=!1,this.elementArrayBuffer=null,this.attribs=new Array(e.maxVertexAttribs);for(let r=0;r<this.attribs.length;r++){const e=new t.VertexAttrib(n);this.attribs[r]=e}this.maxAttrib=0};c.VertexAttrib=function(t){this.enabled=!1,this.buffer=null,this.size=4,this.type=5126,this.normalized=!1,this.stride=16,this.offset=0,this.cached="",this.recache()},c.VertexAttrib.prototype.recache=function(){this.cached=[this.size,this.type,this.normalized,this.stride,this.offset].join(":")};const l=function(t){const e=this;this.gl=t,u(t);const n=this.original={getParameter:t.getParameter,enableVertexAttribArray:t.enableVertexAttribArray,disableVertexAttribArray:t.disableVertexAttribArray,bindBuffer:t.bindBuffer,getVertexAttrib:t.getVertexAttrib,vertexAttribPointer:t.vertexAttribPointer};t.getParameter=function(t){return t===e.VERTEX_ARRAY_BINDING_OES?e.currentVertexArrayObject===e.defaultVertexArrayObject?null:e.currentVertexArrayObject:n.getParameter.apply(this,arguments)},t.enableVertexAttribArray=function(t){const r=e.currentVertexArrayObject;r.maxAttrib=Math.max(r.maxAttrib,t);const i=r.attribs[t];return i.enabled=!0,n.enableVertexAttribArray.apply(this,arguments)},t.disableVertexAttribArray=function(t){const r=e.currentVertexArrayObject;r.maxAttrib=Math.max(r.maxAttrib,t);const i=r.attribs[t];return i.enabled=!1,n.disableVertexAttribArray.apply(this,arguments)},t.bindBuffer=function(t,r){switch(t){case 34962:e.currentArrayBuffer=r;break;case 34963:e.currentVertexArrayObject.elementArrayBuffer=r;break;default:}return n.bindBuffer.apply(this,arguments)},t.getVertexAttrib=function(t,r){const i=e.currentVertexArrayObject,o=i.attribs[t];switch(r){case 34975:return o.buffer;case 34338:return o.enabled;case 34339:return o.size;case 34340:return o.stride;case 34341:return o.type;case 34922:return o.normalized;default:return n.getVertexAttrib.apply(this,arguments)}},t.vertexAttribPointer=function(t,r,i,o,s,a){const u=e.currentVertexArrayObject;u.maxAttrib=Math.max(u.maxAttrib,t);const c=u.attribs[t];return c.buffer=e.currentArrayBuffer,c.size=r,c.type=i,c.normalized=o,c.stride=s,c.offset=a,c.recache(),n.vertexAttribPointer.apply(this,arguments)},t.instrumentExtension&&t.instrumentExtension(this,"OES_vertex_array_object"),t.canvas&&t.canvas.addEventListener("webglcontextrestored",()=>{s("OESVertexArrayObject emulation library context restored"),e.reset_()},!0),this.reset_()};function h(t){if("function"===typeof t.createVertexArray)return;const e=t.getSupportedExtensions;t.getSupportedExtensions=function(){const t=e.call(this)||[];return t.indexOf("OES_vertex_array_object")<0&&t.push("OES_vertex_array_object"),t};const n=t.getExtension;t.getExtension=function(e){const r=n.call(this,e);return r||("OES_vertex_array_object"!==e?null:(t.__OESVertexArrayObject||(this.__OESVertexArrayObject=new l(this)),this.__OESVertexArrayObject))}}l.prototype.VERTEX_ARRAY_BINDING_OES=34229,l.prototype.reset_=function(){const t=void 0!==this.vertexArrayObjects;if(t)for(let n=0;n<this.vertexArrayObjects.length;++n)this.vertexArrayObjects.isAlive=!1;const e=this.gl;this.maxVertexAttribs=e.getParameter(34921),this.defaultVertexArrayObject=new c(this),this.currentVertexArrayObject=null,this.currentArrayBuffer=null,this.vertexArrayObjects=[this.defaultVertexArrayObject],this.bindVertexArrayOES(null)},l.prototype.createVertexArrayOES=function(){const t=new c(this);return this.vertexArrayObjects.push(t),t},l.prototype.deleteVertexArrayOES=function(t){t.isAlive=!1,this.vertexArrayObjects.splice(this.vertexArrayObjects.indexOf(t),1),this.currentVertexArrayObject===t&&this.bindVertexArrayOES(null)},l.prototype.isVertexArrayOES=function(t){return!!(t&&t instanceof c&&t.hasBeenBound&&t.ext===this)},l.prototype.bindVertexArrayOES=function(t){const e=this.gl;if(t&&!t.isAlive)return void a(1282,"bindVertexArrayOES: attempt to bind deleted arrayObject");const n=this.original,r=this.currentVertexArrayObject;this.currentVertexArrayObject=t||this.defaultVertexArrayObject,this.currentVertexArrayObject.hasBeenBound=!0;const i=this.currentVertexArrayObject;if(r===i)return;r&&i.elementArrayBuffer===r.elementArrayBuffer||n.bindBuffer.call(e,34963,i.elementArrayBuffer);let o=this.currentArrayBuffer;const s=Math.max(r?r.maxAttrib:0,i.maxAttrib);for(let a=0;a<=s;a++){const t=i.attribs[a],s=r?r.attribs[a]:null;if(r&&t.enabled===s.enabled||(t.enabled?n.enableVertexAttribArray.call(e,a):n.disableVertexAttribArray.call(e,a)),t.enabled){let i=!1;r&&t.buffer===s.buffer||(o!==t.buffer&&(n.bindBuffer.call(e,34962,t.buffer),o=t.buffer),i=!0),(i||t.cached!==s.cached)&&n.vertexAttribPointer.call(e,a,t.size,t.type,t.normalized,t.stride,t.offset)}}this.currentArrayBuffer!==o&&n.bindBuffer.call(e,34962,this.currentArrayBuffer)}},2739:function(t,e,n){"use strict";n.d(e,"b",(function(){return s})),n.d(e,"a",(function(){return a})),n.d(e,"c",(function(){return l}));var r=n("18e2"),i=n("1738");function o(t){return Object(r["a"])((function(e){e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCDate(t.getUTCDate()+7*e)}),(function(t,e){return(e-t)/i["f"]}))}var s=o(0),a=o(1),u=o(2),c=o(3),l=o(4),h=o(5),f=o(6);s.range,a.range,u.range,c.range,l.range,h.range,f.range},2904:function(t,e,n){"use strict";n("c831")},"2afa":function(t,e,n){t.exports=n("8329")},"2c38":function(t,e,n){"use strict";var r=n("18e2"),i=n("1738"),o=Object(r["a"])((function(t){t.setTime(t-t.getMilliseconds()-t.getSeconds()*i["e"])}),(function(t,e){t.setTime(+t+e*i["c"])}),(function(t,e){return(e-t)/i["c"]}),(function(t){return t.getMinutes()}));e["a"]=o;o.range},"2d83":function(t,e,n){"use strict";var r=n("387f");t.exports=function(t,e,n,i,o){var s=new Error(t);return r(s,e,n,i,o)}},"2e67":function(t,e,n){"use strict";t.exports=function(t){return!(!t||!t.__CANCEL__)}},"2f03":function(t,e,n){},"2f5d":function(t,e,n){"use strict";n("1a71")},"30b5":function(t,e,n){"use strict";var r=n("c532");function i(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}t.exports=function(t,e,n){if(!e)return t;var o;if(n)o=n(e);else if(r.isURLSearchParams(e))o=e.toString();else{var s=[];r.forEach(e,(function(t,e){null!==t&&"undefined"!==typeof t&&(r.isArray(t)?e+="[]":t=[t],r.forEach(t,(function(t){r.isDate(t)?t=t.toISOString():r.isObject(t)&&(t=JSON.stringify(t)),s.push(i(e)+"="+i(t))})))})),o=s.join("&")}if(o){var a=t.indexOf("#");-1!==a&&(t=t.slice(0,a)),t+=(-1===t.indexOf("?")?"?":"&")+o}return t}},"323f":function(t,e,n){"use strict";n.d(e,"c",(function(){return o})),n.d(e,"b",(function(){return a})),n.d(e,"h",(function(){return u})),n.d(e,"g",(function(){return c})),n.d(e,"i",(function(){return l})),n.d(e,"d",(function(){return h})),n.d(e,"e",(function(){return f})),n.d(e,"f",(function(){return d})),n.d(e,"a",(function(){return p}));var r=n("6d51");function i(){var t=new r["a"](3);return r["a"]!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function o(t){var e=t[0],n=t[1],r=t[2];return Math.hypot(e,n,r)}function s(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function a(t,e,n){var r=e[0],i=e[1],o=e[2],s=n[0],a=n[1],u=n[2];return t[0]=i*u-o*a,t[1]=o*s-r*u,t[2]=r*a-i*s,t}function u(t,e,n){var r=e[0],i=e[1],o=e[2],s=n[3]*r+n[7]*i+n[11]*o+n[15];return s=s||1,t[0]=(n[0]*r+n[4]*i+n[8]*o+n[12])/s,t[1]=(n[1]*r+n[5]*i+n[9]*o+n[13])/s,t[2]=(n[2]*r+n[6]*i+n[10]*o+n[14])/s,t}function c(t,e,n){var r=e[0],i=e[1],o=e[2];return t[0]=r*n[0]+i*n[3]+o*n[6],t[1]=r*n[1]+i*n[4]+o*n[7],t[2]=r*n[2]+i*n[5]+o*n[8],t}function l(t,e,n){var r=n[0],i=n[1],o=n[2],s=n[3],a=e[0],u=e[1],c=e[2],l=i*c-o*u,h=o*a-r*c,f=r*u-i*a,d=i*f-o*h,p=o*l-r*f,g=r*h-i*l,m=2*s;return l*=m,h*=m,f*=m,d*=2,p*=2,g*=2,t[0]=a+l+d,t[1]=u+h+p,t[2]=c+f+g,t}function h(t,e,n,r){var i=[],o=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],o[0]=i[0],o[1]=i[1]*Math.cos(r)-i[2]*Math.sin(r),o[2]=i[1]*Math.sin(r)+i[2]*Math.cos(r),t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t}function f(t,e,n,r){var i=[],o=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],o[0]=i[2]*Math.sin(r)+i[0]*Math.cos(r),o[1]=i[1],o[2]=i[2]*Math.cos(r)-i[0]*Math.sin(r),t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t}function d(t,e,n,r){var i=[],o=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],o[0]=i[0]*Math.cos(r)-i[1]*Math.sin(r),o[1]=i[0]*Math.sin(r)+i[1]*Math.cos(r),o[2]=i[2],t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t}function p(t,e){var n=t[0],r=t[1],i=t[2],o=e[0],a=e[1],u=e[2],c=Math.sqrt(n*n+r*r+i*i),l=Math.sqrt(o*o+a*a+u*u),h=c*l,f=h&&s(t,e)/h;return Math.acos(Math.min(Math.max(f,-1),1))}(function(){var t=i()})()},"331d":function(t,e,n){"use strict";(function(t,r){var i=n("4ea4");Object.defineProperty(e,"__esModule",{value:!0}),e.console=e.process=e.document=e.global=e.window=e.self=void 0;var o=i(n("7037")),s={self:"undefined"!==typeof self&&self,window:"undefined"!==typeof window&&window,global:"undefined"!==typeof t&&t,document:"undefined"!==typeof document&&document,process:"object"===("undefined"===typeof r?"undefined":(0,o.default)(r))&&r},a=s.self||s.window||s.global;e.self=a;var u=s.window||s.self||s.global;e.window=u;var c=s.global||s.self||s.window;e.global=c;var l=s.document||{};e.document=l;var h=s.process||{};e.process=h;var f=console;e.console=f}).call(this,n("c8ba"),n("4362"))},"33e8":function(t,e,n){"use strict";n.d(e,"e",(function(){return E})),n.d(e,"c",(function(){return h})),n.d(e,"d",(function(){return x})),n.d(e,"a",(function(){return _})),n.d(e,"b",(function(){return S}));const r=Object.create(null);r["open"]="0",r["close"]="1",r["ping"]="2",r["pong"]="3",r["message"]="4",r["upgrade"]="5",r["noop"]="6";const i=Object.create(null);Object.keys(r).forEach(t=>{i[r[t]]=t});const o={type:"error",data:"parser error"},s="function"===typeof Blob||"undefined"!==typeof Blob&&"[object BlobConstructor]"===Object.prototype.toString.call(Blob),a="function"===typeof ArrayBuffer,u=t=>{return"function"===typeof ArrayBuffer.isView?ArrayBuffer.isView(t):t&&t.buffer instanceof ArrayBuffer},c=({type:t,data:e},n,i)=>{return s&&e instanceof Blob?n?i(e):l(e,i):a&&(e instanceof ArrayBuffer||u(e))?n?i(e):l(new Blob([e]),i):i(r[t]+(e||""))},l=(t,e)=>{const n=new FileReader;return n.onload=function(){const t=n.result.split(",")[1];e("b"+t)},n.readAsDataURL(t)};for(var h=c,f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",d="undefined"===typeof Uint8Array?[]:new Uint8Array(256),p=0;p<f.length;p++)d[f.charCodeAt(p)]=p;var g=function(t){var e,n,r,i,o,s=.75*t.length,a=t.length,u=0;"="===t[t.length-1]&&(s--,"="===t[t.length-2]&&s--);var c=new ArrayBuffer(s),l=new Uint8Array(c);for(e=0;e<a;e+=4)n=d[t.charCodeAt(e)],r=d[t.charCodeAt(e+1)],i=d[t.charCodeAt(e+2)],o=d[t.charCodeAt(e+3)],l[u++]=n<<2|r>>4,l[u++]=(15&r)<<4|i>>2,l[u++]=(3&i)<<6|63&o;return c};const m="function"===typeof ArrayBuffer,y=(t,e)=>{if("string"!==typeof t)return{type:"message",data:b(t,e)};const n=t.charAt(0);if("b"===n)return{type:"message",data:v(t.substring(1),e)};const r=i[n];return r?t.length>1?{type:i[n],data:t.substring(1)}:{type:i[n]}:o},v=(t,e)=>{if(m){const n=g(t);return b(n,e)}return{base64:!0,data:t}},b=(t,e)=>{switch(e){case"blob":return t instanceof ArrayBuffer?new Blob([t]):t;case"arraybuffer":default:return t}};var _=y;const w=String.fromCharCode(30),x=(t,e)=>{const n=t.length,r=new Array(n);let i=0;t.forEach((t,o)=>{h(t,!1,t=>{r[o]=t,++i===n&&e(r.join(w))})})},S=(t,e)=>{const n=t.split(w),r=[];for(let i=0;i<n.length;i++){const t=_(n[i],e);if(r.push(t),"error"===t.type)break}return r},E=4},"34ba":function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n("33e8"),i=n("b19d"),o=n("af7f");class s extends i["Emitter"]{constructor(t){super(),this.writable=!1,Object(o["a"])(this,t),this.opts=t,this.query=t.query,this.readyState="",this.socket=t.socket}onError(t,e){const n=new Error(t);return n.type="TransportError",n.description=e,super.emit("error",n),this}open(){return"closed"!==this.readyState&&""!==this.readyState||(this.readyState="opening",this.doOpen()),this}close(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this}send(t){"open"===this.readyState&&this.write(t)}onOpen(){this.readyState="open",this.writable=!0,super.emit("open")}onData(t){const e=Object(r["a"])(t,this.socket.binaryType);this.onPacket(e)}onPacket(t){super.emit("packet",t)}onClose(){this.readyState="closed",super.emit("close")}}},3512:function(t,e,n){"use strict";var r={},i={},o=34,s=10,a=13;function u(t){return new Function("d","return {"+t.map((function(t,e){return JSON.stringify(t)+": d["+e+'] || ""'})).join(",")+"}")}function c(t,e){var n=u(t);return function(r,i){return e(n(r),i,t)}}function l(t){var e=Object.create(null),n=[];return t.forEach((function(t){for(var r in t)r in e||n.push(e[r]=r)})),n}function h(t,e){var n=t+"",r=n.length;return r<e?new Array(e-r+1).join(0)+n:n}function f(t){return t<0?"-"+h(-t,6):t>9999?"+"+h(t,6):h(t,4)}function d(t){var e=t.getUTCHours(),n=t.getUTCMinutes(),r=t.getUTCSeconds(),i=t.getUTCMilliseconds();return isNaN(t)?"Invalid Date":f(t.getUTCFullYear(),4)+"-"+h(t.getUTCMonth()+1,2)+"-"+h(t.getUTCDate(),2)+(i?"T"+h(e,2)+":"+h(n,2)+":"+h(r,2)+"."+h(i,3)+"Z":r?"T"+h(e,2)+":"+h(n,2)+":"+h(r,2)+"Z":n||e?"T"+h(e,2)+":"+h(n,2)+"Z":"")}e["a"]=function(t){var e=new RegExp('["'+t+"\n\r]"),n=t.charCodeAt(0);function h(t,e){var n,r,i=f(t,(function(t,i){if(n)return n(t,i-1);r=t,n=e?c(t,e):u(t)}));return i.columns=r||[],i}function f(t,e){var u,c=[],l=t.length,h=0,f=0,d=l<=0,p=!1;function g(){if(d)return i;if(p)return p=!1,r;var e,u,c=h;if(t.charCodeAt(c)===o){while(h++<l&&t.charCodeAt(h)!==o||t.charCodeAt(++h)===o);return(e=h)>=l?d=!0:(u=t.charCodeAt(h++))===s?p=!0:u===a&&(p=!0,t.charCodeAt(h)===s&&++h),t.slice(c+1,e-1).replace(/""/g,'"')}while(h<l){if((u=t.charCodeAt(e=h++))===s)p=!0;else if(u===a)p=!0,t.charCodeAt(h)===s&&++h;else if(u!==n)continue;return t.slice(c,e)}return d=!0,t.slice(c,l)}t.charCodeAt(l-1)===s&&--l,t.charCodeAt(l-1)===a&&--l;while((u=g())!==i){var m=[];while(u!==r&&u!==i)m.push(u),u=g();e&&null==(m=e(m,f++))||c.push(m)}return c}function p(e,n){return e.map((function(e){return n.map((function(t){return b(e[t])})).join(t)}))}function g(e,n){return null==n&&(n=l(e)),[n.map(b).join(t)].concat(p(e,n)).join("\n")}function m(t,e){return null==e&&(e=l(t)),p(t,e).join("\n")}function y(t){return t.map(v).join("\n")}function v(e){return e.map(b).join(t)}function b(t){return null==t?"":t instanceof Date?d(t):e.test(t+="")?'"'+t.replace(/"/g,'""')+'"':t}return{parse:h,parseRows:f,format:g,formatBody:m,formatRows:y,formatRow:v,formatValue:b}}},"35b1":function(t,e,n){"use strict";(function(t,r){n.d(e,"b",(function(){return o})),n.d(e,"a",(function(){return s}));const i={self:"undefined"!==typeof self&&self,window:"undefined"!==typeof window&&window,global:"undefined"!==typeof t&&t,document:"undefined"!==typeof document&&document,process:"object"===typeof r&&r},o=(i.self||i.window||i.global,i.window||i.self||i.global),s=(i.global||i.self||i.window,i.document,i.process||{});console}).call(this,n("c8ba"),n("4362"))},"370d":function(t,e,n){"use strict";n.d(e,"a",(function(){return D}));var r=n("f87d"),i=n("e355"),o=n("6b74"),s=n("b52f");class a extends i["a"]{get ELEMENTS(){return Object(s["a"])(!1),0}get RANK(){return Object(s["a"])(!1),0}toString(){let t="[";if(o["b"].printRowMajor){t+="row-major:";for(let e=0;e<this.RANK;++e)for(let n=0;n<this.RANK;++n)t+=" ".concat(this[n*this.RANK+e])}else{t+="column-major:";for(let e=0;e<this.ELEMENTS;++e)t+=" ".concat(this[e])}return t+="]",t}getElementIndex(t,e){return e*this.RANK+t}getElement(t,e){return this[e*this.RANK+t]}setElement(t,e,n){return this[e*this.RANK+t]=Object(r["a"])(n),this}getColumn(t,e=new Array(this.RANK).fill(-0)){const n=t*this.RANK;for(let r=0;r<this.RANK;++r)e[r]=this[n+r];return e}setColumn(t,e){const n=t*this.RANK;for(let r=0;r<this.RANK;++r)this[n+r]=e[r];return this}}var u=n("b128"),c=n("6d51");function l(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function h(t,e){if(t===e){var n=e[1],r=e[2],i=e[3],o=e[6],s=e[7],a=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=r,t[9]=o,t[11]=e[14],t[12]=i,t[13]=s,t[14]=a}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function f(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],s=e[4],a=e[5],u=e[6],c=e[7],l=e[8],h=e[9],f=e[10],d=e[11],p=e[12],g=e[13],m=e[14],y=e[15],v=n*a-r*s,b=n*u-i*s,_=n*c-o*s,w=r*u-i*a,x=r*c-o*a,S=i*c-o*u,E=l*g-h*p,A=l*m-f*p,M=l*y-d*p,C=h*m-f*g,k=h*y-d*g,O=f*y-d*m,P=v*O-b*k+_*C+w*M-x*A+S*E;return P?(P=1/P,t[0]=(a*O-u*k+c*C)*P,t[1]=(i*k-r*O-o*C)*P,t[2]=(g*S-m*x+y*w)*P,t[3]=(f*x-h*S-d*w)*P,t[4]=(u*M-s*O-c*A)*P,t[5]=(n*O-i*M+o*A)*P,t[6]=(m*_-p*S-y*b)*P,t[7]=(l*S-f*_+d*b)*P,t[8]=(s*k-a*M+c*E)*P,t[9]=(r*M-n*k-o*E)*P,t[10]=(p*x-g*_+y*v)*P,t[11]=(h*_-l*x-d*v)*P,t[12]=(a*A-s*C-u*E)*P,t[13]=(n*C-r*A+i*E)*P,t[14]=(g*b-p*w-m*v)*P,t[15]=(l*w-h*b+f*v)*P,t):null}function d(t){var e=t[0],n=t[1],r=t[2],i=t[3],o=t[4],s=t[5],a=t[6],u=t[7],c=t[8],l=t[9],h=t[10],f=t[11],d=t[12],p=t[13],g=t[14],m=t[15],y=e*s-n*o,v=e*a-r*o,b=e*u-i*o,_=n*a-r*s,w=n*u-i*s,x=r*u-i*a,S=c*p-l*d,E=c*g-h*d,A=c*m-f*d,M=l*g-h*p,C=l*m-f*p,k=h*m-f*g;return y*k-v*C+b*M+_*A-w*E+x*S}function p(t,e,n){var r=e[0],i=e[1],o=e[2],s=e[3],a=e[4],u=e[5],c=e[6],l=e[7],h=e[8],f=e[9],d=e[10],p=e[11],g=e[12],m=e[13],y=e[14],v=e[15],b=n[0],_=n[1],w=n[2],x=n[3];return t[0]=b*r+_*a+w*h+x*g,t[1]=b*i+_*u+w*f+x*m,t[2]=b*o+_*c+w*d+x*y,t[3]=b*s+_*l+w*p+x*v,b=n[4],_=n[5],w=n[6],x=n[7],t[4]=b*r+_*a+w*h+x*g,t[5]=b*i+_*u+w*f+x*m,t[6]=b*o+_*c+w*d+x*y,t[7]=b*s+_*l+w*p+x*v,b=n[8],_=n[9],w=n[10],x=n[11],t[8]=b*r+_*a+w*h+x*g,t[9]=b*i+_*u+w*f+x*m,t[10]=b*o+_*c+w*d+x*y,t[11]=b*s+_*l+w*p+x*v,b=n[12],_=n[13],w=n[14],x=n[15],t[12]=b*r+_*a+w*h+x*g,t[13]=b*i+_*u+w*f+x*m,t[14]=b*o+_*c+w*d+x*y,t[15]=b*s+_*l+w*p+x*v,t}function g(t,e,n){var r,i,o,s,a,u,c,l,h,f,d,p,g=n[0],m=n[1],y=n[2];return e===t?(t[12]=e[0]*g+e[4]*m+e[8]*y+e[12],t[13]=e[1]*g+e[5]*m+e[9]*y+e[13],t[14]=e[2]*g+e[6]*m+e[10]*y+e[14],t[15]=e[3]*g+e[7]*m+e[11]*y+e[15]):(r=e[0],i=e[1],o=e[2],s=e[3],a=e[4],u=e[5],c=e[6],l=e[7],h=e[8],f=e[9],d=e[10],p=e[11],t[0]=r,t[1]=i,t[2]=o,t[3]=s,t[4]=a,t[5]=u,t[6]=c,t[7]=l,t[8]=h,t[9]=f,t[10]=d,t[11]=p,t[12]=r*g+a*m+h*y+e[12],t[13]=i*g+u*m+f*y+e[13],t[14]=o*g+c*m+d*y+e[14],t[15]=s*g+l*m+p*y+e[15]),t}function m(t,e,n){var r=n[0],i=n[1],o=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function y(t,e,n,r){var i,o,s,a,u,l,h,f,d,p,g,m,y,v,b,_,w,x,S,E,A,M,C,k,O=r[0],P=r[1],T=r[2],L=Math.hypot(O,P,T);return L<c["b"]?null:(L=1/L,O*=L,P*=L,T*=L,i=Math.sin(n),o=Math.cos(n),s=1-o,a=e[0],u=e[1],l=e[2],h=e[3],f=e[4],d=e[5],p=e[6],g=e[7],m=e[8],y=e[9],v=e[10],b=e[11],_=O*O*s+o,w=P*O*s+T*i,x=T*O*s-P*i,S=O*P*s-T*i,E=P*P*s+o,A=T*P*s+O*i,M=O*T*s+P*i,C=P*T*s-O*i,k=T*T*s+o,t[0]=a*_+f*w+m*x,t[1]=u*_+d*w+y*x,t[2]=l*_+p*w+v*x,t[3]=h*_+g*w+b*x,t[4]=a*S+f*E+m*A,t[5]=u*S+d*E+y*A,t[6]=l*S+p*E+v*A,t[7]=h*S+g*E+b*A,t[8]=a*M+f*C+m*k,t[9]=u*M+d*C+y*k,t[10]=l*M+p*C+v*k,t[11]=h*M+g*C+b*k,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function v(t,e,n){var r=Math.sin(n),i=Math.cos(n),o=e[4],s=e[5],a=e[6],u=e[7],c=e[8],l=e[9],h=e[10],f=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=o*i+c*r,t[5]=s*i+l*r,t[6]=a*i+h*r,t[7]=u*i+f*r,t[8]=c*i-o*r,t[9]=l*i-s*r,t[10]=h*i-a*r,t[11]=f*i-u*r,t}function b(t,e,n){var r=Math.sin(n),i=Math.cos(n),o=e[0],s=e[1],a=e[2],u=e[3],c=e[8],l=e[9],h=e[10],f=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*i-c*r,t[1]=s*i-l*r,t[2]=a*i-h*r,t[3]=u*i-f*r,t[8]=o*r+c*i,t[9]=s*r+l*i,t[10]=a*r+h*i,t[11]=u*r+f*i,t}function _(t,e,n){var r=Math.sin(n),i=Math.cos(n),o=e[0],s=e[1],a=e[2],u=e[3],c=e[4],l=e[5],h=e[6],f=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*i+c*r,t[1]=s*i+l*r,t[2]=a*i+h*r,t[3]=u*i+f*r,t[4]=c*i-o*r,t[5]=l*i-s*r,t[6]=h*i-a*r,t[7]=f*i-u*r,t}function w(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],s=n+n,a=r+r,u=i+i,c=n*s,l=r*s,h=r*a,f=i*s,d=i*a,p=i*u,g=o*s,m=o*a,y=o*u;return t[0]=1-h-p,t[1]=l+y,t[2]=f-m,t[3]=0,t[4]=l-y,t[5]=1-c-p,t[6]=d+g,t[7]=0,t[8]=f+m,t[9]=d-g,t[10]=1-c-h,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function x(t,e,n,r,i,o,s){var a=1/(n-e),u=1/(i-r),c=1/(o-s);return t[0]=2*o*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*o*u,t[6]=0,t[7]=0,t[8]=(n+e)*a,t[9]=(i+r)*u,t[10]=(s+o)*c,t[11]=-1,t[12]=0,t[13]=0,t[14]=s*o*2*c,t[15]=0,t}function S(t,e,n,r,i){var o,s=1/Math.tan(e/2);return t[0]=s/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=i&&i!==1/0?(o=1/(r-i),t[10]=(i+r)*o,t[14]=2*i*r*o):(t[10]=-1,t[14]=-2*r),t}function E(t,e,n,r,i,o,s){var a=1/(e-n),u=1/(r-i),c=1/(o-s);return t[0]=-2*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*u,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(e+n)*a,t[13]=(i+r)*u,t[14]=(s+o)*c,t[15]=1,t}function A(t,e,n,r){var i,o,s,a,u,h,f,d,p,g,m=e[0],y=e[1],v=e[2],b=r[0],_=r[1],w=r[2],x=n[0],S=n[1],E=n[2];return Math.abs(m-x)<c["b"]&&Math.abs(y-S)<c["b"]&&Math.abs(v-E)<c["b"]?l(t):(f=m-x,d=y-S,p=v-E,g=1/Math.hypot(f,d,p),f*=g,d*=g,p*=g,i=_*p-w*d,o=w*f-b*p,s=b*d-_*f,g=Math.hypot(i,o,s),g?(g=1/g,i*=g,o*=g,s*=g):(i=0,o=0,s=0),a=d*s-p*o,u=p*i-f*s,h=f*o-d*i,g=Math.hypot(a,u,h),g?(g=1/g,a*=g,u*=g,h*=g):(a=0,u=0,h=0),t[0]=i,t[1]=a,t[2]=f,t[3]=0,t[4]=o,t[5]=u,t[6]=d,t[7]=0,t[8]=s,t[9]=h,t[10]=p,t[11]=0,t[12]=-(i*m+o*y+s*v),t[13]=-(a*m+u*y+h*v),t[14]=-(f*m+d*y+p*v),t[15]=1,t)}function M(){var t=new c["a"](2);return c["a"]!=Float32Array&&(t[0]=0,t[1]=0),t}function C(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[4]*i+n[12],t[1]=n[1]*r+n[5]*i+n[13],t}(function(){var t=M()})();var k=n("323f");function O(){var t=new c["a"](4);return c["a"]!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function P(t,e,n){var r=e[0],i=e[1],o=e[2],s=e[3];return t[0]=n[0]*r+n[4]*i+n[8]*o+n[12]*s,t[1]=n[1]*r+n[5]*i+n[9]*o+n[13]*s,t[2]=n[2]*r+n[6]*i+n[10]*o+n[14]*s,t[3]=n[3]*r+n[7]*i+n[11]*o+n[15]*s,t}(function(){var t=O()})();const T=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),L=Object.freeze([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),I=Object.freeze({COL0ROW0:0,COL0ROW1:1,COL0ROW2:2,COL0ROW3:3,COL1ROW0:4,COL1ROW1:5,COL1ROW2:6,COL1ROW3:7,COL2ROW0:8,COL2ROW1:9,COL2ROW2:10,COL2ROW3:11,COL3ROW0:12,COL3ROW1:13,COL3ROW2:14,COL3ROW3:15}),N={};class D extends a{static get IDENTITY(){return N.IDENTITY=N.IDENTITY||Object.freeze(new D(T)),N.IDENTITY}static get ZERO(){return N.ZERO=N.ZERO||Object.freeze(new D(L)),N.ZERO}get INDICES(){return I}get ELEMENTS(){return 16}get RANK(){return 4}constructor(t){super(-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0),1===arguments.length&&Array.isArray(t)?this.copy(t):this.identity()}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this[4]=t[4],this[5]=t[5],this[6]=t[6],this[7]=t[7],this[8]=t[8],this[9]=t[9],this[10]=t[10],this[11]=t[11],this[12]=t[12],this[13]=t[13],this[14]=t[14],this[15]=t[15],this.check()}set(t,e,n,r,i,o,s,a,u,c,l,h,f,d,p,g){return this[0]=t,this[1]=e,this[2]=n,this[3]=r,this[4]=i,this[5]=o,this[6]=s,this[7]=a,this[8]=u,this[9]=c,this[10]=l,this[11]=h,this[12]=f,this[13]=d,this[14]=p,this[15]=g,this.check()}setRowMajor(t,e,n,r,i,o,s,a,u,c,l,h,f,d,p,g){return this[0]=t,this[1]=i,this[2]=u,this[3]=f,this[4]=e,this[5]=o,this[6]=c,this[7]=d,this[8]=n,this[9]=s,this[10]=l,this[11]=p,this[12]=r,this[13]=a,this[14]=h,this[15]=g,this.check()}toRowMajor(t){return t[0]=this[0],t[1]=this[4],t[2]=this[8],t[3]=this[12],t[4]=this[1],t[5]=this[5],t[6]=this[9],t[7]=this[13],t[8]=this[2],t[9]=this[6],t[10]=this[10],t[11]=this[14],t[12]=this[3],t[13]=this[7],t[14]=this[11],t[15]=this[15],t}identity(){return this.copy(T)}fromQuaternion(t){return w(this,t),this.check()}frustum({left:t,right:e,bottom:n,top:r,near:i,far:o}){return o===1/0?D._computeInfinitePerspectiveOffCenter(this,t,e,n,r,i):x(this,t,e,n,r,i,o),this.check()}static _computeInfinitePerspectiveOffCenter(t,e,n,r,i,o){const s=2*o/(n-e),a=2*o/(i-r),u=(n+e)/(n-e),c=(i+r)/(i-r),l=-1,h=-1,f=-2*o;return t[0]=s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=u,t[9]=c,t[10]=l,t[11]=h,t[12]=0,t[13]=0,t[14]=f,t[15]=0,t}lookAt(t,e,n){return 1===arguments.length&&({eye:t,center:e,up:n}=t),e=e||[0,0,0],n=n||[0,1,0],A(this,t,e,n),this.check()}ortho({left:t,right:e,bottom:n,top:r,near:i=.1,far:o=500}){return E(this,t,e,n,r,i,o),this.check()}orthographic({fovy:t=45*Math.PI/180,aspect:e=1,focalDistance:n=1,near:r=.1,far:i=500}){if(t>2*Math.PI)throw Error("radians");const o=t/2,s=n*Math.tan(o),a=s*e;return(new D).ortho({left:-a,right:a,bottom:-s,top:s,near:r,far:i})}perspective({fovy:t,fov:e=45*Math.PI/180,aspect:n=1,near:r=.1,far:i=500}={}){if(t=t||e,t>2*Math.PI)throw Error("radians");return S(this,t,n,r,i),this.check()}determinant(){return d(this)}getScale(t=[-0,-0,-0]){return t[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),t[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),t[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),t}getTranslation(t=[-0,-0,-0]){return t[0]=this[12],t[1]=this[13],t[2]=this[14],t}getRotation(t=[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],e=null){const n=this.getScale(e||[-0,-0,-0]),r=1/n[0],i=1/n[1],o=1/n[2];return t[0]=this[0]*r,t[1]=this[1]*i,t[2]=this[2]*o,t[3]=0,t[4]=this[4]*r,t[5]=this[5]*i,t[6]=this[6]*o,t[7]=0,t[8]=this[8]*r,t[9]=this[9]*i,t[10]=this[10]*o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}getRotationMatrix3(t=[-0,-0,-0,-0,-0,-0,-0,-0,-0],e=null){const n=this.getScale(e||[-0,-0,-0]),r=1/n[0],i=1/n[1],o=1/n[2];return t[0]=this[0]*r,t[1]=this[1]*i,t[2]=this[2]*o,t[3]=this[4]*r,t[4]=this[5]*i,t[5]=this[6]*o,t[6]=this[8]*r,t[7]=this[9]*i,t[8]=this[10]*o,t}transpose(){return h(this,this),this.check()}invert(){return f(this,this),this.check()}multiplyLeft(t){return p(this,t,this),this.check()}multiplyRight(t){return p(this,this,t),this.check()}rotateX(t){return v(this,this,t),this.check()}rotateY(t){return b(this,this,t),this.check()}rotateZ(t){return _(this,this,t),this.check()}rotateXYZ([t,e,n]){return this.rotateX(t).rotateY(e).rotateZ(n)}rotateAxis(t,e){return y(this,this,t,e),this.check()}scale(t){return Array.isArray(t)?m(this,this,t):m(this,this,[t,t,t]),this.check()}translate(t){return g(this,this,t),this.check()}transform(t,e){return 4===t.length?(e=P(e||[-0,-0,-0,-0],t,this),Object(r["b"])(e,4),e):this.transformAsPoint(t,e)}transformAsPoint(t,e){const{length:n}=t;switch(n){case 2:e=C(e||[-0,-0],t,this);break;case 3:e=k["h"](e||[-0,-0,-0],t,this);break;default:throw new Error("Illegal vector")}return Object(r["b"])(e,t.length),e}transformAsVector(t,e){switch(t.length){case 2:e=Object(u["a"])(e||[-0,-0],t,this);break;case 3:e=Object(u["c"])(e||[-0,-0,-0],t,this);break;default:throw new Error("Illegal vector")}return Object(r["b"])(e,t.length),e}makeRotationX(t){return this.identity().rotateX(t)}makeTranslation(t,e,n){return this.identity().translate([t,e,n])}transformPoint(t,e){return Object(r["c"])("Matrix4.transformPoint","3.0"),this.transformAsPoint(t,e)}transformVector(t,e){return Object(r["c"])("Matrix4.transformVector","3.0"),this.transformAsPoint(t,e)}transformDirection(t,e){return Object(r["c"])("Matrix4.transformDirection","3.0"),this.transformAsVector(t,e)}}},"387f":function(t,e,n){"use strict";t.exports=function(t,e,n,r,i){return t.config=e,n&&(t.code=n),t.request=r,t.response=i,t.isAxiosError=!0,t.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code,status:this.response&&this.response.status?this.response.status:null}},t}},"38ac":function(t,e,n){"use strict";var r=n("4ea4"),i=n("7037");Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"self",{enumerable:!0,get:function(){return o.self}}),Object.defineProperty(e,"window",{enumerable:!0,get:function(){return o.window}}),Object.defineProperty(e,"global",{enumerable:!0,get:function(){return o.global}}),Object.defineProperty(e,"document",{enumerable:!0,get:function(){return o.document}}),Object.defineProperty(e,"process",{enumerable:!0,get:function(){return o.process}}),Object.defineProperty(e,"console",{enumerable:!0,get:function(){return o.console}}),Object.defineProperty(e,"isBrowser",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(e,"isBrowserMainThread",{enumerable:!0,get:function(){return s.isBrowserMainThread}}),Object.defineProperty(e,"getBrowser",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(e,"isMobile",{enumerable:!0,get:function(){return a.isMobile}}),Object.defineProperty(e,"isElectron",{enumerable:!0,get:function(){return u.default}});var o=n("9bef"),s=l(n("9401")),a=l(n("bd1b")),u=r(n("095a"));function c(t){if("function"!==typeof WeakMap)return null;var e=new WeakMap,n=new WeakMap;return(c=function(t){return t?n:e})(t)}function l(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!==i(t)&&"function"!==typeof t)return{default:t};var n=c(e);if(n&&n.has(t))return n.get(t);var r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in t)if("default"!==s&&Object.prototype.hasOwnProperty.call(t,s)){var a=o?Object.getOwnPropertyDescriptor(t,s):null;a&&(a.get||a.set)?Object.defineProperty(r,s,a):r[s]=t[s]}return r.default=t,n&&n.set(t,r),r}},3934:function(t,e,n){"use strict";var r=n("c532");t.exports=r.isStandardBrowserEnv()?function(){var t,e=/(msie|trident)/i.test(navigator.userAgent),n=document.createElement("a");function i(t){var r=t;return e&&(n.setAttribute("href",r),r=n.href),n.setAttribute("href",r),{href:n.href,protocol:n.protocol?n.protocol.replace(/:$/,""):"",host:n.host,search:n.search?n.search.replace(/^\?/,""):"",hash:n.hash?n.hash.replace(/^#/,""):"",hostname:n.hostname,port:n.port,pathname:"/"===n.pathname.charAt(0)?n.pathname:"/"+n.pathname}}return t=i(window.location.href),function(e){var n=r.isString(e)?i(e):e;return n.protocol===t.protocol&&n.host===t.host}}():function(){return function(){return!0}}()},"3a1f":function(t,e,n){},"3bd4":function(t,e,n){"use strict";n("c393")},"3c35":function(t,e){(function(e){t.exports=e}).call(this,{})},"3d96":function(t,e,n){"use strict";n("c895")},"3f90":function(t,e,n){"use strict";n.d(e,"b",(function(){return C})),n.d(e,"a",(function(){return k}));var r=n("5729"),i=n("a093");const o="OES_element_index",s="WEBGL_draw_buffers",a="EXT_disjoint_timer_query",u="EXT_disjoint_timer_query_webgl2",c="EXT_texture_filter_anisotropic",l="WEBGL_debug_renderer_info",h=35723,f=4352,d=36795,p=34047,g=37445,m=37446,y=t=>Object(i["e"])(t)?void 0:0,v={[3074]:t=>Object(i["e"])(t)?void 0:36064,[h]:t=>Object(i["e"])(t)?void 0:f,[35977]:y,[32937]:y,[d]:(t,e)=>{const n=Object(i["e"])(t)?t.getExtension(u):t.getExtension(a);return n&&n.GPU_DISJOINT_EXT?e(n.GPU_DISJOINT_EXT):0},[g]:(t,e)=>{const n=t.getExtension(l);return e(n&&n.UNMASKED_VENDOR_WEBGL||7936)},[m]:(t,e)=>{const n=t.getExtension(l);return e(n&&n.UNMASKED_RENDERER_WEBGL||7937)},[p]:(t,e)=>{const n=t.luma.extensions[c];return n?e(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT):1},[32883]:y,[35071]:y,[37447]:y,[36063]:(t,e)=>{if(!Object(i["e"])(t)){const n=t.getExtension(s);return n?e(n.MAX_COLOR_ATTACHMENTS_WEBGL):0}},[35379]:y,[35374]:y,[35377]:y,[34852]:t=>{if(!Object(i["e"])(t)){const e=t.getExtension(s);return e?e.MAX_DRAW_BUFFERS_WEBGL:0}},[36203]:t=>t.getExtension(o)?2147483647:65535,[33001]:t=>t.getExtension(o)?16777216:65535,[33e3]:t=>16777216,[37157]:y,[35373]:y,[35657]:y,[36183]:y,[37137]:y,[34045]:y,[35978]:y,[35979]:y,[35968]:y,[35376]:y,[35375]:y,[35659]:y,[37154]:y,[35371]:y,[35658]:y,[35076]:y,[35077]:y,[35380]:y};function b(t,e,n){const r=v[n],i="function"===typeof r?r(t,e,n):r,o=void 0!==i?i:e(n);return o}const _="OES_vertex_array_object",w="ANGLE_instanced_arrays",x="WEBGL_draw_buffers",S="EXT_disjoint_timer_query",E="EXT_texture_filter_anisotropic",A="VertexArray requires WebGL2 or OES_vertex_array_object extension";function M(t,e){return{webgl2:Object(i["e"])(t),ext:t.getExtension(e)}}const C={[_]:{meta:{suffix:"OES"},createVertexArray:()=>{Object(r["a"])(!1,A)},deleteVertexArray:()=>{},bindVertexArray:()=>{},isVertexArray:()=>!1},[w]:{meta:{suffix:"ANGLE"},vertexAttribDivisor(t,e){Object(r["a"])(0===e,"WebGL instanced rendering not supported")},drawElementsInstanced:()=>{},drawArraysInstanced:()=>{}},[x]:{meta:{suffix:"WEBGL"},drawBuffers:()=>{Object(r["a"])(!1)}},[S]:{meta:{suffix:"EXT"},createQuery:()=>{Object(r["a"])(!1)},deleteQuery:()=>{Object(r["a"])(!1)},beginQuery:()=>{Object(r["a"])(!1)},endQuery:()=>{},getQuery(t,e){return this.getQueryObject(t,e)},getQueryParameter(t,e){return this.getQueryObject(t,e)},getQueryObject:()=>{}}},k={readBuffer:(t,e,n)=>{Object(i["e"])(t)&&e(n)},getVertexAttrib:(t,e,n,r)=>{const{webgl2:i,ext:o}=M(t,w);let s;switch(r){case 35069:s=!!i&&void 0;break;case 35070:s=i||o?void 0:0;break;default:}return void 0!==s?s:e(n,r)},getProgramParameter:(t,e,n,r)=>{if(!Object(i["e"])(t))switch(r){case 35967:return 35981;case 35971:return 0;case 35382:return 0;default:}return e(n,r)},getInternalformatParameter:(t,e,n,r,o)=>{if(!Object(i["e"])(t))switch(o){case 32937:return new Int32Array([0]);default:}return t.getInternalformatParameter(n,r,o)},getTexParameter(t,e,n,r){switch(r){case 34046:const{extensions:e}=t.luma,n=e[E];r=n&&n.TEXTURE_MAX_ANISOTROPY_EXT||34046;break;default:}return e(n,r)},getParameter:b,hint(t,e,n,r){return e(n,r)}}},4:function(t,e){},4128:function(t,e,n){var r;(function(i){"use strict";var o,s,a,u=9e15,c=1e9,l="0123456789abcdef",h="2.3025850929940456840179914546843642076011014886287729760333279009675726096773524802359972050895982983419677840422862486334095254650828067566662873690987816894829072083255546808437998948262331985283935053089653777326288461633662222876982198867465436674744042432743651550489343149393914796194044002221051017141748003688084012647080685567743216228355220114804663715659121373450747856947683463616792101806445070648000277502684916746550586856935673420670581136429224554405758925724208241314695689016758940256776311356919292033376587141660230105703089634572075440370847469940168269282808481184289314848524948644871927809676271275775397027668605952496716674183485704422507197965004714951050492214776567636938662976979522110718264549734772662425709429322582798502585509785265383207606726317164309505995087807523710333101197857547331541421808427543863591778117054309827482385045648019095610299291824318237525357709750539565187697510374970888692180205189339507238539205144634197265287286965110862571492198849978748873771345686209167058",f="3.1415926535897932384626433832795028841971693993751058209749445923078164062862089986280348253421170679821480865132823066470938446095505822317253594081284811174502841027019385211055596446229489549303819644288109756659334461284756482337867831652712019091456485669234603486104543266482133936072602491412737245870066063155881748815209209628292540917153643678925903600113305305488204665213841469519415116094330572703657595919530921861173819326117931051185480744623799627495673518857527248912279381830119491298336733624406566430860213949463952247371907021798609437027705392171762931767523846748184676694051320005681271452635608277857713427577896091736371787214684409012249534301465495853710507922796892589235420199561121290219608640344181598136297747713099605187072113499999983729780499510597317328160963185950244594553469083026425223082533446850352619311881710100031378387528865875332083814206171776691473035982534904287554687311595628638823537875937519577818577805321712268066130019278766111959092164201989380952572010654858632789",d={precision:20,rounding:4,modulo:1,toExpNeg:-7,toExpPos:21,minE:-u,maxE:u,crypto:!1},p=!0,g="[DecimalError] ",m=g+"Invalid argument: ",y=g+"Precision limit exceeded",v=g+"crypto unavailable",b="[object Decimal]",_=Math.floor,w=Math.pow,x=/^0b([01]+(\.[01]*)?|\.[01]+)(p[+-]?\d+)?$/i,S=/^0x([0-9a-f]+(\.[0-9a-f]*)?|\.[0-9a-f]+)(p[+-]?\d+)?$/i,E=/^0o([0-7]+(\.[0-7]*)?|\.[0-7]+)(p[+-]?\d+)?$/i,A=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,M=1e7,C=7,k=9007199254740991,O=h.length-1,P=f.length-1,T={toStringTag:b};function L(t){var e,n,r,i=t.length-1,o="",s=t[0];if(i>0){for(o+=s,e=1;e<i;e++)r=t[e]+"",n=C-r.length,n&&(o+=q(n)),o+=r;s=t[e],r=s+"",n=C-r.length,n&&(o+=q(n))}else if(0===s)return"0";for(;s%10===0;)s/=10;return o+s}function I(t,e,n){if(t!==~~t||t<e||t>n)throw Error(m+t)}function N(t,e,n,r){var i,o,s,a;for(o=t[0];o>=10;o/=10)--e;return--e<0?(e+=C,i=0):(i=Math.ceil((e+1)/C),e%=C),o=w(10,C-e),a=t[i]%o|0,null==r?e<3?(0==e?a=a/100|0:1==e&&(a=a/10|0),s=n<4&&99999==a||n>3&&49999==a||5e4==a||0==a):s=(n<4&&a+1==o||n>3&&a+1==o/2)&&(t[i+1]/o/100|0)==w(10,e-2)-1||(a==o/2||0==a)&&0==(t[i+1]/o/100|0):e<4?(0==e?a=a/1e3|0:1==e?a=a/100|0:2==e&&(a=a/10|0),s=(r||n<4)&&9999==a||!r&&n>3&&4999==a):s=((r||n<4)&&a+1==o||!r&&n>3&&a+1==o/2)&&(t[i+1]/o/1e3|0)==w(10,e-3)-1,s}function D(t,e,n){for(var r,i,o=[0],s=0,a=t.length;s<a;){for(i=o.length;i--;)o[i]*=e;for(o[0]+=l.indexOf(t.charAt(s++)),r=0;r<o.length;r++)o[r]>n-1&&(void 0===o[r+1]&&(o[r+1]=0),o[r+1]+=o[r]/n|0,o[r]%=n)}return o.reverse()}function R(t,e){var n,r,i;if(e.isZero())return e;r=e.d.length,r<32?(n=Math.ceil(r/3),i=(1/et(4,n)).toString()):(n=16,i="2.3283064365386962890625e-10"),t.precision+=n,e=tt(t,1,e.times(i),new t(1));for(var o=n;o--;){var s=e.times(e);e=s.times(s).minus(s).times(8).plus(1)}return t.precision-=n,e}T.absoluteValue=T.abs=function(){var t=new this.constructor(this);return t.s<0&&(t.s=1),B(t)},T.ceil=function(){return B(new this.constructor(this),this.e+1,2)},T.clampedTo=T.clamp=function(t,e){var n,r=this,i=r.constructor;if(t=new i(t),e=new i(e),!t.s||!e.s)return new i(NaN);if(t.gt(e))throw Error(m+e);return n=r.cmp(t),n<0?t:r.cmp(e)>0?e:new i(r)},T.comparedTo=T.cmp=function(t){var e,n,r,i,o=this,s=o.d,a=(t=new o.constructor(t)).d,u=o.s,c=t.s;if(!s||!a)return u&&c?u!==c?u:s===a?0:!s^u<0?1:-1:NaN;if(!s[0]||!a[0])return s[0]?u:a[0]?-c:0;if(u!==c)return u;if(o.e!==t.e)return o.e>t.e^u<0?1:-1;for(r=s.length,i=a.length,e=0,n=r<i?r:i;e<n;++e)if(s[e]!==a[e])return s[e]>a[e]^u<0?1:-1;return r===i?0:r>i^u<0?1:-1},T.cosine=T.cos=function(){var t,e,n=this,r=n.constructor;return n.d?n.d[0]?(t=r.precision,e=r.rounding,r.precision=t+Math.max(n.e,n.sd())+C,r.rounding=1,n=R(r,nt(r,n)),r.precision=t,r.rounding=e,B(2==a||3==a?n.neg():n,t,e,!0)):new r(1):new r(NaN)},T.cubeRoot=T.cbrt=function(){var t,e,n,r,i,o,s,a,u,c,l=this,h=l.constructor;if(!l.isFinite()||l.isZero())return new h(l);for(p=!1,o=l.s*w(l.s*l,1/3),o&&Math.abs(o)!=1/0?r=new h(o.toString()):(n=L(l.d),t=l.e,(o=(t-n.length+1)%3)&&(n+=1==o||-2==o?"0":"00"),o=w(n,1/3),t=_((t+1)/3)-(t%3==(t<0?-1:2)),o==1/0?n="5e"+t:(n=o.toExponential(),n=n.slice(0,n.indexOf("e")+1)+t),r=new h(n),r.s=l.s),s=(t=h.precision)+3;;)if(a=r,u=a.times(a).times(a),c=u.plus(l),r=F(c.plus(l).times(a),c.plus(u),s+2,1),L(a.d).slice(0,s)===(n=L(r.d)).slice(0,s)){if(n=n.slice(s-3,s+1),"9999"!=n&&(i||"4999"!=n)){+n&&(+n.slice(1)||"5"!=n.charAt(0))||(B(r,t+1,1),e=!r.times(r).times(r).eq(l));break}if(!i&&(B(a,t+1,0),a.times(a).times(a).eq(l))){r=a;break}s+=4,i=1}return p=!0,B(r,t,h.rounding,e)},T.decimalPlaces=T.dp=function(){var t,e=this.d,n=NaN;if(e){if(t=e.length-1,n=(t-_(this.e/C))*C,t=e[t],t)for(;t%10==0;t/=10)n--;n<0&&(n=0)}return n},T.dividedBy=T.div=function(t){return F(this,new this.constructor(t))},T.dividedToIntegerBy=T.divToInt=function(t){var e=this,n=e.constructor;return B(F(e,new n(t),0,1,1),n.precision,n.rounding)},T.equals=T.eq=function(t){return 0===this.cmp(t)},T.floor=function(){return B(new this.constructor(this),this.e+1,3)},T.greaterThan=T.gt=function(t){return this.cmp(t)>0},T.greaterThanOrEqualTo=T.gte=function(t){var e=this.cmp(t);return 1==e||0===e},T.hyperbolicCosine=T.cosh=function(){var t,e,n,r,i,o=this,s=o.constructor,a=new s(1);if(!o.isFinite())return new s(o.s?1/0:NaN);if(o.isZero())return a;n=s.precision,r=s.rounding,s.precision=n+Math.max(o.e,o.sd())+4,s.rounding=1,i=o.d.length,i<32?(t=Math.ceil(i/3),e=(1/et(4,t)).toString()):(t=16,e="2.3283064365386962890625e-10"),o=tt(s,1,o.times(e),new s(1),!0);for(var u,c=t,l=new s(8);c--;)u=o.times(o),o=a.minus(u.times(l.minus(u.times(l))));return B(o,s.precision=n,s.rounding=r,!0)},T.hyperbolicSine=T.sinh=function(){var t,e,n,r,i=this,o=i.constructor;if(!i.isFinite()||i.isZero())return new o(i);if(e=o.precision,n=o.rounding,o.precision=e+Math.max(i.e,i.sd())+4,o.rounding=1,r=i.d.length,r<3)i=tt(o,2,i,i,!0);else{t=1.4*Math.sqrt(r),t=t>16?16:0|t,i=i.times(1/et(5,t)),i=tt(o,2,i,i,!0);for(var s,a=new o(5),u=new o(16),c=new o(20);t--;)s=i.times(i),i=i.times(a.plus(s.times(u.times(s).plus(c))))}return o.precision=e,o.rounding=n,B(i,e,n,!0)},T.hyperbolicTangent=T.tanh=function(){var t,e,n=this,r=n.constructor;return n.isFinite()?n.isZero()?new r(n):(t=r.precision,e=r.rounding,r.precision=t+7,r.rounding=1,F(n.sinh(),n.cosh(),r.precision=t,r.rounding=e)):new r(n.s)},T.inverseCosine=T.acos=function(){var t,e=this,n=e.constructor,r=e.abs().cmp(1),i=n.precision,o=n.rounding;return-1!==r?0===r?e.isNeg()?$(n,i,o):new n(0):new n(NaN):e.isZero()?$(n,i+4,o).times(.5):(n.precision=i+6,n.rounding=1,e=e.asin(),t=$(n,i+4,o).times(.5),n.precision=i,n.rounding=o,t.minus(e))},T.inverseHyperbolicCosine=T.acosh=function(){var t,e,n=this,r=n.constructor;return n.lte(1)?new r(n.eq(1)?0:NaN):n.isFinite()?(t=r.precision,e=r.rounding,r.precision=t+Math.max(Math.abs(n.e),n.sd())+4,r.rounding=1,p=!1,n=n.times(n).minus(1).sqrt().plus(n),p=!0,r.precision=t,r.rounding=e,n.ln()):new r(n)},T.inverseHyperbolicSine=T.asinh=function(){var t,e,n=this,r=n.constructor;return!n.isFinite()||n.isZero()?new r(n):(t=r.precision,e=r.rounding,r.precision=t+2*Math.max(Math.abs(n.e),n.sd())+6,r.rounding=1,p=!1,n=n.times(n).plus(1).sqrt().plus(n),p=!0,r.precision=t,r.rounding=e,n.ln())},T.inverseHyperbolicTangent=T.atanh=function(){var t,e,n,r,i=this,o=i.constructor;return i.isFinite()?i.e>=0?new o(i.abs().eq(1)?i.s/0:i.isZero()?i:NaN):(t=o.precision,e=o.rounding,r=i.sd(),Math.max(r,t)<2*-i.e-1?B(new o(i),t,e,!0):(o.precision=n=r-i.e,i=F(i.plus(1),new o(1).minus(i),n+t,1),o.precision=t+4,o.rounding=1,i=i.ln(),o.precision=t,o.rounding=e,i.times(.5))):new o(NaN)},T.inverseSine=T.asin=function(){var t,e,n,r,i=this,o=i.constructor;return i.isZero()?new o(i):(e=i.abs().cmp(1),n=o.precision,r=o.rounding,-1!==e?0===e?(t=$(o,n+4,r).times(.5),t.s=i.s,t):new o(NaN):(o.precision=n+6,o.rounding=1,i=i.div(new o(1).minus(i.times(i)).sqrt().plus(1)).atan(),o.precision=n,o.rounding=r,i.times(2)))},T.inverseTangent=T.atan=function(){var t,e,n,r,i,o,s,a,u,c=this,l=c.constructor,h=l.precision,f=l.rounding;if(c.isFinite()){if(c.isZero())return new l(c);if(c.abs().eq(1)&&h+4<=P)return s=$(l,h+4,f).times(.25),s.s=c.s,s}else{if(!c.s)return new l(NaN);if(h+4<=P)return s=$(l,h+4,f).times(.5),s.s=c.s,s}for(l.precision=a=h+10,l.rounding=1,n=Math.min(28,a/C+2|0),t=n;t;--t)c=c.div(c.times(c).plus(1).sqrt().plus(1));for(p=!1,e=Math.ceil(a/C),r=1,u=c.times(c),s=new l(c),i=c;-1!==t;)if(i=i.times(u),o=s.minus(i.div(r+=2)),i=i.times(u),s=o.plus(i.div(r+=2)),void 0!==s.d[e])for(t=e;s.d[t]===o.d[t]&&t--;);return n&&(s=s.times(2<<n-1)),p=!0,B(s,l.precision=h,l.rounding=f,!0)},T.isFinite=function(){return!!this.d},T.isInteger=T.isInt=function(){return!!this.d&&_(this.e/C)>this.d.length-2},T.isNaN=function(){return!this.s},T.isNegative=T.isNeg=function(){return this.s<0},T.isPositive=T.isPos=function(){return this.s>0},T.isZero=function(){return!!this.d&&0===this.d[0]},T.lessThan=T.lt=function(t){return this.cmp(t)<0},T.lessThanOrEqualTo=T.lte=function(t){return this.cmp(t)<1},T.logarithm=T.log=function(t){var e,n,r,i,o,s,a,u,c=this,l=c.constructor,h=l.precision,f=l.rounding,d=5;if(null==t)t=new l(10),e=!0;else{if(t=new l(t),n=t.d,t.s<0||!n||!n[0]||t.eq(1))return new l(NaN);e=t.eq(10)}if(n=c.d,c.s<0||!n||!n[0]||c.eq(1))return new l(n&&!n[0]?-1/0:1!=c.s?NaN:n?0:1/0);if(e)if(n.length>1)o=!0;else{for(i=n[0];i%10===0;)i/=10;o=1!==i}if(p=!1,a=h+d,s=Y(c,a),r=e?U(l,a+10):Y(t,a),u=F(s,r,a,1),N(u.d,i=h,f))do{if(a+=10,s=Y(c,a),r=e?U(l,a+10):Y(t,a),u=F(s,r,a,1),!o){+L(u.d).slice(i+1,i+15)+1==1e14&&(u=B(u,h+1,0));break}}while(N(u.d,i+=10,f));return p=!0,B(u,h,f)},T.minus=T.sub=function(t){var e,n,r,i,o,s,a,u,c,l,h,f,d=this,g=d.constructor;if(t=new g(t),!d.d||!t.d)return d.s&&t.s?d.d?t.s=-t.s:t=new g(t.d||d.s!==t.s?d:NaN):t=new g(NaN),t;if(d.s!=t.s)return t.s=-t.s,d.plus(t);if(c=d.d,f=t.d,a=g.precision,u=g.rounding,!c[0]||!f[0]){if(f[0])t.s=-t.s;else{if(!c[0])return new g(3===u?-0:0);t=new g(d)}return p?B(t,a,u):t}if(n=_(t.e/C),l=_(d.e/C),c=c.slice(),o=l-n,o){for(h=o<0,h?(e=c,o=-o,s=f.length):(e=f,n=l,s=c.length),r=Math.max(Math.ceil(a/C),s)+2,o>r&&(o=r,e.length=1),e.reverse(),r=o;r--;)e.push(0);e.reverse()}else{for(r=c.length,s=f.length,h=r<s,h&&(s=r),r=0;r<s;r++)if(c[r]!=f[r]){h=c[r]<f[r];break}o=0}for(h&&(e=c,c=f,f=e,t.s=-t.s),s=c.length,r=f.length-s;r>0;--r)c[s++]=0;for(r=f.length;r>o;){if(c[--r]<f[r]){for(i=r;i&&0===c[--i];)c[i]=M-1;--c[i],c[r]+=M}c[r]-=f[r]}for(;0===c[--s];)c.pop();for(;0===c[0];c.shift())--n;return c[0]?(t.d=c,t.e=z(c,n),p?B(t,a,u):t):new g(3===u?-0:0)},T.modulo=T.mod=function(t){var e,n=this,r=n.constructor;return t=new r(t),!n.d||!t.s||t.d&&!t.d[0]?new r(NaN):!t.d||n.d&&!n.d[0]?B(new r(n),r.precision,r.rounding):(p=!1,9==r.modulo?(e=F(n,t.abs(),0,3,1),e.s*=t.s):e=F(n,t,0,r.modulo,1),e=e.times(t),p=!0,n.minus(e))},T.naturalExponential=T.exp=function(){return X(this)},T.naturalLogarithm=T.ln=function(){return Y(this)},T.negated=T.neg=function(){var t=new this.constructor(this);return t.s=-t.s,B(t)},T.plus=T.add=function(t){var e,n,r,i,o,s,a,u,c,l,h=this,f=h.constructor;if(t=new f(t),!h.d||!t.d)return h.s&&t.s?h.d||(t=new f(t.d||h.s===t.s?h:NaN)):t=new f(NaN),t;if(h.s!=t.s)return t.s=-t.s,h.minus(t);if(c=h.d,l=t.d,a=f.precision,u=f.rounding,!c[0]||!l[0])return l[0]||(t=new f(h)),p?B(t,a,u):t;if(o=_(h.e/C),r=_(t.e/C),c=c.slice(),i=o-r,i){for(i<0?(n=c,i=-i,s=l.length):(n=l,r=o,s=c.length),o=Math.ceil(a/C),s=o>s?o+1:s+1,i>s&&(i=s,n.length=1),n.reverse();i--;)n.push(0);n.reverse()}for(s=c.length,i=l.length,s-i<0&&(i=s,n=l,l=c,c=n),e=0;i;)e=(c[--i]=c[i]+l[i]+e)/M|0,c[i]%=M;for(e&&(c.unshift(e),++r),s=c.length;0==c[--s];)c.pop();return t.d=c,t.e=z(c,r),p?B(t,a,u):t},T.precision=T.sd=function(t){var e,n=this;if(void 0!==t&&t!==!!t&&1!==t&&0!==t)throw Error(m+t);return n.d?(e=V(n.d),t&&n.e+1>e&&(e=n.e+1)):e=NaN,e},T.round=function(){var t=this,e=t.constructor;return B(new e(t),t.e+1,e.rounding)},T.sine=T.sin=function(){var t,e,n=this,r=n.constructor;return n.isFinite()?n.isZero()?new r(n):(t=r.precision,e=r.rounding,r.precision=t+Math.max(n.e,n.sd())+C,r.rounding=1,n=Q(r,nt(r,n)),r.precision=t,r.rounding=e,B(a>2?n.neg():n,t,e,!0)):new r(NaN)},T.squareRoot=T.sqrt=function(){var t,e,n,r,i,o,s=this,a=s.d,u=s.e,c=s.s,l=s.constructor;if(1!==c||!a||!a[0])return new l(!c||c<0&&(!a||a[0])?NaN:a?s:1/0);for(p=!1,c=Math.sqrt(+s),0==c||c==1/0?(e=L(a),(e.length+u)%2==0&&(e+="0"),c=Math.sqrt(e),u=_((u+1)/2)-(u<0||u%2),c==1/0?e="5e"+u:(e=c.toExponential(),e=e.slice(0,e.indexOf("e")+1)+u),r=new l(e)):r=new l(c.toString()),n=(u=l.precision)+3;;)if(o=r,r=o.plus(F(s,o,n+2,1)).times(.5),L(o.d).slice(0,n)===(e=L(r.d)).slice(0,n)){if(e=e.slice(n-3,n+1),"9999"!=e&&(i||"4999"!=e)){+e&&(+e.slice(1)||"5"!=e.charAt(0))||(B(r,u+1,1),t=!r.times(r).eq(s));break}if(!i&&(B(o,u+1,0),o.times(o).eq(s))){r=o;break}n+=4,i=1}return p=!0,B(r,u,l.rounding,t)},T.tangent=T.tan=function(){var t,e,n=this,r=n.constructor;return n.isFinite()?n.isZero()?new r(n):(t=r.precision,e=r.rounding,r.precision=t+10,r.rounding=1,n=n.sin(),n.s=1,n=F(n,new r(1).minus(n.times(n)).sqrt(),t+10,0),r.precision=t,r.rounding=e,B(2==a||4==a?n.neg():n,t,e,!0)):new r(NaN)},T.times=T.mul=function(t){var e,n,r,i,o,s,a,u,c,l=this,h=l.constructor,f=l.d,d=(t=new h(t)).d;if(t.s*=l.s,!f||!f[0]||!d||!d[0])return new h(!t.s||f&&!f[0]&&!d||d&&!d[0]&&!f?NaN:f&&d?0*t.s:t.s/0);for(n=_(l.e/C)+_(t.e/C),u=f.length,c=d.length,u<c&&(o=f,f=d,d=o,s=u,u=c,c=s),o=[],s=u+c,r=s;r--;)o.push(0);for(r=c;--r>=0;){for(e=0,i=u+r;i>r;)a=o[i]+d[r]*f[i-r-1]+e,o[i--]=a%M|0,e=a/M|0;o[i]=(o[i]+e)%M|0}for(;!o[--s];)o.pop();return e?++n:o.shift(),t.d=o,t.e=z(o,n),p?B(t,h.precision,h.rounding):t},T.toBinary=function(t,e){return rt(this,2,t,e)},T.toDecimalPlaces=T.toDP=function(t,e){var n=this,r=n.constructor;return n=new r(n),void 0===t?n:(I(t,0,c),void 0===e?e=r.rounding:I(e,0,8),B(n,t+n.e+1,e))},T.toExponential=function(t,e){var n,r=this,i=r.constructor;return void 0===t?n=j(r,!0):(I(t,0,c),void 0===e?e=i.rounding:I(e,0,8),r=B(new i(r),t+1,e),n=j(r,!0,t+1)),r.isNeg()&&!r.isZero()?"-"+n:n},T.toFixed=function(t,e){var n,r,i=this,o=i.constructor;return void 0===t?n=j(i):(I(t,0,c),void 0===e?e=o.rounding:I(e,0,8),r=B(new o(i),t+i.e+1,e),n=j(r,!1,t+r.e+1)),i.isNeg()&&!i.isZero()?"-"+n:n},T.toFraction=function(t){var e,n,r,i,o,s,a,u,c,l,h,f,d=this,g=d.d,y=d.constructor;if(!g)return new y(d);if(c=n=new y(1),r=u=new y(0),e=new y(r),o=e.e=V(g)-d.e-1,s=o%C,e.d[0]=w(10,s<0?C+s:s),null==t)t=o>0?e:c;else{if(a=new y(t),!a.isInt()||a.lt(c))throw Error(m+a);t=a.gt(e)?o>0?e:c:a}for(p=!1,a=new y(L(g)),l=y.precision,y.precision=o=g.length*C*2;;){if(h=F(a,e,0,1,1),i=n.plus(h.times(r)),1==i.cmp(t))break;n=r,r=i,i=c,c=u.plus(h.times(i)),u=i,i=e,e=a.minus(h.times(i)),a=i}return i=F(t.minus(n),r,0,1,1),u=u.plus(i.times(c)),n=n.plus(i.times(r)),u.s=c.s=d.s,f=F(c,r,o,1).minus(d).abs().cmp(F(u,n,o,1).minus(d).abs())<1?[c,r]:[u,n],y.precision=l,p=!0,f},T.toHexadecimal=T.toHex=function(t,e){return rt(this,16,t,e)},T.toNearest=function(t,e){var n=this,r=n.constructor;if(n=new r(n),null==t){if(!n.d)return n;t=new r(1),e=r.rounding}else{if(t=new r(t),void 0===e?e=r.rounding:I(e,0,8),!n.d)return t.s?n:t;if(!t.d)return t.s&&(t.s=n.s),t}return t.d[0]?(p=!1,n=F(n,t,0,e,1).times(t),p=!0,B(n)):(t.s=n.s,n=t),n},T.toNumber=function(){return+this},T.toOctal=function(t,e){return rt(this,8,t,e)},T.toPower=T.pow=function(t){var e,n,r,i,o,s,a=this,u=a.constructor,c=+(t=new u(t));if(!a.d||!t.d||!a.d[0]||!t.d[0])return new u(w(+a,c));if(a=new u(a),a.eq(1))return a;if(r=u.precision,o=u.rounding,t.eq(1))return B(a,r,o);if(e=_(t.e/C),e>=t.d.length-1&&(n=c<0?-c:c)<=k)return i=W(u,a,n,r),t.s<0?new u(1).div(i):B(i,r,o);if(s=a.s,s<0){if(e<t.d.length-1)return new u(NaN);if(0==(1&t.d[e])&&(s=1),0==a.e&&1==a.d[0]&&1==a.d.length)return a.s=s,a}return n=w(+a,c),e=0!=n&&isFinite(n)?new u(n+"").e:_(c*(Math.log("0."+L(a.d))/Math.LN10+a.e+1)),e>u.maxE+1||e<u.minE-1?new u(e>0?s/0:0):(p=!1,u.rounding=a.s=1,n=Math.min(12,(e+"").length),i=X(t.times(Y(a,r+n)),r),i.d&&(i=B(i,r+5,1),N(i.d,r,o)&&(e=r+10,i=B(X(t.times(Y(a,e+n)),e),e+5,1),+L(i.d).slice(r+1,r+15)+1==1e14&&(i=B(i,r+1,0)))),i.s=s,p=!0,u.rounding=o,B(i,r,o))},T.toPrecision=function(t,e){var n,r=this,i=r.constructor;return void 0===t?n=j(r,r.e<=i.toExpNeg||r.e>=i.toExpPos):(I(t,1,c),void 0===e?e=i.rounding:I(e,0,8),r=B(new i(r),t,e),n=j(r,t<=r.e||r.e<=i.toExpNeg,t)),r.isNeg()&&!r.isZero()?"-"+n:n},T.toSignificantDigits=T.toSD=function(t,e){var n=this,r=n.constructor;return void 0===t?(t=r.precision,e=r.rounding):(I(t,1,c),void 0===e?e=r.rounding:I(e,0,8)),B(new r(n),t,e)},T.toString=function(){var t=this,e=t.constructor,n=j(t,t.e<=e.toExpNeg||t.e>=e.toExpPos);return t.isNeg()&&!t.isZero()?"-"+n:n},T.truncated=T.trunc=function(){return B(new this.constructor(this),this.e+1,1)},T.valueOf=T.toJSON=function(){var t=this,e=t.constructor,n=j(t,t.e<=e.toExpNeg||t.e>=e.toExpPos);return t.isNeg()?"-"+n:n};var F=function(){function t(t,e,n){var r,i=0,o=t.length;for(t=t.slice();o--;)r=t[o]*e+i,t[o]=r%n|0,i=r/n|0;return i&&t.unshift(i),t}function e(t,e,n,r){var i,o;if(n!=r)o=n>r?1:-1;else for(i=o=0;i<n;i++)if(t[i]!=e[i]){o=t[i]>e[i]?1:-1;break}return o}function n(t,e,n,r){for(var i=0;n--;)t[n]-=i,i=t[n]<e[n]?1:0,t[n]=i*r+t[n]-e[n];for(;!t[0]&&t.length>1;)t.shift()}return function(r,i,o,a,u,c){var l,h,f,d,p,g,m,y,v,b,w,x,S,E,A,k,O,P,T,L,I=r.constructor,N=r.s==i.s?1:-1,D=r.d,R=i.d;if(!D||!D[0]||!R||!R[0])return new I(r.s&&i.s&&(D?!R||D[0]!=R[0]:R)?D&&0==D[0]||!R?0*N:N/0:NaN);for(c?(p=1,h=r.e-i.e):(c=M,p=C,h=_(r.e/p)-_(i.e/p)),T=R.length,O=D.length,v=new I(N),b=v.d=[],f=0;R[f]==(D[f]||0);f++);if(R[f]>(D[f]||0)&&h--,null==o?(E=o=I.precision,a=I.rounding):E=u?o+(r.e-i.e)+1:o,E<0)b.push(1),g=!0;else{if(E=E/p+2|0,f=0,1==T){for(d=0,R=R[0],E++;(f<O||d)&&E--;f++)A=d*c+(D[f]||0),b[f]=A/R|0,d=A%R|0;g=d||f<O}else{for(d=c/(R[0]+1)|0,d>1&&(R=t(R,d,c),D=t(D,d,c),T=R.length,O=D.length),k=T,w=D.slice(0,T),x=w.length;x<T;)w[x++]=0;L=R.slice(),L.unshift(0),P=R[0],R[1]>=c/2&&++P;do{d=0,l=e(R,w,T,x),l<0?(S=w[0],T!=x&&(S=S*c+(w[1]||0)),d=S/P|0,d>1?(d>=c&&(d=c-1),m=t(R,d,c),y=m.length,x=w.length,l=e(m,w,y,x),1==l&&(d--,n(m,T<y?L:R,y,c))):(0==d&&(l=d=1),m=R.slice()),y=m.length,y<x&&m.unshift(0),n(w,m,x,c),-1==l&&(x=w.length,l=e(R,w,T,x),l<1&&(d++,n(w,T<x?L:R,x,c))),x=w.length):0===l&&(d++,w=[0]),b[f++]=d,l&&w[0]?w[x++]=D[k]||0:(w=[D[k]],x=1)}while((k++<O||void 0!==w[0])&&E--);g=void 0!==w[0]}b[0]||b.shift()}if(1==p)v.e=h,s=g;else{for(f=1,d=b[0];d>=10;d/=10)f++;v.e=f+h*p-1,B(v,u?o+v.e+1:o,a,g)}return v}}();function B(t,e,n,r){var i,o,s,a,u,c,l,h,f,d=t.constructor;t:if(null!=e){if(h=t.d,!h)return t;for(i=1,a=h[0];a>=10;a/=10)i++;if(o=e-i,o<0)o+=C,s=e,l=h[f=0],u=l/w(10,i-s-1)%10|0;else if(f=Math.ceil((o+1)/C),a=h.length,f>=a){if(!r)break t;for(;a++<=f;)h.push(0);l=u=0,i=1,o%=C,s=o-C+1}else{for(l=a=h[f],i=1;a>=10;a/=10)i++;o%=C,s=o-C+i,u=s<0?0:l/w(10,i-s-1)%10|0}if(r=r||e<0||void 0!==h[f+1]||(s<0?l:l%w(10,i-s-1)),c=n<4?(u||r)&&(0==n||n==(t.s<0?3:2)):u>5||5==u&&(4==n||r||6==n&&(o>0?s>0?l/w(10,i-s):0:h[f-1])%10&1||n==(t.s<0?8:7)),e<1||!h[0])return h.length=0,c?(e-=t.e+1,h[0]=w(10,(C-e%C)%C),t.e=-e||0):h[0]=t.e=0,t;if(0==o?(h.length=f,a=1,f--):(h.length=f+1,a=w(10,C-o),h[f]=s>0?(l/w(10,i-s)%w(10,s)|0)*a:0),c)for(;;){if(0==f){for(o=1,s=h[0];s>=10;s/=10)o++;for(s=h[0]+=a,a=1;s>=10;s/=10)a++;o!=a&&(t.e++,h[0]==M&&(h[0]=1));break}if(h[f]+=a,h[f]!=M)break;h[f--]=0,a=1}for(o=h.length;0===h[--o];)h.pop()}return p&&(t.e>d.maxE?(t.d=null,t.e=NaN):t.e<d.minE&&(t.e=0,t.d=[0])),t}function j(t,e,n){if(!t.isFinite())return Z(t);var r,i=t.e,o=L(t.d),s=o.length;return e?(n&&(r=n-s)>0?o=o.charAt(0)+"."+o.slice(1)+q(r):s>1&&(o=o.charAt(0)+"."+o.slice(1)),o=o+(t.e<0?"e":"e+")+t.e):i<0?(o="0."+q(-i-1)+o,n&&(r=n-s)>0&&(o+=q(r))):i>=s?(o+=q(i+1-s),n&&(r=n-i-1)>0&&(o=o+"."+q(r))):((r=i+1)<s&&(o=o.slice(0,r)+"."+o.slice(r)),n&&(r=n-s)>0&&(i+1===s&&(o+="."),o+=q(r))),o}function z(t,e){var n=t[0];for(e*=C;n>=10;n/=10)e++;return e}function U(t,e,n){if(e>O)throw p=!0,n&&(t.precision=n),Error(y);return B(new t(h),e,1,!0)}function $(t,e,n){if(e>P)throw Error(y);return B(new t(f),e,n,!0)}function V(t){var e=t.length-1,n=e*C+1;if(e=t[e],e){for(;e%10==0;e/=10)n--;for(e=t[0];e>=10;e/=10)n++}return n}function q(t){for(var e="";t--;)e+="0";return e}function W(t,e,n,r){var i,o=new t(1),s=Math.ceil(r/C+4);for(p=!1;;){if(n%2&&(o=o.times(e),it(o.d,s)&&(i=!0)),n=_(n/2),0===n){n=o.d.length-1,i&&0===o.d[n]&&++o.d[n];break}e=e.times(e),it(e.d,s)}return p=!0,o}function G(t){return 1&t.d[t.d.length-1]}function H(t,e,n){for(var r,i=new t(e[0]),o=0;++o<e.length;){if(r=new t(e[o]),!r.s){i=r;break}i[n](r)&&(i=r)}return i}function X(t,e){var n,r,i,o,s,a,u,c=0,l=0,h=0,f=t.constructor,d=f.rounding,g=f.precision;if(!t.d||!t.d[0]||t.e>17)return new f(t.d?t.d[0]?t.s<0?0:1/0:1:t.s?t.s<0?0:t:NaN);null==e?(p=!1,u=g):u=e,a=new f(.03125);while(t.e>-2)t=t.times(a),h+=5;for(r=Math.log(w(2,h))/Math.LN10*2+5|0,u+=r,n=o=s=new f(1),f.precision=u;;){if(o=B(o.times(t),u,1),n=n.times(++l),a=s.plus(F(o,n,u,1)),L(a.d).slice(0,u)===L(s.d).slice(0,u)){i=h;while(i--)s=B(s.times(s),u,1);if(null!=e)return f.precision=g,s;if(!(c<3&&N(s.d,u-r,d,c)))return B(s,f.precision=g,d,p=!0);f.precision=u+=10,n=o=a=new f(1),l=0,c++}s=a}}function Y(t,e){var n,r,i,o,s,a,u,c,l,h,f,d=1,g=10,m=t,y=m.d,v=m.constructor,b=v.rounding,_=v.precision;if(m.s<0||!y||!y[0]||!m.e&&1==y[0]&&1==y.length)return new v(y&&!y[0]?-1/0:1!=m.s?NaN:y?0:m);if(null==e?(p=!1,l=_):l=e,v.precision=l+=g,n=L(y),r=n.charAt(0),!(Math.abs(o=m.e)<15e14))return c=U(v,l+2,_).times(o+""),m=Y(new v(r+"."+n.slice(1)),l-g).plus(c),v.precision=_,null==e?B(m,_,b,p=!0):m;while(r<7&&1!=r||1==r&&n.charAt(1)>3)m=m.times(t),n=L(m.d),r=n.charAt(0),d++;for(o=m.e,r>1?(m=new v("0."+n),o++):m=new v(r+"."+n.slice(1)),h=m,u=s=m=F(m.minus(1),m.plus(1),l,1),f=B(m.times(m),l,1),i=3;;){if(s=B(s.times(f),l,1),c=u.plus(F(s,new v(i),l,1)),L(c.d).slice(0,l)===L(u.d).slice(0,l)){if(u=u.times(2),0!==o&&(u=u.plus(U(v,l+2,_).times(o+""))),u=F(u,new v(d),l,1),null!=e)return v.precision=_,u;if(!N(u.d,l-g,b,a))return B(u,v.precision=_,b,p=!0);v.precision=l+=g,c=s=m=F(h.minus(1),h.plus(1),l,1),f=B(m.times(m),l,1),i=a=1}u=c,i+=2}}function Z(t){return String(t.s*t.s/0)}function K(t,e){var n,r,i;for((n=e.indexOf("."))>-1&&(e=e.replace(".","")),(r=e.search(/e/i))>0?(n<0&&(n=r),n+=+e.slice(r+1),e=e.substring(0,r)):n<0&&(n=e.length),r=0;48===e.charCodeAt(r);r++);for(i=e.length;48===e.charCodeAt(i-1);--i);if(e=e.slice(r,i),e){if(i-=r,t.e=n=n-r-1,t.d=[],r=(n+1)%C,n<0&&(r+=C),r<i){for(r&&t.d.push(+e.slice(0,r)),i-=C;r<i;)t.d.push(+e.slice(r,r+=C));e=e.slice(r),r=C-e.length}else r-=i;for(;r--;)e+="0";t.d.push(+e),p&&(t.e>t.constructor.maxE?(t.d=null,t.e=NaN):t.e<t.constructor.minE&&(t.e=0,t.d=[0]))}else t.e=0,t.d=[0];return t}function J(t,e){var n,r,i,s,a,u,c,l,h;if(e.indexOf("_")>-1){if(e=e.replace(/(\d)_(?=\d)/g,"$1"),A.test(e))return K(t,e)}else if("Infinity"===e||"NaN"===e)return+e||(t.s=NaN),t.e=NaN,t.d=null,t;if(S.test(e))n=16,e=e.toLowerCase();else if(x.test(e))n=2;else{if(!E.test(e))throw Error(m+e);n=8}for(s=e.search(/p/i),s>0?(c=+e.slice(s+1),e=e.substring(2,s)):e=e.slice(2),s=e.indexOf("."),a=s>=0,r=t.constructor,a&&(e=e.replace(".",""),u=e.length,s=u-s,i=W(r,new r(n),s,2*s)),l=D(e,n,M),h=l.length-1,s=h;0===l[s];--s)l.pop();return s<0?new r(0*t.s):(t.e=z(l,h),t.d=l,p=!1,a&&(t=F(t,i,4*u)),c&&(t=t.times(Math.abs(c)<54?w(2,c):o.pow(2,c))),p=!0,t)}function Q(t,e){var n,r=e.d.length;if(r<3)return e.isZero()?e:tt(t,2,e,e);n=1.4*Math.sqrt(r),n=n>16?16:0|n,e=e.times(1/et(5,n)),e=tt(t,2,e,e);for(var i,o=new t(5),s=new t(16),a=new t(20);n--;)i=e.times(e),e=e.times(o.plus(i.times(s.times(i).minus(a))));return e}function tt(t,e,n,r,i){var o,s,a,u,c=t.precision,l=Math.ceil(c/C);for(p=!1,u=n.times(n),a=new t(r);;){if(s=F(a.times(u),new t(e++*e++),c,1),a=i?r.plus(s):r.minus(s),r=F(s.times(u),new t(e++*e++),c,1),s=a.plus(r),void 0!==s.d[l]){for(o=l;s.d[o]===a.d[o]&&o--;);if(-1==o)break}o=a,a=r,r=s,s=o}return p=!0,s.d.length=l+1,s}function et(t,e){var n=t;while(--e)n*=t;return n}function nt(t,e){var n,r=e.s<0,i=$(t,t.precision,1),o=i.times(.5);if(e=e.abs(),e.lte(o))return a=r?4:1,e;if(n=e.divToInt(i),n.isZero())a=r?3:2;else{if(e=e.minus(n.times(i)),e.lte(o))return a=G(n)?r?2:3:r?4:1,e;a=G(n)?r?1:4:r?3:2}return e.minus(i).abs()}function rt(t,e,n,r){var i,o,a,u,h,f,d,p,g,m=t.constructor,y=void 0!==n;if(y?(I(n,1,c),void 0===r?r=m.rounding:I(r,0,8)):(n=m.precision,r=m.rounding),t.isFinite()){for(d=j(t),a=d.indexOf("."),y?(i=2,16==e?n=4*n-3:8==e&&(n=3*n-2)):i=e,a>=0&&(d=d.replace(".",""),g=new m(1),g.e=d.length-a,g.d=D(j(g),10,i),g.e=g.d.length),p=D(d,10,i),o=h=p.length;0==p[--h];)p.pop();if(p[0]){if(a<0?o--:(t=new m(t),t.d=p,t.e=o,t=F(t,g,n,r,0,i),p=t.d,o=t.e,f=s),a=p[n],u=i/2,f=f||void 0!==p[n+1],f=r<4?(void 0!==a||f)&&(0===r||r===(t.s<0?3:2)):a>u||a===u&&(4===r||f||6===r&&1&p[n-1]||r===(t.s<0?8:7)),p.length=n,f)for(;++p[--n]>i-1;)p[n]=0,n||(++o,p.unshift(1));for(h=p.length;!p[h-1];--h);for(a=0,d="";a<h;a++)d+=l.charAt(p[a]);if(y){if(h>1)if(16==e||8==e){for(a=16==e?4:3,--h;h%a;h++)d+="0";for(p=D(d,i,e),h=p.length;!p[h-1];--h);for(a=1,d="1.";a<h;a++)d+=l.charAt(p[a])}else d=d.charAt(0)+"."+d.slice(1);d=d+(o<0?"p":"p+")+o}else if(o<0){for(;++o;)d="0"+d;d="0."+d}else if(++o>h)for(o-=h;o--;)d+="0";else o<h&&(d=d.slice(0,o)+"."+d.slice(o))}else d=y?"0p+0":"0";d=(16==e?"0x":2==e?"0b":8==e?"0o":"")+d}else d=Z(t);return t.s<0?"-"+d:d}function it(t,e){if(t.length>e)return t.length=e,!0}function ot(t){return new this(t).abs()}function st(t){return new this(t).acos()}function at(t){return new this(t).acosh()}function ut(t,e){return new this(t).plus(e)}function ct(t){return new this(t).asin()}function lt(t){return new this(t).asinh()}function ht(t){return new this(t).atan()}function ft(t){return new this(t).atanh()}function dt(t,e){t=new this(t),e=new this(e);var n,r=this.precision,i=this.rounding,o=r+4;return t.s&&e.s?t.d||e.d?!e.d||t.isZero()?(n=e.s<0?$(this,r,i):new this(0),n.s=t.s):!t.d||e.isZero()?(n=$(this,o,1).times(.5),n.s=t.s):e.s<0?(this.precision=o,this.rounding=1,n=this.atan(F(t,e,o,1)),e=$(this,o,1),this.precision=r,this.rounding=i,n=t.s<0?n.minus(e):n.plus(e)):n=this.atan(F(t,e,o,1)):(n=$(this,o,1).times(e.s>0?.25:.75),n.s=t.s):n=new this(NaN),n}function pt(t){return new this(t).cbrt()}function gt(t){return B(t=new this(t),t.e+1,2)}function mt(t,e,n){return new this(t).clamp(e,n)}function yt(t){if(!t||"object"!==typeof t)throw Error(g+"Object expected");var e,n,r,i=!0===t.defaults,o=["precision",1,c,"rounding",0,8,"toExpNeg",-u,0,"toExpPos",0,u,"maxE",0,u,"minE",-u,0,"modulo",0,9];for(e=0;e<o.length;e+=3)if(n=o[e],i&&(this[n]=d[n]),void 0!==(r=t[n])){if(!(_(r)===r&&r>=o[e+1]&&r<=o[e+2]))throw Error(m+n+": "+r);this[n]=r}if(n="crypto",i&&(this[n]=d[n]),void 0!==(r=t[n])){if(!0!==r&&!1!==r&&0!==r&&1!==r)throw Error(m+n+": "+r);if(r){if("undefined"==typeof crypto||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw Error(v);this[n]=!0}else this[n]=!1}return this}function vt(t){return new this(t).cos()}function bt(t){return new this(t).cosh()}function _t(t){var e,n,r;function i(t){var e,n,r,o=this;if(!(o instanceof i))return new i(t);if(o.constructor=i,At(t))return o.s=t.s,void(p?!t.d||t.e>i.maxE?(o.e=NaN,o.d=null):t.e<i.minE?(o.e=0,o.d=[0]):(o.e=t.e,o.d=t.d.slice()):(o.e=t.e,o.d=t.d?t.d.slice():t.d));if(r=typeof t,"number"===r){if(0===t)return o.s=1/t<0?-1:1,o.e=0,void(o.d=[0]);if(t<0?(t=-t,o.s=-1):o.s=1,t===~~t&&t<1e7){for(e=0,n=t;n>=10;n/=10)e++;return void(p?e>i.maxE?(o.e=NaN,o.d=null):e<i.minE?(o.e=0,o.d=[0]):(o.e=e,o.d=[t]):(o.e=e,o.d=[t]))}return 0*t!==0?(t||(o.s=NaN),o.e=NaN,void(o.d=null)):K(o,t.toString())}if("string"!==r)throw Error(m+t);return 45===(n=t.charCodeAt(0))?(t=t.slice(1),o.s=-1):(43===n&&(t=t.slice(1)),o.s=1),A.test(t)?K(o,t):J(o,t)}if(i.prototype=T,i.ROUND_UP=0,i.ROUND_DOWN=1,i.ROUND_CEIL=2,i.ROUND_FLOOR=3,i.ROUND_HALF_UP=4,i.ROUND_HALF_DOWN=5,i.ROUND_HALF_EVEN=6,i.ROUND_HALF_CEIL=7,i.ROUND_HALF_FLOOR=8,i.EUCLID=9,i.config=i.set=yt,i.clone=_t,i.isDecimal=At,i.abs=ot,i.acos=st,i.acosh=at,i.add=ut,i.asin=ct,i.asinh=lt,i.atan=ht,i.atanh=ft,i.atan2=dt,i.cbrt=pt,i.ceil=gt,i.clamp=mt,i.cos=vt,i.cosh=bt,i.div=wt,i.exp=xt,i.floor=St,i.hypot=Et,i.ln=Mt,i.log=Ct,i.log10=Ot,i.log2=kt,i.max=Pt,i.min=Tt,i.mod=Lt,i.mul=It,i.pow=Nt,i.random=Dt,i.round=Rt,i.sign=Ft,i.sin=Bt,i.sinh=jt,i.sqrt=zt,i.sub=Ut,i.sum=$t,i.tan=Vt,i.tanh=qt,i.trunc=Wt,void 0===t&&(t={}),t&&!0!==t.defaults)for(r=["precision","rounding","toExpNeg","toExpPos","maxE","minE","modulo","crypto"],e=0;e<r.length;)t.hasOwnProperty(n=r[e++])||(t[n]=this[n]);return i.config(t),i}function wt(t,e){return new this(t).div(e)}function xt(t){return new this(t).exp()}function St(t){return B(t=new this(t),t.e+1,3)}function Et(){var t,e,n=new this(0);for(p=!1,t=0;t<arguments.length;)if(e=new this(arguments[t++]),e.d)n.d&&(n=n.plus(e.times(e)));else{if(e.s)return p=!0,new this(1/0);n=e}return p=!0,n.sqrt()}function At(t){return t instanceof o||t&&t.toStringTag===b||!1}function Mt(t){return new this(t).ln()}function Ct(t,e){return new this(t).log(e)}function kt(t){return new this(t).log(2)}function Ot(t){return new this(t).log(10)}function Pt(){return H(this,arguments,"lt")}function Tt(){return H(this,arguments,"gt")}function Lt(t,e){return new this(t).mod(e)}function It(t,e){return new this(t).mul(e)}function Nt(t,e){return new this(t).pow(e)}function Dt(t){var e,n,r,i,o=0,s=new this(1),a=[];if(void 0===t?t=this.precision:I(t,1,c),r=Math.ceil(t/C),this.crypto)if(crypto.getRandomValues)for(e=crypto.getRandomValues(new Uint32Array(r));o<r;)i=e[o],i>=429e7?e[o]=crypto.getRandomValues(new Uint32Array(1))[0]:a[o++]=i%1e7;else{if(!crypto.randomBytes)throw Error(v);for(e=crypto.randomBytes(r*=4);o<r;)i=e[o]+(e[o+1]<<8)+(e[o+2]<<16)+((127&e[o+3])<<24),i>=214e7?crypto.randomBytes(4).copy(e,o):(a.push(i%1e7),o+=4);o=r/4}else for(;o<r;)a[o++]=1e7*Math.random()|0;for(r=a[--o],t%=C,r&&t&&(i=w(10,C-t),a[o]=(r/i|0)*i);0===a[o];o--)a.pop();if(o<0)n=0,a=[0];else{for(n=-1;0===a[0];n-=C)a.shift();for(r=1,i=a[0];i>=10;i/=10)r++;r<C&&(n-=C-r)}return s.e=n,s.d=a,s}function Rt(t){return B(t=new this(t),t.e+1,this.rounding)}function Ft(t){return t=new this(t),t.d?t.d[0]?t.s:0*t.s:t.s||NaN}function Bt(t){return new this(t).sin()}function jt(t){return new this(t).sinh()}function zt(t){return new this(t).sqrt()}function Ut(t,e){return new this(t).sub(e)}function $t(){var t=0,e=arguments,n=new this(e[t]);for(p=!1;n.s&&++t<e.length;)n=n.plus(e[t]);return p=!0,B(n,this.precision,this.rounding)}function Vt(t){return new this(t).tan()}function qt(t){return new this(t).tanh()}function Wt(t){return B(t=new this(t),t.e+1,1)}o=_t(d),o.prototype.constructor=o,o["default"]=o.Decimal=o,h=new o(h),f=new o(f),r=function(){return o}.call(e,n,e,t),void 0===r||(t.exports=r)})()},"41b5":function(t,e,n){"use strict";n.d(e,"a",(function(){return Bt}));var r=n("c194");const i=10,o=100,s=15,a=140,u=180,c=40,l=40,h=40,f=40,d=100,p=100,g=30,m=60,y=69,v=92,b=120,_=120,w=20;function x(t){switch(t.insight.totalStyle){case"sum-strip":case"sum-strip-percent":case"sum-treemap":return!1;default:return!0}}var S=function(t){const{insight:e,specColumns:n,specViewOptions:a}=t,{language:u}=a,c={orientation:"horizontal",groupby:{column:n.y,defaultBins:i,maxbinsSignalName:r["e"].YBins,maxbinsSignalDisplayName:t.specViewOptions.language.YMaxBins,maxbins:o},minBandWidth:s,showAxes:!0},l={title:null},h={x:l,y:{title:n.y&&n.y.name},z:{title:n.z&&n.z.name}},f=[{layoutType:"Band",props:c}];if("sum-strip-percent"===e.totalStyle){l.aggregate="percent",l.title=u.percent;const t={addPercentageScale:!0,sortOrder:"ascending",orientation:"horizontal",size:n.size,sort:n.sort,z:n.z};f.push({layoutType:"Strip",props:t})}else{const t={niceScale:!0,dock:"left",globalAggregateMaxExtentSignal:"aggMaxExtent",globalAggregateMaxExtentScaledSignal:"aggMaxExtentScaled",sumBy:n.size,showAxes:!0};switch(f.push({layoutType:"AggregateContainer",props:t}),e.totalStyle){case"sum-treemap":{l.aggregate="sum",l.title=u.sum;const t={corner:"top-left",size:n.size,treeMapMethod:a.language.treeMapMethod,z:n.z};f.push({layoutType:"Treemap",props:t});break}case"sum-strip":{l.aggregate="sum",l.title=u.sum;const t={sortOrder:"ascending",orientation:"horizontal",size:n.size,sort:n.sort,z:n.z};f.push({layoutType:"Strip",props:t});break}case"count-strip":{l.aggregate="count",l.title=u.count;const t={sortOrder:"ascending",orientation:"horizontal",size:n.size,sort:n.sort,z:n.z};f.push({layoutType:"Strip",props:t});break}default:{l.aggregate="count",l.title=u.count;const e={sortBy:n.sort,fillDirection:"down-right",z:n.z,maxGroupedUnits:t.globalAggregateMaxExtentSignal,maxGroupedFillSize:t.globalAggregateMaxExtentScaledSignal};f.push({layoutType:"Square",props:e});break}}}return{axisScales:h,layouts:f,specCapabilities:{countsAndSums:!0,percentage:!0,roles:[{role:"y",binnable:!0,axisSelection:n.y&&n.y.quantitative?"range":"exact",signals:[r["e"].YBins]},{role:"z",axisSelection:n.z&&n.z.quantitative?"range":"exact",allowNone:!0},{role:"color",allowNone:!0},{role:"sort",allowNone:!0},{role:"size",allowNone:x,excludeCategoric:!0,signals:[r["e"].TreeMapMethod]},{role:"facet",allowNone:!0,signals:[r["e"].FacetBins]},{role:"facetV",allowNone:!0,signals:[r["e"].FacetVBins]}]}}},E=function(t){const{insight:e,specColumns:n,specViewOptions:a}=t,{language:u}=a,c={orientation:"vertical",groupby:{column:n.x,defaultBins:i,maxbinsSignalName:r["e"].XBins,maxbinsSignalDisplayName:t.specViewOptions.language.XMaxBins,maxbins:o},minBandWidth:s,showAxes:!0},l={title:null},h={x:{title:n.x&&n.x.name},y:l,z:{title:n.z&&n.z.name}},f=[{layoutType:"Band",props:c}];if("sum-strip-percent"===e.totalStyle){l.aggregate="percent",l.title=u.percent;const t={addPercentageScale:!0,sortOrder:"descending",orientation:"vertical",size:n.size,sort:n.sort,z:n.z};f.push({layoutType:"Strip",props:t})}else{const t={niceScale:!0,dock:"bottom",globalAggregateMaxExtentSignal:"aggMaxExtent",globalAggregateMaxExtentScaledSignal:"aggMaxExtentScaled",sumBy:n.size,showAxes:!0};switch(f.push({layoutType:"AggregateContainer",props:t}),e.totalStyle){case"sum-treemap":{l.aggregate="sum",l.title=u.sum;const t={corner:"bottom-left",size:n.size,treeMapMethod:a.language.treeMapMethod,z:n.z};f.push({layoutType:"Treemap",props:t});break}case"sum-strip":{l.aggregate="sum",l.title=u.sum;const t={sortOrder:"descending",orientation:"vertical",size:n.size,sort:n.sort,z:n.z};f.push({layoutType:"Strip",props:t});break}case"count-strip":{l.aggregate="count",l.title=u.count;const t={sortOrder:"descending",orientation:"vertical",sort:n.sort,z:n.z};f.push({layoutType:"Strip",props:t});break}default:{l.aggregate="count",l.title=u.count;const e={sortBy:n.sort,fillDirection:"right-up",z:n.z,maxGroupedUnits:t.globalAggregateMaxExtentSignal,maxGroupedFillSize:t.globalAggregateMaxExtentScaledSignal};f.push({layoutType:"Square",props:e});break}}}return{axisScales:h,layouts:f,specCapabilities:{countsAndSums:!0,percentage:!0,roles:[{role:"x",binnable:!0,axisSelection:n.x&&n.x.quantitative?"range":"exact",signals:[r["e"].XBins]},{role:"z",axisSelection:n.z&&n.z.quantitative?"range":"exact",allowNone:!0},{role:"color",allowNone:!0},{role:"sort",allowNone:!0},{role:"size",allowNone:x,excludeCategoric:!0,signals:[r["e"].TreeMapMethod]},{role:"facet",allowNone:!0,signals:[r["e"].FacetBins]},{role:"facetV",allowNone:!0,signals:[r["e"].FacetVBins]}]}}},A=function(t){const{insight:e,specColumns:n,specViewOptions:a}=t,u={x:{title:n.x&&n.x.name},y:{title:n.y&&n.y.name},z:{title:n.z&&n.z.name}},c={excludeEncodingRuleMap:!0,orientation:"horizontal",groupby:{column:n.y,defaultBins:i,maxbinsSignalName:r["e"].YBins,maxbinsSignalDisplayName:t.specViewOptions.language.YMaxBins,maxbins:o},minBandWidth:s,showAxes:!0},l={excludeEncodingRuleMap:!0,orientation:"vertical",groupby:{column:n.x,defaultBins:i,maxbinsSignalName:r["e"].XBins,maxbinsSignalDisplayName:t.specViewOptions.language.XMaxBins,maxbins:o},minBandWidth:s,showAxes:!0},h={onBuild:null,aggregation:null,sumBy:n.size},f=[{layoutType:"Band",props:l},{layoutType:"Band",props:c},{layoutType:"AggregateSquare",props:h}];switch(e.totalStyle){case"sum-treemap":{h.aggregation="sum";const t={corner:"bottom-left",size:n.size,treeMapMethod:a.language.treeMapMethod,z:n.z};f.push({layoutType:"Treemap",props:t});break}case"sum-strip":{h.aggregation="sum";const t={sortOrder:"ascending",orientation:"vertical",size:n.size,sort:n.sort,z:n.z};f.push({layoutType:"Strip",props:t});break}case"count-strip":{h.aggregation="count";const t={sortOrder:"ascending",orientation:"vertical",sort:n.sort,z:n.z};f.push({layoutType:"Strip",props:t});break}default:{h.aggregation="count";const t={sortBy:n.sort,fillDirection:"right-down",z:n.z,maxGroupedUnits:null,maxGroupedFillSize:null};h.onBuild=(e,n)=>{t.maxGroupedUnits=e,t.maxGroupedFillSize=n},f.push({layoutType:"Square",props:t});break}}return{axisScales:u,layouts:f,specCapabilities:{countsAndSums:!0,roles:[{role:"x",binnable:!0,axisSelection:n.x&&n.x.quantitative?"range":"exact",signals:[r["e"].XBins]},{role:"y",binnable:!0,axisSelection:n.y&&n.y.quantitative?"range":"exact",signals:[r["e"].YBins]},{role:"z",axisSelection:n.z&&n.z.quantitative?"range":"exact",allowNone:!0},{role:"color",allowNone:!0},{role:"sort",allowNone:!0},{role:"size",allowNone:x,excludeCategoric:!0,signals:[r["e"].TreeMapMethod]},{role:"facet",allowNone:!0,signals:[r["e"].FacetBins]},{role:"facetV",allowNone:!0,signals:[r["e"].FacetVBins]}]}}},M=function(t){const{specColumns:e}=t,n={sortBy:e.sort,fillDirection:"right-down",z:e.z,collapseYHeight:!0},i={z:{title:e.z&&e.z.name}};return{axisScales:i,layouts:[{layoutType:"Square",props:n}],specCapabilities:{countsAndSums:!1,roles:[{role:"z",axisSelection:e.z&&e.z.quantitative?"range":"exact",allowNone:!0},{role:"color",allowNone:!0},{role:"sort",allowNone:!0},{role:"facet",allowNone:!0,signals:[r["e"].FacetBins]},{role:"facetV",allowNone:!0,signals:[r["e"].FacetVBins]}]}}},C=function(t){const{specColumns:e,specViewOptions:n}=t,i={x:e.x,y:e.y,z:e.z,size:e.size,scatterPointScaleDisplay:n.language.scatterPointScale,zGrounded:n.language.zGrounded},o={x:{title:e.x&&e.x.name},y:{title:e.y&&e.y.name},z:{title:e.z&&e.z.name}};return{axisScales:o,layouts:[{layoutType:"Scatter",props:i}],specCapabilities:{countsAndSums:!1,roles:[{role:"x",axisSelection:e.x&&e.x.quantitative?"range":"exact"},{role:"y",axisSelection:e.y&&e.y.quantitative?"range":"exact"},{role:"z",axisSelection:e.z&&e.z.quantitative?"range":"exact",allowNone:!0},{role:"color",allowNone:!0},{role:"size",excludeCategoric:!0,allowNone:!0},{role:"facet",allowNone:!0,signals:[r["e"].FacetBins]},{role:"facetV",allowNone:!0,signals:[r["e"].FacetVBins]}],signals:[r["e"].PointScale,r["e"].ZGrounded]}}},k=function(t){const{specColumns:e,specViewOptions:n}=t,a={x:{title:e.x&&e.x.name},y:{title:e.y&&e.y.name},z:{title:n.language.count}},u={excludeEncodingRuleMap:!0,orientation:"horizontal",groupby:{column:e.y,defaultBins:i,maxbinsSignalName:r["e"].YBins,maxbinsSignalDisplayName:t.specViewOptions.language.YMaxBins,maxbins:o},minBandWidth:s,showAxes:!0},c={excludeEncodingRuleMap:!0,orientation:"vertical",groupby:{column:e.x,defaultBins:i,maxbinsSignalName:r["e"].XBins,maxbinsSignalDisplayName:t.specViewOptions.language.XMaxBins,maxbins:o},minBandWidth:s,showAxes:!0},l={sort:e.sort};return{axisScales:a,customZScale:!0,layouts:[{layoutType:"Band",props:c},{layoutType:"Band",props:u},{layoutType:"Stack",props:l}],specCapabilities:{countsAndSums:!1,roles:[{role:"x",binnable:!0,axisSelection:e.x&&e.x.quantitative?"range":"exact",signals:[r["e"].XBins]},{role:"y",binnable:!0,axisSelection:e.y&&e.y.quantitative?"range":"exact",signals:[r["e"].YBins]},{role:"color",allowNone:!0},{role:"sort",allowNone:!0},{role:"facet",allowNone:!0,signals:[r["e"].FacetBins]},{role:"facetV",allowNone:!0,signals:[r["e"].FacetVBins]}]}}},O=function(t){const{specColumns:e}=t,n={sortOrder:"ascending",orientation:"vertical",size:e.size,sort:e.sort,z:e.z},i={z:{title:e.z&&e.z.name}},o=[];if(e.facet){i.y={title:null,aggregate:e.size?"sum":"count"};const t="globalAggregateMaxExtentScaledSignal",n="globalAggregateMaxExtentSignal",r={dock:"top",niceScale:!1,globalAggregateMaxExtentScaledSignal:t,globalAggregateMaxExtentSignal:n,sumBy:e.size,showAxes:!1};o.push({layoutType:"AggregateContainer",props:r})}return o.push({layoutType:"Strip",props:n}),{axisScales:i,layouts:o,specCapabilities:{countsAndSums:!1,roles:[{role:"size",allowNone:!0,excludeCategoric:!0},{role:"z",axisSelection:e.z&&e.z.quantitative?"range":"exact",allowNone:!0},{role:"color",allowNone:!0},{role:"sort",allowNone:!0},{role:"facet",allowNone:!0,signals:[r["e"].FacetBins]},{role:"facetV",allowNone:!0,signals:[r["e"].FacetVBins]}]}}},P=function(t){const{specColumns:e,specViewOptions:n}=t,i={corner:"top-left",group:e.group,size:e.size,treeMapMethod:n.language.treeMapMethod,z:e.z},o={z:{title:e.z&&e.z.name}},s=[];if(e.facet){o.y={title:null,aggregate:"sum"};const t="globalAggregateMaxExtentScaledSignal",n="globalAggregateMaxExtentSignal",r={dock:"top",niceScale:!1,globalAggregateMaxExtentScaledSignal:t,globalAggregateMaxExtentSignal:n,sumBy:e.size,showAxes:!1};s.push({layoutType:"AggregateContainer",props:r})}return s.push({layoutType:"Treemap",props:i}),{axisScales:o,layouts:s,specCapabilities:{countsAndSums:!1,roles:[{role:"size",excludeCategoric:!0},{role:"group",allowNone:!0},{role:"z",axisSelection:e.z&&e.z.quantitative?"range":"exact",allowNone:!0},{role:"color",allowNone:!0},{role:"facet",allowNone:!0,signals:[r["e"].FacetBins]},{role:"facetV",allowNone:!0,signals:[r["e"].FacetVBins]}],signals:[r["e"].TreeMapMethod]}}};function T(t,e,n,r){let i;const o=e,s={x:0,y:0};let a;switch(t){case"cross":{const t={axisTextColor:r,colRowTitles:!0,groupbyX:o,groupbyY:n};i={layoutType:"Cross",props:t},a={bottom:h,left:c,top:0},s.y=l,s.x=f;break}case"wrap":default:{const t={axisTextColor:r,cellTitles:!0,groupby:o};i={layoutType:"Wrap",props:t},a={bottom:h,left:c,top:l};break}}const u={facetPadding:a,plotPadding:s};return{layoutPair:i,facetLayout:u}}const L={barchart:E,barchartH:S,barchartV:E,density:A,grid:M,scatterplot:C,stacks:k,strips:O,treemap:P};function I(t){const{insight:e,specColumns:n,specViewOptions:s}=t,a=L[e.chart];if(a){const u=a(t);if(e.columns.facet){const t={column:n.facet,defaultBins:i,maxbins:o,maxbinsSignalDisplayName:s.language.FacetMaxBins,maxbinsSignalName:r["e"].FacetBins},a={column:n.facetV,defaultBins:i,maxbins:o,maxbinsSignalDisplayName:s.language.FacetVMaxBins,maxbinsSignalName:r["e"].FacetVBins},{facetLayout:c,layoutPair:l}=T(e.facetStyle,t,a,s.colors.axisText);u.layouts.unshift(l),u.facetLayout=c}return u}}var N=n("8645");function D(t,...e){t.axes||(t.axes=[]),t.axes.push(...e)}function R(t,...e){t.data||(t.data=[]),t.data.push(...e)}function F(t,...e){t.marks||(t.marks=[]),t.marks.push(...e)}function B(t,...e){t.scales||(t.scales=[]),t.scales.push(...e.filter(Boolean))}function j(t,...e){t.signals||(t.signals=[]),t.signals.push(...e)}function z(t,...e){t.transform||(t.transform=[]),t.transform.push(...e)}function U(t,e){for(let n=0;n<t.length;n++)if(t[n].name===e)return{data:t[n],index:n}}function $(t){const e=t.map(t=>t.groupby);return e.reduce((t,e)=>t.concat(e),[])}function V(...t){return t.filter(Boolean).join(" + ")}function q(t){const{axesOffsets:e,axisScales:n,axesScopes:r,axesTitlePadding:i,allGlobalScales:o,globalScope:s,labelBaseline:a,plotOffsetSignals:u,specColumns:c,specViewOptions:l}=t,{scope:h}=s;o.forEach(o=>{const{scales:s}=o;for(let f in s){let d=s[f];if(d){B(h,...d);let{showAxes:s}=o,p=void 0;if("z"===f&&(s=!1,"3d"===t.view&&l.zAxisOptions&&!t.faceted&&l.zAxisOptions.showZAxis&&(s=!0,p=l.zAxisOptions.zIndex)),s&&n){let t=n[f];if(t){const n=l.colors.axisLine,o="x"===f,s=c[f]||{quantitative:!0},h=t.title,g={title:h,horizontal:o,column:s,specViewOptions:l,lineColor:n,titlePadding:i[f],labelBaseline:a[f],zindex:p};if(r["main"].forEach(t=>D(t.scope,W(Object.assign(Object.assign({},g),{scale:t.scale||d[0],showTitle:t.title,showLabels:t.labels,showLines:t.lines})))),r[f]&&r[f].forEach(t=>D(t.scope,W(Object.assign(Object.assign({},g),{scale:t.scale||d[0],showTitle:t.title,showLabels:t.labels,showLines:t.lines})))),u[f]&&e[f]){const t=u[f];t.update=`${e[f]}`}}}}}})}function W(t){const{column:e,horizontal:n,labelBaseline:i,lineColor:o,scale:s,showLabels:a,showTitle:u,showLines:c,specViewOptions:l,title:h,titlePadding:f,zindex:g}=t,m=Object.assign(Object.assign(Object.assign(Object.assign({zindex:g,scale:s.name,orient:n?"bottom":"left",domain:c,ticks:c},c&&{domainColor:o,tickColor:o,tickSize:l.tickSize}),u&&{title:h,titleAlign:n?"left":"right",titleAngle:{signal:n?r["e"].TextAngleX:r["e"].TextAngleY},titleColor:l.colors.axisText,titleFontSize:{signal:r["e"].TextTitleSize},titleLimit:p,titlePadding:f}),{labels:a}),a&&{labelAlign:n?"left":"right",labelBaseline:i,labelAngle:{signal:n?r["e"].TextAngleX:r["e"].TextAngleY},labelColor:l.colors.axisText,labelFontSize:{signal:r["e"].TextSize},labelLimit:d});return e.quantitative&&(m.format="~r"),m}function G(t){return t.replace(".","\\.").replace("[","\\[").replace("]","\\]")}function H(t){return t.replace(/[.,:;+=\-/<>{}|~!@#$%^*[\]`'"()?\s\\]/g,"")}function X(t,e,n,r,i,o){const s={name:t,type:"linear",range:r,round:!0,reverse:i,domain:{data:e,field:G(n)},zero:o,nice:!0};return s}function Y(t,e,n,r,i){const o={name:t,type:"point",range:n,domain:{data:e,field:G(r),sort:!0},padding:.5};return void 0!==i&&(o.reverse=i),o}function Z(t,e,n,i,o){o=o||r["a"];const s={data:n,field:G(i)},a={scheme:o},u={signal:r["e"].ColorReverse};switch("continuous"!==e&&(a.count={signal:r["e"].ColorBinCount}),e){case"continuous":{const e={name:t,type:"linear",domain:s,range:a,reverse:u};return e}case"quantile":{const e={name:t,type:"quantile",domain:s,range:a,reverse:u};return e}default:{const e={name:t,type:"quantize",domain:s,range:a,reverse:u};return e}}}const K=.6;function J(t,e){const{specViewOptions:n}=t,i=[{name:r["e"].ZProportion,value:K,bind:{name:n.language.zScaleProportion,debounce:50,input:"range",min:.2,max:2,step:.1}},{name:r["e"].ZHeight,update:`${e} * ${r["e"].ZProportion}`},{name:r["e"].TextScale,value:1.2,bind:{name:n.language.textScaleSignal,debounce:50,input:"range",min:.5,max:2,step:.1}},{name:r["e"].TextSize,update:`${r["e"].TextScale} * 10`},{name:r["e"].TextTitleSize,update:`${r["e"].TextScale} * 15`},{name:r["e"].TextAngleX,value:30,bind:{name:n.language.xAxisTextAngleSignal,debounce:50,input:"range",min:0,max:90,step:1}},{name:r["e"].TextAngleY,value:0,bind:{name:n.language.yAxisTextAngleSignal,debounce:50,input:"range",min:-90,max:0,step:1}},{name:r["e"].MarkOpacity,value:1,bind:{name:n.language.markOpacitySignal,debounce:50,input:"range",min:.1,max:1,step:.05}}];return i}function Q(t){const{specViewOptions:e}=t,n={name:r["e"].ColorBinCount,value:7,bind:{name:e.language.colorBinCount,input:"range",min:1,max:e.maxLegends+1,step:1}};return n}function tt(t){const{specViewOptions:e}=t,n={name:r["e"].ColorReverse,value:!1,bind:{name:e.language.colorReverse,input:"checkbox"}};return n}function et(t,e,n){t.update=`${e}((${t.update}), (${n}))`}function nt(t,e){const n={orient:"none",title:t.name,fill:e,encode:{symbols:{update:{shape:{value:"square"}}}}};return t.quantitative&&(n.type="symbol",n.format="~r"),n}function rt(t,e){const{specColumns:n,insight:r}=t;if(n.color&&!r.hideLegend&&!r.directColor&&!n.color.isColorData)return[nt(n.color,e)]}function it(t,e,n,i,o,s,a){const u=[{name:o,source:n,transform:[{type:"aggregate",groupby:[G(t.name)]},{type:"window",ops:["count"],as:[a]},{type:"filter",expr:`datum[${JSON.stringify(a)}] <= ${e}`}]},{name:i,source:n,transform:[{type:"lookup",from:o,key:G(t.name),fields:[t.name].map(G),values:[t.name].map(G),as:[s]},{type:"formula",expr:`datum[${JSON.stringify(s)}] == null ? '${r["c"]}' : datum[${JSON.stringify(s)}]`,as:s}]}];return u}function ot(t){const{colorReverseSignalName:e,dataName:n,scope:i,legendDataName:o,scaleName:s,specContext:a,topLookupName:u}=t;let c=n;const{insight:l,specColumns:h,specViewOptions:f}=a,d=rt(a,s);d&&(i.legends=d);const p=h.color&&!h.color.quantitative;return p&&(R(i,...it(h.color,f.maxLegends,n,o,u,r["b"].TopColor,r["b"].TopIndex)),c=o),!h.color||h.color.isColorData||l.directColor||(h.color.quantitative?B(i,Z(s,l.colorBin,n,h.color.name,l.scheme)):B(i,{name:s,type:"ordinal",domain:{data:c,field:r["b"].TopColor,sort:!0},range:{scheme:l.scheme||r["a"]},reverse:{signal:e}})),j(i,Q(a),tt(a)),{topColorField:r["b"].TopColor,colorDataName:c}}function st(t,e,n,i,o){const s=`parent[${JSON.stringify(r["b"].FacetTitle)}]`,a=`datum[${JSON.stringify(r["b"].Ordinal)}] - 1`,u=lt(e.dataName,i,a),c=ct(n.dataName,i,a);F(t,u.header,c.footer),F(u.header,{type:"text",encode:{enter:{align:{value:"center"},baseline:{value:"middle"},fill:{value:o}},update:{metaData:{signal:`{search: parent[${JSON.stringify(r["b"].FacetSearch)}]}`},x:{signal:`${i.layoutWidth} / 2`},limit:{signal:i.layoutWidth},fontSize:{signal:r["e"].TextSize},text:{signal:s}}}}),F(c.footer,{type:"text",encode:{enter:{align:{value:"left"},baseline:{value:"middle"},fill:{value:o}},update:{metaData:{signal:`{search: parent[${JSON.stringify(r["b"].FacetSearch)}]}`},y:{signal:`${i.layoutHeight} / 2`},limit:{signal:r["e"].PlotOffsetRight},fontSize:{signal:r["e"].TextSize},text:{signal:s}}}})}function at(t,e,n){F(t,{type:"text",encode:{enter:{align:{value:"center"},baseline:{value:"bottom"},fill:{value:n}},update:{metaData:{signal:`{search: parent[${JSON.stringify(r["b"].FacetSearch)}]}`},x:{signal:`(${e.layoutWidth}) / 2`},text:{signal:`parent[${JSON.stringify(r["b"].FacetTitle)}]`},fontSize:{signal:r["e"].TextSize},limit:{signal:e.layoutWidth},y:{signal:`-${r["e"].FacetPaddingTop} / 2`}}}})}function ut(t){const{colSeqName:e,colTitleScale:n,globalScope:r,facetScope:i,plotScope:o,rowSeqName:s,rowTitleScale:a}=t,{sizeSignals:u}=i,c=ht(e,u.colCount),l=ht(s,u.rowCount),h="datum.data",f=lt(e,u,h),d=ct(s,u,h);R(r,c,l),F(r,f.footer,d.header),B(r,n,a);const p={main:[{scope:i.facetScope,lines:!0,labels:!1,title:!1}],x:[{scope:f.footer,lines:!0,labels:!0,title:!1},{scope:o,scale:n,lines:!1,labels:!1,title:!0}],y:[{scope:d.header,lines:!0,labels:!0,title:!1},{scope:o,scale:a,lines:!1,labels:!1,title:!0}]};return p}function ct(t,e,n){const i=i=>{return{type:"group",from:{data:t},encode:{update:{x:{signal:i},y:{signal:`${r["e"].PlotOffsetTop} + ${r["e"].FacetPaddingTop} + (${n}) * (${e.layoutHeight} + ${r["e"].FacetPaddingTop} + ${r["e"].FacetPaddingBottom})`},height:{signal:e.layoutHeight}}}}},o=i(r["e"].PlotOffsetLeft),s=i(`${r["e"].PlotOffsetLeft} + ${r["e"].PlotWidthOut} + ${r["e"].PlotOffsetRight} / 2`);return{header:o,footer:s}}function lt(t,e,n){const i=i=>{return{type:"group",from:{data:t},encode:{update:{x:{signal:`(${n}) * (${e.layoutWidth} + ${r["e"].FacetPaddingLeft}) + ${r["e"].FacetPaddingLeft} + ${r["e"].PlotOffsetLeft}`},y:{signal:i},width:{signal:e.layoutWidth}}}}},o=i(`${r["e"].PlotOffsetTop} / 2`),s=i(`${r["e"].PlotOffsetTop} + ${r["e"].PlotHeightOut}`);return{header:o,footer:s}}function ht(t,e){return{name:t,transform:[{type:"sequence",start:0,stop:{signal:e}}]}}function ft(t,e,n){const{specColumns:r,insight:i,specViewOptions:o}=t,s=r.color;return s?s.isColorData||i.directColor?{field:G(s.name)}:{scale:n,field:s.quantitative?G(s.name):e}:{value:o.colors.defaultCube}}function dt(t){const e={signal:r["e"].MarkOpacity};return e}class pt{constructor(t){const{dataName:e,markGroup:n,scope:i,signals:o}=t;this.scope=i,this._markGroup=n,this.signals=o,this.data=U(i.data,e).data,this._markDataName=e,this.offsets={x:"0",y:"0",h:r["e"].PlotHeightIn,w:r["e"].PlotWidthIn},this.sizeSignals={layoutHeight:r["e"].PlotHeightIn,layoutWidth:r["e"].PlotWidthIn},this.zSize=r["e"].PlotHeightIn}get markDataName(){return this._markDataName}setMarkDataName(t){this._markDataName=t}get markGroup(){return this._markGroup}setMarkGroup(t){this._markGroup=t}}class gt{constructor(t){this.props=t,this.id=t.id}getGrouping(){return null}getAggregateSumOp(){return null}build(){throw"Not implemented"}}function mt(){return`datum.${r["b"].Collapsed}`}class yt extends gt{constructor(t){super(t),this.props=t;const e=this.aggregation=this.getAggregation(),n=this.prefix=`agg_${this.id}`;this.names={barCount:`${n}_count`,aggregateField:`${n}_aggregate_value`,globalAggregateExtentSignal:`${n}_${e}_extent`,scale:`scale_${n}`,extentData:`data_${n}_extent`,offsets:`data_${n}_offsets`}}getAggregateSumOp(){if("sum"===this.aggregation){const t={field:G(this.props.sumBy.name),op:"sum",as:r["b"].Sum};return t}}build(){const{aggregation:t,names:e,props:n}=this,{dock:r,globalScope:i,groupings:o,niceScale:s,parentScope:a,showAxes:u}=n;z(i.data,Object.assign(Object.assign({},this.getTransforms(t,$(o))),{as:[e.aggregateField]}),{type:"extent",field:G(e.aggregateField),signal:e.globalAggregateExtentSignal}),j(i.scope,{name:n.globalAggregateMaxExtentSignal,update:`${e.globalAggregateExtentSignal}[1]`});const c="left"===r,l=`scale(${JSON.stringify(e.scale)}, datum[${JSON.stringify(e.aggregateField)}])`,h={x:a.offsets.x,y:V(a.offsets.y,"bottom"===r?l:""),h:c?a.offsets.h:"top"===r?l:`${a.offsets.h} - ${l}`,w:c?l:a.offsets.w},f={type:"linear",name:e.scale,domain:[0,{signal:n.globalAggregateMaxExtentSignal}],range:c?[0,{signal:a.sizeSignals.layoutWidth}]:[{signal:a.sizeSignals.layoutHeight},0],nice:s,zero:!0,reverse:"top"===r},d=`scale(${JSON.stringify(e.scale)}, ${n.globalAggregateMaxExtentSignal})`;return j(i.scope,{name:n.globalAggregateMaxExtentScaledSignal,update:"bottom"===r?`${a.sizeSignals.layoutHeight} - ${d}`:d}),{offsets:h,sizeSignals:c?{layoutHeight:a.sizeSignals.layoutHeight,layoutWidth:null}:{layoutHeight:null,layoutWidth:a.sizeSignals.layoutWidth},globalScales:{showAxes:u,scales:{x:c?[f]:void 0,y:c?void 0:[f]}},encodingRuleMap:c?{x:[{test:mt(),signal:a.offsets.x}],width:[{test:mt(),value:0}]}:{y:[{test:mt(),signal:"top"===r?a.offsets.y:V(a.offsets.y,a.offsets.h)}],height:[{test:mt(),value:0}]}}}getTransforms(t,e){const n={type:"joinaggregate",groupby:e.map(G),ops:[t]};return"sum"===t&&(n.fields=[this.props.sumBy.name].map(G)),n}getAggregation(){const{props:t}=this;let e;switch(e="left"===t.dock?t.axesScales.x:t.axesScales.y,e.aggregate){case"sum":return"sum";default:return"count"}}}class vt extends gt{constructor(t){super(t),this.props=t;const e=this.props.aggregation,n=this.prefix=`agg_${this.id}`;this.names={barCount:`${n}_count`,aggregateField:`${n}_aggregate_value`,globalAggregateExtentSignal:`${n}_${e}_extent`,extentData:`data_${n}_extent`}}build(){const{names:t,props:e}=this,{aggregation:n,globalScope:r,groupings:i,onBuild:o,parentScope:s}=e,{sizeSignals:a}=s;z(r.data,Object.assign(Object.assign({},this.getTransforms(n,$(i))),{as:[t.aggregateField]}),{type:"extent",field:G(t.aggregateField),signal:t.globalAggregateExtentSignal});const u=`datum[${JSON.stringify(t.aggregateField)}]`,c=`min((${a.layoutHeight}), (${a.layoutWidth}))`,l=`(${[c,c].join(" * ")})`,h=`((${u}) / (${t.globalAggregateExtentSignal}[1]))`,f=`(${[l,h].join(" * ")})`,d=`sqrt(${f})`,p=d;o&&o(u,p);const g={x:V(s.offsets.x,`(${s.offsets.w} - ${d}) / 2`),y:V(s.offsets.y,`(${s.offsets.h} - ${d}) / 2`),h:d,w:d};return{offsets:g,sizeSignals:{layoutHeight:null,layoutWidth:null},encodingRuleMap:{y:[{test:mt(),signal:g.y}],height:[{test:mt(),value:0}]}}}getTransforms(t,e){const n={type:"joinaggregate",groupby:e.map(G),ops:[t]};return"sum"===t&&(n.fields=[this.props.sumBy.name].map(G)),n}}function bt(t,e,n){const{column:i,defaultBins:o,maxbins:s,maxbinsSignalDisplayName:a,maxbinsSignalName:u}=n;if(i.quantitative){const c=`${t}_bin_${H(i.name)}`,l=`${c}_end`,h=`${c}_bins`,f=`${c}_bin_extent`;e=`${c}_sequence`;const d={type:"extent",field:G(i.name),signal:f},p={name:u,value:o,bind:{name:a,debounce:50,input:"range",min:1,max:s,step:1}},g={type:"bin",field:G(i.name),as:[c,l],signal:h,extent:{signal:`[${f}[0], ${f}[1] + 1e-11]`},maxbins:{signal:u}},m={name:e,transform:[{type:"sequence",start:{signal:`${h}.start`},stop:{signal:`${h}.stop`},step:{signal:`${h}.step`}},{type:"formula",expr:"datum.data",as:c},{type:"formula",expr:`datum.data + ${h}.step`,as:l},{type:"window",ops:["row_number"],as:[r["b"].Ordinal]},{type:"formula",expr:`datum.data === ${h}.start`,as:r["b"].First},{type:"formula",expr:`datum.data === ${h}.stop - ${h}.step`,as:r["b"].Last}]},y={discreteColumn:n,native:!1,transforms:[d,g],fields:[c,l],binSignal:h,dataSequence:m,domainDataName:e,signals:[p],fullScaleDataname:m.name};return y}{const t={discreteColumn:n,native:!0,fields:[i.name],domainDataName:e,fullScaleDataname:e};return t}}class _t extends gt{constructor(t){super(t),this.props=t;const e=this.prefix=`band_${this.id}`;this.names={xScale:`scale_${e}_x`,yScale:`scale_${e}_y`,bandWidth:`${e}_bandwidth`,accumulative:`${e}_accumulative`},this.bin=bt(this.prefix,t.globalScope.data.name,t.groupby)}getGrouping(){return this.bin.fields}build(){const{bin:t,names:e,props:n}=this,{globalScope:r,minBandWidth:i,orientation:o,parentScope:s,showAxes:a}=n,u=t.fields[0];!1===t.native&&(j(r.scope,...t.signals),z(r.data,...t.transforms),R(r.scope,t.dataSequence)),R(r.scope,{name:e.accumulative,source:t.fullScaleDataname,transform:[{type:"aggregate",groupby:this.getGrouping().map(G),ops:["count"]}]});const c="horizontal"===o,l=c?r.signals.minCellHeight:r.signals.minCellWidth;et(l,"max",`length(data(${JSON.stringify(e.accumulative)})) * ${i}`),j(r.scope,{name:e.bandWidth,update:`bandwidth(${JSON.stringify(c?e.yScale:e.xScale)})`});const h=this.getScales(t,c);let f;return n.excludeEncodingRuleMap||(f=c?{x:[{test:mt(),value:s.offsets.x}],width:[{test:mt(),value:0}]}:{y:[{test:mt(),signal:V(s.offsets.y,s.offsets.h)}],height:[{test:mt(),value:0}]}),{offsets:this.getOffset(c,u),sizeSignals:c?{layoutHeight:e.bandWidth,layoutWidth:s.sizeSignals.layoutWidth}:{layoutHeight:s.sizeSignals.layoutHeight,layoutWidth:e.bandWidth},globalScales:{showAxes:a,scales:{x:c?void 0:h,y:c?h:void 0}},encodingRuleMap:f}}getOffset(t,e){const{names:n,props:r}=this,{parentScope:i}=r;return{x:V(i.offsets.x,t?"":`scale(${JSON.stringify(n.xScale)}, datum[${JSON.stringify(e)}])`),y:V(i.offsets.y,t?`scale(${JSON.stringify(n.yScale)}, datum[${JSON.stringify(e)}])`:""),h:t?n.bandWidth:i.offsets.h,w:t?i.offsets.w:n.bandWidth}}getScales(t,e){const{names:n}=this,{parentScope:r}=this.props,i=G(t.fields[0]),o=[];let s;return s=e?{type:"band",name:n.yScale,range:[0,{signal:r.sizeSignals.layoutHeight}],padding:.1,domain:{data:t.domainDataName,field:i,sort:!0},reverse:!0}:{type:"band",name:n.xScale,range:[0,{signal:r.sizeSignals.layoutWidth}],padding:.1,domain:{data:t.domainDataName,field:i,sort:!0}},o.push(s),o}}function wt(t){const e=e=>`datum[${JSON.stringify(t.fields[e])}]`;return t.discreteColumn.column.quantitative?`format(${e(0)}, '~r') + ' - ' + format(${e(1)}, '~r')`:e(0)}function xt(t,e){return e&&(t=[e,...t]),`{${t.join()}}`}function St(t,e,n,r){if(t.discreteColumn.column.quantitative){const i=[`name:${JSON.stringify(t.discreteColumn.column.name)}`,"operator:'>='",`value:datum[${JSON.stringify(t.fields[0])}]`],o=["clause:'&&'",`name:${JSON.stringify(t.discreteColumn.column.name)}`,"operator:'<'",`value:datum[${JSON.stringify(t.fields[1])}]`];return xt([`expressions:[ datum[${JSON.stringify(e)}] ? null : ${xt(i)}, datum[${JSON.stringify(n)}] ? null : ${xt(o)}]`],r)}{const e=[`name:${JSON.stringify(t.discreteColumn.column.name)}`,"operator:'=='",`value:datum[${JSON.stringify(t.fields[0])}]`];return xt([`expressions:[${xt(e)}]`],r)}}function Et(t,e,n,i){const o=n.map(G),s=`${e}_bin_order`,a={name:s,source:t,transform:[{type:"aggregate",groupby:o},{type:"collect",sort:{field:o,order:o.map(t=>i)}},{type:"window",ops:["row_number"],as:[r["b"].Ordinal]}]};return{data:a,scale:At(s,`scale_${e}_order`,n)}}function At(t,e,n){return{type:"ordinal",name:e,domain:{data:t,field:G(n[0])},range:{data:t,field:r["b"].Ordinal}}}class Mt extends gt{constructor(t){super(t),this.props=t;const e=this.prefix=`cross_${this.id}`;this.binX=bt(`${e}_x`,t.globalScope.data.name,t.groupbyX),this.binY=bt(`${e}_y`,t.globalScope.data.name,t.groupbyY),this.names={facetDataName:`data_${e}_facet`,searchUnion:`data_${e}_search`,dimScale:`scale_${e}`,dimCount:`${e}_count`,dimCategorical:`data_${e}_cat`,dimCellSize:`${e}_cell_size`,dimCellSizeCalc:`${e}_cell_calc`}}getGrouping(){return this.binX.fields.concat(this.binY.fields)}build(){const{binX:t,binY:e,names:n,prefix:i,props:o}=this,{axisTextColor:s,colRowTitles:a,globalScope:u,parentScope:c}=o,l={x:{dataName:null,quantitative:null},y:{dataName:null,quantitative:null}},h={dim:"x",bin:t,sortOrder:"ascending",size:c.sizeSignals.layoutWidth,layout:c.sizeSignals.layoutWidth,min:u.signals.minCellWidth.name,out:u.signals.plotWidthOut,offset:r["e"].FacetPaddingLeft,padding:r["e"].FacetPaddingLeft,dataOut:null,scaleName:null,position:null},f={dim:"y",bin:e,sortOrder:"ascending",size:c.sizeSignals.layoutHeight,layout:c.sizeSignals.layoutHeight,min:u.signals.minCellHeight.name,out:u.signals.plotHeightOut,offset:r["e"].FacetPaddingTop,padding:`(${r["e"].FacetPaddingTop} + ${r["e"].FacetPaddingBottom})`,dataOut:null,scaleName:null,position:null},d=[h,f];d.forEach(t=>{const{bin:e,dim:o,padding:s,sortOrder:a}=t;let c,h,f,d;const p=l[o];if(!1===e.native)j(u.scope,...e.signals),z(u.data,...e.transforms),R(u.scope,e.dataSequence),z(e.dataSequence,{type:"formula",expr:`indata(${JSON.stringify(u.markDataName)}, ${JSON.stringify(e.fields[0])}, datum[${JSON.stringify(e.fields[0])}])`,as:r["b"].Contains}),c=e.dataSequence,h=e.dataSequence.name,f=`length(data(${JSON.stringify(h)}))`,d=At(h,`${n.dimScale}_${o}`,e.fields),p.dataName=e.dataSequence.name;else{h=u.markDataName;const t=Et(h,`${i}_${o}`,e.fields,a);c=t.data,R(u.scope,t.data),f=`length(data(${JSON.stringify(t.data.name)}))`,d=t.scale,p.dataName=t.data.name}p.quantitative=e.discreteColumn.column.quantitative,t.dataOut=c,t.scaleName=d.name,z(c,{type:"formula",expr:St(e,r["b"].First,r["b"].Last),as:r["b"].FacetSearch},{type:"formula",expr:wt(e),as:r["b"].FacetTitle}),B(u.scope,d);const g=`${n.dimCount}_${o}`,m=`${n.dimCellSizeCalc}_${o}`,y=`${n.dimCellSize}_${o}`;j(u.scope,{name:g,update:f}),j(u.scope,{name:m,update:`${t.layout} / ${g}`},{name:y,update:`max(${t.min}, (${m} - ${s}))`}),et(t.out,"max",`((${y} + ${s}) * ${g})`),t.position=this.dimensionOffset(t)});const p={type:"group",encode:{update:{y:{signal:f.position}}},from:{data:f.dataOut.name},data:[{name:n.searchUnion,source:h.dataOut.name,transform:[{type:"formula",expr:`[datum[${JSON.stringify(r["b"].FacetSearch)}], merge(parent[${JSON.stringify(r["b"].FacetSearch)}], { clause: '&&'})]`,as:r["b"].FacetSearch}]}]},g={style:"cell",name:i,type:"group",encode:{update:{height:{signal:`${n.dimCellSize}_y`},width:{signal:`${n.dimCellSize}_x`},x:{signal:h.position}}},from:{data:n.searchUnion}};F(u.markGroup,p),F(p,g);const m={x:this.dimensionOffset(h),y:this.dimensionOffset(f),h:`${n.dimCellSize}_y`,w:`${n.dimCellSize}_x`},y={layoutHeight:`${n.dimCellSize}_y`,layoutWidth:`${n.dimCellSize}_x`,colCount:`${n.dimCount}_x`,rowCount:`${n.dimCount}_y`};return a&&st(u.scope,l.x,l.y,y,s),{facetScope:g,offsets:m,sizeSignals:y,titles:l}}dimensionOffset(t){const{names:e}=this;return`${t.offset} + (scale(${JSON.stringify(t.scaleName)}, datum[${JSON.stringify(t.bin.fields[0])}]) - 1) * (${e.dimCellSize}_${t.dim} + ${t.padding})`}}class Ct extends gt{constructor(t){super(t),this.props=t;const e=this.prefix=`scatter_${this.id}`;this.names={aggregateData:`data_${e}_aggregate`,markData:`data_${e}_mark`,sizeExtent:`${e}_sizeExtent`,sizeRange:`${e}_sizeRange`,sizeScale:`${e}_sizeScale`,xScale:`scale_${e}_x`,yScale:`scale_${e}_y`,zScale:`scale_${e}_z`}}build(){const{names:t,prefix:e,props:n}=this,{globalScope:i,parentScope:o,scatterPointScaleDisplay:s,size:a,x:u,y:c,z:l,zGrounded:h}=n,f=a&&a.quantitative&&a;j(i.scope,{name:r["e"].PointScale,value:5,bind:{name:s,debounce:50,input:"range",min:1,max:10,step:1}},{name:r["e"].ZGrounded,value:!1,bind:{name:h,input:"checkbox"}}),f&&(z(i.data,{type:"extent",field:G(f.name),signal:t.sizeExtent}),B(i.scope,{name:t.sizeScale,type:"linear",domain:[0,{signal:`${t.sizeExtent}[1]`}],range:[0,{signal:t.sizeRange}]}),j(i.scope,{name:t.sizeRange,update:`min(${o.sizeSignals.layoutHeight}, ${o.sizeSignals.layoutWidth}) / ${w}`})),R(i.scope,{name:t.markData,source:i.markDataName,transform:[u,c,l].map(t=>{if(!t||!t.quantitative)return;const e={type:"filter",expr:`isValid(datum[${JSON.stringify(t.name)}])`};return e}).filter(Boolean)}),i.setMarkDataName(t.markData);const d={showAxes:!0,scales:{}},p=l?`scale(${JSON.stringify(t.zScale)}, datum[${JSON.stringify(l.name)}])`:null,g=f?`scale(${JSON.stringify(t.sizeScale)}, datum[${JSON.stringify(f.name)}]) * ${r["e"].PointScale}`:r["e"].PointScale,m=Object.assign({height:[{test:mt(),value:0},{signal:g}],width:{signal:g}},l&&{z:[{test:mt(),value:0},{signal:`${r["e"].ZGrounded} ? 0 : ${p}`}],depth:[{test:mt(),value:0},{signal:`${r["e"].ZGrounded} ? ${p} : ${g}`}]}),y=[{column:u,xyz:"x",scaleName:t.xScale,reverse:!1,signal:o.sizeSignals.layoutWidth},{column:c,xyz:"y",scaleName:t.yScale,reverse:!0,signal:o.sizeSignals.layoutHeight},{column:l,xyz:"z",scaleName:t.zScale,reverse:!1,signal:`(${i.zSize}) * ${r["e"].ZProportion}`}];y.forEach(t=>{const{column:e,reverse:n,scaleName:r,signal:o,xyz:s}=t;if(!e)return;let a;a=e.quantitative?X(r,i.data.name,e.name,[0,{signal:o}],n,!1):Y(r,i.data.name,[0,{signal:o}],e.name,n),d.scales[s]=[a]});const v={name:e,type:"rect",from:{data:i.markDataName},encode:{update:m}};return F(i.markGroup,v),{offsets:{x:V(o.offsets.x,`scale(${JSON.stringify(t.xScale)}, datum[${JSON.stringify(u.name)}])`),y:V(o.offsets.y,`scale(${JSON.stringify(t.yScale)}, datum[${JSON.stringify(c.name)}]) - ${g}`),h:g,w:g},sizeSignals:{layoutHeight:null,layoutWidth:null},globalScales:d,mark:v,encodingRuleMap:{y:[{test:mt(),signal:V(o.offsets.y,o.sizeSignals.layoutHeight)}]}}}}function kt(t,e,n,i){if(t){const o=[0,{signal:`(${e}) * ${r["e"].ZProportion}`}],s=t.quantitative?X(i,n,t.name,o,!1,!0):Y(i,n,o,t.name,!1);return s}}class Ot extends gt{constructor(t){super(t),this.props=t;const e=this.prefix=`square_${this.id}`;this.names={bandWidth:this.getBandWidth(),maxGroupField:`${e}_max_group`,maxGroupSignal:`${e}_max_grouping`,stack0:`${e}_stack0`,stack1:`${e}_stack1`,zScale:`scale_${e}_z`}}build(){const{names:t,prefix:e,props:n}=this,{fillDirection:r,globalScope:i,groupings:o,parentScope:s,collapseYHeight:a,sortBy:u,z:c}=n,l=kt(c,i.zSize,i.data.name,t.zScale);z(i.data,Object.assign({type:"stack",groupby:$(o).map(G),as:[t.stack0,t.stack1]},u&&{sort:{field:G(u.name),order:"ascending"}}));const{gap:h,levelSize:f,size:d,squaresPerBand:p}=this.addSignals(),g={signal:"down-right"===r?d:f},m={name:e,type:"rect",from:{data:i.markDataName},encode:{update:Object.assign({height:a?[{test:mt(),value:0},g]:g,width:{signal:"down-right"===r?f:d}},c&&{z:{value:0},depth:[{test:mt(),value:0},{scale:t.zScale,field:G(c.name)}]})}};F(i.markGroup,m);const{tx:y,ty:v}=this.transformXY(h,f,p);return Object.assign(Object.assign(Object.assign({},c&&{globalScales:{showAxes:!0,scales:{z:[l]}}}),{offsets:{x:V(s.offsets.x,y.expr),y:V(s.offsets.y,v.expr),h:d,w:d},mark:m,sizeSignals:{layoutHeight:d,layoutWidth:d}}),a&&{encodingRuleMap:{y:[{test:mt(),value:s.offsets.y}]}})}getBandWidth(){const{offsets:t}=this.props.parentScope;switch(this.props.fillDirection){case"down-right":return t.h;default:return t.w}}addSignals(){const{names:t,props:e}=this,{fillDirection:n,globalScope:r,groupings:i,parentScope:o}=e;let{maxGroupedFillSize:s,maxGroupedUnits:a}=e;a||(i?(z(r.data,{type:"joinaggregate",groupby:$(i).map(G),ops:["count"],as:[t.maxGroupField]},{type:"extent",field:t.maxGroupField,signal:t.maxGroupSignal}),a=`(${t.maxGroupSignal}[1])`):a=`length(data(${JSON.stringify(r.data.name)}))`),s||(s="down-right"===n?o.offsets.w:o.offsets.h);const u=`((${t.bandWidth}) / (${s}))`,c=`ceil(sqrt(${a} * ${u}))`,l=`min(0.1 * ((${t.bandWidth}) / (${c} - 1)), 1)`,h=`(((${t.bandWidth}) / ${c}) - ${l})`,f=`ceil(${a} / ${c})`,d=`(((${s}) / ${f}) - ${l})`;return{gap:l,levelSize:d,size:h,squaresPerBand:c}}transformXY(t,e,n){const{names:i,prefix:o}=this,s=`(${i.bandWidth}) / ${n} * ((datum[${JSON.stringify(i.stack0)}]) % ${n})`,a=`floor((datum[${JSON.stringify(i.stack0)}]) / ${n})`,{fillDirection:u,parentScope:c}=this.props,l={type:"formula",expr:null,as:`${o}_${r["b"].OffsetX}`},h={type:"formula",expr:null,as:`${o}_${r["b"].OffsetY}`};switch(u){case"down-right":l.expr=`${a} * (${e} + ${t})`,h.expr=s;break;case"right-up":l.expr=s,h.expr=`${c.offsets.h} - ${e} - ${a} * (${e} + ${t})`;break;case"right-down":default:l.expr=s,h.expr=`${a} * (${e} + ${t})`;break}return{tx:l,ty:h}}}class Pt extends gt{constructor(t){super(t),this.props=t;const e=this.prefix=`stack_${this.id}`;this.names={cube:`${e}_cube`,globalDataName:`data_${e}_count`,globalExtent:`${e}_global_extent`,levelDataName:`data_${e}_level`,count:`${e}_count`,stack0:`${e}_stack0`,stack1:`${e}_stack1`,sequence:`data_${e}_sequence`,sides:`${e}_sides`,size:`${e}_size`,squared:`${e}_squared`,maxCount:`${e}_maxCount`,maxLevels:`${e}_maxLevels`,zScale:`${e}_zScale`}}build(){const{names:t,props:e}=this,{globalScope:n,groupings:r,parentScope:i,sort:o}=e,{sizeSignals:s}=i;z(n.data,{type:"joinaggregate",groupby:$(r).map(G),ops:["count"],as:[t.count]},{type:"extent",field:t.count,signal:t.globalExtent},Object.assign({type:"stack",groupby:$(r).map(G),as:[t.stack0,t.stack1]},o&&{sort:{field:G(o.name),order:"ascending"}})),R(n.scope,{name:t.sequence,transform:[{type:"sequence",start:1,stop:{signal:`sqrt(${t.globalExtent}[1])`}},{type:"formula",expr:"datum.data * datum.data",as:"squared"},{type:"formula",expr:`ceil(${t.globalExtent}[1] / datum.squared)`,as:"maxlevels"},{type:"formula",expr:`(${t.size} - (datum.data - 1) * datum.data) / datum.data`,as:"side"},{type:"formula",expr:"datum.side * datum.maxlevels + datum.maxlevels - 1",as:"sidecubeheight"},{type:"formula",expr:`abs(${n.zSize} - datum.sidecubeheight)`,as:"heightmatch"},{type:"collect",sort:{field:"heightmatch",order:"ascending"}},{type:"window",ops:["row_number"]},{type:"filter",expr:"datum.row_number === 1"}]}),j(n.scope,{name:t.size,update:`min((${s.layoutHeight}), (${s.layoutWidth}))`},{name:t.squared,update:`data('${t.sequence}')[0].squared`},{name:t.sides,update:`sqrt(${t.squared})`},{name:t.cube,update:`(${t.size} - (${t.sides} - 1)) / ${t.sides}`},{name:t.maxLevels,update:`data('${t.sequence}')[0].maxlevels`},{name:t.maxCount,update:`${t.maxLevels} * ${t.squared}`});const a=`floor(datum[${JSON.stringify(t.stack0)}] / ${t.squared})`,u=`(datum[${JSON.stringify(t.stack0)}] % ${t.squared})`,c=`(${u} % ${t.sides})`,l=`floor(${u} / ${t.sides})`,h=`(${s.layoutWidth} - ${t.size}) / 2`,f=`(${s.layoutHeight} - ${t.size}) / 2`,d={x:V(i.offsets.x,h,`${c} * (${t.cube} + 1)`),y:V(i.offsets.y,f,`${l} * (${t.cube} + 1)`),h:t.size,w:t.size},p={type:"rect",from:{data:this.names.levelDataName},encode:{update:{z:{signal:`${a} * (${t.cube} + 1)`},height:{signal:t.cube},width:{signal:t.cube},depth:{signal:t.cube}}}};F(n.markGroup,p);const g={type:"linear",name:t.zScale,domain:[0,{signal:t.maxCount}],range:[0,{signal:`${t.maxLevels} * (${t.cube} + 1) - 1`}],nice:!1};return{offsets:d,mark:p,sizeSignals:{layoutHeight:t.size,layoutWidth:t.size},globalScales:{showAxes:!0,scales:{z:[g]}},encodingRuleMap:{y:[{test:mt(),signal:i.offsets.y}],z:[{test:mt(),value:0}],depth:[{test:mt(),value:0}],height:[{test:mt(),value:0}]}}}}class Tt extends gt{constructor(t){super(t),this.props=t;const e=this.prefix=`strip_${this.id}`;this.names={firstField:`${e}${r["b"].First}`,lastField:`${e}${r["b"].Last}`,valueField:`${e}${r["b"].Value}`,scale:`scale_${e}`,zScale:`scale_${e}_z`}}build(){const{names:t,prefix:e,props:n}=this,{addPercentageScale:r,globalScope:i,groupings:o,orientation:s,size:a,sort:u,sortOrder:c,parentScope:l,z:h}=n,f=kt(h,i.zSize,i.data.name,t.zScale),d="horizontal"===s,p=[];let g;u&&p.push({type:"collect",sort:{field:G(u.name),order:c}}),a?(g=a.name,p.push({type:"filter",expr:`datum[${JSON.stringify(a.name)}] > 0`})):(g=t.valueField,p.push({type:"formula",expr:"1",as:g}));const m={type:"stack",field:G(g),offset:"normalize",as:[t.firstField,t.lastField]};o.length&&(m.groupby=$(o).map(G)),p.push(m),z(i.data,...p);const y=[t.lastField,t.firstField].map(t=>`datum[${JSON.stringify(t)}]`).join(" - "),v={x:V(l.offsets.x,d?`datum[${JSON.stringify(t.firstField)}] * (${l.offsets.w})`:""),y:V(l.offsets.y,d?"":`datum[${JSON.stringify(t.firstField)}] * (${l.offsets.h})`),h:d?l.offsets.h:`(${y}) * (${l.offsets.h})`,w:d?`(${y}) * (${l.offsets.w})`:l.offsets.w},b={name:e,type:"rect",from:{data:i.markDataName},encode:{update:Object.assign({height:{signal:v.h},width:{signal:v.w}},h&&{z:{value:0},depth:[{test:mt(),value:0},{scale:t.zScale,field:G(h.name)}]})}};let _;return F(i.markGroup,b),r&&(_=[{type:"linear",name:t.scale,domain:[0,100],range:d?[0,{signal:l.sizeSignals.layoutWidth}]:[{signal:l.sizeSignals.layoutHeight},0]}]),{globalScales:{showAxes:!0,scales:{x:d?_:void 0,y:d?void 0:_,z:f&&[f]}},offsets:v,sizeSignals:{layoutHeight:null,layoutWidth:null},mark:b}}}class Lt extends gt{constructor(t){super(t),this.props=t;const e=this.prefix=`treemap_${this.id}`;this.names={dataName:`data_${e}`,dataHeightWidth:`data_${e}_hw`,dataExtents:`data_${e}_extents`,dataFacet:`data_${e}_facet`,dataFacetMark:`data_${e}_facetMark`,fieldChildren:`${e}_children`,fieldDepth:`${e}_depth`,fieldX0:`${e}_x0`,fieldX1:`${e}_x1`,fieldY0:`${e}_y0`,fieldY1:`${e}_y1`,fieldHeight:`${e}_h`,fieldWidth:`${e}_w`,heightExtent:`${e}_heightExtent`,widthExtent:`${e}_widthExtent`,zScale:`scale_${e}_z`}}build(){const{names:t,props:e}=this,{globalScope:n,parentScope:i,treeMapMethod:o,z:s}=e,a=kt(s,n.zSize,n.data.name,t.zScale),u={x:V(i.offsets.x,It(t.fieldX0)),y:V(i.offsets.y,It(t.fieldY0)),h:Nt(t.fieldY1,t.fieldY0),w:Nt(t.fieldX1,t.fieldX0)},c=this.transformedMark(u);return j(n.scope,{name:r["e"].TreeMapMethod,value:"squarify",bind:{name:o,input:"select",options:["squarify","binary"]}}),Object.assign(Object.assign({},s&&{globalScales:{showAxes:!0,scales:{z:[a]}}}),{mark:c,offsets:u,sizeSignals:{layoutHeight:null,layoutWidth:null}})}transformedMark(t){const{names:e,props:n}=this,{globalScope:r,groupings:i,parentScope:o}=n;if(i.length){R(r.scope,{name:e.dataHeightWidth,source:r.markDataName,transform:[{type:"formula",expr:o.offsets.h,as:e.fieldHeight},{type:"formula",expr:o.offsets.w,as:e.fieldWidth}]});const n={name:e.dataFacetMark,source:e.dataFacet},s={type:"group",from:{facet:{name:e.dataFacet,data:e.dataHeightWidth,groupby:$(i).map(G)}},data:[{name:e.dataExtents,source:e.dataFacet,transform:[{type:"extent",field:e.fieldHeight,signal:e.heightExtent},{type:"extent",field:e.fieldWidth,signal:e.widthExtent}]},n]};return r.setMarkDataName(e.dataFacetMark),F(r.markGroup,s),r.setMarkGroup(s),this.treemapTransform(n,`${e.widthExtent}[0]`,`${e.heightExtent}[0]`),this.addMark(t,s,r.markDataName)}return this.treemapTransform(r.data,o.offsets.w,o.offsets.h),this.addMark(t,r.markGroup,r.markDataName)}addMark(t,e,n){const{names:r,prefix:i,props:o}=this,{z:s}=o,a={name:i,type:"rect",from:{data:n},encode:{update:Object.assign({width:{signal:t.w},height:{signal:t.h}},s&&{z:{value:0},depth:[{test:mt(),value:0},{scale:r.zScale,field:G(s.name)}]})}};return F(e,a),a}treemapTransform(t,e,n){const{names:i,props:o}=this,{group:s,size:a}=o;z(t,{type:"filter",expr:`datum[${JSON.stringify(a.name)}] > 0`},{type:"nest",keys:[s&&s.name||"__NONE__"]},{type:"treemap",field:G(a.name),sort:{field:"value",order:"descending"},round:!0,method:{signal:r["e"].TreeMapMethod},paddingInner:1,paddingOuter:0,size:[{signal:e},{signal:n}],as:[i.fieldX0,i.fieldY0,i.fieldX1,i.fieldY1,i.fieldDepth,i.fieldChildren]})}}function It(t){return`datum[${JSON.stringify(t)}]`}function Nt(...t){return t.map(t=>It(t)).join(" - ")}class Dt extends gt{constructor(t){super(t),this.props=t;const e=this.prefix=`wrap_${this.id}`;this.bin=bt(this.prefix,t.globalScope.data.name,t.groupby),this.names={outputData:`data_${e}_out`,rowColumnDataName:`data_${e}_row_col`,cellHeight:`${e}_cellHeight`,cellWidth:`${e}_cellWidth`,fits:`${e}_fits`,target:`${e}_target`,minArea:`${e}_minArea`,aspect:`${e}_aspect`,minAspect:`${e}_minAspect`,idealAspect:`${e}_idealAspect`,dataLength:`${e}_dataLength`,rxc0:`${e}_rxc0`,rxc1:`${e}_rxc1`,rxc2:`${e}_rxc2`,rxc:`${e}_rxc`,growColCount:`${e}_growColCount`,growCellWidth:`${e}_growCellWidth`,fitsArea:`${e}_fitsArea`,colCount:`${e}_colCount`}}getGrouping(){return this.bin.fields}build(){const{bin:t,names:e,prefix:n,props:i}=this,{axisTextColor:o,cellTitles:s,globalScope:a,parentScope:u}=i;let c;if(!1===t.native)j(a.scope,...t.signals),z(a.data,...t.transforms),R(a.scope,t.dataSequence),z(t.dataSequence,{type:"formula",expr:`indata(${JSON.stringify(a.data.name)}, ${JSON.stringify(t.fields[0])}, datum[${JSON.stringify(t.fields[0])}])`,as:r["b"].Contains}),c=t.dataSequence.name;else{const e=Et(a.data.name,n,t.fields,"ascending");R(a.scope,e.data),c=e.data.name}R(a.scope,{name:e.rxc0,transform:[{type:"sequence",start:1,stop:{signal:`ceil(sqrt(${e.dataLength})) + 1`}},{type:"formula",expr:`ceil(${e.dataLength} / datum.data)`,as:"complement"}]},{name:e.rxc1,source:e.rxc0,transform:[{type:"project",fields:["data"],as:["cols"]}]},{name:e.rxc2,source:e.rxc0,transform:[{type:"project",fields:["complement"],as:["cols"]}]},{name:e.rxc,source:[e.rxc1,e.rxc2],transform:[{type:"formula",expr:`ceil(${e.dataLength} / datum.cols)`,as:"rows"},{type:"formula",expr:`${u.sizeSignals.layoutWidth} / datum.cols`,as:"cellw"},{type:"formula",expr:`datum.cols === 1 ? max(datum.cellw, ${r["e"].MinCellWidth}) : datum.cellw`,as:"cellw"},{type:"formula",expr:`${u.sizeSignals.layoutHeight} / datum.rows`,as:"cellh"},{type:"formula",expr:`datum.rows === 1 ? max(datum.cellh, ${r["e"].MinCellHeight}) : datum.cellh`,as:"cellh"},{type:"formula",expr:`(datum.cellw >= ${r["e"].MinCellWidth} && datum.cellh >= ${r["e"].MinCellHeight})`,as:"meetsmin"},{type:"filter",expr:"datum.meetsmin"},{type:"formula",expr:"datum.cellw / datum.cellh",as:e.aspect},{type:"formula",expr:`abs(datum.${e.aspect} - ${e.target})`,as:e.idealAspect},{type:"formula",expr:`${e.dataLength} / (datum.cols * datum.rows)`,as:"coverage"},{type:"collect",sort:{field:[e.idealAspect,"coverage"],order:["ascending","descending"]}}]},{name:e.rowColumnDataName,source:c,transform:[{type:"formula",expr:`floor((datum[${JSON.stringify(r["b"].Ordinal)}] - 1) / ${e.colCount})`,as:r["b"].WrapRow},{type:"formula",expr:`(datum[${JSON.stringify(r["b"].Ordinal)}] - 1) % ${e.colCount}`,as:r["b"].WrapCol},{type:"formula",expr:St(t,r["b"].First,r["b"].Last),as:r["b"].FacetSearch},{type:"formula",expr:wt(t),as:r["b"].FacetTitle}]});const l={name:e.outputData,source:a.data.name,transform:[{type:"lookup",from:e.rowColumnDataName,key:G(t.fields[0]),fields:[t.fields[0]].map(G),values:[r["b"].WrapRow,r["b"].WrapCol]}]};R(a.scope,l),a.setMarkDataName(e.outputData),j(a.scope,{name:e.minAspect,update:`${r["e"].MinCellWidth} / ${r["e"].MinCellHeight}`},{name:e.target,update:`${e.minAspect} === 1 ? 1.2 : ${e.minAspect}`},{name:e.minArea,update:`${r["e"].MinCellWidth}*${r["e"].MinCellHeight}`},{name:e.aspect,update:`${u.sizeSignals.layoutWidth} / ${u.sizeSignals.layoutHeight}`},{name:e.dataLength,update:`data(${JSON.stringify(c)}).length`},{name:e.growColCount,update:`max(floor(${u.sizeSignals.layoutWidth} / ${r["e"].MinCellWidth}), 1)`},{name:e.growCellWidth,update:`${u.sizeSignals.layoutWidth} / ${e.growColCount}`},{name:e.fitsArea,update:`((${e.dataLength} * ${e.minArea}) <= (${u.sizeSignals.layoutWidth} * ${u.sizeSignals.layoutHeight}))`},{name:e.fits,update:`${e.fitsArea} && length(data(${JSON.stringify(e.rxc)})) > 0`},{name:e.colCount,update:`${e.fits} ? data(${JSON.stringify(e.rxc)})[0].cols : ${e.growColCount}`},{name:e.cellWidth,update:`${e.fits} ? data(${JSON.stringify(e.rxc)})[0].cellw : ${e.growCellWidth}`},{name:e.cellHeight,update:`${e.fits} ? data(${JSON.stringify(e.rxc)})[0].cellh : ${r["e"].MinCellHeight}`}),et(a.signals.plotHeightOut,"max",`(${e.cellHeight} * ceil(${e.dataLength} / ${e.colCount}))`),et(a.signals.plotWidthOut,"max",`(${e.cellWidth} * ${e.colCount})`);const h=[e.cellHeight,r["e"].FacetPaddingTop,r["e"].FacetPaddingBottom].join(" - "),f=[e.cellWidth,r["e"].FacetPaddingLeft].join(" - "),d=V(u.offsets.x,`datum[${JSON.stringify(r["b"].WrapCol)}] * ${e.cellWidth}`,r["e"].FacetPaddingLeft),p=V(u.offsets.y,`datum[${JSON.stringify(r["b"].WrapRow)}] * ${e.cellHeight}`,r["e"].FacetPaddingTop),g={height:{signal:h},width:{signal:f},x:{signal:d},y:{signal:p}},m={x:d,y:p,h:h,w:f},y={style:"cell",name:n,type:"group",from:{data:e.rowColumnDataName},encode:{update:g}};F(a.markGroup,y);const v={layoutHeight:`(${e.cellHeight} - ${r["e"].FacetPaddingTop} - ${r["e"].FacetPaddingBottom})`,layoutWidth:`(${e.cellWidth} - ${r["e"].FacetPaddingLeft})`,colCount:e.colCount,rowCount:`ceil(${e.dataLength} / ${e.colCount})`};return s&&at(y,v,o),{facetScope:y,sizeSignals:v,offsets:m}}}const Rt={AggregateContainer:yt,AggregateSquare:vt,Band:_t,Cross:Mt,Scatter:Ct,Square:Ot,Stack:Pt,Strip:Tt,Treemap:Lt,Wrap:Dt};class Ft{constructor(t,e){this.props=t,this.specContext=e,this.globalSignals={minCellWidth:{name:r["e"].MinCellWidth,update:`${a}`},minCellHeight:{name:r["e"].MinCellHeight,update:`${u}`},plotOffsetLeft:{name:r["e"].PlotOffsetLeft,update:"0"},plotOffsetTop:{name:r["e"].PlotOffsetTop,update:"0"},plotOffsetBottom:{name:r["e"].PlotOffsetBottom,update:"0"},plotOffsetRight:{name:r["e"].PlotOffsetRight,update:"0"},plotHeightOut:{name:r["e"].PlotHeightOut,update:r["e"].PlotHeightIn},plotWidthOut:{name:r["e"].PlotWidthOut,update:r["e"].PlotWidthIn}}}validate(){const{specContext:t}=this,{specCapabilities:e}=this.props,{roles:n}=e,r=n.filter(e=>{switch(typeof e.allowNone){case"boolean":return!e.allowNone;case"undefined":return!0;case"function":return!e.allowNone(t)}}),i=n.filter(t=>t.excludeCategoric),o=r.map(e=>{return t.specColumns[e.role]?null:`Field ${e.role} is required.`}).concat(i.map(e=>{return t.specColumns[e.role]&&!t.specColumns[e.role].quantitative?`Field ${e.role} must be quantitative.`:null})).filter(Boolean);return o}build(){const{specContext:t}=this,{facetLayout:e,specCapabilities:n}=this.props,{insight:i,specColumns:o,specViewOptions:s}=t,a="data_source",{vegaSpec:u,groupMark:c}=this.initSpec(a),{topColorField:l,colorDataName:h}=ot({scope:u,dataName:a,specContext:t,scaleName:r["d"].Color,legendDataName:"data_legend",topLookupName:"data_topcolorlookup",colorReverseSignalName:r["e"].ColorReverse}),f=new pt({dataName:h,markGroup:c,scope:u,signals:this.globalSignals});e&&(j(u,{name:r["e"].FacetPaddingBottom,update:`${e.facetPadding.bottom}`},{name:r["e"].FacetPaddingLeft,update:`${e.facetPadding.left}`},{name:r["e"].FacetPaddingTop,update:`${e.facetPadding.top}`}),this.globalSignals.plotOffsetTop.update=`${e.plotPadding.y}`,this.globalSignals.plotOffsetRight.update=`${e.plotPadding.x}`);const{firstScope:d,finalScope:p,specResult:w,allGlobalScales:x,allEncodingRules:S}=this.iterateLayouts(f,(t,n)=>{e&&0===t&&(f.zSize=n.offsets.h)});if(w)return w;if(x.length>0){const t=this.globalSignals.plotHeightOut.name,n=this.globalSignals.plotWidthOut.name,r={type:"linear",name:"scale_facet_col_title",domain:[0,1],range:[0,{signal:n}]},a={type:"linear",name:"scale_facet_row_title",domain:[0,1],range:[{signal:t},0]};let u=e?ut({globalScope:f.scope,plotScope:c,facetScope:d,colTitleScale:r,rowTitleScale:a,colSeqName:"data_FacetCellColTitles",rowSeqName:"data_FacetCellRowTitles"}):{main:[{scope:c,lines:!0,labels:!0,title:!0}]};q({globalScope:f,allGlobalScales:x,axisScales:this.props.axisScales,plotOffsetSignals:{x:this.globalSignals.plotOffsetLeft,y:this.globalSignals.plotOffsetBottom},axesOffsets:{x:b,y:_},axesTitlePadding:e?{x:y,y:v}:{x:g,y:m},labelBaseline:{x:"top",y:"middle"},specColumns:o,specViewOptions:s,axesScopes:u,faceted:!!e,view:i.view})}if(p.mark){const{update:e}=p.mark.encode,n="output";p.mark.from.data=n,R(f.markGroup,{name:n,source:f.markDataName,transform:[{type:"formula",expr:p.offsets.x,as:r["b"].OffsetX},{type:"formula",expr:p.offsets.y,as:r["b"].OffsetY}]}),e.x={field:r["b"].OffsetX},e.y={field:r["b"].OffsetY},S.forEach(t=>{for(let n in t)if(e[n]){let r=t[n];if(Array.isArray(e[n])){let t=e[n];r.forEach(e=>t.unshift(e))}else{let t=e[n],i=[];e[n]=i,r.forEach(t=>i.push(t)),i.push(t)}}}),e.fill=ft(t,l,r["d"].Color),e.opacity=dt(t)}return{specCapabilities:n,vegaSpec:u}}initSpec(t){const{globalSignals:e}=this,{minCellWidth:n,minCellHeight:i,plotOffsetLeft:o,plotOffsetBottom:s,plotOffsetTop:a,plotOffsetRight:u,plotHeightOut:c,plotWidthOut:l}=e,{specContext:h}=this,{insight:f}=h,d={type:"group",encode:{update:{x:{signal:r["e"].PlotOffsetLeft},y:{signal:r["e"].PlotOffsetTop},height:{signal:r["e"].PlotHeightOut},width:{signal:r["e"].PlotWidthOut}}}},p="input",g={$schema:"https://vega.github.io/schema/vega/v5.json",data:[{name:p},{name:t,source:p,transform:[]}],marks:[d],signals:J(h,r["e"].ViewportHeight).concat([n,i,{name:r["e"].ViewportHeight,update:`max(${r["e"].MinCellHeight}, ${f.size.height})`},{name:r["e"].ViewportWidth,update:`max(${r["e"].MinCellWidth}, ${f.size.width})`},o,a,s,u,{name:r["e"].PlotHeightIn,update:`${r["e"].ViewportHeight} - ${r["e"].PlotOffsetBottom}`},{name:r["e"].PlotWidthIn,update:`${r["e"].ViewportWidth} - ${r["e"].PlotOffsetLeft} - ${r["e"].PlotOffsetRight}`},c,l,{name:"height",update:`${r["e"].PlotOffsetTop} + ${r["e"].PlotHeightOut} + ${r["e"].PlotOffsetBottom}`},{name:"width",update:`${r["e"].PlotWidthOut} + ${r["e"].PlotOffsetLeft} + ${r["e"].PlotOffsetRight}`}])};return{vegaSpec:g,groupMark:d}}iterateLayouts(t,e){let n,i,o,s={sizeSignals:t.sizeSignals,offsets:t.offsets};const a=[];let{layouts:u,specCapabilities:c}=this.props;const l=[],h=[];for(let d=0;d<u.length;d++){if(!s)continue;let p={globalScope:t,parentScope:s,axesScales:this.props.axisScales,groupings:a,id:d},g=this.createLayout(u[d],p);try{o=g.build(),o.id=d;let t=g.getGrouping();t&&a.push({id:d,groupby:t,fieldOps:[{field:null,op:"count",as:r["b"].Count}]});let n=g.getAggregateSumOp();n&&a[a.length-1].fieldOps.push(n),e(d,o)}catch(f){n={errors:[f.stack],specCapabilities:c,vegaSpec:null};break}o&&o.globalScales&&l.push(o.globalScales),o.encodingRuleMap&&h.push(o.encodingRuleMap),0===d&&(i=o),s=o}return{firstScope:i,finalScope:s,specResult:n,allGlobalScales:l,allEncodingRules:h}}createLayout(t,e){const{layoutType:n,props:r}=t,i=Object.assign(Object.assign({},r),e),o=Rt[n],s=new o(i);return s.id=e.id,s}}function Bt(t,e){const{specColumns:n}=t,r=[n.color,n.facet,n.facetV,n.group,n.size,n.sort,n.x,n.y,n.z];Object(N["d"])(r,e);const i=I(t),o=new Ft(i,t);let s;if(o){try{const t=o.validate();s=t.length?{errors:t,specCapabilities:i.specCapabilities,vegaSpec:null}:o.build()}catch(a){s={specCapabilities:null,vegaSpec:null,errors:[a.stack]}}if(!s.errors){const t=s.vegaSpec.data[0];t.values=e}}else s={specCapabilities:null,vegaSpec:null,errors:[`could not build spec for ${t.insight.chart}`]};return s}},"43eb":function(t,e,n){"use strict";n("221d")},"467f":function(t,e,n){"use strict";var r=n("2d83");t.exports=function(t,e,n){var i=n.config.validateStatus;n.status&&i&&!i(n.status)?e(r("Request failed with status code "+n.status,n.config,null,n.request,n)):t(n)}},4890:function(t,e,n){"use strict";(function(t){function r(e){if("undefined"!==typeof window&&"object"===typeof window.process&&"renderer"===window.process.type)return!0;if("undefined"!==typeof t&&"object"===typeof t.versions&&Boolean(t.versions.electron))return!0;const n="object"===typeof navigator&&"string"===typeof navigator.userAgent&&navigator.userAgent,r=e||n;return!!(r&&r.indexOf("Electron")>=0)}n.d(e,"a",(function(){return r}))}).call(this,n("4362"))},"48e9":function(t,e,n){"use strict";(function(t){n.d(e,"a",(function(){return i}));var r=n("b8bc");function i(){const e="object"===typeof t&&"[object process]"===String(t)&&!t.browser;return!e||Object(r["a"])()}}).call(this,n("4362"))},"4a7b":function(t,e,n){"use strict";var r=n("c532");t.exports=function(t,e){e=e||{};var n={};function i(t,e){return r.isPlainObject(t)&&r.isPlainObject(e)?r.merge(t,e):r.isPlainObject(e)?r.merge({},e):r.isArray(e)?e.slice():e}function o(n){return r.isUndefined(e[n])?r.isUndefined(t[n])?void 0:i(void 0,t[n]):i(t[n],e[n])}function s(t){if(!r.isUndefined(e[t]))return i(void 0,e[t])}function a(n){return r.isUndefined(e[n])?r.isUndefined(t[n])?void 0:i(void 0,t[n]):i(void 0,e[n])}function u(n){return n in e?i(t[n],e[n]):n in t?i(void 0,t[n]):void 0}var c={url:s,method:s,data:s,baseURL:a,transformRequest:a,transformResponse:a,paramsSerializer:a,timeout:a,timeoutMessage:a,withCredentials:a,adapter:a,responseType:a,xsrfCookieName:a,xsrfHeaderName:a,onUploadProgress:a,onDownloadProgress:a,decompress:a,maxContentLength:a,maxBodyLength:a,transport:a,httpAgent:a,httpsAgent:a,cancelToken:a,socketPath:a,responseEncoding:a,validateStatus:u};return r.forEach(Object.keys(t).concat(Object.keys(e)),(function(t){var e=c[t]||o,i=e(t);r.isUndefined(i)&&e!==u||(n[t]=i)})),n}},"4c23":function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return o})),n.d(e,"c",(function(){return s})),n.d(e,"d",(function(){return a}));var r,i,o,s,a,u=n("a591");function c(t){return r=Object(u["a"])(t),i=r.format,o=r.parse,s=r.utcFormat,a=r.utcParse,r}c({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]})},"4c47":function(t,e){function n(){return t.exports=n=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},t.exports["default"]=t.exports,t.exports.__esModule=!0,n.apply(this,arguments)}t.exports=n,t.exports["default"]=t.exports,t.exports.__esModule=!0},"4d83":function(t,e,n){"use strict";var r=n("4ea4"),i=n("7037");Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"self",{enumerable:!0,get:function(){return o.self}}),Object.defineProperty(e,"window",{enumerable:!0,get:function(){return o.window}}),Object.defineProperty(e,"global",{enumerable:!0,get:function(){return o.global}}),Object.defineProperty(e,"document",{enumerable:!0,get:function(){return o.document}}),Object.defineProperty(e,"process",{enumerable:!0,get:function(){return o.process}}),Object.defineProperty(e,"console",{enumerable:!0,get:function(){return o.console}}),Object.defineProperty(e,"isBrowser",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(e,"isBrowserMainThread",{enumerable:!0,get:function(){return s.isBrowserMainThread}}),Object.defineProperty(e,"getBrowser",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(e,"isMobile",{enumerable:!0,get:function(){return a.isMobile}}),Object.defineProperty(e,"isElectron",{enumerable:!0,get:function(){return u.default}});var o=n("331d"),s=l(n("8007")),a=l(n("724b")),u=r(n("9d38"));function c(t){if("function"!==typeof WeakMap)return null;var e=new WeakMap,n=new WeakMap;return(c=function(t){return t?n:e})(t)}function l(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!==i(t)&&"function"!==typeof t)return{default:t};var n=c(e);if(n&&n.has(t))return n.get(t);var r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in t)if("default"!==s&&Object.prototype.hasOwnProperty.call(t,s)){var a=o?Object.getOwnPropertyDescriptor(t,s):null;a&&(a.get||a.set)?Object.defineProperty(r,s,a):r[s]=t[s]}return r.default=t,n&&n.set(t,r),r}},"4df4":function(t,e,n){"use strict";var r=n("da84"),i=n("0366"),o=n("c65b"),s=n("7b0b"),a=n("9bdd"),u=n("e95a"),c=n("68ee"),l=n("07fa"),h=n("8418"),f=n("9a1f"),d=n("35a1"),p=r.Array;t.exports=function(t){var e=s(t),n=c(this),r=arguments.length,g=r>1?arguments[1]:void 0,m=void 0!==g;m&&(g=i(g,r>2?arguments[2]:void 0));var y,v,b,_,w,x,S=d(e),E=0;if(!S||this==p&&u(S))for(y=l(e),v=n?new this(y):p(y);y>E;E++)x=m?g(e[E],E):e[E],h(v,E,x);else for(_=f(e,S),w=_.next,v=n?new this:[];!(b=o(w,_)).done;E++)x=m?a(_,g,[b.value,E],!0):b.value,h(v,E,x);return v.length=E,v}},"4ea4":function(t,e){function n(t){return t&&t.__esModule?t:{default:t}}t.exports=n},"4ed1":function(t,e,n){"use strict";(function(t){var r=n("4ea4");Object.defineProperty(e,"__esModule",{value:!0}),e.default=o;var i=r(n("7037"));function o(e){if("undefined"!==typeof window&&"object"===(0,i.default)(window.process)&&"renderer"===window.process.type)return!0;if("undefined"!==typeof t&&"object"===(0,i.default)(t.versions)&&Boolean(t.versions.electron))return!0;var n="object"===("undefined"===typeof navigator?"undefined":(0,i.default)(navigator))&&"string"===typeof navigator.userAgent&&navigator.userAgent,r=e||n;return!!(r&&r.indexOf("Electron")>=0)}}).call(this,n("4362"))},"4f2a":function(t,e){e.encode=function(t){var e="";for(var n in t)t.hasOwnProperty(n)&&(e.length&&(e+="&"),e+=encodeURIComponent(n)+"="+encodeURIComponent(t[n]));return e},e.decode=function(t){for(var e={},n=t.split("&"),r=0,i=n.length;r<i;r++){var o=n[r].split("=");e[decodeURIComponent(o[0])]=decodeURIComponent(o[1])}return e}},"4fad":function(t,e,n){var r=n("23e7"),i=n("6f53").entries;r({target:"Object",stat:!0},{entries:function(t){return i(t)}})},"4fadd":function(t,e,n){var r=n("d039"),i=n("861d"),o=n("c6b6"),s=n("d86b"),a=Object.isExtensible,u=r((function(){a(1)}));t.exports=u||s?function(t){return!!i(t)&&((!s||"ArrayBuffer"!=o(t))&&(!a||a(t)))}:a},5:function(t,e){},5270:function(t,e,n){"use strict";var r=n("c532"),i=n("c401"),o=n("2e67"),s=n("2444"),a=n("7a77");function u(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new a("canceled")}t.exports=function(t){u(t),t.headers=t.headers||{},t.data=i.call(t,t.data,t.headers,t.transformRequest),t.headers=r.merge(t.headers.common||{},t.headers[t.method]||{},t.headers),r.forEach(["delete","get","head","post","put","patch","common"],(function(e){delete t.headers[e]}));var e=t.adapter||s.adapter;return e(t).then((function(e){return u(t),e.data=i.call(t,e.data,e.headers,t.transformResponse),e}),(function(e){return o(e)||(u(t),e&&e.response&&(e.response.data=i.call(t,e.response.data,e.response.headers,t.transformResponse))),Promise.reject(e)}))}},5317:function(t,e){var n=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,r=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function i(t,e){var n=/\/{2,9}/g,r=e.replace(n,"/").split("/");return"/"!=e.substr(0,1)&&0!==e.length||r.splice(0,1),"/"==e.substr(e.length-1,1)&&r.splice(r.length-1,1),r}function o(t,e){var n={};return e.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,(function(t,e,r){e&&(n[e]=r)})),n}t.exports=function(t){var e=t,s=t.indexOf("["),a=t.indexOf("]");-1!=s&&-1!=a&&(t=t.substring(0,s)+t.substring(s,a).replace(/:/g,";")+t.substring(a,t.length));var u=n.exec(t||""),c={},l=14;while(l--)c[r[l]]=u[l]||"";return-1!=s&&-1!=a&&(c.source=e,c.host=c.host.substring(1,c.host.length-1).replace(/;/g,":"),c.authority=c.authority.replace("[","").replace("]","").replace(/;/g,":"),c.ipv6uri=!0),c.pathNames=i(c,c["path"]),c.queryKey=o(c,c["query"]),c}},5319:function(t,e,n){"use strict";var r=n("2ba4"),i=n("c65b"),o=n("e330"),s=n("d784"),a=n("d039"),u=n("825a"),c=n("1626"),l=n("5926"),h=n("50c4"),f=n("577e"),d=n("1d80"),p=n("8aa5"),g=n("dc4a"),m=n("0cb2"),y=n("14c3"),v=n("b622"),b=v("replace"),_=Math.max,w=Math.min,x=o([].concat),S=o([].push),E=o("".indexOf),A=o("".slice),M=function(t){return void 0===t?t:String(t)},C=function(){return"$0"==="a".replace(/./,"$0")}(),k=function(){return!!/./[b]&&""===/./[b]("a","$0")}(),O=!a((function(){var t=/./;return t.exec=function(){var t=[];return t.groups={a:"7"},t},"7"!=="".replace(t,"$<a>")}));s("replace",(function(t,e,n){var o=k?"$":"$0";return[function(t,n){var r=d(this),o=void 0==t?void 0:g(t,b);return o?i(o,t,r,n):i(e,f(r),t,n)},function(t,i){var s=u(this),a=f(t);if("string"==typeof i&&-1===E(i,o)&&-1===E(i,"$<")){var d=n(e,s,a,i);if(d.done)return d.value}var g=c(i);g||(i=f(i));var v=s.global;if(v){var b=s.unicode;s.lastIndex=0}var C=[];while(1){var k=y(s,a);if(null===k)break;if(S(C,k),!v)break;var O=f(k[0]);""===O&&(s.lastIndex=p(a,h(s.lastIndex),b))}for(var P="",T=0,L=0;L<C.length;L++){k=C[L];for(var I=f(k[0]),N=_(w(l(k.index),a.length),0),D=[],R=1;R<k.length;R++)S(D,M(k[R]));var F=k.groups;if(g){var B=x([I],D,N,a);void 0!==F&&S(B,F);var j=f(r(i,void 0,B))}else j=m(I,a,N,D,F,i);N>=T&&(P+=A(a,T,N)+j,T=N+I.length)}return P+A(a,T)}]}),!O||!C||k)},"53c7":function(t,e,n){"use strict";n("e431")},"55a9":function(t,e,n){"use strict";(function(t){n.d(e,"b",(function(){return r})),n.d(e,"c",(function(){return i})),n.d(e,"a",(function(){return o}));const r="undefined"!==typeof navigator&&navigator.userAgent?navigator.userAgent.toLowerCase():"",i="undefined"!==typeof window?window:t;"undefined"!==typeof t||window,"undefined"!==typeof document&&document;let o=!1;try{const t={get passive(){return o=!0,!0}};i.addEventListener("test",t,t),i.removeEventListener("test",t,t)}catch(s){}}).call(this,n("c8ba"))},"55f8":function(t,e,n){"use strict";var r=n("18e2"),i=Object(r["a"])((function(t){t.setUTCDate(1),t.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCMonth(t.getUTCMonth()+e)}),(function(t,e){return e.getUTCMonth()-t.getUTCMonth()+12*(e.getUTCFullYear()-t.getUTCFullYear())}),(function(t){return t.getUTCMonth()}));e["a"]=i;i.range},5664:function(t,e,n){"use strict";function r(t,e,n){n=n||2;var r,o,a,u,c,l,f,d=e&&e.length,p=d?e[0]*n:t.length,g=i(t,0,p,n,!0),m=[];if(!g||g.next===g.prev)return m;if(d&&(g=h(t,e,g,n)),t.length>80*n){r=a=t[0],o=u=t[1];for(var y=n;y<p;y+=n)c=t[y],l=t[y+1],c<r&&(r=c),l<o&&(o=l),c>a&&(a=c),l>u&&(u=l);f=Math.max(a-r,u-o),f=0!==f?1/f:0}return s(g,m,n,r,o,f),m}function i(t,e,n,r,i){var o,s;if(i===N(t,e,n,r)>0)for(o=e;o<n;o+=r)s=T(o,t[o],t[o+1],s);else for(o=n-r;o>=e;o-=r)s=T(o,t[o],t[o+1],s);return s&&S(s,s.next)&&(L(s),s=s.next),s}function o(t,e){if(!t)return t;e||(e=t);var n,r=t;do{if(n=!1,r.steiner||!S(r,r.next)&&0!==x(r.prev,r,r.next))r=r.next;else{if(L(r),r=e=r.prev,r===r.next)break;n=!0}}while(n||r!==e);return e}function s(t,e,n,r,i,h,f){if(t){!f&&h&&m(t,r,i,h);var d,p,g=t;while(t.prev!==t.next)if(d=t.prev,p=t.next,h?u(t,r,i,h):a(t))e.push(d.i/n),e.push(t.i/n),e.push(p.i/n),L(t),t=p.next,g=p.next;else if(t=p,t===g){f?1===f?(t=c(o(t),e,n),s(t,e,n,r,i,h,2)):2===f&&l(t,e,n,r,i,h):s(o(t),e,n,r,i,h,1);break}}}function a(t){var e=t.prev,n=t,r=t.next;if(x(e,n,r)>=0)return!1;var i=t.next.next;while(i!==t.prev){if(_(e.x,e.y,n.x,n.y,r.x,r.y,i.x,i.y)&&x(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}function u(t,e,n,r){var i=t.prev,o=t,s=t.next;if(x(i,o,s)>=0)return!1;var a=i.x<o.x?i.x<s.x?i.x:s.x:o.x<s.x?o.x:s.x,u=i.y<o.y?i.y<s.y?i.y:s.y:o.y<s.y?o.y:s.y,c=i.x>o.x?i.x>s.x?i.x:s.x:o.x>s.x?o.x:s.x,l=i.y>o.y?i.y>s.y?i.y:s.y:o.y>s.y?o.y:s.y,h=v(a,u,e,n,r),f=v(c,l,e,n,r),d=t.prevZ,p=t.nextZ;while(d&&d.z>=h&&p&&p.z<=f){if(d!==t.prev&&d!==t.next&&_(i.x,i.y,o.x,o.y,s.x,s.y,d.x,d.y)&&x(d.prev,d,d.next)>=0)return!1;if(d=d.prevZ,p!==t.prev&&p!==t.next&&_(i.x,i.y,o.x,o.y,s.x,s.y,p.x,p.y)&&x(p.prev,p,p.next)>=0)return!1;p=p.nextZ}while(d&&d.z>=h){if(d!==t.prev&&d!==t.next&&_(i.x,i.y,o.x,o.y,s.x,s.y,d.x,d.y)&&x(d.prev,d,d.next)>=0)return!1;d=d.prevZ}while(p&&p.z<=f){if(p!==t.prev&&p!==t.next&&_(i.x,i.y,o.x,o.y,s.x,s.y,p.x,p.y)&&x(p.prev,p,p.next)>=0)return!1;p=p.nextZ}return!0}function c(t,e,n){var r=t;do{var i=r.prev,s=r.next.next;!S(i,s)&&E(i,r,r.next,s)&&k(i,s)&&k(s,i)&&(e.push(i.i/n),e.push(r.i/n),e.push(s.i/n),L(r),L(r.next),r=t=s),r=r.next}while(r!==t);return o(r)}function l(t,e,n,r,i,a){var u=t;do{var c=u.next.next;while(c!==u.prev){if(u.i!==c.i&&w(u,c)){var l=P(u,c);return u=o(u,u.next),l=o(l,l.next),s(u,e,n,r,i,a),void s(l,e,n,r,i,a)}c=c.next}u=u.next}while(u!==t)}function h(t,e,n,r){var s,a,u,c,l,h=[];for(s=0,a=e.length;s<a;s++)u=e[s]*r,c=s<a-1?e[s+1]*r:t.length,l=i(t,u,c,r,!1),l===l.next&&(l.steiner=!0),h.push(b(l));for(h.sort(f),s=0;s<h.length;s++)d(h[s],n),n=o(n,n.next);return n}function f(t,e){return t.x-e.x}function d(t,e){if(e=p(t,e),e){var n=P(e,t);o(n,n.next)}}function p(t,e){var n,r=e,i=t.x,o=t.y,s=-1/0;do{if(o<=r.y&&o>=r.next.y&&r.next.y!==r.y){var a=r.x+(o-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(a<=i&&a>s){if(s=a,a===i){if(o===r.y)return r;if(o===r.next.y)return r.next}n=r.x<r.next.x?r:r.next}}r=r.next}while(r!==e);if(!n)return null;if(i===s)return n;var u,c=n,l=n.x,h=n.y,f=1/0;r=n;do{i>=r.x&&r.x>=l&&i!==r.x&&_(o<h?i:s,o,l,h,o<h?s:i,o,r.x,r.y)&&(u=Math.abs(o-r.y)/(i-r.x),k(r,t)&&(u<f||u===f&&(r.x>n.x||r.x===n.x&&g(n,r)))&&(n=r,f=u)),r=r.next}while(r!==c);return n}function g(t,e){return x(t.prev,t,e.prev)<0&&x(e.next,t,t.next)<0}function m(t,e,n,r){var i=t;do{null===i.z&&(i.z=v(i.x,i.y,e,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==t);i.prevZ.nextZ=null,i.prevZ=null,y(i)}function y(t){var e,n,r,i,o,s,a,u,c=1;do{n=t,t=null,o=null,s=0;while(n){for(s++,r=n,a=0,e=0;e<c;e++)if(a++,r=r.nextZ,!r)break;u=c;while(a>0||u>0&&r)0!==a&&(0===u||!r||n.z<=r.z)?(i=n,n=n.nextZ,a--):(i=r,r=r.nextZ,u--),o?o.nextZ=i:t=i,i.prevZ=o,o=i;n=r}o.nextZ=null,c*=2}while(s>1);return t}function v(t,e,n,r,i){return t=32767*(t-n)*i,e=32767*(e-r)*i,t=16711935&(t|t<<8),t=252645135&(t|t<<4),t=858993459&(t|t<<2),t=1431655765&(t|t<<1),e=16711935&(e|e<<8),e=252645135&(e|e<<4),e=858993459&(e|e<<2),e=1431655765&(e|e<<1),t|e<<1}function b(t){var e=t,n=t;do{(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next}while(e!==t);return n}function _(t,e,n,r,i,o,s,a){return(i-s)*(e-a)-(t-s)*(o-a)>=0&&(t-s)*(r-a)-(n-s)*(e-a)>=0&&(n-s)*(o-a)-(i-s)*(r-a)>=0}function w(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!C(t,e)&&(k(t,e)&&k(e,t)&&O(t,e)&&(x(t.prev,t,e.prev)||x(t,e.prev,e))||S(t,e)&&x(t.prev,t,t.next)>0&&x(e.prev,e,e.next)>0)}function x(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function S(t,e){return t.x===e.x&&t.y===e.y}function E(t,e,n,r){var i=M(x(t,e,n)),o=M(x(t,e,r)),s=M(x(n,r,t)),a=M(x(n,r,e));return i!==o&&s!==a||(!(0!==i||!A(t,n,e))||(!(0!==o||!A(t,r,e))||(!(0!==s||!A(n,t,r))||!(0!==a||!A(n,e,r)))))}function A(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function M(t){return t>0?1:t<0?-1:0}function C(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&E(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}function k(t,e){return x(t.prev,t,t.next)<0?x(t,e,t.next)>=0&&x(t,t.prev,e)>=0:x(t,e,t.prev)<0||x(t,t.next,e)<0}function O(t,e){var n=t,r=!1,i=(t.x+e.x)/2,o=(t.y+e.y)/2;do{n.y>o!==n.next.y>o&&n.next.y!==n.y&&i<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==t);return r}function P(t,e){var n=new I(t.i,t.x,t.y),r=new I(e.i,e.x,e.y),i=t.next,o=e.prev;return t.next=e,e.prev=t,n.next=i,i.prev=n,r.next=n,n.prev=r,o.next=r,r.prev=o,r}function T(t,e,n,r){var i=new I(t,e,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function L(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function I(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function N(t,e,n,r){for(var i=0,o=e,s=n-r;o<n;o+=r)i+=(t[s]-t[o])*(t[o+1]+t[s+1]),s=o;return i}t.exports=r,t.exports.default=r,r.deviation=function(t,e,n,r){var i=e&&e.length,o=i?e[0]*n:t.length,s=Math.abs(N(t,0,o,n));if(i)for(var a=0,u=e.length;a<u;a++){var c=e[a]*n,l=a<u-1?e[a+1]*n:t.length;s-=Math.abs(N(t,c,l,n))}var h=0;for(a=0;a<r.length;a+=3){var f=r[a]*n,d=r[a+1]*n,p=r[a+2]*n;h+=Math.abs((t[f]-t[p])*(t[d+1]-t[f+1])-(t[f]-t[d])*(t[p+1]-t[f+1]))}return 0===s&&0===h?0:Math.abs((h-s)/s)},r.flatten=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},r=0,i=0;i<t.length;i++){for(var o=0;o<t[i].length;o++)for(var s=0;s<e;s++)n.vertices.push(t[i][o][s]);i>0&&(r+=t[i-1].length,n.holes.push(r))}return n}},"56f3":function(t,e,n){"use strict";(function(t){var r=n("6b74"),i=n("cd77");n.d(e,"b",(function(){return i["a"]}));var o=n("370d");n.d(e,"a",(function(){return o["a"]})),n.d(e,"e",(function(){return r["d"]})),n.d(e,"d",(function(){return r["a"]})),n.d(e,"f",(function(){return r["g"]}));var s=n("fab1");n.d(e,"c",(function(){return s["a"]}));const a={self:"undefined"!==typeof self&&self,window:"undefined"!==typeof window&&window,global:"undefined"!==typeof t&&t},u=a.global||a.self||a.window;u.mathgl={config:r["b"]}}).call(this,n("c8ba"))},5729:function(t,e,n){"use strict";function r(t,e){if(!t)throw new Error(e||"luma.gl: assertion failed.")}n.d(e,"a",(function(){return r}))},"5a34":function(t,e,n){var r=n("da84"),i=n("44e7"),o=r.TypeError;t.exports=function(t){if(i(t))throw o("The method doesn't accept regular expressions");return t}},"5b67":function(t,e,n){"use strict";(function(t){n.d(e,"a",(function(){return i}));var r=n("c834");function i(){const e="object"===typeof t&&"[object process]"===String(t)&&!t.browser;return!e||Object(r["a"])()}}).call(this,n("4362"))},"5bcf":function(t,e,n){},"5cce":function(t,e){t.exports={version:"0.24.0"}},"5eb5":function(t,e,n){},"5edf":function(t,e,n){"use strict";var r=n("18e2"),i=n("1738"),o=Object(r["a"])((function(t){t.setTime(t-t.getMilliseconds())}),(function(t,e){t.setTime(+t+e*i["e"])}),(function(t,e){return(e-t)/i["e"]}),(function(t){return t.getUTCSeconds()}));e["a"]=o;o.range},"5f02":function(t,e,n){"use strict";t.exports=function(t){return"object"===typeof t&&!0===t.isAxiosError}},"5f48":function(t,e,n){},6:function(t,e){},6041:function(t,e,n){},"62be":function(t,e,n){"use strict";n("0de6")},"63ad":function(t,e,n){"use strict";function r(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}n.d(e,"b",(function(){return r})),e["a"]=function(t,e,n){t.prototype=e.prototype=n,n.constructor=t}},6441:function(t,e,n){"use strict";n("5bcf")},"65f3":function(t,e,n){"use strict";n("7e18")},"6a1a":function(t,e,n){"use strict";n("cb03")},"6b74":function(t,e,n){"use strict";n.d(e,"b",(function(){return o})),n.d(e,"e",(function(){return a})),n.d(e,"f",(function(){return u})),n.d(e,"h",(function(){return h})),n.d(e,"c",(function(){return f})),n.d(e,"a",(function(){return d})),n.d(e,"g",(function(){return p})),n.d(e,"d",(function(){return g}));n("b52f");const r=1/Math.PI*180,i=1/180*Math.PI,o={};function s(t){return Math.round(t/o.EPSILON)*o.EPSILON}function a(t,{precision:e=o.precision||4}={}){return t=s(t),"".concat(parseFloat(t.toPrecision(e)))}function u(t){return Array.isArray(t)||ArrayBuffer.isView(t)&&!(t instanceof DataView)}function c(t){return t.clone?t.clone():new Array(t.length)}function l(t,e,n){if(u(t)){n=n||c(t);for(let r=0;r<n.length&&r<t.length;++r)n[r]=e(t[r],r,n);return n}return e(t)}function h(t,e){return l(t,t=>t*i,e)}function f(t,e){return l(t,t=>t*r,e)}function d(t,e,n){return l(t,t=>Math.max(e,Math.min(n,t)))}function p(t,e,n){return u(t)?t.map((t,r)=>p(t,e[r],n)):n*e+(1-n)*t}function g(t,e,n){const r=o.EPSILON;n&&(o.EPSILON=n);try{if(t===e)return!0;if(u(t)&&u(e)){if(t.length!==e.length)return!1;for(let n=0;n<t.length;++n)if(!g(t[n],e[n]))return!1;return!0}return t&&t.equals?t.equals(e):e&&e.equals?e.equals(t):!(!Number.isFinite(t)||!Number.isFinite(e))&&Math.abs(t-e)<=o.EPSILON*Math.max(1,Math.abs(t),Math.abs(e))}finally{o.EPSILON=r}}o.EPSILON=1e-12,o.debug=!1,o.precision=4,o.printTypes=!1,o.printDegrees=!1,o.printRowMajor=!0},"6d51":function(t,e,n){"use strict";n.d(e,"b",(function(){return r})),n.d(e,"a",(function(){return i})),n.d(e,"c",(function(){return o}));var r=1e-6,i="undefined"!==typeof Float32Array?Float32Array:Array,o=Math.random;Math.PI;Math.hypot||(Math.hypot=function(){var t=0,e=arguments.length;while(e--)t+=arguments[e]*arguments[e];return Math.sqrt(t)})},"6e8e":function(t,e,n){(function(e){var r;(function(e){t.exports=e()})((function(){var t;return function(){function t(e,n,i){function o(a,u){if(!n[a]){if(!e[a]){var c="function"==typeof r&&r;if(!u&&c)return r(a,!0);if(s)return s(a,!0);var l=new Error("Cannot find module '"+a+"'");throw l.code="MODULE_NOT_FOUND",l}var h=n[a]={exports:{}};e[a][0].call(h.exports,(function(t){var n=e[a][1][t];return o(n||t)}),h,h.exports,t,e,n,i)}return n[a].exports}for(var s="function"==typeof r&&r,a=0;a<i.length;a++)o(i[a]);return o}return t}()({1:[function(t,n,r){(function(e,r){(function(){"use strict";var i=t("events").EventEmitter,o=t("./store"),s=t("mqtt-packet"),a=t("readable-stream").Writable,u=t("inherits"),c=t("reinterval"),l=t("./validations"),h=t("xtend"),f=t("debug")("mqttjs:client"),d=e?e.nextTick:function(t){setTimeout(t,0)},p=r.setImmediate||function(t){d(t)},g={keepalive:60,reschedulePings:!0,protocolId:"MQTT",protocolVersion:4,reconnectPeriod:1e3,connectTimeout:3e4,clean:!0,resubscribe:!0},m=["ECONNREFUSED","EADDRINUSE","ECONNRESET","ENOTFOUND"],y={0:"",1:"Unacceptable protocol version",2:"Identifier rejected",3:"Server unavailable",4:"Bad username or password",5:"Not authorized",16:"No matching subscribers",17:"No subscription existed",128:"Unspecified error",129:"Malformed Packet",130:"Protocol Error",131:"Implementation specific error",132:"Unsupported Protocol Version",133:"Client Identifier not valid",134:"Bad User Name or Password",135:"Not authorized",136:"Server unavailable",137:"Server busy",138:"Banned",139:"Server shutting down",140:"Bad authentication method",141:"Keep Alive timeout",142:"Session taken over",143:"Topic Filter invalid",144:"Topic Name invalid",145:"Packet identifier in use",146:"Packet Identifier not found",147:"Receive Maximum exceeded",148:"Topic Alias invalid",149:"Packet too large",150:"Message rate too high",151:"Quota exceeded",152:"Administrative action",153:"Payload format invalid",154:"Retain not supported",155:"QoS not supported",156:"Use another server",157:"Server moved",158:"Shared Subscriptions not supported",159:"Connection rate exceeded",160:"Maximum connect time",161:"Subscription Identifiers not supported",162:"Wildcard Subscriptions not supported"};function v(){return"mqttjs_"+Math.random().toString(16).substr(2,8)}function b(t,e,n){f("sendPacket :: packet: %O",e),f("sendPacket :: emitting `packetsend`"),t.emit("packetsend",e),f("sendPacket :: writing to stream");var r=s.writeToStream(e,t.stream,t.options);f("sendPacket :: writeToStream result %s",r),!r&&n?(f("sendPacket :: handle events on `drain` once through callback."),t.stream.once("drain",n)):n&&(f("sendPacket :: invoking cb"),n())}function _(t){t&&(f("flush: queue exists? %b",!!t),Object.keys(t).forEach((function(e){"function"===typeof t[e].cb&&(t[e].cb(new Error("Connection closed")),delete t[e])})))}function w(t){t&&(f("flushVolatile :: deleting volatile messages from the queue and setting their callbacks as error function"),Object.keys(t).forEach((function(e){t[e].volatile&&"function"===typeof t[e].cb&&(t[e].cb(new Error("Connection closed")),delete t[e])})))}function x(t,e,n,r){f("storeAndSend :: store packet with cmd %s to outgoingStore",e.cmd),t.outgoingStore.put(e,(function(i){if(i)return n&&n(i);r(),b(t,e,n)}))}function S(t){f("nop ::",t)}function E(t,e){var n,r=this;if(!(this instanceof E))return new E(t,e);for(n in this.options=e||{},g)"undefined"===typeof this.options[n]?this.options[n]=g[n]:this.options[n]=e[n];f("MqttClient :: options.protocol",e.protocol),f("MqttClient :: options.protocolVersion",e.protocolVersion),f("MqttClient :: options.username",e.username),f("MqttClient :: options.keepalive",e.keepalive),f("MqttClient :: options.reconnectPeriod",e.reconnectPeriod),f("MqttClient :: options.rejectUnauthorized",e.rejectUnauthorized),this.options.clientId="string"===typeof e.clientId?e.clientId:v(),f("MqttClient :: clientId",this.options.clientId),this.options.customHandleAcks=5===e.protocolVersion&&e.customHandleAcks?e.customHandleAcks:function(){arguments[3](0)},this.streamBuilder=t,this.outgoingStore=e.outgoingStore||new o,this.incomingStore=e.incomingStore||new o,this.queueQoSZero=void 0===e.queueQoSZero||e.queueQoSZero,this._resubscribeTopics={},this.messageIdToTopic={},this.pingTimer=null,this.connected=!1,this.disconnecting=!1,this.queue=[],this.connackTimer=null,this.reconnectTimer=null,this._storeProcessing=!1,this._packetIdsDuringStoreProcessing={},this.nextId=Math.max(1,Math.floor(65535*Math.random())),this.outgoing={},this._firstConnection=!0,this.on("connect",(function(){var t=this.queue;function e(){var n=t.shift();f("deliver :: entry %o",n);var i=null;n&&(i=n.packet,f("deliver :: call _sendPacket for %o",i),r._sendPacket(i,(function(t){n.cb&&n.cb(t),e()})))}f("connect :: sending queued packets"),e()})),this.on("close",(function(){f("close :: connected set to `false`"),this.connected=!1,f("close :: clearing connackTimer"),clearTimeout(this.connackTimer),f("close :: clearing ping timer"),null!==r.pingTimer&&(r.pingTimer.clear(),r.pingTimer=null),f("close :: calling _setupReconnect"),this._setupReconnect()})),i.call(this),f("MqttClient :: setting up stream"),this._setupStream()}u(E,i),E.prototype._setupStream=function(){var t,e=this,n=new a,r=s.parser(this.options),i=null,o=[];function u(){if(o.length)d(c);else{var t=i;i=null,t()}}function c(){f("work :: getting next packet in queue");var t=o.shift();if(t)f("work :: packet pulled from queue"),e._handlePacket(t,u);else{f("work :: no packets in queue");var n=i;i=null,f("work :: done flag is %s",!!n),n&&n()}}function l(t){f("streamErrorHandler :: error",t.message),m.includes(t.code)?(f("streamErrorHandler :: emitting error"),e.emit("error",t)):S(t)}if(f("_setupStream :: calling method to clear reconnect"),this._clearReconnect(),f("_setupStream :: using streamBuilder provided to client to create stream"),this.stream=this.streamBuilder(this),r.on("packet",(function(t){f("parser :: on packet push to packets array."),o.push(t)})),n._write=function(t,e,n){i=n,f("writable stream :: parsing buffer"),r.parse(t),c()},f("_setupStream :: pipe stream to writable stream"),this.stream.pipe(n),this.stream.on("error",l),this.stream.on("close",(function(){f("(%s)stream :: on close",e.options.clientId),w(e.outgoing),f("stream: emit close to MqttClient"),e.emit("close")})),f("_setupStream: sending packet `connect`"),t=Object.create(this.options),t.cmd="connect",b(this,t),r.on("error",this.emit.bind(this,"error")),this.options.properties){if(!this.options.properties.authenticationMethod&&this.options.properties.authenticationData)return e.end(()=>this.emit("error",new Error("Packet has no Authentication Method"))),this;if(this.options.properties.authenticationMethod&&this.options.authPacket&&"object"===typeof this.options.authPacket){var p=h({cmd:"auth",reasonCode:0},this.options.authPacket);b(this,p)}}this.stream.setMaxListeners(1e3),clearTimeout(this.connackTimer),this.connackTimer=setTimeout((function(){f("!!connectTimeout hit!! Calling _cleanUp with force `true`"),e._cleanUp(!0)}),this.options.connectTimeout)},E.prototype._handlePacket=function(t,e){var n=this.options;if(5===n.protocolVersion&&n.properties&&n.properties.maximumPacketSize&&n.properties.maximumPacketSize<t.length)return this.emit("error",new Error("exceeding packets size "+t.cmd)),this.end({reasonCode:149,properties:{reasonString:"Maximum packet size was exceeded"}}),this;switch(f("_handlePacket :: emitting packetreceive"),this.emit("packetreceive",t),t.cmd){case"publish":this._handlePublish(t,e);break;case"puback":case"pubrec":case"pubcomp":case"suback":case"unsuback":this._handleAck(t),e();break;case"pubrel":this._handlePubrel(t,e);break;case"connack":this._handleConnack(t),e();break;case"pingresp":this._handlePingresp(t),e();break;case"disconnect":this._handleDisconnect(t),e();break;default:break}},E.prototype._checkDisconnecting=function(t){return this.disconnecting&&(t?t(new Error("client disconnecting")):this.emit("error",new Error("client disconnecting"))),this.disconnecting},E.prototype.publish=function(t,e,n,r){var i;f("publish :: message `%s` to topic `%s`",e,t);var o=this.options;"function"===typeof n&&(r=n,n=null);var s={qos:0,retain:!1,dup:!1};if(n=h(s,n),this._checkDisconnecting(r))return this;switch(i={cmd:"publish",topic:t,payload:e,qos:n.qos,retain:n.retain,messageId:this._nextId(),dup:n.dup},5===o.protocolVersion&&(i.properties=n.properties,(!o.properties&&i.properties&&i.properties.topicAlias||n.properties&&o.properties&&(n.properties.topicAlias&&o.properties.topicAliasMaximum&&n.properties.topicAlias>o.properties.topicAliasMaximum||!o.properties.topicAliasMaximum&&n.properties.topicAlias))&&delete i.properties.topicAlias),f("publish :: qos",n.qos),n.qos){case 1:case 2:this.outgoing[i.messageId]={volatile:!1,cb:r||S},this._storeProcessing?(f("_storeProcessing enabled"),this._packetIdsDuringStoreProcessing[i.messageId]=!1,this._storePacket(i,void 0,n.cbStorePut)):(f("MqttClient:publish: packet cmd: %s",i.cmd),this._sendPacket(i,void 0,n.cbStorePut));break;default:this._storeProcessing?(f("_storeProcessing enabled"),this._storePacket(i,r,n.cbStorePut)):(f("MqttClient:publish: packet cmd: %s",i.cmd),this._sendPacket(i,r,n.cbStorePut));break}return this},E.prototype.subscribe=function(){for(var t,e=new Array(arguments.length),n=0;n<arguments.length;n++)e[n]=arguments[n];var r,i=[],o=e.shift(),s=o.resubscribe,a=e.pop()||S,u=e.pop(),c=this,d=this.options.protocolVersion;if(delete o.resubscribe,"string"===typeof o&&(o=[o]),"function"!==typeof a&&(u=a,a=S),r=l.validateTopics(o),null!==r)return p(a,new Error("Invalid topic "+r)),this;if(this._checkDisconnecting(a))return f("subscribe: discconecting true"),this;var g={qos:0};if(5===d&&(g.nl=!1,g.rap=!1,g.rh=0),u=h(g,u),Array.isArray(o)?o.forEach((function(t){if(f("subscribe: array topic %s",t),!c._resubscribeTopics.hasOwnProperty(t)||c._resubscribeTopics[t].qos<u.qos||s){var e={topic:t,qos:u.qos};5===d&&(e.nl=u.nl,e.rap=u.rap,e.rh=u.rh,e.properties=u.properties),f("subscribe: pushing topic `%s` and qos `%s` to subs list",e.topic,e.qos),i.push(e)}})):Object.keys(o).forEach((function(t){if(f("subscribe: object topic %s",t),!c._resubscribeTopics.hasOwnProperty(t)||c._resubscribeTopics[t].qos<o[t].qos||s){var e={topic:t,qos:o[t].qos};5===d&&(e.nl=o[t].nl,e.rap=o[t].rap,e.rh=o[t].rh,e.properties=u.properties),f("subscribe: pushing `%s` to subs list",e),i.push(e)}})),t={cmd:"subscribe",subscriptions:i,qos:1,retain:!1,dup:!1,messageId:this._nextId()},u.properties&&(t.properties=u.properties),i.length){if(this.options.resubscribe){f("subscribe :: resubscribe true");var m=[];i.forEach((function(t){if(c.options.reconnectPeriod>0){var e={qos:t.qos};5===d&&(e.nl=t.nl||!1,e.rap=t.rap||!1,e.rh=t.rh||0,e.properties=t.properties),c._resubscribeTopics[t.topic]=e,m.push(t.topic)}})),c.messageIdToTopic[t.messageId]=m}return this.outgoing[t.messageId]={volatile:!0,cb:function(t,e){if(!t)for(var n=e.granted,r=0;r<n.length;r+=1)i[r].qos=n[r];a(t,i)}},f("subscribe :: call _sendPacket"),this._sendPacket(t),this}a(null,[])},E.prototype.unsubscribe=function(){for(var t={cmd:"unsubscribe",qos:1,messageId:this._nextId()},e=this,n=new Array(arguments.length),r=0;r<arguments.length;r++)n[r]=arguments[r];var i=n.shift(),o=n.pop()||S,s=n.pop();return"string"===typeof i&&(i=[i]),"function"!==typeof o&&(s=o,o=S),this._checkDisconnecting(o)?this:("string"===typeof i?t.unsubscriptions=[i]:Array.isArray(i)&&(t.unsubscriptions=i),this.options.resubscribe&&t.unsubscriptions.forEach((function(t){delete e._resubscribeTopics[t]})),"object"===typeof s&&s.properties&&(t.properties=s.properties),this.outgoing[t.messageId]={volatile:!0,cb:o},f("unsubscribe: call _sendPacket"),this._sendPacket(t),this)},E.prototype.end=function(t,e,n){var r=this;function i(){f("end :: closeStores: closing incoming and outgoing stores"),r.disconnected=!0,r.incomingStore.close((function(t){r.outgoingStore.close((function(e){if(f("end :: closeStores: emitting end"),r.emit("end"),n){let r=t||e;f("end :: closeStores: invoking callback with args"),n(r)}}))})),r._deferredReconnect&&r._deferredReconnect()}function o(){f("end :: (%s) :: finish :: calling _cleanUp with force %s",r.options.clientId,t),r._cleanUp(t,()=>{f("end :: finish :: calling process.nextTick on closeStores"),d(i.bind(r))},e)}return f("end :: (%s)",this.options.clientId),null!=t&&"boolean"===typeof t||(n=e||S,e=t,t=!1,"object"!==typeof e&&(n=e,e=null,"function"!==typeof n&&(n=S))),"object"!==typeof e&&(n=e,e=null),f("end :: cb? %s",!!n),n=n||S,this.disconnecting?(n(),this):(this._clearReconnect(),this.disconnecting=!0,!t&&Object.keys(this.outgoing).length>0?(f("end :: (%s) :: calling finish in 10ms once outgoing is empty",r.options.clientId),this.once("outgoingEmpty",setTimeout.bind(null,o,10))):(f("end :: (%s) :: immediately calling finish",r.options.clientId),o()),this)},E.prototype.removeOutgoingMessage=function(t){var e=this.outgoing[t]?this.outgoing[t].cb:null;return delete this.outgoing[t],this.outgoingStore.del({messageId:t},(function(){e(new Error("Message removed"))})),this},E.prototype.reconnect=function(t){f("client reconnect");var e=this,n=function(){t?(e.options.incomingStore=t.incomingStore,e.options.outgoingStore=t.outgoingStore):(e.options.incomingStore=null,e.options.outgoingStore=null),e.incomingStore=e.options.incomingStore||new o,e.outgoingStore=e.options.outgoingStore||new o,e.disconnecting=!1,e.disconnected=!1,e._deferredReconnect=null,e._reconnect()};return this.disconnecting&&!this.disconnected?this._deferredReconnect=n:n(),this},E.prototype._reconnect=function(){f("_reconnect: emitting reconnect to client"),this.emit("reconnect"),this.connected?(this.end(()=>{this._setupStream()}),f("client already connected. disconnecting first.")):(f("_reconnect: calling _setupStream"),this._setupStream())},E.prototype._setupReconnect=function(){var t=this;!t.disconnecting&&!t.reconnectTimer&&t.options.reconnectPeriod>0?(this.reconnecting||(f("_setupReconnect :: emit `offline` state"),this.emit("offline"),f("_setupReconnect :: set `reconnecting` to `true`"),this.reconnecting=!0),f("_setupReconnect :: setting reconnectTimer for %d ms",t.options.reconnectPeriod),t.reconnectTimer=setInterval((function(){f("reconnectTimer :: reconnect triggered!"),t._reconnect()}),t.options.reconnectPeriod)):f("_setupReconnect :: doing nothing...")},E.prototype._clearReconnect=function(){f("_clearReconnect : clearing reconnect timer"),this.reconnectTimer&&(clearInterval(this.reconnectTimer),this.reconnectTimer=null)},E.prototype._cleanUp=function(t,e){var n=arguments[2];if(e&&(f("_cleanUp :: done callback provided for on stream close"),this.stream.on("close",e)),f("_cleanUp :: forced? %s",t),t)0===this.options.reconnectPeriod&&this.options.clean&&_(this.outgoing),f("_cleanUp :: (%s) :: destroying stream",this.options.clientId),this.stream.destroy();else{var r=h({cmd:"disconnect"},n);f("_cleanUp :: (%s) :: call _sendPacket with disconnect packet",this.options.clientId),this._sendPacket(r,p.bind(null,this.stream.end.bind(this.stream)))}this.disconnecting||(f("_cleanUp :: client not disconnecting. Clearing and resetting reconnect."),this._clearReconnect(),this._setupReconnect()),null!==this.pingTimer&&(f("_cleanUp :: clearing pingTimer"),this.pingTimer.clear(),this.pingTimer=null),e&&!this.connected&&(f("_cleanUp :: (%s) :: removing stream `done` callback `close` listener",this.options.clientId),this.stream.removeListener("close",e),e())},E.prototype._sendPacket=function(t,e,n){if(f("_sendPacket :: (%s) ::  start",this.options.clientId),n=n||S,!this.connected)return f("_sendPacket :: client not connected. Storing packet offline."),void this._storePacket(t,e,n);switch(this._shiftPingInterval(),t.cmd){case"publish":break;case"pubrel":return void x(this,t,e,n);default:return void b(this,t,e)}switch(t.qos){case 2:case 1:x(this,t,e,n);break;case 0:default:b(this,t,e);break}f("_sendPacket :: (%s) ::  end",this.options.clientId)},E.prototype._storePacket=function(t,e,n){f("_storePacket :: packet: %o",t),f("_storePacket :: cb? %s",!!e),n=n||S,0===(t.qos||0)&&this.queueQoSZero||"publish"!==t.cmd?this.queue.push({packet:t,cb:e}):t.qos>0?(e=this.outgoing[t.messageId]?this.outgoing[t.messageId].cb:null,this.outgoingStore.put(t,(function(t){if(t)return e&&e(t);n()}))):e&&e(new Error("No connection to broker"))},E.prototype._setupPingTimer=function(){f("_setupPingTimer :: keepalive %d (seconds)",this.options.keepalive);var t=this;!this.pingTimer&&this.options.keepalive&&(this.pingResp=!0,this.pingTimer=c((function(){t._checkPing()}),1e3*this.options.keepalive))},E.prototype._shiftPingInterval=function(){this.pingTimer&&this.options.keepalive&&this.options.reschedulePings&&this.pingTimer.reschedule(1e3*this.options.keepalive)},E.prototype._checkPing=function(){f("_checkPing :: checking ping..."),this.pingResp?(f("_checkPing :: ping response received. Clearing flag and sending `pingreq`"),this.pingResp=!1,this._sendPacket({cmd:"pingreq"})):(f("_checkPing :: calling _cleanUp with force true"),this._cleanUp(!0))},E.prototype._handlePingresp=function(){this.pingResp=!0},E.prototype._handleConnack=function(t){f("_handleConnack");var e=this.options,n=e.protocolVersion,r=5===n?t.reasonCode:t.returnCode;if(clearTimeout(this.connackTimer),t.properties&&(t.properties.topicAliasMaximum&&(e.properties||(e.properties={}),e.properties.topicAliasMaximum=t.properties.topicAliasMaximum),t.properties.serverKeepAlive&&e.keepalive&&(e.keepalive=t.properties.serverKeepAlive,this._shiftPingInterval()),t.properties.maximumPacketSize&&(e.properties||(e.properties={}),e.properties.maximumPacketSize=t.properties.maximumPacketSize)),0===r)this.reconnecting=!1,this._onConnect(t);else if(r>0){var i=new Error("Connection refused: "+y[r]);i.code=r,this.emit("error",i)}},E.prototype._handlePublish=function(t,e){f("_handlePublish: packet %o",t),e="undefined"!==typeof e?e:S;var n=t.topic.toString(),r=t.payload,i=t.qos,o=t.messageId,s=this,a=this.options,u=[0,16,128,131,135,144,145,151,153];switch(f("_handlePublish: qos %d",i),i){case 2:a.customHandleAcks(n,r,t,(function(n,r){return n instanceof Error||(r=n,n=null),n?s.emit("error",n):-1===u.indexOf(r)?s.emit("error",new Error("Wrong reason code for pubrec")):void(r?s._sendPacket({cmd:"pubrec",messageId:o,reasonCode:r},e):s.incomingStore.put(t,(function(){s._sendPacket({cmd:"pubrec",messageId:o},e)})))}));break;case 1:a.customHandleAcks(n,r,t,(function(i,a){return i instanceof Error||(a=i,i=null),i?s.emit("error",i):-1===u.indexOf(a)?s.emit("error",new Error("Wrong reason code for puback")):(a||s.emit("message",n,r,t),void s.handleMessage(t,(function(t){if(t)return e&&e(t);s._sendPacket({cmd:"puback",messageId:o,reasonCode:a},e)})))}));break;case 0:this.emit("message",n,r,t),this.handleMessage(t,e);break;default:f("_handlePublish: unknown QoS. Doing nothing.");break}},E.prototype.handleMessage=function(t,e){e()},E.prototype._handleAck=function(t){var e,n=t.messageId,r=t.cmd,i=null,o=this.outgoing[n]?this.outgoing[n].cb:null,s=this;if(o){switch(f("_handleAck :: packet type",r),r){case"pubcomp":case"puback":var a=t.reasonCode;a&&a>0&&16!==a&&(e=new Error("Publish error: "+y[a]),e.code=a,o(e,t)),delete this.outgoing[n],this.outgoingStore.del(t,o);break;case"pubrec":i={cmd:"pubrel",qos:2,messageId:n};var u=t.reasonCode;u&&u>0&&16!==u?(e=new Error("Publish error: "+y[u]),e.code=u,o(e,t)):this._sendPacket(i);break;case"suback":delete this.outgoing[n];for(var c=0;c<t.granted.length;c++)if(0!==(128&t.granted[c])){var l=this.messageIdToTopic[n];l&&l.forEach((function(t){delete s._resubscribeTopics[t]}))}o(null,t);break;case"unsuback":delete this.outgoing[n],o(null);break;default:s.emit("error",new Error("unrecognized packet type"))}this.disconnecting&&0===Object.keys(this.outgoing).length&&this.emit("outgoingEmpty")}else f("_handleAck :: Server sent an ack in error. Ignoring.")},E.prototype._handlePubrel=function(t,e){f("handling pubrel packet"),e="undefined"!==typeof e?e:S;var n=t.messageId,r=this,i={cmd:"pubcomp",messageId:n};r.incomingStore.get(t,(function(t,n){t?r._sendPacket(i,e):(r.emit("message",n.topic,n.payload,n),r.handleMessage(n,(function(t){if(t)return e(t);r.incomingStore.del(n,S),r._sendPacket(i,e)})))}))},E.prototype._handleDisconnect=function(t){this.emit("disconnect",t)},E.prototype._nextId=function(){var t=this.nextId++;return 65536===this.nextId&&(this.nextId=1),t},E.prototype.getLastMessageId=function(){return 1===this.nextId?65535:this.nextId-1},E.prototype._resubscribe=function(t){f("_resubscribe");var e=Object.keys(this._resubscribeTopics);if(!this._firstConnection&&(this.options.clean||5===this.options.protocolVersion&&!t.sessionPresent)&&e.length>0)if(this.options.resubscribe)if(5===this.options.protocolVersion){f("_resubscribe: protocolVersion 5");for(var n=0;n<e.length;n++){var r={};r[e[n]]=this._resubscribeTopics[e[n]],r.resubscribe=!0,this.subscribe(r,{properties:r[e[n]].properties})}}else this._resubscribeTopics.resubscribe=!0,this.subscribe(this._resubscribeTopics);else this._resubscribeTopics={};this._firstConnection=!1},E.prototype._onConnect=function(t){if(this.disconnected)this.emit("connect",t);else{var e=this;this._setupPingTimer(),this._resubscribe(t),this.connected=!0,n()}function n(){var r=e.outgoingStore.createStream();function i(){e._storeProcessing=!1,e._packetIdsDuringStoreProcessing={}}function o(){r.destroy(),r=null,i()}function s(){if(r){e._storeProcessing=!0;var t,n=r.read(1);n?e._packetIdsDuringStoreProcessing[n.messageId]?s():e.disconnecting||e.reconnectTimer?r.destroy&&r.destroy():(t=e.outgoing[n.messageId]?e.outgoing[n.messageId].cb:null,e.outgoing[n.messageId]={volatile:!1,cb:function(e,n){t&&t(e,n),s()}},e._packetIdsDuringStoreProcessing[n.messageId]=!0,e._sendPacket(n)):r.once("readable",s)}}e.once("close",o),r.on("error",(function(t){i(),e.removeListener("close",o),e.emit("error",t)})),r.on("end",(function(){var r=!0;for(var s in e._packetIdsDuringStoreProcessing)if(!e._packetIdsDuringStoreProcessing[s]){r=!1;break}r?(i(),e.removeListener("close",o),e.emit("connect",t)):n()})),s()}},n.exports=E}).call(this)}).call(this,t("_process"),"undefined"!==typeof e?e:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{"./store":7,"./validations":8,_process:32,debug:15,events:19,inherits:21,"mqtt-packet":24,"readable-stream":51,reinterval:52,xtend:61}],2:[function(t,e,n){(function(n){(function(){"use strict";var r,i,o,s=t("readable-stream").Transform,a=t("duplexify"),u=!1;function c(){var t=new s;return t._write=function(t,e,n){r.sendSocketMessage({data:t.buffer,success:function(){n()},fail:function(){n(new Error)}})},t._flush=function(t){r.closeSocket({success:function(){t()}})},t}function l(t){t.hostname||(t.hostname="localhost"),t.path||(t.path="/"),t.wsOptions||(t.wsOptions={})}function h(t,e){var n="alis"===t.protocol?"wss":"ws",r=n+"://"+t.hostname+t.path;return t.port&&80!==t.port&&443!==t.port&&(r=n+"://"+t.hostname+":"+t.port+t.path),"function"===typeof t.transformWsUrl&&(r=t.transformWsUrl(r,t,e)),r}function f(){u||(u=!0,r.onSocketOpen((function(){o.setReadable(i),o.setWritable(i),o.emit("connect")})),r.onSocketMessage((function(t){if("string"===typeof t.data){var e=n.from(t.data,"base64");i.push(e)}else{var r=new FileReader;r.addEventListener("load",(function(){var t=r.result;t=t instanceof ArrayBuffer?n.from(t):n.from(t,"utf8"),i.push(t)})),r.readAsArrayBuffer(t.data)}})),r.onSocketClose((function(){o.end(),o.destroy()})),r.onSocketError((function(t){o.destroy(t)})))}function d(t,e){if(e.hostname=e.hostname||e.host,!e.hostname)throw new Error("Could not determine host. Specify host manually.");var n="MQIsdp"===e.protocolId&&3===e.protocolVersion?"mqttv3.1":"mqtt";l(e);var s=h(e,t);return r=e.my,r.connectSocket({url:s,protocols:n}),i=c(),o=a.obj(),f(),o}e.exports=d}).call(this)}).call(this,t("buffer").Buffer)},{buffer:14,duplexify:17,"readable-stream":51}],3:[function(t,e,n){"use strict";var r=t("net"),i=t("debug")("mqttjs:tcp");function o(t,e){var n,o;return e.port=e.port||1883,e.hostname=e.hostname||e.host||"localhost",n=e.port,o=e.hostname,i("port %d and host %s",n,o),r.createConnection(n,o)}e.exports=o},{debug:15,net:13}],4:[function(t,e,n){"use strict";var r=t("tls"),i=t("debug")("mqttjs:tls");function o(t,e){var n;function o(r){e.rejectUnauthorized&&t.emit("error",r),n.end()}return e.port=e.port||8883,e.host=e.hostname||e.host||"localhost",e.servername=e.host,e.rejectUnauthorized=!1!==e.rejectUnauthorized,delete e.path,i("port %d host %s rejectUnauthorized %b",e.port,e.host,e.rejectUnauthorized),n=r.connect(e),n.on("secureConnect",(function(){e.rejectUnauthorized&&!n.authorized?n.emit("error",new Error("TLS not authorized")):n.removeListener("error",o)})),n.on("error",o),n}e.exports=o},{debug:15,tls:13}],5:[function(t,e,r){(function(r,i){(function(){"use strict";const o=t("ws"),s=t("debug")("mqttjs:ws"),a=t("duplexify"),u=t("readable-stream").Transform;let c=["rejectUnauthorized","ca","cert","key","pfx","passphrase"];const l="undefined"!==typeof r&&"browser"===r.title||"function"===typeof n;function h(t,e){let n=t.protocol+"://"+t.hostname+":"+t.port+t.path;return"function"===typeof t.transformWsUrl&&(n=t.transformWsUrl(n,t,e)),n}function f(t){let e=t;return t.hostname||(e.hostname="localhost"),t.port||("wss"===t.protocol?e.port=443:e.port=80),t.path||(e.path="/"),t.wsOptions||(e.wsOptions={}),l||"wss"!==t.protocol||c.forEach((function(n){t.hasOwnProperty(n)&&!t.wsOptions.hasOwnProperty(n)&&(e.wsOptions[n]=t[n])})),e}function d(t){let e=f(t);if(e.hostname||(e.hostname=e.host),!e.hostname){if("undefined"===typeof document)throw new Error("Could not determine host. Specify host manually.");const t=new URL(document.URL);e.hostname=t.hostname,e.port||(e.port=t.port)}return void 0===e.objectMode&&(e.objectMode=!(!0===e.binary||void 0===e.binary)),e}function p(t,e,n){s("createWebSocket"),s("protocol: "+n.protocolId+" "+n.protocolVersion);const r="MQIsdp"===n.protocolId&&3===n.protocolVersion?"mqttv3.1":"mqtt";s("creating new Websocket for url: "+e+" and protocol: "+r);let i=new o(e,[r],n.wsOptions);return i}function g(t,e){const n="MQIsdp"===e.protocolId&&3===e.protocolVersion?"mqttv3.1":"mqtt";let r=h(e,t),i=new WebSocket(r,[n]);return i.binaryType="arraybuffer",i}function m(t,e){s("streamBuilder");let n=f(e);const r=h(n,t);let i=p(t,r,n),a=o.createWebSocketStream(i,n.wsOptions);return a.url=r,i.on("close",()=>{a.destroy()}),a}function y(t,e){let n;s("browserStreamBuilder");let r=d(e);const o=r.browserBufferSize||524288,c=e.browserBufferTimeout||1e3,l=!e.objectMode;let h=g(t,e),f=m(e,x,S);e.objectMode||(f._writev=w),f.on("close",()=>{h.close()});const p="undefined"!==typeof h.addEventListener;function m(t,e,n){let r=new u({objectModeMode:t.objectMode});return r._write=e,r._flush=n,r}function y(){n.setReadable(f),n.setWritable(f),n.emit("connect")}function v(){n.end(),n.destroy()}function b(t){n.destroy(t)}function _(t){let e=t.data;e=e instanceof ArrayBuffer?i.from(e):i.from(e,"utf8"),f.push(e)}function w(t,e){const n=new Array(t.length);for(let r=0;r<t.length;r++)"string"===typeof t[r].chunk?n[r]=i.from(t[r],"utf8"):n[r]=t[r].chunk;this._write(i.concat(n),"binary",e)}function x(t,e,n){h.bufferedAmount>o&&setTimeout(x,c,t,e,n),l&&"string"===typeof t&&(t=i.from(t,"utf8"));try{h.send(t)}catch(r){return n(r)}n()}function S(t){h.close(),t()}return(h.readyState===h.OPEN?n=f:(n=n=a(void 0,void 0,e),e.objectMode||(n._writev=w),p?h.addEventListener("open",y):h.onopen=y),n.socket=h,p?(h.addEventListener("close",v),h.addEventListener("error",b),h.addEventListener("message",_)):(h.onclose=v,h.onerror=b,h.onmessage=_),n)}e.exports=l?y:m}).call(this)}).call(this,t("_process"),t("buffer").Buffer)},{_process:32,buffer:14,debug:15,duplexify:17,"readable-stream":51,ws:60}],6:[function(t,e,n){(function(n){(function(){"use strict";var r,i,o,s=t("readable-stream").Transform,a=t("duplexify");function u(){var t=new s;return t._write=function(t,e,n){r.send({data:t.buffer,success:function(){n()},fail:function(t){n(new Error(t))}})},t._flush=function(t){r.close({success:function(){t()}})},t}function c(t){t.hostname||(t.hostname="localhost"),t.path||(t.path="/"),t.wsOptions||(t.wsOptions={})}function l(t,e){var n="wxs"===t.protocol?"wss":"ws",r=n+"://"+t.hostname+t.path;return t.port&&80!==t.port&&443!==t.port&&(r=n+"://"+t.hostname+":"+t.port+t.path),"function"===typeof t.transformWsUrl&&(r=t.transformWsUrl(r,t,e)),r}function h(){r.onOpen((function(){o.setReadable(i),o.setWritable(i),o.emit("connect")})),r.onMessage((function(t){var e=t.data;e=e instanceof ArrayBuffer?n.from(e):n.from(e,"utf8"),i.push(e)})),r.onClose((function(){o.end(),o.destroy()})),r.onError((function(t){o.destroy(new Error(t.errMsg))}))}function f(t,e){if(e.hostname=e.hostname||e.host,!e.hostname)throw new Error("Could not determine host. Specify host manually.");var n="MQIsdp"===e.protocolId&&3===e.protocolVersion?"mqttv3.1":"mqtt";c(e);var s=l(e,t);r=wx.connectSocket({url:s,protocols:[n]}),i=u(),o=a.obj(),o._destroy=function(t,e){r.close({success:function(){e&&e(t)}})};var f=o.destroy;return o.destroy=function(){o.destroy=f;var t=this;setTimeout((function(){r.close({fail:function(){t._destroy(new Error)}})}),0)}.bind(o),h(),o}e.exports=f}).call(this)}).call(this,t("buffer").Buffer)},{buffer:14,duplexify:17,"readable-stream":51}],7:[function(t,e,n){"use strict";var r=t("xtend"),i=t("readable-stream").Readable,o={objectMode:!0},s={clean:!0};function a(t){if(!(this instanceof a))return new a(t);this.options=t||{},this.options=r(s,t),this._inflights=new Map}a.prototype.put=function(t,e){return this._inflights.set(t.messageId,t),e&&e(),this},a.prototype.createStream=function(){var t=new i(o),e=!1,n=[],r=0;return this._inflights.forEach((function(t,e){n.push(t)})),t._read=function(){!e&&r<n.length?this.push(n[r++]):this.push(null)},t.destroy=function(){if(!e){var t=this;e=!0,setTimeout((function(){t.emit("close")}),0)}},t},a.prototype.del=function(t,e){return t=this._inflights.get(t.messageId),t?(this._inflights.delete(t.messageId),e(null,t)):e&&e(new Error("missing packet")),this},a.prototype.get=function(t,e){return t=this._inflights.get(t.messageId),t?e(null,t):e&&e(new Error("missing packet")),this},a.prototype.close=function(t){this.options.clean&&(this._inflights=null),t&&t()},e.exports=a},{"readable-stream":51,xtend:61}],8:[function(t,e,n){"use strict";function r(t){for(var e=t.split("/"),n=0;n<e.length;n++)if("+"!==e[n]){if("#"===e[n])return n===e.length-1;if(-1!==e[n].indexOf("+")||-1!==e[n].indexOf("#"))return!1}return!0}function i(t){if(0===t.length)return"empty_topic_list";for(var e=0;e<t.length;e++)if(!r(t[e]))return t[e];return null}e.exports={validateTopics:i}},{}],9:[function(t,e,r){(function(r){(function(){"use strict";var i=t("../client"),o=t("../store"),s=t("url"),a=t("xtend"),u=t("debug")("mqttjs"),c={};function l(t){var e;t.auth&&(e=t.auth.match(/^(.+):(.+)$/),e?(t.username=e[1],t.password=e[2]):t.username=t.auth)}function h(t,e){if(u("connecting to an MQTT broker..."),"object"!==typeof t||e||(e=t,t=null),e=e||{},t){var n=s.parse(t,!0);if(null!=n.port&&(n.port=Number(n.port)),e=a(n,e),null===e.protocol)throw new Error("Missing protocol");e.protocol=e.protocol.replace(/:$/,"")}if(l(e),e.query&&"string"===typeof e.query.clientId&&(e.clientId=e.query.clientId),e.cert&&e.key){if(!e.protocol)throw new Error("Missing secure protocol key");if(-1===["mqtts","wss","wxs","alis"].indexOf(e.protocol))switch(e.protocol){case"mqtt":e.protocol="mqtts";break;case"ws":e.protocol="wss";break;case"wx":e.protocol="wxs";break;case"ali":e.protocol="alis";break;default:throw new Error('Unknown protocol for secure connection: "'+e.protocol+'"!')}}if(!c[e.protocol]){var r=-1!==["mqtts","wss"].indexOf(e.protocol);e.protocol=["mqtt","mqtts","ws","wss","wx","wxs","ali","alis"].filter((function(t,e){return(!r||e%2!==0)&&"function"===typeof c[t]}))[0]}if(!1===e.clean&&!e.clientId)throw new Error("Missing clientId for unclean clients");function o(t){return e.servers&&(t._reconnectCount&&t._reconnectCount!==e.servers.length||(t._reconnectCount=0),e.host=e.servers[t._reconnectCount].host,e.port=e.servers[t._reconnectCount].port,e.protocol=e.servers[t._reconnectCount].protocol?e.servers[t._reconnectCount].protocol:e.defaultProtocol,e.hostname=e.host,t._reconnectCount++),u("calling streambuilder for",e.protocol),c[e.protocol](t,e)}e.protocol&&(e.defaultProtocol=e.protocol);var h=new i(o,e);return h.on("error",(function(){})),h}"undefined"!==typeof r&&"browser"!==r.title||"function"!==typeof n?(c.mqtt=t("./tcp"),c.tcp=t("./tcp"),c.ssl=t("./tls"),c.tls=t("./tls"),c.mqtts=t("./tls")):(c.wx=t("./wx"),c.wxs=t("./wx"),c.ali=t("./ali"),c.alis=t("./ali")),c.ws=t("./ws"),c.wss=t("./ws"),e.exports=h,e.exports.connect=h,e.exports.MqttClient=i,e.exports.Store=o}).call(this)}).call(this,t("_process"))},{"../client":1,"../store":7,"./ali":2,"./tcp":3,"./tls":4,"./ws":5,"./wx":6,_process:32,debug:15,url:56,xtend:61}],10:[function(t,e,n){"use strict";n.byteLength=l,n.toByteArray=f,n.fromByteArray=g;for(var r=[],i=[],o="undefined"!==typeof Uint8Array?Uint8Array:Array,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0,u=s.length;a<u;++a)r[a]=s[a],i[s.charCodeAt(a)]=a;function c(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=t.indexOf("=");-1===n&&(n=e);var r=n===e?0:4-n%4;return[n,r]}function l(t){var e=c(t),n=e[0],r=e[1];return 3*(n+r)/4-r}function h(t,e,n){return 3*(e+n)/4-n}function f(t){var e,n,r=c(t),s=r[0],a=r[1],u=new o(h(t,s,a)),l=0,f=a>0?s-4:s;for(n=0;n<f;n+=4)e=i[t.charCodeAt(n)]<<18|i[t.charCodeAt(n+1)]<<12|i[t.charCodeAt(n+2)]<<6|i[t.charCodeAt(n+3)],u[l++]=e>>16&255,u[l++]=e>>8&255,u[l++]=255&e;return 2===a&&(e=i[t.charCodeAt(n)]<<2|i[t.charCodeAt(n+1)]>>4,u[l++]=255&e),1===a&&(e=i[t.charCodeAt(n)]<<10|i[t.charCodeAt(n+1)]<<4|i[t.charCodeAt(n+2)]>>2,u[l++]=e>>8&255,u[l++]=255&e),u}function d(t){return r[t>>18&63]+r[t>>12&63]+r[t>>6&63]+r[63&t]}function p(t,e,n){for(var r,i=[],o=e;o<n;o+=3)r=(t[o]<<16&16711680)+(t[o+1]<<8&65280)+(255&t[o+2]),i.push(d(r));return i.join("")}function g(t){for(var e,n=t.length,i=n%3,o=[],s=16383,a=0,u=n-i;a<u;a+=s)o.push(p(t,a,a+s>u?u:a+s));return 1===i?(e=t[n-1],o.push(r[e>>2]+r[e<<4&63]+"==")):2===i&&(e=(t[n-2]<<8)+t[n-1],o.push(r[e>>10]+r[e>>4&63]+r[e<<2&63]+"=")),o.join("")}i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63},{}],11:[function(t,e,n){"use strict";const{Buffer:r}=t("buffer"),i=Symbol.for("BufferList");function o(t){if(!(this instanceof o))return new o(t);o._init.call(this,t)}o._init=function(t){Object.defineProperty(this,i,{value:!0}),this._bufs=[],this.length=0,t&&this.append(t)},o.prototype._new=function(t){return new o(t)},o.prototype._offset=function(t){if(0===t)return[0,0];let e=0;for(let n=0;n<this._bufs.length;n++){const r=e+this._bufs[n].length;if(t<r||n===this._bufs.length-1)return[n,t-e];e=r}},o.prototype._reverseOffset=function(t){const e=t[0];let n=t[1];for(let r=0;r<e;r++)n+=this._bufs[r].length;return n},o.prototype.get=function(t){if(t>this.length||t<0)return;const e=this._offset(t);return this._bufs[e[0]][e[1]]},o.prototype.slice=function(t,e){return"number"===typeof t&&t<0&&(t+=this.length),"number"===typeof e&&e<0&&(e+=this.length),this.copy(null,0,t,e)},o.prototype.copy=function(t,e,n,i){if(("number"!==typeof n||n<0)&&(n=0),("number"!==typeof i||i>this.length)&&(i=this.length),n>=this.length)return t||r.alloc(0);if(i<=0)return t||r.alloc(0);const o=!!t,s=this._offset(n),a=i-n;let u=a,c=o&&e||0,l=s[1];if(0===n&&i===this.length){if(!o)return 1===this._bufs.length?this._bufs[0]:r.concat(this._bufs,this.length);for(let e=0;e<this._bufs.length;e++)this._bufs[e].copy(t,c),c+=this._bufs[e].length;return t}if(u<=this._bufs[s[0]].length-l)return o?this._bufs[s[0]].copy(t,e,l,l+u):this._bufs[s[0]].slice(l,l+u);o||(t=r.allocUnsafe(a));for(let r=s[0];r<this._bufs.length;r++){const e=this._bufs[r].length-l;if(!(u>e)){this._bufs[r].copy(t,c,l,l+u),c+=e;break}this._bufs[r].copy(t,c,l),c+=e,u-=e,l&&(l=0)}return t.length>c?t.slice(0,c):t},o.prototype.shallowSlice=function(t,e){if(t=t||0,e="number"!==typeof e?this.length:e,t<0&&(t+=this.length),e<0&&(e+=this.length),t===e)return this._new();const n=this._offset(t),r=this._offset(e),i=this._bufs.slice(n[0],r[0]+1);return 0===r[1]?i.pop():i[i.length-1]=i[i.length-1].slice(0,r[1]),0!==n[1]&&(i[0]=i[0].slice(n[1])),this._new(i)},o.prototype.toString=function(t,e,n){return this.slice(e,n).toString(t)},o.prototype.consume=function(t){if(t=Math.trunc(t),Number.isNaN(t)||t<=0)return this;while(this._bufs.length){if(!(t>=this._bufs[0].length)){this._bufs[0]=this._bufs[0].slice(t),this.length-=t;break}t-=this._bufs[0].length,this.length-=this._bufs[0].length,this._bufs.shift()}return this},o.prototype.duplicate=function(){const t=this._new();for(let e=0;e<this._bufs.length;e++)t.append(this._bufs[e]);return t},o.prototype.append=function(t){if(null==t)return this;if(t.buffer)this._appendBuffer(r.from(t.buffer,t.byteOffset,t.byteLength));else if(Array.isArray(t))for(let e=0;e<t.length;e++)this.append(t[e]);else if(this._isBufferList(t))for(let e=0;e<t._bufs.length;e++)this.append(t._bufs[e]);else"number"===typeof t&&(t=t.toString()),this._appendBuffer(r.from(t));return this},o.prototype._appendBuffer=function(t){this._bufs.push(t),this.length+=t.length},o.prototype.indexOf=function(t,e,n){if(void 0===n&&"string"===typeof e&&(n=e,e=void 0),"function"===typeof t||Array.isArray(t))throw new TypeError('The "value" argument must be one of type string, Buffer, BufferList, or Uint8Array.');if("number"===typeof t?t=r.from([t]):"string"===typeof t?t=r.from(t,n):this._isBufferList(t)?t=t.slice():Array.isArray(t.buffer)?t=r.from(t.buffer,t.byteOffset,t.byteLength):r.isBuffer(t)||(t=r.from(t)),e=Number(e||0),isNaN(e)&&(e=0),e<0&&(e=this.length+e),e<0&&(e=0),0===t.length)return e>this.length?this.length:e;const i=this._offset(e);let o=i[0],s=i[1];for(;o<this._bufs.length;o++){const e=this._bufs[o];while(s<e.length){const n=e.length-s;if(n>=t.length){const n=e.indexOf(t,s);if(-1!==n)return this._reverseOffset([o,n]);s=e.length-t.length+1}else{const e=this._reverseOffset([o,s]);if(this._match(e,t))return e;s++}}s=0}return-1},o.prototype._match=function(t,e){if(this.length-t<e.length)return!1;for(let n=0;n<e.length;n++)if(this.get(t+n)!==e[n])return!1;return!0},function(){const t={readDoubleBE:8,readDoubleLE:8,readFloatBE:4,readFloatLE:4,readInt32BE:4,readInt32LE:4,readUInt32BE:4,readUInt32LE:4,readInt16BE:2,readInt16LE:2,readUInt16BE:2,readUInt16LE:2,readInt8:1,readUInt8:1,readIntBE:null,readIntLE:null,readUIntBE:null,readUIntLE:null};for(const e in t)(function(e){null===t[e]?o.prototype[e]=function(t,n){return this.slice(t,t+n)[e](0,n)}:o.prototype[e]=function(n=0){return this.slice(n,n+t[e])[e](0)}})(e)}(),o.prototype._isBufferList=function(t){return t instanceof o||o.isBufferList(t)},o.isBufferList=function(t){return null!=t&&t[i]},e.exports=o},{buffer:14}],12:[function(t,e,n){"use strict";const r=t("readable-stream").Duplex,i=t("inherits"),o=t("./BufferList");function s(t){if(!(this instanceof s))return new s(t);if("function"===typeof t){this._callback=t;const e=function(t){this._callback&&(this._callback(t),this._callback=null)}.bind(this);this.on("pipe",(function(t){t.on("error",e)})),this.on("unpipe",(function(t){t.removeListener("error",e)})),t=null}o._init.call(this,t),r.call(this)}i(s,r),Object.assign(s.prototype,o.prototype),s.prototype._new=function(t){return new s(t)},s.prototype._write=function(t,e,n){this._appendBuffer(t),"function"===typeof n&&n()},s.prototype._read=function(t){if(!this.length)return this.push(null);t=Math.min(t,this.length),this.push(this.slice(0,t)),this.consume(t)},s.prototype.end=function(t){r.prototype.end.call(this,t),this._callback&&(this._callback(null,this.slice()),this._callback=null)},s.prototype._destroy=function(t,e){this._bufs.length=0,this.length=0,e(t)},s.prototype._isBufferList=function(t){return t instanceof s||t instanceof o||s.isBufferList(t)},s.isBufferList=o.isBufferList,e.exports=s,e.exports.BufferListStream=s,e.exports.BufferList=o},{"./BufferList":11,inherits:21,"readable-stream":51}],13:[function(t,e,n){},{}],14:[function(t,e,n){(function(e){(function(){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */
"use strict";var e=t("base64-js"),r=t("ieee754");n.Buffer=a,n.SlowBuffer=y,n.INSPECT_MAX_BYTES=50;var i=2147483647;function o(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()}catch(e){return!1}}function s(t){if(t>i)throw new RangeError('The value "'+t+'" is invalid for option "size"');var e=new Uint8Array(t);return e.__proto__=a.prototype,e}function a(t,e,n){if("number"===typeof t){if("string"===typeof e)throw new TypeError('The "string" argument must be of type string. Received type number');return h(t)}return u(t,e,n)}function u(t,e,n){if("string"===typeof t)return f(t,e);if(ArrayBuffer.isView(t))return d(t);if(null==t)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t);if(Z(t,ArrayBuffer)||t&&Z(t.buffer,ArrayBuffer))return p(t,e,n);if("number"===typeof t)throw new TypeError('The "value" argument must not be of type number. Received type number');var r=t.valueOf&&t.valueOf();if(null!=r&&r!==t)return a.from(r,e,n);var i=g(t);if(i)return i;if("undefined"!==typeof Symbol&&null!=Symbol.toPrimitive&&"function"===typeof t[Symbol.toPrimitive])return a.from(t[Symbol.toPrimitive]("string"),e,n);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t)}function c(t){if("number"!==typeof t)throw new TypeError('"size" argument must be of type number');if(t<0)throw new RangeError('The value "'+t+'" is invalid for option "size"')}function l(t,e,n){return c(t),t<=0?s(t):void 0!==e?"string"===typeof n?s(t).fill(e,n):s(t).fill(e):s(t)}function h(t){return c(t),s(t<0?0:0|m(t))}function f(t,e){if("string"===typeof e&&""!==e||(e="utf8"),!a.isEncoding(e))throw new TypeError("Unknown encoding: "+e);var n=0|v(t,e),r=s(n),i=r.write(t,e);return i!==n&&(r=r.slice(0,i)),r}function d(t){for(var e=t.length<0?0:0|m(t.length),n=s(e),r=0;r<e;r+=1)n[r]=255&t[r];return n}function p(t,e,n){if(e<0||t.byteLength<e)throw new RangeError('"offset" is outside of buffer bounds');if(t.byteLength<e+(n||0))throw new RangeError('"length" is outside of buffer bounds');var r;return r=void 0===e&&void 0===n?new Uint8Array(t):void 0===n?new Uint8Array(t,e):new Uint8Array(t,e,n),r.__proto__=a.prototype,r}function g(t){if(a.isBuffer(t)){var e=0|m(t.length),n=s(e);return 0===n.length?n:(t.copy(n,0,0,e),n)}return void 0!==t.length?"number"!==typeof t.length||K(t.length)?s(0):d(t):"Buffer"===t.type&&Array.isArray(t.data)?d(t.data):void 0}function m(t){if(t>=i)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+i.toString(16)+" bytes");return 0|t}function y(t){return+t!=t&&(t=0),a.alloc(+t)}function v(t,e){if(a.isBuffer(t))return t.length;if(ArrayBuffer.isView(t)||Z(t,ArrayBuffer))return t.byteLength;if("string"!==typeof t)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof t);var n=t.length,r=arguments.length>2&&!0===arguments[2];if(!r&&0===n)return 0;for(var i=!1;;)switch(e){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":return W(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return X(t).length;default:if(i)return r?-1:W(t).length;e=(""+e).toLowerCase(),i=!0}}function b(t,e,n){var r=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if(n>>>=0,e>>>=0,n<=e)return"";t||(t="utf8");while(1)switch(t){case"hex":return D(this,e,n);case"utf8":case"utf-8":return P(this,e,n);case"ascii":return I(this,e,n);case"latin1":case"binary":return N(this,e,n);case"base64":return O(this,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return R(this,e,n);default:if(r)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),r=!0}}function _(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function w(t,e,n,r,i){if(0===t.length)return-1;if("string"===typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,K(n)&&(n=i?0:t.length-1),n<0&&(n=t.length+n),n>=t.length){if(i)return-1;n=t.length-1}else if(n<0){if(!i)return-1;n=0}if("string"===typeof e&&(e=a.from(e,r)),a.isBuffer(e))return 0===e.length?-1:x(t,e,n,r,i);if("number"===typeof e)return e&=255,"function"===typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(t,e,n):Uint8Array.prototype.lastIndexOf.call(t,e,n):x(t,[e],n,r,i);throw new TypeError("val must be string, number or Buffer")}function x(t,e,n,r,i){var o,s=1,a=t.length,u=e.length;if(void 0!==r&&(r=String(r).toLowerCase(),"ucs2"===r||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(t.length<2||e.length<2)return-1;s=2,a/=2,u/=2,n/=2}function c(t,e){return 1===s?t[e]:t.readUInt16BE(e*s)}if(i){var l=-1;for(o=n;o<a;o++)if(c(t,o)===c(e,-1===l?0:o-l)){if(-1===l&&(l=o),o-l+1===u)return l*s}else-1!==l&&(o-=o-l),l=-1}else for(n+u>a&&(n=a-u),o=n;o>=0;o--){for(var h=!0,f=0;f<u;f++)if(c(t,o+f)!==c(e,f)){h=!1;break}if(h)return o}return-1}function S(t,e,n,r){n=Number(n)||0;var i=t.length-n;r?(r=Number(r),r>i&&(r=i)):r=i;var o=e.length;r>o/2&&(r=o/2);for(var s=0;s<r;++s){var a=parseInt(e.substr(2*s,2),16);if(K(a))return s;t[n+s]=a}return s}function E(t,e,n,r){return Y(W(e,t.length-n),t,n,r)}function A(t,e,n,r){return Y(G(e),t,n,r)}function M(t,e,n,r){return A(t,e,n,r)}function C(t,e,n,r){return Y(X(e),t,n,r)}function k(t,e,n,r){return Y(H(e,t.length-n),t,n,r)}function O(t,n,r){return 0===n&&r===t.length?e.fromByteArray(t):e.fromByteArray(t.slice(n,r))}function P(t,e,n){n=Math.min(t.length,n);var r=[],i=e;while(i<n){var o,s,a,u,c=t[i],l=null,h=c>239?4:c>223?3:c>191?2:1;if(i+h<=n)switch(h){case 1:c<128&&(l=c);break;case 2:o=t[i+1],128===(192&o)&&(u=(31&c)<<6|63&o,u>127&&(l=u));break;case 3:o=t[i+1],s=t[i+2],128===(192&o)&&128===(192&s)&&(u=(15&c)<<12|(63&o)<<6|63&s,u>2047&&(u<55296||u>57343)&&(l=u));break;case 4:o=t[i+1],s=t[i+2],a=t[i+3],128===(192&o)&&128===(192&s)&&128===(192&a)&&(u=(15&c)<<18|(63&o)<<12|(63&s)<<6|63&a,u>65535&&u<1114112&&(l=u))}null===l?(l=65533,h=1):l>65535&&(l-=65536,r.push(l>>>10&1023|55296),l=56320|1023&l),r.push(l),i+=h}return L(r)}n.kMaxLength=i,a.TYPED_ARRAY_SUPPORT=o(),a.TYPED_ARRAY_SUPPORT||"undefined"===typeof console||"function"!==typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(a.prototype,"parent",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.buffer}}),Object.defineProperty(a.prototype,"offset",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.byteOffset}}),"undefined"!==typeof Symbol&&null!=Symbol.species&&a[Symbol.species]===a&&Object.defineProperty(a,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),a.poolSize=8192,a.from=function(t,e,n){return u(t,e,n)},a.prototype.__proto__=Uint8Array.prototype,a.__proto__=Uint8Array,a.alloc=function(t,e,n){return l(t,e,n)},a.allocUnsafe=function(t){return h(t)},a.allocUnsafeSlow=function(t){return h(t)},a.isBuffer=function(t){return null!=t&&!0===t._isBuffer&&t!==a.prototype},a.compare=function(t,e){if(Z(t,Uint8Array)&&(t=a.from(t,t.offset,t.byteLength)),Z(e,Uint8Array)&&(e=a.from(e,e.offset,e.byteLength)),!a.isBuffer(t)||!a.isBuffer(e))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(t===e)return 0;for(var n=t.length,r=e.length,i=0,o=Math.min(n,r);i<o;++i)if(t[i]!==e[i]){n=t[i],r=e[i];break}return n<r?-1:r<n?1:0},a.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},a.concat=function(t,e){if(!Array.isArray(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return a.alloc(0);var n;if(void 0===e)for(e=0,n=0;n<t.length;++n)e+=t[n].length;var r=a.allocUnsafe(e),i=0;for(n=0;n<t.length;++n){var o=t[n];if(Z(o,Uint8Array)&&(o=a.from(o)),!a.isBuffer(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(r,i),i+=o.length}return r},a.byteLength=v,a.prototype._isBuffer=!0,a.prototype.swap16=function(){var t=this.length;if(t%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)_(this,e,e+1);return this},a.prototype.swap32=function(){var t=this.length;if(t%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)_(this,e,e+3),_(this,e+1,e+2);return this},a.prototype.swap64=function(){var t=this.length;if(t%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)_(this,e,e+7),_(this,e+1,e+6),_(this,e+2,e+5),_(this,e+3,e+4);return this},a.prototype.toString=function(){var t=this.length;return 0===t?"":0===arguments.length?P(this,0,t):b.apply(this,arguments)},a.prototype.toLocaleString=a.prototype.toString,a.prototype.equals=function(t){if(!a.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===a.compare(this,t)},a.prototype.inspect=function(){var t="",e=n.INSPECT_MAX_BYTES;return t=this.toString("hex",0,e).replace(/(.{2})/g,"$1 ").trim(),this.length>e&&(t+=" ... "),"<Buffer "+t+">"},a.prototype.compare=function(t,e,n,r,i){if(Z(t,Uint8Array)&&(t=a.from(t,t.offset,t.byteLength)),!a.isBuffer(t))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof t);if(void 0===e&&(e=0),void 0===n&&(n=t?t.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),e<0||n>t.length||r<0||i>this.length)throw new RangeError("out of range index");if(r>=i&&e>=n)return 0;if(r>=i)return-1;if(e>=n)return 1;if(e>>>=0,n>>>=0,r>>>=0,i>>>=0,this===t)return 0;for(var o=i-r,s=n-e,u=Math.min(o,s),c=this.slice(r,i),l=t.slice(e,n),h=0;h<u;++h)if(c[h]!==l[h]){o=c[h],s=l[h];break}return o<s?-1:s<o?1:0},a.prototype.includes=function(t,e,n){return-1!==this.indexOf(t,e,n)},a.prototype.indexOf=function(t,e,n){return w(this,t,e,n,!0)},a.prototype.lastIndexOf=function(t,e,n){return w(this,t,e,n,!1)},a.prototype.write=function(t,e,n,r){if(void 0===e)r="utf8",n=this.length,e=0;else if(void 0===n&&"string"===typeof e)r=e,n=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e>>>=0,isFinite(n)?(n>>>=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var i=this.length-e;if((void 0===n||n>i)&&(n=i),t.length>0&&(n<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var o=!1;;)switch(r){case"hex":return S(this,t,e,n);case"utf8":case"utf-8":return E(this,t,e,n);case"ascii":return A(this,t,e,n);case"latin1":case"binary":return M(this,t,e,n);case"base64":return C(this,t,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return k(this,t,e,n);default:if(o)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),o=!0}},a.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var T=4096;function L(t){var e=t.length;if(e<=T)return String.fromCharCode.apply(String,t);var n="",r=0;while(r<e)n+=String.fromCharCode.apply(String,t.slice(r,r+=T));return n}function I(t,e,n){var r="";n=Math.min(t.length,n);for(var i=e;i<n;++i)r+=String.fromCharCode(127&t[i]);return r}function N(t,e,n){var r="";n=Math.min(t.length,n);for(var i=e;i<n;++i)r+=String.fromCharCode(t[i]);return r}function D(t,e,n){var r=t.length;(!e||e<0)&&(e=0),(!n||n<0||n>r)&&(n=r);for(var i="",o=e;o<n;++o)i+=q(t[o]);return i}function R(t,e,n){for(var r=t.slice(e,n),i="",o=0;o<r.length;o+=2)i+=String.fromCharCode(r[o]+256*r[o+1]);return i}function F(t,e,n){if(t%1!==0||t<0)throw new RangeError("offset is not uint");if(t+e>n)throw new RangeError("Trying to access beyond buffer length")}function B(t,e,n,r,i,o){if(!a.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>i||e<o)throw new RangeError('"value" argument is out of bounds');if(n+r>t.length)throw new RangeError("Index out of range")}function j(t,e,n,r,i,o){if(n+r>t.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function z(t,e,n,i,o){return e=+e,n>>>=0,o||j(t,e,n,4,34028234663852886e22,-34028234663852886e22),r.write(t,e,n,i,23,4),n+4}function U(t,e,n,i,o){return e=+e,n>>>=0,o||j(t,e,n,8,17976931348623157e292,-17976931348623157e292),r.write(t,e,n,i,52,8),n+8}a.prototype.slice=function(t,e){var n=this.length;t=~~t,e=void 0===e?n:~~e,t<0?(t+=n,t<0&&(t=0)):t>n&&(t=n),e<0?(e+=n,e<0&&(e=0)):e>n&&(e=n),e<t&&(e=t);var r=this.subarray(t,e);return r.__proto__=a.prototype,r},a.prototype.readUIntLE=function(t,e,n){t>>>=0,e>>>=0,n||F(t,e,this.length);var r=this[t],i=1,o=0;while(++o<e&&(i*=256))r+=this[t+o]*i;return r},a.prototype.readUIntBE=function(t,e,n){t>>>=0,e>>>=0,n||F(t,e,this.length);var r=this[t+--e],i=1;while(e>0&&(i*=256))r+=this[t+--e]*i;return r},a.prototype.readUInt8=function(t,e){return t>>>=0,e||F(t,1,this.length),this[t]},a.prototype.readUInt16LE=function(t,e){return t>>>=0,e||F(t,2,this.length),this[t]|this[t+1]<<8},a.prototype.readUInt16BE=function(t,e){return t>>>=0,e||F(t,2,this.length),this[t]<<8|this[t+1]},a.prototype.readUInt32LE=function(t,e){return t>>>=0,e||F(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},a.prototype.readUInt32BE=function(t,e){return t>>>=0,e||F(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},a.prototype.readIntLE=function(t,e,n){t>>>=0,e>>>=0,n||F(t,e,this.length);var r=this[t],i=1,o=0;while(++o<e&&(i*=256))r+=this[t+o]*i;return i*=128,r>=i&&(r-=Math.pow(2,8*e)),r},a.prototype.readIntBE=function(t,e,n){t>>>=0,e>>>=0,n||F(t,e,this.length);var r=e,i=1,o=this[t+--r];while(r>0&&(i*=256))o+=this[t+--r]*i;return i*=128,o>=i&&(o-=Math.pow(2,8*e)),o},a.prototype.readInt8=function(t,e){return t>>>=0,e||F(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},a.prototype.readInt16LE=function(t,e){t>>>=0,e||F(t,2,this.length);var n=this[t]|this[t+1]<<8;return 32768&n?4294901760|n:n},a.prototype.readInt16BE=function(t,e){t>>>=0,e||F(t,2,this.length);var n=this[t+1]|this[t]<<8;return 32768&n?4294901760|n:n},a.prototype.readInt32LE=function(t,e){return t>>>=0,e||F(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},a.prototype.readInt32BE=function(t,e){return t>>>=0,e||F(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},a.prototype.readFloatLE=function(t,e){return t>>>=0,e||F(t,4,this.length),r.read(this,t,!0,23,4)},a.prototype.readFloatBE=function(t,e){return t>>>=0,e||F(t,4,this.length),r.read(this,t,!1,23,4)},a.prototype.readDoubleLE=function(t,e){return t>>>=0,e||F(t,8,this.length),r.read(this,t,!0,52,8)},a.prototype.readDoubleBE=function(t,e){return t>>>=0,e||F(t,8,this.length),r.read(this,t,!1,52,8)},a.prototype.writeUIntLE=function(t,e,n,r){if(t=+t,e>>>=0,n>>>=0,!r){var i=Math.pow(2,8*n)-1;B(this,t,e,n,i,0)}var o=1,s=0;this[e]=255&t;while(++s<n&&(o*=256))this[e+s]=t/o&255;return e+n},a.prototype.writeUIntBE=function(t,e,n,r){if(t=+t,e>>>=0,n>>>=0,!r){var i=Math.pow(2,8*n)-1;B(this,t,e,n,i,0)}var o=n-1,s=1;this[e+o]=255&t;while(--o>=0&&(s*=256))this[e+o]=t/s&255;return e+n},a.prototype.writeUInt8=function(t,e,n){return t=+t,e>>>=0,n||B(this,t,e,1,255,0),this[e]=255&t,e+1},a.prototype.writeUInt16LE=function(t,e,n){return t=+t,e>>>=0,n||B(this,t,e,2,65535,0),this[e]=255&t,this[e+1]=t>>>8,e+2},a.prototype.writeUInt16BE=function(t,e,n){return t=+t,e>>>=0,n||B(this,t,e,2,65535,0),this[e]=t>>>8,this[e+1]=255&t,e+2},a.prototype.writeUInt32LE=function(t,e,n){return t=+t,e>>>=0,n||B(this,t,e,4,4294967295,0),this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t,e+4},a.prototype.writeUInt32BE=function(t,e,n){return t=+t,e>>>=0,n||B(this,t,e,4,4294967295,0),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},a.prototype.writeIntLE=function(t,e,n,r){if(t=+t,e>>>=0,!r){var i=Math.pow(2,8*n-1);B(this,t,e,n,i-1,-i)}var o=0,s=1,a=0;this[e]=255&t;while(++o<n&&(s*=256))t<0&&0===a&&0!==this[e+o-1]&&(a=1),this[e+o]=(t/s>>0)-a&255;return e+n},a.prototype.writeIntBE=function(t,e,n,r){if(t=+t,e>>>=0,!r){var i=Math.pow(2,8*n-1);B(this,t,e,n,i-1,-i)}var o=n-1,s=1,a=0;this[e+o]=255&t;while(--o>=0&&(s*=256))t<0&&0===a&&0!==this[e+o+1]&&(a=1),this[e+o]=(t/s>>0)-a&255;return e+n},a.prototype.writeInt8=function(t,e,n){return t=+t,e>>>=0,n||B(this,t,e,1,127,-128),t<0&&(t=255+t+1),this[e]=255&t,e+1},a.prototype.writeInt16LE=function(t,e,n){return t=+t,e>>>=0,n||B(this,t,e,2,32767,-32768),this[e]=255&t,this[e+1]=t>>>8,e+2},a.prototype.writeInt16BE=function(t,e,n){return t=+t,e>>>=0,n||B(this,t,e,2,32767,-32768),this[e]=t>>>8,this[e+1]=255&t,e+2},a.prototype.writeInt32LE=function(t,e,n){return t=+t,e>>>=0,n||B(this,t,e,4,2147483647,-2147483648),this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24,e+4},a.prototype.writeInt32BE=function(t,e,n){return t=+t,e>>>=0,n||B(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},a.prototype.writeFloatLE=function(t,e,n){return z(this,t,e,!0,n)},a.prototype.writeFloatBE=function(t,e,n){return z(this,t,e,!1,n)},a.prototype.writeDoubleLE=function(t,e,n){return U(this,t,e,!0,n)},a.prototype.writeDoubleBE=function(t,e,n){return U(this,t,e,!1,n)},a.prototype.copy=function(t,e,n,r){if(!a.isBuffer(t))throw new TypeError("argument should be a Buffer");if(n||(n=0),r||0===r||(r=this.length),e>=t.length&&(e=t.length),e||(e=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),t.length-e<r-n&&(r=t.length-e+n);var i=r-n;if(this===t&&"function"===typeof Uint8Array.prototype.copyWithin)this.copyWithin(e,n,r);else if(this===t&&n<e&&e<r)for(var o=i-1;o>=0;--o)t[o+e]=this[o+n];else Uint8Array.prototype.set.call(t,this.subarray(n,r),e);return i},a.prototype.fill=function(t,e,n,r){if("string"===typeof t){if("string"===typeof e?(r=e,e=0,n=this.length):"string"===typeof n&&(r=n,n=this.length),void 0!==r&&"string"!==typeof r)throw new TypeError("encoding must be a string");if("string"===typeof r&&!a.isEncoding(r))throw new TypeError("Unknown encoding: "+r);if(1===t.length){var i=t.charCodeAt(0);("utf8"===r&&i<128||"latin1"===r)&&(t=i)}}else"number"===typeof t&&(t&=255);if(e<0||this.length<e||this.length<n)throw new RangeError("Out of range index");if(n<=e)return this;var o;if(e>>>=0,n=void 0===n?this.length:n>>>0,t||(t=0),"number"===typeof t)for(o=e;o<n;++o)this[o]=t;else{var s=a.isBuffer(t)?t:a.from(t,r),u=s.length;if(0===u)throw new TypeError('The value "'+t+'" is invalid for argument "value"');for(o=0;o<n-e;++o)this[o+e]=s[o%u]}return this};var $=/[^+/0-9A-Za-z-_]/g;function V(t){if(t=t.split("=")[0],t=t.trim().replace($,""),t.length<2)return"";while(t.length%4!==0)t+="=";return t}function q(t){return t<16?"0"+t.toString(16):t.toString(16)}function W(t,e){var n;e=e||1/0;for(var r=t.length,i=null,o=[],s=0;s<r;++s){if(n=t.charCodeAt(s),n>55295&&n<57344){if(!i){if(n>56319){(e-=3)>-1&&o.push(239,191,189);continue}if(s+1===r){(e-=3)>-1&&o.push(239,191,189);continue}i=n;continue}if(n<56320){(e-=3)>-1&&o.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(e-=3)>-1&&o.push(239,191,189);if(i=null,n<128){if((e-=1)<0)break;o.push(n)}else if(n<2048){if((e-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((e-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function G(t){for(var e=[],n=0;n<t.length;++n)e.push(255&t.charCodeAt(n));return e}function H(t,e){for(var n,r,i,o=[],s=0;s<t.length;++s){if((e-=2)<0)break;n=t.charCodeAt(s),r=n>>8,i=n%256,o.push(i),o.push(r)}return o}function X(t){return e.toByteArray(V(t))}function Y(t,e,n,r){for(var i=0;i<r;++i){if(i+n>=e.length||i>=t.length)break;e[i+n]=t[i]}return i}function Z(t,e){return t instanceof e||null!=t&&null!=t.constructor&&null!=t.constructor.name&&t.constructor.name===e.name}function K(t){return t!==t}}).call(this)}).call(this,t("buffer").Buffer)},{"base64-js":10,buffer:14,ieee754:20}],15:[function(t,e,n){(function(r){(function(){function i(){return!("undefined"===typeof window||!window.process||"renderer"!==window.process.type&&!window.process.__nwjs)||("undefined"===typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!==typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!==typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))}function o(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const n="color: "+this.color;t.splice(1,0,n,"color: inherit");let r=0,i=0;t[0].replace(/%[a-zA-Z%]/g,t=>{"%%"!==t&&(r++,"%c"===t&&(i=r))}),t.splice(i,0,n)}function s(t){try{t?n.storage.setItem("debug",t):n.storage.removeItem("debug")}catch(e){}}function a(){let t;try{t=n.storage.getItem("debug")}catch(e){}return!t&&"undefined"!==typeof r&&"env"in r&&(t=r.env.DEBUG),t}function u(){try{return localStorage}catch(t){}}n.formatArgs=o,n.save=s,n.load=a,n.useColors=i,n.storage=u(),n.destroy=(()=>{let t=!1;return()=>{t||(t=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),n.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],n.log=console.debug||console.log||(()=>{}),e.exports=t("./common")(n);const{formatters:c}=e.exports;c.j=function(t){try{return JSON.stringify(t)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}}).call(this)}).call(this,t("_process"))},{"./common":16,_process:32}],16:[function(t,e,n){function r(e){function n(t){let e=0;for(let n=0;n<t.length;n++)e=(e<<5)-e+t.charCodeAt(n),e|=0;return r.colors[Math.abs(e)%r.colors.length]}function r(t){let e,n=null;function o(...t){if(!o.enabled)return;const n=o,i=Number(new Date),s=i-(e||i);n.diff=s,n.prev=e,n.curr=i,e=i,t[0]=r.coerce(t[0]),"string"!==typeof t[0]&&t.unshift("%O");let a=0;t[0]=t[0].replace(/%([a-zA-Z%])/g,(e,i)=>{if("%%"===e)return"%";a++;const o=r.formatters[i];if("function"===typeof o){const r=t[a];e=o.call(n,r),t.splice(a,1),a--}return e}),r.formatArgs.call(n,t);const u=n.log||r.log;u.apply(n,t)}return o.namespace=t,o.useColors=r.useColors(),o.color=r.selectColor(t),o.extend=i,o.destroy=r.destroy,Object.defineProperty(o,"enabled",{enumerable:!0,configurable:!1,get:()=>null===n?r.enabled(t):n,set:t=>{n=t}}),"function"===typeof r.init&&r.init(o),o}function i(t,e){const n=r(this.namespace+("undefined"===typeof e?":":e)+t);return n.log=this.log,n}function o(t){let e;r.save(t),r.names=[],r.skips=[];const n=("string"===typeof t?t:"").split(/[\s,]+/),i=n.length;for(e=0;e<i;e++)n[e]&&(t=n[e].replace(/\*/g,".*?"),"-"===t[0]?r.skips.push(new RegExp("^"+t.substr(1)+"$")):r.names.push(new RegExp("^"+t+"$")))}function s(){const t=[...r.names.map(u),...r.skips.map(u).map(t=>"-"+t)].join(",");return r.enable(""),t}function a(t){if("*"===t[t.length-1])return!0;let e,n;for(e=0,n=r.skips.length;e<n;e++)if(r.skips[e].test(t))return!1;for(e=0,n=r.names.length;e<n;e++)if(r.names[e].test(t))return!0;return!1}function u(t){return t.toString().substring(2,t.toString().length-2).replace(/\.\*\?$/,"*")}function c(t){return t instanceof Error?t.stack||t.message:t}function l(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return r.debug=r,r.default=r,r.coerce=c,r.disable=s,r.enable=o,r.enabled=a,r.humanize=t("ms"),r.destroy=l,Object.keys(e).forEach(t=>{r[t]=e[t]}),r.names=[],r.skips=[],r.formatters={},r.selectColor=n,r.enable(r.load()),r}e.exports=r},{ms:29}],17:[function(t,e,n){(function(n,r){(function(){var i=t("readable-stream"),o=t("end-of-stream"),s=t("inherits"),a=t("stream-shift"),u=r.from&&r.from!==Uint8Array.from?r.from([0]):new r([0]),c=function(t,e){t._corked?t.once("uncork",e):e()},l=function(t,e){t._autoDestroy&&t.destroy(e)},h=function(t,e){return function(n){n?l(t,"premature close"===n.message?null:n):e&&!t._ended&&t.end()}},f=function(t,e){return t?t._writableState&&t._writableState.finished?e():t._writableState?t.end(e):(t.end(),void e()):e()},d=function(){},p=function(t){return new i.Readable({objectMode:!0,highWaterMark:16}).wrap(t)},g=function(t,e,n){if(!(this instanceof g))return new g(t,e,n);i.Duplex.call(this,n),this._writable=null,this._readable=null,this._readable2=null,this._autoDestroy=!n||!1!==n.autoDestroy,this._forwardDestroy=!n||!1!==n.destroy,this._forwardEnd=!n||!1!==n.end,this._corked=1,this._ondrain=null,this._drained=!1,this._forwarding=!1,this._unwrite=null,this._unread=null,this._ended=!1,this.destroyed=!1,t&&this.setWritable(t),e&&this.setReadable(e)};s(g,i.Duplex),g.obj=function(t,e,n){return n||(n={}),n.objectMode=!0,n.highWaterMark=16,new g(t,e,n)},g.prototype.cork=function(){1===++this._corked&&this.emit("cork")},g.prototype.uncork=function(){this._corked&&0===--this._corked&&this.emit("uncork")},g.prototype.setWritable=function(t){if(this._unwrite&&this._unwrite(),this.destroyed)t&&t.destroy&&t.destroy();else if(null!==t&&!1!==t){var e=this,r=o(t,{writable:!0,readable:!1},h(this,this._forwardEnd)),i=function(){var t=e._ondrain;e._ondrain=null,t&&t()},s=function(){e._writable.removeListener("drain",i),r()};this._unwrite&&n.nextTick(i),this._writable=t,this._writable.on("drain",i),this._unwrite=s,this.uncork()}else this.end()},g.prototype.setReadable=function(t){if(this._unread&&this._unread(),this.destroyed)t&&t.destroy&&t.destroy();else{if(null===t||!1===t)return this.push(null),void this.resume();var e=this,n=o(t,{writable:!1,readable:!0},h(this)),r=function(){e._forward()},i=function(){e.push(null)},s=function(){e._readable2.removeListener("readable",r),e._readable2.removeListener("end",i),n()};this._drained=!0,this._readable=t,this._readable2=t._readableState?t:p(t),this._readable2.on("readable",r),this._readable2.on("end",i),this._unread=s,this._forward()}},g.prototype._read=function(){this._drained=!0,this._forward()},g.prototype._forward=function(){if(!this._forwarding&&this._readable2&&this._drained){var t;this._forwarding=!0;while(this._drained&&null!==(t=a(this._readable2)))this.destroyed||(this._drained=this.push(t));this._forwarding=!1}},g.prototype.destroy=function(t,e){if(e||(e=d),this.destroyed)return e(null);this.destroyed=!0;var r=this;n.nextTick((function(){r._destroy(t),e(null)}))},g.prototype._destroy=function(t){if(t){var e=this._ondrain;this._ondrain=null,e?e(t):this.emit("error",t)}this._forwardDestroy&&(this._readable&&this._readable.destroy&&this._readable.destroy(),this._writable&&this._writable.destroy&&this._writable.destroy()),this.emit("close")},g.prototype._write=function(t,e,n){if(!this.destroyed)return this._corked?c(this,this._write.bind(this,t,e,n)):t===u?this._finish(n):this._writable?void(!1===this._writable.write(t)?this._ondrain=n:this.destroyed||n()):n()},g.prototype._finish=function(t){var e=this;this.emit("preend"),c(this,(function(){f(e._forwardEnd&&e._writable,(function(){!1===e._writableState.prefinished&&(e._writableState.prefinished=!0),e.emit("prefinish"),c(e,t)}))}))},g.prototype.end=function(t,e,n){return"function"===typeof t?this.end(null,null,t):"function"===typeof e?this.end(t,null,e):(this._ended=!0,t&&this.write(t),this._writableState.ending||this.write(u),i.Writable.prototype.end.call(this,n))},e.exports=g}).call(this)}).call(this,t("_process"),t("buffer").Buffer)},{_process:32,buffer:14,"end-of-stream":18,inherits:21,"readable-stream":51,"stream-shift":54}],18:[function(t,e,n){(function(n){(function(){var r=t("once"),i=function(){},o=function(t){return t.setHeader&&"function"===typeof t.abort},s=function(t){return t.stdio&&Array.isArray(t.stdio)&&3===t.stdio.length},a=function(t,e,u){if("function"===typeof e)return a(t,null,e);e||(e={}),u=r(u||i);var c=t._writableState,l=t._readableState,h=e.readable||!1!==e.readable&&t.readable,f=e.writable||!1!==e.writable&&t.writable,d=!1,p=function(){t.writable||g()},g=function(){f=!1,h||u.call(t)},m=function(){h=!1,f||u.call(t)},y=function(e){u.call(t,e?new Error("exited with error code: "+e):null)},v=function(e){u.call(t,e)},b=function(){n.nextTick(_)},_=function(){if(!d)return(!h||l&&l.ended&&!l.destroyed)&&(!f||c&&c.ended&&!c.destroyed)?void 0:u.call(t,new Error("premature close"))},w=function(){t.req.on("finish",g)};return o(t)?(t.on("complete",g),t.on("abort",b),t.req?w():t.on("request",w)):f&&!c&&(t.on("end",p),t.on("close",p)),s(t)&&t.on("exit",y),t.on("end",m),t.on("finish",g),!1!==e.error&&t.on("error",v),t.on("close",b),function(){d=!0,t.removeListener("complete",g),t.removeListener("abort",b),t.removeListener("request",w),t.req&&t.req.removeListener("finish",g),t.removeListener("end",p),t.removeListener("close",p),t.removeListener("finish",g),t.removeListener("exit",y),t.removeListener("end",m),t.removeListener("error",v),t.removeListener("close",b)}};e.exports=a}).call(this)}).call(this,t("_process"))},{_process:32,once:30}],19:[function(t,e,n){var r=Object.create||E,i=Object.keys||A,o=Function.prototype.bind||M;function s(){this._events&&Object.prototype.hasOwnProperty.call(this,"_events")||(this._events=r(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0}e.exports=s,s.EventEmitter=s,s.prototype._events=void 0,s.prototype._maxListeners=void 0;var a,u=10;try{var c={};Object.defineProperty&&Object.defineProperty(c,"x",{value:0}),a=0===c.x}catch(C){a=!1}function l(t){return void 0===t._maxListeners?s.defaultMaxListeners:t._maxListeners}function h(t,e,n){if(e)t.call(n);else for(var r=t.length,i=x(t,r),o=0;o<r;++o)i[o].call(n)}function f(t,e,n,r){if(e)t.call(n,r);else for(var i=t.length,o=x(t,i),s=0;s<i;++s)o[s].call(n,r)}function d(t,e,n,r,i){if(e)t.call(n,r,i);else for(var o=t.length,s=x(t,o),a=0;a<o;++a)s[a].call(n,r,i)}function p(t,e,n,r,i,o){if(e)t.call(n,r,i,o);else for(var s=t.length,a=x(t,s),u=0;u<s;++u)a[u].call(n,r,i,o)}function g(t,e,n,r){if(e)t.apply(n,r);else for(var i=t.length,o=x(t,i),s=0;s<i;++s)o[s].apply(n,r)}function m(t,e,n,i){var o,s,a;if("function"!==typeof n)throw new TypeError('"listener" argument must be a function');if(s=t._events,s?(s.newListener&&(t.emit("newListener",e,n.listener?n.listener:n),s=t._events),a=s[e]):(s=t._events=r(null),t._eventsCount=0),a){if("function"===typeof a?a=s[e]=i?[n,a]:[a,n]:i?a.unshift(n):a.push(n),!a.warned&&(o=l(t),o&&o>0&&a.length>o)){a.warned=!0;var u=new Error("Possible EventEmitter memory leak detected. "+a.length+' "'+String(e)+'" listeners added. Use emitter.setMaxListeners() to increase limit.');u.name="MaxListenersExceededWarning",u.emitter=t,u.type=e,u.count=a.length,"object"===typeof console&&console.warn&&console.warn("%s: %s",u.name,u.message)}}else a=s[e]=n,++t._eventsCount;return t}function y(){if(!this.fired)switch(this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length){case 0:return this.listener.call(this.target);case 1:return this.listener.call(this.target,arguments[0]);case 2:return this.listener.call(this.target,arguments[0],arguments[1]);case 3:return this.listener.call(this.target,arguments[0],arguments[1],arguments[2]);default:for(var t=new Array(arguments.length),e=0;e<t.length;++e)t[e]=arguments[e];this.listener.apply(this.target,t)}}function v(t,e,n){var r={fired:!1,wrapFn:void 0,target:t,type:e,listener:n},i=o.call(y,r);return i.listener=n,r.wrapFn=i,i}function b(t,e,n){var r=t._events;if(!r)return[];var i=r[e];return i?"function"===typeof i?n?[i.listener||i]:[i]:n?S(i):x(i,i.length):[]}function _(t){var e=this._events;if(e){var n=e[t];if("function"===typeof n)return 1;if(n)return n.length}return 0}function w(t,e){for(var n=e,r=n+1,i=t.length;r<i;n+=1,r+=1)t[n]=t[r];t.pop()}function x(t,e){for(var n=new Array(e),r=0;r<e;++r)n[r]=t[r];return n}function S(t){for(var e=new Array(t.length),n=0;n<e.length;++n)e[n]=t[n].listener||t[n];return e}function E(t){var e=function(){};return e.prototype=t,new e}function A(t){var e=[];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.push(n);return n}function M(t){var e=this;return function(){return e.apply(t,arguments)}}a?Object.defineProperty(s,"defaultMaxListeners",{enumerable:!0,get:function(){return u},set:function(t){if("number"!==typeof t||t<0||t!==t)throw new TypeError('"defaultMaxListeners" must be a positive number');u=t}}):s.defaultMaxListeners=u,s.prototype.setMaxListeners=function(t){if("number"!==typeof t||t<0||isNaN(t))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=t,this},s.prototype.getMaxListeners=function(){return l(this)},s.prototype.emit=function(t){var e,n,r,i,o,s,a="error"===t;if(s=this._events,s)a=a&&null==s.error;else if(!a)return!1;if(a){if(arguments.length>1&&(e=arguments[1]),e instanceof Error)throw e;var u=new Error('Unhandled "error" event. ('+e+")");throw u.context=e,u}if(n=s[t],!n)return!1;var c="function"===typeof n;switch(r=arguments.length,r){case 1:h(n,c,this);break;case 2:f(n,c,this,arguments[1]);break;case 3:d(n,c,this,arguments[1],arguments[2]);break;case 4:p(n,c,this,arguments[1],arguments[2],arguments[3]);break;default:for(i=new Array(r-1),o=1;o<r;o++)i[o-1]=arguments[o];g(n,c,this,i)}return!0},s.prototype.addListener=function(t,e){return m(this,t,e,!1)},s.prototype.on=s.prototype.addListener,s.prototype.prependListener=function(t,e){return m(this,t,e,!0)},s.prototype.once=function(t,e){if("function"!==typeof e)throw new TypeError('"listener" argument must be a function');return this.on(t,v(this,t,e)),this},s.prototype.prependOnceListener=function(t,e){if("function"!==typeof e)throw new TypeError('"listener" argument must be a function');return this.prependListener(t,v(this,t,e)),this},s.prototype.removeListener=function(t,e){var n,i,o,s,a;if("function"!==typeof e)throw new TypeError('"listener" argument must be a function');if(i=this._events,!i)return this;if(n=i[t],!n)return this;if(n===e||n.listener===e)0===--this._eventsCount?this._events=r(null):(delete i[t],i.removeListener&&this.emit("removeListener",t,n.listener||e));else if("function"!==typeof n){for(o=-1,s=n.length-1;s>=0;s--)if(n[s]===e||n[s].listener===e){a=n[s].listener,o=s;break}if(o<0)return this;0===o?n.shift():w(n,o),1===n.length&&(i[t]=n[0]),i.removeListener&&this.emit("removeListener",t,a||e)}return this},s.prototype.removeAllListeners=function(t){var e,n,o;if(n=this._events,!n)return this;if(!n.removeListener)return 0===arguments.length?(this._events=r(null),this._eventsCount=0):n[t]&&(0===--this._eventsCount?this._events=r(null):delete n[t]),this;if(0===arguments.length){var s,a=i(n);for(o=0;o<a.length;++o)s=a[o],"removeListener"!==s&&this.removeAllListeners(s);return this.removeAllListeners("removeListener"),this._events=r(null),this._eventsCount=0,this}if(e=n[t],"function"===typeof e)this.removeListener(t,e);else if(e)for(o=e.length-1;o>=0;o--)this.removeListener(t,e[o]);return this},s.prototype.listeners=function(t){return b(this,t,!0)},s.prototype.rawListeners=function(t){return b(this,t,!1)},s.listenerCount=function(t,e){return"function"===typeof t.listenerCount?t.listenerCount(e):_.call(t,e)},s.prototype.listenerCount=_,s.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]}},{}],20:[function(t,e,n){
/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */
n.read=function(t,e,n,r,i){var o,s,a=8*i-r-1,u=(1<<a)-1,c=u>>1,l=-7,h=n?i-1:0,f=n?-1:1,d=t[e+h];for(h+=f,o=d&(1<<-l)-1,d>>=-l,l+=a;l>0;o=256*o+t[e+h],h+=f,l-=8);for(s=o&(1<<-l)-1,o>>=-l,l+=r;l>0;s=256*s+t[e+h],h+=f,l-=8);if(0===o)o=1-c;else{if(o===u)return s?NaN:1/0*(d?-1:1);s+=Math.pow(2,r),o-=c}return(d?-1:1)*s*Math.pow(2,o-r)},n.write=function(t,e,n,r,i,o){var s,a,u,c=8*o-i-1,l=(1<<c)-1,h=l>>1,f=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,d=r?0:o-1,p=r?1:-1,g=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,s=l):(s=Math.floor(Math.log(e)/Math.LN2),e*(u=Math.pow(2,-s))<1&&(s--,u*=2),e+=s+h>=1?f/u:f*Math.pow(2,1-h),e*u>=2&&(s++,u/=2),s+h>=l?(a=0,s=l):s+h>=1?(a=(e*u-1)*Math.pow(2,i),s+=h):(a=e*Math.pow(2,h-1)*Math.pow(2,i),s=0));i>=8;t[n+d]=255&a,d+=p,a/=256,i-=8);for(s=s<<i|a,c+=i;c>0;t[n+d]=255&s,d+=p,s/=256,c-=8);t[n+d-p]|=128*g}},{}],21:[function(t,e,n){"function"===typeof Object.create?e.exports=function(t,e){e&&(t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}))}:e.exports=function(t,e){if(e){t.super_=e;var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}}},{}],22:[function(t,e,n){(function(t){(function(){const n=e.exports;n.types={0:"reserved",1:"connect",2:"connack",3:"publish",4:"puback",5:"pubrec",6:"pubrel",7:"pubcomp",8:"subscribe",9:"suback",10:"unsubscribe",11:"unsuback",12:"pingreq",13:"pingresp",14:"disconnect",15:"auth"},n.codes={};for(const t in n.types){const e=n.types[t];n.codes[e]=t}n.CMD_SHIFT=4,n.CMD_MASK=240,n.DUP_MASK=8,n.QOS_MASK=3,n.QOS_SHIFT=1,n.RETAIN_MASK=1,n.VARBYTEINT_MASK=127,n.VARBYTEINT_FIN_MASK=128,n.VARBYTEINT_MAX=268435455,n.SESSIONPRESENT_MASK=1,n.SESSIONPRESENT_HEADER=t.from([n.SESSIONPRESENT_MASK]),n.CONNACK_HEADER=t.from([n.codes.connack<<n.CMD_SHIFT]),n.USERNAME_MASK=128,n.PASSWORD_MASK=64,n.WILL_RETAIN_MASK=32,n.WILL_QOS_MASK=24,n.WILL_QOS_SHIFT=3,n.WILL_FLAG_MASK=4,n.CLEAN_SESSION_MASK=2,n.CONNECT_HEADER=t.from([n.codes.connect<<n.CMD_SHIFT]),n.properties={sessionExpiryInterval:17,willDelayInterval:24,receiveMaximum:33,maximumPacketSize:39,topicAliasMaximum:34,requestResponseInformation:25,requestProblemInformation:23,userProperties:38,authenticationMethod:21,authenticationData:22,payloadFormatIndicator:1,messageExpiryInterval:2,contentType:3,responseTopic:8,correlationData:9,maximumQoS:36,retainAvailable:37,assignedClientIdentifier:18,reasonString:31,wildcardSubscriptionAvailable:40,subscriptionIdentifiersAvailable:41,sharedSubscriptionAvailable:42,serverKeepAlive:19,responseInformation:26,serverReference:28,topicAlias:35,subscriptionIdentifier:11},n.propertiesCodes={};for(const t in n.properties){const e=n.properties[t];n.propertiesCodes[e]=t}function r(e){return[0,1,2].map(r=>{return[0,1].map(i=>{return[0,1].map(o=>{const s=t.alloc(1);return s.writeUInt8(n.codes[e]<<n.CMD_SHIFT|(i?n.DUP_MASK:0)|r<<n.QOS_SHIFT|o,0,!0),s})})})}n.propertiesTypes={sessionExpiryInterval:"int32",willDelayInterval:"int32",receiveMaximum:"int16",maximumPacketSize:"int32",topicAliasMaximum:"int16",requestResponseInformation:"byte",requestProblemInformation:"byte",userProperties:"pair",authenticationMethod:"string",authenticationData:"binary",payloadFormatIndicator:"byte",messageExpiryInterval:"int32",contentType:"string",responseTopic:"string",correlationData:"binary",maximumQoS:"int8",retainAvailable:"byte",assignedClientIdentifier:"string",reasonString:"string",wildcardSubscriptionAvailable:"byte",subscriptionIdentifiersAvailable:"byte",sharedSubscriptionAvailable:"byte",serverKeepAlive:"int16",responseInformation:"string",serverReference:"string",topicAlias:"int16",subscriptionIdentifier:"var"},n.PUBLISH_HEADER=r("publish"),n.SUBSCRIBE_HEADER=r("subscribe"),n.SUBSCRIBE_OPTIONS_QOS_MASK=3,n.SUBSCRIBE_OPTIONS_NL_MASK=1,n.SUBSCRIBE_OPTIONS_NL_SHIFT=2,n.SUBSCRIBE_OPTIONS_RAP_MASK=1,n.SUBSCRIBE_OPTIONS_RAP_SHIFT=3,n.SUBSCRIBE_OPTIONS_RH_MASK=3,n.SUBSCRIBE_OPTIONS_RH_SHIFT=4,n.SUBSCRIBE_OPTIONS_RH=[0,16,32],n.SUBSCRIBE_OPTIONS_NL=4,n.SUBSCRIBE_OPTIONS_RAP=8,n.SUBSCRIBE_OPTIONS_QOS=[0,1,2],n.UNSUBSCRIBE_HEADER=r("unsubscribe"),n.ACKS={unsuback:r("unsuback"),puback:r("puback"),pubcomp:r("pubcomp"),pubrel:r("pubrel"),pubrec:r("pubrec")},n.SUBACK_HEADER=t.from([n.codes.suback<<n.CMD_SHIFT]),n.VERSION3=t.from([3]),n.VERSION4=t.from([4]),n.VERSION5=t.from([5]),n.VERSION131=t.from([131]),n.VERSION132=t.from([132]),n.QOS=[0,1,2].map(e=>{return t.from([e])}),n.EMPTY={pingreq:t.from([n.codes.pingreq<<4,0]),pingresp:t.from([n.codes.pingresp<<4,0]),disconnect:t.from([n.codes.disconnect<<4,0])}}).call(this)}).call(this,t("buffer").Buffer)},{buffer:14}],23:[function(t,e,n){(function(n){(function(){const r=t("./writeToStream"),i=t("events");function o(t,e){const n=new s;return r(t,n,e),n.concat()}class s extends i{constructor(){super(),this._array=new Array(20),this._i=0}write(t){return this._array[this._i++]=t,!0}concat(){let t=0;const e=new Array(this._array.length),r=this._array;let i,o=0;for(i=0;i<r.length&&void 0!==r[i];i++)"string"!==typeof r[i]?e[i]=r[i].length:e[i]=n.byteLength(r[i]),t+=e[i];const s=n.allocUnsafe(t);for(i=0;i<r.length&&void 0!==r[i];i++)"string"!==typeof r[i]?(r[i].copy(s,o),o+=e[i]):(s.write(r[i],o),o+=e[i]);return s}}e.exports=o}).call(this)}).call(this,t("buffer").Buffer)},{"./writeToStream":28,buffer:14,events:19}],24:[function(t,e,n){n.parser=t("./parser").parser,n.generate=t("./generate"),n.writeToStream=t("./writeToStream")},{"./generate":23,"./parser":27,"./writeToStream":28}],25:[function(t,e,n){(function(t){(function(){const n=65536,r={},i=t.isBuffer(t.from([1,2]).subarray(0,1));function o(e){const n=t.allocUnsafe(2);return n.writeUInt8(e>>8,0),n.writeUInt8(255&e,1),n}function s(){for(let t=0;t<n;t++)r[t]=o(t)}function a(e){const n=4;let r=0,o=0;const s=t.allocUnsafe(n);do{r=e%128|0,e=e/128|0,e>0&&(r|=128),s.writeUInt8(r,o++)}while(e>0&&o<n);return e>0&&(o=0),i?s.subarray(0,o):s.slice(0,o)}function u(e){const n=t.allocUnsafe(4);return n.writeUInt32BE(e,0),n}e.exports={cache:r,generateCache:s,generateNumber:o,genBufVariableByteInt:a,generate4ByteBuffer:u}}).call(this)}).call(this,t("buffer").Buffer)},{buffer:14}],26:[function(t,e,n){class r{constructor(){this.cmd=null,this.retain=!1,this.qos=0,this.dup=!1,this.length=-1,this.topic=null,this.payload=null}}e.exports=r},{}],27:[function(t,e,n){const r=t("bl"),i=t("events"),o=t("./packet"),s=t("./constants"),a=t("debug")("mqtt-packet:parser");class u extends i{constructor(){super(),this.parser=this.constructor.parser}static parser(t){return this instanceof u?(this.settings=t||{},this._states=["_parseHeader","_parseLength","_parsePayload","_newPacket"],this._resetState(),this):(new u).parser(t)}_resetState(){a("_resetState: resetting packet, error, _list, and _stateCounter"),this.packet=new o,this.error=null,this._list=r(),this._stateCounter=0}parse(t){this.error&&this._resetState(),this._list.append(t),a("parse: current state: %s",this._states[this._stateCounter]);while((-1!==this.packet.length||this._list.length>0)&&this[this._states[this._stateCounter]]()&&!this.error)this._stateCounter++,a("parse: state complete. _stateCounter is now: %d",this._stateCounter),a("parse: packet.length: %d, buffer list length: %d",this.packet.length,this._list.length),this._stateCounter>=this._states.length&&(this._stateCounter=0);return a("parse: exited while loop. packet: %d, buffer list length: %d",this.packet.length,this._list.length),this._list.length}_parseHeader(){const t=this._list.readUInt8(0);return this.packet.cmd=s.types[t>>s.CMD_SHIFT],this.packet.retain=0!==(t&s.RETAIN_MASK),this.packet.qos=t>>s.QOS_SHIFT&s.QOS_MASK,this.packet.dup=0!==(t&s.DUP_MASK),a("_parseHeader: packet: %o",this.packet),this._list.consume(1),!0}_parseLength(){const t=this._parseVarByteNum(!0);return t&&(this.packet.length=t.value,this._list.consume(t.bytes)),a("_parseLength %d",t.value),!!t}_parsePayload(){a("_parsePayload: payload %O",this._list);let t=!1;if(0===this.packet.length||this._list.length>=this.packet.length){switch(this._pos=0,this.packet.cmd){case"connect":this._parseConnect();break;case"connack":this._parseConnack();break;case"publish":this._parsePublish();break;case"puback":case"pubrec":case"pubrel":case"pubcomp":this._parseConfirmation();break;case"subscribe":this._parseSubscribe();break;case"suback":this._parseSuback();break;case"unsubscribe":this._parseUnsubscribe();break;case"unsuback":this._parseUnsuback();break;case"pingreq":case"pingresp":break;case"disconnect":this._parseDisconnect();break;case"auth":this._parseAuth();break;default:this._emitError(new Error("Not supported"))}t=!0}return a("_parsePayload complete result: %s",t),t}_parseConnect(){let t,e,n,r;a("_parseConnect");const i={},o=this.packet,u=this._parseString();if(null===u)return this._emitError(new Error("Cannot parse protocolId"));if("MQTT"!==u&&"MQIsdp"!==u)return this._emitError(new Error("Invalid protocolId"));if(o.protocolId=u,this._pos>=this._list.length)return this._emitError(new Error("Packet too short"));if(o.protocolVersion=this._list.readUInt8(this._pos),o.protocolVersion>=128&&(o.bridgeMode=!0,o.protocolVersion=o.protocolVersion-128),3!==o.protocolVersion&&4!==o.protocolVersion&&5!==o.protocolVersion)return this._emitError(new Error("Invalid protocol version"));if(this._pos++,this._pos>=this._list.length)return this._emitError(new Error("Packet too short"));if(i.username=this._list.readUInt8(this._pos)&s.USERNAME_MASK,i.password=this._list.readUInt8(this._pos)&s.PASSWORD_MASK,i.will=this._list.readUInt8(this._pos)&s.WILL_FLAG_MASK,i.will&&(o.will={},o.will.retain=0!==(this._list.readUInt8(this._pos)&s.WILL_RETAIN_MASK),o.will.qos=(this._list.readUInt8(this._pos)&s.WILL_QOS_MASK)>>s.WILL_QOS_SHIFT),o.clean=0!==(this._list.readUInt8(this._pos)&s.CLEAN_SESSION_MASK),this._pos++,o.keepalive=this._parseNum(),-1===o.keepalive)return this._emitError(new Error("Packet too short"));if(5===o.protocolVersion){const t=this._parseProperties();Object.getOwnPropertyNames(t).length&&(o.properties=t)}const c=this._parseString();if(null===c)return this._emitError(new Error("Packet too short"));if(o.clientId=c,a("_parseConnect: packet.clientId: %s",o.clientId),i.will){if(5===o.protocolVersion){const t=this._parseProperties();Object.getOwnPropertyNames(t).length&&(o.will.properties=t)}if(t=this._parseString(),null===t)return this._emitError(new Error("Cannot parse will topic"));if(o.will.topic=t,a("_parseConnect: packet.will.topic: %s",o.will.topic),e=this._parseBuffer(),null===e)return this._emitError(new Error("Cannot parse will payload"));o.will.payload=e,a("_parseConnect: packet.will.paylaod: %s",o.will.payload)}if(i.username){if(r=this._parseString(),null===r)return this._emitError(new Error("Cannot parse username"));o.username=r,a("_parseConnect: packet.username: %s",o.username)}if(i.password){if(n=this._parseBuffer(),null===n)return this._emitError(new Error("Cannot parse password"));o.password=n}return this.settings=o,a("_parseConnect: complete"),o}_parseConnack(){a("_parseConnack");const t=this.packet;if(this._list.length<1)return null;if(t.sessionPresent=!!(this._list.readUInt8(this._pos++)&s.SESSIONPRESENT_MASK),5===this.settings.protocolVersion)this._list.length>=2?t.reasonCode=this._list.readUInt8(this._pos++):t.reasonCode=0;else{if(this._list.length<2)return null;t.returnCode=this._list.readUInt8(this._pos++)}if(-1===t.returnCode||-1===t.reasonCode)return this._emitError(new Error("Cannot parse return code"));if(5===this.settings.protocolVersion){const e=this._parseProperties();Object.getOwnPropertyNames(e).length&&(t.properties=e)}a("_parseConnack: complete")}_parsePublish(){a("_parsePublish");const t=this.packet;if(t.topic=this._parseString(),null===t.topic)return this._emitError(new Error("Cannot parse topic"));if(!(t.qos>0)||this._parseMessageId()){if(5===this.settings.protocolVersion){const e=this._parseProperties();Object.getOwnPropertyNames(e).length&&(t.properties=e)}t.payload=this._list.slice(this._pos,t.length),a("_parsePublish: payload from buffer list: %o",t.payload)}}_parseSubscribe(){a("_parseSubscribe");const t=this.packet;let e,n,r,i,o,u,c;if(1!==t.qos)return this._emitError(new Error("Wrong subscribe header"));if(t.subscriptions=[],this._parseMessageId()){if(5===this.settings.protocolVersion){const e=this._parseProperties();Object.getOwnPropertyNames(e).length&&(t.properties=e)}while(this._pos<t.length){if(e=this._parseString(),null===e)return this._emitError(new Error("Cannot parse topic"));if(this._pos>=t.length)return this._emitError(new Error("Malformed Subscribe Payload"));n=this._parseByte(),r=n&s.SUBSCRIBE_OPTIONS_QOS_MASK,u=0!==(n>>s.SUBSCRIBE_OPTIONS_NL_SHIFT&s.SUBSCRIBE_OPTIONS_NL_MASK),o=0!==(n>>s.SUBSCRIBE_OPTIONS_RAP_SHIFT&s.SUBSCRIBE_OPTIONS_RAP_MASK),i=n>>s.SUBSCRIBE_OPTIONS_RH_SHIFT&s.SUBSCRIBE_OPTIONS_RH_MASK,c={topic:e,qos:r},5===this.settings.protocolVersion?(c.nl=u,c.rap=o,c.rh=i):this.settings.bridgeMode&&(c.rh=0,c.rap=!0,c.nl=!0),a("_parseSubscribe: push subscription `%s` to subscription",c),t.subscriptions.push(c)}}}_parseSuback(){a("_parseSuback");const t=this.packet;if(this.packet.granted=[],this._parseMessageId()){if(5===this.settings.protocolVersion){const e=this._parseProperties();Object.getOwnPropertyNames(e).length&&(t.properties=e)}while(this._pos<this.packet.length)this.packet.granted.push(this._list.readUInt8(this._pos++))}}_parseUnsubscribe(){a("_parseUnsubscribe");const t=this.packet;if(t.unsubscriptions=[],this._parseMessageId()){if(5===this.settings.protocolVersion){const e=this._parseProperties();Object.getOwnPropertyNames(e).length&&(t.properties=e)}while(this._pos<t.length){const e=this._parseString();if(null===e)return this._emitError(new Error("Cannot parse topic"));a("_parseUnsubscribe: push topic `%s` to unsubscriptions",e),t.unsubscriptions.push(e)}}}_parseUnsuback(){a("_parseUnsuback");const t=this.packet;if(!this._parseMessageId())return this._emitError(new Error("Cannot parse messageId"));if(5===this.settings.protocolVersion){const e=this._parseProperties();Object.getOwnPropertyNames(e).length&&(t.properties=e),t.granted=[];while(this._pos<this.packet.length)this.packet.granted.push(this._list.readUInt8(this._pos++))}}_parseConfirmation(){a("_parseConfirmation: packet.cmd: `%s`",this.packet.cmd);const t=this.packet;if(this._parseMessageId(),5===this.settings.protocolVersion&&(t.length>2?(t.reasonCode=this._parseByte(),a("_parseConfirmation: packet.reasonCode `%d`",t.reasonCode)):t.reasonCode=0,t.length>3)){const e=this._parseProperties();Object.getOwnPropertyNames(e).length&&(t.properties=e)}return!0}_parseDisconnect(){const t=this.packet;if(a("_parseDisconnect"),5===this.settings.protocolVersion){this._list.length>0?t.reasonCode=this._parseByte():t.reasonCode=0;const e=this._parseProperties();Object.getOwnPropertyNames(e).length&&(t.properties=e)}return a("_parseDisconnect result: true"),!0}_parseAuth(){a("_parseAuth");const t=this.packet;if(5!==this.settings.protocolVersion)return this._emitError(new Error("Not supported auth packet for this version MQTT"));t.reasonCode=this._parseByte();const e=this._parseProperties();return Object.getOwnPropertyNames(e).length&&(t.properties=e),a("_parseAuth: result: true"),!0}_parseMessageId(){const t=this.packet;return t.messageId=this._parseNum(),null===t.messageId?(this._emitError(new Error("Cannot parse messageId")),!1):(a("_parseMessageId: packet.messageId %d",t.messageId),!0)}_parseString(t){const e=this._parseNum(),n=e+this._pos;if(-1===e||n>this._list.length||n>this.packet.length)return null;const r=this._list.toString("utf8",this._pos,n);return this._pos+=e,a("_parseString: result: %s",r),r}_parseStringPair(){return a("_parseStringPair"),{name:this._parseString(),value:this._parseString()}}_parseBuffer(){const t=this._parseNum(),e=t+this._pos;if(-1===t||e>this._list.length||e>this.packet.length)return null;const n=this._list.slice(this._pos,e);return this._pos+=t,a("_parseBuffer: result: %o",n),n}_parseNum(){if(this._list.length-this._pos<2)return-1;const t=this._list.readUInt16BE(this._pos);return this._pos+=2,a("_parseNum: result: %s",t),t}_parse4ByteNum(){if(this._list.length-this._pos<4)return-1;const t=this._list.readUInt32BE(this._pos);return this._pos+=4,a("_parse4ByteNum: result: %s",t),t}_parseVarByteNum(t){a("_parseVarByteNum");const e=4;let n,r=0,i=1,o=0,u=!1;const c=this._pos?this._pos:0;while(r<e&&c+r<this._list.length){if(n=this._list.readUInt8(c+r++),o+=i*(n&s.VARBYTEINT_MASK),i*=128,0===(n&s.VARBYTEINT_FIN_MASK)){u=!0;break}if(this._list.length<=r)break}return!u&&r===e&&this._list.length>=r&&this._emitError(new Error("Invalid variable byte integer")),c&&(this._pos+=r),u=!!u&&(t?{bytes:r,value:o}:o),a("_parseVarByteNum: result: %o",u),u}_parseByte(){let t;return this._pos<this._list.length&&(t=this._list.readUInt8(this._pos),this._pos++),a("_parseByte: result: %o",t),t}_parseByType(t){switch(a("_parseByType: type: %s",t),t){case"byte":return 0!==this._parseByte();case"int8":return this._parseByte();case"int16":return this._parseNum();case"int32":return this._parse4ByteNum();case"var":return this._parseVarByteNum();case"string":return this._parseString();case"pair":return this._parseStringPair();case"binary":return this._parseBuffer()}}_parseProperties(){a("_parseProperties");const t=this._parseVarByteNum(),e=this._pos,n=e+t,r={};while(this._pos<n){const t=this._parseByte();if(!t)return this._emitError(new Error("Cannot parse property code type")),!1;const e=s.propertiesCodes[t];if(!e)return this._emitError(new Error("Unknown property")),!1;if("userProperties"!==e)r[e]?Array.isArray(r[e])?r[e].push(this._parseByType(s.propertiesTypes[e])):(r[e]=[r[e]],r[e].push(this._parseByType(s.propertiesTypes[e]))):r[e]=this._parseByType(s.propertiesTypes[e]);else{r[e]||(r[e]=Object.create(null));const t=this._parseByType(s.propertiesTypes[e]);if(r[e][t.name])if(Array.isArray(r[e][t.name]))r[e][t.name].push(t.value);else{const n=r[e][t.name];r[e][t.name]=[n],r[e][t.name].push(t.value)}else r[e][t.name]=t.value}}return r}_newPacket(){return a("_newPacket"),this.packet&&(this._list.consume(this.packet.length),a("_newPacket: parser emit packet: packet.cmd: %s, packet.payload: %s, packet.length: %d",this.packet.cmd,this.packet.payload,this.packet.length),this.emit("packet",this.packet)),a("_newPacket: new packet"),this.packet=new o,this._pos=0,!0}_emitError(t){a("_emitError"),this.error=t,this.emit("error",t)}}e.exports=u},{"./constants":22,"./packet":26,bl:12,debug:15,events:19}],28:[function(t,e,n){(function(n){(function(){const r=t("./constants"),i=n.allocUnsafe(0),o=n.from([0]),s=t("./numbers"),a=t("process-nextick-args").nextTick,u=t("debug")("mqtt-packet:writeToStream"),c=s.cache,l=s.generateNumber,h=s.generateCache,f=s.genBufVariableByteInt,d=s.generate4ByteBuffer;let p=I,g=!0;function m(t,e,n){switch(u("generate called"),e.cork&&(e.cork(),a(y,e)),g&&(g=!1,h()),u("generate: packet.cmd: %s",t.cmd),t.cmd){case"connect":return v(t,e,n);case"connack":return b(t,e,n);case"publish":return _(t,e,n);case"puback":case"pubrec":case"pubrel":case"pubcomp":return w(t,e,n);case"subscribe":return x(t,e,n);case"suback":return S(t,e,n);case"unsubscribe":return E(t,e,n);case"unsuback":return A(t,e,n);case"pingreq":case"pingresp":return M(t,e,n);case"disconnect":return C(t,e,n);case"auth":return k(t,e,n);default:return e.emit("error",new Error("Unknown command")),!1}}function y(t){t.uncork()}function v(t,e,i){const o=t||{},s=o.protocolId||"MQTT";let a=o.protocolVersion||4;const u=o.will;let c=o.clean;const l=o.keepalive||0,h=o.clientId||"",f=o.username,d=o.password,g=o.properties;void 0===c&&(c=!0);let m=0;if(!s||"string"!==typeof s&&!n.isBuffer(s))return e.emit("error",new Error("Invalid protocolId")),!1;if(m+=s.length+2,3!==a&&4!==a&&5!==a)return e.emit("error",new Error("Invalid protocol version")),!1;if(m+=1,("string"===typeof h||n.isBuffer(h))&&(h||a>=4)&&(h||c))m+=n.byteLength(h)+2;else{if(a<4)return e.emit("error",new Error("clientId must be supplied before 3.1.1")),!1;if(1*c===0)return e.emit("error",new Error("clientId must be given if cleanSession set to 0")),!1}if("number"!==typeof l||l<0||l>65535||l%1!==0)return e.emit("error",new Error("Invalid keepalive")),!1;if(m+=2,m+=1,5===a){var y=F(e,g);if(!y)return!1;m+=y.length}if(u){if("object"!==typeof u)return e.emit("error",new Error("Invalid will")),!1;if(!u.topic||"string"!==typeof u.topic)return e.emit("error",new Error("Invalid will topic")),!1;if(m+=n.byteLength(u.topic)+2,m+=2,u.payload){if(!(u.payload.length>=0))return e.emit("error",new Error("Invalid will payload")),!1;"string"===typeof u.payload?m+=n.byteLength(u.payload):m+=u.payload.length}var v={};if(5===a){if(v=F(e,u.properties),!v)return!1;m+=v.length}}let b=!1;if(null!=f){if(!$(f))return e.emit("error",new Error("Invalid username")),!1;b=!0,m+=n.byteLength(f)+2}if(null!=d){if(!b)return e.emit("error",new Error("Username is required to use password")),!1;if(!$(d))return e.emit("error",new Error("Invalid password")),!1;m+=U(d)+2}e.write(r.CONNECT_HEADER),P(e,m),R(e,s),o.bridgeMode&&(a+=128),e.write(131===a?r.VERSION131:132===a?r.VERSION132:4===a?r.VERSION4:5===a?r.VERSION5:r.VERSION3);let _=0;return _|=null!=f?r.USERNAME_MASK:0,_|=null!=d?r.PASSWORD_MASK:0,_|=u&&u.retain?r.WILL_RETAIN_MASK:0,_|=u&&u.qos?u.qos<<r.WILL_QOS_SHIFT:0,_|=u?r.WILL_FLAG_MASK:0,_|=c?r.CLEAN_SESSION_MASK:0,e.write(n.from([_])),p(e,l),5===a&&y.write(),R(e,h),u&&(5===a&&v.write(),T(e,u.topic),R(e,u.payload)),null!=f&&R(e,f),null!=d&&R(e,d),!0}function b(t,e,i){const s=i?i.protocolVersion:4,a=t||{},u=5===s?a.reasonCode:a.returnCode,c=a.properties;let l=2;if("number"!==typeof u)return e.emit("error",new Error("Invalid return code")),!1;let h=null;if(5===s){if(h=F(e,c),!h)return!1;l+=h.length}return e.write(r.CONNACK_HEADER),P(e,l),e.write(a.sessionPresent?r.SESSIONPRESENT_HEADER:o),e.write(n.from([u])),null!=h&&h.write(),!0}function _(t,e,o){u("publish: packet: %o",t);const s=o?o.protocolVersion:4,a=t||{},c=a.qos||0,l=a.retain?r.RETAIN_MASK:0,h=a.topic,f=a.payload||i,d=a.messageId,g=a.properties;let m=0;if("string"===typeof h)m+=n.byteLength(h)+2;else{if(!n.isBuffer(h))return e.emit("error",new Error("Invalid topic")),!1;m+=h.length+2}if(n.isBuffer(f)?m+=f.length:m+=n.byteLength(f),c&&"number"!==typeof d)return e.emit("error",new Error("Invalid messageId")),!1;c&&(m+=2);let y=null;if(5===s){if(y=F(e,g),!y)return!1;m+=y.length}return e.write(r.PUBLISH_HEADER[c][a.dup?1:0][l?1:0]),P(e,m),p(e,U(h)),e.write(h),c>0&&p(e,d),null!=y&&y.write(),u("publish: payload: %o",f),e.write(f)}function w(t,e,i){const o=i?i.protocolVersion:4,s=t||{},a=s.cmd||"puback",u=s.messageId,c=s.dup&&"pubrel"===a?r.DUP_MASK:0;let l=0;const h=s.reasonCode,f=s.properties;let d=5===o?3:2;if("pubrel"===a&&(l=1),"number"!==typeof u)return e.emit("error",new Error("Invalid messageId")),!1;let g=null;if(5===o&&"object"===typeof f){if(g=B(e,f,i,d),!g)return!1;d+=g.length}return e.write(r.ACKS[a][l][c][0]),P(e,d),p(e,u),5===o&&e.write(n.from([h])),null!==g&&g.write(),!0}function x(t,e,i){u("subscribe: packet: ");const o=i?i.protocolVersion:4,s=t||{},a=s.dup?r.DUP_MASK:0,c=s.messageId,l=s.subscriptions,h=s.properties;let f=0;if("number"!==typeof c)return e.emit("error",new Error("Invalid messageId")),!1;f+=2;let d=null;if(5===o){if(d=F(e,h),!d)return!1;f+=d.length}if("object"!==typeof l||!l.length)return e.emit("error",new Error("Invalid subscriptions")),!1;for(let r=0;r<l.length;r+=1){const t=l[r].topic,i=l[r].qos;if("string"!==typeof t)return e.emit("error",new Error("Invalid subscriptions - invalid topic")),!1;if("number"!==typeof i)return e.emit("error",new Error("Invalid subscriptions - invalid qos")),!1;if(5===o){const t=l[r].nl||!1;if("boolean"!==typeof t)return e.emit("error",new Error("Invalid subscriptions - invalid No Local")),!1;const n=l[r].rap||!1;if("boolean"!==typeof n)return e.emit("error",new Error("Invalid subscriptions - invalid Retain as Published")),!1;const i=l[r].rh||0;if("number"!==typeof i||i>2)return e.emit("error",new Error("Invalid subscriptions - invalid Retain Handling")),!1}f+=n.byteLength(t)+2+1}u("subscribe: writing to stream: %o",r.SUBSCRIBE_HEADER),e.write(r.SUBSCRIBE_HEADER[1][a?1:0][0]),P(e,f),p(e,c),null!==d&&d.write();let g=!0;for(const u of l){const t=u.topic,i=u.qos,s=+u.nl,a=+u.rap,c=u.rh;let l;T(e,t),l=r.SUBSCRIBE_OPTIONS_QOS[i],5===o&&(l|=s?r.SUBSCRIBE_OPTIONS_NL:0,l|=a?r.SUBSCRIBE_OPTIONS_RAP:0,l|=c?r.SUBSCRIBE_OPTIONS_RH[c]:0),g=e.write(n.from([l]))}return g}function S(t,e,i){const o=i?i.protocolVersion:4,s=t||{},a=s.messageId,u=s.granted,c=s.properties;let l=0;if("number"!==typeof a)return e.emit("error",new Error("Invalid messageId")),!1;if(l+=2,"object"!==typeof u||!u.length)return e.emit("error",new Error("Invalid qos vector")),!1;for(let n=0;n<u.length;n+=1){if("number"!==typeof u[n])return e.emit("error",new Error("Invalid qos vector")),!1;l+=1}let h=null;if(5===o){if(h=B(e,c,i,l),!h)return!1;l+=h.length}return e.write(r.SUBACK_HEADER),P(e,l),p(e,a),null!==h&&h.write(),e.write(n.from(u))}function E(t,e,i){const o=i?i.protocolVersion:4,s=t||{},a=s.messageId,u=s.dup?r.DUP_MASK:0,c=s.unsubscriptions,l=s.properties;let h=0;if("number"!==typeof a)return e.emit("error",new Error("Invalid messageId")),!1;if(h+=2,"object"!==typeof c||!c.length)return e.emit("error",new Error("Invalid unsubscriptions")),!1;for(let r=0;r<c.length;r+=1){if("string"!==typeof c[r])return e.emit("error",new Error("Invalid unsubscriptions")),!1;h+=n.byteLength(c[r])+2}let f=null;if(5===o){if(f=F(e,l),!f)return!1;h+=f.length}e.write(r.UNSUBSCRIBE_HEADER[1][u?1:0][0]),P(e,h),p(e,a),null!==f&&f.write();let d=!0;for(let n=0;n<c.length;n++)d=T(e,c[n]);return d}function A(t,e,i){const o=i?i.protocolVersion:4,s=t||{},a=s.messageId,u=s.dup?r.DUP_MASK:0,c=s.granted,l=s.properties,h=s.cmd,f=0;let d=2;if("number"!==typeof a)return e.emit("error",new Error("Invalid messageId")),!1;if(5===o){if("object"!==typeof c||!c.length)return e.emit("error",new Error("Invalid qos vector")),!1;for(let t=0;t<c.length;t+=1){if("number"!==typeof c[t])return e.emit("error",new Error("Invalid qos vector")),!1;d+=1}}let g=null;if(5===o){if(g=B(e,l,i,d),!g)return!1;d+=g.length}return e.write(r.ACKS[h][f][u][0]),P(e,d),p(e,a),null!==g&&g.write(),5===o&&e.write(n.from(c)),!0}function M(t,e,n){return e.write(r.EMPTY[t.cmd])}function C(t,e,i){const o=i?i.protocolVersion:4,s=t||{},a=s.reasonCode,u=s.properties;let c=5===o?1:0,l=null;if(5===o){if(l=B(e,u,i,c),!l)return!1;c+=l.length}return e.write(n.from([r.codes.disconnect<<4])),P(e,c),5===o&&e.write(n.from([a])),null!==l&&l.write(),!0}function k(t,e,i){const o=i?i.protocolVersion:4,s=t||{},a=s.reasonCode,u=s.properties;let c=5===o?1:0;5!==o&&e.emit("error",new Error("Invalid mqtt version for auth packet"));const l=B(e,u,i,c);return!!l&&(c+=l.length,e.write(n.from([r.codes.auth<<4])),P(e,c),e.write(n.from([a])),null!==l&&l.write(),!0)}Object.defineProperty(m,"cacheNumbers",{get(){return p===I},set(t){t?(c&&0!==Object.keys(c).length||(g=!0),p=I):(g=!1,p=N)}});const O={};function P(t,e){if(e>r.VARBYTEINT_MAX)return t.emit("error",new Error(`Invalid variable byte integer: ${e}`)),!1;let n=O[e];return n||(n=f(e),e<16384&&(O[e]=n)),u("writeVarByteInt: writing to stream: %o",n),t.write(n)}function T(t,e){const r=n.byteLength(e);return p(t,r),u("writeString: %s",e),t.write(e,"utf8")}function L(t,e,n){T(t,e),T(t,n)}function I(t,e){return u("writeNumberCached: number: %d",e),u("writeNumberCached: %o",c[e]),t.write(c[e])}function N(t,e){const n=l(e);return u("writeNumberGenerated: %o",n),t.write(n)}function D(t,e){const n=d(e);return u("write4ByteNumber: %o",n),t.write(n)}function R(t,e){"string"===typeof e?T(t,e):e?(p(t,e.length),t.write(e)):p(t,0)}function F(t,e){if("object"!==typeof e||null!=e.length)return{length:1,write(){z(t,{},0)}};let i=0;function o(e,i){const o=r.propertiesTypes[e];let s=0;switch(o){case"byte":if("boolean"!==typeof i)return t.emit("error",new Error(`Invalid ${e}: ${i}`)),!1;s+=2;break;case"int8":if("number"!==typeof i||i<0||i>255)return t.emit("error",new Error(`Invalid ${e}: ${i}`)),!1;s+=2;break;case"binary":if(i&&null===i)return t.emit("error",new Error(`Invalid ${e}: ${i}`)),!1;s+=1+n.byteLength(i)+2;break;case"int16":if("number"!==typeof i||i<0||i>65535)return t.emit("error",new Error(`Invalid ${e}: ${i}`)),!1;s+=3;break;case"int32":if("number"!==typeof i||i<0||i>4294967295)return t.emit("error",new Error(`Invalid ${e}: ${i}`)),!1;s+=5;break;case"var":if("number"!==typeof i||i<0||i>268435455)return t.emit("error",new Error(`Invalid ${e}: ${i}`)),!1;s+=1+n.byteLength(f(i));break;case"string":if("string"!==typeof i)return t.emit("error",new Error(`Invalid ${e}: ${i}`)),!1;s+=3+n.byteLength(i.toString());break;case"pair":if("object"!==typeof i)return t.emit("error",new Error(`Invalid ${e}: ${i}`)),!1;s+=Object.getOwnPropertyNames(i).reduce((t,e)=>{const r=i[e];return Array.isArray(r)?t+=r.reduce((t,r)=>{return t+=3+n.byteLength(e.toString())+2+n.byteLength(r.toString()),t},0):t+=3+n.byteLength(e.toString())+2+n.byteLength(i[e].toString()),t},0);break;default:return t.emit("error",new Error(`Invalid property ${e}: ${i}`)),!1}return s}if(e)for(const n in e){let t=0,r=0;const s=e[n];if(Array.isArray(s))for(let e=0;e<s.length;e++){if(r=o(n,s[e]),!r)return!1;t+=r}else{if(r=o(n,s),!r)return!1;t=r}if(!t)return!1;i+=t}const s=n.byteLength(f(i));return{length:s+i,write(){z(t,e,i)}}}function B(t,e,n,r){const i=["reasonString","userProperties"],o=n&&n.properties&&n.properties.maximumPacketSize?n.properties.maximumPacketSize:0;let s=F(t,e);if(o)while(r+s.length>o){const n=i.shift();if(!n||!e[n])return!1;delete e[n],s=F(t,e)}return s}function j(t,e,i){const o=r.propertiesTypes[e];switch(o){case"byte":t.write(n.from([r.properties[e]])),t.write(n.from([+i]));break;case"int8":t.write(n.from([r.properties[e]])),t.write(n.from([i]));break;case"binary":t.write(n.from([r.properties[e]])),R(t,i);break;case"int16":t.write(n.from([r.properties[e]])),p(t,i);break;case"int32":t.write(n.from([r.properties[e]])),D(t,i);break;case"var":t.write(n.from([r.properties[e]])),P(t,i);break;case"string":t.write(n.from([r.properties[e]])),T(t,i);break;case"pair":Object.getOwnPropertyNames(i).forEach(o=>{const s=i[o];Array.isArray(s)?s.forEach(i=>{t.write(n.from([r.properties[e]])),L(t,o.toString(),i.toString())}):(t.write(n.from([r.properties[e]])),L(t,o.toString(),s.toString()))});break;default:return t.emit("error",new Error(`Invalid property ${e} value: ${i}`)),!1}}function z(t,e,n){P(t,n);for(const r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&null!==e[r]){const n=e[r];if(Array.isArray(n))for(let e=0;e<n.length;e++)j(t,r,n[e]);else j(t,r,n)}}function U(t){return t?t instanceof n?t.length:n.byteLength(t):0}function $(t){return"string"===typeof t||t instanceof n}e.exports=m}).call(this)}).call(this,t("buffer").Buffer)},{"./constants":22,"./numbers":25,buffer:14,debug:15,"process-nextick-args":31}],29:[function(t,e,n){var r=1e3,i=60*r,o=60*i,s=24*o,a=7*s,u=365.25*s;function c(t){if(t=String(t),!(t.length>100)){var e=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(t);if(e){var n=parseFloat(e[1]),c=(e[2]||"ms").toLowerCase();switch(c){case"years":case"year":case"yrs":case"yr":case"y":return n*u;case"weeks":case"week":case"w":return n*a;case"days":case"day":case"d":return n*s;case"hours":case"hour":case"hrs":case"hr":case"h":return n*o;case"minutes":case"minute":case"mins":case"min":case"m":return n*i;case"seconds":case"second":case"secs":case"sec":case"s":return n*r;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return n;default:return}}}}function l(t){var e=Math.abs(t);return e>=s?Math.round(t/s)+"d":e>=o?Math.round(t/o)+"h":e>=i?Math.round(t/i)+"m":e>=r?Math.round(t/r)+"s":t+"ms"}function h(t){var e=Math.abs(t);return e>=s?f(t,e,s,"day"):e>=o?f(t,e,o,"hour"):e>=i?f(t,e,i,"minute"):e>=r?f(t,e,r,"second"):t+" ms"}function f(t,e,n,r){var i=e>=1.5*n;return Math.round(t/n)+" "+r+(i?"s":"")}e.exports=function(t,e){e=e||{};var n=typeof t;if("string"===n&&t.length>0)return c(t);if("number"===n&&isFinite(t))return e.long?h(t):l(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))}},{}],30:[function(t,e,n){var r=t("wrappy");function i(t){var e=function(){return e.called?e.value:(e.called=!0,e.value=t.apply(this,arguments))};return e.called=!1,e}function o(t){var e=function(){if(e.called)throw new Error(e.onceError);return e.called=!0,e.value=t.apply(this,arguments)},n=t.name||"Function wrapped with `once`";return e.onceError=n+" shouldn't be called more than once",e.called=!1,e}e.exports=r(i),e.exports.strict=r(o),i.proto=i((function(){Object.defineProperty(Function.prototype,"once",{value:function(){return i(this)},configurable:!0}),Object.defineProperty(Function.prototype,"onceStrict",{value:function(){return o(this)},configurable:!0})}))},{wrappy:59}],31:[function(t,e,n){(function(t){(function(){"use strict";function n(e,n,r,i){if("function"!==typeof e)throw new TypeError('"callback" argument must be a function');var o,s,a=arguments.length;switch(a){case 0:case 1:return t.nextTick(e);case 2:return t.nextTick((function(){e.call(null,n)}));case 3:return t.nextTick((function(){e.call(null,n,r)}));case 4:return t.nextTick((function(){e.call(null,n,r,i)}));default:o=new Array(a-1),s=0;while(s<o.length)o[s++]=arguments[s];return t.nextTick((function(){e.apply(null,o)}))}}"undefined"===typeof t||!t.version||0===t.version.indexOf("v0.")||0===t.version.indexOf("v1.")&&0!==t.version.indexOf("v1.8.")?e.exports={nextTick:n}:e.exports=t}).call(this)}).call(this,t("_process"))},{_process:32}],32:[function(t,e,n){var r,i,o=e.exports={};function s(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function u(t){if(r===setTimeout)return setTimeout(t,0);if((r===s||!r)&&setTimeout)return r=setTimeout,setTimeout(t,0);try{return r(t,0)}catch(e){try{return r.call(null,t,0)}catch(e){return r.call(this,t,0)}}}function c(t){if(i===clearTimeout)return clearTimeout(t);if((i===a||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(t);try{return i(t)}catch(e){try{return i.call(null,t)}catch(e){return i.call(this,t)}}}(function(){try{r="function"===typeof setTimeout?setTimeout:s}catch(t){r=s}try{i="function"===typeof clearTimeout?clearTimeout:a}catch(t){i=a}})();var l,h=[],f=!1,d=-1;function p(){f&&l&&(f=!1,l.length?h=l.concat(h):d=-1,h.length&&g())}function g(){if(!f){var t=u(p);f=!0;var e=h.length;while(e){l=h,h=[];while(++d<e)l&&l[d].run();d=-1,e=h.length}l=null,f=!1,c(t)}}function m(t,e){this.fun=t,this.array=e}function y(){}o.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];h.push(new m(t,e)),1!==h.length||f||u(g)},m.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=y,o.addListener=y,o.once=y,o.off=y,o.removeListener=y,o.removeAllListeners=y,o.emit=y,o.prependListener=y,o.prependOnceListener=y,o.listeners=function(t){return[]},o.binding=function(t){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(t){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},{}],33:[function(n,r,i){(function(e){(function(){(function(n){var o="object"==typeof i&&i&&!i.nodeType&&i,s="object"==typeof r&&r&&!r.nodeType&&r,a="object"==typeof e&&e;a.global!==a&&a.window!==a&&a.self!==a||(n=a);var u,c,l=2147483647,h=36,f=1,d=26,p=38,g=700,m=72,y=128,v="-",b=/^xn--/,_=/[^\x20-\x7E]/,w=/[\x2E\u3002\uFF0E\uFF61]/g,x={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},S=h-f,E=Math.floor,A=String.fromCharCode;function M(t){throw new RangeError(x[t])}function C(t,e){var n=t.length,r=[];while(n--)r[n]=e(t[n]);return r}function k(t,e){var n=t.split("@"),r="";n.length>1&&(r=n[0]+"@",t=n[1]),t=t.replace(w,".");var i=t.split("."),o=C(i,e).join(".");return r+o}function O(t){var e,n,r=[],i=0,o=t.length;while(i<o)e=t.charCodeAt(i++),e>=55296&&e<=56319&&i<o?(n=t.charCodeAt(i++),56320==(64512&n)?r.push(((1023&e)<<10)+(1023&n)+65536):(r.push(e),i--)):r.push(e);return r}function P(t){return C(t,(function(t){var e="";return t>65535&&(t-=65536,e+=A(t>>>10&1023|55296),t=56320|1023&t),e+=A(t),e})).join("")}function T(t){return t-48<10?t-22:t-65<26?t-65:t-97<26?t-97:h}function L(t,e){return t+22+75*(t<26)-((0!=e)<<5)}function I(t,e,n){var r=0;for(t=n?E(t/g):t>>1,t+=E(t/e);t>S*d>>1;r+=h)t=E(t/S);return E(r+(S+1)*t/(t+p))}function N(t){var e,n,r,i,o,s,a,u,c,p,g=[],b=t.length,_=0,w=y,x=m;for(n=t.lastIndexOf(v),n<0&&(n=0),r=0;r<n;++r)t.charCodeAt(r)>=128&&M("not-basic"),g.push(t.charCodeAt(r));for(i=n>0?n+1:0;i<b;){for(o=_,s=1,a=h;;a+=h){if(i>=b&&M("invalid-input"),u=T(t.charCodeAt(i++)),(u>=h||u>E((l-_)/s))&&M("overflow"),_+=u*s,c=a<=x?f:a>=x+d?d:a-x,u<c)break;p=h-c,s>E(l/p)&&M("overflow"),s*=p}e=g.length+1,x=I(_-o,e,0==o),E(_/e)>l-w&&M("overflow"),w+=E(_/e),_%=e,g.splice(_++,0,w)}return P(g)}function D(t){var e,n,r,i,o,s,a,u,c,p,g,b,_,w,x,S=[];for(t=O(t),b=t.length,e=y,n=0,o=m,s=0;s<b;++s)g=t[s],g<128&&S.push(A(g));r=i=S.length,i&&S.push(v);while(r<b){for(a=l,s=0;s<b;++s)g=t[s],g>=e&&g<a&&(a=g);for(_=r+1,a-e>E((l-n)/_)&&M("overflow"),n+=(a-e)*_,e=a,s=0;s<b;++s)if(g=t[s],g<e&&++n>l&&M("overflow"),g==e){for(u=n,c=h;;c+=h){if(p=c<=o?f:c>=o+d?d:c-o,u<p)break;x=u-p,w=h-p,S.push(A(L(p+x%w,0))),u=E(x/w)}S.push(A(L(u,0))),o=I(n,_,r==i),n=0,++r}++n,++e}return S.join("")}function R(t){return k(t,(function(t){return b.test(t)?N(t.slice(4).toLowerCase()):t}))}function F(t){return k(t,(function(t){return _.test(t)?"xn--"+D(t):t}))}if(u={version:"1.4.1",ucs2:{decode:O,encode:P},decode:N,encode:D,toASCII:F,toUnicode:R},"function"==typeof t&&"object"==typeof t.amd&&t.amd)t("punycode",(function(){return u}));else if(o&&s)if(r.exports==o)s.exports=u;else for(c in u)u.hasOwnProperty(c)&&(o[c]=u[c]);else n.punycode=u})(this)}).call(this)}).call(this,"undefined"!==typeof e?e:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{}],34:[function(t,e,n){"use strict";function r(t,e){return Object.prototype.hasOwnProperty.call(t,e)}e.exports=function(t,e,n,o){e=e||"&",n=n||"=";var s={};if("string"!==typeof t||0===t.length)return s;var a=/\+/g;t=t.split(e);var u=1e3;o&&"number"===typeof o.maxKeys&&(u=o.maxKeys);var c=t.length;u>0&&c>u&&(c=u);for(var l=0;l<c;++l){var h,f,d,p,g=t[l].replace(a,"%20"),m=g.indexOf(n);m>=0?(h=g.substr(0,m),f=g.substr(m+1)):(h=g,f=""),d=decodeURIComponent(h),p=decodeURIComponent(f),r(s,d)?i(s[d])?s[d].push(p):s[d]=[s[d],p]:s[d]=p}return s};var i=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)}},{}],35:[function(t,e,n){"use strict";var r=function(t){switch(typeof t){case"string":return t;case"boolean":return t?"true":"false";case"number":return isFinite(t)?t:"";default:return""}};e.exports=function(t,e,n,a){return e=e||"&",n=n||"=",null===t&&(t=void 0),"object"===typeof t?o(s(t),(function(s){var a=encodeURIComponent(r(s))+n;return i(t[s])?o(t[s],(function(t){return a+encodeURIComponent(r(t))})).join(e):a+encodeURIComponent(r(t[s]))})).join(e):a?encodeURIComponent(r(a))+n+encodeURIComponent(r(t)):""};var i=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)};function o(t,e){if(t.map)return t.map(e);for(var n=[],r=0;r<t.length;r++)n.push(e(t[r],r));return n}var s=Object.keys||function(t){var e=[];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.push(n);return e}},{}],36:[function(t,e,n){"use strict";n.decode=n.parse=t("./decode"),n.encode=n.stringify=t("./encode")},{"./decode":34,"./encode":35}],37:[function(t,e,n){"use strict";function r(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}var i={};function o(t,e,n){function o(t,n,r){return"string"===typeof e?e:e(t,n,r)}n||(n=Error);var s=function(t){function e(e,n,r){return t.call(this,o(e,n,r))||this}return r(e,t),e}(n);s.prototype.name=n.name,s.prototype.code=t,i[t]=s}function s(t,e){if(Array.isArray(t)){var n=t.length;return t=t.map((function(t){return String(t)})),n>2?"one of ".concat(e," ").concat(t.slice(0,n-1).join(", "),", or ")+t[n-1]:2===n?"one of ".concat(e," ").concat(t[0]," or ").concat(t[1]):"of ".concat(e," ").concat(t[0])}return"of ".concat(e," ").concat(String(t))}function a(t,e,n){return t.substr(!n||n<0?0:+n,e.length)===e}function u(t,e,n){return(void 0===n||n>t.length)&&(n=t.length),t.substring(n-e.length,n)===e}function c(t,e,n){return"number"!==typeof n&&(n=0),!(n+e.length>t.length)&&-1!==t.indexOf(e,n)}o("ERR_INVALID_OPT_VALUE",(function(t,e){return'The value "'+e+'" is invalid for option "'+t+'"'}),TypeError),o("ERR_INVALID_ARG_TYPE",(function(t,e,n){var r,i;if("string"===typeof e&&a(e,"not ")?(r="must not be",e=e.replace(/^not /,"")):r="must be",u(t," argument"))i="The ".concat(t," ").concat(r," ").concat(s(e,"type"));else{var o=c(t,".")?"property":"argument";i='The "'.concat(t,'" ').concat(o," ").concat(r," ").concat(s(e,"type"))}return i+=". Received type ".concat(typeof n),i}),TypeError),o("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),o("ERR_METHOD_NOT_IMPLEMENTED",(function(t){return"The "+t+" method is not implemented"})),o("ERR_STREAM_PREMATURE_CLOSE","Premature close"),o("ERR_STREAM_DESTROYED",(function(t){return"Cannot call "+t+" after a stream was destroyed"})),o("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),o("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),o("ERR_STREAM_WRITE_AFTER_END","write after end"),o("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),o("ERR_UNKNOWN_ENCODING",(function(t){return"Unknown encoding: "+t}),TypeError),o("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),e.exports.codes=i},{}],38:[function(t,e,n){(function(n){(function(){"use strict";var r=Object.keys||function(t){var e=[];for(var n in t)e.push(n);return e};e.exports=c;var i=t("./_stream_readable"),o=t("./_stream_writable");t("inherits")(c,i);for(var s=r(o.prototype),a=0;a<s.length;a++){var u=s[a];c.prototype[u]||(c.prototype[u]=o.prototype[u])}function c(t){if(!(this instanceof c))return new c(t);i.call(this,t),o.call(this,t),this.allowHalfOpen=!0,t&&(!1===t.readable&&(this.readable=!1),!1===t.writable&&(this.writable=!1),!1===t.allowHalfOpen&&(this.allowHalfOpen=!1,this.once("end",l)))}function l(){this._writableState.ended||n.nextTick(h,this)}function h(t){t.end()}Object.defineProperty(c.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(c.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(c.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(c.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed&&this._writableState.destroyed)},set:function(t){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=t,this._writableState.destroyed=t)}})}).call(this)}).call(this,t("_process"))},{"./_stream_readable":40,"./_stream_writable":42,_process:32,inherits:21}],39:[function(t,e,n){"use strict";e.exports=i;var r=t("./_stream_transform");function i(t){if(!(this instanceof i))return new i(t);r.call(this,t)}t("inherits")(i,r),i.prototype._transform=function(t,e,n){n(null,t)}},{"./_stream_transform":41,inherits:21}],40:[function(t,n,r){(function(e,r){(function(){"use strict";var i;n.exports=O,O.ReadableState=k;t("events").EventEmitter;var o=function(t,e){return t.listeners(e).length},s=t("./internal/streams/stream"),a=t("buffer").Buffer,u=r.Uint8Array||function(){};function c(t){return a.from(t)}function l(t){return a.isBuffer(t)||t instanceof u}var h,f=t("util");h=f&&f.debuglog?f.debuglog("stream"):function(){};var d,p,g,m=t("./internal/streams/buffer_list"),y=t("./internal/streams/destroy"),v=t("./internal/streams/state"),b=v.getHighWaterMark,_=t("../errors").codes,w=_.ERR_INVALID_ARG_TYPE,x=_.ERR_STREAM_PUSH_AFTER_EOF,S=_.ERR_METHOD_NOT_IMPLEMENTED,E=_.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;t("inherits")(O,s);var A=y.errorOrDestroy,M=["error","close","destroy","pause","resume"];function C(t,e,n){if("function"===typeof t.prependListener)return t.prependListener(e,n);t._events&&t._events[e]?Array.isArray(t._events[e])?t._events[e].unshift(n):t._events[e]=[n,t._events[e]]:t.on(e,n)}function k(e,n,r){i=i||t("./_stream_duplex"),e=e||{},"boolean"!==typeof r&&(r=n instanceof i),this.objectMode=!!e.objectMode,r&&(this.objectMode=this.objectMode||!!e.readableObjectMode),this.highWaterMark=b(this,e,"readableHighWaterMark",r),this.buffer=new m,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=!1!==e.emitClose,this.autoDestroy=!!e.autoDestroy,this.destroyed=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(d||(d=t("string_decoder/").StringDecoder),this.decoder=new d(e.encoding),this.encoding=e.encoding)}function O(e){if(i=i||t("./_stream_duplex"),!(this instanceof O))return new O(e);var n=this instanceof i;this._readableState=new k(e,this,n),this.readable=!0,e&&("function"===typeof e.read&&(this._read=e.read),"function"===typeof e.destroy&&(this._destroy=e.destroy)),s.call(this)}function P(t,e,n,r,i){h("readableAddChunk",e);var o,s=t._readableState;if(null===e)s.reading=!1,R(t,s);else if(i||(o=L(s,e)),o)A(t,o);else if(s.objectMode||e&&e.length>0)if("string"===typeof e||s.objectMode||Object.getPrototypeOf(e)===a.prototype||(e=c(e)),r)s.endEmitted?A(t,new E):T(t,s,e,!0);else if(s.ended)A(t,new x);else{if(s.destroyed)return!1;s.reading=!1,s.decoder&&!n?(e=s.decoder.write(e),s.objectMode||0!==e.length?T(t,s,e,!1):j(t,s)):T(t,s,e,!1)}else r||(s.reading=!1,j(t,s));return!s.ended&&(s.length<s.highWaterMark||0===s.length)}function T(t,e,n,r){e.flowing&&0===e.length&&!e.sync?(e.awaitDrain=0,t.emit("data",n)):(e.length+=e.objectMode?1:n.length,r?e.buffer.unshift(n):e.buffer.push(n),e.needReadable&&F(t)),j(t,e)}function L(t,e){var n;return l(e)||"string"===typeof e||void 0===e||t.objectMode||(n=new w("chunk",["string","Buffer","Uint8Array"],e)),n}Object.defineProperty(O.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(t){this._readableState&&(this._readableState.destroyed=t)}}),O.prototype.destroy=y.destroy,O.prototype._undestroy=y.undestroy,O.prototype._destroy=function(t,e){e(t)},O.prototype.push=function(t,e){var n,r=this._readableState;return r.objectMode?n=!0:"string"===typeof t&&(e=e||r.defaultEncoding,e!==r.encoding&&(t=a.from(t,e),e=""),n=!0),P(this,t,e,!1,n)},O.prototype.unshift=function(t){return P(this,t,null,!0,!1)},O.prototype.isPaused=function(){return!1===this._readableState.flowing},O.prototype.setEncoding=function(e){d||(d=t("string_decoder/").StringDecoder);var n=new d(e);this._readableState.decoder=n,this._readableState.encoding=this._readableState.decoder.encoding;var r=this._readableState.buffer.head,i="";while(null!==r)i+=n.write(r.data),r=r.next;return this._readableState.buffer.clear(),""!==i&&this._readableState.buffer.push(i),this._readableState.length=i.length,this};var I=1073741824;function N(t){return t>=I?t=I:(t--,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,t|=t>>>16,t++),t}function D(t,e){return t<=0||0===e.length&&e.ended?0:e.objectMode?1:t!==t?e.flowing&&e.length?e.buffer.head.data.length:e.length:(t>e.highWaterMark&&(e.highWaterMark=N(t)),t<=e.length?t:e.ended?e.length:(e.needReadable=!0,0))}function R(t,e){if(h("onEofChunk"),!e.ended){if(e.decoder){var n=e.decoder.end();n&&n.length&&(e.buffer.push(n),e.length+=e.objectMode?1:n.length)}e.ended=!0,e.sync?F(t):(e.needReadable=!1,e.emittedReadable||(e.emittedReadable=!0,B(t)))}}function F(t){var n=t._readableState;h("emitReadable",n.needReadable,n.emittedReadable),n.needReadable=!1,n.emittedReadable||(h("emitReadable",n.flowing),n.emittedReadable=!0,e.nextTick(B,t))}function B(t){var e=t._readableState;h("emitReadable_",e.destroyed,e.length,e.ended),e.destroyed||!e.length&&!e.ended||(t.emit("readable"),e.emittedReadable=!1),e.needReadable=!e.flowing&&!e.ended&&e.length<=e.highWaterMark,G(t)}function j(t,n){n.readingMore||(n.readingMore=!0,e.nextTick(z,t,n))}function z(t,e){while(!e.reading&&!e.ended&&(e.length<e.highWaterMark||e.flowing&&0===e.length)){var n=e.length;if(h("maybeReadMore read 0"),t.read(0),n===e.length)break}e.readingMore=!1}function U(t){return function(){var e=t._readableState;h("pipeOnDrain",e.awaitDrain),e.awaitDrain&&e.awaitDrain--,0===e.awaitDrain&&o(t,"data")&&(e.flowing=!0,G(t))}}function $(t){var e=t._readableState;e.readableListening=t.listenerCount("readable")>0,e.resumeScheduled&&!e.paused?e.flowing=!0:t.listenerCount("data")>0&&t.resume()}function V(t){h("readable nexttick read 0"),t.read(0)}function q(t,n){n.resumeScheduled||(n.resumeScheduled=!0,e.nextTick(W,t,n))}function W(t,e){h("resume",e.reading),e.reading||t.read(0),e.resumeScheduled=!1,t.emit("resume"),G(t),e.flowing&&!e.reading&&t.read(0)}function G(t){var e=t._readableState;h("flow",e.flowing);while(e.flowing&&null!==t.read());}function H(t,e){return 0===e.length?null:(e.objectMode?n=e.buffer.shift():!t||t>=e.length?(n=e.decoder?e.buffer.join(""):1===e.buffer.length?e.buffer.first():e.buffer.concat(e.length),e.buffer.clear()):n=e.buffer.consume(t,e.decoder),n);var n}function X(t){var n=t._readableState;h("endReadable",n.endEmitted),n.endEmitted||(n.ended=!0,e.nextTick(Y,n,t))}function Y(t,e){if(h("endReadableNT",t.endEmitted,t.length),!t.endEmitted&&0===t.length&&(t.endEmitted=!0,e.readable=!1,e.emit("end"),t.autoDestroy)){var n=e._writableState;(!n||n.autoDestroy&&n.finished)&&e.destroy()}}function Z(t,e){for(var n=0,r=t.length;n<r;n++)if(t[n]===e)return n;return-1}O.prototype.read=function(t){h("read",t),t=parseInt(t,10);var e=this._readableState,n=t;if(0!==t&&(e.emittedReadable=!1),0===t&&e.needReadable&&((0!==e.highWaterMark?e.length>=e.highWaterMark:e.length>0)||e.ended))return h("read: emitReadable",e.length,e.ended),0===e.length&&e.ended?X(this):F(this),null;if(t=D(t,e),0===t&&e.ended)return 0===e.length&&X(this),null;var r,i=e.needReadable;return h("need readable",i),(0===e.length||e.length-t<e.highWaterMark)&&(i=!0,h("length less than watermark",i)),e.ended||e.reading?(i=!1,h("reading or ended",i)):i&&(h("do read"),e.reading=!0,e.sync=!0,0===e.length&&(e.needReadable=!0),this._read(e.highWaterMark),e.sync=!1,e.reading||(t=D(n,e))),r=t>0?H(t,e):null,null===r?(e.needReadable=e.length<=e.highWaterMark,t=0):(e.length-=t,e.awaitDrain=0),0===e.length&&(e.ended||(e.needReadable=!0),n!==t&&e.ended&&X(this)),null!==r&&this.emit("data",r),r},O.prototype._read=function(t){A(this,new S("_read()"))},O.prototype.pipe=function(t,n){var r=this,i=this._readableState;switch(i.pipesCount){case 0:i.pipes=t;break;case 1:i.pipes=[i.pipes,t];break;default:i.pipes.push(t);break}i.pipesCount+=1,h("pipe count=%d opts=%j",i.pipesCount,n);var s=(!n||!1!==n.end)&&t!==e.stdout&&t!==e.stderr,a=s?c:v;function u(t,e){h("onunpipe"),t===r&&e&&!1===e.hasUnpiped&&(e.hasUnpiped=!0,d())}function c(){h("onend"),t.end()}i.endEmitted?e.nextTick(a):r.once("end",a),t.on("unpipe",u);var l=U(r);t.on("drain",l);var f=!1;function d(){h("cleanup"),t.removeListener("close",m),t.removeListener("finish",y),t.removeListener("drain",l),t.removeListener("error",g),t.removeListener("unpipe",u),r.removeListener("end",c),r.removeListener("end",v),r.removeListener("data",p),f=!0,!i.awaitDrain||t._writableState&&!t._writableState.needDrain||l()}function p(e){h("ondata");var n=t.write(e);h("dest.write",n),!1===n&&((1===i.pipesCount&&i.pipes===t||i.pipesCount>1&&-1!==Z(i.pipes,t))&&!f&&(h("false write response, pause",i.awaitDrain),i.awaitDrain++),r.pause())}function g(e){h("onerror",e),v(),t.removeListener("error",g),0===o(t,"error")&&A(t,e)}function m(){t.removeListener("finish",y),v()}function y(){h("onfinish"),t.removeListener("close",m),v()}function v(){h("unpipe"),r.unpipe(t)}return r.on("data",p),C(t,"error",g),t.once("close",m),t.once("finish",y),t.emit("pipe",r),i.flowing||(h("pipe resume"),r.resume()),t},O.prototype.unpipe=function(t){var e=this._readableState,n={hasUnpiped:!1};if(0===e.pipesCount)return this;if(1===e.pipesCount)return t&&t!==e.pipes?this:(t||(t=e.pipes),e.pipes=null,e.pipesCount=0,e.flowing=!1,t&&t.emit("unpipe",this,n),this);if(!t){var r=e.pipes,i=e.pipesCount;e.pipes=null,e.pipesCount=0,e.flowing=!1;for(var o=0;o<i;o++)r[o].emit("unpipe",this,{hasUnpiped:!1});return this}var s=Z(e.pipes,t);return-1===s?this:(e.pipes.splice(s,1),e.pipesCount-=1,1===e.pipesCount&&(e.pipes=e.pipes[0]),t.emit("unpipe",this,n),this)},O.prototype.on=function(t,n){var r=s.prototype.on.call(this,t,n),i=this._readableState;return"data"===t?(i.readableListening=this.listenerCount("readable")>0,!1!==i.flowing&&this.resume()):"readable"===t&&(i.endEmitted||i.readableListening||(i.readableListening=i.needReadable=!0,i.flowing=!1,i.emittedReadable=!1,h("on readable",i.length,i.reading),i.length?F(this):i.reading||e.nextTick(V,this))),r},O.prototype.addListener=O.prototype.on,O.prototype.removeListener=function(t,n){var r=s.prototype.removeListener.call(this,t,n);return"readable"===t&&e.nextTick($,this),r},O.prototype.removeAllListeners=function(t){var n=s.prototype.removeAllListeners.apply(this,arguments);return"readable"!==t&&void 0!==t||e.nextTick($,this),n},O.prototype.resume=function(){var t=this._readableState;return t.flowing||(h("resume"),t.flowing=!t.readableListening,q(this,t)),t.paused=!1,this},O.prototype.pause=function(){return h("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(h("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},O.prototype.wrap=function(t){var e=this,n=this._readableState,r=!1;for(var i in t.on("end",(function(){if(h("wrapped end"),n.decoder&&!n.ended){var t=n.decoder.end();t&&t.length&&e.push(t)}e.push(null)})),t.on("data",(function(i){if(h("wrapped data"),n.decoder&&(i=n.decoder.write(i)),(!n.objectMode||null!==i&&void 0!==i)&&(n.objectMode||i&&i.length)){var o=e.push(i);o||(r=!0,t.pause())}})),t)void 0===this[i]&&"function"===typeof t[i]&&(this[i]=function(e){return function(){return t[e].apply(t,arguments)}}(i));for(var o=0;o<M.length;o++)t.on(M[o],this.emit.bind(this,M[o]));return this._read=function(e){h("wrapped _read",e),r&&(r=!1,t.resume())},this},"function"===typeof Symbol&&(O.prototype[Symbol.asyncIterator]=function(){return void 0===p&&(p=t("./internal/streams/async_iterator")),p(this)}),Object.defineProperty(O.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(O.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(O.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(t){this._readableState&&(this._readableState.flowing=t)}}),O._fromList=H,Object.defineProperty(O.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),"function"===typeof Symbol&&(O.from=function(e,n){return void 0===g&&(g=t("./internal/streams/from")),g(O,e,n)})}).call(this)}).call(this,t("_process"),"undefined"!==typeof e?e:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{"../errors":37,"./_stream_duplex":38,"./internal/streams/async_iterator":43,"./internal/streams/buffer_list":44,"./internal/streams/destroy":45,"./internal/streams/from":47,"./internal/streams/state":49,"./internal/streams/stream":50,_process:32,buffer:14,events:19,inherits:21,"string_decoder/":55,util:13}],41:[function(t,e,n){"use strict";e.exports=l;var r=t("../errors").codes,i=r.ERR_METHOD_NOT_IMPLEMENTED,o=r.ERR_MULTIPLE_CALLBACK,s=r.ERR_TRANSFORM_ALREADY_TRANSFORMING,a=r.ERR_TRANSFORM_WITH_LENGTH_0,u=t("./_stream_duplex");function c(t,e){var n=this._transformState;n.transforming=!1;var r=n.writecb;if(null===r)return this.emit("error",new o);n.writechunk=null,n.writecb=null,null!=e&&this.push(e),r(t);var i=this._readableState;i.reading=!1,(i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}function l(t){if(!(this instanceof l))return new l(t);u.call(this,t),this._transformState={afterTransform:c.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,t&&("function"===typeof t.transform&&(this._transform=t.transform),"function"===typeof t.flush&&(this._flush=t.flush)),this.on("prefinish",h)}function h(){var t=this;"function"!==typeof this._flush||this._readableState.destroyed?f(this,null,null):this._flush((function(e,n){f(t,e,n)}))}function f(t,e,n){if(e)return t.emit("error",e);if(null!=n&&t.push(n),t._writableState.length)throw new a;if(t._transformState.transforming)throw new s;return t.push(null)}t("inherits")(l,u),l.prototype.push=function(t,e){return this._transformState.needTransform=!1,u.prototype.push.call(this,t,e)},l.prototype._transform=function(t,e,n){n(new i("_transform()"))},l.prototype._write=function(t,e,n){var r=this._transformState;if(r.writecb=n,r.writechunk=t,r.writeencoding=e,!r.transforming){var i=this._readableState;(r.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},l.prototype._read=function(t){var e=this._transformState;null===e.writechunk||e.transforming?e.needTransform=!0:(e.transforming=!0,this._transform(e.writechunk,e.writeencoding,e.afterTransform))},l.prototype._destroy=function(t,e){u.prototype._destroy.call(this,t,(function(t){e(t)}))}},{"../errors":37,"./_stream_duplex":38,inherits:21}],42:[function(t,n,r){(function(e,r){(function(){"use strict";function i(t){var e=this;this.next=null,this.entry=null,this.finish=function(){W(e,t)}}var o;n.exports=k,k.WritableState=C;var s={deprecate:t("util-deprecate")},a=t("./internal/streams/stream"),u=t("buffer").Buffer,c=r.Uint8Array||function(){};function l(t){return u.from(t)}function h(t){return u.isBuffer(t)||t instanceof c}var f,d=t("./internal/streams/destroy"),p=t("./internal/streams/state"),g=p.getHighWaterMark,m=t("../errors").codes,y=m.ERR_INVALID_ARG_TYPE,v=m.ERR_METHOD_NOT_IMPLEMENTED,b=m.ERR_MULTIPLE_CALLBACK,_=m.ERR_STREAM_CANNOT_PIPE,w=m.ERR_STREAM_DESTROYED,x=m.ERR_STREAM_NULL_VALUES,S=m.ERR_STREAM_WRITE_AFTER_END,E=m.ERR_UNKNOWN_ENCODING,A=d.errorOrDestroy;function M(){}function C(e,n,r){o=o||t("./_stream_duplex"),e=e||{},"boolean"!==typeof r&&(r=n instanceof o),this.objectMode=!!e.objectMode,r&&(this.objectMode=this.objectMode||!!e.writableObjectMode),this.highWaterMark=g(this,e,"writableHighWaterMark",r),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var s=!1===e.decodeStrings;this.decodeStrings=!s,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(t){R(n,t)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!1!==e.emitClose,this.autoDestroy=!!e.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new i(this)}function k(e){o=o||t("./_stream_duplex");var n=this instanceof o;if(!n&&!f.call(k,this))return new k(e);this._writableState=new C(e,this,n),this.writable=!0,e&&("function"===typeof e.write&&(this._write=e.write),"function"===typeof e.writev&&(this._writev=e.writev),"function"===typeof e.destroy&&(this._destroy=e.destroy),"function"===typeof e.final&&(this._final=e.final)),a.call(this)}function O(t,n){var r=new S;A(t,r),e.nextTick(n,r)}function P(t,n,r,i){var o;return null===r?o=new x:"string"===typeof r||n.objectMode||(o=new y("chunk",["string","Buffer"],r)),!o||(A(t,o),e.nextTick(i,o),!1)}function T(t,e,n){return t.objectMode||!1===t.decodeStrings||"string"!==typeof e||(e=u.from(e,n)),e}function L(t,e,n,r,i,o){if(!n){var s=T(e,r,i);r!==s&&(n=!0,i="buffer",r=s)}var a=e.objectMode?1:r.length;e.length+=a;var u=e.length<e.highWaterMark;if(u||(e.needDrain=!0),e.writing||e.corked){var c=e.lastBufferedRequest;e.lastBufferedRequest={chunk:r,encoding:i,isBuf:n,callback:o,next:null},c?c.next=e.lastBufferedRequest:e.bufferedRequest=e.lastBufferedRequest,e.bufferedRequestCount+=1}else I(t,e,!1,a,r,i,o);return u}function I(t,e,n,r,i,o,s){e.writelen=r,e.writecb=s,e.writing=!0,e.sync=!0,e.destroyed?e.onwrite(new w("write")):n?t._writev(i,e.onwrite):t._write(i,o,e.onwrite),e.sync=!1}function N(t,n,r,i,o){--n.pendingcb,r?(e.nextTick(o,i),e.nextTick(V,t,n),t._writableState.errorEmitted=!0,A(t,i)):(o(i),t._writableState.errorEmitted=!0,A(t,i),V(t,n))}function D(t){t.writing=!1,t.writecb=null,t.length-=t.writelen,t.writelen=0}function R(t,n){var r=t._writableState,i=r.sync,o=r.writecb;if("function"!==typeof o)throw new b;if(D(r),n)N(t,r,i,n,o);else{var s=z(r)||t.destroyed;s||r.corked||r.bufferProcessing||!r.bufferedRequest||j(t,r),i?e.nextTick(F,t,r,s,o):F(t,r,s,o)}}function F(t,e,n,r){n||B(t,e),e.pendingcb--,r(),V(t,e)}function B(t,e){0===e.length&&e.needDrain&&(e.needDrain=!1,t.emit("drain"))}function j(t,e){e.bufferProcessing=!0;var n=e.bufferedRequest;if(t._writev&&n&&n.next){var r=e.bufferedRequestCount,o=new Array(r),s=e.corkedRequestsFree;s.entry=n;var a=0,u=!0;while(n)o[a]=n,n.isBuf||(u=!1),n=n.next,a+=1;o.allBuffers=u,I(t,e,!0,e.length,o,"",s.finish),e.pendingcb++,e.lastBufferedRequest=null,s.next?(e.corkedRequestsFree=s.next,s.next=null):e.corkedRequestsFree=new i(e),e.bufferedRequestCount=0}else{while(n){var c=n.chunk,l=n.encoding,h=n.callback,f=e.objectMode?1:c.length;if(I(t,e,!1,f,c,l,h),n=n.next,e.bufferedRequestCount--,e.writing)break}null===n&&(e.lastBufferedRequest=null)}e.bufferedRequest=n,e.bufferProcessing=!1}function z(t){return t.ending&&0===t.length&&null===t.bufferedRequest&&!t.finished&&!t.writing}function U(t,e){t._final((function(n){e.pendingcb--,n&&A(t,n),e.prefinished=!0,t.emit("prefinish"),V(t,e)}))}function $(t,n){n.prefinished||n.finalCalled||("function"!==typeof t._final||n.destroyed?(n.prefinished=!0,t.emit("prefinish")):(n.pendingcb++,n.finalCalled=!0,e.nextTick(U,t,n)))}function V(t,e){var n=z(e);if(n&&($(t,e),0===e.pendingcb&&(e.finished=!0,t.emit("finish"),e.autoDestroy))){var r=t._readableState;(!r||r.autoDestroy&&r.endEmitted)&&t.destroy()}return n}function q(t,n,r){n.ending=!0,V(t,n),r&&(n.finished?e.nextTick(r):t.once("finish",r)),n.ended=!0,t.writable=!1}function W(t,e,n){var r=t.entry;t.entry=null;while(r){var i=r.callback;e.pendingcb--,i(n),r=r.next}e.corkedRequestsFree.next=t}t("inherits")(k,a),C.prototype.getBuffer=function(){var t=this.bufferedRequest,e=[];while(t)e.push(t),t=t.next;return e},function(){try{Object.defineProperty(C.prototype,"buffer",{get:s.deprecate((function(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(t){}}(),"function"===typeof Symbol&&Symbol.hasInstance&&"function"===typeof Function.prototype[Symbol.hasInstance]?(f=Function.prototype[Symbol.hasInstance],Object.defineProperty(k,Symbol.hasInstance,{value:function(t){return!!f.call(this,t)||this===k&&(t&&t._writableState instanceof C)}})):f=function(t){return t instanceof this},k.prototype.pipe=function(){A(this,new _)},k.prototype.write=function(t,e,n){var r=this._writableState,i=!1,o=!r.objectMode&&h(t);return o&&!u.isBuffer(t)&&(t=l(t)),"function"===typeof e&&(n=e,e=null),o?e="buffer":e||(e=r.defaultEncoding),"function"!==typeof n&&(n=M),r.ending?O(this,n):(o||P(this,r,t,n))&&(r.pendingcb++,i=L(this,r,o,t,e,n)),i},k.prototype.cork=function(){this._writableState.corked++},k.prototype.uncork=function(){var t=this._writableState;t.corked&&(t.corked--,t.writing||t.corked||t.bufferProcessing||!t.bufferedRequest||j(this,t))},k.prototype.setDefaultEncoding=function(t){if("string"===typeof t&&(t=t.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((t+"").toLowerCase())>-1))throw new E(t);return this._writableState.defaultEncoding=t,this},Object.defineProperty(k.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(k.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),k.prototype._write=function(t,e,n){n(new v("_write()"))},k.prototype._writev=null,k.prototype.end=function(t,e,n){var r=this._writableState;return"function"===typeof t?(n=t,t=null,e=null):"function"===typeof e&&(n=e,e=null),null!==t&&void 0!==t&&this.write(t,e),r.corked&&(r.corked=1,this.uncork()),r.ending||q(this,r,n),this},Object.defineProperty(k.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(k.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(t){this._writableState&&(this._writableState.destroyed=t)}}),k.prototype.destroy=d.destroy,k.prototype._undestroy=d.undestroy,k.prototype._destroy=function(t,e){e(t)}}).call(this)}).call(this,t("_process"),"undefined"!==typeof e?e:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{"../errors":37,"./_stream_duplex":38,"./internal/streams/destroy":45,"./internal/streams/state":49,"./internal/streams/stream":50,_process:32,buffer:14,inherits:21,"util-deprecate":58}],43:[function(t,e,n){(function(n){(function(){"use strict";var r;function i(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var o=t("./end-of-stream"),s=Symbol("lastResolve"),a=Symbol("lastReject"),u=Symbol("error"),c=Symbol("ended"),l=Symbol("lastPromise"),h=Symbol("handlePromise"),f=Symbol("stream");function d(t,e){return{value:t,done:e}}function p(t){var e=t[s];if(null!==e){var n=t[f].read();null!==n&&(t[l]=null,t[s]=null,t[a]=null,e(d(n,!1)))}}function g(t){n.nextTick(p,t)}function m(t,e){return function(n,r){t.then((function(){e[c]?n(d(void 0,!0)):e[h](n,r)}),r)}}var y=Object.getPrototypeOf((function(){})),v=Object.setPrototypeOf((r={get stream(){return this[f]},next:function(){var t=this,e=this[u];if(null!==e)return Promise.reject(e);if(this[c])return Promise.resolve(d(void 0,!0));if(this[f].destroyed)return new Promise((function(e,r){n.nextTick((function(){t[u]?r(t[u]):e(d(void 0,!0))}))}));var r,i=this[l];if(i)r=new Promise(m(i,this));else{var o=this[f].read();if(null!==o)return Promise.resolve(d(o,!1));r=new Promise(this[h])}return this[l]=r,r}},i(r,Symbol.asyncIterator,(function(){return this})),i(r,"return",(function(){var t=this;return new Promise((function(e,n){t[f].destroy(null,(function(t){t?n(t):e(d(void 0,!0))}))}))})),r),y),b=function(t){var e,n=Object.create(v,(e={},i(e,f,{value:t,writable:!0}),i(e,s,{value:null,writable:!0}),i(e,a,{value:null,writable:!0}),i(e,u,{value:null,writable:!0}),i(e,c,{value:t._readableState.endEmitted,writable:!0}),i(e,h,{value:function(t,e){var r=n[f].read();r?(n[l]=null,n[s]=null,n[a]=null,t(d(r,!1))):(n[s]=t,n[a]=e)},writable:!0}),e));return n[l]=null,o(t,(function(t){if(t&&"ERR_STREAM_PREMATURE_CLOSE"!==t.code){var e=n[a];return null!==e&&(n[l]=null,n[s]=null,n[a]=null,e(t)),void(n[u]=t)}var r=n[s];null!==r&&(n[l]=null,n[s]=null,n[a]=null,r(d(void 0,!0))),n[c]=!0})),t.on("readable",g.bind(null,n)),n};e.exports=b}).call(this)}).call(this,t("_process"))},{"./end-of-stream":46,_process:32}],44:[function(t,e,n){"use strict";function r(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function i(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?r(Object(n),!0).forEach((function(e){o(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function o(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function u(t,e,n){return e&&a(t.prototype,e),n&&a(t,n),t}var c=t("buffer"),l=c.Buffer,h=t("util"),f=h.inspect,d=f&&f.custom||"inspect";function p(t,e,n){l.prototype.copy.call(t,e,n)}e.exports=function(){function t(){s(this,t),this.head=null,this.tail=null,this.length=0}return u(t,[{key:"push",value:function(t){var e={data:t,next:null};this.length>0?this.tail.next=e:this.head=e,this.tail=e,++this.length}},{key:"unshift",value:function(t){var e={data:t,next:this.head};0===this.length&&(this.tail=e),this.head=e,++this.length}},{key:"shift",value:function(){if(0!==this.length){var t=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,t}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(t){if(0===this.length)return"";var e=this.head,n=""+e.data;while(e=e.next)n+=t+e.data;return n}},{key:"concat",value:function(t){if(0===this.length)return l.alloc(0);var e=l.allocUnsafe(t>>>0),n=this.head,r=0;while(n)p(n.data,e,r),r+=n.data.length,n=n.next;return e}},{key:"consume",value:function(t,e){var n;return t<this.head.data.length?(n=this.head.data.slice(0,t),this.head.data=this.head.data.slice(t)):n=t===this.head.data.length?this.shift():e?this._getString(t):this._getBuffer(t),n}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(t){var e=this.head,n=1,r=e.data;t-=r.length;while(e=e.next){var i=e.data,o=t>i.length?i.length:t;if(o===i.length?r+=i:r+=i.slice(0,t),t-=o,0===t){o===i.length?(++n,e.next?this.head=e.next:this.head=this.tail=null):(this.head=e,e.data=i.slice(o));break}++n}return this.length-=n,r}},{key:"_getBuffer",value:function(t){var e=l.allocUnsafe(t),n=this.head,r=1;n.data.copy(e),t-=n.data.length;while(n=n.next){var i=n.data,o=t>i.length?i.length:t;if(i.copy(e,e.length-t,0,o),t-=o,0===t){o===i.length?(++r,n.next?this.head=n.next:this.head=this.tail=null):(this.head=n,n.data=i.slice(o));break}++r}return this.length-=r,e}},{key:d,value:function(t,e){return f(this,i({},e,{depth:0,customInspect:!1}))}}]),t}()},{buffer:14,util:13}],45:[function(t,e,n){(function(t){(function(){"use strict";function n(e,n){var o=this,a=this._readableState&&this._readableState.destroyed,u=this._writableState&&this._writableState.destroyed;return a||u?(n?n(e):e&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,t.nextTick(s,this,e)):t.nextTick(s,this,e)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(e||null,(function(e){!n&&e?o._writableState?o._writableState.errorEmitted?t.nextTick(i,o):(o._writableState.errorEmitted=!0,t.nextTick(r,o,e)):t.nextTick(r,o,e):n?(t.nextTick(i,o),n(e)):t.nextTick(i,o)})),this)}function r(t,e){s(t,e),i(t)}function i(t){t._writableState&&!t._writableState.emitClose||t._readableState&&!t._readableState.emitClose||t.emit("close")}function o(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function s(t,e){t.emit("error",e)}function a(t,e){var n=t._readableState,r=t._writableState;n&&n.autoDestroy||r&&r.autoDestroy?t.destroy(e):t.emit("error",e)}e.exports={destroy:n,undestroy:o,errorOrDestroy:a}}).call(this)}).call(this,t("_process"))},{_process:32}],46:[function(t,e,n){"use strict";var r=t("../../../errors").codes.ERR_STREAM_PREMATURE_CLOSE;function i(t){var e=!1;return function(){if(!e){e=!0;for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];t.apply(this,r)}}}function o(){}function s(t){return t.setHeader&&"function"===typeof t.abort}function a(t,e,n){if("function"===typeof e)return a(t,null,e);e||(e={}),n=i(n||o);var u=e.readable||!1!==e.readable&&t.readable,c=e.writable||!1!==e.writable&&t.writable,l=function(){t.writable||f()},h=t._writableState&&t._writableState.finished,f=function(){c=!1,h=!0,u||n.call(t)},d=t._readableState&&t._readableState.endEmitted,p=function(){u=!1,d=!0,c||n.call(t)},g=function(e){n.call(t,e)},m=function(){var e;return u&&!d?(t._readableState&&t._readableState.ended||(e=new r),n.call(t,e)):c&&!h?(t._writableState&&t._writableState.ended||(e=new r),n.call(t,e)):void 0},y=function(){t.req.on("finish",f)};return s(t)?(t.on("complete",f),t.on("abort",m),t.req?y():t.on("request",y)):c&&!t._writableState&&(t.on("end",l),t.on("close",l)),t.on("end",p),t.on("finish",f),!1!==e.error&&t.on("error",g),t.on("close",m),function(){t.removeListener("complete",f),t.removeListener("abort",m),t.removeListener("request",y),t.req&&t.req.removeListener("finish",f),t.removeListener("end",l),t.removeListener("close",l),t.removeListener("finish",f),t.removeListener("end",p),t.removeListener("error",g),t.removeListener("close",m)}}e.exports=a},{"../../../errors":37}],47:[function(t,e,n){e.exports=function(){throw new Error("Readable.from is not available in the browser")}},{}],48:[function(t,e,n){"use strict";var r;function i(t){var e=!1;return function(){e||(e=!0,t.apply(void 0,arguments))}}var o=t("../../../errors").codes,s=o.ERR_MISSING_ARGS,a=o.ERR_STREAM_DESTROYED;function u(t){if(t)throw t}function c(t){return t.setHeader&&"function"===typeof t.abort}function l(e,n,o,s){s=i(s);var u=!1;e.on("close",(function(){u=!0})),void 0===r&&(r=t("./end-of-stream")),r(e,{readable:n,writable:o},(function(t){if(t)return s(t);u=!0,s()}));var l=!1;return function(t){if(!u&&!l)return l=!0,c(e)?e.abort():"function"===typeof e.destroy?e.destroy():void s(t||new a("pipe"))}}function h(t){t()}function f(t,e){return t.pipe(e)}function d(t){return t.length?"function"!==typeof t[t.length-1]?u:t.pop():u}function p(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var r,i=d(e);if(Array.isArray(e[0])&&(e=e[0]),e.length<2)throw new s("streams");var o=e.map((function(t,n){var s=n<e.length-1,a=n>0;return l(t,s,a,(function(t){r||(r=t),t&&o.forEach(h),s||(o.forEach(h),i(r))}))}));return e.reduce(f)}e.exports=p},{"../../../errors":37,"./end-of-stream":46}],49:[function(t,e,n){"use strict";var r=t("../../../errors").codes.ERR_INVALID_OPT_VALUE;function i(t,e,n){return null!=t.highWaterMark?t.highWaterMark:e?t[n]:null}function o(t,e,n,o){var s=i(e,o,n);if(null!=s){if(!isFinite(s)||Math.floor(s)!==s||s<0){var a=o?n:"highWaterMark";throw new r(a,s)}return Math.floor(s)}return t.objectMode?16:16384}e.exports={getHighWaterMark:o}},{"../../../errors":37}],50:[function(t,e,n){e.exports=t("events").EventEmitter},{events:19}],51:[function(t,e,n){n=e.exports=t("./lib/_stream_readable.js"),n.Stream=n,n.Readable=n,n.Writable=t("./lib/_stream_writable.js"),n.Duplex=t("./lib/_stream_duplex.js"),n.Transform=t("./lib/_stream_transform.js"),n.PassThrough=t("./lib/_stream_passthrough.js"),n.finished=t("./lib/internal/streams/end-of-stream.js"),n.pipeline=t("./lib/internal/streams/pipeline.js")},{"./lib/_stream_duplex.js":38,"./lib/_stream_passthrough.js":39,"./lib/_stream_readable.js":40,"./lib/_stream_transform.js":41,"./lib/_stream_writable.js":42,"./lib/internal/streams/end-of-stream.js":46,"./lib/internal/streams/pipeline.js":48}],52:[function(t,e,n){"use strict";function r(t,e,n){var r=this;this._callback=t,this._args=n,this._interval=setInterval(t,e,this._args),this.reschedule=function(t){t||(t=r._interval),r._interval&&clearInterval(r._interval),r._interval=setInterval(r._callback,t,r._args)},this.clear=function(){r._interval&&(clearInterval(r._interval),r._interval=void 0)},this.destroy=function(){r._interval&&clearInterval(r._interval),r._callback=void 0,r._interval=void 0,r._args=void 0}}function i(){if("function"!==typeof arguments[0])throw new Error("callback needed");if("number"!==typeof arguments[1])throw new Error("interval needed");var t;if(arguments.length>0){t=new Array(arguments.length-2);for(var e=0;e<t.length;e++)t[e]=arguments[e+2]}return new r(arguments[0],arguments[1],t)}e.exports=i},{}],53:[function(t,e,n){
/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */
var r=t("buffer"),i=r.Buffer;function o(t,e){for(var n in t)e[n]=t[n]}function s(t,e,n){return i(t,e,n)}i.from&&i.alloc&&i.allocUnsafe&&i.allocUnsafeSlow?e.exports=r:(o(r,n),n.Buffer=s),s.prototype=Object.create(i.prototype),o(i,s),s.from=function(t,e,n){if("number"===typeof t)throw new TypeError("Argument must not be a number");return i(t,e,n)},s.alloc=function(t,e,n){if("number"!==typeof t)throw new TypeError("Argument must be a number");var r=i(t);return void 0!==e?"string"===typeof n?r.fill(e,n):r.fill(e):r.fill(0),r},s.allocUnsafe=function(t){if("number"!==typeof t)throw new TypeError("Argument must be a number");return i(t)},s.allocUnsafeSlow=function(t){if("number"!==typeof t)throw new TypeError("Argument must be a number");return r.SlowBuffer(t)}},{buffer:14}],54:[function(t,e,n){function r(t){var e=t._readableState;return e?e.objectMode||"number"===typeof t._duplexState?t.read():t.read(i(e)):null}function i(t){return t.buffer.length?t.buffer.head?t.buffer.head.data.length:t.buffer[0].length:t.length}e.exports=r},{}],55:[function(t,e,n){"use strict";var r=t("safe-buffer").Buffer,i=r.isEncoding||function(t){switch(t=""+t,t&&t.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function o(t){if(!t)return"utf8";var e;while(1)switch(t){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return t;default:if(e)return;t=(""+t).toLowerCase(),e=!0}}function s(t){var e=o(t);if("string"!==typeof e&&(r.isEncoding===i||!i(t)))throw new Error("Unknown encoding: "+t);return e||t}function a(t){var e;switch(this.encoding=s(t),this.encoding){case"utf16le":this.text=p,this.end=g,e=4;break;case"utf8":this.fillLast=h,e=4;break;case"base64":this.text=m,this.end=y,e=3;break;default:return this.write=v,void(this.end=b)}this.lastNeed=0,this.lastTotal=0,this.lastChar=r.allocUnsafe(e)}function u(t){return t<=127?0:t>>5===6?2:t>>4===14?3:t>>3===30?4:t>>6===2?-1:-2}function c(t,e,n){var r=e.length-1;if(r<n)return 0;var i=u(e[r]);return i>=0?(i>0&&(t.lastNeed=i-1),i):--r<n||-2===i?0:(i=u(e[r]),i>=0?(i>0&&(t.lastNeed=i-2),i):--r<n||-2===i?0:(i=u(e[r]),i>=0?(i>0&&(2===i?i=0:t.lastNeed=i-3),i):0))}function l(t,e,n){if(128!==(192&e[0]))return t.lastNeed=0,"�";if(t.lastNeed>1&&e.length>1){if(128!==(192&e[1]))return t.lastNeed=1,"�";if(t.lastNeed>2&&e.length>2&&128!==(192&e[2]))return t.lastNeed=2,"�"}}function h(t){var e=this.lastTotal-this.lastNeed,n=l(this,t,e);return void 0!==n?n:this.lastNeed<=t.length?(t.copy(this.lastChar,e,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(t.copy(this.lastChar,e,0,t.length),void(this.lastNeed-=t.length))}function f(t,e){var n=c(this,t,e);if(!this.lastNeed)return t.toString("utf8",e);this.lastTotal=n;var r=t.length-(n-this.lastNeed);return t.copy(this.lastChar,0,r),t.toString("utf8",e,r)}function d(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+"�":e}function p(t,e){if((t.length-e)%2===0){var n=t.toString("utf16le",e);if(n){var r=n.charCodeAt(n.length-1);if(r>=55296&&r<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1],n.slice(0,-1)}return n}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=t[t.length-1],t.toString("utf16le",e,t.length-1)}function g(t){var e=t&&t.length?this.write(t):"";if(this.lastNeed){var n=this.lastTotal-this.lastNeed;return e+this.lastChar.toString("utf16le",0,n)}return e}function m(t,e){var n=(t.length-e)%3;return 0===n?t.toString("base64",e):(this.lastNeed=3-n,this.lastTotal=3,1===n?this.lastChar[0]=t[t.length-1]:(this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1]),t.toString("base64",e,t.length-n))}function y(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+this.lastChar.toString("base64",0,3-this.lastNeed):e}function v(t){return t.toString(this.encoding)}function b(t){return t&&t.length?this.write(t):""}n.StringDecoder=a,a.prototype.write=function(t){if(0===t.length)return"";var e,n;if(this.lastNeed){if(e=this.fillLast(t),void 0===e)return"";n=this.lastNeed,this.lastNeed=0}else n=0;return n<t.length?e?e+this.text(t,n):this.text(t,n):e||""},a.prototype.end=d,a.prototype.text=f,a.prototype.fillLast=function(t){if(this.lastNeed<=t.length)return t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,t.length),this.lastNeed-=t.length}},{"safe-buffer":53}],56:[function(t,e,n){"use strict";var r=t("punycode"),i=t("./util");function o(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}n.parse=w,n.resolve=S,n.resolveObject=E,n.format=x,n.Url=o;var s=/^([a-z0-9.+-]+:)/i,a=/:[0-9]*$/,u=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,c=["<",">",'"',"`"," ","\r","\n","\t"],l=["{","}","|","\\","^","`"].concat(c),h=["'"].concat(l),f=["%","/","?",";","#"].concat(h),d=["/","?","#"],p=255,g=/^[+a-z0-9A-Z_-]{0,63}$/,m=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,y={javascript:!0,"javascript:":!0},v={javascript:!0,"javascript:":!0},b={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},_=t("querystring");function w(t,e,n){if(t&&i.isObject(t)&&t instanceof o)return t;var r=new o;return r.parse(t,e,n),r}function x(t){return i.isString(t)&&(t=w(t)),t instanceof o?t.format():o.prototype.format.call(t)}function S(t,e){return w(t,!1,!0).resolve(e)}function E(t,e){return t?w(t,!1,!0).resolveObject(e):e}o.prototype.parse=function(t,e,n){if(!i.isString(t))throw new TypeError("Parameter 'url' must be a string, not "+typeof t);var o=t.indexOf("?"),a=-1!==o&&o<t.indexOf("#")?"?":"#",c=t.split(a),l=/\\/g;c[0]=c[0].replace(l,"/"),t=c.join(a);var w=t;if(w=w.trim(),!n&&1===t.split("#").length){var x=u.exec(w);if(x)return this.path=w,this.href=w,this.pathname=x[1],x[2]?(this.search=x[2],this.query=e?_.parse(this.search.substr(1)):this.search.substr(1)):e&&(this.search="",this.query={}),this}var S=s.exec(w);if(S){S=S[0];var E=S.toLowerCase();this.protocol=E,w=w.substr(S.length)}if(n||S||w.match(/^\/\/[^@\/]+@[^@\/]+/)){var A="//"===w.substr(0,2);!A||S&&v[S]||(w=w.substr(2),this.slashes=!0)}if(!v[S]&&(A||S&&!b[S])){for(var M,C,k=-1,O=0;O<d.length;O++){var P=w.indexOf(d[O]);-1!==P&&(-1===k||P<k)&&(k=P)}C=-1===k?w.lastIndexOf("@"):w.lastIndexOf("@",k),-1!==C&&(M=w.slice(0,C),w=w.slice(C+1),this.auth=decodeURIComponent(M)),k=-1;for(O=0;O<f.length;O++){P=w.indexOf(f[O]);-1!==P&&(-1===k||P<k)&&(k=P)}-1===k&&(k=w.length),this.host=w.slice(0,k),w=w.slice(k),this.parseHost(),this.hostname=this.hostname||"";var T="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!T)for(var L=this.hostname.split(/\./),I=(O=0,L.length);O<I;O++){var N=L[O];if(N&&!N.match(g)){for(var D="",R=0,F=N.length;R<F;R++)N.charCodeAt(R)>127?D+="x":D+=N[R];if(!D.match(g)){var B=L.slice(0,O),j=L.slice(O+1),z=N.match(m);z&&(B.push(z[1]),j.unshift(z[2])),j.length&&(w="/"+j.join(".")+w),this.hostname=B.join(".");break}}}this.hostname.length>p?this.hostname="":this.hostname=this.hostname.toLowerCase(),T||(this.hostname=r.toASCII(this.hostname));var U=this.port?":"+this.port:"",$=this.hostname||"";this.host=$+U,this.href+=this.host,T&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==w[0]&&(w="/"+w))}if(!y[E])for(O=0,I=h.length;O<I;O++){var V=h[O];if(-1!==w.indexOf(V)){var q=encodeURIComponent(V);q===V&&(q=escape(V)),w=w.split(V).join(q)}}var W=w.indexOf("#");-1!==W&&(this.hash=w.substr(W),w=w.slice(0,W));var G=w.indexOf("?");if(-1!==G?(this.search=w.substr(G),this.query=w.substr(G+1),e&&(this.query=_.parse(this.query)),w=w.slice(0,G)):e&&(this.search="",this.query={}),w&&(this.pathname=w),b[E]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){U=this.pathname||"";var H=this.search||"";this.path=U+H}return this.href=this.format(),this},o.prototype.format=function(){var t=this.auth||"";t&&(t=encodeURIComponent(t),t=t.replace(/%3A/i,":"),t+="@");var e=this.protocol||"",n=this.pathname||"",r=this.hash||"",o=!1,s="";this.host?o=t+this.host:this.hostname&&(o=t+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(o+=":"+this.port)),this.query&&i.isObject(this.query)&&Object.keys(this.query).length&&(s=_.stringify(this.query));var a=this.search||s&&"?"+s||"";return e&&":"!==e.substr(-1)&&(e+=":"),this.slashes||(!e||b[e])&&!1!==o?(o="//"+(o||""),n&&"/"!==n.charAt(0)&&(n="/"+n)):o||(o=""),r&&"#"!==r.charAt(0)&&(r="#"+r),a&&"?"!==a.charAt(0)&&(a="?"+a),n=n.replace(/[?#]/g,(function(t){return encodeURIComponent(t)})),a=a.replace("#","%23"),e+o+n+a+r},o.prototype.resolve=function(t){return this.resolveObject(w(t,!1,!0)).format()},o.prototype.resolveObject=function(t){if(i.isString(t)){var e=new o;e.parse(t,!1,!0),t=e}for(var n=new o,r=Object.keys(this),s=0;s<r.length;s++){var a=r[s];n[a]=this[a]}if(n.hash=t.hash,""===t.href)return n.href=n.format(),n;if(t.slashes&&!t.protocol){for(var u=Object.keys(t),c=0;c<u.length;c++){var l=u[c];"protocol"!==l&&(n[l]=t[l])}return b[n.protocol]&&n.hostname&&!n.pathname&&(n.path=n.pathname="/"),n.href=n.format(),n}if(t.protocol&&t.protocol!==n.protocol){if(!b[t.protocol]){for(var h=Object.keys(t),f=0;f<h.length;f++){var d=h[f];n[d]=t[d]}return n.href=n.format(),n}if(n.protocol=t.protocol,t.host||v[t.protocol])n.pathname=t.pathname;else{var p=(t.pathname||"").split("/");while(p.length&&!(t.host=p.shift()));t.host||(t.host=""),t.hostname||(t.hostname=""),""!==p[0]&&p.unshift(""),p.length<2&&p.unshift(""),n.pathname=p.join("/")}if(n.search=t.search,n.query=t.query,n.host=t.host||"",n.auth=t.auth,n.hostname=t.hostname||t.host,n.port=t.port,n.pathname||n.search){var g=n.pathname||"",m=n.search||"";n.path=g+m}return n.slashes=n.slashes||t.slashes,n.href=n.format(),n}var y=n.pathname&&"/"===n.pathname.charAt(0),_=t.host||t.pathname&&"/"===t.pathname.charAt(0),w=_||y||n.host&&t.pathname,x=w,S=n.pathname&&n.pathname.split("/")||[],E=(p=t.pathname&&t.pathname.split("/")||[],n.protocol&&!b[n.protocol]);if(E&&(n.hostname="",n.port=null,n.host&&(""===S[0]?S[0]=n.host:S.unshift(n.host)),n.host="",t.protocol&&(t.hostname=null,t.port=null,t.host&&(""===p[0]?p[0]=t.host:p.unshift(t.host)),t.host=null),w=w&&(""===p[0]||""===S[0])),_)n.host=t.host||""===t.host?t.host:n.host,n.hostname=t.hostname||""===t.hostname?t.hostname:n.hostname,n.search=t.search,n.query=t.query,S=p;else if(p.length)S||(S=[]),S.pop(),S=S.concat(p),n.search=t.search,n.query=t.query;else if(!i.isNullOrUndefined(t.search)){if(E){n.hostname=n.host=S.shift();var A=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@");A&&(n.auth=A.shift(),n.host=n.hostname=A.shift())}return n.search=t.search,n.query=t.query,i.isNull(n.pathname)&&i.isNull(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.href=n.format(),n}if(!S.length)return n.pathname=null,n.search?n.path="/"+n.search:n.path=null,n.href=n.format(),n;for(var M=S.slice(-1)[0],C=(n.host||t.host||S.length>1)&&("."===M||".."===M)||""===M,k=0,O=S.length;O>=0;O--)M=S[O],"."===M?S.splice(O,1):".."===M?(S.splice(O,1),k++):k&&(S.splice(O,1),k--);if(!w&&!x)for(;k--;k)S.unshift("..");!w||""===S[0]||S[0]&&"/"===S[0].charAt(0)||S.unshift(""),C&&"/"!==S.join("/").substr(-1)&&S.push("");var P=""===S[0]||S[0]&&"/"===S[0].charAt(0);if(E){n.hostname=n.host=P?"":S.length?S.shift():"";A=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@");A&&(n.auth=A.shift(),n.host=n.hostname=A.shift())}return w=w||n.host&&S.length,w&&!P&&S.unshift(""),S.length?n.pathname=S.join("/"):(n.pathname=null,n.path=null),i.isNull(n.pathname)&&i.isNull(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.auth=t.auth||n.auth,n.slashes=n.slashes||t.slashes,n.href=n.format(),n},o.prototype.parseHost=function(){var t=this.host,e=a.exec(t);e&&(e=e[0],":"!==e&&(this.port=e.substr(1)),t=t.substr(0,t.length-e.length)),t&&(this.hostname=t)}},{"./util":57,punycode:33,querystring:36}],57:[function(t,e,n){"use strict";e.exports={isString:function(t){return"string"===typeof t},isObject:function(t){return"object"===typeof t&&null!==t},isNull:function(t){return null===t},isNullOrUndefined:function(t){return null==t}}},{}],58:[function(t,n,r){(function(t){(function(){function e(t,e){if(r("noDeprecation"))return t;var n=!1;function i(){if(!n){if(r("throwDeprecation"))throw new Error(e);r("traceDeprecation")?console.trace(e):console.warn(e),n=!0}return t.apply(this,arguments)}return i}function r(e){try{if(!t.localStorage)return!1}catch(r){return!1}var n=t.localStorage[e];return null!=n&&"true"===String(n).toLowerCase()}n.exports=e}).call(this)}).call(this,"undefined"!==typeof e?e:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{}],59:[function(t,e,n){function r(t,e){if(t&&e)return r(t)(e);if("function"!==typeof t)throw new TypeError("need wrapper function");return Object.keys(t).forEach((function(e){n[e]=t[e]})),n;function n(){for(var e=new Array(arguments.length),n=0;n<e.length;n++)e[n]=arguments[n];var r=t.apply(this,e),i=e[e.length-1];return"function"===typeof r&&r!==i&&Object.keys(i).forEach((function(t){r[t]=i[t]})),r}}e.exports=r},{}],60:[function(t,e,n){"use strict";e.exports=function(){throw new Error("ws does not work in the browser. Browser clients must use the native WebSocket object")}},{}],61:[function(t,e,n){e.exports=i;var r=Object.prototype.hasOwnProperty;function i(){for(var t={},e=0;e<arguments.length;e++){var n=arguments[e];for(var i in n)r.call(n,i)&&(t[i]=n[i])}return t}},{}]},{},[9])(9)}))}).call(this,n("c8ba"))},"6eb2":function(t,e,n){"use strict";var r=n("18e2"),i=n("1738"),o=Object(r["a"])((function(t){t.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCDate(t.getUTCDate()+e)}),(function(t,e){return(e-t)/i["a"]}),(function(t){return t.getUTCDate()-1}));e["a"]=o;o.range},7:function(t,e){},7037:function(t,e,n){function r(t){return r="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(t)}function i(t){return i="function"===typeof Symbol&&"symbol"===r(Symbol.iterator)?function(t){return r(t)}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":r(t)},i(t)}function o(e){return"function"===typeof Symbol&&"symbol"===i(Symbol.iterator)?t.exports=o=function(t){return i(t)}:t.exports=o=function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":i(t)},o(e)}n("a4d3"),n("e01a"),n("d3b7"),n("d28b"),n("3ca3"),n("ddb0"),t.exports=o},7197:function(t,e,n){},"71cd":function(t,e,n){"use strict";(function(t){var r=n("4ea4");Object.defineProperty(e,"__esModule",{value:!0}),e.default=s,e.isBrowserMainThread=a;var i=r(n("7037")),o=r(n("f71a"));function s(){var e="object"===("undefined"===typeof t?"undefined":(0,i.default)(t))&&"[object process]"===String(t)&&!t.browser;return!e||(0,o.default)()}function a(){return s()&&"undefined"!==typeof document}}).call(this,n("4362"))},"724b":function(t,e,n){"use strict";var r=n("4ea4");Object.defineProperty(e,"__esModule",{value:!0}),e.isMobile=a,e.default=u;var i=n("331d"),o=r(n("8007")),s=r(n("9d38"));function a(){return"undefined"!==typeof i.window.orientation}function u(t){if(!t&&!(0,o.default)())return"Node";if((0,s.default)(t))return"Electron";var e="undefined"!==typeof navigator?navigator:{},n=t||e.userAgent||"";if(n.indexOf("Edge")>-1)return"Edge";var r=-1!==n.indexOf("MSIE "),a=-1!==n.indexOf("Trident/");return r||a?"IE":i.window.chrome?"Chrome":i.window.safari?"Safari":i.window.mozInnerScreenX?"Firefox":"Unknown"}},"742c":function(t,e,n){"use strict";var r=n("18e2"),i=n("1738"),o=Object(r["a"])(t=>t.setHours(0,0,0,0),(t,e)=>t.setDate(t.getDate()+e),(t,e)=>(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*i["c"])/i["a"],t=>t.getDate()-1);e["a"]=o;o.range},"744a":function(t,e,n){"use strict";n.d(e,"c",(function(){return i})),n.d(e,"a",(function(){return o})),n.d(e,"d",(function(){return s})),n.d(e,"b",(function(){return a}));var r=n("20a4");const i=(()=>{const t="function"===typeof Promise&&"function"===typeof Promise.resolve;return t?t=>Promise.resolve().then(t):(t,e)=>e(t,0)})(),o=r["a"].WebSocket||r["a"].MozWebSocket,s=!0,a="arraybuffer"},7634:function(t,e,n){"use strict";var r,i,o;(function(n,s){i=[],r=s,o="function"===typeof r?r.apply(e,i):r,void 0===o||(t.exports=o)})(0,(function(){function t(){return!0}function e(){return!1}function n(){}function r(){var i=[{name:"number",test:function(t){return"number"===typeof t}},{name:"string",test:function(t){return"string"===typeof t}},{name:"boolean",test:function(t){return"boolean"===typeof t}},{name:"Function",test:function(t){return"function"===typeof t}},{name:"Array",test:Array.isArray},{name:"Date",test:function(t){return t instanceof Date}},{name:"RegExp",test:function(t){return t instanceof RegExp}},{name:"Object",test:function(t){return"object"===typeof t&&null!==t&&t.constructor===Object}},{name:"null",test:function(t){return null===t}},{name:"undefined",test:function(t){return void 0===t}}],o={name:"any",test:t},s=[],a=[],u={types:i,conversions:a,ignore:s};function c(t){var e=X(u.types,(function(e){return e.name===t}));if(e)return e;if("any"===t)return o;var n=X(u.types,(function(e){return e.name.toLowerCase()===t.toLowerCase()}));throw new TypeError('Unknown type "'+t+'"'+(n?'. Did you mean "'+n.name+'"?':""))}function l(t){return t===o?999:u.types.indexOf(t)}function h(t){var e=X(u.types,(function(e){return e.test(t)}));if(e)return e.name;throw new TypeError("Value has unknown type. Value: "+t)}function f(t,e){if(!t.signatures)throw new TypeError("Function is no typed-function");var n;if("string"===typeof e){n=e.split(",");for(var r=0;r<n.length;r++)n[r]=n[r].trim()}else{if(!Array.isArray(e))throw new TypeError("String array or a comma separated string expected");n=e}var i=n.join(","),o=t.signatures[i];if(o)return o;throw new TypeError("Signature not found (signature: "+(t.name||"unnamed")+"("+n.join(", ")+"))")}function d(t,e){var n=h(t);if(e===n)return t;for(var r=0;r<u.conversions.length;r++){var i=u.conversions[r];if(i.from===n&&i.to===e)return i.convert(t)}throw new Error("Cannot convert from "+n+" to "+e)}function p(t){return t.map((function(t){var e=t.types.map(S);return(t.restParam?"...":"")+e.join("|")})).join(",")}function g(t,e){var n=0===t.indexOf("..."),r=n?t.length>3?t.slice(3):"any":t,i=r.split("|").map(j).filter(z).filter(B),o=T(e,i),s=i.map((function(t){var e=c(t);return{name:t,typeIndex:l(e),test:e.test,conversion:null,conversionIndex:-1}})),a=o.map((function(t){var n=c(t.from);return{name:t.from,typeIndex:l(n),test:n.test,conversion:t,conversionIndex:e.indexOf(t)}}));return{types:s.concat(a),restParam:n}}function m(t,e,n){var r=[];return""!==t.trim()&&(r=t.split(",").map(j).map((function(t,e,r){var i=g(t,n);if(i.restParam&&e!==r.length-1)throw new SyntaxError('Unexpected rest parameter "'+t+'": only allowed for the last parameter');return i}))),r.some($)?null:{params:r,fn:e}}function y(t){var e=q(t);return!!e&&e.restParam}function v(t){return t.types.some((function(t){return null!=t.conversion}))}function b(e){if(e&&0!==e.types.length){if(1===e.types.length)return c(e.types[0].name).test;if(2===e.types.length){var n=c(e.types[0].name).test,r=c(e.types[1].name).test;return function(t){return n(t)||r(t)}}var i=e.types.map((function(t){return c(t.name).test}));return function(t){for(var e=0;e<i.length;e++)if(i[e](t))return!0;return!1}}return t}function _(t){var e,n,r;if(y(t)){e=V(t).map(b);var i=e.length,o=b(q(t)),s=function(t){for(var e=i;e<t.length;e++)if(!o(t[e]))return!1;return!0};return function(t){for(var n=0;n<e.length;n++)if(!e[n](t[n]))return!1;return s(t)&&t.length>=i+1}}return 0===t.length?function(t){return 0===t.length}:1===t.length?(n=b(t[0]),function(t){return n(t[0])&&1===t.length}):2===t.length?(n=b(t[0]),r=b(t[1]),function(t){return n(t[0])&&r(t[1])&&2===t.length}):(e=t.map(b),function(t){for(var n=0;n<e.length;n++)if(!e[n](t[n]))return!1;return t.length===e.length})}function w(t,e){return e<t.params.length?t.params[e]:y(t.params)?q(t.params):null}function x(t,e,n){var r=w(t,e),i=r?n?r.types.filter(E):r.types:[];return i.map(S)}function S(t){return t.name}function E(t){return null===t.conversion||void 0===t.conversion}function A(t,e){var n=Y(Z(t,(function(t){return x(t,e,!1)})));return-1!==n.indexOf("any")?["any"]:n}function M(t,e,n){var r,i,o,s=t||"unnamed",a=n;for(o=0;o<e.length;o++){var u=a.filter((function(t){var n=b(w(t,o));return(o<t.params.length||y(t.params))&&n(e[o])}));if(0===u.length){if(i=A(a,o),i.length>0){var c=h(e[o]);return r=new TypeError("Unexpected type of argument in function "+s+" (expected: "+i.join(" or ")+", actual: "+c+", index: "+o+")"),r.data={category:"wrongType",fn:s,index:o,actual:c,expected:i},r}}else a=u}var l=a.map((function(t){return y(t.params)?1/0:t.params.length}));if(e.length<Math.min.apply(null,l))return i=A(a,o),r=new TypeError("Too few arguments in function "+s+" (expected: "+i.join(" or ")+", index: "+e.length+")"),r.data={category:"tooFewArgs",fn:s,index:e.length,expected:i},r;var f=Math.max.apply(null,l);return e.length>f?(r=new TypeError("Too many arguments in function "+s+" (expected: "+f+", actual: "+e.length+")"),r.data={category:"tooManyArgs",fn:s,index:e.length,expectedLength:f},r):(r=new TypeError('Arguments of type "'+e.join(", ")+'" do not match any of the defined signatures of function '+s+"."),r.data={category:"mismatch",actual:e.map(h)},r)}function C(t){for(var e=999,n=0;n<t.types.length;n++)E(t.types[n])&&(e=Math.min(e,t.types[n].typeIndex));return e}function k(t){for(var e=999,n=0;n<t.types.length;n++)E(t.types[n])||(e=Math.min(e,t.types[n].conversionIndex));return e}function O(t,e){var n;return n=t.restParam-e.restParam,0!==n?n:(n=v(t)-v(e),0!==n?n:(n=C(t)-C(e),0!==n?n:k(t)-k(e)))}function P(t,e){var n,r,i=Math.min(t.params.length,e.params.length);if(r=t.params.some(v)-e.params.some(v),0!==r)return r;for(n=0;n<i;n++)if(r=v(t.params[n])-v(e.params[n]),0!==r)return r;for(n=0;n<i;n++)if(r=O(t.params[n],e.params[n]),0!==r)return r;return t.params.length-e.params.length}function T(t,e){var n={};return t.forEach((function(t){-1!==e.indexOf(t.from)||-1===e.indexOf(t.to)||n[t.from]||(n[t.from]=t)})),Object.keys(n).map((function(t){return n[t]}))}function L(t,e){var n=e;if(t.some(v)){var r=y(t),i=t.map(I);n=function(){for(var t=[],n=r?arguments.length-1:arguments.length,o=0;o<n;o++)t[o]=i[o](arguments[o]);return r&&(t[n]=arguments[n].map(i[n])),e.apply(this,t)}}var o=n;if(y(t)){var s=t.length-1;o=function(){return n.apply(this,W(arguments,0,s).concat([W(arguments,s)]))}}return o}function I(t){var e,n,r,i,o=[],s=[];switch(t.types.forEach((function(t){t.conversion&&(o.push(c(t.conversion.from).test),s.push(t.conversion.convert))})),s.length){case 0:return function(t){return t};case 1:return e=o[0],r=s[0],function(t){return e(t)?r(t):t};case 2:return e=o[0],n=o[1],r=s[0],i=s[1],function(t){return e(t)?r(t):n(t)?i(t):t};default:return function(t){for(var e=0;e<s.length;e++)if(o[e](t))return s[e](t);return t}}}function N(t){var e={};return t.forEach((function(t){t.params.some(v)||D(t.params,!0).forEach((function(n){e[p(n)]=t.fn}))})),e}function D(t,e){function n(t,r,i){if(r<t.length){var o,s=t[r],a=e?s.types.filter(E):s.types;if(s.restParam){var u=a.filter(E);o=u.length<a.length?[u,a]:[a]}else o=a.map((function(t){return[t]}));return Z(o,(function(e){return n(t,r+1,i.concat([e]))}))}var c=i.map((function(e,n){return{types:e,restParam:n===t.length-1&&y(t)}}));return[c]}return n(t,0,[])}function R(t,e){for(var n=Math.max(t.params.length,e.params.length),r=0;r<n;r++){var i=x(t,r,!0),o=x(e,r,!0);if(!H(i,o))return!1}var s=t.params.length,a=e.params.length,u=y(t.params),c=y(e.params);return u?c?s===a:a>=s:c?s>=a:s===a}function F(t,r){if(0===Object.keys(r).length)throw new SyntaxError("No signatures provided");var i=[];Object.keys(r).map((function(t){return m(t,r[t],u.conversions)})).filter(U).forEach((function(t){var e=X(i,(function(e){return R(e,t)}));if(e)throw new TypeError('Conflicting signatures "'+p(e.params)+'" and "'+p(t.params)+'".');i.push(t)}));var o=Z(i,(function(t){var e=t?D(t.params,!1):[];return e.map((function(e){return{params:e,fn:t.fn}}))})).filter(U);o.sort(P);var s=o[0]&&o[0].params.length<=2&&!y(o[0].params),a=o[1]&&o[1].params.length<=2&&!y(o[1].params),c=o[2]&&o[2].params.length<=2&&!y(o[2].params),l=o[3]&&o[3].params.length<=2&&!y(o[3].params),h=o[4]&&o[4].params.length<=2&&!y(o[4].params),f=o[5]&&o[5].params.length<=2&&!y(o[5].params),d=s&&a&&c&&l&&h&&f,g=o.map((function(t){return _(t.params)})),v=s?b(o[0].params[0]):e,w=a?b(o[1].params[0]):e,x=c?b(o[2].params[0]):e,S=l?b(o[3].params[0]):e,E=h?b(o[4].params[0]):e,A=f?b(o[5].params[0]):e,C=s?b(o[0].params[1]):e,k=a?b(o[1].params[1]):e,O=c?b(o[2].params[1]):e,T=l?b(o[3].params[1]):e,I=h?b(o[4].params[1]):e,F=f?b(o[5].params[1]):e,B=o.map((function(t){return L(t.params,t.fn)})),j=s?B[0]:n,z=a?B[1]:n,$=c?B[2]:n,V=l?B[3]:n,q=h?B[4]:n,W=f?B[5]:n,G=s?o[0].params.length:-1,H=a?o[1].params.length:-1,Y=c?o[2].params.length:-1,K=l?o[3].params.length:-1,J=h?o[4].params.length:-1,Q=f?o[5].params.length:-1,tt=d?6:0,et=o.length,nt=function(){for(var e=tt;e<et;e++)if(g[e](arguments))return B[e].apply(this,arguments);throw M(t,arguments,o)},rt=function t(e,n){return arguments.length===G&&v(e)&&C(n)?j.apply(t,arguments):arguments.length===H&&w(e)&&k(n)?z.apply(t,arguments):arguments.length===Y&&x(e)&&O(n)?$.apply(t,arguments):arguments.length===K&&S(e)&&T(n)?V.apply(t,arguments):arguments.length===J&&E(e)&&I(n)?q.apply(t,arguments):arguments.length===Q&&A(e)&&F(n)?W.apply(t,arguments):nt.apply(t,arguments)};try{Object.defineProperty(rt,"name",{value:t})}catch(it){}return rt.signatures=N(o),rt}function B(t){return-1===u.ignore.indexOf(t)}function j(t){return t.trim()}function z(t){return!!t}function U(t){return null!==t}function $(t){return 0===t.types.length}function V(t){return t.slice(0,t.length-1)}function q(t){return t[t.length-1]}function W(t,e,n){return Array.prototype.slice.call(t,e,n)}function G(t,e){return-1!==t.indexOf(e)}function H(t,e){for(var n=0;n<t.length;n++)if(G(e,t[n]))return!0;return!1}function X(t,e){for(var n=0;n<t.length;n++)if(e(t[n]))return t[n]}function Y(t){for(var e={},n=0;n<t.length;n++)e[t[n]]=!0;return Object.keys(e)}function Z(t,e){return Array.prototype.concat.apply([],t.map(e))}function K(t){for(var e="",n=0;n<t.length;n++){var r=t[n];if(("object"===typeof r.signatures||"string"===typeof r.signature)&&""!==r.name)if(""===e)e=r.name;else if(e!==r.name){var i=new Error("Function names do not match (expected: "+e+", actual: "+r.name+")");throw i.data={actual:r.name,expected:e},i}}return e}function J(t){var e,n={};function r(t,r){if(n.hasOwnProperty(t)&&r!==n[t])throw e=new Error('Signature "'+t+'" is defined twice'),e.data={signature:t},e}for(var i=0;i<t.length;i++){var o=t[i];if("object"===typeof o.signatures)for(var s in o.signatures)o.signatures.hasOwnProperty(s)&&(r(s,o.signatures[s]),n[s]=o.signatures[s]);else{if("string"!==typeof o.signature)throw e=new TypeError("Function is no typed-function (index: "+i+")"),e.data={index:i},e;r(o.signature,o),n[o.signature]=o}}return n}return u=F("typed",{"string, Object":F,Object:function(t){var e=[];for(var n in t)t.hasOwnProperty(n)&&e.push(t[n]);var r=K(e);return F(r,t)},"...Function":function(t){return F(K(t),J(t))},"string, ...Function":function(t,e){return F(t,J(e))}}),u.create=r,u.types=i,u.conversions=a,u.ignore=s,u.convert=d,u.find=f,u.addType=function(t,e){if(!t||"string"!==typeof t.name||"function"!==typeof t.test)throw new TypeError("Object with properties {name: string, test: function} expected");if(!1!==e)for(var n=0;n<u.types.length;n++)if("Object"===u.types[n].name)return void u.types.splice(n,0,t);u.types.push(t)},u.addConversion=function(t){if(!t||"string"!==typeof t.from||"string"!==typeof t.to||"function"!==typeof t.convert)throw new TypeError("Object with properties {from: string, to: string, convert: function} expected");u.conversions.push(t)},u}return r()}))},7746:function(t,e,n){(function(t){var r;(function(t,i,o){function s(t){var e=this;function n(t,e){var n,r,i,o,s,a=[],u=128;for(e===(0|e)?(r=e,e=null):(e+="\0",r=0,u=Math.max(u,e.length)),i=0,o=-32;o<u;++o)e&&(r^=e.charCodeAt((o+32)%e.length)),0===o&&(s=r),r^=r<<10,r^=r>>>15,r^=r<<4,r^=r>>>13,o>=0&&(s=s+1640531527|0,n=a[127&o]^=r+s,i=0==n?i+1:0);for(i>=128&&(a[127&(e&&e.length||0)]=-1),i=127,o=512;o>0;--o)r=a[i+34&127],n=a[i=i+1&127],r^=r<<13,n^=n<<17,r^=r>>>15,n^=n>>>12,a[i]=r^n;t.w=s,t.X=a,t.i=i}e.next=function(){var t,n,r=e.w,i=e.X,o=e.i;return e.w=r=r+1640531527|0,n=i[o+34&127],t=i[o=o+1&127],n^=n<<13,t^=t<<17,n^=n>>>15,t^=t>>>12,n=i[o]=n^t,e.i=o,n+(r^r>>>16)|0},n(e,t)}function a(t,e){return e.i=t.i,e.w=t.w,e.X=t.X.slice(),e}function u(t,e){null==t&&(t=+new Date);var n=new s(t),r=e&&e.state,i=function(){return(n.next()>>>0)/4294967296};return i.double=function(){do{var t=n.next()>>>11,e=(n.next()>>>0)/4294967296,r=(t+e)/(1<<21)}while(0===r);return r},i.int32=n.next,i.quick=i,r&&(r.X&&a(r,n),i.state=function(){return a(n,{})}),i}i&&i.exports?i.exports=u:n("07d6")&&n("3c35")?(r=function(){return u}.call(e,n,e,i),void 0===r||(i.exports=r)):this.xor4096=u})(0,t,n("07d6"))}).call(this,n("62e4")(t))},"77ae":function(t,e,n){"use strict";(function(t,r){n.d(e,"a",(function(){return o})),n.d(e,"b",(function(){return s}));const i={self:"undefined"!==typeof self&&self,window:"undefined"!==typeof window&&window,global:"undefined"!==typeof t&&t,document:"undefined"!==typeof document&&document},o=(i.self||i.window||i.global,i.window||i.self||i.global,i.global||i.self||i.window),s=(i.document,"object"!==typeof r||"[object process]"!==String(r)||r.browser),a="undefined"!==typeof r&&r.version&&/v([0-9]*)/.exec(r.version);a&&parseFloat(a[1])}).call(this,n("c8ba"),n("4362"))},"77ae4":function(t,e,n){"use strict";var r=n("18e2"),i=Object(r["a"])((function(t){t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCFullYear(t.getUTCFullYear()+e)}),(function(t,e){return e.getUTCFullYear()-t.getUTCFullYear()}),(function(t){return t.getUTCFullYear()}));i.every=function(t){return isFinite(t=Math.floor(t))&&t>0?Object(r["a"])((function(e){e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)}),(function(e,n){e.setUTCFullYear(e.getUTCFullYear()+n*t)})):null},e["a"]=i;i.range},7909:function(t,e,n){"use strict";n.d(e,"a",(function(){return Zs})),n.d(e,"b",(function(){return na})),n.d(e,"c",(function(){return ra}));var r=n("4c47"),i=n.n(r),o={epsilon:1e-12,matrix:"Matrix",number:"number",precision:64,predictable:!1,randomSeed:null};function s(t){return"number"===typeof t}function a(t){return!(!t||"object"!==typeof t||"function"!==typeof t.constructor)&&(!0===t.isBigNumber&&"object"===typeof t.constructor.prototype&&!0===t.constructor.prototype.isBigNumber||"function"===typeof t.constructor.isDecimal&&!0===t.constructor.isDecimal(t))}function u(t){return t&&"object"===typeof t&&!0===Object.getPrototypeOf(t).isComplex||!1}function c(t){return t&&"object"===typeof t&&!0===Object.getPrototypeOf(t).isFraction||!1}function l(t){return t&&!0===t.constructor.prototype.isUnit||!1}function h(t){return"string"===typeof t}var f=Array.isArray;function d(t){return t&&!0===t.constructor.prototype.isMatrix||!1}function p(t){return Array.isArray(t)||d(t)}function g(t){return t&&t.isDenseMatrix&&!0===t.constructor.prototype.isMatrix||!1}function m(t){return t&&t.isSparseMatrix&&!0===t.constructor.prototype.isMatrix||!1}function y(t){return t&&!0===t.constructor.prototype.isRange||!1}function v(t){return t&&!0===t.constructor.prototype.isIndex||!1}function b(t){return"boolean"===typeof t}function _(t){return t&&!0===t.constructor.prototype.isResultSet||!1}function w(t){return t&&!0===t.constructor.prototype.isHelp||!1}function x(t){return"function"===typeof t}function S(t){return t instanceof Date}function E(t){return t instanceof RegExp}function A(t){return!(!t||"object"!==typeof t||t.constructor!==Object||u(t)||c(t))}function M(t){return null===t}function C(t){return void 0===t}function k(t){return t&&!0===t.isAccessorNode&&!0===t.constructor.prototype.isNode||!1}function O(t){return t&&!0===t.isArrayNode&&!0===t.constructor.prototype.isNode||!1}function P(t){return t&&!0===t.isAssignmentNode&&!0===t.constructor.prototype.isNode||!1}function T(t){return t&&!0===t.isBlockNode&&!0===t.constructor.prototype.isNode||!1}function L(t){return t&&!0===t.isConditionalNode&&!0===t.constructor.prototype.isNode||!1}function I(t){return t&&!0===t.isConstantNode&&!0===t.constructor.prototype.isNode||!1}function N(t){return t&&!0===t.isFunctionAssignmentNode&&!0===t.constructor.prototype.isNode||!1}function D(t){return t&&!0===t.isFunctionNode&&!0===t.constructor.prototype.isNode||!1}function R(t){return t&&!0===t.isIndexNode&&!0===t.constructor.prototype.isNode||!1}function F(t){return t&&!0===t.isNode&&!0===t.constructor.prototype.isNode||!1}function B(t){return t&&!0===t.isObjectNode&&!0===t.constructor.prototype.isNode||!1}function j(t){return t&&!0===t.isOperatorNode&&!0===t.constructor.prototype.isNode||!1}function z(t){return t&&!0===t.isParenthesisNode&&!0===t.constructor.prototype.isNode||!1}function U(t){return t&&!0===t.isRangeNode&&!0===t.constructor.prototype.isNode||!1}function $(t){return t&&!0===t.isSymbolNode&&!0===t.constructor.prototype.isNode||!1}function V(t){return t&&!0===t.constructor.prototype.isChain||!1}function q(t){var e=typeof t;return"object"===e?null===t?"null":Array.isArray(t)?"Array":t instanceof Date?"Date":t instanceof RegExp?"RegExp":a(t)?"BigNumber":u(t)?"Complex":c(t)?"Fraction":d(t)?"Matrix":l(t)?"Unit":v(t)?"Index":y(t)?"Range":_(t)?"ResultSet":F(t)?t.type:V(t)?"Chain":w(t)?"Help":"Object":"function"===e?"Function":e}function W(t){var e=typeof t;if("number"===e||"string"===e||"boolean"===e||null===t||void 0===t)return t;if("function"===typeof t.clone)return t.clone();if(Array.isArray(t))return t.map((function(t){return W(t)}));if(t instanceof Date)return new Date(t.valueOf());if(a(t))return t;if(t instanceof RegExp)throw new TypeError("Cannot clone "+t);return G(t,W)}function G(t,e){var n={};for(var r in t)Y(t,r)&&(n[r]=e(t[r]));return n}function H(t,e){for(var n in e)Y(e,n)&&(t[n]=e[n]);return t}function X(t,e){var n,r,i;if(Array.isArray(t)){if(!Array.isArray(e))return!1;if(t.length!==e.length)return!1;for(r=0,i=t.length;r<i;r++)if(!X(t[r],e[r]))return!1;return!0}if("function"===typeof t)return t===e;if(t instanceof Object){if(Array.isArray(e)||!(e instanceof Object))return!1;for(n in t)if(!(n in e)||!X(t[n],e[n]))return!1;for(n in e)if(!(n in t))return!1;return!0}return t===e}function Y(t,e){return t&&Object.hasOwnProperty.call(t,e)}function Z(t,e){for(var n={},r=0;r<e.length;r++){var i=e[r],o=t[i];void 0!==o&&(n[i]=o)}return n}var K=["Matrix","Array"],J=["number","BigNumber","Fraction"];var Q=function(t){if(t)throw new Error("The global config is readonly. \nPlease create a mathjs instance if you want to change the default configuration. \nExample:\n\n  import { create, all } from 'mathjs';\n  const mathjs = create(all);\n  mathjs.config({ number: 'BigNumber' });\n");return Object.freeze(o)};i()(Q,o,{MATRIX_OPTIONS:K,NUMBER_OPTIONS:J});var tt=n("4128"),et=n.n(tt);function nt(t){return"boolean"===typeof t||!!isFinite(t)&&t===Math.round(t)}var rt=Math.sign||function(t){return t>0?1:t<0?-1:0},it=Math.log2||function(t){return Math.log(t)/Math.LN2},ot=Math.log10||function(t){return Math.log(t)/Math.LN10},st=Math.log1p||function(t){return Math.log(t+1)},at=Math.cbrt||function(t){if(0===t)return t;var e,n=t<0;return n&&(t=-t),isFinite(t)?(e=Math.exp(Math.log(t)/3),e=(t/(e*e)+2*e)/3):e=t,n?-e:e},ut=Math.expm1||function(t){return t>=2e-4||t<=-2e-4?Math.exp(t)-1:t+t*t/2+t*t*t/6};function ct(t,e,n){var r={2:"0b",8:"0o",16:"0x"},i=r[e],o="";if(n){if(n<1)throw new Error("size must be in greater than 0");if(!nt(n))throw new Error("size must be an integer");if(t>2**(n-1)-1||t<-(2**(n-1)))throw new Error("Value must be in range [-2^".concat(n-1,", 2^").concat(n-1,"-1]"));if(!nt(t))throw new Error("Value must be an integer");t<0&&(t+=2**n),o="i".concat(n)}var s="";return t<0&&(t=-t,s="-"),"".concat(s).concat(i).concat(t.toString(e)).concat(o)}function lt(t,e){if("function"===typeof e)return e(t);if(t===1/0)return"Infinity";if(t===-1/0)return"-Infinity";if(isNaN(t))return"NaN";var n,r,i="auto";if(e&&(e.notation&&(i=e.notation),s(e)?n=e:s(e.precision)&&(n=e.precision),e.wordSize&&(r=e.wordSize,"number"!==typeof r)))throw new Error('Option "wordSize" must be a number');switch(i){case"fixed":return dt(t,n);case"exponential":return pt(t,n);case"engineering":return ft(t,n);case"bin":return ct(t,2,r);case"oct":return ct(t,8,r);case"hex":return ct(t,16,r);case"auto":return gt(t,n,e&&e).replace(/((\.\d*?)(0+))($|e)/,(function(){var t=arguments[2],e=arguments[4];return"."!==t?t+e:e}));default:throw new Error('Unknown notation "'+i+'". Choose "auto", "exponential", "fixed", "bin", "oct", or "hex.')}}function ht(t){var e=String(t).toLowerCase().match(/^0*?(-?)(\d+\.?\d*)(e([+-]?\d+))?$/);if(!e)throw new SyntaxError("Invalid number "+t);var n=e[1],r=e[2],i=parseFloat(e[4]||"0"),o=r.indexOf(".");i+=-1!==o?o-1:r.length-1;var s=r.replace(".","").replace(/^0*/,(function(t){return i-=t.length,""})).replace(/0*$/,"").split("").map((function(t){return parseInt(t)}));return 0===s.length&&(s.push(0),i++),{sign:n,coefficients:s,exponent:i}}function ft(t,e){if(isNaN(t)||!isFinite(t))return String(t);var n=ht(t),r=mt(n,e),i=r.exponent,o=r.coefficients,a=i%3===0?i:i<0?i-3-i%3:i-i%3;if(s(e))while(e>o.length||i-a+1>o.length)o.push(0);else for(var u=Math.abs(i-a)-(o.length-1),c=0;c<u;c++)o.push(0);var l=Math.abs(i-a),h=1;while(l>0)h++,l--;var f=o.slice(h).join(""),d=s(e)&&f.length||f.match(/[1-9]/)?"."+f:"",p=o.slice(0,h).join("")+d+"e"+(i>=0?"+":"")+a.toString();return r.sign+p}function dt(t,e){if(isNaN(t)||!isFinite(t))return String(t);var n=ht(t),r="number"===typeof e?mt(n,n.exponent+1+e):n,i=r.coefficients,o=r.exponent+1,s=o+(e||0);return i.length<s&&(i=i.concat(yt(s-i.length))),o<0&&(i=yt(1-o).concat(i),o=1),o<i.length&&i.splice(o,0,0===o?"0.":"."),r.sign+i.join("")}function pt(t,e){if(isNaN(t)||!isFinite(t))return String(t);var n=ht(t),r=e?mt(n,e):n,i=r.coefficients,o=r.exponent;i.length<e&&(i=i.concat(yt(e-i.length)));var s=i.shift();return r.sign+s+(i.length>0?"."+i.join(""):"")+"e"+(o>=0?"+":"")+o}function gt(t,e,n){if(isNaN(t)||!isFinite(t))return String(t);var r=n&&void 0!==n.lowerExp?n.lowerExp:-3,i=n&&void 0!==n.upperExp?n.upperExp:5,o=ht(t),s=e?mt(o,e):o;if(s.exponent<r||s.exponent>=i)return pt(t,e);var a=s.coefficients,u=s.exponent;a.length<e&&(a=a.concat(yt(e-a.length))),a=a.concat(yt(u-a.length+1+(a.length<e?e-a.length:0))),a=yt(-u).concat(a);var c=u>0?u:0;return c<a.length-1&&a.splice(c+1,0,"."),s.sign+a.join("")}function mt(t,e){var n={sign:t.sign,coefficients:t.coefficients,exponent:t.exponent},r=n.coefficients;while(e<=0)r.unshift(0),n.exponent++,e++;if(r.length>e){var i=r.splice(e,r.length-e);if(i[0]>=5){var o=e-1;r[o]++;while(10===r[o])r.pop(),0===o&&(r.unshift(0),n.exponent++,o++),o--,r[o]++}}return n}function yt(t){for(var e=[],n=0;n<t;n++)e.push(0);return e}function vt(t){return t.toExponential().replace(/e.*$/,"").replace(/^0\.?0*|\./,"").length}var bt=Number.EPSILON||2220446049250313e-31;function _t(t,e,n){if(null===n||void 0===n)return t===e;if(t===e)return!0;if(isNaN(t)||isNaN(e))return!1;if(isFinite(t)&&isFinite(e)){var r=Math.abs(t-e);return r<bt||r<=Math.max(Math.abs(t),Math.abs(e))*n}return!1}var wt=Math.acosh||function(t){return Math.log(Math.sqrt(t*t-1)+t)},xt=Math.asinh||function(t){return Math.log(Math.sqrt(t*t+1)+t)},St=Math.atanh||function(t){return Math.log((1+t)/(1-t))/2},Et=Math.cosh||function(t){return(Math.exp(t)+Math.exp(-t))/2},At=Math.sinh||function(t){return(Math.exp(t)-Math.exp(-t))/2},Mt=Math.tanh||function(t){var e=Math.exp(2*t);return(e-1)/(e+1)};function Ct(t,e,n){var r=t.constructor,i=new r(2),o="";if(n){if(n<1)throw new Error("size must be in greater than 0");if(!nt(n))throw new Error("size must be an integer");if(t.greaterThan(i.pow(n-1).sub(1))||t.lessThan(i.pow(n-1).mul(-1)))throw new Error("Value must be in range [-2^".concat(n-1,", 2^").concat(n-1,"-1]"));if(!t.isInteger())throw new Error("Value must be an integer");t.lessThan(0)&&(t=t.add(i.pow(n))),o="i".concat(n)}switch(e){case 2:return"".concat(t.toBinary()).concat(o);case 8:return"".concat(t.toOctal()).concat(o);case 16:return"".concat(t.toHexadecimal()).concat(o);default:throw new Error("Base ".concat(e," not supported "))}}function kt(t,e){if("function"===typeof e)return e(t);if(!t.isFinite())return t.isNaN()?"NaN":t.gt(0)?"Infinity":"-Infinity";var n,r,i="auto";if(void 0!==e&&(e.notation&&(i=e.notation),"number"===typeof e?n=e:e.precision&&(n=e.precision),e.wordSize&&(r=e.wordSize,"number"!==typeof r)))throw new Error('Option "wordSize" must be a number');switch(i){case"fixed":return Tt(t,n);case"exponential":return Pt(t,n);case"engineering":return Ot(t,n);case"bin":return Ct(t,2,r);case"oct":return Ct(t,8,r);case"hex":return Ct(t,16,r);case"auto":var o,s=e&&void 0!==e.lowerExp?e.lowerExp:-3,a=e&&void 0!==e.upperExp?e.upperExp:5;if(t.isZero())return"0";var u=t.toSignificantDigits(n),c=u.e;return o=c>=s&&c<a?u.toFixed():Pt(t,n),o.replace(/((\.\d*?)(0+))($|e)/,(function(){var t=arguments[2],e=arguments[4];return"."!==t?t+e:e}));default:throw new Error('Unknown notation "'+i+'". Choose "auto", "exponential", "fixed", "bin", "oct", or "hex.')}}function Ot(t,e){var n=t.e,r=n%3===0?n:n<0?n-3-n%3:n-n%3,i=t.mul(Math.pow(10,-r)),o=i.toPrecision(e);return-1!==o.indexOf("e")&&(o=i.toString()),o+"e"+(n>=0?"+":"")+r.toString()}function Pt(t,e){return void 0!==e?t.toExponential(e-1):t.toExponential()}function Tt(t,e){return t.toFixed(e)}function Lt(t,e){if("number"===typeof t)return lt(t,e);if(a(t))return kt(t,e);if(Nt(t))return e&&"decimal"===e.fraction?t.toString():t.s*t.n+"/"+t.d;if(Array.isArray(t))return It(t,e);if(h(t))return'"'+t+'"';if("function"===typeof t)return t.syntax?String(t.syntax):"function";if(t&&"object"===typeof t){if("function"===typeof t.format)return t.format(e);if(t&&t.toString(e)!=={}.toString())return t.toString(e);var n=Object.keys(t).map(n=>{return'"'+n+'": '+Lt(t[n],e)});return"{"+n.join(", ")+"}"}return String(t)}function It(t,e){if(Array.isArray(t)){for(var n="[",r=t.length,i=0;i<r;i++)0!==i&&(n+=", "),n+=It(t[i],e);return n+="]",n}return Lt(t,e)}function Nt(t){return t&&"object"===typeof t&&"number"===typeof t.s&&"number"===typeof t.n&&"number"===typeof t.d||!1}function Dt(t,e,n){if(!(this instanceof Dt))throw new SyntaxError("Constructor must be called with the new operator");this.actual=t,this.expected=e,this.relation=n,this.message="Dimension mismatch ("+(Array.isArray(t)?"["+t.join(", ")+"]":t)+" "+(this.relation||"!=")+" "+(Array.isArray(e)?"["+e.join(", ")+"]":e)+")",this.stack=(new Error).stack}function Rt(t,e,n){if(!(this instanceof Rt))throw new SyntaxError("Constructor must be called with the new operator");this.index=t,arguments.length<3?(this.min=0,this.max=e):(this.min=e,this.max=n),void 0!==this.min&&this.index<this.min?this.message="Index out of range ("+this.index+" < "+this.min+")":void 0!==this.max&&this.index>=this.max?this.message="Index out of range ("+this.index+" > "+(this.max-1)+")":this.message="Index out of range ("+this.index+")",this.stack=(new Error).stack}function Ft(t){var e=[];while(Array.isArray(t))e.push(t.length),t=t[0];return e}function Bt(t,e,n){var r,i=t.length;if(i!==e[n])throw new Dt(i,e[n]);if(n<e.length-1){var o=n+1;for(r=0;r<i;r++){var s=t[r];if(!Array.isArray(s))throw new Dt(e.length-1,e.length,"<");Bt(t[r],e,o)}}else for(r=0;r<i;r++)if(Array.isArray(t[r]))throw new Dt(e.length+1,e.length,">")}function jt(t,e){var n=0===e.length;if(n){if(Array.isArray(t))throw new Dt(t.length,0)}else Bt(t,e,0)}function zt(t,e){if(!s(t)||!nt(t))throw new TypeError("Index must be an integer (value: "+t+")");if(t<0||"number"===typeof e&&t>=e)throw new Rt(t,e)}function Ut(t,e,n){if(!Array.isArray(t)||!Array.isArray(e))throw new TypeError("Array expected");if(0===e.length)throw new Error("Resizing to scalar is not supported");e.forEach((function(t){if(!s(t)||!nt(t)||t<0)throw new TypeError("Invalid size, must contain positive integers (size: "+Lt(e)+")")}));var r=void 0!==n?n:0;return $t(t,e,0,r),t}function $t(t,e,n,r){var i,o,s=t.length,a=e[n],u=Math.min(s,a);if(t.length=a,n<e.length-1){var c=n+1;for(i=0;i<u;i++)o=t[i],Array.isArray(o)||(o=[o],t[i]=o),$t(o,e,c,r);for(i=u;i<a;i++)o=[],t[i]=o,$t(o,e,c,r)}else{for(i=0;i<u;i++)while(Array.isArray(t[i]))t[i]=t[i][0];for(i=u;i<a;i++)t[i]=r}}function Vt(t,e){var n=Yt(t),r=n.length;if(!Array.isArray(t)||!Array.isArray(e))throw new TypeError("Array expected");if(0===e.length)throw new Dt(0,r,"!=");e=qt(e,r);var i=Wt(e);if(r!==i)throw new Dt(i,r,"!=");try{return Gt(n,e)}catch(o){if(o instanceof Dt)throw new Dt(i,r,"!=");throw o}}function qt(t,e){var n=Wt(t),r=t.slice(),i=-1,o=t.indexOf(i),s=t.indexOf(i,o+1)>=0;if(s)throw new Error("More than one wildcard in sizes");var a=o>=0,u=e%n===0;if(a){if(!u)throw new Error("Could not replace wildcard, since "+e+" is no multiple of "+-n);r[o]=-e/n}return r}function Wt(t){return t.reduce((t,e)=>t*e,1)}function Gt(t,e){for(var n,r=t,i=e.length-1;i>0;i--){var o=e[i];n=[];for(var s=r.length/o,a=0;a<s;a++)n.push(r.slice(a*o,(a+1)*o));r=n}return r}function Ht(t,e,n,r){var i=r||Ft(t);if(n)for(var o=0;o<n;o++)t=[t],i.unshift(1);t=Xt(t,e,0);while(i.length<e)i.push(1);return t}function Xt(t,e,n){var r,i;if(Array.isArray(t)){var o=n+1;for(r=0,i=t.length;r<i;r++)t[r]=Xt(t[r],e,o)}else for(var s=n;s<e;s++)t=[t];return t}function Yt(t){if(!Array.isArray(t))return t;var e=[];return t.forEach((function t(n){Array.isArray(n)?n.forEach(t):e.push(n)})),e}function Zt(t,e){for(var n,r=0,i=0;i<t.length;i++){var o=t[i],s=Array.isArray(o);if(0===i&&s&&(r=o.length),s&&o.length!==r)return;var a=s?Zt(o,e):e(o);if(void 0===n)n=a;else if(n!==a)return"mixed"}return n}function Kt(t,e,n,r){function i(r){var i=Z(r,e.map(te));return Jt(t,e,r),n(i)}return i.isFactory=!0,i.fn=t,i.dependencies=e.slice().sort(),r&&(i.meta=r),i}function Jt(t,e,n){var r=e.filter(t=>!Qt(t)).every(t=>void 0!==n[t]);if(!r){var i=e.filter(t=>void 0===n[t]);throw new Error('Cannot create function "'.concat(t,'", ')+"some dependencies are missing: ".concat(i.map(t=>'"'.concat(t,'"')).join(", "),"."))}}function Qt(t){return t&&"?"===t[0]}function te(t){return t&&"?"===t[0]?t.slice(1):t}Dt.prototype=new RangeError,Dt.prototype.constructor=RangeError,Dt.prototype.name="DimensionError",Dt.prototype.isDimensionError=!0,Rt.prototype=new RangeError,Rt.prototype.constructor=RangeError,Rt.prototype.name="IndexError",Rt.prototype.isIndexError=!0;var ee="BigNumber",ne=["?on","config"],re=Kt(ee,ne,t=>{var{on:e,config:n}=t,r=et.a.clone({precision:n.precision,modulo:et.a.EUCLID});return r.prototype=Object.create(r.prototype),r.prototype.type="BigNumber",r.prototype.isBigNumber=!0,r.prototype.toJSON=function(){return{mathjs:"BigNumber",value:this.toString()}},r.fromJSON=function(t){return new r(t.value)},e&&e("config",(function(t,e){t.precision!==e.precision&&r.config({precision:t.precision})})),r},{isClass:!0}),ie=n("edaf"),oe=n.n(ie),se="Complex",ae=[],ue=Kt(se,ae,()=>{return oe.a.prototype.type="Complex",oe.a.prototype.isComplex=!0,oe.a.prototype.toJSON=function(){return{mathjs:"Complex",re:this.re,im:this.im}},oe.a.prototype.toPolar=function(){return{r:this.abs(),phi:this.arg()}},oe.a.prototype.format=function(t){var e="",n=this.im,r=this.re,i=lt(this.re,t),o=lt(this.im,t),a=s(t)?t:t?t.precision:null;if(null!==a){var u=Math.pow(10,-a);Math.abs(r/n)<u&&(r=0),Math.abs(n/r)<u&&(n=0)}return e=0===n?i:0===r?1===n?"i":-1===n?"-i":o+"i":n<0?-1===n?i+" - i":i+" - "+o.substring(1)+"i":1===n?i+" + i":i+" + "+o+"i",e},oe.a.fromPolar=function(t){switch(arguments.length){case 1:var e=arguments[0];if("object"===typeof e)return oe()(e);throw new TypeError("Input has to be an object with r and phi keys.");case 2:var n=arguments[0],r=arguments[1];if(s(n)){if(l(r)&&r.hasBase("ANGLE")&&(r=r.toNumber("rad")),s(r))return new oe.a({r:n,phi:r});throw new TypeError("Phi is not a number nor an angle unit.")}throw new TypeError("Radius r is not a number.");default:throw new SyntaxError("Wrong number of arguments in function fromPolar")}},oe.a.prototype.valueOf=oe.a.prototype.toString,oe.a.fromJSON=function(t){return new oe.a(t)},oe.a.compare=function(t,e){return t.re>e.re?1:t.re<e.re?-1:t.im>e.im?1:t.im<e.im?-1:0},oe.a},{isClass:!0});function ce(t){var e=0,n=1,r=Object.create(null),i=Object.create(null),o=0,s=function(t){var s=i[t];if(s&&(delete r[s],delete i[t],--e,n===s)){if(!e)return o=0,void(n=1);while(!hasOwnProperty.call(r,++n));}};return t=Math.abs(t),{hit:function(a){var u=i[a],c=++o;if(r[c]=a,i[a]=c,!u){if(++e,e<=t)return;return a=r[n],s(a),a}if(delete r[u],n===u)while(!hasOwnProperty.call(r,++n));},delete:s,clear:function(){e=o=0,n=1,r=Object.create(null),i=Object.create(null)}}}function le(t){var{hasher:e,limit:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return n=null==n?Number.POSITIVE_INFINITY:n,e=null==e?JSON.stringify:e,function r(){"object"!==typeof r.cache&&(r.cache={values:new Map,lru:ce(n||Number.POSITIVE_INFINITY)});for(var i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];var s=e(i);if(r.cache.values.has(s))return r.cache.lru.hit(s),r.cache.values.get(s);var a=t.apply(t,i);return r.cache.values.set(s,a),r.cache.values.delete(r.cache.lru.hit(s)),a}}le((function(t){return new t(1).exp()}),{hasher:fe}),le((function(t){return new t(1).plus(new t(5).sqrt()).div(2)}),{hasher:fe});var he=le((function(t){return t.acos(-1)}),{hasher:fe});le((function(t){return he(t).times(2)}),{hasher:fe});function fe(t){return t[0].precision}Math.PI,Math.PI,Math.E;de("fineStructure",.0072973525693),de("weakMixingAngle",.2229),de("efimovFactor",22.7),de("sackurTetrode",-1.16487052358);function de(t,e){var n=["config","BigNumber"];return Kt(t,n,t=>{var{config:n,BigNumber:r}=t;return"BigNumber"===n.number?new r(e):e})}var pe=n("d61e"),ge=n.n(pe),me="Fraction",ye=[],ve=Kt(me,ye,()=>{return ge.a.prototype.type="Fraction",ge.a.prototype.isFraction=!0,ge.a.prototype.toJSON=function(){return{mathjs:"Fraction",n:this.s*this.n,d:this.d}},ge.a.fromJSON=function(t){return new ge.a(t)},ge.a},{isClass:!0}),be="Matrix",_e=[],we=Kt(be,_e,()=>{function t(){if(!(this instanceof t))throw new SyntaxError("Constructor must be called with the new operator")}return t.prototype.type="Matrix",t.prototype.isMatrix=!0,t.prototype.storage=function(){throw new Error("Cannot invoke storage on a Matrix interface")},t.prototype.datatype=function(){throw new Error("Cannot invoke datatype on a Matrix interface")},t.prototype.create=function(t,e){throw new Error("Cannot invoke create on a Matrix interface")},t.prototype.subset=function(t,e,n){throw new Error("Cannot invoke subset on a Matrix interface")},t.prototype.get=function(t){throw new Error("Cannot invoke get on a Matrix interface")},t.prototype.set=function(t,e,n){throw new Error("Cannot invoke set on a Matrix interface")},t.prototype.resize=function(t,e){throw new Error("Cannot invoke resize on a Matrix interface")},t.prototype.reshape=function(t,e){throw new Error("Cannot invoke reshape on a Matrix interface")},t.prototype.clone=function(){throw new Error("Cannot invoke clone on a Matrix interface")},t.prototype.size=function(){throw new Error("Cannot invoke size on a Matrix interface")},t.prototype.map=function(t,e){throw new Error("Cannot invoke map on a Matrix interface")},t.prototype.forEach=function(t){throw new Error("Cannot invoke forEach on a Matrix interface")},t.prototype[Symbol.iterator]=function(){throw new Error("Cannot iterate a Matrix interface")},t.prototype.toArray=function(){throw new Error("Cannot invoke toArray on a Matrix interface")},t.prototype.valueOf=function(){throw new Error("Cannot invoke valueOf on a Matrix interface")},t.prototype.format=function(t){throw new Error("Cannot invoke format on a Matrix interface")},t.prototype.toString=function(){throw new Error("Cannot invoke toString on a Matrix interface")},t},{isClass:!0}),xe="DenseMatrix",Se=["Matrix"],Ee=Kt(xe,Se,t=>{var{Matrix:e}=t;function n(t,e){if(!(this instanceof n))throw new SyntaxError("Constructor must be called with the new operator");if(e&&!h(e))throw new Error("Invalid datatype: "+e);if(d(t))"DenseMatrix"===t.type?(this._data=W(t._data),this._size=W(t._size),this._datatype=e||t._datatype):(this._data=t.toArray(),this._size=t.size(),this._datatype=e||t._datatype);else if(t&&f(t.data)&&f(t.size))this._data=t.data,this._size=t.size,jt(this._data,this._size),this._datatype=e||t.datatype;else if(f(t))this._data=g(t),this._size=Ft(this._data),jt(this._data,this._size),this._datatype=e;else{if(t)throw new TypeError("Unsupported type of data ("+q(t)+")");this._data=[],this._size=[0],this._datatype=e}}function r(t,e){if(!v(e))throw new TypeError("Invalid index");var r=e.isScalar();if(r)return t.get(e.min());var o=e.size();if(o.length!==t._size.length)throw new Dt(o.length,t._size.length);for(var s=e.min(),a=e.max(),u=0,c=t._size.length;u<c;u++)zt(s[u],t._size[u]),zt(a[u],t._size[u]);return new n(i(t._data,e,o.length,0),t._datatype)}function i(t,e,n,r){var o=r===n-1,s=e.dimension(r);return o?s.map((function(e){return zt(e,t.length),t[e]})).valueOf():s.map((function(o){zt(o,t.length);var s=t[o];return i(s,e,n,r+1)})).valueOf()}function o(t,e,n,r){if(!e||!0!==e.isIndex)throw new TypeError("Invalid index");var i,o=e.size(),s=e.isScalar();if(d(n)?(i=n.size(),n=n.valueOf()):i=Ft(n),s){if(0!==i.length)throw new TypeError("Scalar expected");t.set(e.min(),n,r)}else{if(o.length<t._size.length)throw new Dt(o.length,t._size.length,"<");if(i.length<o.length){var a=0,c=0;while(1===o[a]&&1===i[a])a++;while(1===o[a])c++,a++;n=Ht(n,o.length,c,i)}if(!X(o,i))throw new Dt(o,i,">");var h=e.max().map((function(t){return t+1}));l(t,h,r);var f=o.length,p=0;u(t._data,e,n,f,p)}return t}function u(t,e,n,r,i){var o=i===r-1,s=e.dimension(i);o?s.forEach((function(e,r){zt(e),t[e]=n[r[0]]})):s.forEach((function(o,s){zt(o),u(t[o],e,n[s[0]],r,i+1)}))}function c(t,e,n){if(0===e.length){var r=t._data;while(f(r))r=r[0];return r}return t._size=e.slice(0),t._data=Ut(t._data,t._size,n),t}function l(t,e,n){var r=t._size.slice(0),i=!1;while(r.length<e.length)r.push(0),i=!0;for(var o=0,s=e.length;o<s;o++)e[o]>r[o]&&(r[o]=e[o],i=!0);i&&c(t,r,n)}function g(t){for(var e=0,n=t.length;e<n;e++){var r=t[e];f(r)?t[e]=g(r):r&&!0===r.isMatrix&&(t[e]=g(r.valueOf()))}return t}return n.prototype=new e,n.prototype.createDenseMatrix=function(t,e){return new n(t,e)},n.prototype.type="DenseMatrix",n.prototype.isDenseMatrix=!0,n.prototype.getDataType=function(){return Zt(this._data,q)},n.prototype.storage=function(){return"dense"},n.prototype.datatype=function(){return this._datatype},n.prototype.create=function(t,e){return new n(t,e)},n.prototype.subset=function(t,e,n){switch(arguments.length){case 1:return r(this,t);case 2:case 3:return o(this,t,e,n);default:throw new SyntaxError("Wrong number of arguments")}},n.prototype.get=function(t){if(!f(t))throw new TypeError("Array expected");if(t.length!==this._size.length)throw new Dt(t.length,this._size.length);for(var e=0;e<t.length;e++)zt(t[e],this._size[e]);for(var n=this._data,r=0,i=t.length;r<i;r++){var o=t[r];zt(o,n.length),n=n[o]}return n},n.prototype.set=function(t,e,n){if(!f(t))throw new TypeError("Array expected");if(t.length<this._size.length)throw new Dt(t.length,this._size.length,"<");var r,i,o,s=t.map((function(t){return t+1}));l(this,s,n);var a=this._data;for(r=0,i=t.length-1;r<i;r++)o=t[r],zt(o,a.length),a=a[o];return o=t[t.length-1],zt(o,a.length),a[o]=e,this},n.prototype.resize=function(t,e,n){if(!p(t))throw new TypeError("Array or Matrix expected");var r=t.valueOf().map(t=>{return Array.isArray(t)&&1===t.length?t[0]:t}),i=n?this.clone():this;return c(i,r,e)},n.prototype.reshape=function(t,e){var n=e?this.clone():this;n._data=Vt(n._data,t);var r=n._size.reduce((t,e)=>t*e);return n._size=qt(t,r),n},n.prototype.clone=function(){var t=new n({data:W(this._data),size:W(this._size),datatype:this._datatype});return t},n.prototype.size=function(){return this._size.slice(0)},n.prototype.map=function(t){var e=this,r=function n(r,i){return f(r)?r.map((function(t,e){return n(t,i.concat(e))})):t(r,i,e)},i=r(this._data,[]),o=void 0!==this._datatype?Zt(i,q):void 0;return new n(i,o)},n.prototype.forEach=function(t){var e=this,n=function n(r,i){f(r)?r.forEach((function(t,e){n(t,i.concat(e))})):t(r,i,e)};n(this._data,[])},n.prototype[Symbol.iterator]=function*(){var t=function*t(e,n){if(f(e))for(var r=0;r<e.length;r++)yield*t(e[r],n.concat(r));else yield{value:e,index:n}};yield*t(this._data,[])},n.prototype.rows=function(){var t=[],e=this.size();if(2!==e.length)throw new TypeError("Rows can only be returned for a 2D matrix.");var r=this._data;for(var i of r)t.push(new n([i],this._datatype));return t},n.prototype.columns=function(){var t=this,e=[],r=this.size();if(2!==r.length)throw new TypeError("Rows can only be returned for a 2D matrix.");for(var i=this._data,o=function(r){var o=i.map(t=>[t[r]]);e.push(new n(o,t._datatype))},s=0;s<r[1];s++)o(s);return e},n.prototype.toArray=function(){return W(this._data)},n.prototype.valueOf=function(){return this._data},n.prototype.format=function(t){return Lt(this._data,t)},n.prototype.toString=function(){return Lt(this._data)},n.prototype.toJSON=function(){return{mathjs:"DenseMatrix",data:this._data,size:this._size,datatype:this._datatype}},n.prototype.diagonal=function(t){if(t){if(a(t)&&(t=t.toNumber()),!s(t)||!nt(t))throw new TypeError("The parameter k must be an integer number")}else t=0;for(var e=t>0?t:0,r=t<0?-t:0,i=this._size[0],o=this._size[1],u=Math.min(i-r,o-e),c=[],l=0;l<u;l++)c[l]=this._data[l+r][l+e];return new n({data:c,size:[u],datatype:this._datatype})},n.diagonal=function(t,e,r,i){if(!f(t))throw new TypeError("Array expected, size parameter");if(2!==t.length)throw new Error("Only two dimensions matrix are supported");if(t=t.map((function(t){if(a(t)&&(t=t.toNumber()),!s(t)||!nt(t)||t<1)throw new Error("Size values must be positive integers");return t})),r){if(a(r)&&(r=r.toNumber()),!s(r)||!nt(r))throw new TypeError("The parameter k must be an integer number")}else r=0;var o,u=r>0?r:0,c=r<0?-r:0,l=t[0],h=t[1],p=Math.min(l-c,h-u);if(f(e)){if(e.length!==p)throw new Error("Invalid value array length");o=function(t){return e[t]}}else if(d(e)){var g=e.size();if(1!==g.length||g[0]!==p)throw new Error("Invalid matrix length");o=function(t){return e.get([t])}}else o=function(){return e};i||(i=a(o(0))?o(0).mul(0):0);var m=[];if(t.length>0){m=Ut(m,t,i);for(var y=0;y<p;y++)m[y+c][y+u]=o(y)}return new n({data:m,size:[l,h]})},n.fromJSON=function(t){return new n(t)},n.prototype.swapRows=function(t,e){if(!s(t)||!nt(t)||!s(e)||!nt(e))throw new Error("Row index must be positive integers");if(2!==this._size.length)throw new Error("Only two dimensional matrix is supported");return zt(t,this._size[0]),zt(e,this._size[0]),n._swapRows(t,e,this._data),this},n._swapRows=function(t,e,n){var r=n[t];n[t]=n[e],n[e]=r},n},{isClass:!0}),Ae=n("7634"),Me=n.n(Ae);function Ce(t,e){if(Le(t)&&Pe(t,e))return t[e];if("function"===typeof t[e]&&Te(t,e))throw new Error('Cannot access method "'+e+'" as a property');throw new Error('No access to property "'+e+'"')}function ke(t,e,n){if(Le(t)&&Pe(t,e))return t[e]=n,n;throw new Error('No access to property "'+e+'"')}function Oe(t,e){return e in t}function Pe(t,e){return!(!t||"object"!==typeof t)&&(!!Y(Ie,e)||!(e in Object.prototype)&&!(e in Function.prototype))}function Te(t,e){return null!==t&&void 0!==t&&"function"===typeof t[e]&&(!(Y(t,e)&&Object.getPrototypeOf&&e in Object.getPrototypeOf(t))&&(!!Y(Ne,e)||!(e in Object.prototype)&&!(e in Function.prototype)))}function Le(t){return"object"===typeof t&&t&&t.constructor===Object}var Ie={length:!0,name:!0},Ne={toString:!0,valueOf:!0,toLocaleString:!0};class De{constructor(t){this.wrappedObject=t}keys(){return Object.keys(this.wrappedObject)}get(t){return Ce(this.wrappedObject,t)}set(t,e){return ke(this.wrappedObject,t,e),this}has(t){return Oe(this.wrappedObject,t)}}function Re(t){return!!t&&(t instanceof Map||t instanceof De||"function"===typeof t.set&&"function"===typeof t.get&&"function"===typeof t.keys&&"function"===typeof t.has)}var Fe=function(){return Fe=Me.a.create,Me.a},Be=["?BigNumber","?Complex","?DenseMatrix","?Fraction"],je=Kt("typed",Be,(function(t){var{BigNumber:e,Complex:n,DenseMatrix:r,Fraction:i}=t,o=Fe();return o.types=[{name:"number",test:s},{name:"Complex",test:u},{name:"BigNumber",test:a},{name:"Fraction",test:c},{name:"Unit",test:l},{name:"string",test:h},{name:"Chain",test:V},{name:"Array",test:f},{name:"Matrix",test:d},{name:"DenseMatrix",test:g},{name:"SparseMatrix",test:m},{name:"Range",test:y},{name:"Index",test:v},{name:"boolean",test:b},{name:"ResultSet",test:_},{name:"Help",test:w},{name:"function",test:x},{name:"Date",test:S},{name:"RegExp",test:E},{name:"null",test:M},{name:"undefined",test:C},{name:"AccessorNode",test:k},{name:"ArrayNode",test:O},{name:"AssignmentNode",test:P},{name:"BlockNode",test:T},{name:"ConditionalNode",test:L},{name:"ConstantNode",test:I},{name:"FunctionNode",test:D},{name:"FunctionAssignmentNode",test:N},{name:"IndexNode",test:R},{name:"Node",test:F},{name:"ObjectNode",test:B},{name:"OperatorNode",test:j},{name:"ParenthesisNode",test:z},{name:"RangeNode",test:U},{name:"SymbolNode",test:$},{name:"Map",test:Re},{name:"Object",test:A}],o.conversions=[{from:"number",to:"BigNumber",convert:function(t){if(e||ze(t),vt(t)>15)throw new TypeError("Cannot implicitly convert a number with >15 significant digits to BigNumber (value: "+t+"). Use function bignumber(x) to convert to BigNumber.");return new e(t)}},{from:"number",to:"Complex",convert:function(t){return n||Ue(t),new n(t,0)}},{from:"number",to:"string",convert:function(t){return t+""}},{from:"BigNumber",to:"Complex",convert:function(t){return n||Ue(t),new n(t.toNumber(),0)}},{from:"Fraction",to:"BigNumber",convert:function(t){throw new TypeError("Cannot implicitly convert a Fraction to BigNumber or vice versa. Use function bignumber(x) to convert to BigNumber or fraction(x) to convert to Fraction.")}},{from:"Fraction",to:"Complex",convert:function(t){return n||Ue(t),new n(t.valueOf(),0)}},{from:"number",to:"Fraction",convert:function(t){i||Ve(t);var e=new i(t);if(e.valueOf()!==t)throw new TypeError("Cannot implicitly convert a number to a Fraction when there will be a loss of precision (value: "+t+"). Use function fraction(x) to convert to Fraction.");return e}},{from:"string",to:"number",convert:function(t){var e=Number(t);if(isNaN(e))throw new Error('Cannot convert "'+t+'" to a number');return e}},{from:"string",to:"BigNumber",convert:function(t){e||ze(t);try{return new e(t)}catch(n){throw new Error('Cannot convert "'+t+'" to BigNumber')}}},{from:"string",to:"Fraction",convert:function(t){i||Ve(t);try{return new i(t)}catch(e){throw new Error('Cannot convert "'+t+'" to Fraction')}}},{from:"string",to:"Complex",convert:function(t){n||Ue(t);try{return new n(t)}catch(e){throw new Error('Cannot convert "'+t+'" to Complex')}}},{from:"boolean",to:"number",convert:function(t){return+t}},{from:"boolean",to:"BigNumber",convert:function(t){return e||ze(t),new e(+t)}},{from:"boolean",to:"Fraction",convert:function(t){return i||Ve(t),new i(+t)}},{from:"boolean",to:"string",convert:function(t){return String(t)}},{from:"Array",to:"Matrix",convert:function(t){return r||$e(),new r(t)}},{from:"Matrix",to:"Array",convert:function(t){return t.valueOf()}}],o}));function ze(t){throw new Error("Cannot convert value ".concat(t," into a BigNumber: no class 'BigNumber' provided"))}function Ue(t){throw new Error("Cannot convert value ".concat(t," into a Complex number: no class 'Complex' provided"))}function $e(){throw new Error("Cannot convert array into a Matrix: no class 'DenseMatrix' provided")}function Ve(t){throw new Error("Cannot convert value ".concat(t," into a Fraction, no class 'Fraction' provided."))}function qe(t){for(var e=0;e<t.length;e++)if(p(t[e]))return!0;return!1}function We(t,e){d(t)&&(t=t.valueOf());for(var n=0,r=t.length;n<r;n++){var i=t[n];Array.isArray(i)?We(i,e):e(i)}}function Ge(t,e,n){return t&&"function"===typeof t.map?t.map((function(t){return Ge(t,e,n)})):e(t)}function He(t,e,n){var r=Array.isArray(t)?Ft(t):t.size();if(e<0||e>=r.length)throw new Rt(e,r.length);return d(t)?t.create(Xe(t.valueOf(),e,n)):Xe(t,e,n)}function Xe(t,e,n){var r,i,o,s;if(e<=0){if(Array.isArray(t[0])){for(s=Ye(t),i=[],r=0;r<s.length;r++)i[r]=Xe(s[r],e-1,n);return i}for(o=t[0],r=1;r<t.length;r++)o=n(o,t[r]);return o}for(i=[],r=0;r<t.length;r++)i[r]=Xe(t[r],e-1,n);return i}function Ye(t){var e,n,r=t.length,i=t[0].length,o=[];for(n=0;n<i;n++){var s=[];for(e=0;e<r;e++)s.push(t[e][n]);o.push(s)}return o}var Ze="number",Ke="number, number";function Je(t){return Math.abs(t)}function Qe(t,e){return t+e}function tn(t,e){return t-e}function en(t,e){return t*e}function nn(t,e){return t/e}function rn(t){return-t}function on(t){return t}function sn(t){return at(t)}function an(t){return Math.ceil(t)}function un(t){return t*t*t}function cn(t){return Math.exp(t)}function ln(t){return ut(t)}function hn(t){return t>0?Math.floor(t):Math.ceil(t)}function fn(t){return Math.floor(t)}function dn(t,e){if(!nt(t)||!nt(e))throw new Error("Parameters in function gcd must be integer numbers");var n;while(0!==e)n=t%e,t=e,e=n;return t<0?-t:t}function pn(t,e){if(!nt(t)||!nt(e))throw new Error("Parameters in function lcm must be integer numbers");if(0===t||0===e)return 0;var n,r=t*e;while(0!==e)n=e,e=t%n,t=n;return Math.abs(r/t)}function gn(t){return Math.log(t)}function mn(t){return ot(t)}function yn(t){return it(t)}function vn(t){return st(t)}function bn(t,e){if(e>0)return t-e*Math.floor(t/e);if(0===e)return t;throw new Error("Cannot calculate mod for a negative divisor")}function _n(t,e){var n=e<0;if(n&&(e=-e),0===e)throw new Error("Root must be non-zero");if(t<0&&Math.abs(e)%2!==1)throw new Error("Root must be odd when a is negative.");if(0===t)return n?1/0:0;if(!isFinite(t))return n?0:t;var r=Math.pow(Math.abs(t),1/e);return r=t<0?-r:r,n?1/r:r}function wn(t){return rt(t)}function xn(t){return Math.sqrt(t)}function Sn(t){return t*t}function En(t,e){var n,r,i,o,s=0,a=1,u=1,c=0;if(!nt(t)||!nt(e))throw new Error("Parameters in function xgcd must be integer numbers");while(e)r=Math.floor(t/e),i=t-r*e,n=s,s=a-r*s,a=n,n=u,u=c-r*u,c=n,t=e,e=i;return o=t<0?[-t,-a,-c]:[t,t?a:0,c],o}function An(t,e){return t*t<1&&e===1/0||t*t>1&&e===-1/0?0:Math.pow(t,e)}function Mn(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return parseFloat(dt(t,e))}function Cn(t){return Math.abs(t)}Je.signature=Ze,Qe.signature=Ke,tn.signature=Ke,en.signature=Ke,nn.signature=Ke,rn.signature=Ze,on.signature=Ze,sn.signature=Ze,an.signature=Ze,un.signature=Ze,cn.signature=Ze,ln.signature=Ze,hn.signature=Ze,fn.signature=Ze,dn.signature=Ke,pn.signature=Ke,gn.signature=Ze,mn.signature=Ze,yn.signature=Ze,vn.signature=Ze,bn.signature=Ke,_n.signature=Ke,wn.signature=Ze,xn.signature=Ze,Sn.signature=Ze,En.signature=Ke,An.signature=Ke,Mn.signature=Ke,Cn.signature=Ze;var kn="abs",On=["typed"],Pn=Kt(kn,On,t=>{var{typed:e}=t;return e(kn,{number:Je,Complex:function(t){return t.abs()},BigNumber:function(t){return t.abs()},Fraction:function(t){return t.abs()},"Array | Matrix":function(t){return Ge(t,this,!0)},Unit:function(t){return t.abs()}})}),Tn="number",Ln="number, number";function In(t){return Math.acos(t)}function Nn(t){return wt(t)}function Dn(t){return Math.atan(1/t)}function Rn(t){return isFinite(t)?(Math.log((t+1)/t)+Math.log(t/(t-1)))/2:0}function Fn(t){return Math.asin(1/t)}function Bn(t){var e=1/t;return Math.log(e+Math.sqrt(e*e+1))}function jn(t){return Math.acos(1/t)}function zn(t){var e=1/t,n=Math.sqrt(e*e-1);return Math.log(n+e)}function Un(t){return Math.asin(t)}function $n(t){return xt(t)}function Vn(t){return Math.atan(t)}function qn(t,e){return Math.atan2(t,e)}function Wn(t){return St(t)}function Gn(t){return Math.cos(t)}function Hn(t){return Et(t)}function Xn(t){return 1/Math.tan(t)}function Yn(t){var e=Math.exp(2*t);return(e+1)/(e-1)}function Zn(t){return 1/Math.sin(t)}function Kn(t){return 0===t?Number.POSITIVE_INFINITY:Math.abs(2/(Math.exp(t)-Math.exp(-t)))*rt(t)}function Jn(t){return 1/Math.cos(t)}function Qn(t){return 2/(Math.exp(t)+Math.exp(-t))}function tr(t){return Math.sin(t)}function er(t){return At(t)}function nr(t){return Math.tan(t)}function rr(t){return Mt(t)}In.signature=Tn,Nn.signature=Tn,Dn.signature=Tn,Rn.signature=Tn,Fn.signature=Tn,Bn.signature=Tn,jn.signature=Tn,zn.signature=Tn,Un.signature=Tn,$n.signature=Tn,Vn.signature=Tn,qn.signature=Ln,Wn.signature=Tn,Gn.signature=Tn,Hn.signature=Tn,Xn.signature=Tn,Yn.signature=Tn,Zn.signature=Tn,Kn.signature=Tn,Jn.signature=Tn,Qn.signature=Tn,tr.signature=Tn,er.signature=Tn,nr.signature=Tn,rr.signature=Tn;var ir="addScalar",or=["typed"],sr=Kt(ir,or,t=>{var{typed:e}=t;return e(ir,{"number, number":Qe,"Complex, Complex":function(t,e){return t.add(e)},"BigNumber, BigNumber":function(t,e){return t.plus(e)},"Fraction, Fraction":function(t,e){return t.add(e)},"Unit, Unit":function(t,e){if(null===t.value||void 0===t.value)throw new Error("Parameter x contains a unit with undefined value");if(null===e.value||void 0===e.value)throw new Error("Parameter y contains a unit with undefined value");if(!t.equalBase(e))throw new Error("Units do not match");var n=t.clone();return n.value=this(n.value,e.value),n.fixPrefix=!1,n}})}),ar="bignumber",ur=["typed","BigNumber"],cr=Kt(ar,ur,t=>{var{typed:e,BigNumber:n}=t;return e("bignumber",{"":function(){return new n(0)},number:function(t){return new n(t+"")},string:function(t){var e=t.match(/(0[box][0-9a-fA-F]*)i([0-9]*)/);if(e){var r=e[2],i=n(e[1]),o=new n(2).pow(Number(r));if(i.gt(o.sub(1)))throw new SyntaxError('String "'.concat(t,'" is out of range'));var s=new n(2).pow(Number(r)-1);return i.gte(s)?i.sub(o):i}return new n(t)},BigNumber:function(t){return t},Fraction:function(t){return new n(t.n).div(t.d).times(t.s)},null:function(t){return new n(0)},"Array | Matrix":function(t){return Ge(t,this)}})});var lr="number",hr="number, number";function fr(t,e){if(!nt(t)||!nt(e))throw new Error("Integers expected in function bitAnd");return t&e}function dr(t){if(!nt(t))throw new Error("Integer expected in function bitNot");return~t}function pr(t,e){if(!nt(t)||!nt(e))throw new Error("Integers expected in function bitOr");return t|e}function gr(t,e){if(!nt(t)||!nt(e))throw new Error("Integers expected in function bitXor");return t^e}function mr(t,e){if(!nt(t)||!nt(e))throw new Error("Integers expected in function leftShift");return t<<e}function yr(t,e){if(!nt(t)||!nt(e))throw new Error("Integers expected in function rightArithShift");return t>>e}function vr(t,e){if(!nt(t)||!nt(e))throw new Error("Integers expected in function rightLogShift");return t>>>e}fr.signature=hr,dr.signature=lr,pr.signature=hr,gr.signature=hr,mr.signature=hr,yr.signature=hr,vr.signature=hr;function br(t,e){if(e<t)return 1;if(e===t)return e;var n=e+t>>1;return br(t,n)*br(n+1,e)}function _r(t,e){if(!nt(t)||t<0)throw new TypeError("Positive integer value expected in function combinations");if(!nt(e)||e<0)throw new TypeError("Positive integer value expected in function combinations");if(e>t)throw new TypeError("k must be less than or equal to n");var n,r=t-e;return e<r?(n=br(r+1,t),n/br(1,e)):(n=br(e+1,t),n/br(1,r))}_r.signature="number, number";var wr="conj",xr=["typed"],Sr=Kt(wr,xr,t=>{var{typed:e}=t;return e(wr,{number:function(t){return t},BigNumber:function(t){return t},Complex:function(t){return t.conjugate()},"Array | Matrix":function(t){return Ge(t,this)}})});function Er(t,e,n){if(null===n||void 0===n)return t.eq(e);if(t.eq(e))return!0;if(t.isNaN()||e.isNaN())return!1;if(t.isFinite()&&e.isFinite()){var r=t.minus(e).abs();if(r.isZero())return!0;var i=t.constructor.max(t.abs(),e.abs());return r.lte(i.times(n))}return!1}function Ar(t,e,n){return _t(t.re,e.re,n)&&_t(t.im,e.im,n)}var Mr="equalScalar",Cr=["typed","config"],kr=Kt(Mr,Cr,t=>{var{typed:e,config:n}=t;return e(Mr,{"boolean, boolean":function(t,e){return t===e},"number, number":function(t,e){return _t(t,e,n.epsilon)},"BigNumber, BigNumber":function(t,e){return t.eq(e)||Er(t,e,n.epsilon)},"Fraction, Fraction":function(t,e){return t.equals(e)},"Complex, Complex":function(t,e){return Ar(t,e,n.epsilon)},"Unit, Unit":function(t,e){if(!t.equalBase(e))throw new Error("Cannot compare units with different base");return this(t.value,e.value)}})});Kt(Mr,["typed","config"],t=>{var{typed:e,config:n}=t;return e(Mr,{"number, number":function(t,e){return _t(t,e,n.epsilon)}})}),Math.pow(2,53);var Or="hex",Pr=["typed","format"],Tr=(Kt(Or,Pr,t=>{var{typed:e,format:n}=t;return e(Or,{"number | BigNumber":function(t){return n(t,{notation:"hex"})},"number | BigNumber, number":function(t,e){return n(t,{notation:"hex",wordSize:e})}})}),"number");function Lr(t){return nt(t)}function Ir(t){return t<0}function Nr(t){return t>0}function Dr(t){return 0===t}function Rr(t){return Number.isNaN(t)}Lr.signature=Tr,Ir.signature=Tr,Nr.signature=Tr,Dr.signature=Tr,Rr.signature=Tr;var Fr="multiplyScalar",Br=["typed"],jr=Kt(Fr,Br,t=>{var{typed:e}=t;return e("multiplyScalar",{"number, number":en,"Complex, Complex":function(t,e){return t.mul(e)},"BigNumber, BigNumber":function(t,e){return t.times(e)},"Fraction, Fraction":function(t,e){return t.mul(e)},"number | Fraction | BigNumber | Complex, Unit":function(t,e){var n=e.clone();return n.value=null===n.value?n._normalize(t):this(n.value,t),n},"Unit, number | Fraction | BigNumber | Complex":function(t,e){var n=t.clone();return n.value=null===n.value?n._normalize(e):this(n.value,e),n},"Unit, Unit":function(t,e){return t.multiply(e)}})}),zr="number",Ur="number, number";function $r(t){return!t}function Vr(t,e){return!(!t&&!e)}function qr(t,e){return!!t!==!!e}function Wr(t,e){return!(!t||!e)}$r.signature=zr,Vr.signature=Ur,qr.signature=Ur,Wr.signature=Ur;var Gr="number",Hr=["typed"];function Xr(t){var e=t.match(/(0[box])([0-9a-fA-F]*)\.([0-9a-fA-F]*)/);if(e){var n={"0b":2,"0o":8,"0x":16}[e[1]],r=e[2],i=e[3];return{input:t,radix:n,integerPart:r,fractionalPart:i}}return null}function Yr(t){for(var e=parseInt(t.integerPart,t.radix),n=0,r=0;r<t.fractionalPart.length;r++){var i=parseInt(t.fractionalPart[r],t.radix);n+=i/Math.pow(t.radix,r+1)}var o=e+n;if(isNaN(o))throw new SyntaxError('String "'+t.input+'" is no valid number');return o}var Zr=Kt(Gr,Hr,t=>{var{typed:e}=t,n=e("number",{"":function(){return 0},number:function(t){return t},string:function(t){if("NaN"===t)return NaN;var e=Xr(t);if(e)return Yr(e);var n=0,r=t.match(/(0[box][0-9a-fA-F]*)i([0-9]*)/);r&&(n=Number(r[2]),t=r[1]);var i=Number(t);if(isNaN(i))throw new SyntaxError('String "'+t+'" is no valid number');if(r){if(i>2**n-1)throw new SyntaxError('String "'.concat(t,'" is out of range'));i>=2**(n-1)&&(i-=2**n)}return i},BigNumber:function(t){return t.toNumber()},Fraction:function(t){return t.valueOf()},Unit:function(t){throw new Error("Second argument with valueless unit expected")},null:function(t){return 0},"Unit, string | Unit":function(t,e){return t.toNumber(e)},"Array | Matrix":function(t){return Ge(t,this)}});return n.fromJSON=function(t){return parseFloat(t.value)},n}),Kr="oct",Jr=["typed","format"],Qr=(Kt(Kr,Jr,t=>{var{typed:e,format:n}=t;return e(Kr,{"number | BigNumber":function(t){return n(t,{notation:"oct"})},"number | BigNumber, number":function(t,e){return n(t,{notation:"oct",wordSize:e})}})}),n("8a44")),ti=n.n(Qr);Date.now();var ei="SparseMatrix",ni=["typed","equalScalar","Matrix"],ri=Kt(ei,ni,t=>{var{typed:e,equalScalar:n,Matrix:r}=t;function i(t,e){if(!(this instanceof i))throw new SyntaxError("Constructor must be called with the new operator");if(e&&!h(e))throw new Error("Invalid datatype: "+e);if(d(t))o(this,t,e);else if(t&&f(t.index)&&f(t.ptr)&&f(t.size))this._values=t.values,this._index=t.index,this._ptr=t.ptr,this._size=t.size,this._datatype=e||t.datatype;else if(f(t))u(this,t,e);else{if(t)throw new TypeError("Unsupported type of data ("+q(t)+")");this._values=[],this._index=[],this._ptr=[0],this._size=[0,0],this._datatype=e}}function o(t,e,n){"SparseMatrix"===e.type?(t._values=e._values?W(e._values):void 0,t._index=W(e._index),t._ptr=W(e._ptr),t._size=W(e._size),t._datatype=n||e._datatype):u(t,e.valueOf(),n||e._datatype)}function u(t,r,i){t._values=[],t._index=[],t._ptr=[],t._datatype=i;var o=r.length,s=0,a=n,u=0;if(h(i)&&(a=e.find(n,[i,i])||n,u=e.convert(0,i)),o>0){var c=0;do{t._ptr.push(t._index.length);for(var l=0;l<o;l++){var d=r[l];if(f(d)){if(0===c&&s<d.length&&(s=d.length),c<d.length){var p=d[c];a(p,u)||(t._values.push(p),t._index.push(l))}}else 0===c&&s<1&&(s=1),a(d,u)||(t._values.push(d),t._index.push(l))}c++}while(c<s)}t._ptr.push(t._index.length),t._size=[o,s]}function c(t,e){if(!v(e))throw new TypeError("Invalid index");var n=e.isScalar();if(n)return t.get(e.min());var r,o,s,a,u=e.size();if(u.length!==t._size.length)throw new Dt(u.length,t._size.length);var c=e.min(),l=e.max();for(r=0,o=t._size.length;r<o;r++)zt(c[r],t._size[r]),zt(l[r],t._size[r]);var h=t._values,f=t._index,d=t._ptr,p=e.dimension(0),g=e.dimension(1),m=[],y=[];p.forEach((function(t,e){y[t]=e[0],m[t]=!0}));var b=h?[]:void 0,_=[],w=[];return g.forEach((function(t){for(w.push(_.length),s=d[t],a=d[t+1];s<a;s++)r=f[s],!0===m[r]&&(_.push(y[r]),b&&b.push(h[s]))})),w.push(_.length),new i({values:b,index:_,ptr:w,size:u,datatype:t._datatype})}function l(t,e,n,r){if(!e||!0!==e.isIndex)throw new TypeError("Invalid index");var i,o=e.size(),s=e.isScalar();if(d(n)?(i=n.size(),n=n.toArray()):i=Ft(n),s){if(0!==i.length)throw new TypeError("Scalar expected");t.set(e.min(),n,r)}else{if(1!==o.length&&2!==o.length)throw new Dt(o.length,t._size.length,"<");if(i.length<o.length){var a=0,u=0;while(1===o[a]&&1===i[a])a++;while(1===o[a])u++,a++;n=Ht(n,o.length,u,i)}if(!X(o,i))throw new Dt(o,i,">");for(var c=e.min()[0],l=e.min()[1],h=i[0],f=i[1],p=0;p<h;p++)for(var g=0;g<f;g++){var m=n[p][g];t.set([p+c,g+l],m,r)}}return t}function g(t,e,n,r){if(n-e===0)return n;for(var i=e;i<n;i++)if(r[i]===t)return i;return e}function m(t,e,n,r,i){n.splice(t,1),r.splice(t,1);for(var o=e+1;o<i.length;o++)i[o]--}function y(t,e,n,r,i,o,s){i.splice(t,0,r),o.splice(t,0,e);for(var a=n+1;a<s.length;a++)s[a]++}function b(t,r,i,o){var s=o||0,a=n,u=0;h(t._datatype)&&(a=e.find(n,[t._datatype,t._datatype])||n,u=e.convert(0,t._datatype),s=e.convert(s,t._datatype));var c,l,f,d=!a(s,u),p=t._size[0],g=t._size[1];if(i>g){for(l=g;l<i;l++)if(t._ptr[l]=t._values.length,d)for(c=0;c<p;c++)t._values.push(s),t._index.push(c);t._ptr[i]=t._values.length}else i<g&&(t._ptr.splice(i+1,g-i),t._values.splice(t._ptr[i],t._values.length),t._index.splice(t._ptr[i],t._index.length));if(g=i,r>p){if(d){var m=0;for(l=0;l<g;l++){t._ptr[l]=t._ptr[l]+m,f=t._ptr[l+1]+m;var y=0;for(c=p;c<r;c++,y++)t._values.splice(f+y,0,s),t._index.splice(f+y,0,c),m++}t._ptr[g]=t._values.length}}else if(r<p){var v=0;for(l=0;l<g;l++){t._ptr[l]=t._ptr[l]-v;var b=t._ptr[l],_=t._ptr[l+1]-v;for(f=b;f<_;f++)c=t._index[f],c>r-1&&(t._values.splice(f,1),t._index.splice(f,1),v++)}t._ptr[l]=t._values.length}return t._size[0]=r,t._size[1]=i,t}function _(t,r,o,s,a,u,c){var l=[],f=[],d=[],p=n,g=0;h(t._datatype)&&(p=e.find(n,[t._datatype,t._datatype])||n,g=e.convert(0,t._datatype));for(var m=function(t,e,n){t=u(t,e,n),p(t,g)||(l.push(t),f.push(e))},y=s;y<=a;y++){d.push(l.length);var v=t._ptr[y],b=t._ptr[y+1];if(c)for(var _=v;_<b;_++){var w=t._index[_];w>=r&&w<=o&&m(t._values[_],w-r,y-s)}else{for(var x={},S=v;S<b;S++){var E=t._index[S];x[E]=t._values[S]}for(var A=r;A<=o;A++){var M=A in x?x[A]:0;m(M,A-r,y-s)}}}return d.push(l.length),new i({values:l,index:f,ptr:d,size:[o-r+1,a-s+1]})}function w(t,e,n,r,i){var o,s,a=r[0],u=r[1],c=[];for(o=0;o<a;o++)for(c[o]=[],s=0;s<u;s++)c[o][s]=0;for(s=0;s<u;s++)for(var l=n[s],h=n[s+1],f=l;f<h;f++)o=e[f],c[o][s]=t?i?W(t[f]):t[f]:1;return c}return i.prototype=new r,i.prototype.createSparseMatrix=function(t,e){return new i(t,e)},i.prototype.type="SparseMatrix",i.prototype.isSparseMatrix=!0,i.prototype.getDataType=function(){return Zt(this._values,q)},i.prototype.storage=function(){return"sparse"},i.prototype.datatype=function(){return this._datatype},i.prototype.create=function(t,e){return new i(t,e)},i.prototype.density=function(){var t=this._size[0],e=this._size[1];return 0!==t&&0!==e?this._index.length/(t*e):0},i.prototype.subset=function(t,e,n){if(!this._values)throw new Error("Cannot invoke subset on a Pattern only matrix");switch(arguments.length){case 1:return c(this,t);case 2:case 3:return l(this,t,e,n);default:throw new SyntaxError("Wrong number of arguments")}},i.prototype.get=function(t){if(!f(t))throw new TypeError("Array expected");if(t.length!==this._size.length)throw new Dt(t.length,this._size.length);if(!this._values)throw new Error("Cannot invoke get on a Pattern only matrix");var e=t[0],n=t[1];zt(e,this._size[0]),zt(n,this._size[1]);var r=g(e,this._ptr[n],this._ptr[n+1],this._index);return r<this._ptr[n+1]&&this._index[r]===e?this._values[r]:0},i.prototype.set=function(t,r,i){if(!f(t))throw new TypeError("Array expected");if(t.length!==this._size.length)throw new Dt(t.length,this._size.length);if(!this._values)throw new Error("Cannot invoke set on a Pattern only matrix");var o=t[0],s=t[1],a=this._size[0],u=this._size[1],c=n,l=0;h(this._datatype)&&(c=e.find(n,[this._datatype,this._datatype])||n,l=e.convert(0,this._datatype)),(o>a-1||s>u-1)&&(b(this,Math.max(o+1,a),Math.max(s+1,u),i),a=this._size[0],u=this._size[1]),zt(o,a),zt(s,u);var d=g(o,this._ptr[s],this._ptr[s+1],this._index);return d<this._ptr[s+1]&&this._index[d]===o?c(r,l)?m(d,s,this._values,this._index,this._ptr):this._values[d]=r:y(d,o,s,r,this._values,this._index,this._ptr),this},i.prototype.resize=function(t,e,n){if(!p(t))throw new TypeError("Array or Matrix expected");var r=t.valueOf().map(t=>{return Array.isArray(t)&&1===t.length?t[0]:t});if(2!==r.length)throw new Error("Only two dimensions matrix are supported");r.forEach((function(t){if(!s(t)||!nt(t)||t<0)throw new TypeError("Invalid size, must contain positive integers (size: "+Lt(r)+")")}));var i=n?this.clone():this;return b(i,r[0],r[1],e)},i.prototype.reshape=function(t,e){if(!f(t))throw new TypeError("Array expected");if(2!==t.length)throw new Error("Sparse matrices can only be reshaped in two dimensions");t.forEach((function(e){if(!s(e)||!nt(e)||e<=-2||0===e)throw new TypeError("Invalid size, must contain positive integers or -1 (size: "+Lt(t)+")")}));var n=this._size[0]*this._size[1];t=qt(t,n);var r=t[0]*t[1];if(n!==r)throw new Error("Reshaping sparse matrix will result in the wrong number of elements");var i=e?this.clone():this;if(this._size[0]===t[0]&&this._size[1]===t[1])return i;for(var o=[],a=0;a<i._ptr.length;a++)for(var u=0;u<i._ptr[a+1]-i._ptr[a];u++)o.push(a);for(var c=i._values.slice(),l=i._index.slice(),h=0;h<i._index.length;h++){var d=l[h],p=o[h],m=d*i._size[1]+p;o[h]=m%t[1],l[h]=Math.floor(m/t[1])}i._values.length=0,i._index.length=0,i._ptr.length=t[1]+1,i._size=t.slice();for(var v=0;v<i._ptr.length;v++)i._ptr[v]=0;for(var b=0;b<c.length;b++){var _=l[b],w=o[b],x=c[b],S=g(_,i._ptr[w],i._ptr[w+1],i._index);y(S,_,w,x,i._values,i._index,i._ptr)}return i},i.prototype.clone=function(){var t=new i({values:this._values?W(this._values):void 0,index:W(this._index),ptr:W(this._ptr),size:W(this._size),datatype:this._datatype});return t},i.prototype.size=function(){return this._size.slice(0)},i.prototype.map=function(t,e){if(!this._values)throw new Error("Cannot invoke map on a Pattern only matrix");var n=this,r=this._size[0],i=this._size[1],o=function(e,r,i){return t(e,[r,i],n)};return _(this,0,r-1,0,i-1,o,e)},i.prototype.forEach=function(t,e){if(!this._values)throw new Error("Cannot invoke forEach on a Pattern only matrix");for(var n=this,r=this._size[0],i=this._size[1],o=0;o<i;o++){var s=this._ptr[o],a=this._ptr[o+1];if(e)for(var u=s;u<a;u++){var c=this._index[u];t(this._values[u],[c,o],n)}else{for(var l={},h=s;h<a;h++){var f=this._index[h];l[f]=this._values[h]}for(var d=0;d<r;d++){var p=d in l?l[d]:0;t(p,[d,o],n)}}}},i.prototype[Symbol.iterator]=function*(){if(!this._values)throw new Error("Cannot iterate a Pattern only matrix");for(var t=this._size[1],e=0;e<t;e++)for(var n=this._ptr[e],r=this._ptr[e+1],i=n;i<r;i++){var o=this._index[i];yield{value:this._values[i],index:[o,e]}}},i.prototype.toArray=function(){return w(this._values,this._index,this._ptr,this._size,!0)},i.prototype.valueOf=function(){return w(this._values,this._index,this._ptr,this._size,!1)},i.prototype.format=function(t){for(var e=this._size[0],n=this._size[1],r=this.density(),i="Sparse Matrix ["+Lt(e,t)+" x "+Lt(n,t)+"] density: "+Lt(r,t)+"\n",o=0;o<n;o++)for(var s=this._ptr[o],a=this._ptr[o+1],u=s;u<a;u++){var c=this._index[u];i+="\n    ("+Lt(c,t)+", "+Lt(o,t)+") ==> "+(this._values?Lt(this._values[u],t):"X")}return i},i.prototype.toString=function(){return Lt(this.toArray())},i.prototype.toJSON=function(){return{mathjs:"SparseMatrix",values:this._values,index:this._index,ptr:this._ptr,size:this._size,datatype:this._datatype}},i.prototype.diagonal=function(t){if(t){if(a(t)&&(t=t.toNumber()),!s(t)||!nt(t))throw new TypeError("The parameter k must be an integer number")}else t=0;var e=t>0?t:0,n=t<0?-t:0,r=this._size[0],o=this._size[1],u=Math.min(r-n,o-e),c=[],l=[],h=[];h[0]=0;for(var f=e;f<o&&c.length<u;f++)for(var d=this._ptr[f],p=this._ptr[f+1],g=d;g<p;g++){var m=this._index[g];if(m===f-e+n){c.push(this._values[g]),l[c.length-1]=m-n;break}}return h.push(c.length),new i({values:c,index:l,ptr:h,size:[u,1]})},i.fromJSON=function(t){return new i(t)},i.diagonal=function(t,r,o,u,c){if(!f(t))throw new TypeError("Array expected, size parameter");if(2!==t.length)throw new Error("Only two dimensions matrix are supported");if(t=t.map((function(t){if(a(t)&&(t=t.toNumber()),!s(t)||!nt(t)||t<1)throw new Error("Size values must be positive integers");return t})),o){if(a(o)&&(o=o.toNumber()),!s(o)||!nt(o))throw new TypeError("The parameter k must be an integer number")}else o=0;var l=n,p=0;h(c)&&(l=e.find(n,[c,c])||n,p=e.convert(0,c));var g,m=o>0?o:0,y=o<0?-o:0,v=t[0],b=t[1],_=Math.min(v-y,b-m);if(f(r)){if(r.length!==_)throw new Error("Invalid value array length");g=function(t){return r[t]}}else if(d(r)){var w=r.size();if(1!==w.length||w[0]!==_)throw new Error("Invalid matrix length");g=function(t){return r.get([t])}}else g=function(){return r};for(var x=[],S=[],E=[],A=0;A<b;A++){E.push(x.length);var M=A-m;if(M>=0&&M<_){var C=g(M);l(C,p)||(S.push(M+y),x.push(C))}}return E.push(x.length),new i({values:x,index:S,ptr:E,size:[v,b]})},i.prototype.swapRows=function(t,e){if(!s(t)||!nt(t)||!s(e)||!nt(e))throw new Error("Row index must be positive integers");if(2!==this._size.length)throw new Error("Only two dimensional matrix is supported");return zt(t,this._size[0]),zt(e,this._size[0]),i._swapRows(t,e,this._size[1],this._values,this._index,this._ptr),this},i._forEachRow=function(t,e,n,r,i){for(var o=r[t],s=r[t+1],a=o;a<s;a++)i(n[a],e[a])},i._swapRows=function(t,e,n,r,i,o){for(var s=0;s<n;s++){var a=o[s],u=o[s+1],c=g(t,a,u,i),l=g(e,a,u,i);if(c<u&&l<u&&i[c]===t&&i[l]===e){if(r){var h=r[c];r[c]=r[l],r[l]=h}}else if(c<u&&i[c]===t&&(l>=u||i[l]!==e)){var f=r?r[c]:void 0;i.splice(l,0,e),r&&r.splice(l,0,f),i.splice(l<=c?c+1:c,1),r&&r.splice(l<=c?c+1:c,1)}else if(l<u&&i[l]===e&&(c>=u||i[c]!==t)){var d=r?r[l]:void 0;i.splice(c,0,t),r&&r.splice(c,0,d),i.splice(c<=l?l+1:l,1),r&&r.splice(c<=l?l+1:l,1)}}},i},{isClass:!0});var ii="bin",oi=["typed","format"];Kt(ii,oi,t=>{var{typed:e,format:n}=t;return e(ii,{"number | BigNumber":function(t){return n(t,{notation:"bin"})},"number | BigNumber, number":function(t,e){return n(t,{notation:"bin",wordSize:e})}})});var si="isNaN",ai=["typed"],ui=Kt(si,ai,t=>{var{typed:e}=t;return e(si,{number:Rr,BigNumber:function(t){return t.isNaN()},Fraction:function(t){return!1},Complex:function(t){return t.isNaN()},Unit:function(t){return Number.isNaN(t.value)},"Array | Matrix":function(t){return Ge(t,Number.isNaN)}})}),ci="unaryMinus",li=["typed"],hi=Kt(ci,li,t=>{var{typed:e}=t;return e(ci,{number:rn,Complex:function(t){return t.neg()},BigNumber:function(t){return t.neg()},Fraction:function(t){return t.neg()},Unit:function(t){var e=t.clone();return e.value=this(t.value),e},"Array | Matrix":function(t){return Ge(t,this,!0)}})}),fi="fraction",di=["typed","Fraction"],pi=Kt(fi,di,t=>{var{typed:e,Fraction:n}=t;return e("fraction",{number:function(t){if(!isFinite(t)||isNaN(t))throw new Error(t+" cannot be represented as a fraction");return new n(t)},string:function(t){return new n(t)},"number, number":function(t,e){return new n(t,e)},null:function(t){return new n(0)},BigNumber:function(t){return new n(t.toString())},Fraction:function(t){return t},Object:function(t){return new n(t)},"Array | Matrix":function(t){return Ge(t,this)}})}),gi="isNumeric",mi=["typed"],yi=Kt(gi,mi,t=>{var{typed:e}=t;return e(gi,{"number | BigNumber | Fraction | boolean":function(){return!0},"Complex | Unit | string | null | undefined | Node":function(){return!1},"Array | Matrix":function(t){return Ge(t,this)}})}),vi="matrix",bi=["typed","Matrix","DenseMatrix","SparseMatrix"],_i=Kt(vi,bi,t=>{var{typed:e,Matrix:n,DenseMatrix:r,SparseMatrix:i}=t;return e(vi,{"":function(){return o([])},string:function(t){return o([],t)},"string, string":function(t,e){return o([],t,e)},Array:function(t){return o(t)},Matrix:function(t){return o(t,t.storage())},"Array | Matrix, string":o,"Array | Matrix, string, string":o});function o(t,e,n){if("dense"===e||"default"===e||void 0===e)return new r(t,n);if("sparse"===e)return new i(t,n);throw new TypeError("Unknown matrix type "+JSON.stringify(e)+".")}}),wi="algorithm03",xi=["typed"],Si=Kt(wi,xi,t=>{var{typed:e}=t;return function(t,n,r,i){var o=t._data,s=t._size,a=t._datatype,u=n._values,c=n._index,l=n._ptr,h=n._size,f=n._datatype;if(s.length!==h.length)throw new Dt(s.length,h.length);if(s[0]!==h[0]||s[1]!==h[1])throw new RangeError("Dimension mismatch. Matrix A ("+s+") must match Matrix B ("+h+")");if(!u)throw new Error("Cannot perform operation on Dense Matrix and Pattern Sparse Matrix");var d,p=s[0],g=s[1],m=0,y=r;"string"===typeof a&&a===f&&(d=a,m=e.convert(0,d),y=e.find(r,[d,d]));for(var v=[],b=0;b<p;b++)v[b]=[];for(var _=[],w=[],x=0;x<g;x++){for(var S=x+1,E=l[x],A=l[x+1],M=E;M<A;M++){var C=c[M];_[C]=i?y(u[M],o[C][x]):y(o[C][x],u[M]),w[C]=S}for(var k=0;k<p;k++)w[k]===S?v[k][x]=_[k]:v[k][x]=i?y(m,o[k][x]):y(o[k][x],m)}return t.createDenseMatrix({data:v,size:[p,g],datatype:d})}}),Ei="algorithm05",Ai=["typed","equalScalar"],Mi=Kt(Ei,Ai,t=>{var{typed:e,equalScalar:n}=t;return function(t,r,i){var o=t._values,s=t._index,a=t._ptr,u=t._size,c=t._datatype,l=r._values,h=r._index,f=r._ptr,d=r._size,p=r._datatype;if(u.length!==d.length)throw new Dt(u.length,d.length);if(u[0]!==d[0]||u[1]!==d[1])throw new RangeError("Dimension mismatch. Matrix A ("+u+") must match Matrix B ("+d+")");var g,m=u[0],y=u[1],v=n,b=0,_=i;"string"===typeof c&&c===p&&(g=c,v=e.find(n,[g,g]),b=e.convert(0,g),_=e.find(i,[g,g]));var w,x,S,E,A=o&&l?[]:void 0,M=[],C=[],k=A?[]:void 0,O=A?[]:void 0,P=[],T=[];for(x=0;x<y;x++){C[x]=M.length;var L=x+1;for(S=a[x],E=a[x+1];S<E;S++)w=s[S],M.push(w),P[w]=L,k&&(k[w]=o[S]);for(S=f[x],E=f[x+1];S<E;S++)w=h[S],P[w]!==L&&M.push(w),T[w]=L,O&&(O[w]=l[S]);if(A){S=C[x];while(S<M.length){w=M[S];var I=P[w],N=T[w];if(I===L||N===L){var D=I===L?k[w]:b,R=N===L?O[w]:b,F=_(D,R);v(F,b)?M.splice(S,1):(A.push(F),S++)}}}}return C[y]=M.length,t.createSparseMatrix({values:A,index:M,ptr:C,size:[m,y],datatype:g})}}),Ci="algorithm11",ki=["typed","equalScalar"],Oi=Kt(Ci,ki,t=>{var{typed:e,equalScalar:n}=t;return function(t,r,i,o){var s=t._values,a=t._index,u=t._ptr,c=t._size,l=t._datatype;if(!s)throw new Error("Cannot perform operation on Pattern Sparse Matrix and Scalar value");var h,f=c[0],d=c[1],p=n,g=0,m=i;"string"===typeof l&&(h=l,p=e.find(n,[h,h]),g=e.convert(0,h),r=e.convert(r,h),m=e.find(i,[h,h]));for(var y=[],v=[],b=[],_=0;_<d;_++){b[_]=v.length;for(var w=u[_],x=u[_+1],S=w;S<x;S++){var E=a[S],A=o?m(r,s[S]):m(s[S],r);p(A,g)||(v.push(E),y.push(A))}}return b[d]=v.length,t.createSparseMatrix({values:y,index:v,ptr:b,size:[f,d],datatype:h})}}),Pi="algorithm12",Ti=["typed","DenseMatrix"],Li=Kt(Pi,Ti,t=>{var{typed:e,DenseMatrix:n}=t;return function(t,r,i,o){var s=t._values,a=t._index,u=t._ptr,c=t._size,l=t._datatype;if(!s)throw new Error("Cannot perform operation on Pattern Sparse Matrix and Scalar value");var h,f=c[0],d=c[1],p=i;"string"===typeof l&&(h=l,r=e.convert(r,h),p=e.find(i,[h,h]));for(var g=[],m=[],y=[],v=0;v<d;v++){for(var b=v+1,_=u[v],w=u[v+1],x=_;x<w;x++){var S=a[x];m[S]=s[x],y[S]=b}for(var E=0;E<f;E++)0===v&&(g[E]=[]),y[E]===b?g[E][v]=o?p(r,m[E]):p(m[E],r):g[E][v]=o?p(r,0):p(0,r)}return new n({data:g,size:[f,d],datatype:h})}}),Ii="algorithm13",Ni=["typed"],Di=Kt(Ii,Ni,t=>{var{typed:e}=t;return function(t,r,i){var o,s=t._data,a=t._size,u=t._datatype,c=r._data,l=r._size,h=r._datatype,f=[];if(a.length!==l.length)throw new Dt(a.length,l.length);for(var d=0;d<a.length;d++){if(a[d]!==l[d])throw new RangeError("Dimension mismatch. Matrix A ("+a+") must match Matrix B ("+l+")");f[d]=a[d]}var p=i;"string"===typeof u&&u===h&&(o=u,p=e.find(i,[o,o]));var g=f.length>0?n(p,0,f,f[0],s,c):[];return t.createDenseMatrix({data:g,size:f,datatype:o})};function n(t,e,r,i,o,s){var a=[];if(e===r.length-1)for(var u=0;u<i;u++)a[u]=t(o[u],s[u]);else for(var c=0;c<i;c++)a[c]=n(t,e+1,r,r[e+1],o[c],s[c]);return a}}),Ri="algorithm14",Fi=["typed"],Bi=Kt(Ri,Fi,t=>{var{typed:e}=t;return function(t,r,i,o){var s,a=t._data,u=t._size,c=t._datatype,l=i;"string"===typeof c&&(s=c,r=e.convert(r,s),l=e.find(i,[s,s]));var h=u.length>0?n(l,0,u,u[0],a,r,o):[];return t.createDenseMatrix({data:h,size:W(u),datatype:s})};function n(t,e,r,i,o,s,a){var u=[];if(e===r.length-1)for(var c=0;c<i;c++)u[c]=a?t(s,o[c]):t(o[c],s);else for(var l=0;l<i;l++)u[l]=n(t,e+1,r,r[e+1],o[l],s,a);return u}}),ji="algorithm01",zi=["typed"],Ui=Kt(ji,zi,t=>{var{typed:e}=t;return function(t,n,r,i){var o=t._data,s=t._size,a=t._datatype,u=n._values,c=n._index,l=n._ptr,h=n._size,f=n._datatype;if(s.length!==h.length)throw new Dt(s.length,h.length);if(s[0]!==h[0]||s[1]!==h[1])throw new RangeError("Dimension mismatch. Matrix A ("+s+") must match Matrix B ("+h+")");if(!u)throw new Error("Cannot perform operation on Dense Matrix and Pattern Sparse Matrix");var d,p,g=s[0],m=s[1],y="string"===typeof a&&a===f?a:void 0,v=y?e.find(r,[y,y]):r,b=[];for(d=0;d<g;d++)b[d]=[];var _=[],w=[];for(p=0;p<m;p++){for(var x=p+1,S=l[p],E=l[p+1],A=S;A<E;A++)d=c[A],_[d]=i?v(u[A],o[d][p]):v(o[d][p],u[A]),w[d]=x;for(d=0;d<g;d++)w[d]===x?b[d][p]=_[d]:b[d][p]=o[d][p]}return t.createDenseMatrix({data:b,size:[g,m],datatype:y})}});function $i(){throw new Error('No "bignumber" implementation available')}function Vi(){throw new Error('No "fraction" implementation available')}function qi(){throw new Error('No "matrix" implementation available')}var Wi="numeric",Gi=["number","?bignumber","?fraction"],Hi=Kt(Wi,Gi,t=>{var{number:e,bignumber:n,fraction:r}=t,i={string:!0,number:!0,BigNumber:!0,Fraction:!0},o={number:t=>e(t),BigNumber:n?t=>n(t):$i,Fraction:r?t=>r(t):Vi};return function(t,e){var n=q(t);if(!(n in i))throw new TypeError("Cannot convert "+t+' of type "'+n+'"; valid input types are '+Object.keys(i).join(", "));if(!(e in o))throw new TypeError("Cannot convert "+t+' to type "'+e+'"; valid output types are '+Object.keys(o).join(", "));return e===n?t:o[e](t)}});function Xi(t,e,n){var r;return-1!==String(t).indexOf("Unexpected type")?(r=arguments.length>2?" (type: "+q(n)+", value: "+JSON.stringify(n)+")":" (type: "+t.data.actual+")",new TypeError("Cannot calculate "+e+", unexpected type of argument"+r)):-1!==String(t).indexOf("complex numbers")?(r=arguments.length>2?" (type: "+q(n)+", value: "+JSON.stringify(n)+")":"",new TypeError("Cannot calculate "+e+", no ordering relation is defined for complex numbers"+r)):t}var Yi="size",Zi=["typed","config","?matrix"],Ki=Kt(Yi,Zi,t=>{var{typed:e,config:n,matrix:r}=t;return e(Yi,{Matrix:function(t){return t.create(t.size())},Array:Ft,string:function(t){return"Array"===n.matrix?[t.length]:r([t.length])},"number | Complex | BigNumber | Unit | boolean | null":function(t){return"Array"===n.matrix?[]:r?r([]):qi()}})}),Ji="algorithm07",Qi=["typed","DenseMatrix"],to=Kt(Ji,Qi,t=>{var{typed:e,DenseMatrix:n}=t;return function(t,i,o){var s=t._size,a=t._datatype,u=i._size,c=i._datatype;if(s.length!==u.length)throw new Dt(s.length,u.length);if(s[0]!==u[0]||s[1]!==u[1])throw new RangeError("Dimension mismatch. Matrix A ("+s+") must match Matrix B ("+u+")");var l,h,f,d=s[0],p=s[1],g=0,m=o;"string"===typeof a&&a===c&&(l=a,g=e.convert(0,l),m=e.find(o,[l,l]));var y=[];for(h=0;h<d;h++)y[h]=[];var v=[],b=[],_=[],w=[];for(f=0;f<p;f++){var x=f+1;for(r(t,f,_,v,x),r(i,f,w,b,x),h=0;h<d;h++){var S=_[h]===x?v[h]:g,E=w[h]===x?b[h]:g;y[h][f]=m(S,E)}}return new n({data:y,size:[d,p],datatype:l})};function r(t,e,n,r,i){for(var o=t._values,s=t._index,a=t._ptr,u=a[e],c=a[e+1];u<c;u++){var l=s[u];n[l]=i,r[l]=o[u]}}}),eo="smaller",no=["typed","config","matrix","DenseMatrix"],ro=Kt(eo,no,t=>{var{typed:e,config:n,matrix:r,DenseMatrix:i}=t,o=Si({typed:e}),s=to({typed:e,DenseMatrix:i}),a=Li({typed:e,DenseMatrix:i}),u=Di({typed:e}),c=Bi({typed:e});return e(eo,{"boolean, boolean":function(t,e){return t<e},"number, number":function(t,e){return t<e&&!_t(t,e,n.epsilon)},"BigNumber, BigNumber":function(t,e){return t.lt(e)&&!Er(t,e,n.epsilon)},"Fraction, Fraction":function(t,e){return-1===t.compare(e)},"Complex, Complex":function(t,e){throw new TypeError("No ordering relation is defined for complex numbers")},"Unit, Unit":function(t,e){if(!t.equalBase(e))throw new Error("Cannot compare units with different base");return this(t.value,e.value)},"SparseMatrix, SparseMatrix":function(t,e){return s(t,e,this)},"SparseMatrix, DenseMatrix":function(t,e){return o(e,t,this,!0)},"DenseMatrix, SparseMatrix":function(t,e){return o(t,e,this,!1)},"DenseMatrix, DenseMatrix":function(t,e){return u(t,e,this)},"Array, Array":function(t,e){return this(r(t),r(e)).valueOf()},"Array, Matrix":function(t,e){return this(r(t),e)},"Matrix, Array":function(t,e){return this(t,r(e))},"SparseMatrix, any":function(t,e){return a(t,e,this,!1)},"DenseMatrix, any":function(t,e){return c(t,e,this,!1)},"any, SparseMatrix":function(t,e){return a(e,t,this,!0)},"any, DenseMatrix":function(t,e){return c(e,t,this,!0)},"Array, any":function(t,e){return c(r(t),e,this,!1).valueOf()},"any, Array":function(t,e){return c(r(e),t,this,!0).valueOf()}})});var io="algorithm10",oo=["typed","DenseMatrix"],so=Kt(io,oo,t=>{var{typed:e,DenseMatrix:n}=t;return function(t,r,i,o){var s=t._values,a=t._index,u=t._ptr,c=t._size,l=t._datatype;if(!s)throw new Error("Cannot perform operation on Pattern Sparse Matrix and Scalar value");var h,f=c[0],d=c[1],p=i;"string"===typeof l&&(h=l,r=e.convert(r,h),p=e.find(i,[h,h]));for(var g=[],m=[],y=[],v=0;v<d;v++){for(var b=v+1,_=u[v],w=u[v+1],x=_;x<w;x++){var S=a[x];m[S]=s[x],y[S]=b}for(var E=0;E<f;E++)0===v&&(g[E]=[]),y[E]===b?g[E][v]=o?p(r,m[E]):p(m[E],r):g[E][v]=r}return new n({data:g,size:[f,d],datatype:h})}}),ao="subtract",uo=["typed","matrix","equalScalar","addScalar","unaryMinus","DenseMatrix"],co=Kt(ao,uo,t=>{var{typed:e,matrix:n,equalScalar:r,addScalar:i,unaryMinus:o,DenseMatrix:s}=t,a=Ui({typed:e}),u=Si({typed:e}),c=Mi({typed:e,equalScalar:r}),l=so({typed:e,DenseMatrix:s}),h=Di({typed:e}),f=Bi({typed:e});return e(ao,{"number, number":function(t,e){return t-e},"Complex, Complex":function(t,e){return t.sub(e)},"BigNumber, BigNumber":function(t,e){return t.minus(e)},"Fraction, Fraction":function(t,e){return t.sub(e)},"Unit, Unit":function(t,e){if(null===t.value)throw new Error("Parameter x contains a unit with undefined value");if(null===e.value)throw new Error("Parameter y contains a unit with undefined value");if(!t.equalBase(e))throw new Error("Units do not match");var n=t.clone();return n.value=this(n.value,e.value),n.fixPrefix=!1,n},"SparseMatrix, SparseMatrix":function(t,e){return lo(t,e),c(t,e,this)},"SparseMatrix, DenseMatrix":function(t,e){return lo(t,e),u(e,t,this,!0)},"DenseMatrix, SparseMatrix":function(t,e){return lo(t,e),a(t,e,this,!1)},"DenseMatrix, DenseMatrix":function(t,e){return lo(t,e),h(t,e,this)},"Array, Array":function(t,e){return this(n(t),n(e)).valueOf()},"Array, Matrix":function(t,e){return this(n(t),e)},"Matrix, Array":function(t,e){return this(t,n(e))},"SparseMatrix, any":function(t,e){return l(t,o(e),i)},"DenseMatrix, any":function(t,e){return f(t,e,this)},"any, SparseMatrix":function(t,e){return l(e,t,this,!0)},"any, DenseMatrix":function(t,e){return f(e,t,this,!0)},"Array, any":function(t,e){return f(n(t),e,this,!1).valueOf()},"any, Array":function(t,e){return f(n(e),t,this,!0).valueOf()}})});function lo(t,e){var n=t.size(),r=e.size();if(n.length!==r.length)throw new Dt(n.length,r.length)}var ho="compare",fo=["typed","config","matrix","equalScalar","BigNumber","Fraction","DenseMatrix"],po=Kt(ho,fo,t=>{var{typed:e,config:n,equalScalar:r,matrix:i,BigNumber:o,Fraction:s,DenseMatrix:a}=t,u=Si({typed:e}),c=Mi({typed:e,equalScalar:r}),l=Li({typed:e,DenseMatrix:a}),h=Di({typed:e}),f=Bi({typed:e});return e(ho,{"boolean, boolean":function(t,e){return t===e?0:t>e?1:-1},"number, number":function(t,e){return _t(t,e,n.epsilon)?0:t>e?1:-1},"BigNumber, BigNumber":function(t,e){return Er(t,e,n.epsilon)?new o(0):new o(t.cmp(e))},"Fraction, Fraction":function(t,e){return new s(t.compare(e))},"Complex, Complex":function(){throw new TypeError("No ordering relation is defined for complex numbers")},"Unit, Unit":function(t,e){if(!t.equalBase(e))throw new Error("Cannot compare units with different base");return this(t.value,e.value)},"SparseMatrix, SparseMatrix":function(t,e){return c(t,e,this)},"SparseMatrix, DenseMatrix":function(t,e){return u(e,t,this,!0)},"DenseMatrix, SparseMatrix":function(t,e){return u(t,e,this,!1)},"DenseMatrix, DenseMatrix":function(t,e){return h(t,e,this)},"Array, Array":function(t,e){return this(i(t),i(e)).valueOf()},"Array, Matrix":function(t,e){return this(i(t),e)},"Matrix, Array":function(t,e){return this(t,i(e))},"SparseMatrix, any":function(t,e){return l(t,e,this,!1)},"DenseMatrix, any":function(t,e){return f(t,e,this,!1)},"any, SparseMatrix":function(t,e){return l(e,t,this,!0)},"any, DenseMatrix":function(t,e){return f(e,t,this,!0)},"Array, any":function(t,e){return f(i(t),e,this,!1).valueOf()},"any, Array":function(t,e){return f(i(e),t,this,!0).valueOf()}})});var go="divideScalar",mo=["typed","numeric"],yo=Kt(go,mo,t=>{var{typed:e,numeric:n}=t;return e(go,{"number, number":function(t,e){return t/e},"Complex, Complex":function(t,e){return t.div(e)},"BigNumber, BigNumber":function(t,e){return t.div(e)},"Fraction, Fraction":function(t,e){return t.div(e)},"Unit, number | Fraction | BigNumber":function(t,e){var r=t.clone(),i=n(1,q(e));return r.value=this(null===r.value?r._normalize(i):r.value,e),r},"number | Fraction | BigNumber, Unit":function(t,e){var r=e.clone();r=r.pow(-1);var i=n(1,q(t));return r.value=this(t,null===e.value?e._normalize(i):e.value),r},"Unit, Unit":function(t,e){return t.divide(e)}})}),vo="equal",bo=(Kt(vo,["typed","equalScalar"],t=>{var{typed:e,equalScalar:n}=t;return e(vo,{"any, any":function(t,e){return null===t?null===e:null===e?null===t:void 0===t?void 0===e:void 0===e?void 0===t:n(t,e)}})}),"algorithm04"),_o=["typed","equalScalar"],wo=Kt(bo,_o,t=>{var{typed:e,equalScalar:n}=t;return function(t,r,i){var o=t._values,s=t._index,a=t._ptr,u=t._size,c=t._datatype,l=r._values,h=r._index,f=r._ptr,d=r._size,p=r._datatype;if(u.length!==d.length)throw new Dt(u.length,d.length);if(u[0]!==d[0]||u[1]!==d[1])throw new RangeError("Dimension mismatch. Matrix A ("+u+") must match Matrix B ("+d+")");var g,m=u[0],y=u[1],v=n,b=0,_=i;"string"===typeof c&&c===p&&(g=c,v=e.find(n,[g,g]),b=e.convert(0,g),_=e.find(i,[g,g]));var w,x,S,E,A,M=o&&l?[]:void 0,C=[],k=[],O=o&&l?[]:void 0,P=o&&l?[]:void 0,T=[],L=[];for(x=0;x<y;x++){k[x]=C.length;var I=x+1;for(E=a[x],A=a[x+1],S=E;S<A;S++)w=s[S],C.push(w),T[w]=I,O&&(O[w]=o[S]);for(E=f[x],A=f[x+1],S=E;S<A;S++)if(w=h[S],T[w]===I){if(O){var N=_(O[w],l[S]);v(N,b)?T[w]=null:O[w]=N}}else C.push(w),L[w]=I,P&&(P[w]=l[S]);if(O&&P){S=k[x];while(S<C.length)w=C[S],T[w]===I?(M[S]=O[w],S++):L[w]===I?(M[S]=P[w],S++):C.splice(S,1)}}return k[y]=C.length,t.createSparseMatrix({values:M,index:C,ptr:k,size:[m,y],datatype:g})}});var xo="partitionSelect",So=["typed","isNumeric","isNaN","compare"],Eo=Kt(xo,So,t=>{var{typed:e,isNumeric:n,isNaN:r,compare:i}=t,o=i,s=(t,e)=>-i(t,e);return e(xo,{"Array | Matrix, number":function(t,e){return a(t,e,o)},"Array | Matrix, number, string":function(t,e,n){if("asc"===n)return a(t,e,o);if("desc"===n)return a(t,e,s);throw new Error('Compare string must be "asc" or "desc"')},"Array | Matrix, number, function":a});function a(t,e,n){if(!nt(e)||e<0)throw new Error("k must be a non-negative integer");if(d(t)){var r=t.size();if(r.length>1)throw new Error("Only one dimensional matrices supported");return u(t.valueOf(),e,n)}if(Array.isArray(t))return u(t,e,n)}function u(t,e,i){if(e>=t.length)throw new Error("k out of bounds");for(var o=0;o<t.length;o++)if(n(t[o])&&r(t[o]))return t[o];var s=0,a=t.length-1;while(s<a){var u=s,c=a,l=t[Math.floor(Math.random()*(a-s+1))+s];while(u<c)if(i(t[u],l)>=0){var h=t[c];t[c]=t[u],t[u]=h,--c}else++u;i(t[u],l)>0&&--u,e<=u?a=u:s=u+1}return t[e]}});function Ao(t,e,n,r){if(!(this instanceof Ao))throw new SyntaxError("Constructor must be called with the new operator");this.fn=t,this.count=e,this.min=n,this.max=r,this.message="Wrong number of arguments in function "+t+" ("+e+" provided, "+n+(void 0!==r&&null!==r?"-"+r:"")+" expected)",this.stack=(new Error).stack}Ao.prototype=new Error,Ao.prototype.constructor=Error,Ao.prototype.name="ArgumentsError",Ao.prototype.isArgumentsError=!0;n("8b17");var Mo="unequal",Co=(Kt(Mo,["typed","equalScalar"],t=>{var{typed:e,equalScalar:n}=t;return e(Mo,{"any, any":function(t,e){return null===t?null!==e:null===e?null!==t:void 0===t?void 0!==e:void 0===e?void 0!==t:!n(t,e)}})}),"add"),ko=["typed","matrix","addScalar","equalScalar","DenseMatrix","SparseMatrix"],Oo=Kt(Co,ko,t=>{var{typed:e,matrix:n,addScalar:r,equalScalar:i,DenseMatrix:o,SparseMatrix:s}=t,a=Ui({typed:e}),u=wo({typed:e,equalScalar:i}),c=so({typed:e,DenseMatrix:o}),l=Di({typed:e}),h=Bi({typed:e});return e(Co,H({"DenseMatrix, DenseMatrix":function(t,e){return l(t,e,r)},"DenseMatrix, SparseMatrix":function(t,e){return a(t,e,r,!1)},"SparseMatrix, DenseMatrix":function(t,e){return a(e,t,r,!0)},"SparseMatrix, SparseMatrix":function(t,e){return u(t,e,r)},"Array, Array":function(t,e){return this(n(t),n(e)).valueOf()},"Array, Matrix":function(t,e){return this(n(t),e)},"Matrix, Array":function(t,e){return this(t,n(e))},"DenseMatrix, any":function(t,e){return h(t,e,r,!1)},"SparseMatrix, any":function(t,e){return c(t,e,r,!1)},"any, DenseMatrix":function(t,e){return h(e,t,r,!0)},"any, SparseMatrix":function(t,e){return c(e,t,r,!0)},"Array, any":function(t,e){return h(n(t),e,r,!1).valueOf()},"any, Array":function(t,e){return h(n(e),t,r,!0).valueOf()},"any, any":r,"any, any, ...any":function(t,e,n){for(var r=this(t,e),i=0;i<n.length;i++)r=this(r,n[i]);return r}},r.signatures))});n("e975");var Po="dot",To=["typed","addScalar","multiplyScalar","conj","size"],Lo=Kt(Po,To,t=>{var{typed:e,addScalar:n,multiplyScalar:r,conj:i,size:o}=t;return e(Po,{"Array | DenseMatrix, Array | DenseMatrix":a,"SparseMatrix, SparseMatrix":u});function s(t,e){var n,r,i=c(t),o=c(e);if(1===i.length)n=i[0];else{if(2!==i.length||1!==i[1])throw new RangeError("Expected a column vector, instead got a matrix of size ("+i.join(", ")+")");n=i[0]}if(1===o.length)r=o[0];else{if(2!==o.length||1!==o[1])throw new RangeError("Expected a column vector, instead got a matrix of size ("+o.join(", ")+")");r=o[0]}if(n!==r)throw new RangeError("Vectors must have equal length ("+n+" != "+r+")");if(0===n)throw new RangeError("Cannot calculate the dot product of empty vectors");return n}function a(t,o){var a=s(t,o),u=d(t)?t._data:t,l=d(t)?t._datatype:void 0,h=d(o)?o._data:o,f=d(o)?o._datatype:void 0,p=2===c(t).length,g=2===c(o).length,m=n,y=r;if(l&&f&&l===f&&"string"===typeof l){var v=l;m=e.find(n,[v,v]),y=e.find(r,[v,v])}if(!p&&!g){for(var b=y(i(u[0]),h[0]),_=1;_<a;_++)b=m(b,y(i(u[_]),h[_]));return b}if(!p&&g){for(var w=y(i(u[0]),h[0][0]),x=1;x<a;x++)w=m(w,y(i(u[x]),h[x][0]));return w}if(p&&!g){for(var S=y(i(u[0][0]),h[0]),E=1;E<a;E++)S=m(S,y(i(u[E][0]),h[E]));return S}if(p&&g){for(var A=y(i(u[0][0]),h[0][0]),M=1;M<a;M++)A=m(A,y(i(u[M][0]),h[M][0]));return A}}function u(t,e){s(t,e);var i=t._index,o=t._values,a=e._index,u=e._values,c=0,l=n,h=r,f=0,d=0;while(f<i.length&&d<a.length){var p=i[f],g=a[d];p<g?f++:p>g?d++:p===g&&(c=l(c,h(o[f],u[d])),f++,d++)}return c}function c(t){return d(t)?t.size():o(t)}}),Io="identity",No=["typed","config","matrix","BigNumber","DenseMatrix","SparseMatrix"],Do=Kt(Io,No,t=>{var{typed:e,config:n,matrix:r,BigNumber:i,DenseMatrix:o,SparseMatrix:s}=t;return e(Io,{"":function(){return"Matrix"===n.matrix?r([]):[]},string:function(t){return r(t)},"number | BigNumber":function(t){return c(t,t,"Matrix"===n.matrix?"dense":void 0)},"number | BigNumber, string":function(t,e){return c(t,t,e)},"number | BigNumber, number | BigNumber":function(t,e){return c(t,e,"Matrix"===n.matrix?"dense":void 0)},"number | BigNumber, number | BigNumber, string":function(t,e,n){return c(t,e,n)},Array:function(t){return u(t)},"Array, string":function(t,e){return u(t,e)},Matrix:function(t){return u(t.valueOf(),t.storage())},"Matrix, string":function(t,e){return u(t.valueOf(),e)}});function u(t,e){switch(t.length){case 0:return e?r(e):[];case 1:return c(t[0],t[0],e);case 2:return c(t[0],t[1],e);default:throw new Error("Vector containing two values expected")}}function c(t,e,n){var r=a(t)||a(e)?i:null;if(a(t)&&(t=t.toNumber()),a(e)&&(e=e.toNumber()),!nt(t)||t<1)throw new Error("Parameters in function identity must be positive integers");if(!nt(e)||e<1)throw new Error("Parameters in function identity must be positive integers");var u=r?new i(1):1,c=r?new r(0):0,l=[t,e];if(n){if("sparse"===n)return s.diagonal(l,u,0,c);if("dense"===n)return o.diagonal(l,u,0,c);throw new TypeError('Unknown matrix type "'.concat(n,'"'))}for(var h=Ut([],l,c),f=t<e?t:e,d=0;d<f;d++)h[d][d]=u;return h}}),Ro="larger",Fo=["typed","config","matrix","DenseMatrix"],Bo=Kt(Ro,Fo,t=>{var{typed:e,config:n,matrix:r,DenseMatrix:i}=t,o=Si({typed:e}),s=to({typed:e,DenseMatrix:i}),a=Li({typed:e,DenseMatrix:i}),u=Di({typed:e}),c=Bi({typed:e});return e(Ro,{"boolean, boolean":function(t,e){return t>e},"number, number":function(t,e){return t>e&&!_t(t,e,n.epsilon)},"BigNumber, BigNumber":function(t,e){return t.gt(e)&&!Er(t,e,n.epsilon)},"Fraction, Fraction":function(t,e){return 1===t.compare(e)},"Complex, Complex":function(){throw new TypeError("No ordering relation is defined for complex numbers")},"Unit, Unit":function(t,e){if(!t.equalBase(e))throw new Error("Cannot compare units with different base");return this(t.value,e.value)},"SparseMatrix, SparseMatrix":function(t,e){return s(t,e,this)},"SparseMatrix, DenseMatrix":function(t,e){return o(e,t,this,!0)},"DenseMatrix, SparseMatrix":function(t,e){return o(t,e,this,!1)},"DenseMatrix, DenseMatrix":function(t,e){return u(t,e,this)},"Array, Array":function(t,e){return this(r(t),r(e)).valueOf()},"Array, Matrix":function(t,e){return this(r(t),e)},"Matrix, Array":function(t,e){return this(t,r(e))},"SparseMatrix, any":function(t,e){return a(t,e,this,!1)},"DenseMatrix, any":function(t,e){return c(t,e,this,!1)},"any, SparseMatrix":function(t,e){return a(e,t,this,!0)},"any, DenseMatrix":function(t,e){return c(e,t,this,!0)},"Array, any":function(t,e){return c(r(t),e,this,!1).valueOf()},"any, Array":function(t,e){return c(r(e),t,this,!0).valueOf()}})}),jo="multiply",zo=["typed","matrix","addScalar","multiplyScalar","equalScalar","dot"],Uo=Kt(jo,zo,t=>{var{typed:e,matrix:n,addScalar:r,multiplyScalar:i,equalScalar:o,dot:s}=t,a=Oi({typed:e,equalScalar:o}),u=Bi({typed:e});function c(t,e){switch(t.length){case 1:switch(e.length){case 1:if(t[0]!==e[0])throw new RangeError("Dimension mismatch in multiplication. Vectors must have the same length");break;case 2:if(t[0]!==e[0])throw new RangeError("Dimension mismatch in multiplication. Vector length ("+t[0]+") must match Matrix rows ("+e[0]+")");break;default:throw new Error("Can only multiply a 1 or 2 dimensional matrix (Matrix B has "+e.length+" dimensions)")}break;case 2:switch(e.length){case 1:if(t[1]!==e[0])throw new RangeError("Dimension mismatch in multiplication. Matrix columns ("+t[1]+") must match Vector length ("+e[0]+")");break;case 2:if(t[1]!==e[0])throw new RangeError("Dimension mismatch in multiplication. Matrix A columns ("+t[1]+") must match Matrix B rows ("+e[0]+")");break;default:throw new Error("Can only multiply a 1 or 2 dimensional matrix (Matrix B has "+e.length+" dimensions)")}break;default:throw new Error("Can only multiply a 1 or 2 dimensional matrix (Matrix A has "+t.length+" dimensions)")}}function l(t,e,n){if(0===n)throw new Error("Cannot multiply two empty vectors");return s(t,e)}function h(t,e){if("dense"!==e.storage())throw new Error("Support for SparseMatrix not implemented");return f(t,e)}function f(t,n){var o,s=t._data,a=t._size,u=t._datatype,c=n._data,l=n._size,h=n._datatype,f=a[0],d=l[1],p=r,g=i;u&&h&&u===h&&"string"===typeof u&&(o=u,p=e.find(r,[o,o]),g=e.find(i,[o,o]));for(var m=[],y=0;y<d;y++){for(var v=g(s[0],c[0][y]),b=1;b<f;b++)v=p(v,g(s[b],c[b][y]));m[y]=v}return t.createDenseMatrix({data:m,size:[d],datatype:o})}var p=e("_multiplyMatrixVector",{"DenseMatrix, any":m,"SparseMatrix, any":b}),g=e("_multiplyMatrixMatrix",{"DenseMatrix, DenseMatrix":y,"DenseMatrix, SparseMatrix":v,"SparseMatrix, DenseMatrix":_,"SparseMatrix, SparseMatrix":w});function m(t,n){var o,s=t._data,a=t._size,u=t._datatype,c=n._data,l=n._datatype,h=a[0],f=a[1],d=r,p=i;u&&l&&u===l&&"string"===typeof u&&(o=u,d=e.find(r,[o,o]),p=e.find(i,[o,o]));for(var g=[],m=0;m<h;m++){for(var y=s[m],v=p(y[0],c[0]),b=1;b<f;b++)v=d(v,p(y[b],c[b]));g[m]=v}return t.createDenseMatrix({data:g,size:[h],datatype:o})}function y(t,n){var o,s=t._data,a=t._size,u=t._datatype,c=n._data,l=n._size,h=n._datatype,f=a[0],d=a[1],p=l[1],g=r,m=i;u&&h&&u===h&&"string"===typeof u&&(o=u,g=e.find(r,[o,o]),m=e.find(i,[o,o]));for(var y=[],v=0;v<f;v++){var b=s[v];y[v]=[];for(var _=0;_<p;_++){for(var w=m(b[0],c[0][_]),x=1;x<d;x++)w=g(w,m(b[x],c[x][_]));y[v][_]=w}}return t.createDenseMatrix({data:y,size:[f,p],datatype:o})}function v(t,n){var s=t._data,a=t._size,u=t._datatype,c=n._values,l=n._index,h=n._ptr,f=n._size,d=n._datatype;if(!c)throw new Error("Cannot multiply Dense Matrix times Pattern only Matrix");var p,g=a[0],m=f[1],y=r,v=i,b=o,_=0;u&&d&&u===d&&"string"===typeof u&&(p=u,y=e.find(r,[p,p]),v=e.find(i,[p,p]),b=e.find(o,[p,p]),_=e.convert(0,p));for(var w=[],x=[],S=[],E=n.createSparseMatrix({values:w,index:x,ptr:S,size:[g,m],datatype:p}),A=0;A<m;A++){S[A]=x.length;var M=h[A],C=h[A+1];if(C>M)for(var k=0,O=0;O<g;O++){for(var P=O+1,T=void 0,L=M;L<C;L++){var I=l[L];k!==P?(T=v(s[O][I],c[L]),k=P):T=y(T,v(s[O][I],c[L]))}k!==P||b(T,_)||(x.push(O),w.push(T))}}return S[m]=x.length,E}function b(t,n){var s=t._values,a=t._index,u=t._ptr,c=t._datatype;if(!s)throw new Error("Cannot multiply Pattern only Matrix times Dense Matrix");var l,h=n._data,f=n._datatype,d=t._size[0],p=n._size[0],g=[],m=[],y=[],v=r,b=i,_=o,w=0;c&&f&&c===f&&"string"===typeof c&&(l=c,v=e.find(r,[l,l]),b=e.find(i,[l,l]),_=e.find(o,[l,l]),w=e.convert(0,l));var x=[],S=[];y[0]=0;for(var E=0;E<p;E++){var A=h[E];if(!_(A,w))for(var M=u[E],C=u[E+1],k=M;k<C;k++){var O=a[k];S[O]?x[O]=v(x[O],b(A,s[k])):(S[O]=!0,m.push(O),x[O]=b(A,s[k]))}}for(var P=m.length,T=0;T<P;T++){var L=m[T];g[T]=x[L]}return y[1]=m.length,t.createSparseMatrix({values:g,index:m,ptr:y,size:[d,1],datatype:l})}function _(t,n){var s=t._values,a=t._index,u=t._ptr,c=t._datatype;if(!s)throw new Error("Cannot multiply Pattern only Matrix times Dense Matrix");var l,h=n._data,f=n._datatype,d=t._size[0],p=n._size[0],g=n._size[1],m=r,y=i,v=o,b=0;c&&f&&c===f&&"string"===typeof c&&(l=c,m=e.find(r,[l,l]),y=e.find(i,[l,l]),v=e.find(o,[l,l]),b=e.convert(0,l));for(var _=[],w=[],x=[],S=t.createSparseMatrix({values:_,index:w,ptr:x,size:[d,g],datatype:l}),E=[],A=[],M=0;M<g;M++){x[M]=w.length;for(var C=M+1,k=0;k<p;k++){var O=h[k][M];if(!v(O,b))for(var P=u[k],T=u[k+1],L=P;L<T;L++){var I=a[L];A[I]!==C?(A[I]=C,w.push(I),E[I]=y(O,s[L])):E[I]=m(E[I],y(O,s[L]))}}for(var N=x[M],D=w.length,R=N;R<D;R++){var F=w[R];_[R]=E[F]}}return x[g]=w.length,S}function w(t,n){var o,s=t._values,a=t._index,u=t._ptr,c=t._datatype,l=n._values,h=n._index,f=n._ptr,d=n._datatype,p=t._size[0],g=n._size[1],m=s&&l,y=r,v=i;c&&d&&c===d&&"string"===typeof c&&(o=c,y=e.find(r,[o,o]),v=e.find(i,[o,o]));for(var b,_,w,x,S,E,A,M,C=m?[]:void 0,k=[],O=[],P=t.createSparseMatrix({values:C,index:k,ptr:O,size:[p,g],datatype:o}),T=m?[]:void 0,L=[],I=0;I<g;I++){O[I]=k.length;var N=I+1;for(S=f[I],E=f[I+1],x=S;x<E;x++)if(M=h[x],m)for(_=u[M],w=u[M+1],b=_;b<w;b++)A=a[b],L[A]!==N?(L[A]=N,k.push(A),T[A]=v(l[x],s[b])):T[A]=y(T[A],v(l[x],s[b]));else for(_=u[M],w=u[M+1],b=_;b<w;b++)A=a[b],L[A]!==N&&(L[A]=N,k.push(A));if(m)for(var D=O[I],R=k.length,F=D;F<R;F++){var B=k[F];C[F]=T[B]}}return O[g]=k.length,P}return e(jo,H({"Array, Array":function(t,e){c(Ft(t),Ft(e));var r=this(n(t),n(e));return d(r)?r.valueOf():r},"Matrix, Matrix":function(t,e){var n=t.size(),r=e.size();return c(n,r),1===n.length?1===r.length?l(t,e,n[0]):h(t,e):1===r.length?p(t,e):g(t,e)},"Matrix, Array":function(t,e){return this(t,n(e))},"Array, Matrix":function(t,e){return this(n(t,e.storage()),e)},"SparseMatrix, any":function(t,e){return a(t,e,i,!1)},"DenseMatrix, any":function(t,e){return u(t,e,i,!1)},"any, SparseMatrix":function(t,e){return a(e,t,i,!0)},"any, DenseMatrix":function(t,e){return u(e,t,i,!0)},"Array, any":function(t,e){return u(n(t),e,i,!1).valueOf()},"any, Array":function(t,e){return u(n(e),t,i,!0).valueOf()},"any, any":i,"any, any, ...any":function(t,e,n){for(var r=this(t,e),i=0;i<n.length;i++)r=this(r,n[i]);return r}},i.signatures))});var $o="FibonacciHeap",Vo=["smaller","larger"],qo=Kt($o,Vo,t=>{var{smaller:e,larger:n}=t,r=1/Math.log((1+Math.sqrt(5))/2);function i(){if(!(this instanceof i))throw new SyntaxError("Constructor must be called with the new operator");this._minimum=null,this._size=0}function o(t,n,r){n.key=r;var i=n.parent;return i&&e(n.key,i.key)&&(s(t,n,i),a(t,i)),e(n.key,t.key)&&(t=n),t}function s(t,e,n){e.left.right=e.right,e.right.left=e.left,n.degree--,n.child===e&&(n.child=e.right),0===n.degree&&(n.child=null),e.left=t,e.right=t.right,t.right=e,e.right.left=e,e.parent=null,e.mark=!1}function a(t,e){var n=e.parent;n&&(e.mark?(s(t,e,n),a(n)):e.mark=!0)}i.prototype.type="FibonacciHeap",i.prototype.isFibonacciHeap=!0,i.prototype.insert=function(t,n){var r={key:t,value:n,degree:0};if(this._minimum){var i=this._minimum;r.left=i,r.right=i.right,i.right=r,r.right.left=r,e(t,i.key)&&(this._minimum=r)}else r.left=r,r.right=r,this._minimum=r;return this._size++,r},i.prototype.size=function(){return this._size},i.prototype.clear=function(){this._minimum=null,this._size=0},i.prototype.isEmpty=function(){return 0===this._size},i.prototype.extractMinimum=function(){var t=this._minimum;if(null===t)return t;var e=this._minimum,n=t.degree,r=t.child;while(n>0){var i=r.right;r.left.right=r.right,r.right.left=r.left,r.left=e,r.right=e.right,e.right=r,r.right.left=r,r.parent=null,r=i,n--}return t.left.right=t.right,t.right.left=t.left,t===t.right?e=null:(e=t.right,e=c(e,this._size)),this._size--,this._minimum=e,t},i.prototype.remove=function(t){this._minimum=o(this._minimum,t,-1),this.extractMinimum()};var u=function(t,e){t.left.right=t.right,t.right.left=t.left,t.parent=e,e.child?(t.left=e.child,t.right=e.child.right,e.child.right=t,t.right.left=t):(e.child=t,t.right=t,t.left=t),e.degree++,t.mark=!1};function c(t,i){var o,s=Math.floor(Math.log(i)*r)+1,a=new Array(s),c=0,l=t;if(l){c++,l=l.right;while(l!==t)c++,l=l.right}while(c>0){var h=l.degree,f=l.right;while(1){if(o=a[h],!o)break;if(n(l.key,o.key)){var d=o;o=l,l=d}u(o,l),a[h]=null,h++}a[h]=l,l=f,c--}t=null;for(var p=0;p<s;p++)o=a[p],o&&(t?(o.left.right=o.right,o.right.left=o.left,o.left=t,o.right=t.right,t.right=o,o.right.left=o,e(o.key,t.key)&&(t=o)):t=o);return t}return i},{isClass:!0});function Wo(t){var e;if(nt(t))return t<=0?isFinite(t)?1/0:NaN:t>171?1/0:br(1,t-1);if(t<.5)return Math.PI/(Math.sin(Math.PI*t)*Wo(1-t));if(t>=171.35)return 1/0;if(t>85){var n=t*t,r=n*t,i=r*t,o=i*t;return Math.sqrt(2*Math.PI/t)*Math.pow(t/Math.E,t)*(1+1/(12*t)+1/(288*n)-139/(51840*r)-571/(2488320*i)+163879/(209018880*o)+5246819/(75246796800*o*t))}--t,e=Ho[0];for(var s=1;s<Ho.length;++s)e+=Ho[s]/(t+s);var a=t+Go+.5;return Math.sqrt(2*Math.PI)*Math.pow(a,t+.5)*Math.exp(-a)*e}Wo.signature="number";var Go=4.7421875,Ho=[.9999999999999971,57.15623566586292,-59.59796035547549,14.136097974741746,-.4919138160976202,3399464998481189e-20,4652362892704858e-20,-9837447530487956e-20,.0001580887032249125,-.00021026444172410488,.00021743961811521265,-.0001643181065367639,8441822398385275e-20,-26190838401581408e-21,36899182659531625e-22],Xo="max",Yo=["typed","config","numeric","larger"],Zo=Kt(Xo,Yo,t=>{var{typed:e,config:n,numeric:r,larger:i}=t;return e(Xo,{"Array | Matrix":s,"Array | Matrix, number | BigNumber":function(t,e){return He(t,e.valueOf(),o)},"...":function(t){if(qe(t))throw new TypeError("Scalar values expected in function max");return s(t)}});function o(t,e){try{return i(t,e)?t:e}catch(n){throw Xi(n,"max",e)}}function s(t){var e;if(We(t,(function(t){try{isNaN(t)&&"number"===typeof t?e=NaN:(void 0===e||i(t,e))&&(e=t)}catch(n){throw Xi(n,"max",t)}})),void 0===e)throw new Error("Cannot calculate max of an empty array");return"string"===typeof e&&(e=r(e,n.number)),e}});var Ko="Spa",Jo=["addScalar","equalScalar","FibonacciHeap"],Qo=Kt(Ko,Jo,t=>{var{addScalar:e,equalScalar:n,FibonacciHeap:r}=t;function i(){if(!(this instanceof i))throw new SyntaxError("Constructor must be called with the new operator");this._values=[],this._heap=new r}return i.prototype.type="Spa",i.prototype.isSpa=!0,i.prototype.set=function(t,e){if(this._values[t])this._values[t].value=e;else{var n=this._heap.insert(t,e);this._values[t]=n}},i.prototype.get=function(t){var e=this._values[t];return e?e.value:0},i.prototype.accumulate=function(t,n){var r=this._values[t];r?r.value=e(r.value,n):(r=this._heap.insert(t,n),this._values[t]=r)},i.prototype.forEach=function(t,e,r){var i=this._heap,o=this._values,s=[],a=i.extractMinimum();a&&s.push(a);while(a&&a.key<=e)a.key>=t&&(n(a.value,0)||r(a.key,a.value,this)),a=i.extractMinimum(),a&&s.push(a);for(var u=0;u<s.length;u++){var c=s[u];a=i.insert(c.key,c.value),o[a.key]=a}},i.prototype.swap=function(t,e){var n=this._values[t],r=this._values[e];if(!n&&r)n=this._heap.insert(t,r.value),this._heap.remove(r),this._values[t]=n,this._values[e]=void 0;else if(n&&!r)r=this._heap.insert(e,n.value),this._heap.remove(n),this._values[e]=r,this._values[t]=void 0;else if(n&&r){var i=n.value;n.value=r.value,r.value=i}},i},{isClass:!0}),ts="lup",es=["typed","matrix","abs","addScalar","divideScalar","multiplyScalar","subtract","larger","equalScalar","unaryMinus","DenseMatrix","SparseMatrix","Spa"],ns=Kt(ts,es,t=>{var{typed:e,matrix:n,abs:r,addScalar:i,divideScalar:o,multiplyScalar:s,subtract:a,larger:u,equalScalar:c,unaryMinus:l,DenseMatrix:h,SparseMatrix:f,Spa:d}=t;return e(ts,{DenseMatrix:function(t){return p(t)},SparseMatrix:function(t){return g(t)},Array:function(t){var e=n(t),r=p(e);return{L:r.L.valueOf(),U:r.U.valueOf(),p:r.p}}});function p(t){var e,n,l,f=t._size[0],d=t._size[1],p=Math.min(f,d),g=W(t._data),m=[],y=[f,p],v=[],b=[p,d],_=[];for(e=0;e<f;e++)_[e]=e;for(n=0;n<d;n++){if(n>0)for(e=0;e<f;e++){var w=Math.min(e,n),x=0;for(l=0;l<w;l++)x=i(x,s(g[e][l],g[l][n]));g[e][n]=a(g[e][n],x)}var S=n,E=0,A=0;for(e=n;e<f;e++){var M=g[e][n],C=r(M);u(C,E)&&(S=e,E=C,A=M)}if(n!==S&&(_[n]=[_[S],_[S]=_[n]][0],h._swapRows(n,S,g)),n<f)for(e=n+1;e<f;e++){var k=g[e][n];c(k,0)||(g[e][n]=o(g[e][n],A))}}for(n=0;n<d;n++)for(e=0;e<f;e++)0===n&&(e<d&&(v[e]=[]),m[e]=[]),e<n?(e<d&&(v[e][n]=g[e][n]),n<f&&(m[e][n]=0)):e!==n?(e<d&&(v[e][n]=0),n<f&&(m[e][n]=g[e][n])):(e<d&&(v[e][n]=g[e][n]),n<f&&(m[e][n]=1));var O=new h({data:m,size:y}),P=new h({data:v,size:b}),T=[];for(e=0,p=_.length;e<p;e++)T[_[e]]=e;return{L:O,U:P,p:T,toString:function(){return"L: "+this.L.toString()+"\nU: "+this.U.toString()+"\nP: "+this.p}}}function g(t){var e,n,i,a=t._size[0],h=t._size[1],p=Math.min(a,h),g=t._values,m=t._index,y=t._ptr,v=[],b=[],_=[],w=[a,p],x=[],S=[],E=[],A=[p,h],M=[],C=[];for(e=0;e<a;e++)M[e]=e,C[e]=e;var k=function(t,e){var n=C[t],r=C[e];M[n]=e,M[r]=t,C[t]=r,C[e]=n},O=function(){var t=new d;n<a&&(_.push(v.length),v.push(1),b.push(n)),E.push(x.length);var h=y[n],p=y[n+1];for(i=h;i<p;i++)e=m[i],t.set(M[e],g[i]);n>0&&t.forEach(0,n-1,(function(e,n){f._forEachRow(e,v,b,_,(function(r,i){r>e&&t.accumulate(r,l(s(i,n)))}))}));var C=n,O=t.get(n),P=r(O);t.forEach(n+1,a-1,(function(t,e){var n=r(e);u(n,P)&&(C=t,P=n,O=e)})),n!==C&&(f._swapRows(n,C,w[1],v,b,_),f._swapRows(n,C,A[1],x,S,E),t.swap(n,C),k(n,C)),t.forEach(0,a-1,(function(t,e){t<=n?(x.push(e),S.push(t)):(e=o(e,O),c(e,0)||(v.push(e),b.push(t)))}))};for(n=0;n<h;n++)O();return E.push(x.length),_.push(v.length),{L:new f({values:v,index:b,ptr:_,size:w}),U:new f({values:x,index:S,ptr:E,size:A}),p:M,toString:function(){return"L: "+this.L.toString()+"\nU: "+this.U.toString()+"\nP: "+this.p}}}}),rs="det",is=["typed","matrix","subtract","multiply","unaryMinus","lup"],os=Kt(rs,is,t=>{var{typed:e,matrix:n,subtract:r,multiply:i,unaryMinus:o,lup:s}=t;return e(rs,{any:function(t){return W(t)},"Array | Matrix":function(t){var e;switch(d(t)?e=t.size():Array.isArray(t)?(t=n(t),e=t.size()):e=[],e.length){case 0:return W(t);case 1:if(1===e[0])return W(t.valueOf()[0]);throw new RangeError("Matrix must be square (size: "+Lt(e)+")");case 2:var r=e[0],i=e[1];if(r===i)return a(t.clone().valueOf(),r,i);throw new RangeError("Matrix must be square (size: "+Lt(e)+")");default:throw new RangeError("Matrix must be two dimensional (size: "+Lt(e)+")")}}});function a(t,e,n){if(1===e)return W(t[0][0]);if(2===e)return r(i(t[0][0],t[1][1]),i(t[1][0],t[0][1]));for(var a=s(t),u=a.U[0][0],c=1;c<e;c++)u=i(u,a.U[c][c]);var l=0,h=0,f=[];while(1){while(f[h])h++;if(h>=e)break;var d=h,p=0;while(!f[a.p[d]])f[a.p[d]]=!0,d=a.p[d],p++;p%2===0&&l++}return l%2===0?u:o(u)}}),ss="inv",as=["typed","matrix","divideScalar","addScalar","multiply","unaryMinus","det","identity","abs"],us=Kt(ss,as,t=>{var{typed:e,matrix:n,divideScalar:r,addScalar:i,multiply:o,unaryMinus:s,det:a,identity:u,abs:c}=t;return e(ss,{"Array | Matrix":function(t){var e=d(t)?t.size():Ft(t);switch(e.length){case 1:if(1===e[0])return d(t)?n([r(1,t.valueOf()[0])]):[r(1,t[0])];throw new RangeError("Matrix must be square (size: "+Lt(e)+")");case 2:var i=e[0],o=e[1];if(i===o)return d(t)?n(l(t.valueOf(),i,o),t.storage()):l(t,i,o);throw new RangeError("Matrix must be square (size: "+Lt(e)+")");default:throw new RangeError("Matrix must be two dimensional (size: "+Lt(e)+")")}},any:function(t){return r(1,t)}});function l(t,e,n){var l,h,f,d,p;if(1===e){if(d=t[0][0],0===d)throw Error("Cannot calculate inverse, determinant is zero");return[[r(1,d)]]}if(2===e){var g=a(t);if(0===g)throw Error("Cannot calculate inverse, determinant is zero");return[[r(t[1][1],g),r(s(t[0][1]),g)],[r(s(t[1][0]),g),r(t[0][0],g)]]}var m=t.concat();for(l=0;l<e;l++)m[l]=m[l].concat();for(var y=u(e).valueOf(),v=0;v<n;v++){var b=c(m[v][v]),_=v;l=v+1;while(l<e)c(m[l][v])>b&&(b=c(m[l][v]),_=l),l++;if(0===b)throw Error("Cannot calculate inverse, determinant is zero");l=_,l!==v&&(p=m[v],m[v]=m[l],m[l]=p,p=y[v],y[v]=y[l],y[l]=p);var w=m[v],x=y[v];for(l=0;l<e;l++){var S=m[l],E=y[l];if(l!==v){if(0!==S[v]){for(f=r(s(S[v]),w[v]),h=v;h<n;h++)S[h]=i(S[h],o(f,w[h]));for(h=0;h<n;h++)E[h]=i(E[h],o(f,x[h]))}}else{for(f=w[v],h=v;h<n;h++)S[h]=r(S[h],f);for(h=0;h<n;h++)E[h]=r(E[h],f)}}}return y}});var cs="divide",ls=["typed","matrix","multiply","equalScalar","divideScalar","inv"],hs=Kt(cs,ls,t=>{var{typed:e,matrix:n,multiply:r,equalScalar:i,divideScalar:o,inv:s}=t,a=Oi({typed:e,equalScalar:i}),u=Bi({typed:e});return e("divide",H({"Array | Matrix, Array | Matrix":function(t,e){return r(t,s(e))},"DenseMatrix, any":function(t,e){return u(t,e,o,!1)},"SparseMatrix, any":function(t,e){return a(t,e,o,!1)},"Array, any":function(t,e){return u(n(t),e,o,!1).valueOf()},"any, Array | Matrix":function(t,e){return r(t,s(e))}},o.signatures))}),fs="mean",ds=["typed","add","divide"],ps=Kt(fs,ds,t=>{var{typed:e,add:n,divide:r}=t;return e(fs,{"Array | Matrix":o,"Array | Matrix, number | BigNumber":i,"...":function(t){if(qe(t))throw new TypeError("Scalar values expected in function mean");return o(t)}});function i(t,e){try{var i=He(t,e,n),o=Array.isArray(t)?Ft(t):t.size();return r(i,o[e])}catch(s){throw Xi(s,"mean")}}function o(t){var e,i=0;if(We(t,(function(t){try{e=void 0===e?t:n(e,t),i++}catch(r){throw Xi(r,"mean",t)}})),0===i)throw new Error("Cannot calculate the mean of an empty array");return r(e,i)}}),gs="median",ms=["typed","add","divide","compare","partitionSelect"],ys=Kt(gs,ms,t=>{var{typed:e,add:n,divide:r,compare:i,partitionSelect:o}=t;function s(t){try{t=Yt(t.valueOf());var e=t.length;if(0===e)throw new Error("Cannot calculate median of an empty array");if(e%2===0){for(var n=e/2-1,r=o(t,n+1),s=t[n],c=0;c<n;++c)i(t[c],s)>0&&(s=t[c]);return u(s,r)}var l=o(t,(e-1)/2);return a(l)}catch(h){throw Xi(h,"median")}}var a=e({"number | BigNumber | Complex | Unit":function(t){return t}}),u=e({"number | BigNumber | Complex | Unit, number | BigNumber | Complex | Unit":function(t,e){return r(n(t,e),2)}});return e(gs,{"Array | Matrix":s,"Array | Matrix, number | BigNumber":function(t,e){throw new Error("median(A, dim) is not yet supported")},"...":function(t){if(qe(t))throw new TypeError("Scalar values expected in function median");return s(t)}})});var vs=re({config:Q}),bs=ue({}),_s=ve({}),ws=we({}),xs=Ee({Matrix:ws}),Ss=je({BigNumber:vs,Complex:bs,DenseMatrix:xs,Fraction:_s}),Es=Pn({typed:Ss}),As=sr({typed:Ss}),Ms=cr({BigNumber:vs,typed:Ss}),Cs=Sr({typed:Ss}),ks=kr({config:Q,typed:Ss}),Os=jr({typed:Ss}),Ps=Zr({typed:Ss}),Ts=ri({Matrix:ws,equalScalar:ks,typed:Ss}),Ls=ui({typed:Ss}),Is=hi({typed:Ss}),Ns=pi({Fraction:_s,typed:Ss}),Ds=yi({typed:Ss}),Rs=_i({DenseMatrix:xs,Matrix:ws,SparseMatrix:Ts,typed:Ss}),Fs=Hi({bignumber:Ms,fraction:Ns,number:Ps}),Bs=Ki({matrix:Rs,config:Q,typed:Ss}),js=ro({DenseMatrix:xs,config:Q,matrix:Rs,typed:Ss}),zs=co({DenseMatrix:xs,addScalar:As,equalScalar:ks,matrix:Rs,typed:Ss,unaryMinus:Is}),Us=po({BigNumber:vs,DenseMatrix:xs,Fraction:_s,config:Q,equalScalar:ks,matrix:Rs,typed:Ss}),$s=yo({numeric:Fs,typed:Ss}),Vs=Eo({compare:Us,isNaN:Ls,isNumeric:Ds,typed:Ss}),qs=Oo({DenseMatrix:xs,SparseMatrix:Ts,addScalar:As,equalScalar:ks,matrix:Rs,typed:Ss}),Ws=Lo({addScalar:As,conj:Cs,multiplyScalar:Os,size:Bs,typed:Ss}),Gs=Do({BigNumber:vs,DenseMatrix:xs,SparseMatrix:Ts,config:Q,matrix:Rs,typed:Ss}),Hs=Bo({DenseMatrix:xs,config:Q,matrix:Rs,typed:Ss}),Xs=Uo({addScalar:As,dot:Ws,equalScalar:ks,matrix:Rs,multiplyScalar:Os,typed:Ss}),Ys=qo({larger:Hs,smaller:js}),Zs=Zo({config:Q,larger:Hs,numeric:Fs,typed:Ss}),Ks=Qo({FibonacciHeap:Ys,addScalar:As,equalScalar:ks}),Js=ns({DenseMatrix:xs,Spa:Ks,SparseMatrix:Ts,abs:Es,addScalar:As,divideScalar:$s,equalScalar:ks,larger:Hs,matrix:Rs,multiplyScalar:Os,subtract:zs,typed:Ss,unaryMinus:Is}),Qs=os({lup:Js,matrix:Rs,multiply:Xs,subtract:zs,typed:Ss,unaryMinus:Is}),ta=us({abs:Es,addScalar:As,det:Qs,divideScalar:$s,identity:Gs,matrix:Rs,multiply:Xs,typed:Ss,unaryMinus:Is}),ea=hs({divideScalar:$s,equalScalar:ks,inv:ta,matrix:Rs,multiply:Xs,typed:Ss}),na=ps({add:qs,divide:ea,typed:Ss}),ra=ys({add:qs,compare:Us,divide:ea,partitionSelect:Vs,typed:Ss})},"7a77":function(t,e,n){"use strict";function r(t){this.message=t}r.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},r.prototype.__CANCEL__=!0,t.exports=r},"7aac":function(t,e,n){"use strict";var r=n("c532");t.exports=r.isStandardBrowserEnv()?function(){return{write:function(t,e,n,i,o,s){var a=[];a.push(t+"="+encodeURIComponent(e)),r.isNumber(n)&&a.push("expires="+new Date(n).toGMTString()),r.isString(i)&&a.push("path="+i),r.isString(o)&&a.push("domain="+o),!0===s&&a.push("secure"),document.cookie=a.join("; ")},read:function(t){var e=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove:function(t){this.write(t,"",Date.now()-864e5)}}}():function(){return{write:function(){},read:function(){return null},remove:function(){}}}()},"7ab7":function(t,e,n){"use strict";n("2f03")},"7ac2":function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"d",(function(){return i})),n.d(e,"b",(function(){return o})),n.d(e,"c",(function(){return s}));var r=4294967295;function i(t,e,n){var r=Math.floor(n/4294967296),i=n;t.setUint32(e,r),t.setUint32(e+4,i)}function o(t,e){var n=t.getInt32(e),r=t.getUint32(e+4);return 4294967296*n+r}function s(t,e){var n=t.getUint32(e),r=t.getUint32(e+4);return 4294967296*n+r}},"7ba4":function(t,e,n){"use strict";(function(t){n.d(e,"a",(function(){return D})),n.d(e,"b",(function(){return R})),n.d(e,"c",(function(){return M})),n.d(e,"d",(function(){return C})),n.d(e,"e",(function(){return z})),n.d(e,"f",(function(){return B})),n.d(e,"g",(function(){return F})),n.d(e,"h",(function(){return S}));var r=n("9be3"),i=n("3512"),o=n("d217"),s=n("c092");const a=/^(data:|([A-Za-z]+:)?\/\/)/,u=/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp|file|data):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i,c=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g,l="file://";function h(t,e){return n=>({options:n||{},sanitize:d,load:f,fileAccess:!!e,file:p(e),http:m(t)})}async function f(t,e){const n=await this.sanitize(t,e),r=n.href;return n.localFile?this.file(r):this.http(r,e)}async function d(t,e){e=Object(r["b"])({},this.options,e);const n=this.fileAccess,i={href:null};let o,s,h;const f=u.test(t.replace(c,""));null!=t&&"string"===typeof t&&f||Object(r["a"])("Sanitize failure, invalid URI: "+Object(r["j"])(t));const d=a.test(t);return(h=e.baseURL)&&!d&&(t.startsWith("/")||h.endsWith("/")||(t="/"+t),t=h+t),s=(o=t.startsWith(l))||"file"===e.mode||"http"!==e.mode&&!d&&n,o?t=t.slice(l.length):t.startsWith("//")&&("file"===e.defaultProtocol?(t=t.slice(2),s=!0):t=(e.defaultProtocol||"http")+":"+t),Object.defineProperty(i,"localFile",{value:!!s}),i.href=t,e.target&&(i.target=e.target+""),e.rel&&(i.rel=e.rel+""),"image"===e.context&&e.crossOrigin&&(i.crossOrigin=e.crossOrigin+""),i}function p(t){return t?e=>new Promise((n,r)=>{t.readFile(e,(t,e)=>{t?r(t):n(e)})}):g}async function g(){Object(r["a"])("No file system access.")}function m(t){return t?async function(e,n){const i=Object(r["b"])({},this.options.http,n),o=n&&n.response,s=await t(e,i);return s.ok?Object(r["g"])(s[o])?s[o]():s.text():Object(r["a"])(s.status+""+s.statusText)}:y}async function y(){Object(r["a"])("No HTTP fetch method available.")}const v=t=>null!=t&&t===t,b=t=>"true"===t||"false"===t||!0===t||!1===t,_=t=>!Number.isNaN(Date.parse(t)),w=t=>!Number.isNaN(+t)&&!(t instanceof Date),x=t=>w(t)&&Number.isInteger(+t),S={boolean:r["k"],integer:r["m"],number:r["m"],date:r["l"],string:r["n"],unknown:r["e"]},E=[b,x,w,_],A=["boolean","integer","number","date"];function M(t,e){if(!t||!t.length)return"unknown";const n=t.length,r=E.length,i=E.map((t,e)=>e+1);for(let o,s,a=0,u=0;a<n;++a)for(s=e?t[a][e]:t[a],o=0;o<r;++o)if(i[o]&&v(s)&&!E[o](s)&&(i[o]=0,++u,u===E.length))return"string";return A[i.reduce((t,e)=>0===t?e:t,0)-1]}function C(t,e){return e.reduce((e,n)=>{return e[n]=M(t,n),e},{})}function k(t){const e=function(e,n){const i={delimiter:t};return O(e,n?Object(r["b"])(n,i):i)};return e.responseType="text",e}function O(t,e){return e.header&&(t=e.header.map(r["j"]).join(e.delimiter)+"\n"+t),Object(i["a"])(e.delimiter).parse(t+"")}function P(e){return!("function"!==typeof t||!Object(r["g"])(t.isBuffer))&&t.isBuffer(e)}function T(t,e){const n=e&&e.property?Object(r["c"])(e.property):r["e"];return Object(r["i"])(t)&&!P(t)?L(n(t),e):n(JSON.parse(t))}function L(t,e){return!Object(r["f"])(t)&&Object(r["h"])(t)&&(t=[...t]),e&&e.copy?JSON.parse(JSON.stringify(t)):t}O.responseType="text",T.responseType="json";const I={interior:(t,e)=>t!==e,exterior:(t,e)=>t===e};function N(t,e){let n,i,s,a;return t=T(t,e),e&&e.feature?(n=o["a"],s=e.feature):e&&e.mesh?(n=o["b"],s=e.mesh,a=I[e.filter]):Object(r["a"])("Missing TopoJSON feature or mesh parameter."),i=(i=t.objects[s])?n(t,i,a):Object(r["a"])("Invalid TopoJSON object: "+s),i&&i.features||[i]}N.responseType="json";const D={dsv:O,csv:k(","),tsv:k("\t"),json:T,topojson:N};function R(t,e){return arguments.length>1?(D[t]=e,this):Object(r["d"])(D,t)?D[t]:null}function F(t){const e=R(t);return e&&e.responseType||"text"}function B(t,e,n,i){e=e||{};const o=R(e.type||"json");return o||Object(r["a"])("Unknown data format type: "+e.type),t=o(t,e),e.parse&&j(t,e.parse,n,i),Object(r["d"])(t,"columns")&&delete t.columns,t}function j(t,e,n,r){if(!t.length)return;const i=Object(s["e"])();n=n||i.timeParse,r=r||i.utcParse;let o,a,u,c,l,h,f=t.columns||Object.keys(t[0]);"auto"===e&&(e=C(t,f)),f=Object.keys(e);const d=f.map(t=>{const i=e[t];let o,s;if(i&&(i.startsWith("date:")||i.startsWith("utc:"))){o=i.split(/:(.+)?/,2),s=o[1],("'"===s[0]&&"'"===s[s.length-1]||'"'===s[0]&&'"'===s[s.length-1])&&(s=s.slice(1,-1));const t="utc"===o[0]?r:n;return t(s)}if(!S[i])throw Error("Illegal format pattern: "+t+":"+i);return S[i]});for(u=0,l=t.length,h=f.length;u<l;++u)for(o=t[u],c=0;c<h;++c)a=f[c],o[a]=d[c](o[a])}const z=h("undefined"!==typeof fetch&&fetch,null)}).call(this,n("b639").Buffer)},"7c9d":function(t,e,n){"use strict";var r=n("4ea4");Object.defineProperty(e,"__esModule",{value:!0}),e.isMobile=a,e.default=u;var i=n("fc4d"),o=r(n("71cd")),s=r(n("f71a"));function a(){return"undefined"!==typeof i.window.orientation}function u(t){if(!t&&!(0,o.default)())return"Node";if((0,s.default)(t))return"Electron";var e="undefined"!==typeof navigator?navigator:{},n=t||e.userAgent||"";if(n.indexOf("Edge")>-1)return"Edge";var r=-1!==n.indexOf("MSIE "),a=-1!==n.indexOf("Trident/");return r||a?"IE":i.window.chrome?"Chrome":i.window.safari?"Safari":i.window.mozInnerScreenX?"Firefox":"Unknown"}},"7db0":function(t,e,n){"use strict";var r=n("23e7"),i=n("b727").find,o=n("44d2"),s="find",a=!0;s in[]&&Array(1)[s]((function(){a=!1})),r({target:"Array",proto:!0,forced:a},{find:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}}),o(s)},"7e18":function(t,e,n){},"7f26":function(t,e,n){"use strict";(function(t,r){n.d(e,"a",(function(){return o}));const i={self:"undefined"!==typeof self&&self,window:"undefined"!==typeof window&&window,global:"undefined"!==typeof t&&t,document:"undefined"!==typeof document&&document,process:"object"===typeof r&&r},o=(i.self||i.window||i.global,i.window||i.self||i.global);i.global||i.self||i.window,i.document,i.process,console}).call(this,n("c8ba"),n("4362"))},8:function(t,e){},8007:function(t,e,n){"use strict";(function(t){var r=n("4ea4");Object.defineProperty(e,"__esModule",{value:!0}),e.default=s,e.isBrowserMainThread=a;var i=r(n("7037")),o=r(n("9d38"));function s(){var e="object"===("undefined"===typeof t?"undefined":(0,i.default)(t))&&"[object process]"===String(t)&&!t.browser;return!e||(0,o.default)()}function a(){return s()&&"undefined"!==typeof document}}).call(this,n("4362"))},"812b":function(t,e,n){"use strict";n("3a1f")},8145:function(t,e,n){"use strict";n("0280")},8177:function(t,e,n){"use strict";n.d(e,"c",(function(){return u})),n.d(e,"a",(function(){return c})),n.d(e,"b",(function(){return l})),n.d(e,"d",(function(){return h}));var r=n("ae9d"),i=n("f50d"),o=n("5729"),s=n("a093"),a=n("dd22");function u(t,e){if(Object(o["a"])(Object(s["d"])(t),"setParameters requires a WebGL context"),Object(a["b"])(e))return;const n={};for(const o in e){const i=Number(o),s=r["e"][o];s&&("string"===typeof s?n[s]=!0:s(t,e[o],i))}const i=t.state&&t.state.cache;if(i)for(const o in n){const n=r["a"][o];n(t,e,i)}}function c(t,e){if(e=e||r["c"],"number"===typeof e){const n=e,i=r["d"][n];return i?i(t,n):t.getParameter(n)}const n=Array.isArray(e)?e:Object.keys(e),i={};for(const o of n){const e=r["d"][o];i[o]=e?e(t,Number(o)):t.getParameter(Number(o))}return i}function l(t){u(t,r["c"])}function h(t,e,n){if(Object(a["b"])(e))return n(t);const{nocatch:r=!0}=e;let o;if(Object(i["b"])(t),u(t,e),r)o=n(t),Object(i["a"])(t);else try{o=n(t)}finally{Object(i["a"])(t)}return o}},"826a":function(t,e,n){"use strict";n.r(e);var r=n("41b5");n.d(e,"build",(function(){return r["a"]}));var i=n("c194");n.d(e,"FieldNames",(function(){return i["b"]})),n.d(e,"ScaleNames",(function(){return i["d"]})),n.d(e,"SignalNames",(function(){return i["e"]})),n.d(e,"Other",(function(){return i["c"]})),n.d(e,"ColorScaleNone",(function(){return i["a"]}));var o=n("8645");n.d(e,"getColumnsFromData",(function(){return o["a"]})),n.d(e,"getSpecColumns",(function(){return o["b"]})),n.d(e,"inferAll",(function(){return o["d"]})),n.d(e,"getStats",(function(){return o["c"]}));var s=n("af32");for(var a in s)["build","FieldNames","ScaleNames","SignalNames","Other","ColorScaleNone","getColumnsFromData","getSpecColumns","inferAll","getStats","default"].indexOf(a)<0&&function(t){n.d(e,t,(function(){return s[t]}))}(a);var u=n("e932");for(var a in u)["build","FieldNames","ScaleNames","SignalNames","Other","ColorScaleNone","getColumnsFromData","getSpecColumns","inferAll","getStats","default"].indexOf(a)<0&&function(t){n.d(e,t,(function(){return u[t]}))}(a)},8329:function(t,e,n){"use strict";var r=n("4ea4"),i=n("7037");Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"self",{enumerable:!0,get:function(){return o.self}}),Object.defineProperty(e,"window",{enumerable:!0,get:function(){return o.window}}),Object.defineProperty(e,"global",{enumerable:!0,get:function(){return o.global}}),Object.defineProperty(e,"document",{enumerable:!0,get:function(){return o.document}}),Object.defineProperty(e,"process",{enumerable:!0,get:function(){return o.process}}),Object.defineProperty(e,"console",{enumerable:!0,get:function(){return o.console}}),Object.defineProperty(e,"isBrowser",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(e,"isBrowserMainThread",{enumerable:!0,get:function(){return s.isBrowserMainThread}}),Object.defineProperty(e,"getBrowser",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(e,"isMobile",{enumerable:!0,get:function(){return a.isMobile}}),Object.defineProperty(e,"isElectron",{enumerable:!0,get:function(){return u.default}});var o=n("fc4d"),s=l(n("71cd")),a=l(n("7c9d")),u=r(n("f71a"));function c(t){if("function"!==typeof WeakMap)return null;var e=new WeakMap,n=new WeakMap;return(c=function(t){return t?n:e})(t)}function l(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!==i(t)&&"function"!==typeof t)return{default:t};var n=c(e);if(n&&n.has(t))return n.get(t);var r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in t)if("default"!==s&&Object.prototype.hasOwnProperty.call(t,s)){var a=o?Object.getOwnPropertyDescriptor(t,s):null;a&&(a.get||a.set)?Object.defineProperty(r,s,a):r[s]=t[s]}return r.default=t,n&&n.set(t,r),r}},"83b9":function(t,e,n){"use strict";var r=n("d925"),i=n("e683");t.exports=function(t,e){return t&&!r(e)?i(t,e):e}},"848b":function(t,e,n){"use strict";var r=n("5cce").version,i={};["object","boolean","number","function","string","symbol"].forEach((function(t,e){i[t]=function(n){return typeof n===t||"a"+(e<1?"n ":" ")+t}}));var o={};function s(t,e,n){if("object"!==typeof t)throw new TypeError("options must be an object");var r=Object.keys(t),i=r.length;while(i-- >0){var o=r[i],s=e[o];if(s){var a=t[o],u=void 0===a||s(a,o,t);if(!0!==u)throw new TypeError("option "+o+" must be "+u)}else if(!0!==n)throw Error("Unknown option "+o)}}i.transitional=function(t,e,n){function i(t,e){return"[Axios v"+r+"] Transitional option '"+t+"'"+e+(n?". "+n:"")}return function(n,r,s){if(!1===t)throw new Error(i(r," has been removed"+(e?" in "+e:"")));return e&&!o[r]&&(o[r]=!0,console.warn(i(r," has been deprecated since v"+e+" and will be removed in the near future"))),!t||t(n,r,s)}},t.exports={assertOptions:s,validators:i}},8645:function(t,e,n){"use strict";n.d(e,"a",(function(){return s})),n.d(e,"b",(function(){return a})),n.d(e,"d",(function(){return u})),n.d(e,"c",(function(){return l}));var r=n("166a");function i(t){return!!Object(r["e"])(t)}function o(t){return"number"===t.type||"integer"===t.type}function s(t,e,n){const r=e[0],i=r?Object.keys(r):[],o=Object.assign(Object.assign({},t(e,i)),n),s=i.map(t=>{const e={name:t,type:o[t]};return e});return u(s,e),s}function a(t,e){function n(t){return e.filter(e=>e.name===t)[0]}return{color:n(t.columns&&t.columns.color),facet:n(t.columns&&t.columns.facet),facetV:n(t.columns&&t.columns.facetV),group:n(t.columns&&t.columns.group),size:n(t.columns&&t.columns.size),sort:n(t.columns&&t.columns.sort),uid:n(t.columns&&t.columns.uid),x:n(t.columns&&t.columns.x),y:n(t.columns&&t.columns.y),z:n(t.columns&&t.columns.z)}}function u(t,e){t.forEach(t=>{t&&("boolean"!==typeof t.quantitative&&(t.quantitative=o(t)),t.stats||(t.stats=l(e,t)),"string"===t.type&&"boolean"!==typeof t.isColorData&&c(e,t))})}function c(t,e){if(e.stats.hasColorData){for(let n=0;n<t.length;n++)if(!i(t[n][e.name]))return void(e.isColorData=!1);e.isColorData=!0}else e.isColorData=!1}function l(t,e){const n={},r={distinctValueCount:null,max:null,mean:null,min:null};let o=0;for(let s=0;s<t.length;s++){let a=t[s],u=a[e.name];n[u]=!0,(null===r.max||u>r.max)&&(r.max=u),(null===r.min||u<r.min)&&(r.min=u);let c=+u;isNaN(c)||(o+=c),"string"===e.type&&!r.hasColorData&&i(u)&&(r.hasColorData=!0)}return e.quantitative&&(r.mean=t.length>0&&o/t.length,r.hasNegative=h(e,t),"integer"===e.type&&(r.isSequential=f(e,t))),r.distinctValueCount=Object.keys(n).length,r}function h(t,e){for(let n=1;n<e.length;n++)if(e[n][t.name]<0)return!0;return!1}function f(t,e){if(e.length<2)return!1;let n=t.name;for(let r=1;r<e.length;r++)if(e[r][n]!==e[r-1][n]+1)return!1;return!0}},8996:function(t,e){(function(){var t={animate:!1,reset:!0,disableViewprereset:!0};L.Sync=function(){},L.Sync.offsetHelper=function(t,e){var n=L.Util.isArray(t)?t:[.5,.5],r=L.Util.isArray(e)?e:[.5,.5];return function(t,e,i,o){var s=i.getSize(),a=o.getSize(),u=i.project(t,e).subtract([(.5-n[0])*s.x,(.5-n[1])*s.y]).add([(.5-r[0])*a.x,(.5-r[1])*a.y]);return i.unproject(u,e)}},L.Map.include({sync:function(e,n){return this._initSync(),n=L.extend({noInitialSync:!1,syncCursor:!1,syncCursorMarkerOptions:{radius:10,fillOpacity:.3,color:"#da291c",fillColor:"#fff"},offsetFn:function(t,e,n,r){return t}},n),-1===this._syncMaps.indexOf(e)&&(this._syncMaps.push(e),this._syncOffsetFns[L.Util.stamp(e)]=n.offsetFn),n.noInitialSync||e.setView(n.offsetFn(this.getCenter(),this.getZoom(),this,e),this.getZoom(),t),n.syncCursor&&("undefined"===typeof e.cursor&&(e.cursor=L.circleMarker([0,0],n.syncCursorMarkerOptions).addTo(e)),this._cursors.push(e.cursor),this.on("mousemove",this._cursorSyncMove,this),this.on("mouseout",this._cursorSyncOut,this)),this.on("resize zoomend",this._selfSetView),this.on("moveend",this._syncOnMoveend),this.on("dragend",this._syncOnDragend),this},unsync:function(t){var e=this;return this._cursors&&this._cursors.forEach((function(e,n,r){e===t.cursor&&r.splice(n,1)})),t.cursor&&t.cursor.setLatLng([0,0]),this._syncMaps&&this._syncMaps.forEach((function(n,r){t===n&&(delete e._syncOffsetFns[L.Util.stamp(t)],e._syncMaps.splice(r,1))})),this._syncMaps&&0!=this._syncMaps.length||(this.off("resize zoomend",this._selfSetView),this.off("moveend",this._syncOnMoveend),this.off("dragend",this._syncOnDragend)),this},isSynced:function(t){var e=this.hasOwnProperty("_syncMaps")&&Object.keys(this._syncMaps).length>0;return e&&t&&(e=!1,this._syncMaps.forEach((function(n){t==n&&(e=!0)}))),e},_cursorSyncMove:function(t){this._cursors.forEach((function(e){e.setLatLng(t.latlng)}))},_cursorSyncOut:function(t){this._cursors.forEach((function(t){t.setLatLng([0,0])}))},_selfSetView:function(e){this.setView(this.getCenter(),this.getZoom(),t)},_syncOnMoveend:function(t){this._syncDragend&&(this._syncDragend=!1,this._selfSetView(t),this._syncMaps.forEach((function(t){t.fire("moveend")})))},_syncOnDragend:function(t){this._syncDragend=!0},_initSync:function(){if(!this._syncMaps){var t=this;this._syncMaps=[],this._cursors=[],this._syncOffsetFns={},L.extend(t,{setView:function(e,n,r,i){function o(t,e){var n=[],i=r&&r.disableViewprereset&&t&&t._events;i&&(n=t._events.viewprereset,t._events.viewprereset=[]);var o=e(t);return i&&(t._events.viewprereset=n),o}var s=o(this,(function(t){return L.Map.prototype.setView.call(t,e,n,r)}));return i||t._syncMaps.forEach((function(i){o(i,(function(o){return i.setView(t._syncOffsetFns[L.Util.stamp(i)](e,n,t,i),n,r,!0)}))})),s},panBy:function(e,n,r){return r||t._syncMaps.forEach((function(t){t.panBy(e,n,!0)})),L.Map.prototype.panBy.call(this,e,n)},_onResize:function(e,n){return n||t._syncMaps.forEach((function(t){t._onResize(e,!0)})),L.Map.prototype._onResize.call(this,e)},_stop:function(e){L.Map.prototype._stop.call(this),e||t._syncMaps.forEach((function(t){t._stop(!0)}))}}),t.dragging._draggable._updatePosition=function(){L.Draggable.prototype._updatePosition.call(this);var e=this;t._syncMaps.forEach((function(n){L.DomUtil.setPosition(n.dragging._draggable._element,e._newPos),n.eachLayer((function(e){if(void 0!==e._google){var r=t._syncOffsetFns[L.Util.stamp(n)],i=r(t.getCenter(),t.getZoom(),t,n);e._google.setCenter(i)}})),n.fire("move")}))}}}})})()},"8a44":function(t,e,n){var r=n("dcc9"),i=n("109a"),o=n("234e"),s=n("1f31"),a=n("7746"),u=n("e68e"),c=n("e5f3");c.alea=r,c.xor128=i,c.xorwow=o,c.xorshift7=s,c.xor4096=a,c.tychei=u,t.exports=c},"8b17":function(t,e){function n(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}t.exports=n,t.exports["default"]=t.exports,t.exports.__esModule=!0},"8c87":function(t,e,n){},"8df4":function(t,e,n){"use strict";var r=n("7a77");function i(t){if("function"!==typeof t)throw new TypeError("executor must be a function.");var e;this.promise=new Promise((function(t){e=t}));var n=this;this.promise.then((function(t){if(n._listeners){var e,r=n._listeners.length;for(e=0;e<r;e++)n._listeners[e](t);n._listeners=null}})),this.promise.then=function(t){var e,r=new Promise((function(t){n.subscribe(t),e=t})).then(t);return r.cancel=function(){n.unsubscribe(e)},r},t((function(t){n.reason||(n.reason=new r(t),e(n.reason))}))}i.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},i.prototype.subscribe=function(t){this.reason?t(this.reason):this._listeners?this._listeners.push(t):this._listeners=[t]},i.prototype.unsubscribe=function(t){if(this._listeners){var e=this._listeners.indexOf(t);-1!==e&&this._listeners.splice(e,1)}},i.source=function(){var t,e=new i((function(e){t=e}));return{token:e,cancel:t}},t.exports=i},9401:function(t,e,n){"use strict";(function(t){var r=n("4ea4");Object.defineProperty(e,"__esModule",{value:!0}),e.default=s,e.isBrowserMainThread=a;var i=r(n("7037")),o=r(n("095a"));function s(){var e="object"===("undefined"===typeof t?"undefined":(0,i.default)(t))&&"[object process]"===String(t)&&!t.browser;return!e||(0,o.default)()}function a(){return s()&&"undefined"!==typeof document}}).call(this,n("4362"))},9603:function(t,e,n){"use strict";var r=n("18e2"),i=Object(r["a"])((function(t){t.setDate(1),t.setHours(0,0,0,0)}),(function(t,e){t.setMonth(t.getMonth()+e)}),(function(t,e){return e.getMonth()-t.getMonth()+12*(e.getFullYear()-t.getFullYear())}),(function(t){return t.getMonth()}));e["a"]=i;i.range},9891:function(t,e,n){"use strict";(function(t){var r=n("d01e6");n.d(e,"a",(function(){return r}));var i=n("2b0e"),o=s;function s(t,e){return t===e||(t!==t&&e!==e||{}.toString.call(t)=={}.toString.call(e)&&(t===Object(t)&&(!!t&&(Array.isArray(t)?u(t,e):"[object Object]"=={}.toString.call(t)?c(t,e):a(t,e)))))}function a(t,e){return t.toString()===e.toString()}function u(t,e){var n=t.length;if(n!=e.length)return!1;for(var r=!0,i=0;i<n;i++)if(!s(t[i],e[i])){r=!1;break}return r}function c(t,e){var n=Object.keys(t).sort(),r=Object.keys(e).sort(),i=n.length;if(i!=r.length)return!1;for(var o=0;o<i;o++){var a=n[o],u=r[o];if(a!=u||!s(t[a],e[u]))return!1}return!0}var l=Object.freeze(Object.assign({__proto__:null,default:o,__moduleExports:o},o)),h=o||l;function f(t,e){void 0===e&&(e={});var n=e.insertAt;if(t&&"undefined"!==typeof document){var r=document.head||document.getElementsByTagName("head")[0],i=document.createElement("style");i.type="text/css","top"===n&&r.firstChild?r.insertBefore(i,r.firstChild):r.appendChild(i),i.styleSheet?i.styleSheet.cssText=t:i.appendChild(document.createTextNode(t))}}var d=".sanddance-root {\n  height: 100%;\n  position: relative;\n  width: 100%; }\n\n.sanddance-gl {\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0; }\n  .sanddance-gl.show-center {\n    background: linear-gradient(to right, transparent 49.9%, rgba(255, 0, 0, 0.7), transparent 50.1%), linear-gradient(to bottom, transparent 49.9%, rgba(255, 0, 0, 0.7), transparent 50.1%); }\n\n.sanddance-panel {\n  position: absolute;\n  top: 1em;\n  right: 1em;\n  bottom: 1em;\n  background: #fff;\n  box-shadow: 8px 8px 12px -6px #ccc;\n  border: 1px solid #ccc;\n  overflow-y: scroll;\n  padding-bottom: 1em;\n  padding-left: 1em; }\n\n.sanddance-legend table {\n  border-collapse: collapse; }\n\n.sanddance-legend th {\n  word-break: break-word;\n  max-width: 11em; }\n\n.sanddance-legend .legend-row {\n  cursor: pointer; }\n  .sanddance-legend .legend-row td {\n    padding: 2px; }\n  .sanddance-legend .legend-row:hover {\n    background-color: #efefef; }\n\n.sanddance-legend .symbol div {\n  border-style: outset;\n  border-width: 1.5px; }\n\n.sanddance-legend .label {\n  max-width: 9em;\n  white-space: nowrap;\n  text-overflow: ellipsis;\n  overflow: hidden; }\n\n.sanddance-details {\n  font-size: smaller; }\n\n.sanddance-details-scroll {\n  padding-bottom: 1em; }\n\n.sanddance-tooltip {\n  z-index: 1; }\n  .sanddance-tooltip table {\n    background: #333;\n    color: #fff;\n    font-size: smaller;\n    margin: 1em;\n    min-width: 16em;\n    padding: 6px;\n    position: absolute; }\n  .sanddance-tooltip td {\n    text-align: left;\n    vertical-align: top;\n    width: 75%; }\n    .sanddance-tooltip td:first-child {\n      width: 25%; }\n";function p(t,e){var n=Object.assign(Object.assign({view:null,filter:null},t),{signalValues:e});return n}f(d);var g=i["default"].extend({name:"SandDanceVue",props:{viewerOptions:Object,insight:{type:Object,required:!0},data:{type:Array,required:!0},renderOptions:Object},data:function(){return{viewer:void 0,lastData:[]}},computed:{needsLayout:function(){return this.insight&&this.data&&!this.areLayoutPropsSame},areLayoutPropsSame:function(){var t=this.viewer.getInsight(),e=p(t,Object.assign(Object.assign({},this.viewer.insight.signalValues),t.signalValues)),n=p(this.insight,Object.assign(Object.assign({},e.signalValues),this.insight.signalValues)),r=h(e,n);return r&&this.data===this.lastData}},methods:{layout:function(){var t=this;this.lastData=this.data,this.viewer.render(this.insight,this.data,this.renderOptions).then((function(e){t.$emit("view",e)})).catch((function(e){t.$emit("error",e)}))},view:function(){this.needsLayout&&this.layout()}},mounted:function(){this.viewer=new r["Viewer"](this.$refs.viewerDiv,this.viewerOptions),this.$emit("mounted",this.viewer.presenter.getElement(r["VegaDeckGl"].PresenterElement.gl)),this.view()},updated:function(){this.viewer.options=r["VegaDeckGl"].util.deepMerge(this.viewer.options,this.viewerOptions),this.view()},beforeDestroy:function(){this.viewer.finalize()}});function m(t,e,n,r,i,o,s,a,u,c){"boolean"!==typeof s&&(u=a,a=s,s=!1);var l,h="function"===typeof n?n.options:n;if(t&&t.render&&(h.render=t.render,h.staticRenderFns=t.staticRenderFns,h._compiled=!0,i&&(h.functional=!0)),r&&(h._scopeId=r),o?(l=function(t){t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,t||"undefined"===typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),e&&e.call(this,u(t)),t&&t._registeredComponents&&t._registeredComponents.add(o)},h._ssrRegister=l):e&&(l=s?function(t){e.call(this,c(t,this.$root.$options.shadowRoot))}:function(t){e.call(this,a(t))}),l)if(h.functional){var f=h.render;h.render=function(t,e){return l.call(e),f(t,e)}}else{var d=h.beforeCreate;h.beforeCreate=d?[].concat(d,l):[l]}return n}var y=g,v=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{ref:"viewerDiv",staticClass:"sanddance-VueViewer"})},b=[];v._withStripped=!0;var _=void 0,w=void 0,x=void 0,S=!1,E=m({render:v,staticRenderFns:b},_,y,w,S,x,!1,void 0,void 0,void 0);function A(t){A.installed||(A.installed=!0,t.component("SandDanceVue",E))}var M={install:A},C=null;"undefined"!==typeof window?C=window.Vue:"undefined"!==typeof t&&(C=t.Vue),C&&C.use(M)}).call(this,n("c8ba"))},9911:function(t,e,n){"use strict";var r=n("23e7"),i=n("857a"),o=n("af03");r({target:"String",proto:!0,forced:o("link")},{link:function(t){return i(this,"a","href",t)}})},"9bdd":function(t,e,n){var r=n("825a"),i=n("2a62");t.exports=function(t,e,n,o){try{return o?e(r(n)[0],n[1]):e(n)}catch(s){i(t,"throw",s)}}},"9be3":function(t,e,n){"use strict";function r(t,e,n){return t.fields=e||[],t.fname=n,t}function i(t){return 1===t.length?o(t[0]):s(t)}n.d(e,"a",(function(){return a})),n.d(e,"b",(function(){return g})),n.d(e,"c",(function(){return c})),n.d(e,"d",(function(){return y})),n.d(e,"e",(function(){return l})),n.d(e,"f",(function(){return h})),n.d(e,"g",(function(){return p})),n.d(e,"h",(function(){return b})),n.d(e,"i",(function(){return f})),n.d(e,"j",(function(){return x})),n.d(e,"k",(function(){return S})),n.d(e,"l",(function(){return A})),n.d(e,"m",(function(){return d})),n.d(e,"n",(function(){return M}));const o=t=>(function(e){return e[t]}),s=t=>{const e=t.length;return function(n){for(let r=0;r<e;++r)n=n[t[r]];return n}};function a(t){throw Error(t)}function u(t){const e=[],n=t.length;let r,i,o,s=null,u=0,c="";function l(){e.push(c+t.substring(r,i)),c="",r=i+1}for(t+="",r=i=0;i<n;++i)if(o=t[i],"\\"===o)c+=t.substring(r,i),c+=t.substring(++i,++i),r=i;else if(o===s)l(),s=null,u=-1;else{if(s)continue;r===u&&'"'===o?(r=i+1,s=o):r===u&&"'"===o?(r=i+1,s=o):"."!==o||u?"["===o?(i>r&&l(),u=r=i+1):"]"===o&&(u||a("Access path missing open bracket: "+t),u>0&&l(),u=0,r=i+1):i>r?l():r=i+1}return u&&a("Access path missing closing bracket: "+t),s&&a("Access path missing closing quote: "+t),i>r&&(i++,l()),e}function c(t,e,n){const o=u(t);return t=1===o.length?o[0]:t,r((n&&n.get||i)(o),[t],e||t)}c("id");const l=r(t=>t,[],"identity");r(()=>0,[],"zero"),r(()=>1,[],"one"),r(()=>!0,[],"true"),r(()=>!1,[],"false");var h=Array.isArray;function f(t){return t===Object(t)}function d(t){return null==t||""===t?null:+t}function p(t){return"function"===typeof t}function g(t){for(let e,n,r=1,i=arguments.length;r<i;++r)for(n in e=arguments[r],e)t[n]=e[n];return t}const m=Object.prototype.hasOwnProperty;function y(t,e){return m.call(t,e)}function v(t){return"[object Date]"===Object.prototype.toString.call(t)}function b(t){return t&&p(t[Symbol.iterator])}function _(t){return"number"===typeof t}function w(t){return"string"===typeof t}function x(t){return h(t)?"["+t.map(x)+"]":f(t)||w(t)?JSON.stringify(t).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):t}function S(t){return null==t||""===t?null:!(!t||"false"===t||"0"===t)&&!!t}const E=t=>_(t)?t:v(t)?t:Date.parse(t);function A(t,e){return e=e||E,null==t||""===t?null:e(t)}function M(t){return null==t||""===t?null:t+""}},"9bef":function(t,e,n){"use strict";(function(t,r){var i=n("4ea4");Object.defineProperty(e,"__esModule",{value:!0}),e.console=e.process=e.document=e.global=e.window=e.self=void 0;var o=i(n("7037")),s={self:"undefined"!==typeof self&&self,window:"undefined"!==typeof window&&window,global:"undefined"!==typeof t&&t,document:"undefined"!==typeof document&&document,process:"object"===("undefined"===typeof r?"undefined":(0,o.default)(r))&&r},a=s.self||s.window||s.global;e.self=a;var u=s.window||s.self||s.global;e.window=u;var c=s.global||s.self||s.window;e.global=c;var l=s.document||{};e.document=l;var h=s.process||{};e.process=h;var f=console;e.console=f}).call(this,n("c8ba"),n("4362"))},"9d38":function(t,e,n){"use strict";(function(t){var r=n("4ea4");Object.defineProperty(e,"__esModule",{value:!0}),e.default=o;var i=r(n("7037"));function o(e){if("undefined"!==typeof window&&"object"===(0,i.default)(window.process)&&"renderer"===window.process.type)return!0;if("undefined"!==typeof t&&"object"===(0,i.default)(t.versions)&&Boolean(t.versions.electron))return!0;var n="object"===("undefined"===typeof navigator?"undefined":(0,i.default)(navigator))&&"string"===typeof navigator.userAgent&&navigator.userAgent,r=e||n;return!!(r&&r.indexOf("Electron")>=0)}}).call(this,n("4362"))},a070:function(t,e,n){"use strict";(function(t){function r(e){if("undefined"!==typeof window&&"object"===typeof window.process&&"renderer"===window.process.type)return!0;if("undefined"!==typeof t&&"object"===typeof t.versions&&Boolean(t.versions.electron))return!0;const n="object"===typeof navigator&&"string"===typeof navigator.userAgent&&navigator.userAgent,r=e||n;return!!(r&&r.indexOf("Electron")>=0)}n.d(e,"a",(function(){return r}))}).call(this,n("4362"))},a093:function(t,e,n){"use strict";n.d(e,"d",(function(){return s})),n.d(e,"e",(function(){return a})),n.d(e,"c",(function(){return u})),n.d(e,"b",(function(){return c})),n.d(e,"a",(function(){return l}));var r=n("5729");const i="Invalid WebGLRenderingContext",o="Requires WebGL2";function s(t){return"undefined"!==typeof WebGLRenderingContext&&t instanceof WebGLRenderingContext||("undefined"!==typeof WebGL2RenderingContext&&t instanceof WebGL2RenderingContext||Boolean(t&&Number.isFinite(t._version)))}function a(t){return"undefined"!==typeof WebGL2RenderingContext&&t instanceof WebGL2RenderingContext||Boolean(t&&2===t._version)}function u(t){return a(t)?t:null}function c(t){return Object(r["a"])(s(t),i),t}function l(t){return Object(r["a"])(a(t),o),t}},a15a3:function(t,e,n){"use strict";var r=n("18e2"),i=Object(r["a"])((function(t){t.setMonth(0,1),t.setHours(0,0,0,0)}),(function(t,e){t.setFullYear(t.getFullYear()+e)}),(function(t,e){return e.getFullYear()-t.getFullYear()}),(function(t){return t.getFullYear()}));i.every=function(t){return isFinite(t=Math.floor(t))&&t>0?Object(r["a"])((function(e){e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)}),(function(e,n){e.setFullYear(e.getFullYear()+n*t)})):null},e["a"]=i;i.range},a16a:function(t,e,n){"use strict";(function(t,r){n.d(e,"b",(function(){return o})),n.d(e,"a",(function(){return s}));const i={self:"undefined"!==typeof self&&self,window:"undefined"!==typeof window&&window,global:"undefined"!==typeof t&&t,document:"undefined"!==typeof document&&document,process:"object"===typeof r&&r},o=(i.self||i.window||i.global,i.window||i.self||i.global),s=(i.global||i.self||i.window,i.document,i.process||{});console}).call(this,n("c8ba"),n("4362"))},a303:function(t,e,n){"use strict";n("e041")},a4c0:function(t){t.exports=JSON.parse('["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","math","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rb","rp","rt","rtc","ruby","s","samp","script","section","select","slot","small","source","span","strong","style","sub","summary","sup","svg","table","tbody","td","template","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr"]')},a591:function(t,e,n){"use strict";n.d(e,"a",(function(){return f}));var r=n("2739"),i=n("6eb2"),o=n("b14c"),s=n("742c"),a=n("a15a3"),u=n("77ae4");function c(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function l(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function h(t,e,n){return{y:t,m:e,d:n,H:0,M:0,S:0,L:0}}function f(t){var e=t.dateTime,n=t.date,a=t.time,u=t.periods,f=t.days,p=t.shortDays,g=t.months,m=t.shortMonths,y=b(u),v=_(u),J=b(f),vt=_(f),Pt=b(p),Tt=_(p),Lt=b(g),It=_(g),Nt=b(m),Dt=_(m),Rt={a:Zt,A:Kt,b:Jt,B:Qt,c:null,d:U,e:U,f:G,g:rt,G:ot,H:$,I:V,j:q,L:W,m:H,M:X,p:te,q:ee,Q:kt,s:Ot,S:Y,u:Z,U:K,V:Q,w:tt,W:et,x:null,X:null,y:nt,Y:it,Z:st,"%":Ct},Ft={a:ne,A:re,b:ie,B:oe,c:null,d:at,e:at,f:ft,g:St,G:At,H:ut,I:ct,j:lt,L:ht,m:dt,M:pt,p:se,q:ae,Q:kt,s:Ot,S:gt,u:mt,U:yt,V:bt,w:_t,W:wt,x:null,X:null,y:xt,Y:Et,Z:Mt,"%":Ct},Bt={a:Vt,A:qt,b:Wt,B:Gt,c:Ht,d:T,e:T,f:F,g:C,G:M,H:I,I:I,j:L,L:R,m:P,M:N,p:$t,q:O,Q:j,s:z,S:D,u:x,U:S,V:E,w:w,W:A,x:Xt,X:Yt,y:C,Y:M,Z:k,"%":B};function jt(t,e){return function(n){var r,i,o,s=[],a=-1,u=0,c=t.length;n instanceof Date||(n=new Date(+n));while(++a<c)37===t.charCodeAt(a)&&(s.push(t.slice(u,a)),null!=(i=d[r=t.charAt(++a)])?r=t.charAt(++a):i="e"===r?" ":"0",(o=e[r])&&(r=o(n,i)),s.push(r),u=a+1);return s.push(t.slice(u,a)),s.join("")}}function zt(t,e){return function(n){var a,u,f=h(1900,void 0,1),d=Ut(f,t,n+="",0);if(d!=n.length)return null;if("Q"in f)return new Date(f.Q);if("s"in f)return new Date(1e3*f.s+("L"in f?f.L:0));if(!e||"Z"in f||(f.Z=0),"p"in f&&(f.H=f.H%12+12*f.p),void 0===f.m&&(f.m="q"in f?f.q:0),"V"in f){if(f.V<1||f.V>53)return null;"w"in f||(f.w=1),"Z"in f?(a=l(h(f.y,0,1)),u=a.getUTCDay(),a=u>4||0===u?r["a"].ceil(a):Object(r["a"])(a),a=i["a"].offset(a,7*(f.V-1)),f.y=a.getUTCFullYear(),f.m=a.getUTCMonth(),f.d=a.getUTCDate()+(f.w+6)%7):(a=c(h(f.y,0,1)),u=a.getDay(),a=u>4||0===u?o["a"].ceil(a):Object(o["a"])(a),a=s["a"].offset(a,7*(f.V-1)),f.y=a.getFullYear(),f.m=a.getMonth(),f.d=a.getDate()+(f.w+6)%7)}else("W"in f||"U"in f)&&("w"in f||(f.w="u"in f?f.u%7:"W"in f?1:0),u="Z"in f?l(h(f.y,0,1)).getUTCDay():c(h(f.y,0,1)).getDay(),f.m=0,f.d="W"in f?(f.w+6)%7+7*f.W-(u+5)%7:f.w+7*f.U-(u+6)%7);return"Z"in f?(f.H+=f.Z/100|0,f.M+=f.Z%100,l(f)):c(f)}}function Ut(t,e,n,r){var i,o,s=0,a=e.length,u=n.length;while(s<a){if(r>=u)return-1;if(i=e.charCodeAt(s++),37===i){if(i=e.charAt(s++),o=Bt[i in d?e.charAt(s++):i],!o||(r=o(t,n,r))<0)return-1}else if(i!=n.charCodeAt(r++))return-1}return r}function $t(t,e,n){var r=y.exec(e.slice(n));return r?(t.p=v.get(r[0].toLowerCase()),n+r[0].length):-1}function Vt(t,e,n){var r=Pt.exec(e.slice(n));return r?(t.w=Tt.get(r[0].toLowerCase()),n+r[0].length):-1}function qt(t,e,n){var r=J.exec(e.slice(n));return r?(t.w=vt.get(r[0].toLowerCase()),n+r[0].length):-1}function Wt(t,e,n){var r=Nt.exec(e.slice(n));return r?(t.m=Dt.get(r[0].toLowerCase()),n+r[0].length):-1}function Gt(t,e,n){var r=Lt.exec(e.slice(n));return r?(t.m=It.get(r[0].toLowerCase()),n+r[0].length):-1}function Ht(t,n,r){return Ut(t,e,n,r)}function Xt(t,e,r){return Ut(t,n,e,r)}function Yt(t,e,n){return Ut(t,a,e,n)}function Zt(t){return p[t.getDay()]}function Kt(t){return f[t.getDay()]}function Jt(t){return m[t.getMonth()]}function Qt(t){return g[t.getMonth()]}function te(t){return u[+(t.getHours()>=12)]}function ee(t){return 1+~~(t.getMonth()/3)}function ne(t){return p[t.getUTCDay()]}function re(t){return f[t.getUTCDay()]}function ie(t){return m[t.getUTCMonth()]}function oe(t){return g[t.getUTCMonth()]}function se(t){return u[+(t.getUTCHours()>=12)]}function ae(t){return 1+~~(t.getUTCMonth()/3)}return(Rt.x=jt(n,Rt),Rt.X=jt(a,Rt),Rt.c=jt(e,Rt),Ft.x=jt(n,Ft),Ft.X=jt(a,Ft),Ft.c=jt(e,Ft),{format:function(t){var e=jt(t+="",Rt);return e.toString=function(){return t},e},parse:function(t){var e=zt(t+="",!1);return e.toString=function(){return t},e},utcFormat:function(t){var e=jt(t+="",Ft);return e.toString=function(){return t},e},utcParse:function(t){var e=zt(t+="",!0);return e.toString=function(){return t},e}})}var d={"-":"",_:" ",0:"0"},p=/^\s*\d+/,g=/^%/,m=/[\\^$*+?|[\]().{}]/g;function y(t,e,n){var r=t<0?"-":"",i=(r?-t:t)+"",o=i.length;return r+(o<n?new Array(n-o+1).join(e)+i:i)}function v(t){return t.replace(m,"\\$&")}function b(t){return new RegExp("^(?:"+t.map(v).join("|")+")","i")}function _(t){return new Map(t.map((t,e)=>[t.toLowerCase(),e]))}function w(t,e,n){var r=p.exec(e.slice(n,n+1));return r?(t.w=+r[0],n+r[0].length):-1}function x(t,e,n){var r=p.exec(e.slice(n,n+1));return r?(t.u=+r[0],n+r[0].length):-1}function S(t,e,n){var r=p.exec(e.slice(n,n+2));return r?(t.U=+r[0],n+r[0].length):-1}function E(t,e,n){var r=p.exec(e.slice(n,n+2));return r?(t.V=+r[0],n+r[0].length):-1}function A(t,e,n){var r=p.exec(e.slice(n,n+2));return r?(t.W=+r[0],n+r[0].length):-1}function M(t,e,n){var r=p.exec(e.slice(n,n+4));return r?(t.y=+r[0],n+r[0].length):-1}function C(t,e,n){var r=p.exec(e.slice(n,n+2));return r?(t.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function k(t,e,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(n,n+6));return r?(t.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function O(t,e,n){var r=p.exec(e.slice(n,n+1));return r?(t.q=3*r[0]-3,n+r[0].length):-1}function P(t,e,n){var r=p.exec(e.slice(n,n+2));return r?(t.m=r[0]-1,n+r[0].length):-1}function T(t,e,n){var r=p.exec(e.slice(n,n+2));return r?(t.d=+r[0],n+r[0].length):-1}function L(t,e,n){var r=p.exec(e.slice(n,n+3));return r?(t.m=0,t.d=+r[0],n+r[0].length):-1}function I(t,e,n){var r=p.exec(e.slice(n,n+2));return r?(t.H=+r[0],n+r[0].length):-1}function N(t,e,n){var r=p.exec(e.slice(n,n+2));return r?(t.M=+r[0],n+r[0].length):-1}function D(t,e,n){var r=p.exec(e.slice(n,n+2));return r?(t.S=+r[0],n+r[0].length):-1}function R(t,e,n){var r=p.exec(e.slice(n,n+3));return r?(t.L=+r[0],n+r[0].length):-1}function F(t,e,n){var r=p.exec(e.slice(n,n+6));return r?(t.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function B(t,e,n){var r=g.exec(e.slice(n,n+1));return r?n+r[0].length:-1}function j(t,e,n){var r=p.exec(e.slice(n));return r?(t.Q=+r[0],n+r[0].length):-1}function z(t,e,n){var r=p.exec(e.slice(n));return r?(t.s=+r[0],n+r[0].length):-1}function U(t,e){return y(t.getDate(),e,2)}function $(t,e){return y(t.getHours(),e,2)}function V(t,e){return y(t.getHours()%12||12,e,2)}function q(t,e){return y(1+s["a"].count(Object(a["a"])(t),t),e,3)}function W(t,e){return y(t.getMilliseconds(),e,3)}function G(t,e){return W(t,e)+"000"}function H(t,e){return y(t.getMonth()+1,e,2)}function X(t,e){return y(t.getMinutes(),e,2)}function Y(t,e){return y(t.getSeconds(),e,2)}function Z(t){var e=t.getDay();return 0===e?7:e}function K(t,e){return y(o["b"].count(Object(a["a"])(t)-1,t),e,2)}function J(t){var e=t.getDay();return e>=4||0===e?Object(o["c"])(t):o["c"].ceil(t)}function Q(t,e){return t=J(t),y(o["c"].count(Object(a["a"])(t),t)+(4===Object(a["a"])(t).getDay()),e,2)}function tt(t){return t.getDay()}function et(t,e){return y(o["a"].count(Object(a["a"])(t)-1,t),e,2)}function nt(t,e){return y(t.getFullYear()%100,e,2)}function rt(t,e){return t=J(t),y(t.getFullYear()%100,e,2)}function it(t,e){return y(t.getFullYear()%1e4,e,4)}function ot(t,e){var n=t.getDay();return t=n>=4||0===n?Object(o["c"])(t):o["c"].ceil(t),y(t.getFullYear()%1e4,e,4)}function st(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+y(e/60|0,"0",2)+y(e%60,"0",2)}function at(t,e){return y(t.getUTCDate(),e,2)}function ut(t,e){return y(t.getUTCHours(),e,2)}function ct(t,e){return y(t.getUTCHours()%12||12,e,2)}function lt(t,e){return y(1+i["a"].count(Object(u["a"])(t),t),e,3)}function ht(t,e){return y(t.getUTCMilliseconds(),e,3)}function ft(t,e){return ht(t,e)+"000"}function dt(t,e){return y(t.getUTCMonth()+1,e,2)}function pt(t,e){return y(t.getUTCMinutes(),e,2)}function gt(t,e){return y(t.getUTCSeconds(),e,2)}function mt(t){var e=t.getUTCDay();return 0===e?7:e}function yt(t,e){return y(r["b"].count(Object(u["a"])(t)-1,t),e,2)}function vt(t){var e=t.getUTCDay();return e>=4||0===e?Object(r["c"])(t):r["c"].ceil(t)}function bt(t,e){return t=vt(t),y(r["c"].count(Object(u["a"])(t),t)+(4===Object(u["a"])(t).getUTCDay()),e,2)}function _t(t){return t.getUTCDay()}function wt(t,e){return y(r["a"].count(Object(u["a"])(t)-1,t),e,2)}function xt(t,e){return y(t.getUTCFullYear()%100,e,2)}function St(t,e){return t=vt(t),y(t.getUTCFullYear()%100,e,2)}function Et(t,e){return y(t.getUTCFullYear()%1e4,e,4)}function At(t,e){var n=t.getUTCDay();return t=n>=4||0===n?Object(r["c"])(t):r["c"].ceil(t),y(t.getUTCFullYear()%1e4,e,4)}function Mt(){return"+0000"}function Ct(){return"%"}function kt(t){return+t}function Ot(t){return Math.floor(+t/1e3)}},a630:function(t,e,n){var r=n("23e7"),i=n("4df4"),o=n("1c7e"),s=!o((function(t){Array.from(t)}));r({target:"Array",stat:!0,forced:s},{from:i})},a683:function(t,e,n){"use strict";(function(t){n.d(e,"a",(function(){return i}));var r=n("4890");function i(){const e="object"===typeof t&&"[object process]"===String(t)&&!t.browser;return!e||Object(r["a"])()}}).call(this,n("4362"))},a7fd5:function(t,e,n){"use strict";var r=n("aa74");e["a"]=function(t){return t=Object(r["b"])(Math.abs(t)),t?t[1]:NaN}},a814:function(t,e,n){"use strict";n("8c87")},aa74:function(t,e,n){"use strict";function r(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]}n.d(e,"b",(function(){return r})),e["a"]=function(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}},ab13:function(t,e,n){var r=n("b622"),i=r("match");t.exports=function(t){var e=/./;try{"/./"[t](e)}catch(n){try{return e[i]=!1,"/./"[t](e)}catch(r){}}return!1}},ae32:function(t,e,n){t.exports=n("4d83")},ae9d:function(t,e,n){"use strict";n.d(e,"c",(function(){return i})),n.d(e,"e",(function(){return h})),n.d(e,"a",(function(){return d})),n.d(e,"b",(function(){return p})),n.d(e,"d",(function(){return m}));var r=n("a093");const i={[3042]:!1,[32773]:new Float32Array([0,0,0,0]),[32777]:32774,[34877]:32774,[32969]:1,[32968]:0,[32971]:1,[32970]:0,[3106]:new Float32Array([0,0,0,0]),[3107]:[!0,!0,!0,!0],[2884]:!1,[2885]:1029,[2929]:!1,[2931]:1,[2932]:513,[2928]:new Float32Array([0,1]),[2930]:!0,[3024]:!0,[36006]:null,[2886]:2305,[33170]:4352,[2849]:1,[32823]:!1,[32824]:0,[10752]:0,[32938]:1,[32939]:!1,[3089]:!1,[3088]:new Int32Array([0,0,1024,1024]),[2960]:!1,[2961]:0,[2968]:4294967295,[36005]:4294967295,[2962]:519,[2967]:0,[2963]:4294967295,[34816]:519,[36003]:0,[36004]:4294967295,[2964]:7680,[2965]:7680,[2966]:7680,[34817]:7680,[34818]:7680,[34819]:7680,[2978]:[0,0,1024,1024],[3333]:4,[3317]:4,[37440]:!1,[37441]:!1,[37443]:37444,[35723]:4352,[36010]:null,[35977]:!1,[3330]:0,[3332]:0,[3331]:0,[3314]:0,[32878]:0,[3316]:0,[3315]:0,[32877]:0},o=(t,e,n)=>e?t.enable(n):t.disable(n),s=(t,e,n)=>t.hint(n,e),a=(t,e,n)=>t.pixelStorei(n,e),u=(t,e)=>{const n=Object(r["e"])(t)?36009:36160;return t.bindFramebuffer(n,e)},c=(t,e)=>{return t.bindFramebuffer(36008,e)};function l(t){return Array.isArray(t)||ArrayBuffer.isView(t)}const h={[3042]:o,[32773]:(t,e)=>t.blendColor(...e),[32777]:"blendEquation",[34877]:"blendEquation",[32969]:"blendFunc",[32968]:"blendFunc",[32971]:"blendFunc",[32970]:"blendFunc",[3106]:(t,e)=>t.clearColor(...e),[3107]:(t,e)=>t.colorMask(...e),[2884]:o,[2885]:(t,e)=>t.cullFace(e),[2929]:o,[2931]:(t,e)=>t.clearDepth(e),[2932]:(t,e)=>t.depthFunc(e),[2928]:(t,e)=>t.depthRange(...e),[2930]:(t,e)=>t.depthMask(e),[3024]:o,[35723]:s,[36006]:u,[2886]:(t,e)=>t.frontFace(e),[33170]:s,[2849]:(t,e)=>t.lineWidth(e),[32823]:o,[32824]:"polygonOffset",[10752]:"polygonOffset",[35977]:o,[32938]:"sampleCoverage",[32939]:"sampleCoverage",[3089]:o,[3088]:(t,e)=>t.scissor(...e),[2960]:o,[2961]:(t,e)=>t.clearStencil(e),[2968]:(t,e)=>t.stencilMaskSeparate(1028,e),[36005]:(t,e)=>t.stencilMaskSeparate(1029,e),[2962]:"stencilFuncFront",[2967]:"stencilFuncFront",[2963]:"stencilFuncFront",[34816]:"stencilFuncBack",[36003]:"stencilFuncBack",[36004]:"stencilFuncBack",[2964]:"stencilOpFront",[2965]:"stencilOpFront",[2966]:"stencilOpFront",[34817]:"stencilOpBack",[34818]:"stencilOpBack",[34819]:"stencilOpBack",[2978]:(t,e)=>t.viewport(...e),[3333]:a,[3317]:a,[37440]:a,[37441]:a,[37443]:a,[3330]:a,[3332]:a,[3331]:a,[36010]:c,[3314]:a,[32878]:a,[3316]:a,[3315]:a,[32877]:a,framebuffer:(t,e)=>{const n=e&&"handle"in e?e.handle:e;return t.bindFramebuffer(36160,n)},blend:(t,e)=>e?t.enable(3042):t.disable(3042),blendColor:(t,e)=>t.blendColor(...e),blendEquation:(t,e)=>{e=l(e)?e:[e,e],t.blendEquationSeparate(...e)},blendFunc:(t,e)=>{e=l(e)&&2===e.length?[...e,...e]:e,t.blendFuncSeparate(...e)},clearColor:(t,e)=>t.clearColor(...e),clearDepth:(t,e)=>t.clearDepth(e),clearStencil:(t,e)=>t.clearStencil(e),colorMask:(t,e)=>t.colorMask(...e),cull:(t,e)=>e?t.enable(2884):t.disable(2884),cullFace:(t,e)=>t.cullFace(e),depthTest:(t,e)=>e?t.enable(2929):t.disable(2929),depthFunc:(t,e)=>t.depthFunc(e),depthMask:(t,e)=>t.depthMask(e),depthRange:(t,e)=>t.depthRange(...e),dither:(t,e)=>e?t.enable(3024):t.disable(3024),derivativeHint:(t,e)=>{t.hint(35723,e)},frontFace:(t,e)=>t.frontFace(e),mipmapHint:(t,e)=>t.hint(33170,e),lineWidth:(t,e)=>t.lineWidth(e),polygonOffsetFill:(t,e)=>e?t.enable(32823):t.disable(32823),polygonOffset:(t,e)=>t.polygonOffset(...e),sampleCoverage:(t,e)=>t.sampleCoverage(...e),scissorTest:(t,e)=>e?t.enable(3089):t.disable(3089),scissor:(t,e)=>t.scissor(...e),stencilTest:(t,e)=>e?t.enable(2960):t.disable(2960),stencilMask:(t,e)=>{e=l(e)?e:[e,e];const[n,r]=e;t.stencilMaskSeparate(1028,n),t.stencilMaskSeparate(1029,r)},stencilFunc:(t,e)=>{e=l(e)&&3===e.length?[...e,...e]:e;const[n,r,i,o,s,a]=e;t.stencilFuncSeparate(1028,n,r,i),t.stencilFuncSeparate(1029,o,s,a)},stencilOp:(t,e)=>{e=l(e)&&3===e.length?[...e,...e]:e;const[n,r,i,o,s,a]=e;t.stencilOpSeparate(1028,n,r,i),t.stencilOpSeparate(1029,o,s,a)},viewport:(t,e)=>t.viewport(...e)};function f(t,e,n){return void 0!==e[t]?e[t]:n[t]}const d={blendEquation:(t,e,n)=>t.blendEquationSeparate(f(32777,e,n),f(34877,e,n)),blendFunc:(t,e,n)=>t.blendFuncSeparate(f(32969,e,n),f(32968,e,n),f(32971,e,n),f(32970,e,n)),polygonOffset:(t,e,n)=>t.polygonOffset(f(32824,e,n),f(10752,e,n)),sampleCoverage:(t,e,n)=>t.sampleCoverage(f(32938,e,n),f(32939,e,n)),stencilFuncFront:(t,e,n)=>t.stencilFuncSeparate(1028,f(2962,e,n),f(2967,e,n),f(2963,e,n)),stencilFuncBack:(t,e,n)=>t.stencilFuncSeparate(1029,f(34816,e,n),f(36003,e,n),f(36004,e,n)),stencilOpFront:(t,e,n)=>t.stencilOpSeparate(1028,f(2964,e,n),f(2965,e,n),f(2966,e,n)),stencilOpBack:(t,e,n)=>t.stencilOpSeparate(1029,f(34817,e,n),f(34818,e,n),f(34819,e,n))},p={enable:(t,e)=>t({[e]:!0}),disable:(t,e)=>t({[e]:!1}),pixelStorei:(t,e,n)=>t({[e]:n}),hint:(t,e,n)=>t({[e]:n}),bindFramebuffer:(t,e,n)=>{switch(e){case 36160:return t({[36006]:n,[36010]:n});case 36009:return t({[36006]:n});case 36008:return t({[36010]:n});default:return null}},blendColor:(t,e,n,r,i)=>t({[32773]:new Float32Array([e,n,r,i])}),blendEquation:(t,e)=>t({[32777]:e,[34877]:e}),blendEquationSeparate:(t,e,n)=>t({[32777]:e,[34877]:n}),blendFunc:(t,e,n)=>t({[32969]:e,[32968]:n,[32971]:e,[32970]:n}),blendFuncSeparate:(t,e,n,r,i)=>t({[32969]:e,[32968]:n,[32971]:r,[32970]:i}),clearColor:(t,e,n,r,i)=>t({[3106]:new Float32Array([e,n,r,i])}),clearDepth:(t,e)=>t({[2931]:e}),clearStencil:(t,e)=>t({[2961]:e}),colorMask:(t,e,n,r,i)=>t({[3107]:[e,n,r,i]}),cullFace:(t,e)=>t({[2885]:e}),depthFunc:(t,e)=>t({[2932]:e}),depthRange:(t,e,n)=>t({[2928]:new Float32Array([e,n])}),depthMask:(t,e)=>t({[2930]:e}),frontFace:(t,e)=>t({[2886]:e}),lineWidth:(t,e)=>t({[2849]:e}),polygonOffset:(t,e,n)=>t({[32824]:e,[10752]:n}),sampleCoverage:(t,e,n)=>t({[32938]:e,[32939]:n}),scissor:(t,e,n,r,i)=>t({[3088]:new Int32Array([e,n,r,i])}),stencilMask:(t,e)=>t({[2968]:e,[36005]:e}),stencilMaskSeparate:(t,e,n)=>t({[1028===e?2968:36005]:n}),stencilFunc:(t,e,n,r)=>t({[2962]:e,[2967]:n,[2963]:r,[34816]:e,[36003]:n,[36004]:r}),stencilFuncSeparate:(t,e,n,r,i)=>t({[1028===e?2962:34816]:n,[1028===e?2967:36003]:r,[1028===e?2963:36004]:i}),stencilOp:(t,e,n,r)=>t({[2964]:e,[2965]:n,[2966]:r,[34817]:e,[34818]:n,[34819]:r}),stencilOpSeparate:(t,e,n,r,i)=>t({[1028===e?2964:34817]:n,[1028===e?2965:34818]:r,[1028===e?2966:34819]:i}),viewport:(t,e,n,r,i)=>t({[2978]:[e,n,r,i]})},g=(t,e)=>t.isEnabled(e),m={[3042]:g,[2884]:g,[2929]:g,[3024]:g,[32823]:g,[32926]:g,[32928]:g,[3089]:g,[2960]:g,[35977]:g}},af19:function(t,e,n){"use strict";t.exports=i,t.exports.default=i;var r=1e20;function i(t,e,n,r,i,o){this.fontSize=t||24,this.buffer=void 0===e?3:e,this.cutoff=r||.25,this.fontFamily=i||"sans-serif",this.fontWeight=o||"normal",this.radius=n||8;var s=this.size=this.fontSize+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=s,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(s*s),this.gridInner=new Float64Array(s*s),this.f=new Float64Array(s),this.d=new Float64Array(s),this.z=new Float64Array(s+1),this.v=new Int16Array(s),this.middle=Math.round(s/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function o(t,e,n,r,i,o,a){for(var u=0;u<e;u++){for(var c=0;c<n;c++)r[c]=t[c*e+u];for(s(r,i,o,a,n),c=0;c<n;c++)t[c*e+u]=i[c]}for(c=0;c<n;c++){for(u=0;u<e;u++)r[u]=t[c*e+u];for(s(r,i,o,a,e),u=0;u<e;u++)t[c*e+u]=Math.sqrt(i[u])}}function s(t,e,n,i,o){n[0]=0,i[0]=-r,i[1]=+r;for(var s=1,a=0;s<o;s++){var u=(t[s]+s*s-(t[n[a]]+n[a]*n[a]))/(2*s-2*n[a]);while(u<=i[a])a--,u=(t[s]+s*s-(t[n[a]]+n[a]*n[a]))/(2*s-2*n[a]);a++,n[a]=s,i[a]=u,i[a+1]=+r}for(s=0,a=0;s<o;s++){while(i[a+1]<s)a++;e[s]=(s-n[a])*(s-n[a])+t[n[a]]}}i.prototype.draw=function(t){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(t,this.buffer,this.middle);for(var e=this.ctx.getImageData(0,0,this.size,this.size),n=new Uint8ClampedArray(this.size*this.size),i=0;i<this.size*this.size;i++){var s=e.data[4*i+3]/255;this.gridOuter[i]=1===s?0:0===s?r:Math.pow(Math.max(0,.5-s),2),this.gridInner[i]=1===s?r:0===s?0:Math.pow(Math.max(0,s-.5),2)}for(o(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),o(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),i=0;i<this.size*this.size;i++){var a=this.gridOuter[i]-this.gridInner[i];n[i]=Math.max(0,Math.min(255,Math.round(255-255*(a/this.radius+this.cutoff))))}return n}},af32:function(t,e){},af7f:function(t,e,n){"use strict";n.d(e,"b",(function(){return i})),n.d(e,"a",(function(){return a}));var r=n("20a4");function i(t,...e){return e.reduce((e,n)=>{return t.hasOwnProperty(n)&&(e[n]=t[n]),e},{})}const o=setTimeout,s=clearTimeout;function a(t,e){e.useNativeTimers?(t.setTimeoutFn=o.bind(r["a"]),t.clearTimeoutFn=s.bind(r["a"])):(t.setTimeoutFn=setTimeout.bind(r["a"]),t.clearTimeoutFn=clearTimeout.bind(r["a"]))}},b00f:function(t,e,n){"use strict";t.exports=n("a4c0")},b128:function(t,e,n){"use strict";function r(t,e,n){const r=e[0],i=e[1],o=n[3]*r+n[7]*i||1;return t[0]=(n[0]*r+n[4]*i)/o,t[1]=(n[1]*r+n[5]*i)/o,t}function i(t,e,n){const r=e[0],i=e[1],o=e[2],s=n[3]*r+n[7]*i+n[11]*o||1;return t[0]=(n[0]*r+n[4]*i+n[8]*o)/s,t[1]=(n[1]*r+n[5]*i+n[9]*o)/s,t[2]=(n[2]*r+n[6]*i+n[10]*o)/s,t}function o(t,e,n){const r=e[0],i=e[1];return t[0]=n[0]*r+n[2]*i,t[1]=n[1]*r+n[3]*i,t[2]=e[2],t}n.d(e,"a",(function(){return r})),n.d(e,"c",(function(){return i})),n.d(e,"b",(function(){return o}))},b14c:function(t,e,n){"use strict";n.d(e,"b",(function(){return s})),n.d(e,"a",(function(){return a})),n.d(e,"c",(function(){return l}));var r=n("18e2"),i=n("1738");function o(t){return Object(r["a"])((function(e){e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)}),(function(t,e){t.setDate(t.getDate()+7*e)}),(function(t,e){return(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*i["c"])/i["f"]}))}var s=o(0),a=o(1),u=o(2),c=o(3),l=o(4),h=o(5),f=o(6);s.range,a.range,u.range,c.range,l.range,h.range,f.range},b170:function(t,e,n){"use strict";var r,i=n("a7fd5"),o=function(t,e){return function(n,r){var i=n.length,o=[],s=0,a=t[0],u=0;while(i>0&&a>0){if(u+a+1>r&&(a=Math.max(1,r-u)),o.push(n.substring(i-=a,i+a)),(u+=a+1)>r)break;a=t[s=(s+1)%t.length]}return o.reverse().join(e)}},s=function(t){return function(e){return e.replace(/[0-9]/g,(function(e){return t[+e]}))}},a=n("09b8"),u=function(t){t:for(var e,n=t.length,r=1,i=-1;r<n;++r)switch(t[r]){case".":i=e=r;break;case"0":0===i&&(i=r),e=r;break;default:if(!+t[r])break t;i>0&&(i=0);break}return i>0?t.slice(0,i)+t.slice(e+1):t},c=n("aa74"),l=function(t,e){var n=Object(c["b"])(t,e);if(!n)return t+"";var i=n[0],o=n[1],s=o-(r=3*Math.max(-8,Math.min(8,Math.floor(o/3))))+1,a=i.length;return s===a?i:s>a?i+new Array(s-a+1).join("0"):s>0?i.slice(0,s)+"."+i.slice(s):"0."+new Array(1-s).join("0")+Object(c["b"])(t,Math.max(0,e+s-1))[0]},h=function(t,e){var n=Object(c["b"])(t,e);if(!n)return t+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")},f={"%":(t,e)=>(100*t).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:c["a"],e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>h(100*t,e),r:h,s:l,X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)},d=function(t){return t},p=Array.prototype.map,g=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];e["a"]=function(t){var e=void 0===t.grouping||void 0===t.thousands?d:o(p.call(t.grouping,Number),t.thousands+""),n=void 0===t.currency?"":t.currency[0]+"",c=void 0===t.currency?"":t.currency[1]+"",l=void 0===t.decimal?".":t.decimal+"",h=void 0===t.numerals?d:s(p.call(t.numerals,String)),m=void 0===t.percent?"%":t.percent+"",y=void 0===t.minus?"−":t.minus+"",v=void 0===t.nan?"NaN":t.nan+"";function b(t){t=Object(a["a"])(t);var i=t.fill,o=t.align,s=t.sign,d=t.symbol,p=t.zero,b=t.width,_=t.comma,w=t.precision,x=t.trim,S=t.type;"n"===S?(_=!0,S="g"):f[S]||(void 0===w&&(w=12),x=!0,S="g"),(p||"0"===i&&"="===o)&&(p=!0,i="0",o="=");var E="$"===d?n:"#"===d&&/[boxX]/.test(S)?"0"+S.toLowerCase():"",A="$"===d?c:/[%p]/.test(S)?m:"",M=f[S],C=/[defgprs%]/.test(S);function k(t){var n,a,c,f=E,d=A;if("c"===S)d=M(t)+d,t="";else{t=+t;var m=t<0||1/t<0;if(t=isNaN(t)?v:M(Math.abs(t),w),x&&(t=u(t)),m&&0===+t&&"+"!==s&&(m=!1),f=(m?"("===s?s:y:"-"===s||"("===s?"":s)+f,d=("s"===S?g[8+r/3]:"")+d+(m&&"("===s?")":""),C){n=-1,a=t.length;while(++n<a)if(c=t.charCodeAt(n),48>c||c>57){d=(46===c?l+t.slice(n+1):t.slice(n))+d,t=t.slice(0,n);break}}}_&&!p&&(t=e(t,1/0));var k=f.length+t.length+d.length,O=k<b?new Array(b-k+1).join(i):"";switch(_&&p&&(t=e(O+t,O.length?b-d.length:1/0),O=""),o){case"<":t=f+t+d+O;break;case"=":t=f+O+t+d;break;case"^":t=O.slice(0,k=O.length>>1)+f+t+d+O.slice(k);break;default:t=O+f+t+d;break}return h(t)}return w=void 0===w?6:/[gprs]/.test(S)?Math.max(1,Math.min(21,w)):Math.max(0,Math.min(20,w)),k.toString=function(){return t+""},k}function _(t,e){var n=b((t=Object(a["a"])(t),t.type="f",t)),r=3*Math.max(-8,Math.min(8,Math.floor(Object(i["a"])(e)/3))),o=Math.pow(10,-r),s=g[8+r/3];return function(t){return n(o*t)+s}}return{format:b,formatPrefix:_}}},b181:function(t){t.exports=JSON.parse('["a","altGlyph","altGlyphDef","altGlyphItem","animate","animateColor","animateMotion","animateTransform","circle","clipPath","color-profile","cursor","defs","desc","ellipse","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","font","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignObject","g","glyph","glyphRef","hkern","image","line","linearGradient","marker","mask","metadata","missing-glyph","mpath","path","pattern","polygon","polyline","radialGradient","rect","script","set","stop","style","svg","switch","symbol","text","textPath","title","tref","tspan","use","view","vkern"]')},b19d:function(t,e){function n(t){if(t)return r(t)}function r(t){for(var e in n.prototype)t[e]=n.prototype[e];return t}e.Emitter=n,n.prototype.on=n.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(e),this},n.prototype.once=function(t,e){function n(){this.off(t,n),e.apply(this,arguments)}return n.fn=e,this.on(t,n),this},n.prototype.off=n.prototype.removeListener=n.prototype.removeAllListeners=n.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n,r=this._callbacks["$"+t];if(!r)return this;if(1==arguments.length)return delete this._callbacks["$"+t],this;for(var i=0;i<r.length;i++)if(n=r[i],n===e||n.fn===e){r.splice(i,1);break}return 0===r.length&&delete this._callbacks["$"+t],this},n.prototype.emit=function(t){this._callbacks=this._callbacks||{};for(var e=new Array(arguments.length-1),n=this._callbacks["$"+t],r=1;r<arguments.length;r++)e[r-1]=arguments[r];if(n){n=n.slice(0);r=0;for(var i=n.length;r<i;++r)n[r].apply(this,e)}return this},n.prototype.emitReserved=n.prototype.emit,n.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks["$"+t]||[]},n.prototype.hasListeners=function(t){return!!this.listeners(t).length}},b2b4:function(t,e,n){t.exports=n("f330")},b3c3:function(t,e,n){"use strict";var r=n("18e2"),i=n("1738"),o=Object(r["a"])((function(t){t.setTime(t-t.getMilliseconds()-t.getSeconds()*i["e"]-t.getMinutes()*i["c"])}),(function(t,e){t.setTime(+t+e*i["b"])}),(function(t,e){return(e-t)/i["b"]}),(function(t){return t.getHours()}));e["a"]=o;o.range},b50d:function(t,e,n){"use strict";var r=n("c532"),i=n("467f"),o=n("7aac"),s=n("30b5"),a=n("83b9"),u=n("c345"),c=n("3934"),l=n("2d83"),h=n("2444"),f=n("7a77");t.exports=function(t){return new Promise((function(e,n){var d,p=t.data,g=t.headers,m=t.responseType;function y(){t.cancelToken&&t.cancelToken.unsubscribe(d),t.signal&&t.signal.removeEventListener("abort",d)}r.isFormData(p)&&delete g["Content-Type"];var v=new XMLHttpRequest;if(t.auth){var b=t.auth.username||"",_=t.auth.password?unescape(encodeURIComponent(t.auth.password)):"";g.Authorization="Basic "+btoa(b+":"+_)}var w=a(t.baseURL,t.url);function x(){if(v){var r="getAllResponseHeaders"in v?u(v.getAllResponseHeaders()):null,o=m&&"text"!==m&&"json"!==m?v.response:v.responseText,s={data:o,status:v.status,statusText:v.statusText,headers:r,config:t,request:v};i((function(t){e(t),y()}),(function(t){n(t),y()}),s),v=null}}if(v.open(t.method.toUpperCase(),s(w,t.params,t.paramsSerializer),!0),v.timeout=t.timeout,"onloadend"in v?v.onloadend=x:v.onreadystatechange=function(){v&&4===v.readyState&&(0!==v.status||v.responseURL&&0===v.responseURL.indexOf("file:"))&&setTimeout(x)},v.onabort=function(){v&&(n(l("Request aborted",t,"ECONNABORTED",v)),v=null)},v.onerror=function(){n(l("Network Error",t,null,v)),v=null},v.ontimeout=function(){var e=t.timeout?"timeout of "+t.timeout+"ms exceeded":"timeout exceeded",r=t.transitional||h.transitional;t.timeoutErrorMessage&&(e=t.timeoutErrorMessage),n(l(e,t,r.clarifyTimeoutError?"ETIMEDOUT":"ECONNABORTED",v)),v=null},r.isStandardBrowserEnv()){var S=(t.withCredentials||c(w))&&t.xsrfCookieName?o.read(t.xsrfCookieName):void 0;S&&(g[t.xsrfHeaderName]=S)}"setRequestHeader"in v&&r.forEach(g,(function(t,e){"undefined"===typeof p&&"content-type"===e.toLowerCase()?delete g[e]:v.setRequestHeader(e,t)})),r.isUndefined(t.withCredentials)||(v.withCredentials=!!t.withCredentials),m&&"json"!==m&&(v.responseType=t.responseType),"function"===typeof t.onDownloadProgress&&v.addEventListener("progress",t.onDownloadProgress),"function"===typeof t.onUploadProgress&&v.upload&&v.upload.addEventListener("progress",t.onUploadProgress),(t.cancelToken||t.signal)&&(d=function(t){v&&(n(!t||t&&t.type?new f("canceled"):t),v.abort(),v=null)},t.cancelToken&&t.cancelToken.subscribe(d),t.signal&&(t.signal.aborted?d():t.signal.addEventListener("abort",d))),p||(p=null),v.send(p)}))}},b52f:function(t,e,n){"use strict";function r(t,e){if(!t)throw new Error("math.gl assertion ".concat(e))}n.d(e,"a",(function(){return r}))},b834:function(t,e,n){"use strict";n("1f77")},b8bc:function(t,e,n){"use strict";(function(t){function r(e){if("undefined"!==typeof window&&"object"===typeof window.process&&"renderer"===window.process.type)return!0;if("undefined"!==typeof t&&"object"===typeof t.versions&&Boolean(t.versions.electron))return!0;const n="object"===typeof navigator&&"string"===typeof navigator.userAgent&&navigator.userAgent,r=e||n;return!!(r&&r.indexOf("Electron")>=0)}n.d(e,"a",(function(){return r}))}).call(this,n("4362"))},bb2f:function(t,e,n){var r=n("d039");t.exports=!r((function(){return Object.isExtensible(Object.preventExtensions({}))}))},bbdc:function(t,e,n){"use strict";n("dd09")},bc3a:function(t,e,n){t.exports=n("cee4")},bd1b:function(t,e,n){"use strict";var r=n("4ea4");Object.defineProperty(e,"__esModule",{value:!0}),e.isMobile=a,e.default=u;var i=n("9bef"),o=r(n("9401")),s=r(n("095a"));function a(){return"undefined"!==typeof i.window.orientation}function u(t){if(!t&&!(0,o.default)())return"Node";if((0,s.default)(t))return"Electron";var e="undefined"!==typeof navigator?navigator:{},n=t||e.userAgent||"";if(n.indexOf("Edge")>-1)return"Edge";var r=-1!==n.indexOf("MSIE "),a=-1!==n.indexOf("Trident/");return r||a?"IE":i.window.chrome?"Chrome":i.window.safari?"Safari":i.window.mozInnerScreenX?"Firefox":"Unknown"}},c092:function(t,e,n){"use strict";n.d(e,"a",(function(){return $})),n.d(e,"b",(function(){return U})),n.d(e,"c",(function(){return N})),n.d(e,"d",(function(){return V})),n.d(e,"e",(function(){return j}));var r=Math.sqrt(50),i=Math.sqrt(10),o=Math.sqrt(2);function s(t,e,n){var s=Math.abs(e-t)/Math.max(0,n),a=Math.pow(10,Math.floor(Math.log(s)/Math.LN10)),u=s/a;return u>=r?a*=10:u>=i?a*=5:u>=o&&(a*=2),e<t?-a:a}var a=n("09b8"),u=n("d933"),c=n("d989"),l=n("dad1"),h=n("1231"),f=n("b170"),d=n("de28");function p(t,e,n){return t.fields=e||[],t.fname=n,t}function g(t){return 1===t.length?m(t[0]):y(t)}const m=t=>(function(e){return e[t]}),y=t=>{const e=t.length;return function(n){for(let r=0;r<e;++r)n=n[t[r]];return n}};function v(t){throw Error(t)}function b(t){const e=[],n=t.length;let r,i,o,s=null,a=0,u="";function c(){e.push(u+t.substring(r,i)),u="",r=i+1}for(t+="",r=i=0;i<n;++i)if(o=t[i],"\\"===o)u+=t.substring(r,i),u+=t.substring(++i,++i),r=i;else if(o===s)c(),s=null,a=-1;else{if(s)continue;r===a&&'"'===o?(r=i+1,s=o):r===a&&"'"===o?(r=i+1,s=o):"."!==o||a?"["===o?(i>r&&c(),a=r=i+1):"]"===o&&(a||v("Access path missing open bracket: "+t),a>0&&c(),a=0,r=i+1):i>r?c():r=i+1}return a&&v("Access path missing closing bracket: "+t),s&&v("Access path missing closing quote: "+t),i>r&&(i++,c()),e}function _(t,e,n){const r=b(t);return t=1===r.length?r[0]:t,p((n&&n.get||g)(r),[t],e||t)}_("id"),p(t=>t,[],"identity"),p(()=>0,[],"zero"),p(()=>1,[],"one"),p(()=>!0,[],"true"),p(()=>!1,[],"false");Array.isArray;function w(t){return t===Object(t)}function x(t){for(let e,n,r=1,i=arguments.length;r<i;++r)for(n in e=arguments[r],e)t[n]=e[n];return t}Object.prototype.hasOwnProperty;function S(t){return"string"===typeof t}var E=n("4c23"),A=n("a591");function M(t){const e={};return n=>e[n]||(e[n]=t(n))}function C(t,e){return n=>{const r=t(n),i=r.indexOf(e);if(i<0)return r;let o=k(r,i);const s=o<r.length?r.slice(o):"";while(--o>i)if("0"!==r[o]){++o;break}return r.slice(0,o)+s}}function k(t,e){let n,r=t.lastIndexOf("e");if(r>0)return r;for(r=t.length;--r>e;)if(n=t.charCodeAt(r),n>=48&&n<=57)return r+1}function O(t){const e=M(t.format),n=t.formatPrefix;return{format:e,formatPrefix:n,formatFloat(t){const n=Object(a["a"])(t||",");if(null==n.precision){switch(n.precision=12,n.type){case"%":n.precision-=2;break;case"e":n.precision-=1;break}return C(e(n),e(".1f")(1)[1])}return e(n)},formatSpan(t,r,i,o){o=Object(a["a"])(null==o?",f":o);const h=s(t,r,i),f=Math.max(Math.abs(t),Math.abs(r));let d;if(null==o.precision)switch(o.type){case"s":return isNaN(d=Object(u["a"])(h,f))||(o.precision=d),n(o,f);case"":case"e":case"g":case"p":case"r":isNaN(d=Object(c["a"])(h,f))||(o.precision=d-("e"===o.type));break;case"f":case"%":isNaN(d=Object(l["a"])(h))||(o.precision=d-2*("%"===o.type));break}return e(o)}}}let P,T;function L(){return P=O({format:h["a"],formatPrefix:h["b"]})}function I(t){return O(Object(f["a"])(t))}function N(t){return arguments.length?P=I(t):P}function D(t,e,n){n=n||{},w(n)||v("Invalid time multi-format specifier: ".concat(n));const r=e(d["i"]),i=e(d["f"]),o=e(d["d"]),s=e(d["a"]),a=e(d["k"]),u=e(d["g"]),c=e(d["h"]),l=e(d["l"]),h=t(n[d["e"]]||".%L"),f=t(n[d["i"]]||":%S"),p=t(n[d["f"]]||"%I:%M"),g=t(n[d["d"]]||"%I %p"),m=t(n[d["a"]]||n[d["b"]]||"%a %d"),y=t(n[d["k"]]||"%b %d"),b=t(n[d["g"]]||"%B"),_=t(n[d["h"]]||"%B"),x=t(n[d["l"]]||"%Y");return t=>(r(t)<t?h:i(t)<t?f:o(t)<t?p:s(t)<t?g:u(t)<t?a(t)<t?m:y:l(t)<t?c(t)<t?b:_:x)(t)}function R(t){const e=M(t.format),n=M(t.utcFormat);return{timeFormat:t=>S(t)?e(t):D(e,d["p"],t),utcFormat:t=>S(t)?n(t):D(n,d["v"],t),timeParse:M(t.parse),utcParse:M(t.utcParse)}}function F(){return T=R({format:E["a"],parse:E["b"],utcFormat:E["c"],utcParse:E["d"]})}function B(t){return R(Object(A["a"])(t))}function j(t){return arguments.length?T=B(t):T}L(),F();const z=(t,e)=>x({},t,e);function U(t,e){const n=t?I(t):N(),r=e?B(e):j();return z(n,r)}function $(t,e){const n=arguments.length;return n&&2!==n&&v("defaultLocale expects either zero or two arguments."),n?z(N(t),j(e)):z(N(),j())}function V(){return L(),F(),$()}},c194:function(t,e,n){"use strict";n.d(e,"b",(function(){return r})),n.d(e,"d",(function(){return i})),n.d(e,"e",(function(){return o})),n.d(e,"c",(function(){return s})),n.d(e,"a",(function(){return a}));const r={Active:"__SandDance__Active",Collapsed:"__SandDance__Collapsed",Contains:"__SandDance__Contains",Count:"__SandDance__Count",Sum:"__SandDance__Sum",SumOfCount:"__SandDance__CountSum",SumOfSum:"__SandDance__SumSum",Selected:"__SandDance__Selected",First:"__SandDance__First",Last:"__SandDance__Last",Top:"__SandDance__Top",TopColor:"__SandDance__TopColor",TopIndex:"__SandDance__TopIndex",PowerBISelectionId:"__SandDance__PowerBISelectionId",FacetSearch:"__SandDance__FacetSearch",FacetTitle:"__SandDance__FacetTitle",Ordinal:"__SandDance__Ordinal",WrapCol:"__SandDance__WrapCol",WrapRow:"__SandDance__WrapRow",Value:"__SandDance__Value",OffsetX:"__SandDance__X",OffsetY:"__SandDance__Y",OffsetHeight:"__SandDance__H",OffsetWidth:"__SandDance__W"},i={Color:"scale_color",X:"scale_x",Y:"scale_y",Z:"scale_z"},o={ViewportWidth:"ViewportWidth",ViewportHeight:"ViewportHeight",MinCellWidth:"MinCellWidth",MinCellHeight:"MinCellHeight",PlotOffsetLeft:"PlotOffsetLeft",PlotOffsetTop:"PlotOffsetTop",PlotOffsetBottom:"PlotOffsetBottom",PlotOffsetRight:"PlotOffsetRight",PlotHeightIn:"PlotHeightIn",PlotWidthIn:"PlotWidthIn",PlotHeightOut:"PlotHeightOut",PlotWidthOut:"PlotWidthOut",ColorBinCount:"RoleColor_BinCountSignal",ColorReverse:"RoleColor_ReverseSignal",FacetBins:"RoleFacet_BinsSignal",FacetVBins:"RoleFacetV_BinsSignal",FacetPaddingTop:"FacetPaddingTop",FacetPaddingBottom:"FacetPaddingBottom",FacetPaddingLeft:"FacetPaddingLeft",MarkOpacity:"Mark_OpacitySignal",PointScale:"Chart_PointScaleSignal",TextAngleX:"Text_AngleXSignal",TextAngleY:"Text_AngleYSignal",TextScale:"Text_ScaleSignal",TextSize:"Text_SizeSignal",TextTitleSize:"Text_TitleSizeSignal",TreeMapMethod:"Chart_TreeMapMethodSignal",XBins:"RoleX_BinsSignal",YBins:"RoleY_BinsSignal",ZHeight:"RoleZ_HeightSignal",ZGrounded:"RoleZ_Grounded",ZProportion:"RoleZ_ProportionSignal"},s="__Other",a="none"},c345:function(t,e,n){"use strict";var r=n("c532"),i=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];t.exports=function(t){var e,n,o,s={};return t?(r.forEach(t.split("\n"),(function(t){if(o=t.indexOf(":"),e=r.trim(t.substr(0,o)).toLowerCase(),n=r.trim(t.substr(o+1)),e){if(s[e]&&i.indexOf(e)>=0)return;s[e]="set-cookie"===e?(s[e]?s[e]:[]).concat([n]):s[e]?s[e]+", "+n:n}})),s):s}},c393:function(t,e,n){},c401:function(t,e,n){"use strict";var r=n("c532"),i=n("2444");t.exports=function(t,e,n){var o=this||i;return r.forEach(n,(function(n){t=n.call(o,t,e)})),t}},c532:function(t,e,n){"use strict";var r=n("1d2b"),i=Object.prototype.toString;function o(t){return"[object Array]"===i.call(t)}function s(t){return"undefined"===typeof t}function a(t){return null!==t&&!s(t)&&null!==t.constructor&&!s(t.constructor)&&"function"===typeof t.constructor.isBuffer&&t.constructor.isBuffer(t)}function u(t){return"[object ArrayBuffer]"===i.call(t)}function c(t){return"undefined"!==typeof FormData&&t instanceof FormData}function l(t){var e;return e="undefined"!==typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(t):t&&t.buffer&&t.buffer instanceof ArrayBuffer,e}function h(t){return"string"===typeof t}function f(t){return"number"===typeof t}function d(t){return null!==t&&"object"===typeof t}function p(t){if("[object Object]"!==i.call(t))return!1;var e=Object.getPrototypeOf(t);return null===e||e===Object.prototype}function g(t){return"[object Date]"===i.call(t)}function m(t){return"[object File]"===i.call(t)}function y(t){return"[object Blob]"===i.call(t)}function v(t){return"[object Function]"===i.call(t)}function b(t){return d(t)&&v(t.pipe)}function _(t){return"undefined"!==typeof URLSearchParams&&t instanceof URLSearchParams}function w(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function x(){return("undefined"===typeof navigator||"ReactNative"!==navigator.product&&"NativeScript"!==navigator.product&&"NS"!==navigator.product)&&("undefined"!==typeof window&&"undefined"!==typeof document)}function S(t,e){if(null!==t&&"undefined"!==typeof t)if("object"!==typeof t&&(t=[t]),o(t))for(var n=0,r=t.length;n<r;n++)e.call(null,t[n],n,t);else for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.call(null,t[i],i,t)}function E(){var t={};function e(e,n){p(t[n])&&p(e)?t[n]=E(t[n],e):p(e)?t[n]=E({},e):o(e)?t[n]=e.slice():t[n]=e}for(var n=0,r=arguments.length;n<r;n++)S(arguments[n],e);return t}function A(t,e,n){return S(e,(function(e,i){t[i]=n&&"function"===typeof e?r(e,n):e})),t}function M(t){return 65279===t.charCodeAt(0)&&(t=t.slice(1)),t}t.exports={isArray:o,isArrayBuffer:u,isBuffer:a,isFormData:c,isArrayBufferView:l,isString:h,isNumber:f,isObject:d,isPlainObject:p,isUndefined:s,isDate:g,isFile:m,isBlob:y,isFunction:v,isStream:b,isURLSearchParams:_,isStandardBrowserEnv:x,forEach:S,merge:E,extend:A,trim:w,stripBOM:M}},c805:function(t,e,n){},c831:function(t,e,n){},c834:function(t,e,n){"use strict";(function(t){function r(e){if("undefined"!==typeof window&&"object"===typeof window.process&&"renderer"===window.process.type)return!0;if("undefined"!==typeof t&&"object"===typeof t.versions&&Boolean(t.versions.electron))return!0;const n="object"===typeof navigator&&"string"===typeof navigator.userAgent&&navigator.userAgent,r=e||n;return!!(r&&r.indexOf("Electron")>=0)}n.d(e,"a",(function(){return r}))}).call(this,n("4362"))},c895:function(t,e,n){},c8af:function(t,e,n){"use strict";var r=n("c532");t.exports=function(t,e){r.forEach(t,(function(n,r){r!==e&&r.toUpperCase()===e.toUpperCase()&&(t[e]=n,delete t[r])}))}},c8b5:function(t,e,n){var r;
/*! Hammer.JS - v2.0.7 - 2016-04-22
 * http://hammerjs.github.io/
 *
 * Copyright (c) 2016 Jorik Tangelder;
 * Licensed under the MIT license */(function(i,o,s,a){"use strict";var u,c=["","webkit","Moz","MS","ms","o"],l=o.createElement("div"),h="function",f=Math.round,d=Math.abs,p=Date.now;function g(t,e,n){return setTimeout(x(t,n),e)}function m(t,e,n){return!!Array.isArray(t)&&(y(t,n[e],n),!0)}function y(t,e,n){var r;if(t)if(t.forEach)t.forEach(e,n);else if(t.length!==a){r=0;while(r<t.length)e.call(n,t[r],r,t),r++}else for(r in t)t.hasOwnProperty(r)&&e.call(n,t[r],r,t)}function v(t,e,n){var r="DEPRECATED METHOD: "+e+"\n"+n+" AT \n";return function(){var e=new Error("get-stack-trace"),n=e&&e.stack?e.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",o=i.console&&(i.console.warn||i.console.log);return o&&o.call(i.console,r,n),t.apply(this,arguments)}}u="function"!==typeof Object.assign?function(t){if(t===a||null===t)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(t),n=1;n<arguments.length;n++){var r=arguments[n];if(r!==a&&null!==r)for(var i in r)r.hasOwnProperty(i)&&(e[i]=r[i])}return e}:Object.assign;var b=v((function(t,e,n){var r=Object.keys(e),i=0;while(i<r.length)(!n||n&&t[r[i]]===a)&&(t[r[i]]=e[r[i]]),i++;return t}),"extend","Use `assign`."),_=v((function(t,e){return b(t,e,!0)}),"merge","Use `assign`.");function w(t,e,n){var r,i=e.prototype;r=t.prototype=Object.create(i),r.constructor=t,r._super=i,n&&u(r,n)}function x(t,e){return function(){return t.apply(e,arguments)}}function S(t,e){return typeof t==h?t.apply(e&&e[0]||a,e):t}function E(t,e){return t===a?e:t}function A(t,e,n){y(O(e),(function(e){t.addEventListener(e,n,!1)}))}function M(t,e,n){y(O(e),(function(e){t.removeEventListener(e,n,!1)}))}function C(t,e){while(t){if(t==e)return!0;t=t.parentNode}return!1}function k(t,e){return t.indexOf(e)>-1}function O(t){return t.trim().split(/\s+/g)}function P(t,e,n){if(t.indexOf&&!n)return t.indexOf(e);var r=0;while(r<t.length){if(n&&t[r][n]==e||!n&&t[r]===e)return r;r++}return-1}function T(t){return Array.prototype.slice.call(t,0)}function L(t,e,n){var r=[],i=[],o=0;while(o<t.length){var s=e?t[o][e]:t[o];P(i,s)<0&&r.push(t[o]),i[o]=s,o++}return n&&(r=e?r.sort((function(t,n){return t[e]>n[e]})):r.sort()),r}function I(t,e){var n,r,i=e[0].toUpperCase()+e.slice(1),o=0;while(o<c.length){if(n=c[o],r=n?n+i:e,r in t)return r;o++}return a}var N=1;function D(){return N++}function R(t){var e=t.ownerDocument||t;return e.defaultView||e.parentWindow||i}var F=/mobile|tablet|ip(ad|hone|od)|android/i,B="ontouchstart"in i,j=I(i,"PointerEvent")!==a,z=B&&F.test(navigator.userAgent),U="touch",$="pen",V="mouse",q="kinect",W=25,G=1,H=2,X=4,Y=8,Z=1,K=2,J=4,Q=8,tt=16,et=K|J,nt=Q|tt,rt=et|nt,it=["x","y"],ot=["clientX","clientY"];function st(t,e){var n=this;this.manager=t,this.callback=e,this.element=t.element,this.target=t.options.inputTarget,this.domHandler=function(e){S(t.options.enable,[t])&&n.handler(e)},this.init()}function at(t){var e,n=t.options.inputClass;return e=n||(j?kt:z?Rt:B?zt:St),new e(t,ut)}function ut(t,e,n){var r=n.pointers.length,i=n.changedPointers.length,o=e&G&&r-i===0,s=e&(X|Y)&&r-i===0;n.isFirst=!!o,n.isFinal=!!s,o&&(t.session={}),n.eventType=e,ct(t,n),t.emit("hammer.input",n),t.recognize(n),t.session.prevInput=n}function ct(t,e){var n=t.session,r=e.pointers,i=r.length;n.firstInput||(n.firstInput=ft(e)),i>1&&!n.firstMultiple?n.firstMultiple=ft(e):1===i&&(n.firstMultiple=!1);var o=n.firstInput,s=n.firstMultiple,a=s?s.center:o.center,u=e.center=dt(r);e.timeStamp=p(),e.deltaTime=e.timeStamp-o.timeStamp,e.angle=yt(a,u),e.distance=mt(a,u),lt(n,e),e.offsetDirection=gt(e.deltaX,e.deltaY);var c=pt(e.deltaTime,e.deltaX,e.deltaY);e.overallVelocityX=c.x,e.overallVelocityY=c.y,e.overallVelocity=d(c.x)>d(c.y)?c.x:c.y,e.scale=s?bt(s.pointers,r):1,e.rotation=s?vt(s.pointers,r):0,e.maxPointers=n.prevInput?e.pointers.length>n.prevInput.maxPointers?e.pointers.length:n.prevInput.maxPointers:e.pointers.length,ht(n,e);var l=t.element;C(e.srcEvent.target,l)&&(l=e.srcEvent.target),e.target=l}function lt(t,e){var n=e.center,r=t.offsetDelta||{},i=t.prevDelta||{},o=t.prevInput||{};e.eventType!==G&&o.eventType!==X||(i=t.prevDelta={x:o.deltaX||0,y:o.deltaY||0},r=t.offsetDelta={x:n.x,y:n.y}),e.deltaX=i.x+(n.x-r.x),e.deltaY=i.y+(n.y-r.y)}function ht(t,e){var n,r,i,o,s=t.lastInterval||e,u=e.timeStamp-s.timeStamp;if(e.eventType!=Y&&(u>W||s.velocity===a)){var c=e.deltaX-s.deltaX,l=e.deltaY-s.deltaY,h=pt(u,c,l);r=h.x,i=h.y,n=d(h.x)>d(h.y)?h.x:h.y,o=gt(c,l),t.lastInterval=e}else n=s.velocity,r=s.velocityX,i=s.velocityY,o=s.direction;e.velocity=n,e.velocityX=r,e.velocityY=i,e.direction=o}function ft(t){var e=[],n=0;while(n<t.pointers.length)e[n]={clientX:f(t.pointers[n].clientX),clientY:f(t.pointers[n].clientY)},n++;return{timeStamp:p(),pointers:e,center:dt(e),deltaX:t.deltaX,deltaY:t.deltaY}}function dt(t){var e=t.length;if(1===e)return{x:f(t[0].clientX),y:f(t[0].clientY)};var n=0,r=0,i=0;while(i<e)n+=t[i].clientX,r+=t[i].clientY,i++;return{x:f(n/e),y:f(r/e)}}function pt(t,e,n){return{x:e/t||0,y:n/t||0}}function gt(t,e){return t===e?Z:d(t)>=d(e)?t<0?K:J:e<0?Q:tt}function mt(t,e,n){n||(n=it);var r=e[n[0]]-t[n[0]],i=e[n[1]]-t[n[1]];return Math.sqrt(r*r+i*i)}function yt(t,e,n){n||(n=it);var r=e[n[0]]-t[n[0]],i=e[n[1]]-t[n[1]];return 180*Math.atan2(i,r)/Math.PI}function vt(t,e){return yt(e[1],e[0],ot)+yt(t[1],t[0],ot)}function bt(t,e){return mt(e[0],e[1],ot)/mt(t[0],t[1],ot)}st.prototype={handler:function(){},init:function(){this.evEl&&A(this.element,this.evEl,this.domHandler),this.evTarget&&A(this.target,this.evTarget,this.domHandler),this.evWin&&A(R(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&M(this.element,this.evEl,this.domHandler),this.evTarget&&M(this.target,this.evTarget,this.domHandler),this.evWin&&M(R(this.element),this.evWin,this.domHandler)}};var _t={mousedown:G,mousemove:H,mouseup:X},wt="mousedown",xt="mousemove mouseup";function St(){this.evEl=wt,this.evWin=xt,this.pressed=!1,st.apply(this,arguments)}w(St,st,{handler:function(t){var e=_t[t.type];e&G&&0===t.button&&(this.pressed=!0),e&H&&1!==t.which&&(e=X),this.pressed&&(e&X&&(this.pressed=!1),this.callback(this.manager,e,{pointers:[t],changedPointers:[t],pointerType:V,srcEvent:t}))}});var Et={pointerdown:G,pointermove:H,pointerup:X,pointercancel:Y,pointerout:Y},At={2:U,3:$,4:V,5:q},Mt="pointerdown",Ct="pointermove pointerup pointercancel";function kt(){this.evEl=Mt,this.evWin=Ct,st.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}i.MSPointerEvent&&!i.PointerEvent&&(Mt="MSPointerDown",Ct="MSPointerMove MSPointerUp MSPointerCancel"),w(kt,st,{handler:function(t){var e=this.store,n=!1,r=t.type.toLowerCase().replace("ms",""),i=Et[r],o=At[t.pointerType]||t.pointerType,s=o==U,a=P(e,t.pointerId,"pointerId");i&G&&(0===t.button||s)?a<0&&(e.push(t),a=e.length-1):i&(X|Y)&&(n=!0),a<0||(e[a]=t,this.callback(this.manager,i,{pointers:e,changedPointers:[t],pointerType:o,srcEvent:t}),n&&e.splice(a,1))}});var Ot={touchstart:G,touchmove:H,touchend:X,touchcancel:Y},Pt="touchstart",Tt="touchstart touchmove touchend touchcancel";function Lt(){this.evTarget=Pt,this.evWin=Tt,this.started=!1,st.apply(this,arguments)}function It(t,e){var n=T(t.touches),r=T(t.changedTouches);return e&(X|Y)&&(n=L(n.concat(r),"identifier",!0)),[n,r]}w(Lt,st,{handler:function(t){var e=Ot[t.type];if(e===G&&(this.started=!0),this.started){var n=It.call(this,t,e);e&(X|Y)&&n[0].length-n[1].length===0&&(this.started=!1),this.callback(this.manager,e,{pointers:n[0],changedPointers:n[1],pointerType:U,srcEvent:t})}}});var Nt={touchstart:G,touchmove:H,touchend:X,touchcancel:Y},Dt="touchstart touchmove touchend touchcancel";function Rt(){this.evTarget=Dt,this.targetIds={},st.apply(this,arguments)}function Ft(t,e){var n=T(t.touches),r=this.targetIds;if(e&(G|H)&&1===n.length)return r[n[0].identifier]=!0,[n,n];var i,o,s=T(t.changedTouches),a=[],u=this.target;if(o=n.filter((function(t){return C(t.target,u)})),e===G){i=0;while(i<o.length)r[o[i].identifier]=!0,i++}i=0;while(i<s.length)r[s[i].identifier]&&a.push(s[i]),e&(X|Y)&&delete r[s[i].identifier],i++;return a.length?[L(o.concat(a),"identifier",!0),a]:void 0}w(Rt,st,{handler:function(t){var e=Nt[t.type],n=Ft.call(this,t,e);n&&this.callback(this.manager,e,{pointers:n[0],changedPointers:n[1],pointerType:U,srcEvent:t})}});var Bt=2500,jt=25;function zt(){st.apply(this,arguments);var t=x(this.handler,this);this.touch=new Rt(this.manager,t),this.mouse=new St(this.manager,t),this.primaryTouch=null,this.lastTouches=[]}function Ut(t,e){t&G?(this.primaryTouch=e.changedPointers[0].identifier,$t.call(this,e)):t&(X|Y)&&$t.call(this,e)}function $t(t){var e=t.changedPointers[0];if(e.identifier===this.primaryTouch){var n={x:e.clientX,y:e.clientY};this.lastTouches.push(n);var r=this.lastTouches,i=function(){var t=r.indexOf(n);t>-1&&r.splice(t,1)};setTimeout(i,Bt)}}function Vt(t){for(var e=t.srcEvent.clientX,n=t.srcEvent.clientY,r=0;r<this.lastTouches.length;r++){var i=this.lastTouches[r],o=Math.abs(e-i.x),s=Math.abs(n-i.y);if(o<=jt&&s<=jt)return!0}return!1}w(zt,st,{handler:function(t,e,n){var r=n.pointerType==U,i=n.pointerType==V;if(!(i&&n.sourceCapabilities&&n.sourceCapabilities.firesTouchEvents)){if(r)Ut.call(this,e,n);else if(i&&Vt.call(this,n))return;this.callback(t,e,n)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var qt=I(l.style,"touchAction"),Wt=qt!==a,Gt="compute",Ht="auto",Xt="manipulation",Yt="none",Zt="pan-x",Kt="pan-y",Jt=ee();function Qt(t,e){this.manager=t,this.set(e)}function te(t){if(k(t,Yt))return Yt;var e=k(t,Zt),n=k(t,Kt);return e&&n?Yt:e||n?e?Zt:Kt:k(t,Xt)?Xt:Ht}function ee(){if(!Wt)return!1;var t={},e=i.CSS&&i.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach((function(n){t[n]=!e||i.CSS.supports("touch-action",n)})),t}Qt.prototype={set:function(t){t==Gt&&(t=this.compute()),Wt&&this.manager.element.style&&Jt[t]&&(this.manager.element.style[qt]=t),this.actions=t.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var t=[];return y(this.manager.recognizers,(function(e){S(e.options.enable,[e])&&(t=t.concat(e.getTouchAction()))})),te(t.join(" "))},preventDefaults:function(t){var e=t.srcEvent,n=t.offsetDirection;if(this.manager.session.prevented)e.preventDefault();else{var r=this.actions,i=k(r,Yt)&&!Jt[Yt],o=k(r,Kt)&&!Jt[Kt],s=k(r,Zt)&&!Jt[Zt];if(i){var a=1===t.pointers.length,u=t.distance<2,c=t.deltaTime<250;if(a&&u&&c)return}if(!s||!o)return i||o&&n&et||s&&n&nt?this.preventSrc(e):void 0}},preventSrc:function(t){this.manager.session.prevented=!0,t.preventDefault()}};var ne=1,re=2,ie=4,oe=8,se=oe,ae=16,ue=32;function ce(t){this.options=u({},this.defaults,t||{}),this.id=D(),this.manager=null,this.options.enable=E(this.options.enable,!0),this.state=ne,this.simultaneous={},this.requireFail=[]}function le(t){return t&ae?"cancel":t&oe?"end":t&ie?"move":t&re?"start":""}function he(t){return t==tt?"down":t==Q?"up":t==K?"left":t==J?"right":""}function fe(t,e){var n=e.manager;return n?n.get(t):t}function de(){ce.apply(this,arguments)}function pe(){de.apply(this,arguments),this.pX=null,this.pY=null}function ge(){de.apply(this,arguments)}function me(){ce.apply(this,arguments),this._timer=null,this._input=null}function ye(){de.apply(this,arguments)}function ve(){de.apply(this,arguments)}function be(){ce.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function _e(t,e){return e=e||{},e.recognizers=E(e.recognizers,_e.defaults.preset),new Se(t,e)}ce.prototype={defaults:{},set:function(t){return u(this.options,t),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(t){if(m(t,"recognizeWith",this))return this;var e=this.simultaneous;return t=fe(t,this),e[t.id]||(e[t.id]=t,t.recognizeWith(this)),this},dropRecognizeWith:function(t){return m(t,"dropRecognizeWith",this)?this:(t=fe(t,this),delete this.simultaneous[t.id],this)},requireFailure:function(t){if(m(t,"requireFailure",this))return this;var e=this.requireFail;return t=fe(t,this),-1===P(e,t)&&(e.push(t),t.requireFailure(this)),this},dropRequireFailure:function(t){if(m(t,"dropRequireFailure",this))return this;t=fe(t,this);var e=P(this.requireFail,t);return e>-1&&this.requireFail.splice(e,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(t){return!!this.simultaneous[t.id]},emit:function(t){var e=this,n=this.state;function r(n){e.manager.emit(n,t)}n<oe&&r(e.options.event+le(n)),r(e.options.event),t.additionalEvent&&r(t.additionalEvent),n>=oe&&r(e.options.event+le(n))},tryEmit:function(t){if(this.canEmit())return this.emit(t);this.state=ue},canEmit:function(){var t=0;while(t<this.requireFail.length){if(!(this.requireFail[t].state&(ue|ne)))return!1;t++}return!0},recognize:function(t){var e=u({},t);if(!S(this.options.enable,[this,e]))return this.reset(),void(this.state=ue);this.state&(se|ae|ue)&&(this.state=ne),this.state=this.process(e),this.state&(re|ie|oe|ae)&&this.tryEmit(e)},process:function(t){},getTouchAction:function(){},reset:function(){}},w(de,ce,{defaults:{pointers:1},attrTest:function(t){var e=this.options.pointers;return 0===e||t.pointers.length===e},process:function(t){var e=this.state,n=t.eventType,r=e&(re|ie),i=this.attrTest(t);return r&&(n&Y||!i)?e|ae:r||i?n&X?e|oe:e&re?e|ie:re:ue}}),w(pe,de,{defaults:{event:"pan",threshold:10,pointers:1,direction:rt},getTouchAction:function(){var t=this.options.direction,e=[];return t&et&&e.push(Kt),t&nt&&e.push(Zt),e},directionTest:function(t){var e=this.options,n=!0,r=t.distance,i=t.direction,o=t.deltaX,s=t.deltaY;return i&e.direction||(e.direction&et?(i=0===o?Z:o<0?K:J,n=o!=this.pX,r=Math.abs(t.deltaX)):(i=0===s?Z:s<0?Q:tt,n=s!=this.pY,r=Math.abs(t.deltaY))),t.direction=i,n&&r>e.threshold&&i&e.direction},attrTest:function(t){return de.prototype.attrTest.call(this,t)&&(this.state&re||!(this.state&re)&&this.directionTest(t))},emit:function(t){this.pX=t.deltaX,this.pY=t.deltaY;var e=he(t.direction);e&&(t.additionalEvent=this.options.event+e),this._super.emit.call(this,t)}}),w(ge,de,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[Yt]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.scale-1)>this.options.threshold||this.state&re)},emit:function(t){if(1!==t.scale){var e=t.scale<1?"in":"out";t.additionalEvent=this.options.event+e}this._super.emit.call(this,t)}}),w(me,ce,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[Ht]},process:function(t){var e=this.options,n=t.pointers.length===e.pointers,r=t.distance<e.threshold,i=t.deltaTime>e.time;if(this._input=t,!r||!n||t.eventType&(X|Y)&&!i)this.reset();else if(t.eventType&G)this.reset(),this._timer=g((function(){this.state=se,this.tryEmit()}),e.time,this);else if(t.eventType&X)return se;return ue},reset:function(){clearTimeout(this._timer)},emit:function(t){this.state===se&&(t&&t.eventType&X?this.manager.emit(this.options.event+"up",t):(this._input.timeStamp=p(),this.manager.emit(this.options.event,this._input)))}}),w(ye,de,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[Yt]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.rotation)>this.options.threshold||this.state&re)}}),w(ve,de,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:et|nt,pointers:1},getTouchAction:function(){return pe.prototype.getTouchAction.call(this)},attrTest:function(t){var e,n=this.options.direction;return n&(et|nt)?e=t.overallVelocity:n&et?e=t.overallVelocityX:n&nt&&(e=t.overallVelocityY),this._super.attrTest.call(this,t)&&n&t.offsetDirection&&t.distance>this.options.threshold&&t.maxPointers==this.options.pointers&&d(e)>this.options.velocity&&t.eventType&X},emit:function(t){var e=he(t.offsetDirection);e&&this.manager.emit(this.options.event+e,t),this.manager.emit(this.options.event,t)}}),w(be,ce,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[Xt]},process:function(t){var e=this.options,n=t.pointers.length===e.pointers,r=t.distance<e.threshold,i=t.deltaTime<e.time;if(this.reset(),t.eventType&G&&0===this.count)return this.failTimeout();if(r&&i&&n){if(t.eventType!=X)return this.failTimeout();var o=!this.pTime||t.timeStamp-this.pTime<e.interval,s=!this.pCenter||mt(this.pCenter,t.center)<e.posThreshold;this.pTime=t.timeStamp,this.pCenter=t.center,s&&o?this.count+=1:this.count=1,this._input=t;var a=this.count%e.taps;if(0===a)return this.hasRequireFailures()?(this._timer=g((function(){this.state=se,this.tryEmit()}),e.interval,this),re):se}return ue},failTimeout:function(){return this._timer=g((function(){this.state=ue}),this.options.interval,this),ue},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==se&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),_e.VERSION="2.0.7",_e.defaults={domEvents:!1,touchAction:Gt,enable:!0,inputTarget:null,inputClass:null,preset:[[ye,{enable:!1}],[ge,{enable:!1},["rotate"]],[ve,{direction:et}],[pe,{direction:et},["swipe"]],[be],[be,{event:"doubletap",taps:2},["tap"]],[me]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var we=1,xe=2;function Se(t,e){this.options=u({},_e.defaults,e||{}),this.options.inputTarget=this.options.inputTarget||t,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=t,this.input=at(this),this.touchAction=new Qt(this,this.options.touchAction),Ee(this,!0),y(this.options.recognizers,(function(t){var e=this.add(new t[0](t[1]));t[2]&&e.recognizeWith(t[2]),t[3]&&e.requireFailure(t[3])}),this)}function Ee(t,e){var n,r=t.element;r.style&&(y(t.options.cssProps,(function(i,o){n=I(r.style,o),e?(t.oldCssProps[n]=r.style[n],r.style[n]=i):r.style[n]=t.oldCssProps[n]||""})),e||(t.oldCssProps={}))}function Ae(t,e){var n=o.createEvent("Event");n.initEvent(t,!0,!0),n.gesture=e,e.target.dispatchEvent(n)}Se.prototype={set:function(t){return u(this.options,t),t.touchAction&&this.touchAction.update(),t.inputTarget&&(this.input.destroy(),this.input.target=t.inputTarget,this.input.init()),this},stop:function(t){this.session.stopped=t?xe:we},recognize:function(t){var e=this.session;if(!e.stopped){var n;this.touchAction.preventDefaults(t);var r=this.recognizers,i=e.curRecognizer;(!i||i&&i.state&se)&&(i=e.curRecognizer=null);var o=0;while(o<r.length)n=r[o],e.stopped===xe||i&&n!=i&&!n.canRecognizeWith(i)?n.reset():n.recognize(t),!i&&n.state&(re|ie|oe)&&(i=e.curRecognizer=n),o++}},get:function(t){if(t instanceof ce)return t;for(var e=this.recognizers,n=0;n<e.length;n++)if(e[n].options.event==t)return e[n];return null},add:function(t){if(m(t,"add",this))return this;var e=this.get(t.options.event);return e&&this.remove(e),this.recognizers.push(t),t.manager=this,this.touchAction.update(),t},remove:function(t){if(m(t,"remove",this))return this;if(t=this.get(t),t){var e=this.recognizers,n=P(e,t);-1!==n&&(e.splice(n,1),this.touchAction.update())}return this},on:function(t,e){if(t!==a&&e!==a){var n=this.handlers;return y(O(t),(function(t){n[t]=n[t]||[],n[t].push(e)})),this}},off:function(t,e){if(t!==a){var n=this.handlers;return y(O(t),(function(t){e?n[t]&&n[t].splice(P(n[t],e),1):delete n[t]})),this}},emit:function(t,e){this.options.domEvents&&Ae(t,e);var n=this.handlers[t]&&this.handlers[t].slice();if(n&&n.length){e.type=t,e.preventDefault=function(){e.srcEvent.preventDefault()};var r=0;while(r<n.length)n[r](e),r++}},destroy:function(){this.element&&Ee(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},u(_e,{INPUT_START:G,INPUT_MOVE:H,INPUT_END:X,INPUT_CANCEL:Y,STATE_POSSIBLE:ne,STATE_BEGAN:re,STATE_CHANGED:ie,STATE_ENDED:oe,STATE_RECOGNIZED:se,STATE_CANCELLED:ae,STATE_FAILED:ue,DIRECTION_NONE:Z,DIRECTION_LEFT:K,DIRECTION_RIGHT:J,DIRECTION_UP:Q,DIRECTION_DOWN:tt,DIRECTION_HORIZONTAL:et,DIRECTION_VERTICAL:nt,DIRECTION_ALL:rt,Manager:Se,Input:st,TouchAction:Qt,TouchInput:Rt,MouseInput:St,PointerEventInput:kt,TouchMouseInput:zt,SingleTouchInput:Lt,Recognizer:ce,AttrRecognizer:de,Tap:be,Pan:pe,Swipe:ve,Pinch:ge,Rotate:ye,Press:me,on:A,off:M,each:y,merge:_,extend:b,assign:u,inherit:w,bindFn:x,prefixed:I});var Me="undefined"!==typeof i?i:"undefined"!==typeof self?self:{};Me.Hammer=_e,r=function(){return _e}.call(e,n,e,t),r===a||(t.exports=r)})(window,document)},c9eb:function(t,e){try{t.exports="undefined"!==typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(n){t.exports=!1}},cb03:function(t,e,n){},cd77:function(t,e,n){"use strict";n.d(e,"a",(function(){return f}));var r=n("e355"),i=n("f87d"),o=n("b52f");class s extends r["a"]{get ELEMENTS(){return Object(o["a"])(!1),0}copy(t){return Object(o["a"])(!1),this}get x(){return this[0]}set x(t){this[0]=Object(i["a"])(t)}get y(){return this[1]}set y(t){this[1]=Object(i["a"])(t)}len(){return Math.sqrt(this.lengthSquared())}magnitude(){return this.len()}lengthSquared(){let t=0;for(let e=0;e<this.ELEMENTS;++e)t+=this[e]*this[e];return t}magnitudeSquared(){return this.lengthSquared()}distance(t){return Math.sqrt(this.distanceSquared(t))}distanceSquared(t){let e=0;for(let n=0;n<this.ELEMENTS;++n){const r=this[n]-t[n];e+=r*r}return Object(i["a"])(e)}dot(t){let e=0;for(let n=0;n<this.ELEMENTS;++n)e+=this[n]*t[n];return Object(i["a"])(e)}normalize(){const t=this.magnitude();if(0!==t)for(let e=0;e<this.ELEMENTS;++e)this[e]/=t;return this.check()}multiply(...t){for(const e of t)for(let t=0;t<this.ELEMENTS;++t)this[t]*=e[t];return this.check()}divide(...t){for(const e of t)for(let t=0;t<this.ELEMENTS;++t)this[t]/=e[t];return this.check()}lengthSq(){return this.lengthSquared()}distanceTo(t){return this.distance(t)}distanceToSquared(t){return this.distanceSquared(t)}getComponent(t){return Object(o["a"])(t>=0&&t<this.ELEMENTS,"index is out of range"),Object(i["a"])(this[t])}setComponent(t,e){return Object(o["a"])(t>=0&&t<this.ELEMENTS,"index is out of range"),this[t]=e,this.check()}addVectors(t,e){return this.copy(t).add(e)}subVectors(t,e){return this.copy(t).subtract(e)}multiplyVectors(t,e){return this.copy(t).multiply(e)}addScaledVector(t,e){return this.add(new this.constructor(t).multiplyScalar(e))}}var a=n("6b74"),u=n("323f"),c=n("b128");const l=[0,0,0],h={};class f extends s{static get ZERO(){return h.ZERO=h.ZERO||Object.freeze(new f(0,0,0,0))}constructor(t=0,e=0,n=0){super(-0,-0,-0),1===arguments.length&&Object(a["f"])(t)?this.copy(t):(a["b"].debug&&(Object(i["a"])(t),Object(i["a"])(e),Object(i["a"])(n)),this[0]=t,this[1]=e,this[2]=n)}set(t,e,n){return this[0]=t,this[1]=e,this[2]=n,this.check()}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this.check()}fromObject(t){return a["b"].debug&&(Object(i["a"])(t.x),Object(i["a"])(t.y),Object(i["a"])(t.z)),this[0]=t.x,this[1]=t.y,this[2]=t.z,this.check()}toObject(t){return t.x=this[0],t.y=this[1],t.z=this[2],t}get ELEMENTS(){return 3}get z(){return this[2]}set z(t){this[2]=Object(i["a"])(t)}angle(t){return u["a"](this,t)}cross(t){return u["b"](this,this,t),this.check()}rotateX({radians:t,origin:e=l}){return u["d"](this,this,e,t),this.check()}rotateY({radians:t,origin:e=l}){return u["e"](this,this,e,t),this.check()}rotateZ({radians:t,origin:e=l}){return u["f"](this,this,e,t),this.check()}transform(t){return this.transformAsPoint(t)}transformAsPoint(t){return u["h"](this,this,t),this.check()}transformAsVector(t){return Object(c["c"])(this,this,t),this.check()}transformByMatrix3(t){return u["g"](this,this,t),this.check()}transformByMatrix2(t){return Object(c["b"])(this,this,t),this.check()}transformByQuaternion(t){return u["i"](this,this,t),this.check()}}},cedc:function(t,e,n){},cee4:function(t,e,n){"use strict";var r=n("c532"),i=n("1d2b"),o=n("0a06"),s=n("4a7b"),a=n("2444");function u(t){var e=new o(t),n=i(o.prototype.request,e);return r.extend(n,o.prototype,e),r.extend(n,e),n.create=function(e){return u(s(t,e))},n}var c=u(a);c.Axios=o,c.Cancel=n("7a77"),c.CancelToken=n("8df4"),c.isCancel=n("2e67"),c.VERSION=n("5cce").version,c.all=function(t){return Promise.all(t)},c.spread=n("0df6"),c.isAxiosError=n("5f02"),t.exports=c,t.exports.default=c},cf42:function(t,e){},d01e6:function(t,e,n){"use strict";n.r(e),n.d(e,"colorSchemes",(function(){return kn})),n.d(e,"constants",(function(){return r})),n.d(e,"searchExpression",(function(){return i})),n.d(e,"specs",(function(){return f})),n.d(e,"types",(function(){return N})),n.d(e,"use",(function(){return Nr})),n.d(e,"util",(function(){return h})),n.d(e,"VegaDeckGl",(function(){return l})),n.d(e,"Viewer",(function(){return Lr})),n.d(e,"version",(function(){return Ir}));var r={};n.r(r),n.d(r,"ColorScaleNone",(function(){return f["ColorScaleNone"]})),n.d(r,"FieldNames",(function(){return f["FieldNames"]})),n.d(r,"ScaleNames",(function(){return f["ScaleNames"]})),n.d(r,"SignalNames",(function(){return f["SignalNames"]})),n.d(r,"GL_ORDINAL",(function(){return d}));var i={};n.r(i),n.d(i,"compareExpression",(function(){return v})),n.d(i,"compareGroup",(function(){return _})),n.d(i,"compare",(function(){return w})),n.d(i,"startsWith",(function(){return x})),n.d(i,"Exec",(function(){return C})),n.d(i,"isSearchExpressionGroup",(function(){return p})),n.d(i,"createGroupFromExpression",(function(){return g})),n.d(i,"ensureSearchExpressionGroupArray",(function(){return m})),n.d(i,"invert",(function(){return L})),n.d(i,"narrow",(function(){return I}));var o={};n.r(o),n.d(o,"layerNames",(function(){return D}));var s={};n.r(s),n.d(s,"Table",(function(){return rt}));var a={};n.r(a),n.d(a,"default",(function(){return St}));var u={};n.r(u),n.d(u,"minHeight",(function(){return Ut})),n.d(u,"minWidth",(function(){return $t})),n.d(u,"defaultPresenterStyle",(function(){return Vt})),n.d(u,"defaultPresenterConfig",(function(){return qt})),n.d(u,"createStage",(function(){return Wt})),n.d(u,"groupStrokeWidth",(function(){return Gt})),n.d(u,"lineZ",(function(){return Ht})),n.d(u,"defaultView",(function(){return Xt})),n.d(u,"min3dDepth",(function(){return Yt})),n.d(u,"minPixelSize",(function(){return Zt}));var c={};n.r(c),n.d(c,"addDiv",(function(){return ct})),n.d(c,"addEl",(function(){return ut})),n.d(c,"allTruthy",(function(){return st})),n.d(c,"clone",(function(){return At})),n.d(c,"colorFromString",(function(){return Tt})),n.d(c,"colorIsEqual",(function(){return Pt})),n.d(c,"colorToString",(function(){return Lt})),n.d(c,"concat",(function(){return ot})),n.d(c,"createElement",(function(){return V})),n.d(c,"deepMerge",(function(){return Ct})),n.d(c,"desaturate",(function(){return It})),n.d(c,"getActiveElementInfo",(function(){return Q})),n.d(c,"getCubeLayer",(function(){return ve})),n.d(c,"getCubes",(function(){return be})),n.d(c,"mount",(function(){return Y})),n.d(c,"outerSize",(function(){return lt})),n.d(c,"push",(function(){return at})),n.d(c,"setActiveElement",(function(){return J}));var l={};n.r(l),n.d(l,"base",(function(){return Bt})),n.d(l,"use",(function(){return jt})),n.d(l,"Presenter",(function(){return dn})),n.d(l,"ViewGl",(function(){return vn})),n.d(l,"PresenterElement",(function(){return Ce})),n.d(l,"constants",(function(){return o})),n.d(l,"controls",(function(){return s})),n.d(l,"defaults",(function(){return u})),n.d(l,"types",(function(){return it})),n.d(l,"util",(function(){return c}));var h={};n.r(h),n.d(h,"getColumnsFromData",(function(){return f["getColumnsFromData"]})),n.d(h,"getStats",(function(){return f["getStats"]})),n.d(h,"inferAll",(function(){return f["inferAll"]})),n.d(h,"getPresenterStyle",(function(){return Sn})),n.d(h,"isInternalFieldName",(function(){return Mn}));var f=n("826a");const d="GL_ORDINAL";function p(t){return!!t&&!!t.expressions}function g(t){const e={expressions:[t]};return e}function m(t){return Array.isArray(t)?[...t]:p(t)?[t]:[g(t)]}const y=Object.keys({clause:null,name:null,operator:null,value:null});function v(t,e){if(!t||!e)return!t&&!e;for(let n=0;n<y.length;n++){let r=y[n];if(t[r]!=e[r])return!1}return!0}const b=Object.keys({clause:null});function _(t,e){for(let n=0;n<b.length;n++){let r=b[n];if(t[r]!=e[r])return!1}if(!t.expressions&&!e.expressions)return!0;if(!t.expressions||!e.expressions)return!1;if(t.expressions.length!=e.expressions.length)return!1;for(let n=0;n<t.expressions.length;n++)if(!v(t.expressions[n],e.expressions[n]))return!1;return!0}function w(t,e){if(t==e)return!0;if(!t||!e)return!1;let n=[t,e].map(m),[r,i]=n;if(r.length!=i.length)return!1;for(let o=0;o<r.length;o++)if(!_(r[o],i[o]))return!1;return!0}function x(t,e){if(!e)return!0;let n=[t,e].map(m),[r,i]=n;if(i.length>r.length)return!1;for(let o=0;o<i.length;o++)if(!_(r[o],i[o]))return!1;return!0}function S(t){if("string"===typeof t)switch(t.toLowerCase()){case"true":return!0;case"false":return!1}return!!t}function E(t){if(null==t)return"";switch(typeof t){case"string":return t;case"boolean":case"number":return t.toString()}return""}function A(t){switch(t.operator){case"contains":case"!contains":case"starts":case"!starts":return!0}return!1}function M(t){return null==t||"string"===typeof t&&0===t.length}class C{constructor(t,e){this.columns=e,this.groups=m(t).map(t=>{const e=t.expressions.filter(Boolean);e.forEach(t=>{t.column=this.getColumn(t.name),t.valueBool=S(t.value),t.valueLow=E(t.value).toLocaleLowerCase(),t.stringOperation=A(t)});const n=Object.assign(Object.assign({},t),{expressions:e});return n})}getColumn(t){for(let e=0;e<this.columns.length;e++)if(this.columns[e].name==t)return this.columns[e]}runExpressionOnColumn(t,e){const n=t[e.name];if("isnullorEmpty"===e.operator)return M(n);if("!isnullorEmpty"===e.operator)return!M(n);let r=n,i=e.value;switch(e.column&&("string"===e.column.type||e.stringOperation?(r=E(n).toLocaleLowerCase(),i=e.valueLow):"boolean"===e.column.type?(r=S(n),i=e.valueBool):e.column.quantitative&&(r=+n,i=+e.value)),e.operator){case"!=":return r!=i;case"<":return r<i;case"<=":return r<=i;case"==":return r==i;case">":return r>i;case">=":return r>=i;case"contains":return r.indexOf(i)>=0;case"!contains":return r.indexOf(i)<0;case"starts":return 0==r.indexOf(i);case"!starts":return 0!==r.indexOf(i)}}runExpression(t,e){if(null==e.name){const n={expressions:this.columns.map((t,n)=>{const r=Object.assign(Object.assign({},e),{column:t,name:t.name});return n&&(r.clause="||"),r})};return this.runGroup(t,n)}return this.runExpressionOnColumn(t,e)}runGroup(t,e){let n=this.runExpression(t,e.expressions[0]);for(let r=1;r<e.expressions.length;r++){let i=e.expressions[r];switch(i.clause){case"&&":n=n&&this.runExpression(t,i);break;case"||":n=n||this.runExpression(t,i);break}}return n}run(t){let e=this.runGroup(t,this.groups[0]);for(let n=1;n<this.groups.length;n++){let r=this.groups[n];switch(r.clause){case"&&":e=e&&this.runGroup(t,r);break;case"||":e=e||this.runGroup(t,r);break}}return e}}function k(t){const e={expressions:t.expressions.map(T)};return t.clause&&(e.clause=P[t.clause]),e}const O={"!=":"==","==":"!=","<":">=",">=":"<","<=":">",">":"<=","!contains":"contains",contains:"!contains","!isnullorEmpty":"isnullorEmpty",isnullorEmpty:"!isnullorEmpty","!starts":"starts",starts:"!starts"},P={"&&":"||","||":"&&"};function T(t){const e=O[t.operator],n=Object.assign(Object.assign({},t),{operator:e});return t.clause&&(n.clause=P[t.clause]),n}function L(t){return Array.isArray(t)?t.map(k):p(t)?k(t):T(t)}function I(t,e){if(!t)return e;let n=[t,e].map(m),[r,i]=n;return i[0].clause="&&",r.concat(i)}var N=n("0004");const D={cubes:"LAYER_CUBES",lines:"LAYER_LINES",text:"LAYER_TEXT",paths:"LAYER_PATHS",polygons:"LAYER_POLYGONS"};var R=n("b00f"),F=n.n(R),B=n("04d4"),j=n.n(B);const z=F.a||R,U=j.a||B;function $(t,e="-"){return t.replace(/([a-z\d])([A-Z])/g,"$1"+e+"$2").replace(/([A-Z]+)([A-Z][a-z\d]+)/g,"$1"+e+"$2").toLowerCase()}function V(t,e,...n){if("function"===typeof t){const r=t,i=e;return i.children=n,r(i)}{const r=et(t),i=r?document.createElementNS(r,t):document.createElement(t),o=e;let s;for(let t in o)if(t&&o.hasOwnProperty(t)){let e=o[t];if("className"===t&&void 0!==e)q(i,r,"class",e.toString());else if("disabled"!==t||e){if(null===e||void 0===e)continue;!0===e?q(i,r,t,t):"function"===typeof e?"ref"===t?s=e:i[t.toLowerCase()]=e:q(i,r,t,"object"===typeof e?W(e):e.toString())}else;}return n&&n.length>0&&H(i,n),s&&s(i),i}}function q(t,e,n,r){e?t.setAttributeNS(null,n,r):t.setAttribute(n,r)}function W(t){const e=[];for(let n in t)e.push(`${$(n,"-")}:${t[n]}`);return e.join(";")}function G(t,e){null!==e&&void 0!==e&&"boolean"!==typeof e&&(Array.isArray(e)?H(t,e):X(e)?t.appendChild(e):t.appendChild(document.createTextNode(e.toString())))}function H(t,e){e.forEach(e=>G(t,e))}function X(t){return!!t.nodeType}function Y(t,e){e.innerHTML="",t&&G(e,t)}function Z(t,e){let n,r=e||document.body;while(r&&t.length)n=t.shift(),r=r.children.item(n);if(r)return r}function K(t,e){t.focus(),t.scrollTop=e.scrollTop;const n=t;n.setSelectionRange&&e&&null!=e.selectionStart&&null!=e.selectionEnd&&n.setSelectionRange(e.selectionStart,e.selectionEnd,e.selectionDirection)}function J(t,e){if(t){const n=Z(t.childPositions,e);n&&K(n,t)}}function Q(t){let e=document.activeElement;const{scrollTop:n,selectionDirection:r,selectionEnd:i,selectionStart:o}=e,s={childPositions:[],scrollTop:n,selectionDirection:r,selectionEnd:i,selectionStart:o};while(e&&e!==document.body&&e!==t)s.childPositions.unshift(tt(e)),e=e.parentElement;if((e===document.body||e===t)&&s.childPositions.length)return s}function tt(t){let e=0;while(t=t.previousElementSibling)e++;return e}function et(t){if("svg"===t||U.indexOf(t)>=0&&!(z.indexOf(t)>=0))return"http://www.w3.org/2000/svg"}const nt={ENTER:13},rt=t=>{return V("table",{className:t.className},t.children,t.rows.map((e,n)=>V("tr",{className:t.rowClassName||"",onClick:e=>t.onRowClick&&t.onRowClick(e,n),tabIndex:t.onRowClick?0:-1,onKeyUp:e=>{e.keyCode===nt.ENTER&&t.onRowClick&&t.onRowClick(e,n)}},e.cells.map((t,e)=>V("td",{className:t.className||"",title:t.title||""},t.content)))))};var it=n("cf42");function ot(...t){return t.reduce((t,e)=>e?t.concat(e):t,[])}function st(...t){return t.reduce((t,e)=>e?t.concat(e):t,[]).filter(Boolean)}function at(t,e){t.push.apply(t,e)}function ut(t,e){const n=document.createElement(t);return e.appendChild(n),n}function ct(t,e){const n=ut("div",t);return e&&(n.className=e),n}function lt(t){const e=getComputedStyle(t),n=parseFloat(e.marginTop)+parseFloat(e.paddingTop)+parseFloat(e.borderTopWidth)+t.offsetHeight+parseFloat(e.borderBottomWidth)+parseFloat(e.paddingBottom)+parseFloat(e.marginBottom),r=parseFloat(e.marginLeft)+parseFloat(e.paddingLeft)+parseFloat(e.borderLeftWidth)+t.offsetWidth+parseFloat(e.borderRightWidth)+parseFloat(e.paddingRight)+parseFloat(e.marginRight);return{height:n,width:r}}var ht=function(t){return ft(t)&&!dt(t)};function ft(t){return!!t&&"object"===typeof t}function dt(t){var e=Object.prototype.toString.call(t);return"[object RegExp]"===e||"[object Date]"===e||mt(t)}var pt="function"===typeof Symbol&&Symbol.for,gt=pt?Symbol.for("react.element"):60103;function mt(t){return t.$$typeof===gt}function yt(t){return Array.isArray(t)?[]:{}}function vt(t,e){return!1!==e.clone&&e.isMergeableObject(t)?wt(yt(t),t,e):t}function bt(t,e,n){return t.concat(e).map((function(t){return vt(t,n)}))}function _t(t,e,n){var r={};return n.isMergeableObject(t)&&Object.keys(t).forEach((function(e){r[e]=vt(t[e],n)})),Object.keys(e).forEach((function(i){n.isMergeableObject(e[i])&&t[i]?r[i]=wt(t[i],e[i],n):r[i]=vt(e[i],n)})),r}function wt(t,e,n){n=n||{},n.arrayMerge=n.arrayMerge||bt,n.isMergeableObject=n.isMergeableObject||ht;var r=Array.isArray(e),i=Array.isArray(t),o=r===i;return o?r?n.arrayMerge(t,e,n):_t(t,e,n):vt(e,n)}wt.all=function(t,e){if(!Array.isArray(t))throw new Error("first argument should be an array");return t.reduce((function(t,n){return wt(t,n,e)}),{})};var xt=wt,St=xt;const Et=St||a;function At(t){return t?Et.all([t]):t}const Mt=(t,e)=>e;function Ct(...t){const e=t.filter(Boolean);return Et.all(e,{arrayMerge:Mt})}var kt=n("166a");function Ot(t){return[t.r,t.g,t.b,255*t.opacity]}function Pt(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}function Tt(t){if(t){const e=Object(kt["e"])(t);if(e){const t=e.rgb();return Ot(t)}}}function Lt(t){const e=[...t];return e.length>3&&(e[3]/=255),`rgba(${e.join(",")})`}function It(t,e){const n=Object(kt["g"])(t[0],t[1],t[2],t[3]/255),r=Object(kt["f"])(n);r.s=e;const i=r.rgb();return Ot(i)}let Nt={CanvasHandler:null,inferType:null,inferTypes:null,loader:null,parse:null,read:null,renderModule:null,Renderer:null,sceneVisit:null,scheme:null,truncate:null,View:null},Dt={_CameraLight:null,AmbientLight:null,CompositeLayer:null,COORDINATE_SYSTEM:null,Deck:null,DirectionalLight:null,Layer:null,LightingEffect:null,LinearInterpolator:null,OrbitView:null,OrbitController:null,gouraudLighting:null,picking:null,project32:null},Rt={IconLayer:null,LineLayer:null,PathLayer:null,PolygonLayer:null,TextLayer:null},Ft={CubeGeometry:null,Model:null,Texture2D:null};const Bt={deck:Dt,layers:Rt,luma:Ft,vega:Nt};function jt(t,e,n,r){Bt.deck=e,Bt.layers=n,Bt.luma=r,Bt.vega=t}var zt="#define SHADER_NAME cube-layer-fragment-shader\n\nprecision highp float;\n\nvarying vec4 vColor;\n\nvoid main(void) {\n  gl_FragColor = vColor;\n\n  // use highlight color if this fragment belongs to the selected object.\n  gl_FragColor = picking_filterHighlightColor(gl_FragColor);\n\n  // use picking color if rendering to picking FBO.\n  gl_FragColor = picking_filterPickingColor(gl_FragColor);\n}\n";const Ut="100px",$t="100px",Vt={cssPrefix:"vega-deckgl-",defaultCubeColor:[128,128,128,255],highlightColor:[0,0,0,255]},qt={onCubeClick:(t,e)=>{},onCubeHover:(t,e)=>{},transitionDurations:{color:100,position:600,size:600,view:600}};function Wt(t){const e={view:t,cubeData:[],pathData:[],polygonData:[],axes:{x:[],y:[],z:[]},gridLines:[],textData:[],legend:{rows:{}},facets:[]};return e}const Gt=1,Ht=-1,Xt="2d",Yt=.05,Zt=.5;var Kt=`#define SHADER_NAME cube-layer-vertex-shader\n\nattribute vec3 positions;\nattribute vec3 normals;\n\nattribute vec3 instancePositions;\nattribute vec3 instancePositions64Low;\nattribute vec3 instanceSizes;\nattribute vec4 instanceColors;\nattribute vec3 instancePickingColors;\n\n// Custom uniforms\nuniform float lightingMix;\n\n// Result\nvarying vec4 vColor;\n\nvoid main(void) {\n\n  float x = instanceSizes.x > 0.0 ? max(instanceSizes.x, ${Zt.toFixed(1)}) : 0.0;\n  float y = instanceSizes.y > 0.0 ? max(instanceSizes.y, ${Zt.toFixed(1)}) : 0.0;\n\n  // if alpha == 0.0, do not render element\n  float noRender = float(instanceColors.a == 0.0);\n  float finalXScale = project_size(x) * mix(1.0, 0.0, noRender);\n  float finalYScale = project_size(y) * mix(1.0, 0.0, noRender);\n  float finalZScale = project_size(instanceSizes.z) * mix(1.0, 0.0, noRender);\n\n  // cube geometry vertics are between -1 to 1, scale and transform it to between 0, 1\n  vec3 offset = vec3(\n    (positions.x + 1.0) / 2.0 * finalXScale,\n    (positions.y + 1.0) / 2.0 * finalYScale,\n    (positions.z + 1.0) / 2.0 * finalZScale);\n\n  // extrude positions\n  vec4 position_worldspace;\n  gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset, position_worldspace);\n  \n  vec3 lightColor = lighting_getLightColor(instanceColors.rgb, project_uCameraPosition, position_worldspace.xyz, project_normal(normals));\n  vec3 mixedLight = mix(instanceColors.rgb, lightColor, lightingMix);\n  vec4 color = vec4(mixedLight, instanceColors.a) / 255.0;\n  vColor = color;\n\n  // Set color to be rendered to picking fbo (also used to check for selection highlight).\n  picking_setPickingColor(instancePickingColors);\n}\n`;const Jt=5121,Qt=5130,te=[255,0,255,255],ee={lightingMix:.5,getSize:t=>t.size,getPosition:t=>t.position,getColor:t=>t.color,material:{ambient:.5,diffuse:1}};function ne(t){class e extends Bt.deck.Layer{getShaders(){return{vs:Kt,fs:zt,modules:[Bt.deck.project32,Bt.deck.gouraudLighting,Bt.deck.picking]}}initializeState(){const t=this.getAttributeManager();t.addInstanced({instancePositions:{size:3,type:Qt,transition:!0,accessor:"getPosition"},instanceSizes:{size:3,transition:!0,accessor:"getSize"},instanceColors:{size:4,type:Jt,transition:!0,accessor:"getColor",defaultValue:te}})}updateState({props:t,oldProps:e,changeFlags:n}){super.updateState({props:t,oldProps:e,changeFlags:n});const{gl:r}=this.context;this.state.model&&this.state.model.delete(),this.setState({model:this._getModel(r)}),this.getAttributeManager().invalidateAll()}_getModel(t){return new Bt.luma.Model(t,Object.assign({},this.getShaders(),{id:this.props.id,geometry:new Bt.luma.CubeGeometry,isInstanced:!0}))}draw({uniforms:t}){let{lightingMix:e}=this.props;this.props.interpolator&&this.props.interpolator.layerInterpolatedProps&&(e=this.props.interpolator.layerInterpolatedProps.lightingMix),this.state.model.setUniforms(Object.assign({},t,{lightingMix:e})).draw()}}e.layerName="CubeLayer",e.defaultProps=ee;const n=new e(t);return n}const re=ne;var ie=3;(function t(e){function n(t){return Math.pow(t,e)}return e=+e,n.exponent=t,n})(ie),function t(e){function n(t){return 1-Math.pow(1-t,e)}return e=+e,n.exponent=t,n}(ie),function t(e){function n(t){return((t*=2)<=1?Math.pow(t,e):2-Math.pow(2-t,e))/2}return e=+e,n.exponent=t,n}(ie),Math.PI;function oe(t){return((t*=2)<=1?Math.pow(2,10*t-10):2-Math.pow(2,10-10*t))/2}var se=1.70158,ae=(function t(e){function n(t){return t*t*((e+1)*t-e)}return e=+e,n.overshoot=t,n}(se),function t(e){function n(t){return--t*t*((e+1)*t+e)+1}return e=+e,n.overshoot=t,n}(se),function t(e){function n(t){return((t*=2)<1?t*t*((e+1)*t-e):(t-=2)*t*((e+1)*t+e)+2)/2}return e=+e,n.overshoot=t,n}(se),2*Math.PI),ue=1,ce=.3;(function t(e,n){var r=Math.asin(1/(e=Math.max(1,e)))*(n/=ae);function i(t){return e*Math.pow(2,10*--t)*Math.sin((r-t)/n)}return i.amplitude=function(e){return t(e,n*ae)},i.period=function(n){return t(e,n)},i})(ue,ce),function t(e,n){var r=Math.asin(1/(e=Math.max(1,e)))*(n/=ae);function i(t){return 1-e*Math.pow(2,-10*(t=+t))*Math.sin((t+r)/n)}return i.amplitude=function(e){return t(e,n*ae)},i.period=function(n){return t(e,n)},i}(ue,ce),function t(e,n){var r=Math.asin(1/(e=Math.max(1,e)))*(n/=ae);function i(t){return((t=2*t-1)<0?e*Math.pow(2,10*t)*Math.sin((r-t)/n):2-e*Math.pow(2,-10*t)*Math.sin((r+t)/n))/2}return i.amplitude=function(e){return t(e,n*ae)},i.period=function(n){return t(e,n)},i}(ue,ce);function le(t){return 0===t||1===t?t:oe(t)}function he(t,e,n,r,i,o,s){const a=fe(t,e,n.cubeData,t.style.highlightColor,r,i,o),{x:u,y:c,z:l}=n.axes,h=ot(n.gridLines,s),f=[...n.textData];let d;[u,c,l].forEach(t=>{t.forEach(t=>{t.domain&&h.push(t.domain),t.ticks&&h.push.apply(h,t.ticks),t.tickText&&f.push.apply(f,t.tickText),t.title&&f.push(t.title)})}),d=e.getCharacterSet?e.getCharacterSet(n):new Array(95).fill(1).map((t,e)=>String.fromCharCode(32+e)),n.facets&&n.facets.forEach(t=>{t.lines&&h.push.apply(h,t.lines)});const p=de(D.lines,h),g=me(t,D.text,f,e,t.style.fontFamily,d),m=pe(D.paths,n.pathData),y=ge(D.polygons,n.polygonData);return[g,a,p,m,y]}function fe(t,e,n,r,i,o,s){const a=ye(e.transitionDurations.position,le),u=ye(e.transitionDurations.size,le),c=ye(e.transitionDurations.color),l={interpolator:s,lightingMix:o,id:D.cubes,data:n,coordinateSystem:Bt.deck.COORDINATE_SYSTEM.CARTESIAN,pickable:!0,autoHighlight:!0,highlightColor:r,onClick:(t,n)=>{e.onCubeClick(n&&n.srcEvent,t.object)},onHover:(n,r)=>{-1===n.index?(t.deckgl.interactiveState.onCube=!1,e.onCubeHover(r&&r.srcEvent,null)):(t.deckgl.interactiveState.onCube=!0,e.onCubeHover(r&&r.srcEvent,n.object))},transitions:{getPosition:a,getColor:c,getSize:u}};return new re(l)}function de(t,e){return new Bt.layers.LineLayer({id:t,data:e,widthUnits:"pixels",coordinateSystem:Bt.deck.COORDINATE_SYSTEM.CARTESIAN,getColor:t=>t.color,getWidth:t=>t.strokeWidth})}function pe(t,e){return e?new Bt.layers.PathLayer({id:t,data:e,billboard:!0,widthScale:1,widthMinPixels:2,widthUnits:"pixels",coordinateSystem:Bt.deck.COORDINATE_SYSTEM.CARTESIAN,getPath:t=>t.positions,getColor:t=>t.strokeColor,getWidth:t=>t.strokeWidth}):null}function ge(t,e){if(!e)return null;let n=new Bt.layers.PolygonLayer({id:t,data:e,coordinateSystem:Bt.deck.COORDINATE_SYSTEM.CARTESIAN,getPolygon:t=>t.positions,getFillColor:t=>t.fillColor,getLineColor:t=>t.strokeColor,wireframe:!1,filled:!0,stroked:!0,pickable:!0,extruded:!0,getElevation:t=>t.depth,getLineWidth:t=>t.strokeWidth});return n}function me(t,e,n,r,i,o){let s=r.getTextHighlightAlphaCutoff&&r.getTextHighlightAlphaCutoff();void 0===s&&(s=.1);const a={id:e,data:n,characterSet:o,coordinateSystem:Bt.deck.COORDINATE_SYSTEM.CARTESIAN,sizeUnits:"pixels",autoHighlight:!0,pickable:!0,highlightColor:t=>{return r.getTextHighlightColor?r.getTextHighlightColor(t.object):[0,0,0,0]},onClick:(t,e)=>{let n=e&&e.srcEvent;r.onTextClick&&r.onTextClick(n,t.object)},onHover:(e,n)=>{-1===e.index?t.deckgl.interactiveState.onText=!1:t.deckgl.interactiveState.onText=!r.onTextHover||r.onTextHover(n&&n.srcEvent,e.object)},getColor:r.getTextColor||(t=>t.color),getTextAnchor:t=>t.textAnchor,getSize:t=>t.size,getAngle:t=>t.angle,fontSettings:{sdf:!1,fontSize:128,buffer:3},_subLayerProps:{characters:{alphaCutoff:s}}};return i&&(a.fontFamily=i),new Bt.layers.TextLayer(a)}function ye(t,e){let n;return t&&(n={duration:t,type:"interpolation"},e&&(n.easing=e)),n}function ve(t){return t.layers.filter(t=>t&&t.id===D.cubes)[0]}function be(t){const e=ve(t);if(!e)return;const n=e.props;return n.data}function _e(t){function e(e){class n extends Bt.deck.OrbitController{constructor(t){super(t),this.invertPan=!0}handleEvent(e){return"doubletap"===e.type&&t&&t.doubleClickHandler?t.doubleClickHandler(e,this):super.handleEvent(e)}}const r=new n(e);return r}return e}const we={position:"absolute",left:0,top:0,width:"100%",height:"100%"};function xe(t){let{container:e=document.body}=t;if("string"===typeof e&&(e=document.getElementById(e)),!e)throw Error("Deck: container not found");const n=window.getComputedStyle(e);"static"===n.position&&(e.style.position="relative");const r=document.createElement("canvas");return e.appendChild(r),Object.assign(r.style,we),{container:e,deckCanvas:r}}function Se(t){const e=_e(t);function n(t){class n extends Bt.deck.Deck{constructor(t){if("undefined"===typeof document)throw Error("Deck can only be used in the browser");const{deckCanvas:n}=xe(t),r=t.initialViewState||t.viewState||{};super(Object.assign({},t,{width:"100%",height:"100%",canvas:n,controller:e,initialViewState:r})),this._updateViewState=t=>{this.onViewStateChange&&this.onViewStateChange(t)}}setProps(t){"onViewStateChange"in t&&this._updateViewState&&(this.onViewStateChange=t.onViewStateChange,t.onViewStateChange=this._updateViewState),super.setProps(t)}}const r=new n(t);return r}return{OrbitControllerClass:e,DeckGL_Class:n}}function Ee(t){class e extends Bt.deck.LinearInterpolator{constructor(t){super(t)}interpolateProps(t,e,n){return this.layerStartProps&&this.layerEndProps&&(this.layerInterpolatedProps=super.interpolateProps(this.layerStartProps,this.layerEndProps,n)),super.interpolateProps(t,e,n)}}const n=new e(t);return n}const Ae=Ee;function Me(){const t=new Bt.deck.AmbientLight({color:[255,255,255],intensity:.3}),e=new Bt.deck._CameraLight({color:[255,255,255],intensity:1});return[new Bt.deck.LightingEffect({ambientLight:t,cameraLight:e})]}var Ce;(function(t){t[t["root"]=0]="root",t[t["gl"]=1]="gl",t[t["panel"]=2]="panel",t[t["legend"]=3]="legend",t[t["vegaControls"]=4]="vegaControls"})(Ce||(Ce={}));const ke=t=>{const e=[],n=(t,n)=>{const r=Oe[t.symbol.shape];let i;i=r?r(t.symbol):V("span",null,"x"),e.push({cells:[{className:"symbol",content:i},{className:"label",content:t.label,title:t.label}]})};var r=Object.keys(t.legend.rows).sort((t,e)=>+t-+e);if(r.forEach(e=>n(t.legend.rows[e],+e)),r.length)return V(rt,{rows:e,rowClassName:"legend-row",onRowClick:(e,n)=>t.onClick(e,t.legend,n)},void 0!==t.legend.title&&V("tr",{onClick:e=>t.onClick(e,t.legend,null)},V("th",{colSpan:2},t.legend.title)))},Oe={square:function(t){return V("div",{style:{height:`${t.bounds.y2-t.bounds.y1}px`,width:`${t.bounds.x2-t.bounds.x1}px`,backgroundColor:t.fill,borderColor:t.fill}})}};function Pe(t){let e=-t[1];t[0]===Ht&&(t[0]=0),t[1]=t[2],t[2]=e}const Te=(t,e,n,r,i,o)=>{Bt.vega.sceneVisit(n,(function(n){var o,s,a,u;o=n.x||0,s=n.y||0,a=null!=n.x2?n.x2:o,u=null!=n.y2?n.y2:s;const c=Le(o+r,s+i,a+r,u+i,n.stroke,n.strokeWidth);"axis-tick"===n.mark.role?("z"===t.currAxis.role&&(Pe(c.sourcePosition),Pe(c.targetPosition)),t.currAxis.ticks.push(c)):"axis-domain"===n.mark.role?("z"===t.currAxis.role&&(Pe(c.sourcePosition),Pe(c.targetPosition)),t.currAxis.domain=c):e.gridLines.push(c)}))};function Le(t,e,n,r,i,o){const s={sourcePosition:[t,-e,Ht],targetPosition:[n,-r,Ht],color:Tt(i),strokeWidth:o};return s}function Ie(t,e,n,r,i,o,s=!1){const a=[Le(t,e,t+r,e,i,o),Le(t+r,e,t+r,e+n,i,o),Le(t+r,e+n,t,e+n,i,o),Le(t,e+n,t,e,i,o)];return s&&(a.push(Le(t,e,t+r,e+n,i,o)),a.push(Le(t,e+n,t+r,e,i,o))),a}var Ne=Te;function De(t){const e=V("div",{className:Re(Ce.root,t)},V("div",{className:Re(Ce.gl,t),style:{minHeight:Ut,minWidth:$t}}),V("div",{className:Re(Ce.panel,t)},V("div",{className:Re(Ce.vegaControls,t)}),V("div",{className:Re(Ce.legend,t)})));Y(e,t.el)}function Re(t,e){return`${e.style.cssPrefix}${Ce[t]}`}function Fe(t,e,n){const r=new Array(t);return r.fill(e),n.forEach(t=>r[t.ordinal]=t),r}const Be={"legend-title":function(t,e){t.title=e.text},"legend-symbol":function(t,e){const{bounds:n,fill:r,shape:i}=e,o={bounds:n,fill:r,shape:i},s=e.datum.index;t.rows[s]=t.rows[s]||{},t.rows[s].symbol=o},"legend-label":function(t,e){const n=e.datum.index;t.rows[n]=t.rows[n]||{};const r=t.rows[n];r.label=e.text,r.value=e.datum.value}},je=(t,e,n,r,i,o)=>{Bt.vega.sceneVisit(n,(function(t){const n=Be[t.mark.role];n&&n(e.legend,t)}))};var ze=je;const Ue=(t,e,n,r,i,o)=>{Bt.vega.sceneVisit(n,(function(n){const o="2d"===e.view?0:n.z||0,s=("2d"===e.view?0:n.depth||0)+Yt,a=-1;let u=t.assignCubeOrdinal(n.datum);if(u>t.maxOrdinal&&(t.maxOrdinal=u),void 0===u);else{const c={ordinal:u,size:[n.width,n.height,s],position:[r+(n.x||0),a*(i+(n.y||0))-n.height,o],color:Tt(n.fill)||t.defaultCubeColor||[128,128,128,128]};c.color[3]=void 0===n.opacity?255:255*n.opacity,e.cubeData.push(c)}}))};var $e=Ue;const Ve=-1,qe=(t,e,n,r,i,o)=>{const s=Object.assign({opacity:1,strokeOpacity:1,strokeWidth:1},n.items[0]),a={strokeWidth:s.strokeWidth,strokeColor:Tt(s.stroke),positions:n.items.map(t=>[t.x,Ve*t.y,t.z||0])};a.strokeColor[3]*=s.strokeOpacity,a.strokeColor[3]*=s.opacity,e.pathData.push(a)};var We=qe;const Ge=(t,e,n,r,i,o)=>{const s=1,a=-1;Bt.vega.sceneVisit(n,(function(n){if(!n.text)return;const o=n.fontSize*s,u=Ye(n.baseline),c="top"===u?n.fontSize/2:0,l={color:Tt(n.fill),text:void 0===n.limit?n.text:Bt.vega.truncate(n.text,n.limit,"right",n.ellipsis||"..."),position:[r+(n.x||0),a*(i+(n.y||0)+c),0],size:o,angle:He(n.angle),textAnchor:Xe(n.align),alignmentBaseline:u,metaData:n.metaData};if("axis-label"===n.mark.role){const e=l;e.value=n.datum.value,"z"===t.currAxis.role&&Pe(e.position),t.currAxis.tickText.push(e)}else"axis-title"===n.mark.role?("z"===t.currAxis.role&&Pe(l.position),t.currAxis.title=l):e.textData.push(l)}))};function He(t){return t&&!isNaN(t)?360-t:0}function Xe(t){switch(t){case"center":return"middle";case"left":return"start";case"right":return"end"}return"start"}function Ye(t){switch(t){case"middle":return"center"}return t||"bottom"}var Ze=Ge;const Ke=-1,Je=(t,e,n,r,i,o)=>{const s=Object.assign({fillOpacity:1,opacity:1,strokeOpacity:1,strokeWidth:0,depth:0},n.items[0]),a=n.items.map(t=>{return t=Object.assign({z:0},t),t=Object.assign({x2:t.x,y2:t.y,z2:t.z},t),[t.x,Ke*t.y,t.z,t.x2,Ke*t.y2,t.z2]});let u=[],c=[a[0][0],a[0][1],a[0][2]];a.forEach(t=>{u.push([t[0],t[1],t[2]])}),a.reverse().forEach(t=>{u.push([t[3],t[4],t[5]])}),u.push(c);const l={fillColor:Tt(s.fill)||[0,0,0,0],positions:u,strokeColor:Tt(s.stroke)||[0,0,0,0],strokeWidth:s.strokeWidth,depth:s.depth};l.fillColor[3]*=s.fillOpacity,l.fillColor[3]*=s.opacity,l.strokeColor[3]*=s.strokeOpacity,l.strokeColor[3]*=s.opacity,e.polygonData.push(l)};var Qe,tn=Je;function en(t){return t.orient?t:t.datum}function nn(t,e){if("legend"===t.mark.role)return Qe.legend;if("axis"===t.mark.role){if(t.mark.zindex===e.zAxisZindex&&void 0!==e.zAxisZindex)return Qe.zAxis;const n=en(t);if(n)switch(n.orient){case"bottom":case"top":return Qe.xAxis;case"left":case"right":return Qe.yAxis}}}(function(t){t[t["none"]=0]="none",t[t["legend"]=1]="legend",t[t["xAxis"]=2]="xAxis",t[t["yAxis"]=3]="yAxis",t[t["zAxis"]=4]="zAxis"})(Qe||(Qe={}));const rn=(t,e,n,r,i,o)=>{Bt.vega.sceneVisit(n,(function(n){const s=n.x||0,a=n.y||0;if(n.context&&n.context.background&&!e.backgroundColor&&(e.backgroundColor=Tt(n.context.background)),n.stroke){const t={datum:n.datum,lines:Ie(s+r,a+i,n.height,n.width,n.stroke,Gt)};e.facets.push(t)}o=nn(n,t)||o,on(t,e,o),Bt.vega.sceneVisit(n,(function(n){an(t,e,n,s+r,a+i,o)}))}))};function on(t,e,n){let r,i;switch(n){case Qe.xAxis:r=e.axes.x,i="x";break;case Qe.yAxis:r=e.axes.y,i="y";break;case Qe.zAxis:r=e.axes.z,i="z";break;default:return}t.currAxis={domain:null,tickText:[],ticks:[],role:i},r.push(t.currAxis)}const sn={group:rn,legend:ze,rect:$e,rule:Ne,line:We,area:tn,text:Ze};var an=(t,e,n,r,i,o)=>{if("group"!==n.marktype&&o===Qe.legend)ze(t,e,n,r,i,o);else{var s=sn[n.marktype];s&&s(t,e,n,r,i,o)}};function un(t,e,n){an(t,e,n,0,0,null),cn(e.axes.x,0),cn(e.axes.y,1)}function cn(t,e){t.forEach(t=>{t.domain&&ln(t.domain,e),t.ticks.sort((t,n)=>t.sourcePosition[e]-n.sourcePosition[e]),t.tickText.sort((t,n)=>t.position[e]-n.position[e])})}function ln(t,e){if(t.sourcePosition[e]>t.targetPosition[e]){const e=t.targetPosition;t.targetPosition=t.sourcePosition,t.sourcePosition=e}}const hn=["target","rotationOrbit","rotationX","zoom"];function fn(t,e,n){const r=[e/2,-t/2,0];return"2d"===n?{target:r,rotationOrbit:0,rotationX:90,zoom:-.2}:{target:r,rotationOrbit:25,rotationX:30,zoom:-.4}}class dn{constructor(t,e){this.el=t,this.style=Ct(Vt,e),De(this),this._last={view:null,height:null,width:null,cubeCount:null,stage:null}}get stage(){return this._last.stage}get view(){return this._last.view}animationCancel(){this.animationTimer&&(clearTimeout(this.animationTimer),this.animationTimer=null,this.logger&&this.logger(`canceling animation ${this.queuedAnimationOptions&&this.queuedAnimationOptions.handlerLabel||"handler"}`),this.queuedAnimationOptions&&this.queuedAnimationOptions.animationCanceled&&this.queuedAnimationOptions.animationCanceled.call(null))}animationQueue(t,e,n){this.logger&&this.logger(`queueing animation ${n&&n.waitingLabel||"waiting"}...`),this.animationCancel(),this.animationTimer=setTimeout(()=>{this.logger&&this.logger(`queueing animation ${n&&n.handlerLabel||"handler"}...`),t()},e)}getElement(t){const e=this.el.getElementsByClassName(Re(t,this));if(e&&e.length)return e[0]}present(t,e,n,r){this.animationCancel();let i,o=t,s={maxOrdinal:0,currAxis:null,defaultCubeColor:this.style.defaultCubeColor,assignCubeOrdinal:(null===r||void 0===r?void 0:r.onSceneRectAssignCubeOrdinal)||(()=>s.maxOrdinal++),zAxisZindex:null===r||void 0===r?void 0:r.zAxisZindex};if(o.marktype?(i=Wt(o.view),un(s,i,o)):i=t,!this.deckgl){const t=Se({doubleClickHandler:()=>{this.homeCamera()}});this.OrbitControllerClass=t.OrbitControllerClass;const o=fn(e,n,i.view);let s;r&&r.preserveDrawingBuffer&&(s={preserveDrawingBuffer:!0});const a={glOptions:s,height:null,width:null,effects:Me(),layers:[],onClick:r&&r.onLayerClick,views:[new Bt.deck.OrbitView({controller:Bt.deck.OrbitController})],initialViewState:o,container:this.getElement(Ce.gl),getCursor:t=>{return t.onText||t.onAxisSelection?"pointer":t.onCube?"default":"grab"}};i.backgroundColor&&(a.style={"background-color":Lt(i.backgroundColor)}),this.deckgl=new t.DeckGL_Class(a)}let a=Math.max(this._last.cubeCount,i.cubeData.length);if(s.maxOrdinal){a=Math.max(a,s.maxOrdinal);const t={isEmpty:!0,color:[0,0,0,0]};i.cubeData=Fe(a,t,i.cubeData)}this.setDeckProps(i,e,n,a,r);const u=Q();Y(ke({legend:i.legend,onClick:r&&r.onLegendClick}),this.getElement(Ce.legend)),J(u),r&&r.onPresent&&r.onPresent()}rePresent(t,e){const n=Object.assign(Object.assign({},this._last.stage),t);this.setDeckProps(n,this._last.height,this._last.width,this._last.cubeCount,e)}isNewBounds(t,e,n,r){const i=this.lastBounds();for(let s in i)if(null===i[s])return!0;const o={cubeCount:r,height:e,view:t,width:n};for(let s in i)if(i[s]!==o[s])return!0}lastBounds(){const{cubeCount:t,height:e,view:n,width:r}=this._last;return{cubeCount:t,height:e,view:n,width:r}}setDeckProps(t,e,n,r,i){const o=Ct(qt,i),s=this.isNewBounds(t.view,e,n,r);let a,u="3d"===t.view?1:0,c=this.deckgl.viewState&&Object.keys(this.deckgl.viewState).length&&this.deckgl.viewState.OrbitView||this.deckgl.props.viewState;if(!c||s||o.shouldViewstateTransition&&o.shouldViewstateTransition()){let r=!0;if(o&&o.onTargetViewState){const t=o.onTargetViewState(e,n);e=t.height,n=t.width,void 0!==t.newViewStateTarget&&(r=t.newViewStateTarget)}c&&!r||(c=fn(e,n,t.view));const i=ve(this.deckgl.props);i&&(a=new Ae(hn),a.layerStartProps={lightingMix:i.props.lightingMix},a.layerEndProps={lightingMix:u},c.transitionDuration=o.transitionDurations.view,c.transitionEasing=le,c.transitionInterpolator=a),t.view}const l=this._showGuides&&Ie(0,0,e,n,"#0f0",1,!0);o.preLayer&&o.preLayer(t);const h=he(this,o,t,null,u,a,l),f={effects:Me(),views:[new Bt.deck.OrbitView({controller:Bt.deck.OrbitController})],initialViewState:c,layers:h};o&&o.preStage&&o.preStage(t,f),requestAnimationFrame(()=>this.deckgl.setProps(Object.assign(Object.assign({},f),{onAfterRender:()=>{this._afterRenderHandler&&this._afterRenderHandler()}}))),delete t.cubeData,this._last={cubeCount:r,height:e,width:n,stage:t,view:t.view}}canvasToDataURL(){return new Promise((t,e)=>{this._afterRenderHandler=()=>{this._afterRenderHandler=null;const e=this.deckgl.canvas.toDataURL("image/png");t(e)}})}homeCamera(){const t=fn(this._last.height,this._last.width,this._last.view);t.transitionDuration=qt.transitionDurations.view,t.transitionEasing=le,t.transitionInterpolator=new Ae(hn);const e={effects:Me(),views:this.deckgl.props.views,initialViewState:t,layers:this.deckgl.props.layers};this.deckgl.setProps(e)}getCubeData(){return be(this.deckgl.props)}showGuides(){this._showGuides=!0,this.getElement(Ce.gl).classList.add("show-center"),this.rePresent(Object.assign(Object.assign({},this._last.stage),{cubeData:this.getCubeData()}))}finalize(){this.animationCancel(),this.deckgl&&this.deckgl.finalize(),this.el&&(this.el.innerHTML=""),this._last=null,this.deckgl=null,this.el=null,this.logger=null,this.queuedAnimationOptions=null}}function pn(t){class e extends Bt.vega.Renderer{initialize(t,e,n,r){return this.height=n,this.width=e,super.initialize(t,e,n,r)}resize(t,e,n){return super.resize(t,e,n),this.origin=n,this.height=e,this.width=t,this}_render(t,e){const n=t;return n.view=this.getView(),this.presenter.present(n,this.height,this.width,this.presenterConfig),this}}const n=new e(t);return n}const gn=pn;let mn=!1;function yn(t,e){class n extends Bt.vega.View{constructor(t,e={}){super(t,e),this.config=e,this.presenter=e.presenter,e.presenterConfig=e.presenterConfig||{},e.presenterConfig.redraw=()=>{this._redraw=!0,this.run()}}renderer(...t){if(t&&t.length){const e=t[0];return"deck.gl"!==e||mn||(Bt.vega.renderModule("deck.gl",{handler:Bt.vega.CanvasHandler,renderer:gn}),mn=!0),super.renderer(e)}return super.renderer()}initialize(t){this.presenter||(this.presenter=new dn(t)),super.initialize(this.presenter.getElement(Ce.vegaControls));const e=this._renderer;return e.presenterConfig=this.config.presenterConfig,e.presenter=this.presenter,e.getView=this.config&&this.config.getView||(()=>this.presenter.view||Xt),this}error(t){this.presenter.logger&&this.presenter.logger(t)}}const r=new n(t,e);return r}const vn=yn,{defaultPresenterConfig:bn,defaultPresenterStyle:_n}=u,{desaturate:wn}=c,xn={colors:{activeCube:"purple",defaultCube:c.colorToString(_n.defaultCubeColor),hoveredCube:c.colorToString(_n.highlightColor),selectedCube:"yellow",axisSelectHighlight:c.colorToString([128,128,128,128]),axisLine:"#000",axisText:"#000",unselectedColorMethod:t=>{const e=wn(t,.05);return e[3]=171,e}},language:{headers:{chart:"Chart",details:"Details",legend:"Legend",selection:"Select & Filter"},bing:"bing",newColorMap:"remap color to filtered items",oldColorMap:"keep same colors",deselect:"deselect",exclude:"exclude",isolate:"isolate",legendOther:"other",nextDetail:">",previousDetail:"<",reset:"reset",colorBinCount:"Color bin count",colorReverse:"Color reverse",count:"Count",percent:"Percent",sum:"Sum",scatterPointScale:"Point scale",FacetMaxBins:"Facet max bins",FacetVMaxBins:"Cross facet max bins",XMaxBins:"X axis max bins",YMaxBins:"Y axis max bins",XGridSize:"X grid size",YGridSize:"Y grid size",InnerPaddingSize:"Inner padding size",OuterPaddingSize:"Outer padding size",treeMapMethod:"Treemap layout",facetColumns:"Facet columns",facetRows:"Facet rows",markOpacitySignal:"Mark opacity",textScaleSignal:"Text scale",xAxisTextAngleSignal:"X axis text angle",yAxisTextAngleSignal:"Y axis text angle",zGrounded:"Z grounded",zScaleProportion:"Z scale proportion to Y",selectionCount:t=>`${t} items selected`},maxLegends:19,onError:t=>{},transitionDurations:Object.assign(Object.assign({},bn.transitionDurations),{scope:600}),selectionPolygonZ:-1,tickSize:10};function Sn(t){var e={cssPrefix:En,fontFamily:t.fontFamily,defaultCubeColor:c.colorFromString(t.colors.defaultCube)};return t.colors.hoveredCube&&(e.highlightColor=c.colorFromString(t.colors.hoveredCube)),e}const En="sanddance-",An={black:"#212121",gray:"#D2D2D2",blue:"#0060F0",green:"#00C000",orange:"#FF9900",red:"#E00000"};function Mn(t,e=!1){if(e&&t===d)return!0;for(let n in f["FieldNames"])if(t===f["FieldNames"][n])return!0;return!1}const Cn=[[An.black,An.gray],[An.red,An.green],[An.red,An.blue],[An.black,An.red],[An.black,An.orange],[An.black,An.green]],kn=[{scheme:f["ColorScaleNone"],colors:[xn.colors.defaultCube]}];function On(t){kn.forEach(e=>{1===e.colors.length?t.scheme(e.scheme,t=>e.colors[0]):t.scheme(e.scheme,e.colors)})}function Pn(t,e){const n=`dual_${t[0]}${t[1]}`;kn.push({scheme:n,colors:e})}function Tn(){Cn.forEach(t=>{const e=t.map(t=>{for(let e in An)if(t===An[e])return e});Pn(e,t),Pn([...e].reverse(),[...t].reverse())})}var Ln;Tn(),function(t){t[t["same"]=0]="same",t[t["reset"]=1]="reset",t[t["refine"]=2]="refine"}(Ln||(Ln={}));class In{constructor(t,e){this.dataScope=t,this.props=e}select(t){return new Promise((e,n)=>{this.dataScope.select(t),this.props.onDataChanged(Ln.same),e()})}deselect(){return new Promise((t,e)=>{this.dataScope.deselect(),this.props.onDataChanged(Ln.same),t()})}filter(t,e,n,r){return r&&this.dataScope.collapse(!1,e),this.dataScope.collapse(!0,n),new Promise((n,r)=>{this.props.onAnimateDataChange(Ln.refine,"before refine","refine").then(()=>{this.dataScope.deselect(),this.dataScope.setFilteredData(e),this.props.onDataChanged(Ln.refine,t),n()}).catch(r)})}reset(){return new Promise((t,e)=>{this.dataScope.deselect(),this.dataScope.setFilteredData(null),this.props.onAnimateDataChange(Ln.reset,"before reset","reset").then(()=>{this.dataScope.collapse(!1),this.props.onDataChanged(Ln.reset),t()}).catch(e)})}activate(t){return new Promise((e,n)=>{this.dataScope.activate(t),this.props.onDataChanged(Ln.same),e()})}deactivate(){return new Promise((t,e)=>{this.dataScope.deactivate(),this.props.onDataChanged(Ln.same),t()})}}function Nn(t,e,n){return t.map(t=>{const r=c.deepMerge(t);return r.domain&&(r.domain.color=e),r.title&&(r.title.color=n),r.ticks.forEach(t=>{t.color=e}),r.tickText.forEach(t=>{t.color=n}),r})}function Dn(t,e){return t.map(t=>{return Object.assign(Object.assign({},t),{color:e})})}function Rn(t,e,n){const r=n.axisLine&&n.axisLine!==e.axisLine,i=n.axisText&&n.axisText!==e.axisText;let o,s;if(r||i){const r=c.colorFromString(n.axisLine||e.axisLine),i=c.colorFromString(n.axisText||e.axisText);o={x:Nn(t.axes.x,r,i),y:Nn(t.axes.y,r,i),z:Nn(t.axes.z,r,i)}}return i&&(s=Dn(t.textData,c.colorFromString(n.axisText))),{axes:o,textData:s}}function Fn(t){return(t+"").replace(/[\s,]/g,"")}function Bn(t,e){const n=t.tickText[e];let r;return n&&(r=t.tickText[e].value),{tick:n,value:r}}function jn(t){const e={name:t.name,operator:"isnullorEmpty"};return e}function zn(t,e){if(null==e)return jn(t);const n={name:t.name,operator:"==",value:e};return n}function Un(t,e){const n=e.map((e,n)=>{const r={name:t.name,operator:"!=",value:e};return n&&(r.clause="&&"),r}),r={expressions:n};return r}function $n(t,e,n){const r=Bn(t,n);if(r.tick)return zn(e,r.value)}function Vn(t,e,n,r=">=",i="<"){const o=[];void 0!==e&&o.push({name:t.name,operator:r,value:e}),void 0!==n&&o.push({name:t.name,operator:i,value:n}),o.length>1&&(o[1].clause="&&");const s={expressions:o};return s}function qn(t,e,n){const r=Bn(t,n),i=Bn(t,n+1);return Vn(e,r.value,i.value)}const{allTruthy:Wn,concat:Gn,push:Hn}=c;function Xn(t){let e;const n=t;return Array.isArray(n)?(e={expressions:[]},n.forEach(t=>{const n=c.clone(t.expressions).filter(Boolean);n[0].clause="&&",Hn(e.expressions,n)})):e=n?{expressions:n.expressions.filter(Boolean)}:null,e}function Yn(t,e,n,r,i,o,s){const a=[],u=e.roles.filter(t=>"x"===t.role)[0];u&&u.axisSelection&&r.axes.x.filter(t=>t.tickText.length).forEach(t=>{a.push.apply(a,Zn(t,!1,u.axisSelection,n.x))});const l=e.roles.filter(t=>"y"===t.role)[0];l&&l.axisSelection&&r.axes.y.filter(t=>t.tickText.length).forEach(t=>{a.push.apply(a,Zn(t,!0,l.axisSelection,n.y))}),r.facets&&n.facet&&a.push.apply(a,Kn(r.facets)),a.forEach(t=>{t.polygon.forEach(t=>{t[2]=s})});const h=(t,e)=>i(e.srcEvent,t.object.search),f=new Bt.layers.PolygonLayer({autoHighlight:!0,coordinateSystem:Bt.deck.COORDINATE_SYSTEM.CARTESIAN,data:a,extruded:!1,highlightColor:c.colorFromString(o),id:"selections",onHover:(e,n)=>{-1===e.index?t.deckgl.interactiveState.onAxisSelection=!1:t.deckgl.interactiveState.onAxisSelection=!0},onClick:h,getElevation:()=>0,getFillColor:()=>[0,0,0,0],pickable:!0,stroked:!1});return f}function Zn(t,e,n,r){const i=[],o=50,s="exact"===n?(t,e,n)=>({expressions:[$n(t,e,n)]}):qn,{domain:a,ticks:u}=t;if(u.length>0&&a){const n=e?1:0,c=Math.abs(u[0].sourcePosition[n]-a.sourcePosition[n])>1;let l;if(c){l=[];for(let t=1;t<u.length;t++)l.push((u[t].sourcePosition[n]+u[t-1].sourcePosition[n])/2)}else l=u.slice(1,-1).map(t=>t.sourcePosition[n]);const h=(n,o)=>{const a=[[f,d],[n,d],[n,p],[f,p]];i.push({search:s(t,r,o),polygon:e?a.map(t=>t.reverse()):a}),f=n};let f=a.sourcePosition[n];const d=a.sourcePosition[e?0:1],p=d-o;l.forEach(h),h(a.targetPosition[n],u.length-(c?1:2))}return i}function Kn(t){const e=[];let n;return n=t.map(({datum:t,lines:e},n)=>{let r=Xn(t[f["FieldNames"].FacetSearch]);return{lines:e,search:r}}),n.forEach(({lines:t,search:n},r)=>{const[i,o]=Jn(t.slice(2));e.push({search:n,polygon:[[i.min,o.min],[i.max,o.min],[i.max,o.max],[i.min,o.max]]})}),e}function Jn(t){const e=[];return t.forEach(t=>{[t.sourcePosition,t.targetPosition].forEach(t=>{e.push(t)})}),[0,1].map(t=>{let n={min:null,max:null};return e.forEach(e=>{null==n.max?n.max=e[t]:n.max=Math.max(n.max,e[t]),null==n.min?n.min=e[t]:n.min=Math.min(n.min,e[t])}),n})}function Qn(t,e,n,r){function i(t){let i;return e&&(i=t[f["FieldNames"].Selected]?{color:c.colorFromString(r.colors.selectedCube)}:{unSelected:!0}),n&&t[f["FieldNames"].Active]&&(i={color:c.colorFromString(r.colors.activeCube)}),i}const o={};return t.forEach(t=>{const e=i(t);if(e){const n=t[d];o[n]=e}}),o}function tr(t){const e={};return t.forEach(t=>{e[t.ordinal]={color:t.color}}),e}function er(t,e){if(!t.colorMap){const n=e.getCubeData();t.colorMap=tr(n)}t.legend=c.clone(e.stage.legend),t.legendElement=e.getElement(Ce.legend).children[0]}function nr(t,e,n){Object.keys(t[0]).forEach(r=>{const i=e[+r];if(i&&!i.isEmpty){const e=t[0][r];if(t.length>1){const o=t[1][r];if(o)return void(o.unSelected&&n?i.color=n(e.color):i.color=o.color)}i.color=e.color}})}class rr{constructor(){this.filteredColumnsStats={}}setData(t,e){const n=this.data!==t;return n&&(this.data&&this.deselect(),this.data=t,this.columns=e,this.filteredData=null,this.filteredColumnsStats={}),n}setFilteredData(t){this.filteredData=t,this.filteredColumnsStats={}}getColumns(t){return this.columns||(this.columns=Object(f["getColumnsFromData"])(Bt.vega.inferTypes,this.data,t)),this.columns}getFilteredColumnStats(t){return this.filteredColumnsStats[t]||(this.filteredColumnsStats[t]=Object(f["getStats"])(this.filteredData,this.columns.filter(e=>e.name===t)[0])),this.filteredColumnsStats[t]}currentData(){return this.filteredData||this.data}select(t){this.deselect(),t&&(this.selection=this.createUserSelection(t,!0,!1),this.selection.included.length&&this.activate(this.selection.included[0]))}createUserSelection(t,e,n){const r=new C(t,this.getColumns()),i={search:t,included:[],excluded:[]},o=n?this.data:this.currentData();return o.forEach(t=>{r.run(t)?(e&&(t[f["FieldNames"].Selected]=!0),i.included.push(t)):i.excluded.push(t)}),i}deselect(){this.deactivate(),this.data.forEach(t=>{delete t[f["FieldNames"].Selected]}),this.selection=null}hasFilteredData(){return!!this.filteredData}hasSelectedData(){return!!this.selection}collapse(t,e=this.data){e.forEach(e=>{e[f["FieldNames"].Collapsed]=t}),this.isCollapsed=t}activate(t){this.deactivate(),t[f["FieldNames"].Active]=!0,this.active=t}deactivate(){this.active&&delete this.active[f["FieldNames"].Active],this.active=null}ordinalIndexWithinSelection(t){if(this.selection)for(let e=0;e<this.selection.included.length;e++){let n=this.selection.included[e];if(n[d]===t)return{datum:n,index:e}}return{datum:null,index:-1}}finalize(){this.data=null,this.filteredData=null,this.filteredColumnsStats=null,this.selection&&(this.selection.excluded=null,this.selection.included=null,this.selection=null)}}var ir;(function(t){t[t["deselect"]=0]="deselect",t[t["isolate"]=1]="isolate",t[t["exclude"]=2]="exclude",t[t["reset"]=3]="reset",t[t["next"]=4]="next",t[t["previous"]=5]="previous"})(ir||(ir={}));class or{constructor(t,e,n,r,i,o){this.language=e,this.animator=n,this.dataScope=r,this.colorMapHandler=i,this.hasColorMaps=o,this.element=c.addDiv(t,`${En}unitControls`),this.clear()}finalize(){this.element&&(this.element.innerHTML=""),this.dataScope=null,this.element=null}clear(){this.state={userSelection:null,index:-1,remapColor:!1},this.render()}clearSelection(){this.state.userSelection=null,this.state.index=-1,this.render()}populate(t,e=0){this.state.userSelection=t,this.state.index=e,this.render()}selectByNameValue(t,e){const n={name:t,operator:"==",value:e};this.clearSelection(),this.animator.select(n),this.populate(this.dataScope.selection)}remapChanged(t){this.state.remapColor=t,this.colorMapHandler(t),this.render()}handleAction(t){let e;const n=this.state.userSelection;switch(t){case ir.deselect:this.clearSelection(),e=this.animator.deselect();break;case ir.exclude:this.clearSelection(),e=this.animator.filter(L(n.search),n.excluded,n.included,!1),this.state.remapColor=!1;break;case ir.isolate:this.clearSelection(),e=this.animator.filter(n.search,n.included,n.excluded,!1),this.state.remapColor=!1;break;case ir.reset:this.clear(),e=this.animator.reset();break;default:switch(t){case ir.previous:this.state.index--,this.state.index<0&&(this.state.index=this.state.userSelection.included.length-1);break;case ir.next:this.state.index++,this.state.index>=this.state.userSelection.included.length&&(this.state.index=0);break}this.render(),e=this.animator.activate(this.state.userSelection.included[this.state.index])}e.then(()=>this.render())}render(){const t=this.dataScope.hasFilteredData(),e={language:this.language,actionHandler:t=>this.handleAction(t),selectionHandler:(t,e)=>this.selectByNameValue(t,e),count:this.state.userSelection&&this.state.userSelection.included.length,hasRefinedData:t,item:this.state.userSelection&&this.state.userSelection.included[this.state.index],remapColorHandler:t=>this.remapChanged(t),hasColorMaps:this.hasColorMaps()&&t,remapColor:this.state.remapColor},n=c.getActiveElementInfo();c.mount(sr(e),this.element),c.setActiveElement(n)}}const sr=t=>{const e=[c.createElement("button",{disabled:!t.item,onClick:e=>t.actionHandler(ir.deselect)},t.language.deselect),c.createElement("button",{disabled:!t.item,onClick:e=>t.actionHandler(ir.isolate)},t.language.isolate),c.createElement("button",{disabled:!t.item,onClick:e=>t.actionHandler(ir.exclude)},t.language.exclude)],n=c.createElement("div",null,c.createElement("button",{disabled:t.remapColor,onClick:e=>t.remapColorHandler(!0)},t.language.newColorMap),c.createElement("button",{disabled:!t.remapColor,onClick:e=>t.remapColorHandler(!1)},t.language.oldColorMap)),r=1===t.count,i=[c.createElement("button",{disabled:r,onClick:e=>t.actionHandler(ir.previous)},t.language.previousDetail),c.createElement("button",{disabled:r,onClick:e=>t.actionHandler(ir.next)},t.language.nextDetail),c.createElement("span",null," ",t.language.selectionCount(t.count))],o=[];for(let s in t.item)s!==d&&(Mn(s)||o.push({cells:[{content:s},{content:ar(t.language,s,t.item[s],t.selectionHandler)}]}));return c.createElement("div",null,t.hasColorMaps&&n,c.createElement("h4",null,t.language.headers.selection),c.createElement("div",{className:`${En}selection`},e,c.createElement("button",{disabled:!t.hasRefinedData,onClick:e=>t.actionHandler(ir.reset)},"reset")),t.item&&c.createElement("h4",null,t.language.headers.details),c.createElement("div",null,c.createElement("div",{className:`${En}details-scroll`},t.item&&i),c.createElement("div",{className:`${En}details`},t.item&&c.createElement(s.Table,{rows:o}))))};function ar(t,e,n,r){return c.createElement("span",null,c.createElement("a",{href:"#",onClick:t=>r(e,n)},n),isNaN(n)?[" ",c.createElement("a",{className:"bing-search",href:`https://www.bing.com/search?q=${encodeURIComponent(n)}`,target:"_blank"},t.bing)]:"")}function ur(t,e){const n=t.getElement(Ce.vegaControls);cr(!!n.querySelectorAll(".vega-bindings > *").length,n,e.chart);const r=t.getElement(Ce.legend);cr(!!r.children.length,r,e.legend)}function cr(t,e,n){var r=hr(e,n);t&&!r&&lr(e,n),!t&&r&&r.remove()}function lr(t,e){const n=document.createElement("h4");n.innerHTML=e,t.insertAdjacentElement("beforebegin",n)}function hr(t,e){const{previousElementSibling:n}=t;if(n&&n.innerHTML===e)return n}function fr(t,e,n,r){return e.quantitative?pr(t,e,n,r):dr(e,n,r)}function dr(t,e,n){const r=e.rows[n].value;if(r===f["Other"]){const r=[];for(let t in e.rows)+t!==n&&r.push(e.rows[t].value);return Un(t,r)}return{expressions:[zn(t,e.rows[n].value)]}}function pr(t,e,n,r){const i=Object.keys(n.rows).map(t=>+t).sort((t,e)=>+t-+e);let o,s,a,u;const c=n.rows[r].label;switch(t){case"continuous":o=c,r<i.length-1&&(a=n.rows[r+1].value);break;default:{if(c.indexOf("null")>0){const t={expressions:[jn(e)]};return t}const t=c.indexOf("–");t>0?(o=c.substr(0,t),a=c.substr(t+1)):c.indexOf("<")>=0?a=c.substring(2):c.indexOf("≥")>=0&&(o=c.substring(2))}}return o&&(o=Fn(o)),a&&(a=Fn(a)),o===a?{expressions:[zn(e,o)]}:Vn(e,o,a,s,u)}function gr(t,e,n,r){const i=[];for(let o in n.rows){let s=n.rows[o];s.search=fr(t,e,n,+o),s.value===f["Other"]?s.label=r.legendOther:i.push(s.value)}}function mr(t,e,n){const r=t.uid&&t.uid.name;return n?e.forEach((t,e)=>{const i=r?t[r]:e;t[d]=n[i]}):(n={},e.forEach((t,e)=>{t[d]=e;const i=r?t[r]:e;n[i]=e})),n}function yr(t,e){const n=e.length;for(let r=0;r<n;r++)if(e[r][d]===t.ordinal)return r}function vr(t,e){if(t&&e&&e.signals&&e.signals.length)for(let n in t){let r=t[n],i=e.signals.filter(t=>t.name===n)[0];i&&i.bind&&(i.value=r)}}function br(t,e){if(!t||!e||!e.signals||!e.signals.length)return;const n={};return e.signals.forEach(e=>{if(e.bind)try{n[e.name]=t.signal(e.name)}catch(r){}}),n}const{outerSize:_r}=c,{Table:wr}=s;class xr{constructor(t){const e={cssPrefix:t.cssPrefix,rows:Sr(t.item,t.options)};if(this.element=Er(e),this.element){this.element.style.position="absolute",this.child=this.element.firstChild,document.body.appendChild(this.element);let e=_r(this.child);while(e.height>document.documentElement.clientHeight){let t=this.child.querySelector("tr:last-child");if(!t)break;t.parentElement.removeChild(t),e=_r(this.child)}t.position.clientX+e.width>=document.documentElement.clientWidth&&(this.child.style.right="0");let n=!0;t.position.clientY+e.height>=document.documentElement.clientHeight&&(t.position.clientY-e.height>0?this.child.style.bottom="0":n=!1),n&&(this.element.style.top=`${t.position.clientY}px`),this.element.style.left=`${t.position.clientX}px`}}finalize(){this.element&&document.body.removeChild(this.element),this.element=null}}function Sr(t,e){const n=[];for(let r in t){if(r===d)continue;if(Mn(r))continue;if(e&&e.exclude&&e.exclude(r))continue;let i,o=t[r];if(e&&e.displayValue)i=e.displayValue(o);else switch(o){case null:i=c.createElement("i",null,"null");break;case void 0:i=c.createElement("i",null,"undefined");break;default:i=o.toString()}n.push({cells:[{content:r+":"},{content:i}]})}return n}const Er=t=>{return 0===t.rows.length?null:c.createElement("div",{className:`${t.cssPrefix}tooltip`},wr({rows:t.rows}))};class Ar{resetCharacterSet(t,e,n){(t||Mr(e,n))&&(this.chars=void 0)}getCharacterSet(t){if(!this.chars){const e={},n=t=>{Array.from(t).forEach(t=>{e[t]=!0})};t.textData.forEach(t=>n(t.text));const{x:r,y:i,z:o}=t.axes;[r,i,o].forEach(t=>{t.forEach(t=>{t.tickText&&t.tickText.forEach(t=>n(t.text)),t.title&&n(t.title.text)})}),this.chars=Object.keys(e)}return this.chars}}function Mr(t,e){if(!t)return!0;if(!e)return!0;if(t.chart!==e.chart)return!0;if(t.facetStyle!==e.facetStyle)return!0;if(t.totalStyle!==e.totalStyle)return!0;if(t.hideAxes!==e.hideAxes)return!0;if(t.view!==e.view)return!0;if(Cr(t.signalValues,e.signalValues))return!0;if(Cr(t.size,e.size))return!0;const n=t.columns,r=e.columns;return n.facet!==r.facet||(n.facetV!==r.facetV||(n.x!==r.x||(n.y!==r.y||n.z!==r.z)))}function Cr(t,e){if(!t&&!e)return!1;if(!t||!e)return!0;const n=Object.keys(e);for(let r=0;r<n.length;r++){let i=n[r],o=typeof t,s=typeof e;if(o!==s)return!0;if("object"===o)return Cr(t[i],e[i]);if(t[i]!==e[i])return!0}return!1}var kr=function(t,e,n,r){function i(t){return t instanceof n?t:new n((function(e){e(t)}))}return new(n||(n=Promise))((function(n,o){function s(t){try{u(r.next(t))}catch(e){o(e)}}function a(t){try{u(r["throw"](t))}catch(e){o(e)}}function u(t){t.done?n(t.value):i(t.value).then(s,a)}u((r=r.apply(t,e||[])).next())}))};const{defaultView:Or}=u,Pr=1010;let Tr=!1;class Lr{constructor(t,e){this.element=t,this.options=c.deepMerge(xn,e),this.presenter=new dn(t,Sn(this.options)),this._characterSet=new Ar,this._dataScope=new rr,this._animator=new In(this._dataScope,{onDataChanged:this.onDataChanged.bind(this),onAnimateDataChange:this.onAnimateDataChange.bind(this)}),this._details=new or(this.presenter.getElement(Ce.panel),this.options.language,this._animator,this._dataScope,t=>{this.currentColorContext=~~t,this.renderSameLayout()},()=>this.insight&&this.insight.columns&&!!this.insight.columns.color&&this.colorContexts&&this.colorContexts.length>1),this.insight={}}changeColorContexts(t){this.colorContexts=t,this.currentColorContext=0,this.options.onColorContextChange&&this.options.onColorContextChange()}applyLegendColorContext(t){const e=c.getActiveElementInfo();c.mount(t.legendElement,this.presenter.getElement(Ce.legend)),c.setActiveElement(e),this.presenter.stage.legend=t.legend}onAnimateDataChange(t,e,n){return new Promise((r,i)=>{let o;if(t===Ln.refine){const t=this.colorContexts[this.currentColorContext];o=new Promise(e=>{this.renderNewLayout({},{preStage:(e,n)=>{gr(this.insight.colorBin,this._specColumns.color,e.legend,this.options.language),this.overrideAxisLabels(e),nr([t.colorMap],c.getCubes(n)),this.options.onStage&&this.options.onStage(e,n)}}).then(()=>{this.applyLegendColorContext(t),e()})})}else o=this.renderNewLayout({},{preStage:(t,e)=>{gr(this.insight.colorBin,this._specColumns.color,t.legend,this.options.language),this.overrideAxisLabels(t),this.options.onStage&&this.options.onStage(t,e)}});o.then(()=>{this.presenter.animationQueue(r,this.options.transitionDurations.position,{waitingLabel:e,handlerLabel:n,animationCanceled:i})})})}onDataChanged(t,e){return kr(this,void 0,void 0,(function*(){switch(t){case Ln.same:this.renderSameLayout();break;case Ln.refine:{const t=this.colorContexts[this.currentColorContext];let n;yield this.renderNewLayout({},{preStage:(e,r)=>{n=tr(e.cubeData),nr([t.colorMap],c.getCubes(r)),this.preStage(e,r)},onPresent:()=>{const e={colorMap:n,legend:c.clone(this.presenter.stage.legend),legendElement:this.presenter.getElement(Ce.legend).children[0]};this.applyLegendColorContext(t),this.changeColorContexts([t,e])}}),w(this.insight.filter,e)||(this.insight.filter=I(this.insight.filter,e)),this.options.onDataFilter&&this.options.onDataFilter(this.insight.filter,this._dataScope.currentData());break}case Ln.reset:{const t={colorMap:null,legend:null,legendElement:null};this.changeColorContexts([t]),yield this.renderNewLayout({},{onPresent:()=>{er(t,this.presenter)}}),delete this.insight.filter,this.options.onDataFilter&&this.options.onDataFilter(null,null);break}}if(this.options.onSelectionChanged){const t=this.getSelection();this.options.onSelectionChanged(t&&t.search||null,0,t&&t.selectedData||null)}}))}getSpecColumnsWithFilteredStats(){if(!this._dataScope.hasFilteredData())return this._specColumns;const t=["color","facet","group","size","sort","sum","x","y","z"],e=Object.assign({},this._specColumns);return t.forEach(t=>{if(e[t]){const n=Object.assign({},e[t]);n.stats=this.getColumnStats(n),e[t]=n}}),e}renderNewLayout(t,e,n){return kr(this,void 0,void 0,(function*(){const r=this._dataScope.currentData(),i={specColumns:this.getSpecColumnsWithFilteredStats(),insight:this.insight,specViewOptions:Object.assign(Object.assign({},this.options),{zAxisOptions:{showZAxis:!0,zIndex:Pr}})},o=Object(f["build"])(i,r);if(!o.errors){const r=br(this.vegaViewGl,this.vegaSpec);vr(Object.assign(Object.assign({},r),t),o.vegaSpec),this.vegaSpec=o.vegaSpec,this.options.onVegaSpec&&this.options.onVegaSpec(this.vegaSpec),this.specCapabilities=o.specCapabilities;const i=this.createConfig(e);n&&(i.getView=()=>n),Tr||(On(Bt.vega),Tr=!0);try{this.vegaViewGl&&this.vegaViewGl.finalize();const t=Bt.vega.parse(this.vegaSpec);this.vegaViewGl=new vn(t,i).renderer("deck.gl").initialize(this.element),yield this.vegaViewGl.runAsync();const e=(t,e)=>{this._characterSet.resetCharacterSet(!0)};this.vegaSpec.signals.forEach(t=>{this.vegaViewGl.addSignalListener(t.name,e)}),this.configForSignalCapture(i.presenterConfig)}catch(s){o.errors=[s.message]}o.errors||ur(this.presenter,this.options.language.headers)}return o.errors&&(this.options.onError?this.options.onError(o.errors):this.presenter.logger&&this.presenter.logger(`errors rendering Vega spec:${o.errors.join("\n")}`)),o}))}renderSameLayout(t){const e=this.colorContexts[this.currentColorContext],n=this.presenter.getCubeData().map(t=>{return Object.assign({},t)});this.applyLegendColorContext(e);let r,{axes:i,textData:o}=this.presenter.stage;t&&(t.colors&&(r=Rn(this.presenter.stage,this._lastColorOptions,t.colors),this._lastColorOptions=c.clone(t.colors),i=r.axes||i,o=r.textData||o),this.options=c.deepMerge(this.options,t));let s,a=[e.colorMap];const u=this._dataScope.hasSelectedData(),l=!!this._dataScope.active;if(u||l){const t=Qn(this._dataScope.currentData(),u,l,this.options);a.push(t),s=this.options.colors.unselectedColorMethod}nr(a,n,s);const h={cubeData:n,axes:i,textData:o};this.vegaViewGl.presenter.rePresent(h,this.createConfig().presenterConfig)}getView(t){return void 0===t?null===this.presenter.view?Or:this.presenter.view:t}transformData(t,e){try{const n=Bt.vega.parse({$schema:"https://vega.github.io/schema/vega/v4.json",data:[{name:"source",values:t,transform:e}]});new vn(n).run()}catch(n){}return t}render(t,e,n={}){return kr(this,void 0,void 0,(function*(){let r;if(w(t.filter,this.insight.filter))r=yield this._render(t,e,n,!1);else{const i=100;t.filter?(r=yield this._render(t,e,n,!0),this.presenter.animationQueue(()=>{this.filter(t.filter,n.rebaseFilter&&n.rebaseFilter())},i,{waitingLabel:"layout before refine",handlerLabel:"refine after layout"})):(this._dataScope.setFilteredData(null),r=yield this._render(t,e,n,!0),this.presenter.animationQueue(()=>{this.reset()},i,{waitingLabel:"layout before reset",handlerLabel:"reset after layout"}))}return r}))}shouldViewstateTransition(t,e){return!!e.columns&&(e.chart!==t.chart||(e.size.height!==t.size.height||(e.size.width!==t.size.width||e.columns.facet!==t.columns.facet)))}configForSignalCapture(t){const e={colorMap:null,legend:null,legendElement:null};t.preStage=(t,n)=>{this._shouldSaveColorContext()&&(e.colorMap=tr(t.cubeData)),this.preStage(t,n)},t.onPresent=()=>{this._shouldSaveColorContext()&&(er(e,this.presenter),this.changeColorContexts([e]),this._dataScope.deselect())}}_render(t,e,n,r){return kr(this,void 0,void 0,(function*(){this._tooltip&&(this._tooltip.finalize(),this._tooltip=null),this._dataScope.setData(e,n.columns)&&this.transformData(e,t.transform),this._specColumns=Object(f["getSpecColumns"])(t,this._dataScope.getColumns(n.columnTypes));const i=mr(this._specColumns,e,n.ordinalMap);this._characterSet.resetCharacterSet(r,this.insight,t),this.insight=c.clone(t),this._lastColorOptions=c.clone(this.options.colors),this._shouldSaveColorContext=()=>!n.initialColorContext;const o=n.initialColorContext||{colorMap:null,legend:null,legendElement:null},s=yield this.renderNewLayout(t.signalValues,{preStage:(t,e)=>{this._shouldSaveColorContext()?o.colorMap=tr(t.cubeData):nr([o.colorMap],c.getCubes(e));const n=!!this._dataScope.hasSelectedData(),r=!!this._dataScope.active;if(this._dataScope.hasSelectedData()||this._dataScope.active){const e=Qn(this._dataScope.currentData(),n,r,this.options);nr([o.colorMap,e],t.cubeData,this.options.colors.unselectedColorMethod)}this.preStage(t,e)},onPresent:()=>{this._shouldSaveColorContext()?(er(o,this.presenter),this.changeColorContexts([o])):this.applyLegendColorContext(o)},shouldViewstateTransition:()=>this.shouldViewstateTransition(t,this.insight)},this.getView(t.view));this._shouldSaveColorContext=()=>!n.discardColorContextUpdates||!n.discardColorContextUpdates(),this._details.render();const a={ordinalMap:i,specResult:s};return a}))}overrideAxisLabels(t){}preStage(t,e){const n=(t,e)=>{this.options.onAxisClick?this.options.onAxisClick(t,e):this.select(e)};this.overrideAxisLabels(t);const r=Yn(this.presenter,this.specCapabilities,this._specColumns,t,n,this.options.colors.axisSelectHighlight,this.options.selectionPolygonZ),i=1;e.layers.splice(i,0,r),gr(this.insight.colorBin,this._specColumns.color,t.legend,this.options.language),this.options.onStage&&this.options.onStage(t,e)}onCubeClick(t,e){this.options.onCubeClick&&this.options.onCubeClick(t,e);const n=this._dataScope.hasSelectedData();if(n&&this._dataScope.selection.included.length>1){const t=this._dataScope.ordinalIndexWithinSelection(e.ordinal);if(t.index>=0){if(this.activate(t.datum),this._details.populate(this._dataScope.selection,t.index),this.options.onSelectionChanged){const e=this.getSelection();this.options.onSelectionChanged(e.search,t.index,e.selectedData)}return}}if(n&&1===this._dataScope.selection.included.length&&this._dataScope.selection.included[0][d]===e.ordinal)return void this.deselect();const r={name:d,operator:"==",value:e.ordinal};this.select(r)}onCubeHover(t,e){if(this._tooltip&&(this._tooltip.finalize(),this._tooltip=null),!e)return;const n=this._dataScope.currentData(),r=yr(e,n);r>=0&&(this._tooltip=new xr({options:this.options.tooltipOptions,item:n[r],position:t,cssPrefix:this.presenter.style.cssPrefix}))}onTextHover(t,e){return!!(e&&this.options.getTextColor&&this.options.getTextHighlightColor)&&!c.colorIsEqual(this.options.getTextColor(e),this.options.getTextHighlightColor(e))}createConfig(t){const{getTextColor:e,getTextHighlightColor:n,getTextHighlightAlphaCutoff:r,onTextClick:i}=this.options,o={zAxisZindex:Pr,getCharacterSet:t=>this._characterSet.getCharacterSet(t),getTextColor:e,getTextHighlightColor:n,getTextHighlightAlphaCutoff:r,onTextClick:(t,e)=>{if(e.metaData&&e.metaData.search){const n=Xn(e.metaData.search);this.options.onAxisClick?this.options.onAxisClick(t,n):this.select(n)}i&&i(t,e)},onCubeClick:this.onCubeClick.bind(this),onCubeHover:this.onCubeHover.bind(this),onTextHover:this.onTextHover.bind(this),preStage:this.preStage.bind(this),onPresent:this.options.onPresent,onLayerClick:(t,e)=>{t&&t.object||this.deselect()},onLegendClick:(t,e,n)=>{const r=null!==n&&e.rows[n];r?this.options.onLegendRowClick?this.options.onLegendRowClick(t,r):this.select(r.search):this.options.onLegendHeaderClick&&this.options.onLegendHeaderClick(t)},onSceneRectAssignCubeOrdinal:t=>{return t[d]},onTargetViewState:(t,e)=>{const{height:n,width:r}=this.insight.size;let i;return this.options.onNewViewStateTarget&&(i=this.options.onNewViewStateTarget()),{height:n,width:r,newViewStateTarget:i}},preserveDrawingBuffer:this.options.preserveDrawingBuffer};this.options.onBeforeCreateLayers&&(o.preLayer=t=>{this.options.onBeforeCreateLayers(t,this.specCapabilities)});const s={presenter:this.presenter,presenterConfig:Object.assign(o,t)};return this.options.transitionDurations&&(s.presenterConfig.transitionDurations=this.options.transitionDurations),s}filter(t,e=!1){const n=this._dataScope.createUserSelection(t,!1,e);return new Promise((r,i)=>{this._animator.filter(t,n.included,n.excluded,e).then(()=>{this._details.clear(),this._details.clearSelection(),this._details.populate(this._dataScope.selection),r()})})}reset(){return new Promise((t,e)=>{this._animator.reset().then(()=>{this._details.clear(),this._details.clearSelection(),t()})})}select(t){return new Promise((e,n)=>{this._animator.select(t).then(()=>{this._details.populate(this._dataScope.selection),e()})})}deselect(){return new Promise((t,e)=>{this._animator.deselect().then(()=>{this._details.clearSelection(),t()})})}getSelection(){if(!this._dataScope)return null;const t={search:this._dataScope.selection&&this._dataScope.selection.search||null,selectedData:this._dataScope.selection&&this._dataScope.selection.included||null,active:this._dataScope.active};return t}activate(t){return new Promise((e,n)=>{this._animator.activate(t).then(()=>{this._details.render(),e()})})}deActivate(){return new Promise((t,e)=>{this._dataScope&&this._dataScope.active?this._animator.deactivate().then(()=>{this._details.render(),t()}):t()})}getInsight(){const t=Object.assign({},this.insight);return t.signalValues=this.getSignalValues(),t}getColumnStats(t){return this._dataScope.hasFilteredData()?this._dataScope.getFilteredColumnStats(t.name):t.stats}getSignalValues(){return br(this.vegaViewGl,this.vegaSpec)}finalize(){this._dataScope&&this._dataScope.finalize(),this._details&&this._details.finalize(),this._tooltip&&this._tooltip.finalize(),this.vegaViewGl&&this.vegaViewGl.finalize(),this.presenter&&this.presenter.finalize(),this.element&&(this.element.innerHTML=""),this.colorContexts=null,this.element=null,this.options=null,this.presenter=null,this.vegaSpec=null,this.vegaViewGl=null,this._animator=null,this._dataScope=null,this._details=null,this._tooltip=null}}Lr.defaultViewerOptions=xn;const Ir="3.2.1",Nr=jt},d0af:function(t,e,n){"use strict";function r(t){if(Array.isArray(t))return t}n.d(e,"a",(function(){return a}));n("a4d3"),n("e01a"),n("d3b7"),n("d28b"),n("3ca3"),n("ddb0");function i(t,e){var n=null==t?null:"undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,i,o=[],s=!0,a=!1;try{for(n=n.call(t);!(s=(r=n.next()).done);s=!0)if(o.push(r.value),e&&o.length===e)break}catch(u){a=!0,i=u}finally{try{s||null==n["return"]||n["return"]()}finally{if(a)throw i}}return o}}var o=n("dde1");function s(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function a(t,e){return r(t)||i(t,e)||Object(o["a"])(t,e)||s()}},d217:function(t,e,n){"use strict";n.d(e,"a",(function(){return s})),n.d(e,"b",(function(){return l}));var r=function(t){return t},i=function(t){if(null==t)return r;var e,n,i=t.scale[0],o=t.scale[1],s=t.translate[0],a=t.translate[1];return function(t,r){r||(e=n=0);var u=2,c=t.length,l=new Array(c);l[0]=(e+=t[0])*i+s,l[1]=(n+=t[1])*o+a;while(u<c)l[u]=t[u],++u;return l}},o=function(t,e){var n,r=t.length,i=r-e;while(i<--r)n=t[i],t[i++]=t[r],t[r]=n},s=function(t,e){return"string"===typeof e&&(e=t.objects[e]),"GeometryCollection"===e.type?{type:"FeatureCollection",features:e.geometries.map((function(e){return a(t,e)}))}:a(t,e)};function a(t,e){var n=e.id,r=e.bbox,i=null==e.properties?{}:e.properties,o=u(t,e);return null==n&&null==r?{type:"Feature",properties:i,geometry:o}:null==r?{type:"Feature",id:n,properties:i,geometry:o}:{type:"Feature",id:n,bbox:r,properties:i,geometry:o}}function u(t,e){var n=i(t.transform),r=t.arcs;function s(t,e){e.length&&e.pop();for(var i=r[t<0?~t:t],s=0,a=i.length;s<a;++s)e.push(n(i[s],s));t<0&&o(e,a)}function a(t){return n(t)}function u(t){for(var e=[],n=0,r=t.length;n<r;++n)s(t[n],e);return e.length<2&&e.push(e[0]),e}function c(t){var e=u(t);while(e.length<4)e.push(e[0]);return e}function l(t){return t.map(c)}function h(t){var e,n=t.type;switch(n){case"GeometryCollection":return{type:n,geometries:t.geometries.map(h)};case"Point":e=a(t.coordinates);break;case"MultiPoint":e=t.coordinates.map(a);break;case"LineString":e=u(t.arcs);break;case"MultiLineString":e=t.arcs.map(u);break;case"Polygon":e=l(t.arcs);break;case"MultiPolygon":e=t.arcs.map(l);break;default:return null}return{type:n,coordinates:e}}return h(e)}var c=function(t,e){var n={},r={},i={},o=[],s=-1;function a(e){var n,r=t.arcs[e<0?~e:e],i=r[0];return t.transform?(n=[0,0],r.forEach((function(t){n[0]+=t[0],n[1]+=t[1]}))):n=r[r.length-1],e<0?[n,i]:[i,n]}function u(t,e){for(var r in t){var i=t[r];delete e[i.start],delete i.start,delete i.end,i.forEach((function(t){n[t<0?~t:t]=1})),o.push(i)}}return e.forEach((function(n,r){var i,o=t.arcs[n<0?~n:n];o.length<3&&!o[1][0]&&!o[1][1]&&(i=e[++s],e[s]=n,e[r]=i)})),e.forEach((function(t){var e,n,o=a(t),s=o[0],u=o[1];if(e=i[s])if(delete i[e.end],e.push(t),e.end=u,n=r[u]){delete r[n.start];var c=n===e?e:e.concat(n);r[c.start=e.start]=i[c.end=n.end]=c}else r[e.start]=i[e.end]=e;else if(e=r[u])if(delete r[e.start],e.unshift(t),e.start=s,n=i[s]){delete i[n.end];var l=n===e?e:n.concat(e);r[l.start=n.start]=i[l.end=e.end]=l}else r[e.start]=i[e.end]=e;else e=[t],r[e.start=s]=i[e.end=u]=e})),u(i,r),u(r,i),e.forEach((function(t){n[t<0?~t:t]||o.push([t])})),o},l=function(t){return u(t,h.apply(this,arguments))};function h(t,e,n){var r,i,o;if(arguments.length>1)r=f(t,e,n);else for(i=0,r=new Array(o=t.arcs.length);i<o;++i)r[i]=i;return{type:"MultiLineString",arcs:c(t,r)}}function f(t,e,n){var r,i=[],o=[];function s(t){var e=t<0?~t:t;(o[e]||(o[e]=[])).push({i:t,g:r})}function a(t){t.forEach(s)}function u(t){t.forEach(a)}function c(t){t.forEach(u)}function l(t){switch(r=t,t.type){case"GeometryCollection":t.geometries.forEach(l);break;case"LineString":a(t.arcs);break;case"MultiLineString":case"Polygon":u(t.arcs);break;case"MultiPolygon":c(t.arcs);break}}return l(e),o.forEach(null==n?function(t){i.push(t[0].i)}:function(t){n(t[0].g,t[t.length-1].g)&&i.push(t[0].i)}),i}},d28b:function(t,e,n){var r=n("746f");r("iterator")},d61e:function(t,e,n){var r,i;
/**
 * @license Fraction.js v4.1.2 23/05/2021
 * https://www.xarg.org/2014/03/rational-numbers-in-javascript/
 *
 * Copyright (c) 2021, Robert Eisele (robert@xarg.org)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 **/(function(n){"use strict";var o=2e3,s={s:1,n:0,d:1};function a(t){function e(){var e=Error.apply(this,arguments);e["name"]=this["name"]=t,this["stack"]=e["stack"],this["message"]=e["message"]}function n(){}return n.prototype=Error.prototype,e.prototype=new n,e}var u=v["DivisionByZero"]=a("DivisionByZero"),c=v["InvalidParameter"]=a("InvalidParameter");function l(t,e){return isNaN(t=parseInt(t,10))&&h(),t*e}function h(){throw new c}function f(t){var e={},n=t,r=2,i=4;while(i<=n){while(n%r===0)n/=r,e[r]=(e[r]||0)+1;i+=1+2*r++}return n!==t?n>1&&(e[n]=(e[n]||0)+1):e[t]=(e[t]||0)+1,e}var d=function(t,e){var n,r=0,i=1,o=1,a=0,c=0,f=0,d=1,p=1,g=0,m=1,y=1,v=1,b=1e7;if(void 0===t||null===t);else if(void 0!==e)r=t,i=e,o=r*i;else switch(typeof t){case"object":"d"in t&&"n"in t?(r=t["n"],i=t["d"],"s"in t&&(r*=t["s"])):0 in t?(r=t[0],1 in t&&(i=t[1])):h(),o=r*i;break;case"number":if(t<0&&(o=t,t=-t),t%1===0)r=t;else if(t>0){t>=1&&(p=Math.pow(10,Math.floor(1+Math.log(t)/Math.LN10)),t/=p);while(m<=b&&v<=b){if(n=(g+y)/(m+v),t===n){m+v<=b?(r=g+y,i=m+v):v>m?(r=y,i=v):(r=g,i=m);break}t>n?(g+=y,m+=v):(y+=g,v+=m),m>b?(r=y,i=v):(r=g,i=m)}r*=p}else(isNaN(t)||isNaN(e))&&(i=r=NaN);break;case"string":if(m=t.match(/\d+|./g),null===m&&h(),"-"===m[g]?(o=-1,g++):"+"===m[g]&&g++,m.length===g+1?c=l(m[g++],o):"."===m[g+1]||"."===m[g]?("."!==m[g]&&(a=l(m[g++],o)),g++,(g+1===m.length||"("===m[g+1]&&")"===m[g+3]||"'"===m[g+1]&&"'"===m[g+3])&&(c=l(m[g],o),d=Math.pow(10,m[g].length),g++),("("===m[g]&&")"===m[g+2]||"'"===m[g]&&"'"===m[g+2])&&(f=l(m[g+1],o),p=Math.pow(10,m[g+1].length)-1,g+=3)):"/"===m[g+1]||":"===m[g+1]?(c=l(m[g],o),d=l(m[g+2],1),g+=3):"/"===m[g+3]&&" "===m[g+1]&&(a=l(m[g],o),c=l(m[g+2],o),d=l(m[g+4],1),g+=5),m.length<=g){i=d*p,o=r=f+i*a+p*c;break}default:h()}if(0===i)throw new u;s["s"]=o<0?-1:1,s["n"]=Math.abs(r),s["d"]=Math.abs(i)};function p(t,e,n){for(var r=1;e>0;t=t*t%n,e>>=1)1&e&&(r=r*t%n);return r}function g(t,e){for(;e%2===0;e/=2);for(;e%5===0;e/=5);if(1===e)return 0;for(var n=10%e,r=1;1!==n;r++)if(n=10*n%e,r>o)return 0;return r}function m(t,e,n){for(var r=1,i=p(10,n,e),o=0;o<300;o++){if(r===i)return o;r=10*r%e,i=10*i%e}return 0}function y(t,e){if(!t)return e;if(!e)return t;while(1){if(t%=e,!t)return e;if(e%=t,!e)return t}}function v(t,e){if(!(this instanceof v))return new v(t,e);d(t,e),t=y(s["d"],s["n"]),this["s"]=s["s"],this["n"]=s["n"]/t,this["d"]=s["d"]/t}v.prototype={s:1,n:0,d:1,abs:function(){return new v(this["n"],this["d"])},neg:function(){return new v(-this["s"]*this["n"],this["d"])},add:function(t,e){return d(t,e),new v(this["s"]*this["n"]*s["d"]+s["s"]*this["d"]*s["n"],this["d"]*s["d"])},sub:function(t,e){return d(t,e),new v(this["s"]*this["n"]*s["d"]-s["s"]*this["d"]*s["n"],this["d"]*s["d"])},mul:function(t,e){return d(t,e),new v(this["s"]*s["s"]*this["n"]*s["n"],this["d"]*s["d"])},div:function(t,e){return d(t,e),new v(this["s"]*s["s"]*this["n"]*s["d"],this["d"]*s["n"])},clone:function(){return new v(this)},mod:function(t,e){return isNaN(this["n"])||isNaN(this["d"])?new v(NaN):void 0===t?new v(this["s"]*this["n"]%this["d"],1):(d(t,e),0===s["n"]&&0===this["d"]&&v(0,0),new v(this["s"]*(s["d"]*this["n"])%(s["n"]*this["d"]),s["d"]*this["d"]))},gcd:function(t,e){return d(t,e),new v(y(s["n"],this["n"])*y(s["d"],this["d"]),s["d"]*this["d"])},lcm:function(t,e){return d(t,e),0===s["n"]&&0===this["n"]?new v:new v(s["n"]*this["n"],y(s["n"],this["n"])*y(s["d"],this["d"]))},ceil:function(t){return t=Math.pow(10,t||0),isNaN(this["n"])||isNaN(this["d"])?new v(NaN):new v(Math.ceil(t*this["s"]*this["n"]/this["d"]),t)},floor:function(t){return t=Math.pow(10,t||0),isNaN(this["n"])||isNaN(this["d"])?new v(NaN):new v(Math.floor(t*this["s"]*this["n"]/this["d"]),t)},round:function(t){return t=Math.pow(10,t||0),isNaN(this["n"])||isNaN(this["d"])?new v(NaN):new v(Math.round(t*this["s"]*this["n"]/this["d"]),t)},inverse:function(){return new v(this["s"]*this["d"],this["n"])},pow:function(t,e){if(d(t,e),1===s["d"])return s["s"]<0?new v(Math.pow(this["s"]*this["d"],s["n"]),Math.pow(this["n"],s["n"])):new v(Math.pow(this["s"]*this["n"],s["n"]),Math.pow(this["d"],s["n"]));if(this["s"]<0)return null;var n=f(this["n"]),r=f(this["d"]),i=1,o=1;for(var a in n)if("1"!==a){if("0"===a){i=0;break}if(n[a]*=s["n"],n[a]%s["d"]!==0)return null;n[a]/=s["d"],i*=Math.pow(a,n[a])}for(var a in r)if("1"!==a){if(r[a]*=s["n"],r[a]%s["d"]!==0)return null;r[a]/=s["d"],o*=Math.pow(a,r[a])}return s["s"]<0?new v(o,i):new v(i,o)},equals:function(t,e){return d(t,e),this["s"]*this["n"]*s["d"]===s["s"]*s["n"]*this["d"]},compare:function(t,e){d(t,e);var n=this["s"]*this["n"]*s["d"]-s["s"]*s["n"]*this["d"];return(0<n)-(n<0)},simplify:function(t){if(isNaN(this["n"])||isNaN(this["d"]))return this;var e=this["abs"]()["toContinued"]();function n(t){return 1===t.length?new v(t[0]):n(t.slice(1))["inverse"]()["add"](t[0])}t=t||.001;for(var r=0;r<e.length;r++){var i=n(e.slice(0,r+1));if(i["sub"](this["abs"]())["abs"]().valueOf()<t)return i["mul"](this["s"])}return this},divisible:function(t,e){return d(t,e),!(!(s["n"]*this["d"])||this["n"]*s["d"]%(s["n"]*this["d"]))},valueOf:function(){return this["s"]*this["n"]/this["d"]},toFraction:function(t){var e,n="",r=this["n"],i=this["d"];return this["s"]<0&&(n+="-"),1===i?n+=r:(t&&(e=Math.floor(r/i))>0&&(n+=e,n+=" ",r%=i),n+=r,n+="/",n+=i),n},toLatex:function(t){var e,n="",r=this["n"],i=this["d"];return this["s"]<0&&(n+="-"),1===i?n+=r:(t&&(e=Math.floor(r/i))>0&&(n+=e,r%=i),n+="\\frac{",n+=r,n+="}{",n+=i,n+="}"),n},toContinued:function(){var t,e=this["n"],n=this["d"],r=[];if(isNaN(e)||isNaN(n))return r;do{r.push(Math.floor(e/n)),t=e%n,e=n,n=t}while(1!==e);return r},toString:function(t){var e=this["n"],n=this["d"];if(isNaN(e)||isNaN(n))return"NaN";t=t||15;var r=g(e,n),i=m(e,n,r),o=-1===this["s"]?"-":"";if(o+=e/n|0,e%=n,e*=10,e&&(o+="."),r){for(var s=i;s--;)o+=e/n|0,e%=n,e*=10;o+="(";for(s=r;s--;)o+=e/n|0,e%=n,e*=10;o+=")"}else for(s=t;e&&s--;)o+=e/n|0,e%=n,e*=10;return o}},r=[],i=function(){return v}.apply(e,r),void 0===i||(t.exports=i)})()},d6df:function(t,e,n){"use strict";(function(t){n.d(e,"a",(function(){return i}));var r=n("a070");function i(){const e="object"===typeof t&&"[object process]"===String(t)&&!t.browser;return!e||Object(r["a"])()}}).call(this,n("4362"))},d86b:function(t,e,n){var r=n("d039");t.exports=r((function(){if("function"==typeof ArrayBuffer){var t=new ArrayBuffer(8);Object.isExtensible(t)&&Object.defineProperty(t,"a",{value:8})}}))},d925:function(t,e,n){"use strict";t.exports=function(t){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(t)}},d933:function(t,e,n){"use strict";var r=n("a7fd5");e["a"]=function(t,e){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(Object(r["a"])(e)/3)))-Object(r["a"])(Math.abs(t)))}},d989:function(t,e,n){"use strict";var r=n("a7fd5");e["a"]=function(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,Object(r["a"])(e)-Object(r["a"])(t))+1}},dad1:function(t,e,n){"use strict";var r=n("a7fd5");e["a"]=function(t){return Math.max(0,-Object(r["a"])(Math.abs(t)))}},dca8:function(t,e,n){var r=n("23e7"),i=n("bb2f"),o=n("d039"),s=n("861d"),a=n("f183").onFreeze,u=Object.freeze,c=o((function(){u(1)}));r({target:"Object",stat:!0,forced:c,sham:!i},{freeze:function(t){return u&&s(t)?u(a(t)):t}})},dcb8:function(t,e,n){"use strict";var r=n("4ea4");Object.defineProperty(e,"__esModule",{value:!0}),e.isMobile=a,e.default=u;var i=n("1adc"),o=r(n("1050")),s=r(n("4ed1"));function a(){return"undefined"!==typeof i.window.orientation}function u(t){if(!t&&!(0,o.default)())return"Node";if((0,s.default)(t))return"Electron";var e="undefined"!==typeof navigator?navigator:{},n=t||e.userAgent||"";if(n.indexOf("Edge")>-1)return"Edge";var r=-1!==n.indexOf("MSIE "),a=-1!==n.indexOf("Trident/");return r||a?"IE":i.window.chrome?"Chrome":i.window.safari?"Safari":i.window.mozInnerScreenX?"Firefox":"Unknown"}},dcc9:function(t,e,n){(function(t){var r;(function(t,i,o){function s(t){var e=this,n=c();e.next=function(){var t=2091639*e.s0+2.3283064365386963e-10*e.c;return e.s0=e.s1,e.s1=e.s2,e.s2=t-(e.c=0|t)},e.c=1,e.s0=n(" "),e.s1=n(" "),e.s2=n(" "),e.s0-=n(t),e.s0<0&&(e.s0+=1),e.s1-=n(t),e.s1<0&&(e.s1+=1),e.s2-=n(t),e.s2<0&&(e.s2+=1),n=null}function a(t,e){return e.c=t.c,e.s0=t.s0,e.s1=t.s1,e.s2=t.s2,e}function u(t,e){var n=new s(t),r=e&&e.state,i=n.next;return i.int32=function(){return 4294967296*n.next()|0},i.double=function(){return i()+11102230246251565e-32*(2097152*i()|0)},i.quick=i,r&&("object"==typeof r&&a(r,n),i.state=function(){return a(n,{})}),i}function c(){var t=4022871197,e=function(e){e=String(e);for(var n=0;n<e.length;n++){t+=e.charCodeAt(n);var r=.02519603282416938*t;t=r>>>0,r-=t,r*=t,t=r>>>0,r-=t,t+=4294967296*r}return 2.3283064365386963e-10*(t>>>0)};return e}i&&i.exports?i.exports=u:n("07d6")&&n("3c35")?(r=function(){return u}.call(e,n,e,i),void 0===r||(i.exports=r)):this.alea=u})(0,t,n("07d6"))}).call(this,n("62e4")(t))},dd09:function(t,e,n){},dd22:function(t,e,n){"use strict";function r(t){for(const e in t)return!1;return!0}function i(t,e){if(t===e)return!0;const n=Array.isArray(t)||ArrayBuffer.isView(t),r=Array.isArray(e)||ArrayBuffer.isView(e);if(n&&r&&t.length===e.length){for(let n=0;n<t.length;++n)if(t[n]!==e[n])return!1;return!0}return!1}n.d(e,"b",(function(){return r})),n.d(e,"a",(function(){return i}))},dde1:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));n("fb6a"),n("d3b7"),n("b0c0"),n("a630"),n("3ca3"),n("ac1f"),n("00b4");function r(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function i(t,e){if(t){if("string"===typeof t)return r(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(t,e):void 0}}},de28:function(t,e,n){"use strict";function r(t,e,n){return t.fields=e||[],t.fname=n,t}function i(t){return 1===t.length?o(t[0]):s(t)}n.d(e,"a",(function(){return H})),n.d(e,"b",(function(){return X})),n.d(e,"c",(function(){return Y})),n.d(e,"d",(function(){return Z})),n.d(e,"e",(function(){return Q})),n.d(e,"f",(function(){return K})),n.d(e,"g",(function(){return W})),n.d(e,"h",(function(){return q})),n.d(e,"i",(function(){return J})),n.d(e,"j",(function(){return tt})),n.d(e,"k",(function(){return G})),n.d(e,"l",(function(){return V})),n.d(e,"m",(function(){return at})),n.d(e,"n",(function(){return te})),n.d(e,"o",(function(){return Et})),n.d(e,"p",(function(){return Pt})),n.d(e,"q",(function(){return It})),n.d(e,"r",(function(){return Rt})),n.d(e,"s",(function(){return it})),n.d(e,"t",(function(){return nt})),n.d(e,"u",(function(){return Ct})),n.d(e,"v",(function(){return Tt})),n.d(e,"w",(function(){return Nt})),n.d(e,"x",(function(){return Ft})),n.d(e,"y",(function(){return dt})),n.d(e,"z",(function(){return pt})),n.d(e,"A",(function(){return ut}));const o=t=>(function(e){return e[t]}),s=t=>{const e=t.length;return function(n){for(let r=0;r<e;++r)n=n[t[r]];return n}};function a(t){throw Error(t)}function u(t){const e=[],n=t.length;let r,i,o,s=null,u=0,c="";function l(){e.push(c+t.substring(r,i)),c="",r=i+1}for(t+="",r=i=0;i<n;++i)if(o=t[i],"\\"===o)c+=t.substring(r,i),c+=t.substring(++i,++i),r=i;else if(o===s)l(),s=null,u=-1;else{if(s)continue;r===u&&'"'===o?(r=i+1,s=o):r===u&&"'"===o?(r=i+1,s=o):"."!==o||u?"["===o?(i>r&&l(),u=r=i+1):"]"===o&&(u||a("Access path missing open bracket: "+t),u>0&&l(),u=0,r=i+1):i>r?l():r=i+1}return u&&a("Access path missing closing bracket: "+t),s&&a("Access path missing closing quote: "+t),i>r&&(i++,l()),e}function c(t,e,n){const o=u(t);return t=1===o.length?o[0]:t,r((n&&n.get||i)(o),[t],e||t)}c("id"),r(t=>t,[],"identity");const l=r(()=>0,[],"zero"),h=r(()=>1,[],"one");r(()=>!0,[],"true"),r(()=>!1,[],"false");var f=Array.isArray;function d(t){return t[t.length-1]}function p(t){return null!=t?f(t)?t:[t]:[]}function g(t){return"function"===typeof t}function m(t){return g(t)?t:()=>t}function y(t){for(let e,n,r=1,i=arguments.length;r<i;++r)for(n in e=arguments[r],e)t[n]=e[n];return t}const v=Object.prototype.hasOwnProperty;function b(t,e){return v.call(t,e)}function _(t){return t&&d(t)-t[0]||0}function w(t){const e={},n=t.length;for(let r=0;r<n;++r)e[t[r]]=!0;return e}var x=n("742c"),S=n("b14c"),E=n("6eb2"),A=n("2739"),M=n("a15a3"),C=n("9603"),k=n("b3c3"),O=n("2c38"),P=n("5edf"),T=n("1809"),L=n("77ae4"),I=n("55f8"),N=n("f623"),D=n("f8ee"),R=function(t,e){return t<e?-1:t>e?1:t>=e?0:NaN},F=function(t){let e=t,n=t;function r(t,e,r,i){null==r&&(r=0),null==i&&(i=t.length);while(r<i){const o=r+i>>>1;n(t[o],e)<0?r=o+1:i=o}return r}function i(t,e,r,i){null==r&&(r=0),null==i&&(i=t.length);while(r<i){const o=r+i>>>1;n(t[o],e)>0?i=o:r=o+1}return r}function o(t,n,i,o){null==i&&(i=0),null==o&&(o=t.length);const s=r(t,n,i,o-1);return s>i&&e(t[s-1],n)>-e(t[s],n)?s-1:s}return 1===t.length&&(e=(e,n)=>t(e)-n,n=B(t)),{left:r,center:o,right:i}};function B(t){return(e,n)=>R(t(e),n)}var j=Math.sqrt(50),z=Math.sqrt(10),U=Math.sqrt(2);function $(t,e,n){var r=Math.abs(e-t)/Math.max(0,n),i=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),o=r/i;return o>=j?i*=10:o>=z?i*=5:o>=U&&(i*=2),e<t?-i:i}const V="year",q="quarter",W="month",G="week",H="date",X="day",Y="dayofyear",Z="hours",K="minutes",J="seconds",Q="milliseconds",tt=[V,q,W,G,H,X,Y,Z,K,J,Q],et=tt.reduce((t,e,n)=>(t[e]=1+n,t),{});function nt(t){const e=p(t).slice(),n={};e.length||a("Missing time unit."),e.forEach(t=>{b(et,t)?n[t]=1:a("Invalid time unit: ".concat(t,"."))});const r=(n[G]||n[X]?1:0)+(n[q]||n[W]||n[H]?1:0)+(n[Y]?1:0);return r>1&&a("Incompatible time units: ".concat(t)),e.sort((t,e)=>et[t]-et[e]),e}const rt={[V]:"%Y ",[q]:"Q%q ",[W]:"%b ",[H]:"%d ",[G]:"W%U ",[X]:"%a ",[Y]:"%j ",[Z]:"%H:00",[K]:"00:%M",[J]:":%S",[Q]:".%L",["".concat(V,"-").concat(W)]:"%Y-%m ",["".concat(V,"-").concat(W,"-").concat(H)]:"%Y-%m-%d ",["".concat(Z,"-").concat(K)]:"%H:%M"};function it(t,e){const n=y({},rt,e),r=nt(t),i=r.length;let o,s,a="",u=0;for(u=0;u<i;)for(o=r.length;o>u;--o)if(s=r.slice(u,o).join("-"),null!=n[s]){a+=n[s],u=o;break}return a.trim()}const ot=new Date;function st(t){return ot.setFullYear(t),ot.setMonth(0),ot.setDate(1),ot.setHours(0,0,0,0),ot}function at(t){return ct(new Date(t))}function ut(t){return lt(new Date(t))}function ct(t){return x["a"].count(st(t.getFullYear())-1,t)}function lt(t){return S["b"].count(st(t.getFullYear())-1,t)}function ht(t){return st(t).getDay()}function ft(t,e,n,r,i,o,s){if(0<=t&&t<100){const a=new Date(-1,e,n,r,i,o,s);return a.setFullYear(t),a}return new Date(t,e,n,r,i,o,s)}function dt(t){return gt(new Date(t))}function pt(t){return mt(new Date(t))}function gt(t){const e=Date.UTC(t.getUTCFullYear(),0,1);return E["a"].count(e-1,t)}function mt(t){const e=Date.UTC(t.getUTCFullYear(),0,1);return A["b"].count(e-1,t)}function yt(t){return ot.setTime(Date.UTC(t,0,1)),ot.getUTCDay()}function vt(t,e,n,r,i,o,s){if(0<=t&&t<100){const t=new Date(Date.UTC(-1,e,n,r,i,o,s));return t.setUTCFullYear(n.y),t}return new Date(Date.UTC(t,e,n,r,i,o,s))}function bt(t,e,n,r,i){const o=e||1,s=d(t),a=(t,e,i)=>{return i=i||t,_t(n[i],r[i],t===s&&o,e)},u=new Date,c=w(t),f=c[V]?a(V):m(2012),p=c[W]?a(W):c[q]?a(q):l,g=c[G]&&c[X]?a(X,1,G+X):c[G]?a(G,1):c[X]?a(X,1):c[H]?a(H,1):c[Y]?a(Y,1):h,y=c[Z]?a(Z):l,v=c[K]?a(K):l,b=c[J]?a(J):l,_=c[Q]?a(Q):l;return function(t){u.setTime(+t);const e=f(u);return i(e,p(u),g(u,e),y(u),v(u),b(u),_(u))}}function _t(t,e,n,r){const i=n<=1?t:r?(e,i)=>r+n*Math.floor((t(e,i)-r)/n):(e,r)=>n*Math.floor(t(e,r)/n);return e?(t,n)=>e(i(t,n),n):i}function wt(t,e,n){return e+7*t-(n+6)%7}const xt={[V]:t=>t.getFullYear(),[q]:t=>Math.floor(t.getMonth()/3),[W]:t=>t.getMonth(),[H]:t=>t.getDate(),[Z]:t=>t.getHours(),[K]:t=>t.getMinutes(),[J]:t=>t.getSeconds(),[Q]:t=>t.getMilliseconds(),[Y]:t=>ct(t),[G]:t=>lt(t),[G+X]:(t,e)=>wt(lt(t),t.getDay(),ht(e)),[X]:(t,e)=>wt(1,t.getDay(),ht(e))},St={[q]:t=>3*t,[G]:(t,e)=>wt(t,0,ht(e))};function Et(t,e){return bt(t,e||1,xt,St,ft)}const At={[V]:t=>t.getUTCFullYear(),[q]:t=>Math.floor(t.getUTCMonth()/3),[W]:t=>t.getUTCMonth(),[H]:t=>t.getUTCDate(),[Z]:t=>t.getUTCHours(),[K]:t=>t.getUTCMinutes(),[J]:t=>t.getUTCSeconds(),[Q]:t=>t.getUTCMilliseconds(),[Y]:t=>gt(t),[G]:t=>mt(t),[X]:(t,e)=>wt(1,t.getUTCDay(),yt(e)),[G+X]:(t,e)=>wt(mt(t),t.getUTCDay(),yt(e))},Mt={[q]:t=>3*t,[G]:(t,e)=>wt(t,0,yt(e))};function Ct(t,e){return bt(t,e||1,At,Mt,vt)}const kt={[V]:M["a"],[q]:C["a"].every(3),[W]:C["a"],[G]:S["b"],[H]:x["a"],[X]:x["a"],[Y]:x["a"],[Z]:k["a"],[K]:O["a"],[J]:P["a"],[Q]:T["a"]},Ot={[V]:L["a"],[q]:I["a"].every(3),[W]:I["a"],[G]:A["b"],[H]:E["a"],[X]:E["a"],[Y]:E["a"],[Z]:N["a"],[K]:D["a"],[J]:P["a"],[Q]:T["a"]};function Pt(t){return kt[t]}function Tt(t){return Ot[t]}function Lt(t,e,n){return t?t.offset(e,n):void 0}function It(t,e,n){return Lt(Pt(t),e,n)}function Nt(t,e,n){return Lt(Tt(t),e,n)}function Dt(t,e,n,r){return t?t.range(e,n,r):void 0}function Rt(t,e,n,r){return Dt(Pt(t),e,n,r)}function Ft(t,e,n,r){return Dt(Tt(t),e,n,r)}const Bt=1e3,jt=60*Bt,zt=60*jt,Ut=24*zt,$t=7*Ut,Vt=30*Ut,qt=365*Ut,Wt=[V,W,H,Z,K,J,Q],Gt=Wt.slice(0,-1),Ht=Gt.slice(0,-1),Xt=Ht.slice(0,-1),Yt=Xt.slice(0,-1),Zt=[V,G],Kt=[V,W],Jt=[V],Qt=[[Gt,1,Bt],[Gt,5,5*Bt],[Gt,15,15*Bt],[Gt,30,30*Bt],[Ht,1,jt],[Ht,5,5*jt],[Ht,15,15*jt],[Ht,30,30*jt],[Xt,1,zt],[Xt,3,3*zt],[Xt,6,6*zt],[Xt,12,12*zt],[Yt,1,Ut],[Zt,1,$t],[Kt,1,Vt],[Kt,3,3*Vt],[Jt,1,qt]];function te(t){const e=t.extent,n=t.maxbins||40,r=Math.abs(_(e))/n;let i,o,s=F(t=>t[2]).right(Qt,r);return s===Qt.length?(i=Jt,o=$(e[0]/qt,e[1]/qt,n)):s?(s=Qt[r/Qt[s-1][2]<Qt[s][2]/r?s-1:s],i=s[0],o=s[1]):(i=Wt,o=Math.max($(e[0],e[1],n),1)),{units:i,step:o}}},def1:function(t,e,n){"use strict";n("6041")},e01a:function(t,e,n){"use strict";var r=n("23e7"),i=n("83ab"),o=n("da84"),s=n("e330"),a=n("1a2d"),u=n("1626"),c=n("3a9b"),l=n("577e"),h=n("9bf2").f,f=n("e893"),d=o.Symbol,p=d&&d.prototype;if(i&&u(d)&&(!("description"in p)||void 0!==d().description)){var g={},m=function(){var t=arguments.length<1||void 0===arguments[0]?void 0:l(arguments[0]),e=c(p,this)?new d(t):void 0===t?d():d(t);return""===t&&(g[e]=!0),e};f(m,d),m.prototype=p,p.constructor=m;var y="Symbol(test)"==String(d("test")),v=s(p.toString),b=s(p.valueOf),_=/^Symbol\((.*)\)[^)]+$/,w=s("".replace),x=s("".slice);h(p,"description",{configurable:!0,get:function(){var t=b(this),e=v(t);if(a(g,t))return"";var n=y?x(e,7,-1):w(e,_,"$1");return""===n?void 0:n}}),r({global:!0,forced:!0},{Symbol:m})}},e041:function(t,e,n){},e06e:function(t,e,n){"use strict";n("c805")},e355:function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n("6b74"),i=n("b52f");function o(t){function e(){var e=Reflect.construct(t,Array.from(arguments));return Object.setPrototypeOf(e,Object.getPrototypeOf(this)),e}return e.prototype=Object.create(t.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t,e}class s extends(o(Array)){get ELEMENTS(){return Object(i["a"])(!1),0}clone(){return(new this.constructor).copy(this)}from(t){return Array.isArray(t)?this.copy(t):this.fromObject(t)}fromArray(t,e=0){for(let n=0;n<this.ELEMENTS;++n)this[n]=t[n+e];return this.check()}to(t){return t===this?this:Object(r["f"])(t)?this.toArray(t):this.toObject(t)}toTarget(t){return t?this.to(t):this}toArray(t=[],e=0){for(let n=0;n<this.ELEMENTS;++n)t[e+n]=this[n];return t}toFloat32Array(){return new Float32Array(this)}toString(){return this.formatString(r["b"])}formatString(t){let e="";for(let n=0;n<this.ELEMENTS;++n)e+=(n>0?", ":"")+Object(r["e"])(this[n],t);return"".concat(t.printTypes?this.constructor.name:"","[").concat(e,"]")}equals(t){if(!t||this.length!==t.length)return!1;for(let e=0;e<this.ELEMENTS;++e)if(!Object(r["d"])(this[e],t[e]))return!1;return!0}exactEquals(t){if(!t||this.length!==t.length)return!1;for(let e=0;e<this.ELEMENTS;++e)if(this[e]!==t[e])return!1;return!0}negate(){for(let t=0;t<this.ELEMENTS;++t)this[t]=-this[t];return this.check()}lerp(t,e,n){void 0===n&&(n=e,e=t,t=this);for(let r=0;r<this.ELEMENTS;++r){const i=t[r];this[r]=i+n*(e[r]-i)}return this.check()}min(t){for(let e=0;e<this.ELEMENTS;++e)this[e]=Math.min(t[e],this[e]);return this.check()}max(t){for(let e=0;e<this.ELEMENTS;++e)this[e]=Math.max(t[e],this[e]);return this.check()}clamp(t,e){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(Math.max(this[n],t[n]),e[n]);return this.check()}add(...t){for(const e of t)for(let t=0;t<this.ELEMENTS;++t)this[t]+=e[t];return this.check()}subtract(...t){for(const e of t)for(let t=0;t<this.ELEMENTS;++t)this[t]-=e[t];return this.check()}scale(t){if(Array.isArray(t))return this.multiply(t);for(let e=0;e<this.ELEMENTS;++e)this[e]*=t;return this.check()}sub(t){return this.subtract(t)}setScalar(t){for(let e=0;e<this.ELEMENTS;++e)this[e]=t;return this.check()}addScalar(t){for(let e=0;e<this.ELEMENTS;++e)this[e]+=t;return this.check()}subScalar(t){return this.addScalar(-t)}multiplyScalar(t){for(let e=0;e<this.ELEMENTS;++e)this[e]*=t;return this.check()}divideScalar(t){return this.scale(1/t)}clampScalar(t,e){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(Math.max(this[n],t),e);return this.check()}multiplyByScalar(t){return this.scale(t)}get elements(){return this}check(){if(r["b"].debug&&!this.validate())throw new Error("math.gl: ".concat(this.constructor.name," some fields set to invalid numbers'"));return this}validate(){let t=this.length===this.ELEMENTS;for(let e=0;e<this.ELEMENTS;++e)t=t&&Number.isFinite(this[e]);return t}}},e431:function(t,e,n){},e5f3:function(t,e,n){var r;(function(i,o,s){var a,u=256,c=6,l=52,h="random",f=s.pow(u,c),d=s.pow(2,l),p=2*d,g=u-1;function m(t,e,n){var r=[];e=1==e?{entropy:!0}:e||{};var i=_(b(e.entropy?[t,x(o)]:null==t?w():t,3),r),a=new y(r),l=function(){var t=a.g(c),e=f,n=0;while(t<d)t=(t+n)*u,e*=u,n=a.g(1);while(t>=p)t/=2,e/=2,n>>>=1;return(t+n)/e};return l.int32=function(){return 0|a.g(4)},l.quick=function(){return a.g(4)/4294967296},l.double=l,_(x(a.S),o),(e.pass||n||function(t,e,n,r){return r&&(r.S&&v(r,a),t.state=function(){return v(a,{})}),n?(s[h]=t,e):t})(l,i,"global"in e?e.global:this==s,e.state)}function y(t){var e,n=t.length,r=this,i=0,o=r.i=r.j=0,s=r.S=[];n||(t=[n++]);while(i<u)s[i]=i++;for(i=0;i<u;i++)s[i]=s[o=g&o+t[i%n]+(e=s[i])],s[o]=e;(r.g=function(t){var e,n=0,i=r.i,o=r.j,s=r.S;while(t--)e=s[i=g&i+1],n=n*u+s[g&(s[i]=s[o=g&o+e])+(s[o]=e)];return r.i=i,r.j=o,n})(u)}function v(t,e){return e.i=t.i,e.j=t.j,e.S=t.S.slice(),e}function b(t,e){var n,r=[],i=typeof t;if(e&&"object"==i)for(n in t)try{r.push(b(t[n],e-1))}catch(o){}return r.length?r:"string"==i?t:t+"\0"}function _(t,e){var n,r=t+"",i=0;while(i<r.length)e[g&i]=g&(n^=19*e[g&i])+r.charCodeAt(i++);return x(e)}function w(){try{var t;return a&&(t=a.randomBytes)?t=t(u):(t=new Uint8Array(u),(i.crypto||i.msCrypto).getRandomValues(t)),x(t)}catch(r){var e=i.navigator,n=e&&e.plugins;return[+new Date,i,n,i.screen,x(o)]}}function x(t){return String.fromCharCode.apply(0,t)}if(_(s.random(),o),t.exports){t.exports=m;try{a=n(8)}catch(S){}}else r=function(){return m}.call(e,n,e,t),void 0===r||(t.exports=r)})("undefined"!==typeof self?self:this,[],Math)},e683:function(t,e,n){"use strict";t.exports=function(t,e){return e?t.replace(/\/+$/,"")+"/"+e.replace(/^\/+/,""):t}},e68e:function(t,e,n){(function(t){var r;(function(t,i,o){function s(t){var e=this,n="";e.next=function(){var t=e.b,n=e.c,r=e.d,i=e.a;return t=t<<25^t>>>7^n,n=n-r|0,r=r<<24^r>>>8^i,i=i-t|0,e.b=t=t<<20^t>>>12^n,e.c=n=n-r|0,e.d=r<<16^n>>>16^i,e.a=i-t|0},e.a=0,e.b=0,e.c=-1640531527,e.d=1367130551,t===Math.floor(t)?(e.a=t/4294967296|0,e.b=0|t):n+=t;for(var r=0;r<n.length+20;r++)e.b^=0|n.charCodeAt(r),e.next()}function a(t,e){return e.a=t.a,e.b=t.b,e.c=t.c,e.d=t.d,e}function u(t,e){var n=new s(t),r=e&&e.state,i=function(){return(n.next()>>>0)/4294967296};return i.double=function(){do{var t=n.next()>>>11,e=(n.next()>>>0)/4294967296,r=(t+e)/(1<<21)}while(0===r);return r},i.int32=n.next,i.quick=i,r&&("object"==typeof r&&a(r,n),i.state=function(){return a(n,{})}),i}i&&i.exports?i.exports=u:n("07d6")&&n("3c35")?(r=function(){return u}.call(e,n,e,i),void 0===r||(i.exports=r)):this.tychei=u})(0,t,n("07d6"))}).call(this,n("62e4")(t))},e813:function(t,e,n){var r,i;(function(o,s,a){"use strict";"undefined"!==typeof window&&n("3c35")?(r=a,i="function"===typeof r?r.call(e,n,e,t):r,void 0===i||(t.exports=i)):t.exports?t.exports=a():s.exports?s.exports=a():s[o]=a()})("Fingerprint2",this,(function(){"use strict";"undefined"===typeof Array.isArray&&(Array.isArray=function(t){return"[object Array]"===Object.prototype.toString.call(t)});var t=function(t,e){t=[t[0]>>>16,65535&t[0],t[1]>>>16,65535&t[1]],e=[e[0]>>>16,65535&e[0],e[1]>>>16,65535&e[1]];var n=[0,0,0,0];return n[3]+=t[3]+e[3],n[2]+=n[3]>>>16,n[3]&=65535,n[2]+=t[2]+e[2],n[1]+=n[2]>>>16,n[2]&=65535,n[1]+=t[1]+e[1],n[0]+=n[1]>>>16,n[1]&=65535,n[0]+=t[0]+e[0],n[0]&=65535,[n[0]<<16|n[1],n[2]<<16|n[3]]},e=function(t,e){t=[t[0]>>>16,65535&t[0],t[1]>>>16,65535&t[1]],e=[e[0]>>>16,65535&e[0],e[1]>>>16,65535&e[1]];var n=[0,0,0,0];return n[3]+=t[3]*e[3],n[2]+=n[3]>>>16,n[3]&=65535,n[2]+=t[2]*e[3],n[1]+=n[2]>>>16,n[2]&=65535,n[2]+=t[3]*e[2],n[1]+=n[2]>>>16,n[2]&=65535,n[1]+=t[1]*e[3],n[0]+=n[1]>>>16,n[1]&=65535,n[1]+=t[2]*e[2],n[0]+=n[1]>>>16,n[1]&=65535,n[1]+=t[3]*e[1],n[0]+=n[1]>>>16,n[1]&=65535,n[0]+=t[0]*e[3]+t[1]*e[2]+t[2]*e[1]+t[3]*e[0],n[0]&=65535,[n[0]<<16|n[1],n[2]<<16|n[3]]},n=function(t,e){return e%=64,32===e?[t[1],t[0]]:e<32?[t[0]<<e|t[1]>>>32-e,t[1]<<e|t[0]>>>32-e]:(e-=32,[t[1]<<e|t[0]>>>32-e,t[0]<<e|t[1]>>>32-e])},r=function(t,e){return e%=64,0===e?t:e<32?[t[0]<<e|t[1]>>>32-e,t[1]<<e]:[t[1]<<e-32,0]},i=function(t,e){return[t[0]^e[0],t[1]^e[1]]},o=function(t){return t=i(t,[0,t[0]>>>1]),t=e(t,[4283543511,3981806797]),t=i(t,[0,t[0]>>>1]),t=e(t,[3301882366,444984403]),t=i(t,[0,t[0]>>>1]),t},s=function(s,a){s=s||"",a=a||0;for(var u=s.length%16,c=s.length-u,l=[0,a],h=[0,a],f=[0,0],d=[0,0],p=[2277735313,289559509],g=[1291169091,658871167],m=0;m<c;m+=16)f=[255&s.charCodeAt(m+4)|(255&s.charCodeAt(m+5))<<8|(255&s.charCodeAt(m+6))<<16|(255&s.charCodeAt(m+7))<<24,255&s.charCodeAt(m)|(255&s.charCodeAt(m+1))<<8|(255&s.charCodeAt(m+2))<<16|(255&s.charCodeAt(m+3))<<24],d=[255&s.charCodeAt(m+12)|(255&s.charCodeAt(m+13))<<8|(255&s.charCodeAt(m+14))<<16|(255&s.charCodeAt(m+15))<<24,255&s.charCodeAt(m+8)|(255&s.charCodeAt(m+9))<<8|(255&s.charCodeAt(m+10))<<16|(255&s.charCodeAt(m+11))<<24],f=e(f,p),f=n(f,31),f=e(f,g),l=i(l,f),l=n(l,27),l=t(l,h),l=t(e(l,[0,5]),[0,1390208809]),d=e(d,g),d=n(d,33),d=e(d,p),h=i(h,d),h=n(h,31),h=t(h,l),h=t(e(h,[0,5]),[0,944331445]);switch(f=[0,0],d=[0,0],u){case 15:d=i(d,r([0,s.charCodeAt(m+14)],48));case 14:d=i(d,r([0,s.charCodeAt(m+13)],40));case 13:d=i(d,r([0,s.charCodeAt(m+12)],32));case 12:d=i(d,r([0,s.charCodeAt(m+11)],24));case 11:d=i(d,r([0,s.charCodeAt(m+10)],16));case 10:d=i(d,r([0,s.charCodeAt(m+9)],8));case 9:d=i(d,[0,s.charCodeAt(m+8)]),d=e(d,g),d=n(d,33),d=e(d,p),h=i(h,d);case 8:f=i(f,r([0,s.charCodeAt(m+7)],56));case 7:f=i(f,r([0,s.charCodeAt(m+6)],48));case 6:f=i(f,r([0,s.charCodeAt(m+5)],40));case 5:f=i(f,r([0,s.charCodeAt(m+4)],32));case 4:f=i(f,r([0,s.charCodeAt(m+3)],24));case 3:f=i(f,r([0,s.charCodeAt(m+2)],16));case 2:f=i(f,r([0,s.charCodeAt(m+1)],8));case 1:f=i(f,[0,s.charCodeAt(m)]),f=e(f,p),f=n(f,31),f=e(f,g),l=i(l,f)}return l=i(l,[0,s.length]),h=i(h,[0,s.length]),l=t(l,h),h=t(h,l),l=o(l),h=o(h),l=t(l,h),h=t(h,l),("00000000"+(l[0]>>>0).toString(16)).slice(-8)+("00000000"+(l[1]>>>0).toString(16)).slice(-8)+("00000000"+(h[0]>>>0).toString(16)).slice(-8)+("00000000"+(h[1]>>>0).toString(16)).slice(-8)},a={preprocessor:null,audio:{timeout:1e3,excludeIOS11:!0},fonts:{swfContainerId:"fingerprintjs2",swfPath:"flash/compiled/FontList.swf",userDefinedFonts:[],extendedJsFonts:!1},screen:{detectScreenOrientation:!0},plugins:{sortPluginsFor:[/palemoon/i],excludeIE:!1},extraComponents:[],excludes:{enumerateDevices:!0,pixelRatio:!0,doNotTrack:!0,fontsFlash:!0,adBlock:!0},NOT_AVAILABLE:"not available",ERROR:"error",EXCLUDED:"excluded"},u=function(t,e){if(Array.prototype.forEach&&t.forEach===Array.prototype.forEach)t.forEach(e);else if(t.length===+t.length)for(var n=0,r=t.length;n<r;n++)e(t[n],n,t);else for(var i in t)t.hasOwnProperty(i)&&e(t[i],i,t)},c=function(t,e){var n=[];return null==t?n:Array.prototype.map&&t.map===Array.prototype.map?t.map(e):(u(t,(function(t,r,i){n.push(e(t,r,i))})),n)},l=function(t,e){if(null==e)return t;var n,r;for(r in e)n=e[r],null==n||Object.prototype.hasOwnProperty.call(t,r)||(t[r]=n);return t},h=function(t,e){if(!f())return t(e.NOT_AVAILABLE);navigator.mediaDevices.enumerateDevices().then((function(e){t(e.map((function(t){return"id="+t.deviceId+";gid="+t.groupId+";"+t.kind+";"+t.label})))})).catch((function(e){t(e)}))},f=function(){return navigator.mediaDevices&&navigator.mediaDevices.enumerateDevices},d=function(t,e){var n=e.audio;if(n.excludeIOS11&&navigator.userAgent.match(/OS 11.+Version\/11.+Safari/))return t(e.EXCLUDED);var r=window.OfflineAudioContext||window.webkitOfflineAudioContext;if(null==r)return t(e.NOT_AVAILABLE);var i=new r(1,44100,44100),o=i.createOscillator();o.type="triangle",o.frequency.setValueAtTime(1e4,i.currentTime);var s=i.createDynamicsCompressor();u([["threshold",-50],["knee",40],["ratio",12],["reduction",-20],["attack",0],["release",.25]],(function(t){void 0!==s[t[0]]&&"function"===typeof s[t[0]].setValueAtTime&&s[t[0]].setValueAtTime(t[1],i.currentTime)})),o.connect(s),s.connect(i.destination),o.start(0),i.startRendering();var a=setTimeout((function(){return console.warn('Audio fingerprint timed out. Please report bug at https://github.com/fingerprintjs/fingerprintjs with your user agent: "'+navigator.userAgent+'".'),i.oncomplete=function(){},i=null,t("audioTimeout")}),n.timeout);i.oncomplete=function(e){var n;try{clearTimeout(a),n=e.renderedBuffer.getChannelData(0).slice(4500,5e3).reduce((function(t,e){return t+Math.abs(e)}),0).toString(),o.disconnect(),s.disconnect()}catch(r){return void t(r)}t(n)}},p=function(t){t(navigator.userAgent)},g=function(t,e){t(null==navigator.webdriver?e.NOT_AVAILABLE:navigator.webdriver)},m=function(t,e){t(navigator.language||navigator.userLanguage||navigator.browserLanguage||navigator.systemLanguage||e.NOT_AVAILABLE)},y=function(t,e){t(window.screen.colorDepth||e.NOT_AVAILABLE)},v=function(t,e){t(navigator.deviceMemory||e.NOT_AVAILABLE)},b=function(t,e){t(window.devicePixelRatio||e.NOT_AVAILABLE)},_=function(t,e){t(w(e))},w=function(t){var e=[window.screen.width,window.screen.height];return t.screen.detectScreenOrientation&&e.sort().reverse(),e},x=function(t,e){t(S(e))},S=function(t){if(window.screen.availWidth&&window.screen.availHeight){var e=[window.screen.availHeight,window.screen.availWidth];return t.screen.detectScreenOrientation&&e.sort().reverse(),e}return t.NOT_AVAILABLE},E=function(t){t((new Date).getTimezoneOffset())},A=function(t,e){window.Intl&&window.Intl.DateTimeFormat?t((new window.Intl.DateTimeFormat).resolvedOptions().timeZone||e.NOT_AVAILABLE):t(e.NOT_AVAILABLE)},M=function(t,e){t(Z(e))},C=function(t,e){t(K(e))},k=function(t,e){t(J(e))},O=function(t){t(!!window.HTMLElement.prototype.addBehavior)},P=function(t){t(!!window.openDatabase)},T=function(t,e){t(tt(e))},L=function(t,e){t(et(e))},I=function(t,e){t(nt(e))},N=function(t,e){ft()?t(it(e)):t(e.NOT_AVAILABLE)},D=function(t,e){dt()?t(ot()):t(e.NOT_AVAILABLE)},R=function(t){dt()?t(st()):t()},F=function(t){t(at())},B=function(t){t(ut())},j=function(t){t(ct())},z=function(t){t(lt())},U=function(t){t(ht())},$=function(t,e){return mt()?yt()?e.fonts.swfPath?void bt((function(e){t(e)}),e):t("missing options.fonts.swfPath"):t("flash not installed"):t("swf object not loaded")},V=function(t,e){var n=["monospace","sans-serif","serif"],r=["Andale Mono","Arial","Arial Black","Arial Hebrew","Arial MT","Arial Narrow","Arial Rounded MT Bold","Arial Unicode MS","Bitstream Vera Sans Mono","Book Antiqua","Bookman Old Style","Calibri","Cambria","Cambria Math","Century","Century Gothic","Century Schoolbook","Comic Sans","Comic Sans MS","Consolas","Courier","Courier New","Geneva","Georgia","Helvetica","Helvetica Neue","Impact","Lucida Bright","Lucida Calligraphy","Lucida Console","Lucida Fax","LUCIDA GRANDE","Lucida Handwriting","Lucida Sans","Lucida Sans Typewriter","Lucida Sans Unicode","Microsoft Sans Serif","Monaco","Monotype Corsiva","MS Gothic","MS Outlook","MS PGothic","MS Reference Sans Serif","MS Sans Serif","MS Serif","MYRIAD","MYRIAD PRO","Palatino","Palatino Linotype","Segoe Print","Segoe Script","Segoe UI","Segoe UI Light","Segoe UI Semibold","Segoe UI Symbol","Tahoma","Times","Times New Roman","Times New Roman PS","Trebuchet MS","Verdana","Wingdings","Wingdings 2","Wingdings 3"];if(e.fonts.extendedJsFonts){var i=["Abadi MT Condensed Light","Academy Engraved LET","ADOBE CASLON PRO","Adobe Garamond","ADOBE GARAMOND PRO","Agency FB","Aharoni","Albertus Extra Bold","Albertus Medium","Algerian","Amazone BT","American Typewriter","American Typewriter Condensed","AmerType Md BT","Andalus","Angsana New","AngsanaUPC","Antique Olive","Aparajita","Apple Chancery","Apple Color Emoji","Apple SD Gothic Neo","Arabic Typesetting","ARCHER","ARNO PRO","Arrus BT","Aurora Cn BT","AvantGarde Bk BT","AvantGarde Md BT","AVENIR","Ayuthaya","Bandy","Bangla Sangam MN","Bank Gothic","BankGothic Md BT","Baskerville","Baskerville Old Face","Batang","BatangChe","Bauer Bodoni","Bauhaus 93","Bazooka","Bell MT","Bembo","Benguiat Bk BT","Berlin Sans FB","Berlin Sans FB Demi","Bernard MT Condensed","BernhardFashion BT","BernhardMod BT","Big Caslon","BinnerD","Blackadder ITC","BlairMdITC TT","Bodoni 72","Bodoni 72 Oldstyle","Bodoni 72 Smallcaps","Bodoni MT","Bodoni MT Black","Bodoni MT Condensed","Bodoni MT Poster Compressed","Bookshelf Symbol 7","Boulder","Bradley Hand","Bradley Hand ITC","Bremen Bd BT","Britannic Bold","Broadway","Browallia New","BrowalliaUPC","Brush Script MT","Californian FB","Calisto MT","Calligrapher","Candara","CaslonOpnface BT","Castellar","Centaur","Cezanne","CG Omega","CG Times","Chalkboard","Chalkboard SE","Chalkduster","Charlesworth","Charter Bd BT","Charter BT","Chaucer","ChelthmITC Bk BT","Chiller","Clarendon","Clarendon Condensed","CloisterBlack BT","Cochin","Colonna MT","Constantia","Cooper Black","Copperplate","Copperplate Gothic","Copperplate Gothic Bold","Copperplate Gothic Light","CopperplGoth Bd BT","Corbel","Cordia New","CordiaUPC","Cornerstone","Coronet","Cuckoo","Curlz MT","DaunPenh","Dauphin","David","DB LCD Temp","DELICIOUS","Denmark","DFKai-SB","Didot","DilleniaUPC","DIN","DokChampa","Dotum","DotumChe","Ebrima","Edwardian Script ITC","Elephant","English 111 Vivace BT","Engravers MT","EngraversGothic BT","Eras Bold ITC","Eras Demi ITC","Eras Light ITC","Eras Medium ITC","EucrosiaUPC","Euphemia","Euphemia UCAS","EUROSTILE","Exotc350 Bd BT","FangSong","Felix Titling","Fixedsys","FONTIN","Footlight MT Light","Forte","FrankRuehl","Fransiscan","Freefrm721 Blk BT","FreesiaUPC","Freestyle Script","French Script MT","FrnkGothITC Bk BT","Fruitger","FRUTIGER","Futura","Futura Bk BT","Futura Lt BT","Futura Md BT","Futura ZBlk BT","FuturaBlack BT","Gabriola","Galliard BT","Gautami","Geeza Pro","Geometr231 BT","Geometr231 Hv BT","Geometr231 Lt BT","GeoSlab 703 Lt BT","GeoSlab 703 XBd BT","Gigi","Gill Sans","Gill Sans MT","Gill Sans MT Condensed","Gill Sans MT Ext Condensed Bold","Gill Sans Ultra Bold","Gill Sans Ultra Bold Condensed","Gisha","Gloucester MT Extra Condensed","GOTHAM","GOTHAM BOLD","Goudy Old Style","Goudy Stout","GoudyHandtooled BT","GoudyOLSt BT","Gujarati Sangam MN","Gulim","GulimChe","Gungsuh","GungsuhChe","Gurmukhi MN","Haettenschweiler","Harlow Solid Italic","Harrington","Heather","Heiti SC","Heiti TC","HELV","Herald","High Tower Text","Hiragino Kaku Gothic ProN","Hiragino Mincho ProN","Hoefler Text","Humanst 521 Cn BT","Humanst521 BT","Humanst521 Lt BT","Imprint MT Shadow","Incised901 Bd BT","Incised901 BT","Incised901 Lt BT","INCONSOLATA","Informal Roman","Informal011 BT","INTERSTATE","IrisUPC","Iskoola Pota","JasmineUPC","Jazz LET","Jenson","Jester","Jokerman","Juice ITC","Kabel Bk BT","Kabel Ult BT","Kailasa","KaiTi","Kalinga","Kannada Sangam MN","Kartika","Kaufmann Bd BT","Kaufmann BT","Khmer UI","KodchiangUPC","Kokila","Korinna BT","Kristen ITC","Krungthep","Kunstler Script","Lao UI","Latha","Leelawadee","Letter Gothic","Levenim MT","LilyUPC","Lithograph","Lithograph Light","Long Island","Lydian BT","Magneto","Maiandra GD","Malayalam Sangam MN","Malgun Gothic","Mangal","Marigold","Marion","Marker Felt","Market","Marlett","Matisse ITC","Matura MT Script Capitals","Meiryo","Meiryo UI","Microsoft Himalaya","Microsoft JhengHei","Microsoft New Tai Lue","Microsoft PhagsPa","Microsoft Tai Le","Microsoft Uighur","Microsoft YaHei","Microsoft Yi Baiti","MingLiU","MingLiU_HKSCS","MingLiU_HKSCS-ExtB","MingLiU-ExtB","Minion","Minion Pro","Miriam","Miriam Fixed","Mistral","Modern","Modern No. 20","Mona Lisa Solid ITC TT","Mongolian Baiti","MONO","MoolBoran","Mrs Eaves","MS LineDraw","MS Mincho","MS PMincho","MS Reference Specialty","MS UI Gothic","MT Extra","MUSEO","MV Boli","Nadeem","Narkisim","NEVIS","News Gothic","News GothicMT","NewsGoth BT","Niagara Engraved","Niagara Solid","Noteworthy","NSimSun","Nyala","OCR A Extended","Old Century","Old English Text MT","Onyx","Onyx BT","OPTIMA","Oriya Sangam MN","OSAKA","OzHandicraft BT","Palace Script MT","Papyrus","Parchment","Party LET","Pegasus","Perpetua","Perpetua Titling MT","PetitaBold","Pickwick","Plantagenet Cherokee","Playbill","PMingLiU","PMingLiU-ExtB","Poor Richard","Poster","PosterBodoni BT","PRINCETOWN LET","Pristina","PTBarnum BT","Pythagoras","Raavi","Rage Italic","Ravie","Ribbon131 Bd BT","Rockwell","Rockwell Condensed","Rockwell Extra Bold","Rod","Roman","Sakkal Majalla","Santa Fe LET","Savoye LET","Sceptre","Script","Script MT Bold","SCRIPTINA","Serifa","Serifa BT","Serifa Th BT","ShelleyVolante BT","Sherwood","Shonar Bangla","Showcard Gothic","Shruti","Signboard","SILKSCREEN","SimHei","Simplified Arabic","Simplified Arabic Fixed","SimSun","SimSun-ExtB","Sinhala Sangam MN","Sketch Rockwell","Skia","Small Fonts","Snap ITC","Snell Roundhand","Socket","Souvenir Lt BT","Staccato222 BT","Steamer","Stencil","Storybook","Styllo","Subway","Swis721 BlkEx BT","Swiss911 XCm BT","Sylfaen","Synchro LET","System","Tamil Sangam MN","Technical","Teletype","Telugu Sangam MN","Tempus Sans ITC","Terminal","Thonburi","Traditional Arabic","Trajan","TRAJAN PRO","Tristan","Tubular","Tunga","Tw Cen MT","Tw Cen MT Condensed","Tw Cen MT Condensed Extra Bold","TypoUpright BT","Unicorn","Univers","Univers CE 55 Medium","Univers Condensed","Utsaah","Vagabond","Vani","Vijaya","Viner Hand ITC","VisualUI","Vivaldi","Vladimir Script","Vrinda","Westminster","WHITNEY","Wide Latin","ZapfEllipt BT","ZapfHumnst BT","ZapfHumnst Dm BT","Zapfino","Zurich BlkEx BT","Zurich Ex BT","ZWAdobeF"];r=r.concat(i)}r=r.concat(e.fonts.userDefinedFonts),r=r.filter((function(t,e){return r.indexOf(t)===e}));var o="mmmmmmmmmmlli",s="72px",a=document.getElementsByTagName("body")[0],u=document.createElement("div"),c=document.createElement("div"),l={},h={},f=function(){var t=document.createElement("span");return t.style.position="absolute",t.style.left="-9999px",t.style.fontSize=s,t.style.fontStyle="normal",t.style.fontWeight="normal",t.style.letterSpacing="normal",t.style.lineBreak="auto",t.style.lineHeight="normal",t.style.textTransform="none",t.style.textAlign="left",t.style.textDecoration="none",t.style.textShadow="none",t.style.whiteSpace="normal",t.style.wordBreak="normal",t.style.wordSpacing="normal",t.innerHTML=o,t},d=function(t,e){var n=f();return n.style.fontFamily="'"+t+"',"+e,n},p=function(){for(var t=[],e=0,r=n.length;e<r;e++){var i=f();i.style.fontFamily=n[e],u.appendChild(i),t.push(i)}return t},g=function(){for(var t={},e=0,i=r.length;e<i;e++){for(var o=[],s=0,a=n.length;s<a;s++){var u=d(r[e],n[s]);c.appendChild(u),o.push(u)}t[r[e]]=o}return t},m=function(t){for(var e=!1,r=0;r<n.length;r++)if(e=t[r].offsetWidth!==l[n[r]]||t[r].offsetHeight!==h[n[r]],e)return e;return e},y=p();a.appendChild(u);for(var v=0,b=n.length;v<b;v++)l[n[v]]=y[v].offsetWidth,h[n[v]]=y[v].offsetHeight;var _=g();a.appendChild(c);for(var w=[],x=0,S=r.length;x<S;x++)m(_[r[x]])&&w.push(r[x]);a.removeChild(c),a.removeChild(u),t(w)},q=function(t,e){pt()?e.plugins.excludeIE?t(e.EXCLUDED):t(G(e)):t(W(e))},W=function(t){if(null==navigator.plugins)return t.NOT_AVAILABLE;for(var e=[],n=0,r=navigator.plugins.length;n<r;n++)navigator.plugins[n]&&e.push(navigator.plugins[n]);return H(t)&&(e=e.sort((function(t,e){return t.name>e.name?1:t.name<e.name?-1:0}))),c(e,(function(t){var e=c(t,(function(t){return[t.type,t.suffixes]}));return[t.name,t.description,e]}))},G=function(t){var e=[];if(Object.getOwnPropertyDescriptor&&Object.getOwnPropertyDescriptor(window,"ActiveXObject")||"ActiveXObject"in window){var n=["AcroPDF.PDF","Adodb.Stream","AgControl.AgControl","DevalVRXCtrl.DevalVRXCtrl.1","MacromediaFlashPaper.MacromediaFlashPaper","Msxml2.DOMDocument","Msxml2.XMLHTTP","PDF.PdfCtrl","QuickTime.QuickTime","QuickTimeCheckObject.QuickTimeCheck.1","RealPlayer","RealPlayer.RealPlayer(tm) ActiveX Control (32-bit)","RealVideo.RealVideo(tm) ActiveX Control (32-bit)","Scripting.Dictionary","SWCtl.SWCtl","Shell.UIHelper","ShockwaveFlash.ShockwaveFlash","Skype.Detection","TDCCtl.TDCCtl","WMPlayer.OCX","rmocx.RealPlayer G2 Control","rmocx.RealPlayer G2 Control.1"];e=c(n,(function(e){try{return new window.ActiveXObject(e),e}catch(n){return t.ERROR}}))}else e.push(t.NOT_AVAILABLE);return navigator.plugins&&(e=e.concat(W(t))),e},H=function(t){for(var e=!1,n=0,r=t.plugins.sortPluginsFor.length;n<r;n++){var i=t.plugins.sortPluginsFor[n];if(navigator.userAgent.match(i)){e=!0;break}}return e},X=function(t){t(rt())},Y=function(t,e){t(Q(e))},Z=function(t){try{return!!window.sessionStorage}catch(e){return t.ERROR}},K=function(t){try{return!!window.localStorage}catch(e){return t.ERROR}},J=function(t){if(gt())return t.EXCLUDED;try{return!!window.indexedDB}catch(e){return t.ERROR}},Q=function(t){return navigator.hardwareConcurrency?navigator.hardwareConcurrency:t.NOT_AVAILABLE},tt=function(t){return navigator.cpuClass||t.NOT_AVAILABLE},et=function(t){return navigator.platform?navigator.platform:t.NOT_AVAILABLE},nt=function(t){return navigator.doNotTrack?navigator.doNotTrack:navigator.msDoNotTrack?navigator.msDoNotTrack:window.doNotTrack?window.doNotTrack:t.NOT_AVAILABLE},rt=function(){var t,e=0;"undefined"!==typeof navigator.maxTouchPoints?e=navigator.maxTouchPoints:"undefined"!==typeof navigator.msMaxTouchPoints&&(e=navigator.msMaxTouchPoints);try{document.createEvent("TouchEvent"),t=!0}catch(r){t=!1}var n="ontouchstart"in window;return[e,t,n]},it=function(t){var e=[],n=document.createElement("canvas");n.width=2e3,n.height=200,n.style.display="inline";var r=n.getContext("2d");return r.rect(0,0,10,10),r.rect(2,2,6,6),e.push("canvas winding:"+(!1===r.isPointInPath(5,5,"evenodd")?"yes":"no")),r.textBaseline="alphabetic",r.fillStyle="#f60",r.fillRect(125,1,62,20),r.fillStyle="#069",t.dontUseFakeFontInCanvas?r.font="11pt Arial":r.font="11pt no-real-font-123",r.fillText("Cwm fjordbank glyphs vext quiz, 😃",2,15),r.fillStyle="rgba(102, 204, 0, 0.2)",r.font="18pt Arial",r.fillText("Cwm fjordbank glyphs vext quiz, 😃",4,45),r.globalCompositeOperation="multiply",r.fillStyle="rgb(255,0,255)",r.beginPath(),r.arc(50,50,50,0,2*Math.PI,!0),r.closePath(),r.fill(),r.fillStyle="rgb(0,255,255)",r.beginPath(),r.arc(100,50,50,0,2*Math.PI,!0),r.closePath(),r.fill(),r.fillStyle="rgb(255,255,0)",r.beginPath(),r.arc(75,100,50,0,2*Math.PI,!0),r.closePath(),r.fill(),r.fillStyle="rgb(255,0,255)",r.arc(75,75,75,0,2*Math.PI,!0),r.arc(75,75,25,0,2*Math.PI,!0),r.fill("evenodd"),n.toDataURL&&e.push("canvas fp:"+n.toDataURL()),e},ot=function(){var t,e=function(e){return t.clearColor(0,0,0,1),t.enable(t.DEPTH_TEST),t.depthFunc(t.LEQUAL),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT),"["+e[0]+", "+e[1]+"]"},n=function(t){var e=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic");if(e){var n=t.getParameter(e.MAX_TEXTURE_MAX_ANISOTROPY_EXT);return 0===n&&(n=2),n}return null};if(t=_t(),!t)return null;var r=[],i="attribute vec2 attrVertex;varying vec2 varyinTexCoordinate;uniform vec2 uniformOffset;void main(){varyinTexCoordinate=attrVertex+uniformOffset;gl_Position=vec4(attrVertex,0,1);}",o="precision mediump float;varying vec2 varyinTexCoordinate;void main() {gl_FragColor=vec4(varyinTexCoordinate,0,1);}",s=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,s);var a=new Float32Array([-.2,-.9,0,.4,-.26,0,0,.732134444,0]);t.bufferData(t.ARRAY_BUFFER,a,t.STATIC_DRAW),s.itemSize=3,s.numItems=3;var c=t.createProgram(),l=t.createShader(t.VERTEX_SHADER);t.shaderSource(l,i),t.compileShader(l);var h=t.createShader(t.FRAGMENT_SHADER);t.shaderSource(h,o),t.compileShader(h),t.attachShader(c,l),t.attachShader(c,h),t.linkProgram(c),t.useProgram(c),c.vertexPosAttrib=t.getAttribLocation(c,"attrVertex"),c.offsetUniform=t.getUniformLocation(c,"uniformOffset"),t.enableVertexAttribArray(c.vertexPosArray),t.vertexAttribPointer(c.vertexPosAttrib,s.itemSize,t.FLOAT,!1,0,0),t.uniform2f(c.offsetUniform,1,1),t.drawArrays(t.TRIANGLE_STRIP,0,s.numItems);try{r.push(t.canvas.toDataURL())}catch(d){}r.push("extensions:"+(t.getSupportedExtensions()||[]).join(";")),r.push("webgl aliased line width range:"+e(t.getParameter(t.ALIASED_LINE_WIDTH_RANGE))),r.push("webgl aliased point size range:"+e(t.getParameter(t.ALIASED_POINT_SIZE_RANGE))),r.push("webgl alpha bits:"+t.getParameter(t.ALPHA_BITS)),r.push("webgl antialiasing:"+(t.getContextAttributes().antialias?"yes":"no")),r.push("webgl blue bits:"+t.getParameter(t.BLUE_BITS)),r.push("webgl depth bits:"+t.getParameter(t.DEPTH_BITS)),r.push("webgl green bits:"+t.getParameter(t.GREEN_BITS)),r.push("webgl max anisotropy:"+n(t)),r.push("webgl max combined texture image units:"+t.getParameter(t.MAX_COMBINED_TEXTURE_IMAGE_UNITS)),r.push("webgl max cube map texture size:"+t.getParameter(t.MAX_CUBE_MAP_TEXTURE_SIZE)),r.push("webgl max fragment uniform vectors:"+t.getParameter(t.MAX_FRAGMENT_UNIFORM_VECTORS)),r.push("webgl max render buffer size:"+t.getParameter(t.MAX_RENDERBUFFER_SIZE)),r.push("webgl max texture image units:"+t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS)),r.push("webgl max texture size:"+t.getParameter(t.MAX_TEXTURE_SIZE)),r.push("webgl max varying vectors:"+t.getParameter(t.MAX_VARYING_VECTORS)),r.push("webgl max vertex attribs:"+t.getParameter(t.MAX_VERTEX_ATTRIBS)),r.push("webgl max vertex texture image units:"+t.getParameter(t.MAX_VERTEX_TEXTURE_IMAGE_UNITS)),r.push("webgl max vertex uniform vectors:"+t.getParameter(t.MAX_VERTEX_UNIFORM_VECTORS)),r.push("webgl max viewport dims:"+e(t.getParameter(t.MAX_VIEWPORT_DIMS))),r.push("webgl red bits:"+t.getParameter(t.RED_BITS)),r.push("webgl renderer:"+t.getParameter(t.RENDERER)),r.push("webgl shading language version:"+t.getParameter(t.SHADING_LANGUAGE_VERSION)),r.push("webgl stencil bits:"+t.getParameter(t.STENCIL_BITS)),r.push("webgl vendor:"+t.getParameter(t.VENDOR)),r.push("webgl version:"+t.getParameter(t.VERSION));try{var f=t.getExtension("WEBGL_debug_renderer_info");f&&(r.push("webgl unmasked vendor:"+t.getParameter(f.UNMASKED_VENDOR_WEBGL)),r.push("webgl unmasked renderer:"+t.getParameter(f.UNMASKED_RENDERER_WEBGL)))}catch(d){}return t.getShaderPrecisionFormat?(u(["FLOAT","INT"],(function(e){u(["VERTEX","FRAGMENT"],(function(n){u(["HIGH","MEDIUM","LOW"],(function(i){u(["precision","rangeMin","rangeMax"],(function(o){var s=t.getShaderPrecisionFormat(t[n+"_SHADER"],t[i+"_"+e])[o];"precision"!==o&&(o="precision "+o);var a=["webgl ",n.toLowerCase()," shader ",i.toLowerCase()," ",e.toLowerCase()," ",o,":",s].join("");r.push(a)}))}))}))})),wt(t),r):(wt(t),r)},st=function(){try{var t=_t(),e=t.getExtension("WEBGL_debug_renderer_info"),n=t.getParameter(e.UNMASKED_VENDOR_WEBGL)+"~"+t.getParameter(e.UNMASKED_RENDERER_WEBGL);return wt(t),n}catch(r){return null}},at=function(){var t=document.createElement("div");t.innerHTML="&nbsp;",t.className="adsbox";var e=!1;try{document.body.appendChild(t),e=0===document.getElementsByClassName("adsbox")[0].offsetHeight,document.body.removeChild(t)}catch(n){e=!1}return e},ut=function(){if("undefined"!==typeof navigator.languages)try{var t=navigator.languages[0].substr(0,2);if(t!==navigator.language.substr(0,2))return!0}catch(e){return!0}return!1},ct=function(){return window.screen.width<window.screen.availWidth||window.screen.height<window.screen.availHeight},lt=function(){var t,e=navigator.userAgent.toLowerCase(),n=navigator.oscpu,r=navigator.platform.toLowerCase();t=e.indexOf("windows phone")>=0?"Windows Phone":e.indexOf("windows")>=0||e.indexOf("win16")>=0||e.indexOf("win32")>=0||e.indexOf("win64")>=0||e.indexOf("win95")>=0||e.indexOf("win98")>=0||e.indexOf("winnt")>=0||e.indexOf("wow64")>=0?"Windows":e.indexOf("android")>=0?"Android":e.indexOf("linux")>=0||e.indexOf("cros")>=0||e.indexOf("x11")>=0?"Linux":e.indexOf("iphone")>=0||e.indexOf("ipad")>=0||e.indexOf("ipod")>=0||e.indexOf("crios")>=0||e.indexOf("fxios")>=0?"iOS":e.indexOf("macintosh")>=0||e.indexOf("mac_powerpc)")>=0?"Mac":"Other";var i="ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0;if(i&&"Windows"!==t&&"Windows Phone"!==t&&"Android"!==t&&"iOS"!==t&&"Other"!==t&&-1===e.indexOf("cros"))return!0;if("undefined"!==typeof n){if(n=n.toLowerCase(),n.indexOf("win")>=0&&"Windows"!==t&&"Windows Phone"!==t)return!0;if(n.indexOf("linux")>=0&&"Linux"!==t&&"Android"!==t)return!0;if(n.indexOf("mac")>=0&&"Mac"!==t&&"iOS"!==t)return!0;if((-1===n.indexOf("win")&&-1===n.indexOf("linux")&&-1===n.indexOf("mac"))!==("Other"===t))return!0}if(r.indexOf("win")>=0&&"Windows"!==t&&"Windows Phone"!==t)return!0;if((r.indexOf("linux")>=0||r.indexOf("android")>=0||r.indexOf("pike")>=0)&&"Linux"!==t&&"Android"!==t)return!0;if((r.indexOf("mac")>=0||r.indexOf("ipad")>=0||r.indexOf("ipod")>=0||r.indexOf("iphone")>=0)&&"Mac"!==t&&"iOS"!==t)return!0;if(r.indexOf("arm")>=0&&"Windows Phone"===t)return!1;if(r.indexOf("pike")>=0&&e.indexOf("opera mini")>=0)return!1;var o=r.indexOf("win")<0&&r.indexOf("linux")<0&&r.indexOf("mac")<0&&r.indexOf("iphone")<0&&r.indexOf("ipad")<0&&r.indexOf("ipod")<0;return o!==("Other"===t)||"undefined"===typeof navigator.plugins&&"Windows"!==t&&"Windows Phone"!==t},ht=function(){var t,e=navigator.userAgent.toLowerCase(),n=navigator.productSub;if(e.indexOf("edge/")>=0||e.indexOf("iemobile/")>=0)return!1;if(e.indexOf("opera mini")>=0)return!1;if(t=e.indexOf("firefox/")>=0?"Firefox":e.indexOf("opera/")>=0||e.indexOf(" opr/")>=0?"Opera":e.indexOf("chrome/")>=0?"Chrome":e.indexOf("safari/")>=0?e.indexOf("android 1.")>=0||e.indexOf("android 2.")>=0||e.indexOf("android 3.")>=0||e.indexOf("android 4.")>=0?"AOSP":"Safari":e.indexOf("trident/")>=0?"Internet Explorer":"Other",("Chrome"===t||"Safari"===t||"Opera"===t)&&"20030107"!==n)return!0;var r,i=eval.toString().length;if(37===i&&"Safari"!==t&&"Firefox"!==t&&"Other"!==t)return!0;if(39===i&&"Internet Explorer"!==t&&"Other"!==t)return!0;if(33===i&&"Chrome"!==t&&"AOSP"!==t&&"Opera"!==t&&"Other"!==t)return!0;try{throw"a"}catch(o){try{o.toSource(),r=!0}catch(s){r=!1}}return r&&"Firefox"!==t&&"Other"!==t},ft=function(){var t=document.createElement("canvas");return!(!t.getContext||!t.getContext("2d"))},dt=function(){if(!ft())return!1;var t=_t(),e=!!window.WebGLRenderingContext&&!!t;return wt(t),e},pt=function(){return"Microsoft Internet Explorer"===navigator.appName||!("Netscape"!==navigator.appName||!/Trident/.test(navigator.userAgent))},gt=function(){return("msWriteProfilerMark"in window)+("msLaunchUri"in navigator)+("msSaveBlob"in navigator)>=2},mt=function(){return"undefined"!==typeof window.swfobject},yt=function(){return window.swfobject.hasFlashPlayerVersion("9.0.0")},vt=function(t){var e=document.createElement("div");e.setAttribute("id",t.fonts.swfContainerId),document.body.appendChild(e)},bt=function(t,e){var n="___fp_swf_loaded";window[n]=function(e){t(e)};var r=e.fonts.swfContainerId;vt();var i={onReady:n},o={allowScriptAccess:"always",menu:"false"};window.swfobject.embedSWF(e.fonts.swfPath,r,"1","1","9.0.0",!1,i,o,{})},_t=function(){var t=document.createElement("canvas"),e=null;try{e=t.getContext("webgl")||t.getContext("experimental-webgl")}catch(n){}return e||(e=null),e},wt=function(t){var e=t.getExtension("WEBGL_lose_context");null!=e&&e.loseContext()},xt=[{key:"userAgent",getData:p},{key:"webdriver",getData:g},{key:"language",getData:m},{key:"colorDepth",getData:y},{key:"deviceMemory",getData:v},{key:"pixelRatio",getData:b},{key:"hardwareConcurrency",getData:Y},{key:"screenResolution",getData:_},{key:"availableScreenResolution",getData:x},{key:"timezoneOffset",getData:E},{key:"timezone",getData:A},{key:"sessionStorage",getData:M},{key:"localStorage",getData:C},{key:"indexedDb",getData:k},{key:"addBehavior",getData:O},{key:"openDatabase",getData:P},{key:"cpuClass",getData:T},{key:"platform",getData:L},{key:"doNotTrack",getData:I},{key:"plugins",getData:q},{key:"canvas",getData:N},{key:"webgl",getData:D},{key:"webglVendorAndRenderer",getData:R},{key:"adBlock",getData:F},{key:"hasLiedLanguages",getData:B},{key:"hasLiedResolution",getData:j},{key:"hasLiedOs",getData:z},{key:"hasLiedBrowser",getData:U},{key:"touchSupport",getData:X},{key:"fonts",getData:V,pauseBefore:!0},{key:"fontsFlash",getData:$,pauseBefore:!0},{key:"audio",getData:d},{key:"enumerateDevices",getData:h}],St=function(t){throw new Error("'new Fingerprint()' is deprecated, see https://github.com/fingerprintjs/fingerprintjs#upgrade-guide-from-182-to-200")};return St.get=function(t,e){e?t||(t={}):(e=t,t={}),l(t,a),t.components=t.extraComponents.concat(xt);var n={data:[],addPreprocessedComponent:function(e,r){"function"===typeof t.preprocessor&&(r=t.preprocessor(e,r)),n.data.push({key:e,value:r})}},r=-1,i=function(o){if(r+=1,r>=t.components.length)e(n.data);else{var s=t.components[r];if(t.excludes[s.key])i(!1);else{if(!o&&s.pauseBefore)return r-=1,void setTimeout((function(){i(!0)}),1);try{s.getData((function(t){n.addPreprocessedComponent(s.key,t),i(!1)}),t)}catch(a){n.addPreprocessedComponent(s.key,String(a)),i(!1)}}}};i(!1)},St.getPromise=function(t){return new Promise((function(e,n){St.get(t,e)}))},St.getV18=function(t,e){return null==e&&(e=t,t={}),St.get(t,(function(n){for(var r=[],i=0;i<n.length;i++){var o=n[i];if(o.value===(t.NOT_AVAILABLE||"not available"))r.push({key:o.key,value:"unknown"});else if("plugins"===o.key)r.push({key:"plugins",value:c(o.value,(function(t){var e=c(t[2],(function(t){return t.join?t.join("~"):t})).join(",");return[t[0],t[1],e].join("::")}))});else if(-1!==["canvas","webgl"].indexOf(o.key)&&Array.isArray(o.value))r.push({key:o.key,value:o.value.join("~")});else if(-1!==["sessionStorage","localStorage","indexedDb","addBehavior","openDatabase"].indexOf(o.key)){if(!o.value)continue;r.push({key:o.key,value:1})}else o.value?r.push(o.value.join?{key:o.key,value:o.value.join(";")}:o):r.push({key:o.key,value:o.value})}var a=s(c(r,(function(t){return t.value})).join("~~~"),31);e(a,r)}))},St.x64hash128=s,St.VERSION="2.1.4",St}))},e932:function(t,e){},e975:function(t,e){t.exports=function t(e,n){"use strict";var r,i,o=/(^([+\-]?(?:0|[1-9]\d*)(?:\.\d*)?(?:[eE][+\-]?\d+)?)?$|^0x[0-9a-f]+$|\d+)/gi,s=/(^[ ]*|[ ]*$)/g,a=/(^([\w ]+,?[\w ]+)?[\w ]+,?[\w ]+\d+:\d+(:\d+)?[\w ]?|^\d{1,4}[\/\-]\d{1,4}[\/\-]\d{1,4}|^\w+, \w+ \d+, \d{4})/,u=/^0x[0-9a-f]+$/i,c=/^0/,l=function(e){return t.insensitive&&(""+e).toLowerCase()||""+e},h=l(e).replace(s,"")||"",f=l(n).replace(s,"")||"",d=h.replace(o,"\0$1\0").replace(/\0$/,"").replace(/^\0/,"").split("\0"),p=f.replace(o,"\0$1\0").replace(/\0$/,"").replace(/^\0/,"").split("\0"),g=parseInt(h.match(u),16)||1!==d.length&&h.match(a)&&Date.parse(h),m=parseInt(f.match(u),16)||g&&f.match(a)&&Date.parse(f)||null;if(m){if(g<m)return-1;if(g>m)return 1}for(var y=0,v=Math.max(d.length,p.length);y<v;y++){if(r=!(d[y]||"").match(c)&&parseFloat(d[y])||d[y]||0,i=!(p[y]||"").match(c)&&parseFloat(p[y])||p[y]||0,isNaN(r)!==isNaN(i))return isNaN(r)?1:-1;if(typeof r!==typeof i&&(r+="",i+=""),r<i)return-1;if(r>i)return 1}return 0}},e9c4:function(t,e,n){var r=n("23e7"),i=n("da84"),o=n("d066"),s=n("2ba4"),a=n("e330"),u=n("d039"),c=i.Array,l=o("JSON","stringify"),h=a(/./.exec),f=a("".charAt),d=a("".charCodeAt),p=a("".replace),g=a(1..toString),m=/[\uD800-\uDFFF]/g,y=/^[\uD800-\uDBFF]$/,v=/^[\uDC00-\uDFFF]$/,b=function(t,e,n){var r=f(n,e-1),i=f(n,e+1);return h(y,t)&&!h(v,i)||h(v,t)&&!h(y,r)?"\\u"+g(d(t,0),16):t},_=u((function(){return'"\\udf06\\ud834"'!==l("\udf06\ud834")||'"\\udead"'!==l("\udead")}));l&&r({target:"JSON",stat:!0,forced:_},{stringify:function(t,e,n){for(var r=0,i=arguments.length,o=c(i);r<i;r++)o[r]=arguments[r];var a=s(l,null,o);return"string"==typeof a?p(a,m,b):a}})},edaf:function(t,e,n){var r,i;
/**
 * @license Complex.js v2.0.15 12/05/2020
 *
 * Copyright (c) 2020, Robert Eisele (robert@xarg.org)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 **/(function(n){"use strict";var o=function(t){return.5*(Math.exp(t)+Math.exp(-t))},s=function(t){return.5*(Math.exp(t)-Math.exp(-t))},a=function(t){var e=Math.PI/4;if(-e>t||t>e)return Math.cos(t)-1;var n=t*t;return n*(n*(n*(n*(n*(n*(n*(n/20922789888e3-1/87178291200)+1/479001600)-1/3628800)+1/40320)-1/720)+1/24)-.5)},u=function(t,e){var n=Math.abs(t),r=Math.abs(e);return n<3e3&&r<3e3?Math.sqrt(n*n+r*r):(n<r?(n=r,r=t/e):r=e/t,n*Math.sqrt(1+r*r))},c=function(){throw SyntaxError("Invalid Param")};function l(t,e){var n=Math.abs(t),r=Math.abs(e);return 0===t?Math.log(r):0===e?Math.log(n):n<3e3&&r<3e3?.5*Math.log(t*t+e*e):Math.log(t/Math.cos(Math.atan2(e,t)))}var h=function(t,e){var n={re:0,im:0};if(void 0===t||null===t)n["re"]=n["im"]=0;else if(void 0!==e)n["re"]=t,n["im"]=e;else switch(typeof t){case"object":if("im"in t&&"re"in t)n["re"]=t["re"],n["im"]=t["im"];else if("abs"in t&&"arg"in t){if(!Number.isFinite(t["abs"])&&Number.isFinite(t["arg"]))return f["INFINITY"];n["re"]=t["abs"]*Math.cos(t["arg"]),n["im"]=t["abs"]*Math.sin(t["arg"])}else if("r"in t&&"phi"in t){if(!Number.isFinite(t["r"])&&Number.isFinite(t["phi"]))return f["INFINITY"];n["re"]=t["r"]*Math.cos(t["phi"]),n["im"]=t["r"]*Math.sin(t["phi"])}else 2===t.length?(n["re"]=t[0],n["im"]=t[1]):c();break;case"string":n["im"]=n["re"]=0;var r=t.match(/\d+\.?\d*e[+-]?\d+|\d+\.?\d*|\.\d+|./g),i=1,o=0;null===r&&c();for(var s=0;s<r.length;s++){var a=r[s];" "===a||"\t"===a||"\n"===a||("+"===a?i++:"-"===a?o++:"i"===a||"I"===a?(i+o===0&&c()," "===r[s+1]||isNaN(r[s+1])?n["im"]+=parseFloat((o%2?"-":"")+"1"):(n["im"]+=parseFloat((o%2?"-":"")+r[s+1]),s++),i=o=0):((i+o===0||isNaN(a))&&c(),"i"===r[s+1]||"I"===r[s+1]?(n["im"]+=parseFloat((o%2?"-":"")+a),s++):n["re"]+=parseFloat((o%2?"-":"")+a),i=o=0))}i+o>0&&c();break;case"number":n["im"]=0,n["re"]=t;break;default:c()}return isNaN(n["re"])||isNaN(n["im"]),n};function f(t,e){if(!(this instanceof f))return new f(t,e);var n=h(t,e);this["re"]=n["re"],this["im"]=n["im"]}f.prototype={re:0,im:0,sign:function(){var t=this["abs"]();return new f(this["re"]/t,this["im"]/t)},add:function(t,e){var n=new f(t,e);return this["isInfinite"]()&&n["isInfinite"]()?f["NAN"]:this["isInfinite"]()||n["isInfinite"]()?f["INFINITY"]:new f(this["re"]+n["re"],this["im"]+n["im"])},sub:function(t,e){var n=new f(t,e);return this["isInfinite"]()&&n["isInfinite"]()?f["NAN"]:this["isInfinite"]()||n["isInfinite"]()?f["INFINITY"]:new f(this["re"]-n["re"],this["im"]-n["im"])},mul:function(t,e){var n=new f(t,e);return this["isInfinite"]()&&n["isZero"]()||this["isZero"]()&&n["isInfinite"]()?f["NAN"]:this["isInfinite"]()||n["isInfinite"]()?f["INFINITY"]:0===n["im"]&&0===this["im"]?new f(this["re"]*n["re"],0):new f(this["re"]*n["re"]-this["im"]*n["im"],this["re"]*n["im"]+this["im"]*n["re"])},div:function(t,e){var n=new f(t,e);if(this["isZero"]()&&n["isZero"]()||this["isInfinite"]()&&n["isInfinite"]())return f["NAN"];if(this["isInfinite"]()||n["isZero"]())return f["INFINITY"];if(this["isZero"]()||n["isInfinite"]())return f["ZERO"];t=this["re"],e=this["im"];var r,i,o=n["re"],s=n["im"];return 0===s?new f(t/o,e/o):Math.abs(o)<Math.abs(s)?(i=o/s,r=o*i+s,new f((t*i+e)/r,(e*i-t)/r)):(i=s/o,r=s*i+o,new f((t+e*i)/r,(e-t*i)/r))},pow:function(t,e){var n=new f(t,e);if(t=this["re"],e=this["im"],n["isZero"]())return f["ONE"];if(0===n["im"]){if(0===e&&t>0)return new f(Math.pow(t,n["re"]),0);if(0===t)switch((n["re"]%4+4)%4){case 0:return new f(Math.pow(e,n["re"]),0);case 1:return new f(0,Math.pow(e,n["re"]));case 2:return new f(-Math.pow(e,n["re"]),0);case 3:return new f(0,-Math.pow(e,n["re"]))}}if(0===t&&0===e&&n["re"]>0&&n["im"]>=0)return f["ZERO"];var r=Math.atan2(e,t),i=l(t,e);return t=Math.exp(n["re"]*i-n["im"]*r),e=n["im"]*i+n["re"]*r,new f(t*Math.cos(e),t*Math.sin(e))},sqrt:function(){var t,e,n=this["re"],r=this["im"],i=this["abs"]();if(n>=0){if(0===r)return new f(Math.sqrt(n),0);t=.5*Math.sqrt(2*(i+n))}else t=Math.abs(r)/Math.sqrt(2*(i-n));return e=n<=0?.5*Math.sqrt(2*(i-n)):Math.abs(r)/Math.sqrt(2*(i+n)),new f(t,r<0?-e:e)},exp:function(){var t=Math.exp(this["re"]);return this["im"],new f(t*Math.cos(this["im"]),t*Math.sin(this["im"]))},expm1:function(){var t=this["re"],e=this["im"];return new f(Math.expm1(t)*Math.cos(e)+a(e),Math.exp(t)*Math.sin(e))},log:function(){var t=this["re"],e=this["im"];return new f(l(t,e),Math.atan2(e,t))},abs:function(){return u(this["re"],this["im"])},arg:function(){return Math.atan2(this["im"],this["re"])},sin:function(){var t=this["re"],e=this["im"];return new f(Math.sin(t)*o(e),Math.cos(t)*s(e))},cos:function(){var t=this["re"],e=this["im"];return new f(Math.cos(t)*o(e),-Math.sin(t)*s(e))},tan:function(){var t=2*this["re"],e=2*this["im"],n=Math.cos(t)+o(e);return new f(Math.sin(t)/n,s(e)/n)},cot:function(){var t=2*this["re"],e=2*this["im"],n=Math.cos(t)-o(e);return new f(-Math.sin(t)/n,s(e)/n)},sec:function(){var t=this["re"],e=this["im"],n=.5*o(2*e)+.5*Math.cos(2*t);return new f(Math.cos(t)*o(e)/n,Math.sin(t)*s(e)/n)},csc:function(){var t=this["re"],e=this["im"],n=.5*o(2*e)-.5*Math.cos(2*t);return new f(Math.sin(t)*o(e)/n,-Math.cos(t)*s(e)/n)},asin:function(){var t=this["re"],e=this["im"],n=new f(e*e-t*t+1,-2*t*e)["sqrt"](),r=new f(n["re"]-e,n["im"]+t)["log"]();return new f(r["im"],-r["re"])},acos:function(){var t=this["re"],e=this["im"],n=new f(e*e-t*t+1,-2*t*e)["sqrt"](),r=new f(n["re"]-e,n["im"]+t)["log"]();return new f(Math.PI/2-r["im"],r["re"])},atan:function(){var t=this["re"],e=this["im"];if(0===t){if(1===e)return new f(0,1/0);if(-1===e)return new f(0,-1/0)}var n=t*t+(1-e)*(1-e),r=new f((1-e*e-t*t)/n,-2*t/n).log();return new f(-.5*r["im"],.5*r["re"])},acot:function(){var t=this["re"],e=this["im"];if(0===e)return new f(Math.atan2(1,t),0);var n=t*t+e*e;return 0!==n?new f(t/n,-e/n).atan():new f(0!==t?t/0:0,0!==e?-e/0:0).atan()},asec:function(){var t=this["re"],e=this["im"];if(0===t&&0===e)return new f(0,1/0);var n=t*t+e*e;return 0!==n?new f(t/n,-e/n).acos():new f(0!==t?t/0:0,0!==e?-e/0:0).acos()},acsc:function(){var t=this["re"],e=this["im"];if(0===t&&0===e)return new f(Math.PI/2,1/0);var n=t*t+e*e;return 0!==n?new f(t/n,-e/n).asin():new f(0!==t?t/0:0,0!==e?-e/0:0).asin()},sinh:function(){var t=this["re"],e=this["im"];return new f(s(t)*Math.cos(e),o(t)*Math.sin(e))},cosh:function(){var t=this["re"],e=this["im"];return new f(o(t)*Math.cos(e),s(t)*Math.sin(e))},tanh:function(){var t=2*this["re"],e=2*this["im"],n=o(t)+Math.cos(e);return new f(s(t)/n,Math.sin(e)/n)},coth:function(){var t=2*this["re"],e=2*this["im"],n=o(t)-Math.cos(e);return new f(s(t)/n,-Math.sin(e)/n)},csch:function(){var t=this["re"],e=this["im"],n=Math.cos(2*e)-o(2*t);return new f(-2*s(t)*Math.cos(e)/n,2*o(t)*Math.sin(e)/n)},sech:function(){var t=this["re"],e=this["im"],n=Math.cos(2*e)+o(2*t);return new f(2*o(t)*Math.cos(e)/n,-2*s(t)*Math.sin(e)/n)},asinh:function(){var t=this["im"];this["im"]=-this["re"],this["re"]=t;var e=this["asin"]();return this["re"]=-this["im"],this["im"]=t,t=e["re"],e["re"]=-e["im"],e["im"]=t,e},acosh:function(){var t=this["acos"]();if(t["im"]<=0){var e=t["re"];t["re"]=-t["im"],t["im"]=e}else{e=t["im"];t["im"]=-t["re"],t["re"]=e}return t},atanh:function(){var t=this["re"],e=this["im"],n=t>1&&0===e,r=1-t,i=1+t,o=r*r+e*e,s=0!==o?new f((i*r-e*e)/o,(e*r+i*e)/o):new f(-1!==t?t/0:0,0!==e?e/0:0),a=s["re"];return s["re"]=l(s["re"],s["im"])/2,s["im"]=Math.atan2(s["im"],a)/2,n&&(s["im"]=-s["im"]),s},acoth:function(){var t=this["re"],e=this["im"];if(0===t&&0===e)return new f(0,Math.PI/2);var n=t*t+e*e;return 0!==n?new f(t/n,-e/n).atanh():new f(0!==t?t/0:0,0!==e?-e/0:0).atanh()},acsch:function(){var t=this["re"],e=this["im"];if(0===e)return new f(0!==t?Math.log(t+Math.sqrt(t*t+1)):1/0,0);var n=t*t+e*e;return 0!==n?new f(t/n,-e/n).asinh():new f(0!==t?t/0:0,0!==e?-e/0:0).asinh()},asech:function(){var t=this["re"],e=this["im"];if(this["isZero"]())return f["INFINITY"];var n=t*t+e*e;return 0!==n?new f(t/n,-e/n).acosh():new f(0!==t?t/0:0,0!==e?-e/0:0).acosh()},inverse:function(){if(this["isZero"]())return f["INFINITY"];if(this["isInfinite"]())return f["ZERO"];var t=this["re"],e=this["im"],n=t*t+e*e;return new f(t/n,-e/n)},conjugate:function(){return new f(this["re"],-this["im"])},neg:function(){return new f(-this["re"],-this["im"])},ceil:function(t){return t=Math.pow(10,t||0),new f(Math.ceil(this["re"]*t)/t,Math.ceil(this["im"]*t)/t)},floor:function(t){return t=Math.pow(10,t||0),new f(Math.floor(this["re"]*t)/t,Math.floor(this["im"]*t)/t)},round:function(t){return t=Math.pow(10,t||0),new f(Math.round(this["re"]*t)/t,Math.round(this["im"]*t)/t)},equals:function(t,e){var n=new f(t,e);return Math.abs(n["re"]-this["re"])<=f["EPSILON"]&&Math.abs(n["im"]-this["im"])<=f["EPSILON"]},clone:function(){return new f(this["re"],this["im"])},toString:function(){var t=this["re"],e=this["im"],n="";return this["isNaN"]()?"NaN":this["isInfinite"]()?"Infinity":(Math.abs(t)<f["EPSILON"]&&(t=0),Math.abs(e)<f["EPSILON"]&&(e=0),0===e?n+t:(0!==t?(n+=t,n+=" ",e<0?(e=-e,n+="-"):n+="+",n+=" "):e<0&&(e=-e,n+="-"),1!==e&&(n+=e),n+"i"))},toVector:function(){return[this["re"],this["im"]]},valueOf:function(){return 0===this["im"]?this["re"]:null},isNaN:function(){return isNaN(this["re"])||isNaN(this["im"])},isZero:function(){return 0===this["im"]&&0===this["re"]},isFinite:function(){return isFinite(this["re"])&&isFinite(this["im"])},isInfinite:function(){return!(this["isNaN"]()||this["isFinite"]())}},f["ZERO"]=new f(0,0),f["ONE"]=new f(1,0),f["I"]=new f(0,1),f["PI"]=new f(Math.PI,0),f["E"]=new f(Math.E,0),f["INFINITY"]=new f(1/0,1/0),f["NAN"]=new f(NaN,NaN),f["EPSILON"]=1e-15,r=[],i=function(){return f}.apply(e,r),void 0===i||(t.exports=i)})()},f183:function(t,e,n){var r=n("23e7"),i=n("e330"),o=n("d012"),s=n("861d"),a=n("1a2d"),u=n("9bf2").f,c=n("241c"),l=n("057f"),h=n("4fadd"),f=n("90e3"),d=n("bb2f"),p=!1,g=f("meta"),m=0,y=function(t){u(t,g,{value:{objectID:"O"+m++,weakData:{}}})},v=function(t,e){if(!s(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!a(t,g)){if(!h(t))return"F";if(!e)return"E";y(t)}return t[g].objectID},b=function(t,e){if(!a(t,g)){if(!h(t))return!0;if(!e)return!1;y(t)}return t[g].weakData},_=function(t){return d&&p&&h(t)&&!a(t,g)&&y(t),t},w=function(){x.enable=function(){},p=!0;var t=c.f,e=i([].splice),n={};n[g]=1,t(n).length&&(c.f=function(n){for(var r=t(n),i=0,o=r.length;i<o;i++)if(r[i]===g){e(r,i,1);break}return r},r({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:l.f}))},x=t.exports={enable:w,fastKey:v,getWeakData:b,onFreeze:_};o[g]=!0},f330:function(t,e,n){"use strict";var r=n("4ea4"),i=n("7037");Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"self",{enumerable:!0,get:function(){return o.self}}),Object.defineProperty(e,"window",{enumerable:!0,get:function(){return o.window}}),Object.defineProperty(e,"global",{enumerable:!0,get:function(){return o.global}}),Object.defineProperty(e,"document",{enumerable:!0,get:function(){return o.document}}),Object.defineProperty(e,"process",{enumerable:!0,get:function(){return o.process}}),Object.defineProperty(e,"console",{enumerable:!0,get:function(){return o.console}}),Object.defineProperty(e,"isBrowser",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(e,"isBrowserMainThread",{enumerable:!0,get:function(){return s.isBrowserMainThread}}),Object.defineProperty(e,"getBrowser",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(e,"isMobile",{enumerable:!0,get:function(){return a.isMobile}}),Object.defineProperty(e,"isElectron",{enumerable:!0,get:function(){return u.default}});var o=n("1adc"),s=l(n("1050")),a=l(n("dcb8")),u=r(n("4ed1"));function c(t){if("function"!==typeof WeakMap)return null;var e=new WeakMap,n=new WeakMap;return(c=function(t){return t?n:e})(t)}function l(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!==i(t)&&"function"!==typeof t)return{default:t};var n=c(e);if(n&&n.has(t))return n.get(t);var r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in t)if("default"!==s&&Object.prototype.hasOwnProperty.call(t,s)){var a=o?Object.getOwnPropertyDescriptor(t,s):null;a&&(a.get||a.set)?Object.defineProperty(r,s,a):r[s]=t[s]}return r.default=t,n&&n.set(t,r),r}},f50d:function(t,e,n){"use strict";(function(t){n.d(e,"c",(function(){return h})),n.d(e,"b",(function(){return f})),n.d(e,"a",(function(){return d}));var r=n("ae9d"),i=n("8177"),o=n("5729"),s=n("dd22");function a(t,e){const n=t[e].bind(t);t[e]=function(...e){const r=e[0];return r in t.state.cache&&t.state.enable?t.state.cache[r]:n(...e)},Object.defineProperty(t[e],"name",{value:`${e}-from-cache`,configurable:!1})}function u(t,e,n){const r=t[e].bind(t);t[e]=function(...e){const{valueChanged:i,oldValue:o}=n(t.state._updateCache,...e);return i&&r(...e),o},Object.defineProperty(t[e],"name",{value:`${e}-to-cache`,configurable:!1})}function c(t){const e=t.useProgram.bind(t);t.useProgram=function(n){t.state.program!==n&&(e(n),t.state.program=n)}}class l{constructor(t,{copyState:e=!1,log:n=(()=>{})}={}){this.gl=t,this.program=null,this.stateStack=[],this.enable=!0,this.cache=e?Object(i["a"])(t):Object.assign({},r["c"]),this.log=n,this._updateCache=this._updateCache.bind(this),Object.seal(this)}push(t={}){this.stateStack.push({})}pop(){Object(o["a"])(this.stateStack.length>0);const t=this.stateStack[this.stateStack.length-1];Object(i["c"])(this.gl,t),this.stateStack.pop()}_updateCache(t){let e,n=!1;const r=this.stateStack.length>0&&this.stateStack[this.stateStack.length-1];for(const i in t){Object(o["a"])(void 0!==i);const a=t[i],u=this.cache[i];Object(s["a"])(a,u)||(n=!0,e=u,!r||i in r||(r[i]=u),this.cache[i]=a)}return{valueChanged:n,oldValue:e}}}function h(e,n={}){const{enable:i=!0,copyState:s}=n;if(Object(o["a"])(void 0!==s),!e.state){const n="undefined"!==typeof t?t:window,{polyfillContext:i}=n;i&&i(e),e.state=new l(e,{copyState:s}),c(e);for(const t in r["b"]){const n=r["b"][t];u(e,t,n)}a(e,"getParameter"),a(e,"isEnabled")}return e.state.enable=i,e}function f(t){t.state||h(t,{copyState:!1}),t.state.push()}function d(t){Object(o["a"])(t.state),t.state.pop()}}).call(this,n("c8ba"))},f5f44:function(t,e,n){"use strict";(function(t,r){n.d(e,"a",(function(){return o}));const i={self:"undefined"!==typeof self&&self,window:"undefined"!==typeof window&&window,global:"undefined"!==typeof t&&t,document:"undefined"!==typeof document&&document},o=(i.self||i.window||i.global,i.window||i.self||i.global,i.global||i.self||i.window,i.document,"object"!==typeof r||"[object process]"!==String(r)||r.browser,"undefined"!==typeof window&&"undefined"!==typeof window.orientation),s="undefined"!==typeof r&&r.version&&/v([0-9]*)/.exec(r.version);s&&parseFloat(s[1])}).call(this,n("c8ba"),n("4362"))},f623:function(t,e,n){"use strict";var r=n("18e2"),i=n("1738"),o=Object(r["a"])((function(t){t.setUTCMinutes(0,0,0)}),(function(t,e){t.setTime(+t+e*i["b"])}),(function(t,e){return(e-t)/i["b"]}),(function(t){return t.getUTCHours()}));e["a"]=o;o.range},f6b4:function(t,e,n){"use strict";var r=n("c532");function i(){this.handlers=[]}i.prototype.use=function(t,e,n){return this.handlers.push({fulfilled:t,rejected:e,synchronous:!!n&&n.synchronous,runWhen:n?n.runWhen:null}),this.handlers.length-1},i.prototype.eject=function(t){this.handlers[t]&&(this.handlers[t]=null)},i.prototype.forEach=function(t){r.forEach(this.handlers,(function(e){null!==e&&t(e)}))},t.exports=i},f717:function(t,e,n){"use strict";n("5f48")},f71a:function(t,e,n){"use strict";(function(t){var r=n("4ea4");Object.defineProperty(e,"__esModule",{value:!0}),e.default=o;var i=r(n("7037"));function o(e){if("undefined"!==typeof window&&"object"===(0,i.default)(window.process)&&"renderer"===window.process.type)return!0;if("undefined"!==typeof t&&"object"===(0,i.default)(t.versions)&&Boolean(t.versions.electron))return!0;var n="object"===("undefined"===typeof navigator?"undefined":(0,i.default)(navigator))&&"string"===typeof navigator.userAgent&&navigator.userAgent,r=e||n;return!!(r&&r.indexOf("Electron")>=0)}}).call(this,n("4362"))},f87d:function(t,e,n){"use strict";n.d(e,"a",(function(){return o})),n.d(e,"b",(function(){return s})),n.d(e,"c",(function(){return u}));var r=n("6b74");function i(t,e){if(t.length!==e)return!1;for(let n=0;n<t.length;++n)if(!Number.isFinite(t[n]))return!1;return!0}function o(t){if(!Number.isFinite(t))throw new Error("Invalid number ".concat(t));return t}function s(t,e,n=""){if(r["b"].debug&&!i(t,e))throw new Error("math.gl: ".concat(n," some fields set to invalid numbers'"));return t}const a={};function u(t,e){a[t]||(a[t]=!0,console.warn("".concat(t," has been removed in version ").concat(e,", see upgrade guide for more information")))}},f8ee:function(t,e,n){"use strict";var r=n("18e2"),i=n("1738"),o=Object(r["a"])((function(t){t.setUTCSeconds(0,0)}),(function(t,e){t.setTime(+t+e*i["c"])}),(function(t,e){return(e-t)/i["c"]}),(function(t){return t.getUTCMinutes()}));e["a"]=o;o.range},f9e5:function(t,e,n){"use strict";n("151e")},fab1:function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n("6b74"),i=n("cd77"),o=n("323f");const s=1e-6,a=6371e3;class u{constructor({phi:t=0,theta:e=0,radius:n=1,bearing:r,pitch:i,altitude:o,radiusScale:s=a}={}){this.phi=t,this.theta=e,this.radius=n||o||1,this.radiusScale=s||1,void 0!==r&&(this.bearing=r),void 0!==i&&(this.pitch=i),this.check()}toString(){return this.formatString(r["b"])}formatString({printTypes:t=!1}){const e=r["e"];return"".concat(t?"Spherical":"","[rho:").concat(e(this.radius),",theta:").concat(e(this.theta),",phi:").concat(e(this.phi),"]")}equals(t){return Object(r["d"])(this.radius,t.radius)&&Object(r["d"])(this.theta,t.theta)&&Object(r["d"])(this.phi,t.phi)}exactEquals(t){return this.radius===t.radius&&this.theta===t.theta&&this.phi===t.phi}get bearing(){return 180-Object(r["c"])(this.phi)}set bearing(t){this.phi=Math.PI-Object(r["h"])(t)}get pitch(){return Object(r["c"])(this.theta)}set pitch(t){this.theta=Object(r["h"])(t)}get longitude(){return Object(r["c"])(this.phi)}get latitude(){return Object(r["c"])(this.theta)}get lng(){return Object(r["c"])(this.phi)}get lat(){return Object(r["c"])(this.theta)}get z(){return(this.radius-1)*this.radiusScale}set(t,e,n){return this.radius=t,this.phi=e,this.theta=n,this.check()}clone(){return(new u).copy(this)}copy(t){return this.radius=t.radius,this.phi=t.phi,this.theta=t.theta,this.check()}fromLngLatZ([t,e,n]){this.radius=1+n/this.radiusScale,this.phi=Object(r["h"])(e),this.theta=Object(r["h"])(t)}fromVector3(t){return this.radius=o["c"](t),this.radius>0&&(this.theta=Math.atan2(t[0],t[1]),this.phi=Math.acos(Object(r["a"])(t[2]/this.radius,-1,1))),this.check()}toVector3(){return new i["a"](0,0,this.radius).rotateX({radians:this.theta}).rotateZ({radians:this.phi})}makeSafe(){return this.phi=Math.max(s,Math.min(Math.PI-s,this.phi)),this}check(){if(!Number.isFinite(this.phi)||!Number.isFinite(this.theta)||!(this.radius>0))throw new Error("SphericalCoordinates: some fields set to invalid numbers");return this}}},fc4d:function(t,e,n){"use strict";(function(t,r){var i=n("4ea4");Object.defineProperty(e,"__esModule",{value:!0}),e.console=e.process=e.document=e.global=e.window=e.self=void 0;var o=i(n("7037")),s={self:"undefined"!==typeof self&&self,window:"undefined"!==typeof window&&window,global:"undefined"!==typeof t&&t,document:"undefined"!==typeof document&&document,process:"object"===("undefined"===typeof r?"undefined":(0,o.default)(r))&&r},a=s.self||s.window||s.global;e.self=a;var u=s.window||s.self||s.global;e.window=u;var c=s.global||s.self||s.window;e.global=c;var l=s.document||{};e.document=l;var h=s.process||{};e.process=h;var f=console;e.console=f}).call(this,n("c8ba"),n("4362"))},fda6:function(t,e,n){"use strict";n("5eb5")}}]);
//# sourceMappingURL=chunk-275db676.128594c9.js.map